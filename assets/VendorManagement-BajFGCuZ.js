import{j as e}from"./date-iP6_brdS.js";import{r as n}from"./vendor-CPDP2aPO.js";import{a as k,S as h,C as S,b as A}from"./index-672Kbn38.js";import{c as i,C as V}from"./clock-CRlKMyow.js";import{m as u,A as B}from"./ui-Tzc8TJql.js";import{M as E}from"./mail-BdZ2oGEy.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],D=i("calendar",q);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],T=i("funnel",Q);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],H=i("map-pin",G);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],O=i("search",J);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],C=i("triangle-alert",U),M="https://afrimercato-backend.fly.dev";function se(){const[f,$]=n.useState([]),[_,y]=n.useState(!0),[x,z]=n.useState("all"),[m,L]=n.useState(""),[o,j]=n.useState(null),[P,c]=n.useState(!1),[a,F]=n.useState(""),[d,b]=n.useState(""),[p,N]=n.useState(!1);n.useEffect(()=>{v()},[x,m]);const v=async()=>{try{y(!0);const s=localStorage.getItem("afrimercato_token"),{data:t}=await k.get(`${M}/admin/vendors`,{params:{status:x,search:m},headers:{Authorization:`Bearer ${s}`}});$(t.data)}catch(s){console.error("Failed to fetch vendors:",s)}finally{y(!1)}},I=async()=>{var s,t;if(!(!o||!a))try{N(!0);const r=localStorage.getItem("afrimercato_token"),l=a==="approve"?"approve":a==="reject"?"reject":"suspend";await k.put(`${M}/admin/vendors/${o._id}/${l}`,{note:d,reason:d},{headers:{Authorization:`Bearer ${r}`}}),c(!1),b(""),j(null),v()}catch(r){console.error("Action failed:",r),alert(((t=(s=r.response)==null?void 0:s.data)==null?void 0:t.message)||"Action failed")}finally{N(!1)}},g=(s,t)=>{j(s),F(t),c(!0)},R=s=>{const t={approved:{bg:"bg-green-100",text:"text-green-800",icon:S},pending:{bg:"bg-yellow-100",text:"text-yellow-800",icon:V},rejected:{bg:"bg-red-100",text:"text-red-800",icon:A},suspended:{bg:"bg-gray-100",text:"text-gray-800",icon:C}},r=t[s]||t.pending,l=r.icon;return e.jsxs("span",{className:`${r.bg} ${r.text} px-3 py-1 rounded-full text-sm font-semibold flex items-center gap-1 w-fit`,children:[e.jsx(l,{className:"w-4 h-4"}),s]})};return e.jsxs("div",{className:"min-h-screen bg-gray-50 p-4 md:p-8",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 mb-2 flex items-center",children:[e.jsx(h,{className:"w-8 h-8 mr-3 text-afri-green"}),"Vendor Management"]}),e.jsx("p",{className:"text-gray-600",children:"Approve, reject, or manage vendor stores"})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(O,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search vendors...",value:m,onChange:s=>L(s.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(T,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsxs("select",{value:x,onChange:s=>z(s.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent appearance-none",children:[e.jsx("option",{value:"all",children:"All Statuses"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"}),e.jsx("option",{value:"suspended",children:"Suspended"})]})]})]})}),_?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-afri-green mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading vendors..."})]}):f.length===0?e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-12 text-center",children:[e.jsx(h,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"No vendors found"}),e.jsx("p",{className:"text-gray-500",children:"Try adjusting your filters"})]}):e.jsx("div",{className:"grid grid-cols-1 gap-6",children:f.map((s,t)=>{var r,l,w;return e.jsx(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:t*.05},className:"bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:s.storeName||s.businessName}),R(s.approvalStatus)]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{children:(r=s.user)==null?void 0:r.email})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{children:[(l=s.address)==null?void 0:l.city,", ",(w=s.address)==null?void 0:w.country]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{children:["Joined ",new Date(s.createdAt).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{children:s.category||"General"})]})]}),s.description&&e.jsx("p",{className:"mt-3 text-gray-700 text-sm",children:s.description}),s.approvalNote&&e.jsx("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Note:"})," ",s.approvalNote]})})]}),e.jsxs("div",{className:"flex flex-col gap-2 md:min-w-[200px]",children:[s.approvalStatus==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>g(s,"approve"),className:"bg-green-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-green-700 transition flex items-center justify-center gap-2",children:[e.jsx(S,{className:"w-4 h-4"}),"Approve"]}),e.jsxs("button",{onClick:()=>g(s,"reject"),className:"bg-red-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-red-700 transition flex items-center justify-center gap-2",children:[e.jsx(A,{className:"w-4 h-4"}),"Reject"]})]}),s.approvalStatus==="approved"&&e.jsxs("button",{onClick:()=>g(s,"suspend"),className:"bg-gray-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-gray-700 transition flex items-center justify-center gap-2",children:[e.jsx(C,{className:"w-4 h-4"}),"Suspend"]})]})]})})},s._id)})})]}),e.jsx(B,{children:P&&e.jsxs(e.Fragment,{children:[e.jsx(u.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>c(!1),className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-40"}),e.jsx(u.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6",children:[e.jsxs("h3",{className:"text-2xl font-bold text-gray-900 mb-4 capitalize",children:[a," Vendor"]}),e.jsxs("p",{className:"text-gray-600 mb-4",children:["Are you sure you want to ",a," ",o==null?void 0:o.storeName,"?"]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:a==="approve"?"Approval Note (Optional)":"Reason *"}),e.jsx("textarea",{value:d,onChange:s=>b(s.target.value),placeholder:`Enter ${a} ${a==="approve"?"note":"reason"}...`,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent",rows:4})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:I,disabled:p||a!=="approve"&&!d,className:`flex-1 py-3 rounded-lg font-semibold text-white transition ${a==="approve"?"bg-green-600 hover:bg-green-700":a==="reject"?"bg-red-600 hover:bg-red-700":"bg-gray-600 hover:bg-gray-700"} disabled:opacity-50 disabled:cursor-not-allowed`,children:p?"Processing...":`Confirm ${a}`}),e.jsx("button",{onClick:()=>c(!1),disabled:p,className:"flex-1 bg-gray-200 text-gray-700 py-3 rounded-lg font-semibold hover:bg-gray-300 transition",children:"Cancel"})]})]})})]})})]})}export{se as default};
