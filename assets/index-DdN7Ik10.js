const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.es-CYUj7cQv.js","assets/vendor-BOvbtTVj.js","assets/date-CmiLJgMe.js"])))=>i.map(i=>d[i]);
import{j as o,_ as rr}from"./date-CmiLJgMe.js";import{a as t2,r as Te,u as qi,L as Et,b as r2,c as nc,d as n2,e as a2,f as i2,h as s2,i as Yn,N as li,R as cu,H as o2}from"./vendor-BOvbtTVj.js";import{m as ct,A as l2}from"./ui-B-S5vQyI.js";import{R as ac,L as c2,C as Vf,X as Gf,Y as $f,T as ic,a as Yf,b as f2,B as h2,c as u2,P as d2,d as p2,e as m2}from"./charts-C7uDCmWg.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=t(a);fetch(a.href,s)}})();var kc={},Xf=t2;kc.createRoot=Xf.createRoot,kc.hydrateRoot=Xf.hydrateRoot;const Gc="http://localhost:5000/api";console.log("ðŸ”— API Base URL:",Gc);let Pl=!1,Tc=[];const Kf=(e,r=null)=>{Tc.forEach(t=>{e?t.reject(e):t.resolve(r)}),Tc=[]},g2=async()=>{var r;const e=localStorage.getItem("afrimercato_refresh_token");if(!e)throw new Error("No refresh token available");try{const t=await fetch(`${Gc}/auth/refresh-token`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:e})});if(!t.ok)throw new Error("Failed to refresh token");const n=await t.json();if(n.success&&((r=n.data)!=null&&r.token))return localStorage.setItem("afrimercato_token",n.data.token),n.data.token;throw new Error("Invalid refresh response")}catch(t){throw localStorage.removeItem("afrimercato_token"),localStorage.removeItem("afrimercato_refresh_token"),t}},It=async(e,r={},t=!1)=>{try{const n=`${Gc}${e}`,a={headers:{"Content-Type":"application/json",...r.headers},credentials:"include",...r},s=localStorage.getItem("afrimercato_token");s&&(a.headers.Authorization=`Bearer ${s}`);const l=await fetch(n,a);if(!l.ok){const f=await l.json().catch(()=>({}));if(l.status===401&&!t&&(f.errorCode==="TOKEN_EXPIRED"||f.errorCode==="INVALID_TOKEN")){if(Pl)return new Promise((u,d)=>{Tc.push({resolve:u,reject:d})}).then(u=>It(e,r,!0)).catch(u=>{throw u});Pl=!0;try{const u=await g2();return Kf(null,u),Pl=!1,It(e,r,!0)}catch(u){throw Kf(u,null),Pl=!1,window.location.href="/login",new Error("Session expired. Please log in again.")}}throw l.status===401?(localStorage.removeItem("afrimercato_token"),localStorage.removeItem("afrimercato_refresh_token"),new Error("Session expired. Please log in again.")):new Error(f.message||`HTTP error! status: ${l.status}`)}return await l.json()}catch(n){throw console.error(`âŒ API Error (${e}):`,n),n}},x2=async e=>{var t;const r=await It("/auth/login",{method:"POST",body:JSON.stringify(e)});return r.success&&((t=r.data)!=null&&t.token)&&(localStorage.setItem("afrimercato_token",r.data.token),r.data.refreshToken&&localStorage.setItem("afrimercato_refresh_token",r.data.refreshToken)),r},v2=async e=>{var t;const r=await It("/auth/register",{method:"POST",body:JSON.stringify(e)});return r.success&&((t=r.data)!=null&&t.token)&&(localStorage.setItem("afrimercato_token",r.data.token),r.data.refreshToken&&localStorage.setItem("afrimercato_refresh_token",r.data.refreshToken)),r},y2=async()=>{try{await It("/auth/logout",{method:"POST"})}finally{localStorage.removeItem("afrimercato_token"),localStorage.removeItem("afrimercato_refresh_token"),window.location.href="/login"}},w2=async()=>It("/auth/refresh",{method:"POST"}),b2=async()=>It("/vendor/profile"),N2=async e=>It("/vendor/profile",{method:"PUT",body:JSON.stringify(e)}),fu=async e=>It("/vendor/profile",{method:"POST",body:JSON.stringify(e)}),_2=async(e={})=>{const r=new URLSearchParams(e).toString();return It(`/vendor/products?${r}`)},S2=async e=>It("/vendor/products",{method:"POST",body:JSON.stringify(e)}),A2=async(e,r)=>It(`/vendor/products/${e}`,{method:"PUT",body:JSON.stringify(r)}),j2=async e=>It(`/vendor/products/${e}`,{method:"DELETE"}),k2=async(e={})=>{const r=new URLSearchParams(e).toString();return It(`/vendor/orders?${r}`)},T2=async e=>It(`/vendor/orders/${e}`),E2=async(e,r)=>It(`/vendor/orders/${e}/status`,{method:"PUT",body:JSON.stringify(r)}),F2=async()=>It("/vendor/dashboard/stats"),C2=async(e="7d")=>It(`/vendor/dashboard/chart-data?timeRange=${e}`),L2=async(e={})=>{const r=new URLSearchParams(e).toString();return It(`/vendor/reports/sales?${r}`)},P2=async()=>It("/vendor/reports/inventory"),O2=async(e={})=>{const r=new URLSearchParams(e).toString();return It(`/vendor/reports/orders?${r}`)},I2=async(e={})=>{const r=new URLSearchParams(e).toString();return It(`/vendor/reports/revenue?${r}`)},D2=async()=>It("/subscription/plans"),R2=async e=>It("/subscription/subscribe",{method:"POST",body:JSON.stringify(e)}),M2=async()=>It("/subscription/my-subscription"),B2=async()=>It("/subscription/cancel",{method:"POST"}),U2=async(e,r=50)=>{const t=new URLSearchParams({location:e,radius:r});return It(`/location/search-vendors?${t}`)},H2=async e=>It(`/vendors/${e}`),W2=async e=>It(`/vendors/${e}/products`),z2=async e=>{const r=new FormData;e.forEach(n=>{r.append("images",n)});const t=localStorage.getItem("afrimercato_token");return It("/vendor/upload/images",{method:"POST",headers:{...t&&{Authorization:`Bearer ${t}`}},body:r})},q2=async e=>It("/vendor/products/bulk-delete",{method:"POST",body:JSON.stringify(e)}),V2=async e=>It("/vendor/products/bulk-status",{method:"POST",body:JSON.stringify(e)}),G2=async e=>It("/vendor/products/bulk-price",{method:"POST",body:JSON.stringify(e)}),$2=async e=>It("/vendor/products/bulk-stock",{method:"POST",body:JSON.stringify(e)}),Y2=()=>!!localStorage.getItem("afrimercato_token"),X2=()=>localStorage.getItem("afrimercato_token"),K2=e=>{localStorage.setItem("afrimercato_token",e)},J2=()=>{localStorage.removeItem("afrimercato_token"),localStorage.removeItem("afrimercato_refresh_token")},Jf={login:x2,register:v2,logout:y2,refreshToken:w2,isAuthenticated:Y2,getAuthToken:X2,setAuthToken:K2,clearAuthToken:J2},mr={getProfile:b2,updateProfile:N2,createProfile:fu,getProducts:_2,createProduct:S2,updateProduct:A2,deleteProduct:j2,getOrders:k2,getOrder:T2,updateOrderStatus:E2,getDashboardStats:F2,getChartData:C2,getSalesReport:L2,getInventoryReport:P2,getOrdersReport:O2,getRevenueReport:I2,uploadProductImages:z2,bulkDeleteProducts:q2,bulkUpdateStatus:V2,bulkUpdatePrices:G2,bulkUpdateStock:$2},sc={getPlans:D2,subscribe:R2,getMySubscription:M2,cancel:B2},hu=Te.createContext(),Bo=()=>{const e=Te.useContext(hu);if(!e)throw new Error("useAuth must be used within AuthProvider");return e},Z2=({children:e})=>{const[r,t]=Te.useState(null),[n,a]=Te.useState(!0),[s,l]=Te.useState(!1);Te.useEffect(()=>{c()},[]);const c=async()=>{localStorage.getItem("afrimercato_token")&&l(!0),a(!1)},g={user:r,isAuthenticated:s,loading:n,login:async(x,p)=>{try{const w=await Jf.login({email:x,password:p});if(w.success){const{token:v,user:_}=w.data;return localStorage.setItem("afrimercato_token",v),t(_),l(!0),{success:!0,user:_}}}catch(w){return{success:!1,message:w.message||"Login failed"}}},register:async x=>{try{const p=await Jf.register(x);if(p.success){const{token:w,user:v}=p.data;return localStorage.setItem("afrimercato_token",w),t(v),l(!0),{success:!0}}}catch(p){return{success:!1,message:p.message||"Registration failed"}}},logout:()=>{localStorage.removeItem("afrimercato_token"),t(null),l(!1)},checkAuth:c};return o.jsx(hu.Provider,{value:g,children:e})};function Q2(){const e=qi(),{login:r}=Bo(),[t,n]=Te.useState({email:"",password:""}),[a,s]=Te.useState(""),[l,c]=Te.useState(!1),[f,u]=Te.useState(!1),d=x=>{n({...t,[x.target.name]:x.target.value}),s("")},g=async x=>{var w,v;x.preventDefault(),s(""),c(!0);const p=await r(t.email,t.password);if(p.success)switch(((w=p.user)==null?void 0:w.role)||((v=p.user)==null?void 0:v.primaryRole)||"customer"){case"vendor":e("/dashboard");break;case"rider":e("/rider/dashboard");break;case"picker":e("/picker/dashboard");break;case"customer":default:e("/");break}else s(p.message||"Login failed. Please try again.");c(!1)};return o.jsxs("div",{className:"min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8 overflow-hidden relative bg-gradient-to-br from-afri-green to-afri-green-dark",style:{backgroundSize:"400% 400%",animation:"gradient 15s ease infinite"},children:[o.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:o.jsx("div",{className:"absolute inset-0",style:{background:"radial-gradient(circle at center, rgba(255,255,255,0.1) 0%, transparent 60%)",animation:"pulse 4s ease-in-out infinite"}})}),o.jsxs(ct.div,{className:"max-w-md w-full relative",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[o.jsxs(ct.div,{className:"text-center mb-8",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5},children:[o.jsx(ct.h1,{className:"text-5xl font-bold text-white mb-2",initial:{y:-20},animate:{y:0},transition:{type:"spring",stiffness:300,damping:20},children:"Afrimercato"}),o.jsx(ct.p,{className:"text-afri-yellow text-lg",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:"Fresh African Groceries"})]}),o.jsxs(ct.div,{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl p-8",initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.4,delay:.3},children:[o.jsx(ct.h2,{className:"text-3xl font-bold text-gray-900 mb-2",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{duration:.4,delay:.4},children:"Welcome Back"}),o.jsx(ct.p,{className:"text-gray-600 mb-6",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{duration:.4,delay:.5},children:"Sign in to your account"}),a&&o.jsx(ct.div,{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-6 rounded",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3},children:o.jsx("p",{className:"text-red-700 text-sm",children:a})}),o.jsxs("form",{onSubmit:g,className:"space-y-6",children:[o.jsxs(ct.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.6},children:[o.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),o.jsx(ct.input,{whileFocus:{scale:1.01},transition:{type:"spring",stiffness:300,damping:20},id:"email",name:"email",type:"email",required:!0,value:t.email,onChange:d,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"vendor@example.com"})]}),o.jsxs(ct.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.7},children:[o.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),o.jsxs("div",{className:"relative",children:[o.jsx(ct.input,{whileFocus:{scale:1.01},transition:{type:"spring",stiffness:300,damping:20},id:"password",name:"password",type:f?"text":"password",required:!0,value:t.password,onChange:d,className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"}),o.jsx("button",{type:"button",onClick:()=>u(!f),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700 focus:outline-none",children:f?o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):o.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),o.jsxs(ct.div,{className:"flex items-center justify-between",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.8},children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(ct.input,{whileHover:{scale:1.1},transition:{type:"spring",stiffness:400,damping:10},id:"remember",name:"remember",type:"checkbox",className:"h-4 w-4 text-afri-green focus:ring-afri-green border-gray-300 rounded"}),o.jsx("label",{htmlFor:"remember",className:"ml-2 block text-sm text-gray-700",children:"Remember me"})]}),o.jsx(ct.div,{whileHover:{scale:1.05},children:o.jsx(Et,{to:"/forgot-password",className:"text-sm text-afri-green hover:text-afri-green-dark font-medium",children:"Forgot password?"})})]}),o.jsx(ct.button,{type:"submit",disabled:l,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-white bg-gradient-to-r from-afri-green to-afri-green-dark hover:from-afri-green-dark hover:to-afri-green focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-afri-green font-semibold text-lg transition disabled:opacity-50 disabled:cursor-not-allowed",whileHover:{scale:1.02},whileTap:{scale:.98},initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.9},children:l?o.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):"Sign In"})]}),o.jsxs(ct.div,{className:"mt-6",initial:{opacity:0},animate:{opacity:1},transition:{delay:1},children:[o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-0 flex items-center",children:o.jsx("div",{className:"w-full border-t border-gray-300"})}),o.jsx("div",{className:"relative flex justify-center text-sm",children:o.jsx("span",{className:"px-4 bg-white text-gray-500",children:"New to Afrimercato?"})})]}),o.jsx(ct.div,{className:"mt-6 text-center",whileHover:{scale:1.05},children:o.jsxs(Et,{to:"/register",className:"text-afri-green hover:text-afri-green-dark font-semibold text-base inline-flex items-center",children:["Create an account",o.jsx(ct.span,{animate:{x:[0,5,0]},transition:{repeat:1/0,duration:1.5},className:"ml-2",children:"â†’"})]})})]})]}),o.jsx(ct.p,{className:"mt-8 text-center text-sm text-white",initial:{opacity:0},animate:{opacity:1},transition:{delay:1.1},children:"Â© 2025 Afrimercato. Fresh African Groceries Delivered."})]}),o.jsx("style",{jsx:!0,children:`
        @keyframes gradient {
          0% { background-position: 0% 50% }
          50% { background-position: 100% 50% }
          100% { background-position: 0% 50% }
        }
        @keyframes pulse {
          0% { opacity: 0.4 }
          50% { opacity: 0.6 }
          100% { opacity: 0.4 }
        }
      `})]})}const oc={vegetables:"/images/afrihub3.png",fruits:"/images/afrihub4.png","meat-fish":"/images/afrihub5.png",dairy:"/images/afrihub6.png",grains:"/images/afrihub7.png",beverages:"/images/afrihub8.png",spices:"/images/afrihub9.png","fresh-produce":"/images/afrihub2.png",bakery:"/images/afrime2.png",snacks:"/images/afrime3.png",default:"/images/afrihub1.png"},lc={default:"/images/piafrimerca.png",market:"/images/afrimenewme.png",grocery:"/images/afrimenewme2.png"},Ol={hero1:"/images/afrimenewme3.png",hero2:"/images/afrimenewme4.png",store1:"/images/afrime4.png",store2:"/images/afrime5.png"},ep=e=>{if(!e)return oc.default;const r=e.toLowerCase().replace(/\s+/g,"-");return oc[r]||oc.default},tp=e=>{if(!e)return lc.default;const r=e.toLowerCase();return lc[r]||lc.default},uu=e=>{var r;if(e!=null&&e.images&&e.images.length>0){const t=e.images.find(n=>n.isPrimary);if(t!=null&&t.url)return t.url;if((r=e.images[0])!=null&&r.url)return e.images[0].url}return ep(e==null?void 0:e.category)},rp=e=>{var r,t;return(r=e==null?void 0:e.banner)!=null&&r.url?e.banner.url:(t=e==null?void 0:e.logo)!=null&&t.url?e.logo.url:tp((e==null?void 0:e.businessType)||(e==null?void 0:e.category))};function np(){const e=qi(),{register:r}=Bo(),[t,n]=Te.useState({name:"",email:"",password:"",confirmPassword:"",role:"customer"}),[a,s]=Te.useState(""),[l,c]=Te.useState(!1),[f,u]=Te.useState(!1),[d,g]=Te.useState(!1),x=b=>{n({...t,[b.target.name]:b.target.value}),s("")},p=async b=>{if(b.preventDefault(),s(""),t.password!==t.confirmPassword){s("Passwords do not match");return}if(t.password.length<6){s("Password must be at least 6 characters");return}c(!0);const A=await r(t);if(A.success)switch(t.role){case"vendor":e("/dashboard");break;case"rider":e("/rider/dashboard");break;case"picker":e("/picker/dashboard");break;case"customer":default:e("/");break}else s(A.message);c(!1)},w={hidden:{opacity:0},visible:{opacity:1,transition:{delayChildren:.1,staggerChildren:.1}}},v={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",stiffness:100}}},S=(()=>{switch(t.role){case"vendor":return{title:"Start Selling Today",subtitle:"Join thousands of vendors on Afrimercato",benefit1:"ðŸ“Š Real-time sales analytics",benefit2:"ðŸš€ Instant order notifications",benefit3:"ðŸ’° Low commission rates",image:Ol.store1};case"rider":return{title:"Become a Delivery Partner",subtitle:"Deliver groceries and earn on your schedule",benefit1:"â° Flexible working hours",benefit2:"ðŸ’µ Competitive earnings",benefit3:"ðŸ“± Easy-to-use rider app",image:Ol.hero2};case"picker":return{title:"Join Our Fulfillment Team",subtitle:"Help fulfill orders from local stores",benefit1:"ðŸª Work with top vendors",benefit2:"ðŸ“¦ Simple picking process",benefit3:"ðŸ’ª Great team environment",image:Ol.store2};default:return{title:"Join Our Community",subtitle:"Start shopping for fresh African groceries",benefit1:"ðŸ¥¬ Fresh produce daily",benefit2:"ðŸšš Fast delivery",benefit3:"ðŸŽ Exclusive deals",image:Ol.hero1}}})();return o.jsxs("div",{className:"min-h-screen flex bg-gray-50",children:[o.jsxs(ct.div,{initial:{x:-50,opacity:0},animate:{x:0,opacity:1},transition:{duration:.6},className:"hidden lg:flex lg:w-1/2 bg-gradient-to-br from-afri-green via-afri-green-dark to-green-900 p-12 flex-col justify-between relative overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 opacity-10",children:o.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 2px 2px, white 1px, transparent 0)",backgroundSize:"40px 40px"}})}),o.jsxs("div",{className:"relative z-10",children:[o.jsxs(ct.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.6},children:[o.jsx("h1",{className:"text-6xl font-bold text-white mb-2",children:"Afrimercato"}),o.jsx("p",{className:"text-afri-yellow text-xl font-semibold",children:S.title})]}),o.jsxs(ct.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4,duration:.6},className:"mt-12 space-y-6",children:[o.jsxs("div",{className:"flex items-start space-x-4",children:[o.jsx("div",{className:"bg-white/20 rounded-lg p-3 backdrop-blur-sm",children:o.jsx("svg",{className:"w-6 h-6 text-afri-yellow",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),o.jsx("div",{children:o.jsx("p",{className:"text-white text-lg font-medium",children:S.benefit1})})]}),o.jsxs("div",{className:"flex items-start space-x-4",children:[o.jsx("div",{className:"bg-white/20 rounded-lg p-3 backdrop-blur-sm",children:o.jsx("svg",{className:"w-6 h-6 text-afri-yellow",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),o.jsx("div",{children:o.jsx("p",{className:"text-white text-lg font-medium",children:S.benefit2})})]}),o.jsxs("div",{className:"flex items-start space-x-4",children:[o.jsx("div",{className:"bg-white/20 rounded-lg p-3 backdrop-blur-sm",children:o.jsx("svg",{className:"w-6 h-6 text-afri-yellow",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),o.jsx("div",{children:o.jsx("p",{className:"text-white text-lg font-medium",children:S.benefit3})})]})]})]}),o.jsx(ct.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.6,duration:.6},className:"relative z-10",children:o.jsx("img",{src:S.image,alt:S.title,className:"rounded-2xl shadow-2xl w-full h-64 object-cover border-4 border-white/20"})}),o.jsx(ct.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},className:"relative z-10 text-white/70 text-sm",children:"Â© 2025 Afrimercato. Fresh African Groceries Delivered."})]}),o.jsx("div",{className:"w-full lg:w-1/2 flex items-center justify-center p-8",children:o.jsxs(ct.div,{variants:w,initial:"hidden",animate:"visible",className:"w-full max-w-md",children:[o.jsxs(ct.div,{variants:v,className:"lg:hidden text-center mb-8",children:[o.jsx("h1",{className:"text-4xl font-bold text-afri-green mb-2",children:"Afrimercato"}),o.jsx("p",{className:"text-gray-600",children:S.title})]}),o.jsxs(ct.div,{variants:v,className:"bg-white rounded-2xl shadow-xl p-8 border border-gray-100",children:[o.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Create Account"}),o.jsxs("p",{className:"text-gray-600 mb-6",children:[t.role==="vendor"&&"Join thousands of vendors on Afrimercato",t.role==="customer"&&"Start shopping for fresh African groceries",t.role==="rider"&&"Deliver groceries and earn on your schedule",t.role==="picker"&&"Help fulfill orders from local stores"]}),a&&o.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-6 rounded",children:o.jsx("p",{className:"text-red-700 text-sm",children:a})}),o.jsxs("form",{onSubmit:p,className:"space-y-5",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 mb-2",children:"I want to register as"}),o.jsxs("select",{id:"role",name:"role",required:!0,value:t.role,onChange:x,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition bg-white",children:[o.jsx("option",{value:"customer",children:"Customer - Shop for groceries"}),o.jsx("option",{value:"vendor",children:"Vendor - Sell products"}),o.jsx("option",{value:"rider",children:"Rider - Deliver orders"}),o.jsx("option",{value:"picker",children:"Picker - Fulfill orders"})]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name"}),o.jsx("input",{id:"name",name:"name",type:"text",required:!0,value:t.name,onChange:x,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"John Doe"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),o.jsx("input",{id:"email",name:"email",type:"email",required:!0,value:t.email,onChange:x,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"vendor@example.com"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{id:"password",name:"password",type:f?"text":"password",required:!0,value:t.password,onChange:x,className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"}),o.jsx("button",{type:"button",onClick:()=>u(!f),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700 focus:outline-none",children:f?o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.542 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):o.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"At least 6 characters"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password"}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:d?"text":"password",required:!0,value:t.confirmPassword,onChange:x,className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"}),o.jsx("button",{type:"button",onClick:()=>g(!d),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700 focus:outline-none",children:d?o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.542 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):o.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),o.jsxs("div",{className:"flex items-start",children:[o.jsx("input",{id:"terms",name:"terms",type:"checkbox",required:!0,className:"h-4 w-4 mt-1 text-afri-green focus:ring-afri-green border-gray-300 rounded"}),o.jsxs("label",{htmlFor:"terms",className:"ml-2 block text-sm text-gray-700",children:["I agree to the"," ",o.jsx(Et,{to:"/terms",className:"text-afri-green hover:text-afri-green-dark font-medium",children:"Terms of Service"})," ","and"," ",o.jsx(Et,{to:"/privacy",className:"text-afri-green hover:text-afri-green-dark font-medium",children:"Privacy Policy"})]})]}),o.jsx("button",{type:"submit",disabled:l,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-white bg-gradient-to-r from-afri-green to-afri-green-dark hover:from-afri-green-dark hover:to-afri-green focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-afri-green font-semibold text-lg transition disabled:opacity-50 disabled:cursor-not-allowed",children:l?o.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):"Create Account"})]}),o.jsxs("div",{className:"mt-6",children:[o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-0 flex items-center",children:o.jsx("div",{className:"w-full border-t border-gray-300"})}),o.jsx("div",{className:"relative flex justify-center text-sm",children:o.jsx("span",{className:"px-4 bg-white text-gray-500",children:"Already have an account?"})})]}),o.jsx("div",{className:"mt-6 text-center",children:o.jsx(Et,{to:"/login",className:"text-afri-green hover:text-afri-green-dark font-semibold text-base",children:"Sign in here â†’"})})]})]}),o.jsx("p",{className:"mt-8 text-center text-sm text-gray-600 lg:hidden",children:"Â© 2025 Afrimercato. Fresh African Groceries Delivered."})]})})]})}var Il=function(e,r){return e<r?-1:e>r?1:0},Zf=function(e){return e.reduce(function(r,t){return r+t},0)},ap=function(){function e(t){this.colors=t}var r=e.prototype;return r.palette=function(){return this.colors},r.map=function(t){return t},e}(),ip=function(){function e(s,l,c){return(s<<10)+(l<<5)+c}function r(s){var l=[],c=!1;function f(){l.sort(s),c=!0}return{push:function(u){l.push(u),c=!1},peek:function(u){return c||f(),u===void 0&&(u=l.length-1),l[u]},pop:function(){return c||f(),l.pop()},size:function(){return l.length},map:function(u){return l.map(u)},debug:function(){return c||f(),l}}}function t(s,l,c,f,u,d,g){var x=this;x.r1=s,x.r2=l,x.g1=c,x.g2=f,x.b1=u,x.b2=d,x.histo=g}function n(){this.vboxes=new r(function(s,l){return Il(s.vbox.count()*s.vbox.volume(),l.vbox.count()*l.vbox.volume())})}function a(s,l){if(l.count()){var c=l.r2-l.r1+1,f=l.g2-l.g1+1,u=Math.max.apply(null,[c,f,l.b2-l.b1+1]);if(l.count()==1)return[l.copy()];var d,g,x,p,w=0,v=[],_=[];if(u==c)for(d=l.r1;d<=l.r2;d++){for(p=0,g=l.g1;g<=l.g2;g++)for(x=l.b1;x<=l.b2;x++)p+=s[e(d,g,x)]||0;v[d]=w+=p}else if(u==f)for(d=l.g1;d<=l.g2;d++){for(p=0,g=l.r1;g<=l.r2;g++)for(x=l.b1;x<=l.b2;x++)p+=s[e(g,d,x)]||0;v[d]=w+=p}else for(d=l.b1;d<=l.b2;d++){for(p=0,g=l.r1;g<=l.r2;g++)for(x=l.g1;x<=l.g2;x++)p+=s[e(g,x,d)]||0;v[d]=w+=p}return v.forEach(function(S,b){_[b]=w-S}),function(S){var b,A,E,U,R,L=S+"1",C=S+"2",P=0;for(d=l[L];d<=l[C];d++)if(v[d]>w/2){for(E=l.copy(),U=l.copy(),R=(b=d-l[L])<=(A=l[C]-d)?Math.min(l[C]-1,~~(d+A/2)):Math.max(l[L],~~(d-1-b/2));!v[R];)R++;for(P=_[R];!P&&v[R-1];)P=_[--R];return E[C]=R,U[L]=E[C]+1,[E,U]}}(u==c?"r":u==f?"g":"b")}}return t.prototype={volume:function(s){var l=this;return l._volume&&!s||(l._volume=(l.r2-l.r1+1)*(l.g2-l.g1+1)*(l.b2-l.b1+1)),l._volume},count:function(s){var l=this,c=l.histo;if(!l._count_set||s){var f,u,d,g=0;for(f=l.r1;f<=l.r2;f++)for(u=l.g1;u<=l.g2;u++)for(d=l.b1;d<=l.b2;d++)g+=c[e(f,u,d)]||0;l._count=g,l._count_set=!0}return l._count},copy:function(){var s=this;return new t(s.r1,s.r2,s.g1,s.g2,s.b1,s.b2,s.histo)},avg:function(s){var l=this,c=l.histo;if(!l._avg||s){var f,u,d,g,x=0,p=0,w=0,v=0;if(l.r1===l.r2&&l.g1===l.g2&&l.b1===l.b2)l._avg=[l.r1<<3,l.g1<<3,l.b1<<3];else{for(u=l.r1;u<=l.r2;u++)for(d=l.g1;d<=l.g2;d++)for(g=l.b1;g<=l.b2;g++)x+=f=c[e(u,d,g)]||0,p+=f*(u+.5)*8,w+=f*(d+.5)*8,v+=f*(g+.5)*8;l._avg=x?[~~(p/x),~~(w/x),~~(v/x)]:[~~(8*(l.r1+l.r2+1)/2),~~(8*(l.g1+l.g2+1)/2),~~(8*(l.b1+l.b2+1)/2)]}}return l._avg},contains:function(s){var l=this,c=s[0]>>3;return gval=s[1]>>3,bval=s[2]>>3,c>=l.r1&&c<=l.r2&&gval>=l.g1&&gval<=l.g2&&bval>=l.b1&&bval<=l.b2}},n.prototype={push:function(s){this.vboxes.push({vbox:s,color:s.avg()})},palette:function(){return this.vboxes.map(function(s){return s.color})},size:function(){return this.vboxes.size()},map:function(s){for(var l=this.vboxes,c=0;c<l.size();c++)if(l.peek(c).vbox.contains(s))return l.peek(c).color;return this.nearest(s)},nearest:function(s){for(var l,c,f,u=this.vboxes,d=0;d<u.size();d++)((c=Math.sqrt(Math.pow(s[0]-u.peek(d).color[0],2)+Math.pow(s[1]-u.peek(d).color[1],2)+Math.pow(s[2]-u.peek(d).color[2],2)))<l||l===void 0)&&(l=c,f=u.peek(d).color);return f},forcebw:function(){var s=this.vboxes;s.sort(function(u,d){return Il(Zf(u.color),Zf(d.color))});var l=s[0].color;l[0]<5&&l[1]<5&&l[2]<5&&(s[0].color=[0,0,0]);var c=s.length-1,f=s[c].color;f[0]>251&&f[1]>251&&f[2]>251&&(s[c].color=[255,255,255])}},{quantize:function(s,l){if(!Number.isInteger(l)||l<1||l>256)throw new Error("Invalid maximum color count. It must be an integer between 1 and 256.");if(!s.length||l<2||l>256||!s.length||l<2||l>256)return!1;for(var c=[],f=new Set,u=0;u<s.length;u++){var d=s[u],g=d.join(",");f.has(g)||(f.add(g),c.push(d))}if(c.length<=l)return new ap(c);var x=function(b){var A,E=new Array(32768);return b.forEach(function(U){A=e(U[0]>>3,U[1]>>3,U[2]>>3),E[A]=(E[A]||0)+1}),E}(s);x.forEach(function(){});var p=function(b,A){var E,U,R,L=1e6,C=0,P=1e6,W=0,k=1e6,T=0;return b.forEach(function(H){(E=H[0]>>3)<L?L=E:E>C&&(C=E),(U=H[1]>>3)<P?P=U:U>W&&(W=U),(R=H[2]>>3)<k?k=R:R>T&&(T=R)}),new t(L,C,P,W,k,T,A)}(s,x),w=new r(function(b,A){return Il(b.count(),A.count())});function v(b,A){for(var E,U=b.size(),R=0;R<1e3;){if(U>=A||R++>1e3)return;if((E=b.pop()).count()){var L=a(x,E),C=L[0],P=L[1];if(!C)return;b.push(C),P&&(b.push(P),U++)}else b.push(E),R++}}w.push(p),v(w,.75*l);for(var _=new r(function(b,A){return Il(b.count()*b.volume(),A.count()*A.volume())});w.size();)_.push(w.pop());v(_,l);for(var S=new n;_.size();)S.push(_.pop());return S}}}().quantize,du=function(e){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.width=this.canvas.width=e.naturalWidth,this.height=this.canvas.height=e.naturalHeight,this.context.drawImage(e,0,0,this.width,this.height)};du.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)};var As=function(){};As.prototype.getColor=function(e,r){return r===void 0&&(r=10),this.getPalette(e,5,r)[0]},As.prototype.getPalette=function(e,r,t){var n=function(c){var f=c.colorCount,u=c.quality;if(f!==void 0&&Number.isInteger(f)){if(f===1)throw new Error("colorCount should be between 2 and 20. To get one color, call getColor() instead of getPalette()");f=Math.max(f,2),f=Math.min(f,20)}else f=10;return(u===void 0||!Number.isInteger(u)||u<1)&&(u=10),{colorCount:f,quality:u}}({colorCount:r,quality:t}),a=new du(e),s=function(c,f,u){for(var d,g,x,p,w,v=c,_=[],S=0;S<f;S+=u)g=v[0+(d=4*S)],x=v[d+1],p=v[d+2],((w=v[d+3])===void 0||w>=125)&&(g>250&&x>250&&p>250||_.push([g,x,p]));return _}(a.getImageData().data,a.width*a.height,n.quality),l=ip(s,n.colorCount);return l?l.palette():null},As.prototype.getColorFromUrl=function(e,r,t){var n=this,a=document.createElement("img");a.addEventListener("load",function(){var s=n.getPalette(a,5,t);r(s[0],e)}),a.src=e},As.prototype.getImageData=function(e,r){var t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="arraybuffer",t.onload=function(){if(this.status==200){var n=new Uint8Array(this.response);i=n.length;for(var a=new Array(i),s=0;s<n.length;s++)a[s]=String.fromCharCode(n[s]);var l=a.join(""),c=window.btoa(l);r("data:image/png;base64,"+c)}},t.send()},As.prototype.getColorAsync=function(e,r,t){var n=this;this.getImageData(e,function(a){var s=document.createElement("img");s.addEventListener("load",function(){var l=n.getPalette(s,5,t);r(l[0],this)}),s.src=a})};const sp=({onComplete:e})=>{const r=qi(),[t,n]=Te.useState(1),[a,s]=Te.useState(!1),[l,c]=Te.useState(""),f=Te.useRef(null),u=Te.useRef(new As),[d,g]=Te.useState({storeName:"",description:"",category:"fresh-produce",phone:"",alternativePhone:"",address:{street:"",city:"",state:"",country:"Nigeria",postalCode:""},businessHours:{monday:{open:"09:00",close:"18:00",closed:!1},tuesday:{open:"09:00",close:"18:00",closed:!1},wednesday:{open:"09:00",close:"18:00",closed:!1},thursday:{open:"09:00",close:"18:00",closed:!1},friday:{open:"09:00",close:"18:00",closed:!1},saturday:{open:"09:00",close:"18:00",closed:!1},sunday:{open:"09:00",close:"18:00",closed:!0}},logo:null,logoPreview:null,brandColors:{primary:"#059669",secondary:"#FFC107"}}),x=[{value:"fresh-produce",label:"Fresh Produce",icon:"ðŸ¥¬"},{value:"meat-seafood",label:"Meat & Seafood",icon:"ðŸ¥©"},{value:"dairy-eggs",label:"Dairy & Eggs",icon:"ðŸ¥›"},{value:"bakery",label:"Bakery",icon:"ðŸž"},{value:"pantry-staples",label:"Pantry Staples",icon:"ðŸŒ¾"},{value:"beverages",label:"Beverages",icon:"ðŸ¥¤"},{value:"snacks",label:"Snacks",icon:"ðŸ¿"},{value:"specialty",label:"Specialty Items",icon:"âœ¨"}],p=R=>{const{name:L,value:C}=R.target;if(L.startsWith("address.")){const P=L.split(".")[1];g(W=>({...W,address:{...W.address,[P]:C}}))}else g(P=>({...P,[L]:C}))},w=async R=>{const L=R.target.files[0];if(!L)return;if(!L.type.startsWith("image/")){c("Please upload an image file");return}if(L.size>5*1024*1024){c("Image size should be less than 5MB");return}const C=new FileReader;C.onload=async P=>{const W=new Image;W.crossOrigin="Anonymous",W.onload=()=>{try{const k=u.current.getPalette(W,5),T=k[0],H=(J,Q,oe)=>"#"+[J,Q,oe].map(ae=>ae.toString(16).padStart(2,"0")).join(""),G=H(...T),ce=k[1]?H(...k[1]):"#FFC107";g(J=>({...J,logo:L,logoPreview:P.target.result,brandColors:{primary:G,secondary:ce}}))}catch(k){console.error("Color extraction error:",k),g(T=>({...T,logo:L,logoPreview:P.target.result}))}},W.src=P.target.result},C.readAsDataURL(L),c("")},v=(R,L,C)=>{g(P=>({...P,businessHours:{...P.businessHours,[R]:{...P.businessHours[R],[L]:C}}}))},_=R=>{switch(R){case 1:if(!d.storeName.trim())return c("Store name is required"),!1;if(!d.description.trim())return c("Store description is required"),!1;break;case 2:if(!d.phone.trim())return c("Phone number is required"),!1;break;case 3:if(!d.address.street.trim()||!d.address.city.trim()||!d.address.state.trim())return c("Please fill in all address fields"),!1;break}return c(""),!0},S=()=>{_(t)&&n(R=>Math.min(R+1,5))},b=()=>{n(R=>Math.max(R-1,1)),c("")},A=async()=>{s(!0),c("");try{const R={storeName:d.storeName,description:d.description,category:d.category,phone:d.phone,alternativePhone:d.alternativePhone||void 0,address:d.address,businessHours:d.businessHours,brandColors:d.brandColors},L=await fu(R);L.success?(d.logo&&console.log("Logo upload will be implemented"),e?e():r("/dashboard")):c(L.message||"Failed to create vendor profile")}catch(R){console.error("Onboarding error:",R),c(R.message||"Failed to create vendor profile")}finally{s(!1)}},E=[{number:1,title:"Store Info",icon:"ðŸª"},{number:2,title:"Contact",icon:"ðŸ“ž"},{number:3,title:"Location",icon:"ðŸ“"},{number:4,title:"Hours",icon:"ðŸ•"},{number:5,title:"Branding",icon:"ðŸŽ¨"}],U={enter:R=>({x:R>0?1e3:-1e3,opacity:0}),center:{zIndex:1,x:0,opacity:1},exit:R=>({zIndex:0,x:R<0?1e3:-1e3,opacity:0})};return o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 py-12 px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"max-w-4xl mx-auto",children:[o.jsxs(ct.div,{className:"text-center mb-8",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},children:[o.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Welcome to Afrimercato! ðŸŽ‰"}),o.jsx("p",{className:"text-lg text-gray-600",children:"Let's set up your store in just 5 easy steps"})]}),o.jsx(ct.div,{className:"mb-8",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:o.jsx("div",{className:"flex justify-between items-center",children:E.map((R,L)=>o.jsxs("div",{className:"flex items-center flex-1",children:[o.jsxs("div",{className:"flex flex-col items-center flex-1",children:[o.jsx(ct.div,{className:`w-12 h-12 rounded-full flex items-center justify-center text-2xl border-4 transition-all duration-300 ${t>=R.number?"bg-afri-green border-afri-green text-white":"bg-white border-gray-300 text-gray-400"}`,whileHover:{scale:1.1},animate:{scale:t===R.number?[1,1.1,1]:1},transition:{duration:.3},children:R.icon}),o.jsx("span",{className:`mt-2 text-xs font-medium ${t>=R.number?"text-afri-green":"text-gray-400"}`,children:R.title})]}),L<E.length-1&&o.jsx("div",{className:`h-1 flex-1 mx-2 rounded transition-all duration-300 ${t>R.number?"bg-afri-green":"bg-gray-300"}`})]},R.number))})}),o.jsxs(ct.div,{className:"bg-white rounded-2xl shadow-xl p-8",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.5,delay:.3},children:[l&&o.jsx(ct.div,{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-6 rounded",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:o.jsx("p",{className:"text-red-700",children:l})}),o.jsxs(l2,{mode:"wait",custom:t,children:[t===1&&o.jsxs(ct.div,{custom:1,variants:U,initial:"enter",animate:"center",exit:"exit",transition:{duration:.3},className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Tell us about your store"}),o.jsx("p",{className:"text-gray-600",children:"This information will help customers find and learn about your business"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Store Name *"}),o.jsx("input",{type:"text",name:"storeName",value:d.storeName,onChange:p,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"e.g., Fresh Valley Farms"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Store Description *"}),o.jsx("textarea",{name:"description",value:d.description,onChange:p,rows:"4",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"Describe what makes your store special..."})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Store Category *"}),o.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:x.map(R=>o.jsxs(ct.button,{type:"button",onClick:()=>g(L=>({...L,category:R.value})),className:`p-4 rounded-lg border-2 transition-all ${d.category===R.value?"border-afri-green bg-afri-green/10 text-afri-green":"border-gray-200 hover:border-gray-300"}`,whileHover:{scale:1.05},whileTap:{scale:.95},children:[o.jsx("div",{className:"text-3xl mb-1",children:R.icon}),o.jsx("div",{className:"text-xs font-medium",children:R.label})]},R.value))})]})]},"step1"),t===2&&o.jsxs(ct.div,{custom:2,variants:U,initial:"enter",animate:"center",exit:"exit",transition:{duration:.3},className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Contact Information"}),o.jsx("p",{className:"text-gray-600",children:"How can customers reach you?"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Primary Phone Number *"}),o.jsx("input",{type:"tel",name:"phone",value:d.phone,onChange:p,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"+234-800-555-0001"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Alternative Phone (Optional)"}),o.jsx("input",{type:"tel",name:"alternativePhone",value:d.alternativePhone,onChange:p,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"+234-800-555-0002"})]})]},"step2"),t===3&&o.jsxs(ct.div,{custom:3,variants:U,initial:"enter",animate:"center",exit:"exit",transition:{duration:.3},className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Where are you located?"}),o.jsx("p",{className:"text-gray-600",children:"Your business address"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Street Address *"}),o.jsx("input",{type:"text",name:"address.street",value:d.address.street,onChange:p,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"123 Main Street"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City *"}),o.jsx("input",{type:"text",name:"address.city",value:d.address.city,onChange:p,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"Lagos"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"State *"}),o.jsx("input",{type:"text",name:"address.state",value:d.address.state,onChange:p,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"Lagos State"})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Country"}),o.jsx("input",{type:"text",name:"address.country",value:d.address.country,onChange:p,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition bg-gray-50",readOnly:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Postal Code"}),o.jsx("input",{type:"text",name:"address.postalCode",value:d.address.postalCode,onChange:p,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"100001"})]})]})]},"step3"),t===4&&o.jsxs(ct.div,{custom:4,variants:U,initial:"enter",animate:"center",exit:"exit",transition:{duration:.3},className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"When are you open?"}),o.jsx("p",{className:"text-gray-600",children:"Set your business hours for each day"})]}),o.jsx("div",{className:"space-y-4",children:Object.keys(d.businessHours).map(R=>o.jsxs("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-lg",children:[o.jsx("div",{className:"w-28",children:o.jsx("span",{className:"font-medium text-gray-700 capitalize",children:R})}),o.jsx("input",{type:"checkbox",checked:!d.businessHours[R].closed,onChange:L=>v(R,"closed",!L.target.checked),className:"h-5 w-5 text-afri-green focus:ring-afri-green border-gray-300 rounded"}),d.businessHours[R].closed?o.jsx("span",{className:"text-gray-400 italic",children:"Closed"}):o.jsxs(o.Fragment,{children:[o.jsx("input",{type:"time",value:d.businessHours[R].open,onChange:L=>v(R,"open",L.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent"}),o.jsx("span",{className:"text-gray-500",children:"to"}),o.jsx("input",{type:"time",value:d.businessHours[R].close,onChange:L=>v(R,"close",L.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent"})]})]},R))})]},"step4"),t===5&&o.jsxs(ct.div,{custom:5,variants:U,initial:"enter",animate:"center",exit:"exit",transition:{duration:.3},className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Make it yours!"}),o.jsx("p",{className:"text-gray-600",children:"Upload your logo and we'll extract your brand colors automatically"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Store Logo"}),o.jsxs("div",{className:"flex items-center gap-6",children:[d.logoPreview?o.jsxs(ct.div,{className:"relative",initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200},children:[o.jsx("img",{src:d.logoPreview,alt:"Logo preview",className:"w-32 h-32 rounded-lg object-cover border-4 border-gray-200"}),o.jsx(ct.button,{type:"button",onClick:()=>g(R=>({...R,logo:null,logoPreview:null})),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 shadow-lg",whileHover:{scale:1.1},whileTap:{scale:.9},children:o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):o.jsxs(ct.button,{type:"button",onClick:()=>{var R;return(R=f.current)==null?void 0:R.click()},className:"w-32 h-32 border-2 border-dashed border-gray-300 rounded-lg flex flex-col items-center justify-center hover:border-afri-green hover:bg-afri-green/5 transition-all",whileHover:{scale:1.05},whileTap:{scale:.95},children:[o.jsx("svg",{className:"w-8 h-8 text-gray-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),o.jsx("span",{className:"text-xs text-gray-500",children:"Upload Logo"})]}),o.jsx("input",{ref:f,type:"file",accept:"image/*",onChange:w,className:"hidden"}),d.logoPreview&&o.jsxs(ct.div,{className:"flex-1",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:[o.jsx("p",{className:"text-sm font-medium text-gray-700 mb-3",children:"Extracted Brand Colors:"}),o.jsxs("div",{className:"flex gap-4",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"h-16 rounded-lg shadow-md mb-2 border-2 border-white",style:{backgroundColor:d.brandColors.primary}}),o.jsx("p",{className:"text-xs text-gray-600 text-center font-mono",children:d.brandColors.primary}),o.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Primary"})]}),o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"h-16 rounded-lg shadow-md mb-2 border-2 border-white",style:{backgroundColor:d.brandColors.secondary}}),o.jsx("p",{className:"text-xs text-gray-600 text-center font-mono",children:d.brandColors.secondary}),o.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Secondary"})]})]})]})]}),o.jsx("p",{className:"mt-3 text-sm text-gray-500",children:"Upload a square image (recommended: 500x500px, max 5MB)"})]}),o.jsxs(ct.div,{className:"bg-gradient-to-r from-afri-green/10 to-afri-yellow/10 p-6 rounded-lg border border-afri-green/20",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:[o.jsx("h4",{className:"font-bold text-gray-900 mb-2",children:"You're all set! ðŸŽ‰"}),o.jsx("p",{className:"text-gray-600 text-sm",children:'Click "Complete Setup" to create your vendor profile and start selling on Afrimercato!'})]})]},"step5")]}),o.jsxs("div",{className:"flex justify-between mt-8 pt-6 border-t",children:[o.jsx(ct.button,{type:"button",onClick:b,disabled:t===1,className:`px-6 py-3 rounded-lg font-medium transition-all ${t===1?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,whileHover:t!==1?{scale:1.05}:{},whileTap:t!==1?{scale:.95}:{},children:"â† Previous"}),t<5?o.jsx(ct.button,{type:"button",onClick:S,className:"px-8 py-3 bg-gradient-to-r from-afri-green to-afri-green-dark text-white rounded-lg font-semibold hover:from-afri-green-dark hover:to-afri-green transition-all shadow-lg",whileHover:{scale:1.05},whileTap:{scale:.95},children:"Next â†’"}):o.jsx(ct.button,{type:"button",onClick:A,disabled:a,className:"px-8 py-3 bg-gradient-to-r from-afri-green to-afri-green-dark text-white rounded-lg font-semibold hover:from-afri-green-dark hover:to-afri-green transition-all shadow-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",whileHover:{scale:a?1:1.05},whileTap:{scale:a?1:.95},children:a?o.jsxs(o.Fragment,{children:[o.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating..."]}):o.jsx(o.Fragment,{children:"Complete Setup âœ¨"})})]})]}),o.jsx(ct.p,{className:"mt-6 text-center text-sm text-gray-500",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:"Need help? Contact our support team at support@afrimercato.com"})]})})},Qf=["#00B207","#FFD700","#FF6B6B","#4ECDC4","#95E1D3"];function op(){var v,_,S,b,A,E,U,R,L,C;const[e,r]=Te.useState(null),[t,n]=Te.useState(null),[a,s]=Te.useState(!0),[l,c]=Te.useState("7d"),[f,u]=Te.useState(!1),[d,g]=Te.useState(!1);Te.useEffect(()=>{x(),setTimeout(()=>u(!0),100)},[l]);const x=async()=>{try{s(!0);const[P,W]=await Promise.all([mr.getDashboardStats(),mr.getChartData({timeRange:l})]);P.success&&r(P.data),W.success&&n(W.data),g(!1)}catch(P){console.error("Dashboard error:",P),P.message&&P.message.includes("Vendor profile not found")&&g(!0)}finally{s(!1)}},p=()=>{g(!1),x()},w=({title:P,value:W,icon:k,trend:T,color:H,delay:G})=>o.jsx("div",{className:`bg-white rounded-xl shadow-lg p-6 transform transition-all duration-700 hover:scale-105 hover:shadow-2xl ${f?"translate-y-0 opacity-100":"translate-y-4 opacity-0"}`,style:{transitionDelay:`${G}ms`},children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"text-sm font-medium text-afri-gray-600 mb-1",children:P}),o.jsx("h3",{className:"text-3xl font-bold text-afri-gray-900",children:W}),T&&o.jsxs("div",{className:`flex items-center mt-2 text-sm ${T>=0?"text-green-600":"text-red-600"}`,children:[o.jsx("svg",{className:`w-4 h-4 mr-1 transform ${T>=0?"":"rotate-180"}`,fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M12 7a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0V8.414l-4.293 4.293a1 1 0 01-1.414 0L8 10.414l-4.293 4.293a1 1 0 01-1.414-1.414l5-5a1 1 0 011.414 0L11 10.586 14.586 7H12z",clipRule:"evenodd"})}),o.jsxs("span",{className:"font-semibold",children:[Math.abs(T),"%"]}),o.jsx("span",{className:"ml-1 text-afri-gray-500",children:"vs last period"})]})]}),o.jsx("div",{className:`w-16 h-16 rounded-full bg-gradient-to-br ${H} flex items-center justify-center text-white text-3xl shadow-lg transform transition-transform duration-300 hover:rotate-12`,children:k})]})});return d&&!a?o.jsx(sp,{onComplete:p}):a?o.jsx("div",{className:"flex justify-center items-center h-screen",children:o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"w-20 h-20 border-4 border-afri-green border-t-transparent rounded-full animate-spin"}),o.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:o.jsx("div",{className:"w-12 h-12 border-4 border-afri-yellow border-t-transparent rounded-full animate-spin"})})]})}):o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-afri-green to-afri-green-dark bg-clip-text text-transparent",children:"Dashboard"}),o.jsx("p",{className:"text-afri-gray-600 mt-2",children:"Welcome back! Here's what's happening with your store."})]}),o.jsx("div",{className:"mt-4 md:mt-0",children:o.jsx("div",{className:"inline-flex rounded-lg border border-gray-200 bg-white p-1 shadow-sm",children:["7d","30d","90d"].map(P=>o.jsx("button",{onClick:()=>c(P),className:`px-4 py-2 rounded-md font-medium transition-all duration-300 ${l===P?"bg-gradient-to-r from-afri-green to-afri-green-dark text-white shadow-md":"text-afri-gray-700 hover:bg-afri-gray-50"}`,children:P==="7d"?"Last 7 Days":P==="30d"?"Last 30 Days":"Last 90 Days"},P))})})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[o.jsx(w,{title:"Total Revenue",value:`Â£${((_=(v=e==null?void 0:e.revenue)==null?void 0:v.total)==null?void 0:_.toFixed(2))||"0.00"}`,icon:"ðŸ’°",trend:(S=e==null?void 0:e.revenue)==null?void 0:S.trend,color:"from-green-400 to-green-600",delay:0}),o.jsx(w,{title:"Total Orders",value:((b=e==null?void 0:e.orders)==null?void 0:b.total)||0,icon:"ðŸ›’",trend:(A=e==null?void 0:e.orders)==null?void 0:A.trend,color:"from-blue-400 to-blue-600",delay:100}),o.jsx(w,{title:"Total Products",value:((E=e==null?void 0:e.products)==null?void 0:E.total)||0,icon:"ðŸ“¦",trend:(U=e==null?void 0:e.products)==null?void 0:U.trend,color:"from-purple-400 to-purple-600",delay:200}),o.jsx(w,{title:"Average Order Value",value:`Â£${((L=(R=e==null?void 0:e.revenue)==null?void 0:R.avgOrderValue)==null?void 0:L.toFixed(2))||"0.00"}`,icon:"ðŸ“Š",trend:(C=e==null?void 0:e.revenue)==null?void 0:C.avgTrend,color:"from-yellow-400 to-yellow-600",delay:300})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 transform transition-all duration-500 hover:shadow-2xl",children:[o.jsxs("h3",{className:"text-lg font-semibold text-afri-gray-900 mb-4 flex items-center",children:[o.jsx("span",{className:"w-3 h-3 bg-gradient-to-r from-afri-green to-afri-green-dark rounded-full mr-2"}),"Revenue Trend"]}),o.jsx(ac,{width:"100%",height:300,children:o.jsxs(c2,{data:(t==null?void 0:t.revenueData)||[],children:[o.jsx("defs",{children:o.jsxs("linearGradient",{id:"revenueGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[o.jsx("stop",{offset:"5%",stopColor:"#00B207",stopOpacity:.8}),o.jsx("stop",{offset:"95%",stopColor:"#00B207",stopOpacity:.1})]})}),o.jsx(Vf,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),o.jsx(Gf,{dataKey:"date",stroke:"#6B7280"}),o.jsx($f,{stroke:"#6B7280"}),o.jsx(ic,{contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"}}),o.jsx(Yf,{}),o.jsx(f2,{type:"monotone",dataKey:"revenue",stroke:"#00B207",strokeWidth:3,fill:"url(#revenueGradient)",dot:{fill:"#00B207",r:5},activeDot:{r:8,stroke:"#FFD700",strokeWidth:2}})]})})]}),o.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 transform transition-all duration-500 hover:shadow-2xl",children:[o.jsxs("h3",{className:"text-lg font-semibold text-afri-gray-900 mb-4 flex items-center",children:[o.jsx("span",{className:"w-3 h-3 bg-gradient-to-r from-blue-400 to-blue-600 rounded-full mr-2"}),"Orders Overview"]}),o.jsx(ac,{width:"100%",height:300,children:o.jsxs(h2,{data:(t==null?void 0:t.ordersData)||[],children:[o.jsx("defs",{children:o.jsxs("linearGradient",{id:"ordersGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[o.jsx("stop",{offset:"5%",stopColor:"#3B82F6",stopOpacity:.8}),o.jsx("stop",{offset:"95%",stopColor:"#3B82F6",stopOpacity:.3})]})}),o.jsx(Vf,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),o.jsx(Gf,{dataKey:"date",stroke:"#6B7280"}),o.jsx($f,{stroke:"#6B7280"}),o.jsx(ic,{contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"}}),o.jsx(Yf,{}),o.jsx(u2,{dataKey:"orders",fill:"url(#ordersGradient)",radius:[8,8,0,0]})]})})]})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 transform transition-all duration-500 hover:shadow-2xl",children:[o.jsxs("h3",{className:"text-lg font-semibold text-afri-gray-900 mb-4 flex items-center",children:[o.jsx("span",{className:"w-3 h-3 bg-gradient-to-r from-purple-400 to-purple-600 rounded-full mr-2"}),"Order Status Distribution"]}),o.jsx(ac,{width:"100%",height:300,children:o.jsxs(d2,{children:[o.jsx(p2,{data:(t==null?void 0:t.orderStatusData)||[],cx:"50%",cy:"50%",labelLine:!1,label:({name:P,percent:W})=>`${P}: ${(W*100).toFixed(0)}%`,outerRadius:100,fill:"#8884d8",dataKey:"value",animationBegin:0,animationDuration:800,children:((t==null?void 0:t.orderStatusData)||[]).map((P,W)=>o.jsx(m2,{fill:Qf[W%Qf.length]},`cell-${W}`))}),o.jsx(ic,{})]})})]}),o.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 transform transition-all duration-500 hover:shadow-2xl",children:[o.jsxs("h3",{className:"text-lg font-semibold text-afri-gray-900 mb-4 flex items-center",children:[o.jsx("span",{className:"w-3 h-3 bg-gradient-to-r from-afri-yellow to-afri-yellow-dark rounded-full mr-2"}),"Top Selling Products"]}),o.jsx("div",{className:"space-y-3",children:((e==null?void 0:e.topProducts)||[]).slice(0,5).map((P,W)=>{var k;return o.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-gradient-to-r from-afri-gray-50 to-white hover:from-afri-green hover:to-afri-green-dark hover:text-white transition-all duration-300 cursor-pointer group",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-afri-green to-afri-green-dark text-white flex items-center justify-center font-bold group-hover:scale-110 transition-transform",children:W+1}),o.jsxs("div",{children:[o.jsx("p",{className:"font-medium group-hover:text-white",children:P.name}),o.jsxs("p",{className:"text-sm text-afri-gray-500 group-hover:text-white group-hover:opacity-80",children:[P.soldQuantity," sold"]})]})]}),o.jsxs("span",{className:"font-bold text-afri-green group-hover:text-white",children:["Â£",(k=P.revenue)==null?void 0:k.toFixed(2)]})]},P._id)})})]})]}),o.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 transform transition-all duration-500 hover:shadow-2xl",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("h3",{className:"text-lg font-semibold text-afri-gray-900 flex items-center",children:[o.jsx("span",{className:"w-3 h-3 bg-gradient-to-r from-afri-green to-afri-green-dark rounded-full mr-2"}),"Recent Orders"]}),o.jsxs(Et,{to:"/orders",className:"text-afri-green hover:text-afri-green-dark font-medium transition-colors duration-200 flex items-center group",children:["View All",o.jsx("svg",{className:"w-4 h-4 ml-1 transform group-hover:translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full",children:[o.jsx("thead",{className:"bg-afri-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Order #"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Customer"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Total"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Status"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Date"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:((e==null?void 0:e.recentOrders)||[]).slice(0,5).map(P=>{var W,k,T;return o.jsxs("tr",{className:"hover:bg-gradient-to-r hover:from-afri-gray-50 hover:to-white transition-all duration-200 cursor-pointer",children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-afri-gray-900",children:P.orderNumber}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-afri-gray-500",children:((W=P.customer)==null?void 0:W.name)||"N/A"}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-afri-green",children:["Â£",((T=(k=P.pricing)==null?void 0:k.total)==null?void 0:T.toFixed(2))||"0.00"]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-gradient-to-r from-afri-green to-afri-green-dark text-white",children:P.status})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-afri-gray-500",children:new Date(P.createdAt).toLocaleDateString()})]},P._id)})})]})})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsx(Et,{to:"/products",className:"bg-gradient-to-br from-afri-green to-afri-green-dark text-white rounded-xl shadow-lg p-6 transform transition-all duration-300 hover:scale-105 hover:shadow-2xl group",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"text-lg font-semibold mb-2",children:"Manage Products"}),o.jsx("p",{className:"text-sm opacity-90",children:"Add, edit, or remove products"})]}),o.jsx("svg",{className:"w-10 h-10 opacity-75 group-hover:scale-110 transition-transform",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{d:"M3 1a1 1 0 000 2h1.22l.305 1.222a.997.997 0 00.01.042l1.358 5.43-.893.892C3.74 11.846 4.632 14 6.414 14H15a1 1 0 000-2H6.414l1-1H14a1 1 0 00.894-.553l3-6A1 1 0 0017 3H6.28l-.31-1.243A1 1 0 005 1H3zM16 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM6.5 18a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"})})]})}),o.jsx(Et,{to:"/orders",className:"bg-gradient-to-br from-blue-500 to-blue-700 text-white rounded-xl shadow-lg p-6 transform transition-all duration-300 hover:scale-105 hover:shadow-2xl group",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"text-lg font-semibold mb-2",children:"Process Orders"}),o.jsx("p",{className:"text-sm opacity-90",children:"View and manage orders"})]}),o.jsxs("svg",{className:"w-10 h-10 opacity-75 group-hover:scale-110 transition-transform",fill:"currentColor",viewBox:"0 0 20 20",children:[o.jsx("path",{d:"M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"}),o.jsx("path",{fillRule:"evenodd",d:"M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm9.707 5.707a1 1 0 00-1.414-1.414L9 12.586l-1.293-1.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})]})]})}),o.jsx(Et,{to:"/reports",className:"bg-gradient-to-br from-purple-500 to-purple-700 text-white rounded-xl shadow-lg p-6 transform transition-all duration-300 hover:scale-105 hover:shadow-2xl group",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"text-lg font-semibold mb-2",children:"View Reports"}),o.jsx("p",{className:"text-sm opacity-90",children:"Analytics and insights"})]}),o.jsx("svg",{className:"w-10 h-10 opacity-75 group-hover:scale-110 transition-transform",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{d:"M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z"})})]})})]})]})}const lp=["fruits","vegetables","grains","dairy","meat","fish","poultry","bakery","beverages","spices","snacks","household","beauty","other"],cp=["kg","g","lb","piece","bunch","pack","liter","ml","dozen"];function fp({product:e,onClose:r,onSave:t}){const[n,a]=Te.useState({name:"",description:"",category:"fruits",price:"",originalPrice:"",unit:"kg",stock:"",lowStockThreshold:10,inStock:!0,isActive:!0}),[s,l]=Te.useState([]),[c,f]=Te.useState([]),[u,d]=Te.useState(!1),[g,x]=Te.useState({});Te.useEffect(()=>{e&&(a({name:e.name||"",description:e.description||"",category:e.category||"fruits",price:e.price||"",originalPrice:e.originalPrice||"",unit:e.unit||"kg",stock:e.stock||"",lowStockThreshold:e.lowStockThreshold||10,inStock:e.inStock!==void 0?e.inStock:!0,isActive:e.isActive!==void 0?e.isActive:!0}),e.images&&e.images.length>0&&f(e.images.map(b=>b.url)))},[e]);const p=b=>{const{name:A,value:E,type:U,checked:R}=b.target;a(L=>({...L,[A]:U==="checkbox"?R:E})),g[A]&&x(L=>({...L,[A]:""}))},w=b=>{const A=Array.from(b.target.files);if(A.length>5){alert("You can only upload up to 5 images");return}l(A);const E=A.map(U=>URL.createObjectURL(U));f(E)},v=b=>{l(A=>A.filter((E,U)=>U!==b)),f(A=>A.filter((E,U)=>U!==b))},_=()=>{const b={};return n.name.trim()||(b.name="Product name is required"),n.description.trim()||(b.description="Description is required"),(!n.price||n.price<=0)&&(b.price="Valid price is required"),(!n.stock||n.stock<0)&&(b.stock="Valid stock quantity is required"),x(b),Object.keys(b).length===0},S=async b=>{var A,E;if(b.preventDefault(),!!_())try{d(!0);let U=(e==null?void 0:e.images)||[];if(s.length>0){const C=new FormData;s.forEach(W=>{C.append("productImages",W)});const P=await mr.uploadProductImages(C);P.success&&(U=P.data.images)}const R={...n,price:parseFloat(n.price),originalPrice:n.originalPrice?parseFloat(n.originalPrice):void 0,stock:parseInt(n.stock),lowStockThreshold:parseInt(n.lowStockThreshold),images:U};let L;e?L=await mr.updateProduct(e._id,R):L=await mr.createProduct(R),L.success&&(alert(e?"Product updated successfully!":"Product created successfully!"),t())}catch(U){console.error("Product save error:",U),alert(((E=(A=U.response)==null?void 0:A.data)==null?void 0:E.message)||"Failed to save product")}finally{d(!1)}};return o.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm transition-opacity",onClick:r}),o.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:o.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto transform transition-all animate-slideUp",children:[o.jsx("div",{className:"sticky top-0 bg-gradient-to-r from-afri-green to-afri-green-dark text-white px-6 py-4 rounded-t-2xl z-10",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h2",{className:"text-2xl font-bold",children:e?"Edit Product":"Add New Product"}),o.jsx("button",{onClick:r,className:"text-white hover:text-afri-yellow transition-colors p-2 hover:bg-white hover:bg-opacity-20 rounded-lg",children:o.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),o.jsxs("form",{onSubmit:S,className:"p-6 space-y-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:["Product Name ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",name:"name",value:n.name,onChange:p,className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all ${g.name?"border-red-500":"border-gray-300"}`,placeholder:"e.g., Fresh Organic Tomatoes"}),g.name&&o.jsx("p",{className:"mt-1 text-sm text-red-500",children:g.name})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:["Description ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("textarea",{name:"description",value:n.description,onChange:p,rows:4,className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all ${g.description?"border-red-500":"border-gray-300"}`,placeholder:"Describe your product..."}),g.description&&o.jsx("p",{className:"mt-1 text-sm text-red-500",children:g.description})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Category"}),o.jsx("select",{name:"category",value:n.category,onChange:p,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all",children:lp.map(b=>o.jsx("option",{value:b,children:b.charAt(0).toUpperCase()+b.slice(1)},b))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Unit"}),o.jsx("select",{name:"unit",value:n.unit,onChange:p,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all",children:cp.map(b=>o.jsx("option",{value:b,children:b},b))})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:["Price (Â£) ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"number",name:"price",value:n.price,onChange:p,step:"0.01",min:"0",className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all ${g.price?"border-red-500":"border-gray-300"}`,placeholder:"0.00"}),g.price&&o.jsx("p",{className:"mt-1 text-sm text-red-500",children:g.price})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Original Price (Â£)"}),o.jsx("input",{type:"number",name:"originalPrice",value:n.originalPrice,onChange:p,step:"0.01",min:"0",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all",placeholder:"0.00 (optional)"}),o.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"For showing discounts"})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:["Stock Quantity ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"number",name:"stock",value:n.stock,onChange:p,min:"0",className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all ${g.stock?"border-red-500":"border-gray-300"}`,placeholder:"0"}),g.stock&&o.jsx("p",{className:"mt-1 text-sm text-red-500",children:g.stock})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Low Stock Alert"}),o.jsx("input",{type:"number",name:"lowStockThreshold",value:n.lowStockThreshold,onChange:p,min:"0",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all",placeholder:"10"}),o.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Get alert when stock is below this number"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Product Images"}),o.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 hover:border-afri-green transition-colors",children:[o.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:w,className:"hidden",id:"product-images"}),o.jsxs("label",{htmlFor:"product-images",className:"flex flex-col items-center cursor-pointer text-center",children:[o.jsx("svg",{className:"w-12 h-12 text-gray-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),o.jsx("p",{className:"text-sm text-gray-600",children:"Click to upload images (max 5)"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"PNG, JPG, GIF up to 10MB"})]})]}),c.length>0&&o.jsx("div",{className:"mt-4 grid grid-cols-5 gap-4",children:c.map((b,A)=>o.jsxs("div",{className:"relative group",children:[o.jsx("img",{src:b,alt:`Preview ${A+1}`,className:"w-full h-24 object-cover rounded-lg border-2 border-gray-200 group-hover:border-afri-green transition-all"}),o.jsx("button",{type:"button",onClick:()=>v(A),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity shadow-lg hover:bg-red-600",children:o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},A))})]}),o.jsxs("div",{className:"flex items-center space-x-6",children:[o.jsxs("label",{className:"flex items-center cursor-pointer",children:[o.jsx("input",{type:"checkbox",name:"inStock",checked:n.inStock,onChange:p,className:"w-5 h-5 text-afri-green border-gray-300 rounded focus:ring-afri-green cursor-pointer"}),o.jsx("span",{className:"ml-2 text-sm font-medium text-afri-gray-900",children:"In Stock"})]}),o.jsxs("label",{className:"flex items-center cursor-pointer",children:[o.jsx("input",{type:"checkbox",name:"isActive",checked:n.isActive,onChange:p,className:"w-5 h-5 text-afri-green border-gray-300 rounded focus:ring-afri-green cursor-pointer"}),o.jsx("span",{className:"ml-2 text-sm font-medium text-afri-gray-900",children:"Active"})]})]}),o.jsxs("div",{className:"flex items-center justify-end space-x-4 pt-6 border-t",children:[o.jsx("button",{type:"button",onClick:r,className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-all",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:u,className:"px-6 py-3 bg-gradient-to-r from-afri-green to-afri-green-dark text-white rounded-lg font-semibold shadow-lg hover:shadow-xl transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center",children:u?o.jsxs(o.Fragment,{children:[o.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):o.jsx(o.Fragment,{children:e?"Update Product":"Create Product"})})]})]})]})}),o.jsx("style",{jsx:!0,children:`
        @keyframes slideUp {
          from {
            opacity: 0;
            transform: translateY(20px) scale(0.95);
          }
          to {
            opacity: 1;
            transform: translateY(0) scale(1);
          }
        }

        .animate-slideUp {
          animation: slideUp 0.3s ease-out;
        }
      `})]})}function hp({selectedProducts:e,onClose:r,onComplete:t}){const[n,a]=Te.useState("delete"),[s,l]=Te.useState({isActive:!0,priceType:"percentage",priceValue:"",stockType:"adjust",stockValue:""}),[c,f]=Te.useState(!1),u=async g=>{var x,p;g.preventDefault(),f(!0);try{let w;switch(n){case"delete":if(!confirm(`Delete ${e.length} products? This cannot be undone.`)){f(!1);return}w=await mr.bulkDeleteProducts({productIds:e});break;case"status":w=await mr.bulkUpdateStatus({productIds:e,isActive:s.isActive});break;case"price":if(!s.priceValue||s.priceValue==="0"){alert("Please enter a valid price value"),f(!1);return}w=await mr.bulkUpdatePrices({productIds:e,type:s.priceType,value:parseFloat(s.priceValue)});break;case"stock":if(!s.stockValue||s.stockValue==="0"){alert("Please enter a valid stock value"),f(!1);return}w=await mr.bulkUpdateStock({productIds:e,type:s.stockType,value:parseInt(s.stockValue)});break;default:throw new Error("Invalid action")}w.success&&(alert(`Successfully updated ${e.length} products!`),t())}catch(w){console.error("Bulk action error:",w),alert(((p=(x=w.response)==null?void 0:x.data)==null?void 0:p.message)||"Failed to perform bulk action")}finally{f(!1)}},d=()=>{switch(n){case"delete":return o.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-start",children:[o.jsx("svg",{className:"w-6 h-6 text-red-600 mt-0.5 mr-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-semibold text-red-900 mb-1",children:"Warning: Permanent Deletion"}),o.jsxs("p",{className:"text-sm text-red-700",children:["You are about to delete ",o.jsxs("span",{className:"font-bold",children:[e.length," products"]}),". This action cannot be undone."]})]})]})});case"status":return o.jsxs("div",{className:"space-y-4",children:[o.jsxs("p",{className:"text-sm text-afri-gray-600",children:["Change status for ",o.jsxs("span",{className:"font-semibold",children:[e.length," products"]})]}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs("label",{className:"flex items-center cursor-pointer",children:[o.jsx("input",{type:"radio",name:"status",checked:s.isActive===!0,onChange:()=>l({...s,isActive:!0}),className:"w-5 h-5 text-afri-green border-gray-300 focus:ring-afri-green cursor-pointer"}),o.jsx("span",{className:"ml-2 text-sm font-medium text-afri-gray-900",children:"Activate"})]}),o.jsxs("label",{className:"flex items-center cursor-pointer",children:[o.jsx("input",{type:"radio",name:"status",checked:s.isActive===!1,onChange:()=>l({...s,isActive:!1}),className:"w-5 h-5 text-afri-green border-gray-300 focus:ring-afri-green cursor-pointer"}),o.jsx("span",{className:"ml-2 text-sm font-medium text-afri-gray-900",children:"Deactivate"})]})]})]});case"price":return o.jsxs("div",{className:"space-y-4",children:[o.jsxs("p",{className:"text-sm text-afri-gray-600",children:["Update prices for ",o.jsxs("span",{className:"font-semibold",children:[e.length," products"]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-afri-gray-700 mb-2",children:"Update Type"}),o.jsxs("select",{value:s.priceType,onChange:g=>l({...s,priceType:g.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent",children:[o.jsx("option",{value:"percentage",children:"Percentage (%)"}),o.jsx("option",{value:"fixed",children:"Fixed Amount (Â£)"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-afri-gray-700 mb-2",children:s.priceType==="percentage"?"Percentage":"Amount (Â£)"}),o.jsx("input",{type:"number",step:"0.01",value:s.priceValue,onChange:g=>l({...s,priceValue:g.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent",placeholder:"0.00"})]})]}),o.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:o.jsx("p",{className:"text-sm text-blue-800",children:s.priceType==="percentage"?o.jsxs(o.Fragment,{children:[s.priceValue>0?"Increase":"Decrease"," prices by"," ",o.jsxs("span",{className:"font-bold",children:[Math.abs(s.priceValue),"%"]})]}):o.jsxs(o.Fragment,{children:[s.priceValue>0?"Add":"Subtract"," ",o.jsxs("span",{className:"font-bold",children:["Â£",Math.abs(s.priceValue)]})," to/from prices"]})})})]});case"stock":return o.jsxs("div",{className:"space-y-4",children:[o.jsxs("p",{className:"text-sm text-afri-gray-600",children:["Update stock for ",o.jsxs("span",{className:"font-semibold",children:[e.length," products"]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-afri-gray-700 mb-2",children:"Update Type"}),o.jsxs("select",{value:s.stockType,onChange:g=>l({...s,stockType:g.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent",children:[o.jsx("option",{value:"adjust",children:"Adjust (+/-)"}),o.jsx("option",{value:"set",children:"Set to Value"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-afri-gray-700 mb-2",children:"Quantity"}),o.jsx("input",{type:"number",value:s.stockValue,onChange:g=>l({...s,stockValue:g.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent",placeholder:"0"})]})]}),o.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:o.jsx("p",{className:"text-sm text-blue-800",children:s.stockType==="adjust"?o.jsxs(o.Fragment,{children:[s.stockValue>0?"Add":"Remove"," ",o.jsx("span",{className:"font-bold",children:Math.abs(s.stockValue)})," units"]}):o.jsxs(o.Fragment,{children:["Set stock to ",o.jsx("span",{className:"font-bold",children:s.stockValue})," units"]})})})]});default:return null}};return o.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm transition-opacity",onClick:r}),o.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:o.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl max-w-2xl w-full transform transition-all animate-slideUp",children:[o.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white px-6 py-4 rounded-t-2xl",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h2",{className:"text-2xl font-bold",children:"Bulk Actions"}),o.jsx("button",{onClick:r,className:"text-white hover:text-afri-yellow transition-colors p-2 hover:bg-white hover:bg-opacity-20 rounded-lg",children:o.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),o.jsxs("p",{className:"text-sm opacity-90 mt-1",children:[e.length," product",e.length>1?"s":""," selected"]})]}),o.jsxs("form",{onSubmit:u,className:"p-6 space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-3",children:"Select Action"}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("button",{type:"button",onClick:()=>a("delete"),className:`p-4 rounded-lg border-2 transition-all transform hover:scale-105 ${n==="delete"?"border-red-500 bg-red-50 shadow-lg":"border-gray-200 hover:border-gray-300"}`,children:[o.jsx("div",{className:"text-3xl mb-2",children:"ðŸ—‘ï¸"}),o.jsx("div",{className:"font-semibold text-afri-gray-900",children:"Delete"}),o.jsx("div",{className:"text-xs text-afri-gray-500 mt-1",children:"Remove products"})]}),o.jsxs("button",{type:"button",onClick:()=>a("status"),className:`p-4 rounded-lg border-2 transition-all transform hover:scale-105 ${n==="status"?"border-afri-green bg-green-50 shadow-lg":"border-gray-200 hover:border-gray-300"}`,children:[o.jsx("div",{className:"text-3xl mb-2",children:"ðŸ”„"}),o.jsx("div",{className:"font-semibold text-afri-gray-900",children:"Status"}),o.jsx("div",{className:"text-xs text-afri-gray-500 mt-1",children:"Activate/Deactivate"})]}),o.jsxs("button",{type:"button",onClick:()=>a("price"),className:`p-4 rounded-lg border-2 transition-all transform hover:scale-105 ${n==="price"?"border-blue-500 bg-blue-50 shadow-lg":"border-gray-200 hover:border-gray-300"}`,children:[o.jsx("div",{className:"text-3xl mb-2",children:"ðŸ’°"}),o.jsx("div",{className:"font-semibold text-afri-gray-900",children:"Price"}),o.jsx("div",{className:"text-xs text-afri-gray-500 mt-1",children:"Update prices"})]}),o.jsxs("button",{type:"button",onClick:()=>a("stock"),className:`p-4 rounded-lg border-2 transition-all transform hover:scale-105 ${n==="stock"?"border-purple-500 bg-purple-50 shadow-lg":"border-gray-200 hover:border-gray-300"}`,children:[o.jsx("div",{className:"text-3xl mb-2",children:"ðŸ“¦"}),o.jsx("div",{className:"font-semibold text-afri-gray-900",children:"Stock"}),o.jsx("div",{className:"text-xs text-afri-gray-500 mt-1",children:"Adjust inventory"})]})]})]}),o.jsx("div",{className:"border-t pt-6",children:d()}),o.jsxs("div",{className:"flex items-center justify-end space-x-4 pt-6 border-t",children:[o.jsx("button",{type:"button",onClick:r,className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-all",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:c,className:`px-6 py-3 text-white rounded-lg font-semibold shadow-lg hover:shadow-xl transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center ${n==="delete"?"bg-gradient-to-r from-red-600 to-red-700":"bg-gradient-to-r from-afri-green to-afri-green-dark"}`,children:c?o.jsxs(o.Fragment,{children:[o.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):`Apply to ${e.length} Product${e.length>1?"s":""}`})]})]})]})}),o.jsx("style",{jsx:!0,children:`
        @keyframes slideUp {
          from {
            opacity: 0;
            transform: translateY(20px) scale(0.95);
          }
          to {
            opacity: 1;
            transform: translateY(0) scale(1);
          }
        }

        .animate-slideUp {
          animation: slideUp 0.3s ease-out;
        }
      `})]})}const up=["fruits","vegetables","grains","dairy","meat","fish","poultry","bakery","beverages","spices","snacks","household","beauty","other"];function dp(){const[e,r]=Te.useState([]),[t,n]=Te.useState(!0),[a,s]=Te.useState(!1),[l,c]=Te.useState(!1),[f,u]=Te.useState(null),[d,g]=Te.useState([]),[x,p]=Te.useState({search:"",category:"",status:"",page:1,limit:20}),[w,v]=Te.useState({});Te.useEffect(()=>{_()},[x]);const _=async()=>{try{n(!0);const C=await mr.getProducts(x);C.success&&(r(C.data.products),v(C.data.pagination))}catch(C){console.error("Error fetching products:",C)}finally{n(!1)}},S=()=>{u(null),s(!0)},b=C=>{u(C),s(!0)},A=async C=>{var P,W;if(confirm("Are you sure you want to delete this product?"))try{(await mr.deleteProduct(C)).success&&(_(),alert("Product deleted successfully!"))}catch(k){alert(((W=(P=k.response)==null?void 0:P.data)==null?void 0:W.message)||"Failed to delete product")}},E=C=>{g(P=>P.includes(C)?P.filter(W=>W!==C):[...P,C])},U=()=>{d.length===e.length?g([]):g(e.map(C=>C._id))},R=()=>{if(d.length===0){alert("Please select products first");return}c(!0)},L=C=>C.inStock?C.stock<=C.lowStockThreshold?o.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800",children:"Low Stock"}):o.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800",children:"In Stock"}):o.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800",children:"Out of Stock"});return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-afri-green to-afri-green-dark bg-clip-text text-transparent",children:"Products"}),o.jsx("p",{className:"text-afri-gray-600 mt-2",children:"Manage your inventory and product listings"})]}),o.jsxs("button",{onClick:S,className:"mt-4 md:mt-0 bg-gradient-to-r from-afri-green to-afri-green-dark text-white px-6 py-3 rounded-lg font-semibold shadow-lg transform transition-all duration-300 hover:scale-105 hover:shadow-xl flex items-center group",children:[o.jsx("svg",{className:"w-5 h-5 mr-2 transform group-hover:rotate-90 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Product"]})]}),o.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[o.jsx("div",{className:"md:col-span-2",children:o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"text",placeholder:"Search products...",value:x.search,onChange:C=>p({...x,search:C.target.value,page:1}),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all"}),o.jsx("svg",{className:"absolute left-3 top-3.5 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})}),o.jsxs("select",{value:x.category,onChange:C=>p({...x,category:C.target.value,page:1}),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all",children:[o.jsx("option",{value:"",children:"All Categories"}),up.map(C=>o.jsx("option",{value:C,children:C.charAt(0).toUpperCase()+C.slice(1)},C))]}),o.jsxs("select",{value:x.status,onChange:C=>p({...x,status:C.target.value,page:1}),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all",children:[o.jsx("option",{value:"",children:"All Status"}),o.jsx("option",{value:"active",children:"Active"}),o.jsx("option",{value:"inactive",children:"Inactive"}),o.jsx("option",{value:"low-stock",children:"Low Stock"}),o.jsx("option",{value:"out-of-stock",children:"Out of Stock"})]})]}),d.length>0&&o.jsxs("div",{className:"mt-4 p-4 bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg border border-blue-200 flex items-center justify-between animate-slideDown",children:[o.jsx("div",{className:"flex items-center",children:o.jsxs("span",{className:"font-semibold text-blue-900",children:[d.length," products selected"]})}),o.jsx("button",{onClick:R,className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white px-4 py-2 rounded-lg font-medium hover:from-blue-700 hover:to-blue-800 transition-all transform hover:scale-105",children:"Bulk Actions"})]})]}),t?o.jsx("div",{className:"flex justify-center items-center h-64",children:o.jsx("div",{className:"relative",children:o.jsx("div",{className:"w-20 h-20 border-4 border-afri-green border-t-transparent rounded-full animate-spin"})})}):e.length===0?o.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-12 text-center",children:[o.jsx("svg",{className:"w-24 h-24 text-afri-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),o.jsx("h3",{className:"text-xl font-semibold text-afri-gray-900 mb-2",children:"No products found"}),o.jsx("p",{className:"text-afri-gray-500 mb-6",children:x.search||x.category||x.status?"Try adjusting your filters":"Get started by adding your first product"}),o.jsx("button",{onClick:S,className:"bg-gradient-to-r from-afri-green to-afri-green-dark text-white px-6 py-3 rounded-lg font-semibold shadow-lg hover:shadow-xl transition-all transform hover:scale-105",children:"Add Your First Product"})]}):o.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gradient-to-r from-afri-gray-50 to-afri-gray-100",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-4",children:o.jsx("input",{type:"checkbox",checked:d.length===e.length,onChange:U,className:"w-4 h-4 text-afri-green border-gray-300 rounded focus:ring-afri-green cursor-pointer"})}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-afri-gray-700 uppercase tracking-wider",children:"Product"}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-afri-gray-700 uppercase tracking-wider",children:"Category"}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-afri-gray-700 uppercase tracking-wider",children:"Price"}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-afri-gray-700 uppercase tracking-wider",children:"Stock"}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-afri-gray-700 uppercase tracking-wider",children:"Status"}),o.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-afri-gray-700 uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map((C,P)=>o.jsxs("tr",{className:"hover:bg-gradient-to-r hover:from-afri-gray-50 hover:to-white transition-all duration-200 animate-fadeIn",style:{animationDelay:`${P*50}ms`},children:[o.jsx("td",{className:"px-6 py-4",children:o.jsx("input",{type:"checkbox",checked:d.includes(C._id),onChange:()=>E(C._id),className:"w-4 h-4 text-afri-green border-gray-300 rounded focus:ring-afri-green cursor-pointer"})}),o.jsx("td",{className:"px-6 py-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"h-12 w-12 flex-shrink-0 rounded-lg overflow-hidden bg-afri-gray-100 shadow-sm",children:C.images&&C.images.length>0?o.jsx("img",{src:C.images[0].url,alt:C.name,className:"h-full w-full object-cover transform hover:scale-110 transition-transform duration-300"}):o.jsx("div",{className:"h-full w-full flex items-center justify-center text-afri-gray-400",children:"ðŸ“¦"})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("div",{className:"text-sm font-semibold text-afri-gray-900",children:C.name}),o.jsx("div",{className:"text-sm text-afri-gray-500",children:C.unit})]})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800",children:C.category})}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[o.jsxs("div",{className:"text-sm font-bold text-afri-green",children:["Â£",C.price.toFixed(2)]}),C.originalPrice&&C.originalPrice>C.price&&o.jsxs("div",{className:"text-xs text-gray-400 line-through",children:["Â£",C.originalPrice.toFixed(2)]})]}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[o.jsx("div",{className:"text-sm text-afri-gray-900 font-semibold",children:C.stock}),C.lowStockThreshold&&o.jsxs("div",{className:"text-xs text-gray-500",children:["Min: ",C.lowStockThreshold]})]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:L(C)}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:o.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[o.jsx("button",{onClick:()=>b(C),className:"text-blue-600 hover:text-blue-900 transition-colors p-2 hover:bg-blue-50 rounded-lg group",title:"Edit",children:o.jsx("svg",{className:"w-5 h-5 transform group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),o.jsx("button",{onClick:()=>A(C._id),className:"text-red-600 hover:text-red-900 transition-colors p-2 hover:bg-red-50 rounded-lg group",title:"Delete",children:o.jsx("svg",{className:"w-5 h-5 transform group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},C._id))})]})}),w.pages>1&&o.jsx("div",{className:"px-6 py-4 bg-gradient-to-r from-afri-gray-50 to-white border-t border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"text-sm text-afri-gray-700",children:["Showing ",o.jsx("span",{className:"font-semibold",children:(w.currentPage-1)*x.limit+1})," to"," ",o.jsx("span",{className:"font-semibold",children:Math.min(w.currentPage*x.limit,w.total)})," ","of ",o.jsx("span",{className:"font-semibold",children:w.total})," products"]}),o.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[o.jsx("button",{onClick:()=>p({...x,page:x.page-1}),disabled:w.currentPage===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:o.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),[...Array(w.pages)].map((C,P)=>o.jsx("button",{onClick:()=>p({...x,page:P+1}),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium transition-all ${w.currentPage===P+1?"z-10 bg-gradient-to-r from-afri-green to-afri-green-dark text-white border-afri-green":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:P+1},P)),o.jsx("button",{onClick:()=>p({...x,page:x.page+1}),disabled:w.currentPage===w.pages,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:o.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]})})]}),a&&o.jsx(fp,{product:f,onClose:()=>{s(!1),u(null)},onSave:()=>{_(),s(!1),u(null)}}),l&&o.jsx(hp,{selectedProducts:d,onClose:()=>c(!1),onComplete:()=>{_(),g([]),c(!1)}}),o.jsx("style",{jsx:!0,children:`
        @keyframes fadeIn {
          from {
            opacity: 0;
            transform: translateY(10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        @keyframes slideDown {
          from {
            opacity: 0;
            transform: translateY(-10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .animate-fadeIn {
          animation: fadeIn 0.5s ease-out forwards;
        }

        .animate-slideDown {
          animation: slideDown 0.3s ease-out;
        }
      `})]})}function pp({order:e,onPackingComplete:r,onStatusUpdate:t}){var v;const[n,a]=Te.useState([]),[s,l]=Te.useState({});Te.useEffect(()=>{const _=e.items.map(S=>({itemId:S._id||S.productId||S.name,name:S.name,quantity:S.quantity,unit:S.unit,packed:!1,pickedQuantity:0}));a(_)},[e.items]);const c=_=>{a(S=>S.map(b=>b.itemId===_?{...b,packed:!b.packed,pickedQuantity:b.packed?0:b.quantity}:b))},f=(_,S)=>{a(b=>b.map(A=>A.itemId===_?{...A,pickedQuantity:Math.max(0,Math.min(S,A.quantity))}:A))},u=(_,S)=>{l(b=>({...b,[_]:S}))},d=()=>{a(_=>_.map(S=>({...S,packed:!0,pickedQuantity:S.quantity})))},g=async()=>{!n.every(S=>S.packed)&&!window.confirm("Not all items are marked as packed. Are you sure you want to mark this order as ready?")||(r&&r(n),t&&await t("ready_for_pickup","All items packed and ready for pickup"))},x=n.filter(_=>_.packed).length,p=n.length,w=p>0?x/p*100:0;return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-gradient-to-br from-[#FFB300] to-[#FFA726] rounded-xl p-6 text-white shadow-lg",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-2xl font-bold",children:"Packing Checklist"}),o.jsxs("p",{className:"text-gray-900 mt-1",children:[x," of ",p," items packed"]})]}),o.jsxs("div",{className:"text-right",children:[o.jsxs("div",{className:"text-4xl font-bold",children:[Math.round(w),"%"]}),o.jsx("div",{className:"text-sm text-gray-900",children:"Complete"})]})]}),o.jsx("div",{className:"w-full bg-gray-900/20 rounded-full h-4 overflow-hidden shadow-inner",children:o.jsx("div",{className:"bg-gradient-to-r from-[#00897B] to-[#26A69A] h-full rounded-full transition-all duration-500 ease-out shadow-lg",style:{width:`${w}%`}})}),o.jsxs("div",{className:"mt-4 flex gap-3",children:[o.jsx("button",{onClick:d,className:"flex-1 bg-white text-gray-900 px-4 py-2 rounded-lg font-semibold shadow-md hover:shadow-lg transition-all transform hover:-translate-y-0.5",children:"âœ“ Mark All Packed"}),o.jsx("button",{onClick:g,disabled:x===0,className:"flex-1 bg-[#00897B] text-white px-4 py-2 rounded-lg font-semibold shadow-md hover:shadow-lg hover:bg-[#00695C] transition-all transform hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none",children:"ðŸ“¦ Ready for Pickup"})]})]}),((v=e.deliveryAddress)==null?void 0:v.instructions)&&o.jsx("div",{className:"bg-yellow-50 border-l-4 border-[#FFB300] rounded-lg p-4 shadow-sm",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("svg",{className:"w-5 h-5 text-[#FFB300] mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"Special Instructions"}),o.jsx("p",{className:"text-gray-700 text-sm",children:e.deliveryAddress.instructions})]})]})}),o.jsx("div",{className:"space-y-3",children:n.map((_,S)=>{const b=e.items[S];return o.jsx("div",{className:`
                bg-white rounded-xl p-5 shadow-md border-2 transition-all duration-300
                ${_.packed?"border-[#00897B] bg-green-50/50":"border-gray-200 hover:border-[#FFB300]"}
              `,children:o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("div",{className:"flex-shrink-0 pt-1",children:o.jsx("button",{onClick:()=>c(_.itemId),className:`
                      w-8 h-8 rounded-lg border-2 flex items-center justify-center
                      transition-all duration-200 transform hover:scale-110
                      ${_.packed?"bg-[#00897B] border-[#00897B] shadow-lg":"bg-white border-gray-300 hover:border-[#FFB300]"}
                    `,children:_.packed&&o.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-start justify-between gap-4 mb-3",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("h4",{className:`text-lg font-semibold ${_.packed?"text-[#00897B] line-through":"text-gray-900"}`,children:_.name}),o.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-1",children:[o.jsxs("span",{className:"text-sm text-gray-600",children:["Ordered: ",o.jsxs("span",{className:"font-semibold",children:[_.quantity," ",_.unit]})]}),b.price&&o.jsxs("span",{className:"text-sm text-gray-600",children:["Price: ",o.jsxs("span",{className:"font-semibold",children:["Â£",b.price.toFixed(2)]})]})]})]}),b.image&&o.jsx("img",{src:b.image,alt:_.name,className:"w-20 h-20 object-cover rounded-lg shadow-md"})]}),o.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[o.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Picked Quantity:"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:()=>f(_.itemId,_.pickedQuantity-1),disabled:_.pickedQuantity<=0,className:"w-8 h-8 rounded-lg bg-gray-200 hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed font-semibold transition-colors",children:"-"}),o.jsx("input",{type:"number",value:_.pickedQuantity,onChange:A=>f(_.itemId,parseInt(A.target.value)||0),className:"w-20 text-center px-2 py-1 border-2 border-gray-300 rounded-lg font-semibold focus:border-[#FFB300] focus:ring-2 focus:ring-[#FFB300]/20",min:"0",max:_.quantity}),o.jsx("button",{onClick:()=>f(_.itemId,_.pickedQuantity+1),disabled:_.pickedQuantity>=_.quantity,className:"w-8 h-8 rounded-lg bg-gray-200 hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed font-semibold transition-colors",children:"+"}),o.jsxs("span",{className:"text-sm text-gray-600",children:["/ ",_.quantity," ",_.unit]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes (optional)"}),o.jsx("input",{type:"text",value:s[_.itemId]||"",onChange:A=>u(_.itemId,A.target.value),placeholder:"E.g., substitution, quality issue...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-[#FFB300] focus:border-transparent"})]}),_.pickedQuantity>0&&_.pickedQuantity<_.quantity&&o.jsx("div",{className:"mt-2 p-2 bg-orange-50 border-l-4 border-orange-400 rounded",children:o.jsxs("p",{className:"text-xs text-orange-700",children:["âš ï¸ Short by ",_.quantity-_.pickedQuantity," ",_.unit]})})]})]})},_.itemId)})}),o.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-6 shadow-lg border border-gray-200",children:[o.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Packing Summary"}),o.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[o.jsxs("div",{className:"text-center p-3 bg-white rounded-lg shadow-sm",children:[o.jsx("div",{className:"text-2xl font-bold text-gray-900",children:p}),o.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Total Items"})]}),o.jsxs("div",{className:"text-center p-3 bg-white rounded-lg shadow-sm",children:[o.jsx("div",{className:"text-2xl font-bold text-[#00897B]",children:x}),o.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Packed"})]}),o.jsxs("div",{className:"text-center p-3 bg-white rounded-lg shadow-sm",children:[o.jsx("div",{className:"text-2xl font-bold text-orange-600",children:p-x}),o.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Remaining"})]})]})]}),o.jsx("div",{className:"sticky bottom-0 bg-white border-t-2 border-gray-200 p-4 -mx-6 -mb-6 rounded-b-xl shadow-lg",children:o.jsx("button",{onClick:g,disabled:x===0,className:`
            w-full py-4 rounded-xl font-bold text-lg text-white shadow-lg
            transition-all duration-200 transform hover:-translate-y-1 hover:shadow-xl
            ${x===p?"bg-gradient-to-r from-[#00897B] to-[#26A69A]":"bg-gradient-to-r from-gray-500 to-gray-600"}
            disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none
          `,children:x===p?o.jsx(o.Fragment,{children:"âœ“ Mark Order as Ready for Pickup"}):o.jsxs(o.Fragment,{children:["Pack ",p-x," More Items"]})})})]})}function mp({order:e,onPickerAssigned:r}){var _,S,b,A;const[t,n]=Te.useState([]),[a,s]=Te.useState(null),[l,c]=Te.useState(!0),[f,u]=Te.useState(!1);Te.useEffect(()=>{d()},[]);const d=async()=>{try{c(!0);const E=[{id:"picker-1",name:"John Smith",status:"available",activeOrders:0,rating:4.8,completedOrders:156,avatar:null},{id:"picker-2",name:"Sarah Johnson",status:"available",activeOrders:1,rating:4.9,completedOrders:203,avatar:null},{id:"picker-3",name:"Michael Brown",status:"busy",activeOrders:3,rating:4.7,completedOrders:189,avatar:null},{id:"picker-4",name:"Emily Davis",status:"available",activeOrders:0,rating:5,completedOrders:98,avatar:null}];setTimeout(()=>{n(E),c(!1)},500)}catch(E){console.error("Error fetching pickers:",E),c(!1)}},g=async()=>{if(!a){alert("Please select a picker");return}u(!0);try{await new Promise(E=>setTimeout(E,1e3)),r&&await r(a.id),alert(`Order assigned to ${a.name}`)}catch(E){console.error("Error assigning picker:",E),alert("Failed to assign picker. Please try again.")}finally{u(!1)}},x=E=>{switch(E){case"available":return"bg-green-100 text-green-700 border-green-200";case"busy":return"bg-orange-100 text-orange-700 border-orange-200";case"offline":return"bg-gray-100 text-gray-700 border-gray-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}},p=E=>{switch(E){case"available":return"bg-green-500";case"busy":return"bg-orange-500";case"offline":return"bg-gray-400";default:return"bg-gray-400"}};if(l)return o.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#FFB300] mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Loading available pickers..."})]});const w=t.filter(E=>E.status==="available"),v=t.filter(E=>E.status==="busy");return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-gradient-to-br from-[#FFB300] to-[#FFA726] rounded-xl p-6 text-white shadow-lg",children:[o.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Assign Order Picker"}),o.jsxs("p",{className:"text-gray-900",children:["Select a picker to handle this order â€¢ ",w.length," available"]})]}),o.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-md border border-gray-200",children:[o.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Order Details"}),o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-500",children:"Order Number"}),o.jsx("p",{className:"font-semibold text-gray-900",children:e.orderNumber})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-500",children:"Total Items"}),o.jsx("p",{className:"font-semibold text-gray-900",children:((_=e.items)==null?void 0:_.length)||0})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-500",children:"Order Value"}),o.jsxs("p",{className:"font-semibold text-[#00897B]",children:["Â£",(b=(S=e.pricing)==null?void 0:S.total)==null?void 0:b.toFixed(2)]})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-500",children:"Customer"}),o.jsx("p",{className:"font-semibold text-gray-900",children:((A=e.deliveryAddress)==null?void 0:A.fullName)||"N/A"})]})]})]}),w.length>0&&o.jsxs("div",{children:[o.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[o.jsx("span",{className:"w-3 h-3 bg-green-500 rounded-full animate-pulse"}),"Available Pickers (",w.length,")"]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:w.map(E=>o.jsx("div",{onClick:()=>s(E),className:`
                  bg-white rounded-xl p-5 shadow-md cursor-pointer transition-all duration-200
                  border-2 ${(a==null?void 0:a.id)===E.id?"border-[#FFB300] shadow-lg scale-105":"border-gray-200 hover:border-[#FFB300] hover:shadow-lg"}
                `,children:o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsxs("div",{className:"flex-shrink-0",children:[E.avatar?o.jsx("img",{src:E.avatar,alt:E.name,className:"w-16 h-16 rounded-full object-cover shadow-md"}):o.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-[#FFB300] to-[#FFA726] flex items-center justify-center text-white text-2xl font-bold shadow-md",children:E.name.charAt(0)}),o.jsx("div",{className:`w-4 h-4 rounded-full ${p(E.status)} border-2 border-white shadow-sm -mt-3 ml-12`})]}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[o.jsx("h5",{className:"font-bold text-gray-900 text-lg",children:E.name}),(a==null?void 0:a.id)===E.id&&o.jsx("svg",{className:"w-6 h-6 text-[#FFB300] flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[o.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded-lg",children:[o.jsx("div",{className:"text-sm font-bold text-gray-900",children:E.rating}),o.jsx("div",{className:"text-xs text-gray-500",children:"Rating"})]}),o.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded-lg",children:[o.jsx("div",{className:"text-sm font-bold text-gray-900",children:E.completedOrders}),o.jsx("div",{className:"text-xs text-gray-500",children:"Orders"})]}),o.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded-lg",children:[o.jsx("div",{className:"text-sm font-bold text-gray-900",children:E.activeOrders}),o.jsx("div",{className:"text-xs text-gray-500",children:"Active"})]})]}),o.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold border ${x(E.status)}`,children:[o.jsx("span",{className:`w-2 h-2 rounded-full ${p(E.status)} mr-2`}),E.status.charAt(0).toUpperCase()+E.status.slice(1)]})]})]})},E.id))})]}),v.length>0&&o.jsxs("div",{children:[o.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[o.jsx("span",{className:"w-3 h-3 bg-orange-500 rounded-full"}),"Busy Pickers (",v.length,")"]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:v.map(E=>o.jsx("div",{className:"bg-white rounded-xl p-5 shadow-md border-2 border-gray-200 opacity-60",children:o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("div",{className:"flex-shrink-0",children:E.avatar?o.jsx("img",{src:E.avatar,alt:E.name,className:"w-16 h-16 rounded-full object-cover shadow-md grayscale"}):o.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-400 flex items-center justify-center text-white text-2xl font-bold shadow-md",children:E.name.charAt(0)})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h5",{className:"font-bold text-gray-700 text-lg mb-1",children:E.name}),o.jsxs("p",{className:"text-sm text-gray-500 mb-2",children:["Currently handling ",E.activeOrders," orders"]}),o.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold border ${x(E.status)}`,children:[o.jsx("span",{className:`w-2 h-2 rounded-full ${p(E.status)} mr-2`}),"Busy"]})]})]})},E.id))})]}),t.length===0&&o.jsxs("div",{className:"bg-gray-50 rounded-xl p-12 text-center",children:[o.jsx("svg",{className:"w-16 h-16 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Pickers Available"}),o.jsx("p",{className:"text-gray-600",children:"All pickers are currently busy. Please check back in a few minutes."})]}),a&&o.jsx("div",{className:"sticky bottom-0 bg-white border-t-2 border-gray-200 p-4 -mx-6 -mb-6 rounded-b-xl shadow-lg",children:o.jsx("button",{onClick:g,disabled:f,className:"w-full py-4 bg-gradient-to-r from-[#00897B] to-[#26A69A] text-white rounded-xl font-bold text-lg shadow-lg hover:shadow-xl transition-all duration-200 transform hover:-translate-y-1 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center justify-center gap-2",children:f?o.jsxs(o.Fragment,{children:[o.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Assigning..."]}):o.jsxs(o.Fragment,{children:["âœ“ Assign to ",a.name]})})})]})}function gp({order:e,onStatusUpdate:r,isUpdating:t}){const[n,a]=Te.useState(!1),[s,l]=Te.useState(null),[c,f]=Te.useState(""),u=()=>({pending:[{status:"confirmed",label:"Accept Order",icon:"âœ“",color:"green",description:"Confirm and start preparing this order"},{status:"cancelled",label:"Reject Order",icon:"âœ•",color:"red",description:"Cancel this order (requires reason)",requiresNote:!0}],confirmed:[{status:"preparing",label:"Start Preparing",icon:"ðŸ‘¨â€ðŸ³",color:"orange",description:"Begin preparing the order"},{status:"cancelled",label:"Cancel Order",icon:"âœ•",color:"red",description:"Cancel this order",requiresNote:!0}],preparing:[{status:"ready",label:"Mark as Ready",icon:"âœ“",color:"green",description:"Order is ready for pickup"}],ready:[{status:"out-for-delivery",label:"Out for Delivery",icon:"ðŸšš",color:"blue",description:"Rider has picked up the order"}],"out-for-delivery":[{status:"delivered",label:"Mark as Delivered",icon:"âœ“",color:"green",description:"Order has been delivered to customer"}],delivered:[{status:"completed",label:"Complete Order",icon:"âœ“",color:"gray",description:"Finalize and archive this order"}],assigned_picker:[{status:"picking",label:"Start Picking",icon:"ðŸ“¦",color:"purple",description:"Picker starts collecting items"}],picking:[{status:"picked",label:"Items Picked",icon:"âœ“",color:"purple",description:"All items have been picked"}],picked:[{status:"packing",label:"Start Packing",icon:"ðŸ“¦",color:"indigo",description:"Begin packing the items"}],packing:[{status:"ready_for_pickup",label:"Ready for Pickup",icon:"âœ“",color:"teal",description:"Order is packed and ready"}]})[e.status]||[],d=v=>{l(v),a(!0)},g=async()=>{if(!s)return;const v=s.requiresNote?c:"";if(s.requiresNote&&!v.trim()){alert("Please provide a reason for cancellation");return}try{await r(s.status,v),a(!1),l(null),f("")}catch(_){console.error("Error updating status:",_),alert("Failed to update order status. Please try again.")}},x=()=>{a(!1),l(null),f("")},p=u();if(p.length===0)return null;const w={green:{bg:"bg-gradient-to-r from-green-600 to-green-700",hover:"hover:from-green-700 hover:to-green-800",border:"border-green-600",text:"text-green-700"},red:{bg:"bg-gradient-to-r from-red-600 to-red-700",hover:"hover:from-red-700 hover:to-red-800",border:"border-red-600",text:"text-red-700"},orange:{bg:"bg-gradient-to-r from-orange-600 to-orange-700",hover:"hover:from-orange-700 hover:to-orange-800",border:"border-orange-600",text:"text-orange-700"},blue:{bg:"bg-gradient-to-r from-blue-600 to-blue-700",hover:"hover:from-blue-700 hover:to-blue-800",border:"border-blue-600",text:"text-blue-700"},purple:{bg:"bg-gradient-to-r from-purple-600 to-purple-700",hover:"hover:from-purple-700 hover:to-purple-800",border:"border-purple-600",text:"text-purple-700"},indigo:{bg:"bg-gradient-to-r from-indigo-600 to-indigo-700",hover:"hover:from-indigo-700 hover:to-indigo-800",border:"border-indigo-600",text:"text-indigo-700"},teal:{bg:"bg-gradient-to-r from-[#00897B] to-[#00695C]",hover:"hover:from-[#00695C] hover:to-[#004D40]",border:"border-[#00897B]",text:"text-[#00897B]"},gray:{bg:"bg-gradient-to-r from-gray-600 to-gray-700",hover:"hover:from-gray-700 hover:to-gray-800",border:"border-gray-600",text:"text-gray-700"}};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg border-2 border-[#FFB300]",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[o.jsx("svg",{className:"w-5 h-5 text-[#FFB300]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"Quick Actions"]}),o.jsx("div",{className:"flex flex-wrap gap-3",children:p.map(v=>{const _=w[v.color]||w.gray;return o.jsxs("button",{onClick:()=>d(v),disabled:t,className:`
                  flex items-center gap-2 px-6 py-3 rounded-lg font-semibold text-white
                  ${_.bg} ${_.hover}
                  shadow-md hover:shadow-lg
                  transition-all duration-200 transform hover:-translate-y-0.5
                  disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none
                `,children:[o.jsx("span",{className:"text-xl",children:v.icon}),o.jsx("span",{children:v.label}),t&&o.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})]},v.status)})})]}),n&&s&&o.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[60] p-4 animate-fadeIn",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-slideUp",children:[o.jsx("div",{className:`w-16 h-16 rounded-full mx-auto mb-4 flex items-center justify-center ${s.color==="red"?"bg-red-100":"bg-green-100"}`,children:o.jsx("span",{className:"text-3xl",children:s.icon})}),o.jsx("h3",{className:"text-xl font-bold text-gray-900 text-center mb-2",children:s.label}),o.jsx("p",{className:"text-gray-600 text-center mb-4",children:s.description}),s.requiresNote&&o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for cancellation *"}),o.jsx("textarea",{value:c,onChange:v=>f(v.target.value),placeholder:"Please provide a reason...",rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#FFB300] focus:border-transparent resize-none",required:!0})]}),o.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-4",children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Order Number"}),o.jsx("div",{className:"font-semibold text-gray-900",children:e.orderNumber})]}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx("button",{onClick:x,className:"flex-1 px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium rounded-lg transition-colors",children:"Cancel"}),o.jsx("button",{onClick:g,disabled:s.requiresNote&&!c.trim(),className:`
                  flex-1 px-4 py-2 text-white font-medium rounded-lg transition-all
                  ${w[s.color].bg} ${w[s.color].hover}
                  shadow-md hover:shadow-lg
                  disabled:opacity-50 disabled:cursor-not-allowed
                `,children:"Confirm"})]})]})})]})}function xp({order:e}){const[r,t]=Te.useState(!1),n=[{status:"pending",label:"Order Placed",icon:"ðŸ“‹",description:"Customer placed the order"},{status:"confirmed",label:"Order Confirmed",icon:"âœ“",description:"Vendor accepted the order"},{status:"assigned_picker",label:"Picker Assigned",icon:"ðŸ‘¤",description:"Order assigned to picker"},{status:"picking",label:"Picking Items",icon:"ðŸ›’",description:"Picker is collecting items"},{status:"picked",label:"Items Picked",icon:"âœ“",description:"All items collected"},{status:"packing",label:"Packing Order",icon:"ðŸ“¦",description:"Items being packed"},{status:"ready_for_pickup",label:"Ready for Pickup",icon:"âœ“",description:"Order ready for rider"},{status:"out-for-delivery",label:"Out for Delivery",icon:"ðŸšš",description:"Rider on the way"},{status:"delivered",label:"Delivered",icon:"âœ“",description:"Order delivered to customer"},{status:"completed",label:"Completed",icon:"âœ“",description:"Order completed"}],a={label:"Order Cancelled",icon:"âœ•",description:"Order was cancelled"},l=e.status==="cancelled"?-1:n.findIndex(x=>x.status===e.status),c=e.status==="cancelled",f=x=>c?"cancelled":x<l?"completed":x===l?"current":"upcoming",u=x=>{switch(x){case"completed":return{bg:"bg-[#00897B]",text:"text-[#00897B]",border:"border-[#00897B]",line:"bg-[#00897B]"};case"current":return{bg:"bg-[#FFB300]",text:"text-[#FFB300]",border:"border-[#FFB300]",line:"bg-gray-300"};case"cancelled":return{bg:"bg-red-500",text:"text-red-500",border:"border-red-500",line:"bg-gray-300"};default:return{bg:"bg-gray-300",text:"text-gray-400",border:"border-gray-300",line:"bg-gray-300"}}},d=e.statusHistory||[{status:"pending",timestamp:e.createdAt,note:"Order placed by customer",user:"System"},...e.status!=="pending"?[{status:e.status,timestamp:e.updatedAt,note:"Current status",user:"Vendor"}]:[]],g=r?d:d.slice(0,3);return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-gradient-to-br from-[#FFB300] to-[#FFA726] rounded-xl p-6 text-white shadow-lg",children:[o.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Order Timeline"}),o.jsxs("p",{className:"text-gray-900",children:["Track the progress of order ",e.orderNumber]})]}),o.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-gray-200",children:[o.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Progress Stages"}),o.jsx("div",{className:"relative",children:c?o.jsxs("div",{className:"relative flex items-start gap-4",children:[o.jsx("div",{className:"relative z-10 flex-shrink-0",children:o.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center border-4 border-white shadow-lg bg-red-500",children:o.jsx("span",{className:"text-white text-xl",children:a.icon})})}),o.jsxs("div",{className:"flex-1 pt-1",children:[o.jsx("h5",{className:"font-bold text-lg text-red-500 mb-1",children:a.label}),o.jsx("p",{className:"text-sm text-gray-600",children:a.description}),e.cancellationReason&&o.jsx("div",{className:"mt-2 p-3 bg-red-50 border-l-4 border-red-500 rounded",children:o.jsxs("p",{className:"text-sm text-gray-700",children:[o.jsx("span",{className:"font-semibold",children:"Reason:"})," ",e.cancellationReason]})})]})]}):n.map((x,p)=>{const w=f(p),v=u(w),_=p===n.length-1;return o.jsxs("div",{className:"relative flex items-start gap-4 pb-8",children:[!_&&o.jsx("div",{className:"absolute left-5 top-12 w-0.5 h-full",children:o.jsx("div",{className:`w-full h-full ${v.line}`})}),o.jsxs("div",{className:"relative z-10 flex-shrink-0",children:[o.jsx("div",{className:`
                        w-10 h-10 rounded-full flex items-center justify-center
                        border-4 border-white shadow-lg
                        ${v.bg}
                        ${w==="current"?"animate-pulse":""}
                      `,children:o.jsx("span",{className:"text-white text-xl",children:x.icon})}),w==="completed"&&o.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-[#00897B] rounded-full flex items-center justify-center",children:o.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),o.jsxs("div",{className:"flex-1 pt-1",children:[o.jsxs("div",{className:"flex items-center justify-between mb-1",children:[o.jsx("h5",{className:`font-bold text-lg ${v.text}`,children:x.label}),w==="completed"&&d.find(S=>S.status===x.status)&&o.jsx("span",{className:"text-sm text-gray-500",children:new Date(d.find(S=>S.status===x.status).timestamp).toLocaleString("en-GB",{dateStyle:"short",timeStyle:"short"})}),w==="current"&&o.jsx("span",{className:"px-3 py-1 bg-[#FFB300] text-gray-900 text-xs font-semibold rounded-full",children:"Current"})]}),o.jsx("p",{className:"text-sm text-gray-600",children:x.description}),w==="current"&&o.jsx("div",{className:"mt-2 p-3 bg-yellow-50 border-l-4 border-[#FFB300] rounded",children:o.jsxs("p",{className:"text-sm text-gray-700",children:[o.jsx("span",{className:"font-semibold",children:"In Progress:"})," This stage is currently active"]})})]})]},x.status)})})]}),o.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-gray-200",children:[o.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[o.jsx("svg",{className:"w-5 h-5 text-[#00897B]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Status History"]}),o.jsx("div",{className:"space-y-3",children:g.map((x,p)=>o.jsxs("div",{className:"flex items-start gap-4 p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[o.jsx("div",{className:"flex-shrink-0 w-2 h-2 mt-2 rounded-full bg-[#00897B]"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[o.jsx("h5",{className:"font-semibold text-gray-900 capitalize",children:x.status.replace(/_/g," ").replace(/-/g," ")}),o.jsx("span",{className:"text-sm text-gray-500 whitespace-nowrap",children:new Date(x.timestamp).toLocaleString("en-GB",{dateStyle:"short",timeStyle:"short"})})]}),x.note&&o.jsx("p",{className:"text-sm text-gray-600",children:x.note}),x.user&&o.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["By ",x.user]})]})]},p))}),d.length>3&&o.jsx("button",{onClick:()=>t(!r),className:"mt-4 w-full py-2 text-[#00897B] font-medium hover:bg-gray-50 rounded-lg transition-colors",children:r?"â–² Show Less":`â–¼ Show ${d.length-3} More`})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-5 shadow-md border border-blue-200",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[o.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-500 flex items-center justify-center",children:o.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),o.jsx("h5",{className:"font-semibold text-gray-900",children:"Total Time"})]}),o.jsxs("p",{className:"text-2xl font-bold text-blue-700",children:[Math.round((new Date-new Date(e.createdAt))/1e3/60)," mins"]}),o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Since order placed"})]}),o.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-5 shadow-md border border-green-200",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[o.jsx("div",{className:"w-10 h-10 rounded-full bg-green-500 flex items-center justify-center",children:o.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),o.jsx("h5",{className:"font-semibold text-gray-900",children:"Progress"})]}),o.jsxs("p",{className:"text-2xl font-bold text-green-700",children:[Math.round((l+1)/n.length*100),"%"]}),o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Order completion"})]}),o.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-5 shadow-md border border-purple-200",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[o.jsx("div",{className:"w-10 h-10 rounded-full bg-purple-500 flex items-center justify-center",children:o.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),o.jsx("h5",{className:"font-semibold text-gray-900",children:"Updates"})]}),o.jsx("p",{className:"text-2xl font-bold text-purple-700",children:d.length}),o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Status changes"})]})]})]})}const vp={pending:"bg-gradient-to-r from-yellow-400 to-yellow-500 text-gray-900",confirmed:"bg-gradient-to-r from-blue-500 to-blue-600 text-white",assigned_picker:"bg-gradient-to-r from-purple-500 to-purple-600 text-white",picking:"bg-gradient-to-r from-purple-600 to-purple-700 text-white",picked:"bg-gradient-to-r from-purple-700 to-purple-800 text-white",packing:"bg-gradient-to-r from-indigo-500 to-indigo-600 text-white",ready_for_pickup:"bg-gradient-to-r from-teal-500 to-teal-600 text-white",preparing:"bg-gradient-to-r from-orange-500 to-orange-600 text-white",ready:"bg-gradient-to-r from-green-600 to-green-700 text-white","out-for-delivery":"bg-gradient-to-r from-blue-600 to-blue-700 text-white",delivered:"bg-gradient-to-r from-green-700 to-green-800 text-white",completed:"bg-gradient-to-r from-gray-700 to-gray-800 text-white",cancelled:"bg-gradient-to-r from-red-500 to-red-600 text-white"},yp={pending:"Pending",confirmed:"Confirmed",assigned_picker:"Picker Assigned",picking:"Picking Items",picked:"Items Picked",packing:"Packing",ready_for_pickup:"Ready for Pickup",preparing:"Preparing",ready:"Ready","out-for-delivery":"Out for Delivery",delivered:"Delivered",completed:"Completed",cancelled:"Cancelled"};function wp({order:e,onClose:r,onStatusUpdate:t,onRefresh:n}){var v,_,S,b,A,E,U,R,L,C,P,W,k,T,H,G,ce,J,Q,oe,ae,ge;const[a,s]=Te.useState("details"),[l,c]=Te.useState([]),[f,u]=Te.useState(!1);Te.useEffect(()=>{if(e.status==="packing"||e.status==="picking"){const ve=e.items.map(j=>({itemId:j._id||j.productId,packed:!1}));c(ve)}},[e]);const d=async(ve,j="")=>{u(!0);try{await t(e._id,ve,j),n&&await n()}catch(O){console.error("Error updating status:",O)}finally{u(!1)}},g=ve=>{c(ve),ve.every(O=>O.packed)&&d("ready_for_pickup","All items packed and ready")},x=async ve=>{try{await d("assigned_picker",`Picker ${ve} assigned`)}catch(j){console.error("Error assigning picker:",j)}},p=e.items.reduce((ve,j)=>ve+j.quantity,0),w=Math.ceil(p*2);return o.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fadeIn",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-6xl w-full max-h-[95vh] overflow-hidden flex flex-col animate-slideUp",children:[o.jsx("div",{className:"bg-gradient-to-r from-[#FFB300] to-[#FFA726] text-gray-900 p-6",children:o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-3xl font-bold",children:e.orderNumber}),o.jsxs("p",{className:"text-gray-800 mt-1 text-sm",children:["Placed on ",new Date(e.createdAt).toLocaleString("en-GB",{dateStyle:"medium",timeStyle:"short"})]}),o.jsxs("div",{className:"mt-2 flex items-center gap-3",children:[o.jsx("span",{className:`px-4 py-1.5 inline-flex text-sm font-semibold rounded-full shadow-lg ${vp[e.status]}`,children:yp[e.status]}),o.jsxs("span",{className:"text-sm text-gray-800",children:[p," items â€¢ Est. ",w," mins"]})]})]}),o.jsx("button",{onClick:r,className:"text-gray-900 hover:text-gray-700 transition-all hover:rotate-90 duration-300",children:o.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})]})}),o.jsx("div",{className:"border-b border-gray-200 bg-gray-50",children:o.jsx("div",{className:"flex overflow-x-auto",children:[{id:"details",label:"Order Details",icon:"ðŸ“‹"},{id:"timeline",label:"Timeline",icon:"ðŸ“"},{id:"packing",label:"Packing",icon:"ðŸ“¦",show:["packing","picking","assigned_picker"].includes(e.status)},{id:"picker",label:"Picker",icon:"ðŸ‘¤",show:["pending","confirmed"].includes(e.status)}].map(ve=>ve.show===!1||ve.show&&!ve.show?null:o.jsxs("button",{onClick:()=>s(ve.id),className:`px-6 py-4 text-sm font-medium transition-all duration-200 border-b-2 whitespace-nowrap ${a===ve.id?"border-[#FFB300] text-[#FFB300] bg-white":"border-transparent text-gray-600 hover:text-[#FFB300] hover:bg-gray-100"}`,children:[o.jsx("span",{className:"mr-2",children:ve.icon}),ve.label]},ve.id))})}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[a==="details"&&o.jsxs("div",{className:"space-y-6",children:[o.jsx(gp,{order:e,onStatusUpdate:d,isUpdating:f}),o.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-6 shadow-sm border border-gray-200",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[o.jsx("svg",{className:"w-5 h-5 text-[#00897B]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Customer Information"]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[o.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Name"}),o.jsx("p",{className:"font-semibold text-gray-900",children:((v=e.deliveryAddress)==null?void 0:v.fullName)||((_=e.customer)==null?void 0:_.name)||"N/A"})]}),o.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[o.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Phone"}),o.jsx("p",{className:"font-semibold text-gray-900",children:((S=e.deliveryAddress)==null?void 0:S.phone)||((b=e.customer)==null?void 0:b.phone)||"N/A"})]}),o.jsxs("div",{className:"col-span-1 md:col-span-2 bg-white rounded-lg p-4 shadow-sm",children:[o.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Delivery Address"}),o.jsxs("p",{className:"font-semibold text-gray-900",children:[(A=e.deliveryAddress)==null?void 0:A.street,", ",(E=e.deliveryAddress)==null?void 0:E.city,", ",(U=e.deliveryAddress)==null?void 0:U.state," ",(R=e.deliveryAddress)==null?void 0:R.postalCode]}),((L=e.deliveryAddress)==null?void 0:L.instructions)&&o.jsx("div",{className:"mt-2 p-3 bg-yellow-50 border-l-4 border-[#FFB300] rounded",children:o.jsxs("p",{className:"text-sm text-gray-700",children:[o.jsx("span",{className:"font-semibold",children:"Delivery Note:"})," ",e.deliveryAddress.instructions]})})]})]})]}),o.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden",children:[o.jsx("div",{className:"bg-gradient-to-r from-[#00897B] to-[#26A69A] text-white px-6 py-4",children:o.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),"Order Items (",((C=e.items)==null?void 0:C.length)||0,")"]})}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Product"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Price"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Quantity"}),o.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Subtotal"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(P=e.items)==null?void 0:P.map((ve,j)=>{var O,I;return o.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[o.jsx("td",{className:"px-6 py-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[ve.image&&o.jsx("img",{src:ve.image,alt:ve.name,className:"w-12 h-12 object-cover rounded-lg shadow-sm"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-medium text-gray-900",children:ve.name}),ve.notes&&o.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Note: ",ve.notes]})]})]})}),o.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:["Â£",(O=ve.price)==null?void 0:O.toFixed(2)]}),o.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:o.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full bg-gray-100 font-medium",children:[ve.quantity," ",ve.unit]})}),o.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900 text-right font-semibold",children:["Â£",(I=ve.subtotal)==null?void 0:I.toFixed(2)]})]},j)})})]})})]}),o.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-6 shadow-lg border border-gray-200",children:[o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{className:"text-gray-600",children:"Subtotal"}),o.jsxs("span",{className:"text-gray-900 font-medium",children:["Â£",(k=(W=e.pricing)==null?void 0:W.subtotal)==null?void 0:k.toFixed(2)]})]}),((T=e.pricing)==null?void 0:T.deliveryFee)>0&&o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{className:"text-gray-600",children:"Delivery Fee"}),o.jsxs("span",{className:"text-gray-900 font-medium",children:["Â£",e.pricing.deliveryFee.toFixed(2)]})]}),((H=e.pricing)==null?void 0:H.tax)>0&&o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{className:"text-gray-600",children:"Tax (VAT)"}),o.jsxs("span",{className:"text-gray-900 font-medium",children:["Â£",e.pricing.tax.toFixed(2)]})]}),((G=e.pricing)==null?void 0:G.discount)>0&&o.jsxs("div",{className:"flex justify-between text-sm text-[#00897B]",children:[o.jsx("span",{children:"Discount"}),o.jsxs("span",{className:"font-medium",children:["-Â£",e.pricing.discount.toFixed(2)]})]}),o.jsxs("div",{className:"border-t-2 border-gray-300 pt-3 flex justify-between items-center",children:[o.jsx("span",{className:"font-bold text-lg text-gray-900",children:"Total"}),o.jsxs("span",{className:"font-bold text-2xl text-[#00897B]",children:["Â£",(J=(ce=e.pricing)==null?void 0:ce.total)==null?void 0:J.toFixed(2)]})]})]}),o.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-300 flex flex-wrap items-center justify-between gap-2",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm text-gray-500",children:"Payment Method:"}),o.jsx("span",{className:"font-semibold text-gray-900 capitalize px-3 py-1 bg-white rounded-lg shadow-sm",children:((Q=e.payment)==null?void 0:Q.method)||"N/A"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm text-gray-500",children:"Status:"}),o.jsx("span",{className:`font-semibold px-3 py-1 rounded-lg shadow-sm ${((oe=e.payment)==null?void 0:oe.status)==="paid"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:((ge=(ae=e.payment)==null?void 0:ae.status)==null?void 0:ge.toUpperCase())||"PENDING"})]})]})]})]}),a==="timeline"&&o.jsx(xp,{order:e}),a==="packing"&&o.jsx(pp,{order:e,onPackingComplete:g,onStatusUpdate:d}),a==="picker"&&o.jsx(mp,{order:e,onPickerAssigned:x})]}),o.jsxs("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200 flex justify-between items-center",children:[o.jsxs("div",{className:"text-sm text-gray-600",children:["Last updated: ",new Date(e.updatedAt||e.createdAt).toLocaleString("en-GB",{dateStyle:"short",timeStyle:"short"})]}),o.jsx("button",{onClick:r,className:"px-6 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium rounded-lg transition-all duration-200 shadow-sm hover:shadow-md",children:"Close"})]})]})})}const bp={pending:"bg-gradient-to-r from-yellow-400 to-yellow-500 text-gray-900",confirmed:"bg-gradient-to-r from-blue-500 to-blue-600 text-white",assigned_picker:"bg-gradient-to-r from-purple-500 to-purple-600 text-white",picking:"bg-gradient-to-r from-purple-600 to-purple-700 text-white",picked:"bg-gradient-to-r from-purple-700 to-purple-800 text-white",packing:"bg-gradient-to-r from-indigo-500 to-indigo-600 text-white",ready_for_pickup:"bg-gradient-to-r from-teal-500 to-teal-600 text-white",preparing:"bg-gradient-to-r from-orange-500 to-orange-600 text-white",ready:"bg-gradient-to-r from-green-600 to-green-700 text-white","out-for-delivery":"bg-gradient-to-r from-blue-600 to-blue-700 text-white",delivered:"bg-gradient-to-r from-green-700 to-green-800 text-white",completed:"bg-gradient-to-r from-gray-700 to-gray-800 text-white",cancelled:"bg-gradient-to-r from-red-500 to-red-600 text-white"},eh={pending:"Pending",confirmed:"Confirmed",assigned_picker:"Picker Assigned",picking:"Picking Items",picked:"Items Picked",packing:"Packing",ready_for_pickup:"Ready for Pickup",preparing:"Preparing",ready:"Ready","out-for-delivery":"Out for Delivery",delivered:"Delivered",completed:"Completed",cancelled:"Cancelled"};function Np(){const[e,r]=Te.useState([]),[t,n]=Te.useState(!0),[a,s]=Te.useState(null),[l,c]=Te.useState(!1),[f,u]=Te.useState({status:"",search:"",page:1,limit:20}),[d,g]=Te.useState({total:0,pages:0,currentPage:1});Te.useEffect(()=>{x()},[f]);const x=async()=>{try{n(!0);const S=await mr.getOrders(f);S.success&&(r(S.data.orders),g(S.data.pagination))}catch(S){console.error("Error fetching orders:",S)}finally{n(!1)}},p=S=>{u({...f,status:S===f.status?"":S,page:1})},w=S=>{u({...f,search:S.target.value,page:1})},v=async S=>{try{const b=await mr.getOrder(S);b.success&&(s(b.data.order),c(!0))}catch(b){console.error("Error fetching order details:",b)}},_=async(S,b,A="")=>{var E,U;try{if((await mr.updateOrderStatus(S,{status:b,note:A})).success&&(x(),a&&a._id===S)){const L=await mr.getOrder(S);L.success&&s(L.data.order)}}catch(R){console.error("Error updating order status:",R),alert(((U=(E=R.response)==null?void 0:E.data)==null?void 0:U.message)||"Failed to update order status")}};return o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("h1",{className:"text-3xl font-bold text-afri-gray-900",children:"Orders"}),o.jsx("p",{className:"text-afri-gray-600 mt-1",children:"Manage and track all your orders"})]}),o.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:o.jsxs("div",{className:"flex flex-wrap gap-4",children:[o.jsx("div",{className:"flex-1 min-w-[250px]",children:o.jsx("input",{type:"text",placeholder:"Search by order number...",value:f.search,onChange:w,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent"})}),o.jsxs("div",{className:"flex flex-wrap gap-2",children:[["pending","confirmed","preparing","ready","out-for-delivery","delivered"].map(S=>o.jsx("button",{onClick:()=>p(S),className:`px-4 py-2 rounded-lg font-medium transition ${f.status===S?"bg-afri-green text-white":"bg-afri-gray-50 text-afri-gray-700 hover:bg-afri-gray-100"}`,children:eh[S]},S)),f.status&&o.jsx("button",{onClick:()=>u({...f,status:""}),className:"px-4 py-2 rounded-lg font-medium bg-red-100 text-red-700 hover:bg-red-200",children:"Clear Filter"})]})]})}),t?o.jsx("div",{className:"flex justify-center items-center h-64",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-afri-green"})}):e.length===0?o.jsxs("div",{className:"bg-white rounded-lg shadow p-12 text-center",children:[o.jsx("svg",{className:"w-16 h-16 text-afri-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),o.jsx("h3",{className:"text-lg font-medium text-afri-gray-900 mb-1",children:"No orders found"}),o.jsx("p",{className:"text-afri-gray-500",children:f.status||f.search?"Try adjusting your filters":"Orders will appear here"})]}):o.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-afri-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Order Number"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Customer"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Items"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Total"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Status"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Date"}),o.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(S=>{var b,A,E,U,R;return o.jsxs("tr",{className:"hover:bg-afri-gray-50 transition",children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("div",{className:"text-sm font-medium text-afri-gray-900",children:S.orderNumber})}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[o.jsx("div",{className:"text-sm text-afri-gray-900",children:((b=S.customer)==null?void 0:b.name)||"N/A"}),o.jsx("div",{className:"text-sm text-afri-gray-500",children:((A=S.customer)==null?void 0:A.phone)||""})]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"text-sm text-afri-gray-900",children:[((E=S.items)==null?void 0:E.length)||0," items"]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"text-sm font-medium text-afri-gray-900",children:["Â£",((R=(U=S.pricing)==null?void 0:U.total)==null?void 0:R.toFixed(2))||"0.00"]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${bp[S.status]}`,children:eh[S.status]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-afri-gray-500",children:new Date(S.createdAt).toLocaleDateString()}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:o.jsx("button",{onClick:()=>v(S._id),className:"text-afri-green hover:text-afri-green-dark font-medium",children:"View Details"})})]},S._id)})})]})}),d.pages>1&&o.jsx("div",{className:"mt-6 flex justify-center",children:o.jsx("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[...Array(d.pages)].map((S,b)=>o.jsx("button",{onClick:()=>u({...f,page:b+1}),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${d.currentPage===b+1?"z-10 bg-afri-green text-white border-afri-green":"bg-white border-gray-300 text-afri-gray-700 hover:bg-afri-gray-50"}`,children:b+1},b))})}),l&&a&&o.jsx(wp,{order:a,onClose:()=>{c(!1),s(null)},onStatusUpdate:_,onRefresh:x})]})}const _p="modulepreload",Sp=function(e){return"/afrimercato-frontend/"+e},th={},Ec=function(r,t,n){let a=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));a=Promise.allSettled(t.map(f=>{if(f=Sp(f),f in th)return;th[f]=!0;const u=f.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${d}`))return;const g=document.createElement("link");if(g.rel=u?"stylesheet":_p,u||(g.as="script"),g.crossOrigin="",g.href=f,c&&g.setAttribute("nonce",c),document.head.appendChild(g),u)return new Promise((x,p)=>{g.addEventListener("load",x),g.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${f}`)))})}))}function s(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return a.then(l=>{for(const c of l||[])c.status==="rejected"&&s(c.reason);return r().catch(s)})};var an=Uint8Array,Dn=Uint16Array,$c=Int32Array,f0=new an([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),h0=new an([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Fc=new an([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),pu=function(e,r){for(var t=new Dn(31),n=0;n<31;++n)t[n]=r+=1<<e[n-1];for(var a=new $c(t[30]),n=1;n<30;++n)for(var s=t[n];s<t[n+1];++s)a[s]=s-t[n]<<5|n;return{b:t,r:a}},mu=pu(f0,2),gu=mu.b,Cc=mu.r;gu[28]=258,Cc[258]=28;var xu=pu(h0,0),Ap=xu.b,rh=xu.r,Lc=new Dn(32768);for(var or=0;or<32768;++or){var ci=(or&43690)>>1|(or&21845)<<1;ci=(ci&52428)>>2|(ci&13107)<<2,ci=(ci&61680)>>4|(ci&3855)<<4,Lc[or]=((ci&65280)>>8|(ci&255)<<8)>>1}var ka=function(e,r,t){for(var n=e.length,a=0,s=new Dn(r);a<n;++a)e[a]&&++s[e[a]-1];var l=new Dn(r);for(a=1;a<r;++a)l[a]=l[a-1]+s[a-1]<<1;var c;if(t){c=new Dn(1<<r);var f=15-r;for(a=0;a<n;++a)if(e[a])for(var u=a<<4|e[a],d=r-e[a],g=l[e[a]-1]++<<d,x=g|(1<<d)-1;g<=x;++g)c[Lc[g]>>f]=u}else for(c=new Dn(n),a=0;a<n;++a)e[a]&&(c[a]=Lc[l[e[a]-1]++]>>15-e[a]);return c},xi=new an(288);for(var or=0;or<144;++or)xi[or]=8;for(var or=144;or<256;++or)xi[or]=9;for(var or=256;or<280;++or)xi[or]=7;for(var or=280;or<288;++or)xi[or]=8;var Fo=new an(32);for(var or=0;or<32;++or)Fo[or]=5;var jp=ka(xi,9,0),kp=ka(xi,9,1),Tp=ka(Fo,5,0),Ep=ka(Fo,5,1),cc=function(e){for(var r=e[0],t=1;t<e.length;++t)e[t]>r&&(r=e[t]);return r},sa=function(e,r,t){var n=r/8|0;return(e[n]|e[n+1]<<8)>>(r&7)&t},fc=function(e,r){var t=r/8|0;return(e[t]|e[t+1]<<8|e[t+2]<<16)>>(r&7)},Yc=function(e){return(e+7)/8|0},vu=function(e,r,t){return(t==null||t>e.length)&&(t=e.length),new an(e.subarray(r,t))},Fp=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],fa=function(e,r,t){var n=new Error(r||Fp[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,fa),!t)throw n;return n},Cp=function(e,r,t,n){var a=e.length,s=0;if(!a||r.f&&!r.l)return t||new an(0);var l=!t,c=l||r.i!=2,f=r.i;l&&(t=new an(a*3));var u=function(Oe){var Me=t.length;if(Oe>Me){var Ve=new an(Math.max(Me*2,Oe));Ve.set(t),t=Ve}},d=r.f||0,g=r.p||0,x=r.b||0,p=r.l,w=r.d,v=r.m,_=r.n,S=a*8;do{if(!p){d=sa(e,g,1);var b=sa(e,g+1,3);if(g+=3,b)if(b==1)p=kp,w=Ep,v=9,_=5;else if(b==2){var R=sa(e,g,31)+257,L=sa(e,g+10,15)+4,C=R+sa(e,g+5,31)+1;g+=14;for(var P=new an(C),W=new an(19),k=0;k<L;++k)W[Fc[k]]=sa(e,g+k*3,7);g+=L*3;for(var T=cc(W),H=(1<<T)-1,G=ka(W,T,1),k=0;k<C;){var ce=G[sa(e,g,H)];g+=ce&15;var A=ce>>4;if(A<16)P[k++]=A;else{var J=0,Q=0;for(A==16?(Q=3+sa(e,g,3),g+=2,J=P[k-1]):A==17?(Q=3+sa(e,g,7),g+=3):A==18&&(Q=11+sa(e,g,127),g+=7);Q--;)P[k++]=J}}var oe=P.subarray(0,R),ae=P.subarray(R);v=cc(oe),_=cc(ae),p=ka(oe,v,1),w=ka(ae,_,1)}else fa(1);else{var A=Yc(g)+4,E=e[A-4]|e[A-3]<<8,U=A+E;if(U>a){f&&fa(0);break}c&&u(x+E),t.set(e.subarray(A,U),x),r.b=x+=E,r.p=g=U*8,r.f=d;continue}if(g>S){f&&fa(0);break}}c&&u(x+131072);for(var ge=(1<<v)-1,ve=(1<<_)-1,j=g;;j=g){var J=p[fc(e,g)&ge],O=J>>4;if(g+=J&15,g>S){f&&fa(0);break}if(J||fa(2),O<256)t[x++]=O;else if(O==256){j=g,p=null;break}else{var I=O-254;if(O>264){var k=O-257,D=f0[k];I=sa(e,g,(1<<D)-1)+gu[k],g+=D}var X=w[fc(e,g)&ve],fe=X>>4;X||fa(3),g+=X&15;var ae=Ap[fe];if(fe>3){var D=h0[fe];ae+=fc(e,g)&(1<<D)-1,g+=D}if(g>S){f&&fa(0);break}c&&u(x+131072);var he=x+I;if(x<ae){var ue=s-ae,be=Math.min(ae,he);for(ue+x<0&&fa(3);x<be;++x)t[x]=n[ue+x]}for(;x<he;++x)t[x]=t[x-ae]}}r.l=p,r.p=j,r.b=x,r.f=d,p&&(d=1,r.m=v,r.d=w,r.n=_)}while(!d);return x!=t.length&&l?vu(t,0,x):t.subarray(0,x)},Ha=function(e,r,t){t<<=r&7;var n=r/8|0;e[n]|=t,e[n+1]|=t>>8},mo=function(e,r,t){t<<=r&7;var n=r/8|0;e[n]|=t,e[n+1]|=t>>8,e[n+2]|=t>>16},hc=function(e,r){for(var t=[],n=0;n<e.length;++n)e[n]&&t.push({s:n,f:e[n]});var a=t.length,s=t.slice();if(!a)return{t:wu,l:0};if(a==1){var l=new an(t[0].s+1);return l[t[0].s]=1,{t:l,l:1}}t.sort(function(U,R){return U.f-R.f}),t.push({s:-1,f:25001});var c=t[0],f=t[1],u=0,d=1,g=2;for(t[0]={s:-1,f:c.f+f.f,l:c,r:f};d!=a-1;)c=t[t[u].f<t[g].f?u++:g++],f=t[u!=d&&t[u].f<t[g].f?u++:g++],t[d++]={s:-1,f:c.f+f.f,l:c,r:f};for(var x=s[0].s,n=1;n<a;++n)s[n].s>x&&(x=s[n].s);var p=new Dn(x+1),w=Pc(t[d-1],p,0);if(w>r){var n=0,v=0,_=w-r,S=1<<_;for(s.sort(function(R,L){return p[L.s]-p[R.s]||R.f-L.f});n<a;++n){var b=s[n].s;if(p[b]>r)v+=S-(1<<w-p[b]),p[b]=r;else break}for(v>>=_;v>0;){var A=s[n].s;p[A]<r?v-=1<<r-p[A]++-1:++n}for(;n>=0&&v;--n){var E=s[n].s;p[E]==r&&(--p[E],++v)}w=r}return{t:new an(p),l:w}},Pc=function(e,r,t){return e.s==-1?Math.max(Pc(e.l,r,t+1),Pc(e.r,r,t+1)):r[e.s]=t},nh=function(e){for(var r=e.length;r&&!e[--r];);for(var t=new Dn(++r),n=0,a=e[0],s=1,l=function(f){t[n++]=f},c=1;c<=r;++c)if(e[c]==a&&c!=r)++s;else{if(!a&&s>2){for(;s>138;s-=138)l(32754);s>2&&(l(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(l(a),--s;s>6;s-=6)l(8304);s>2&&(l(s-3<<5|8208),s=0)}for(;s--;)l(a);s=1,a=e[c]}return{c:t.subarray(0,n),n:r}},go=function(e,r){for(var t=0,n=0;n<r.length;++n)t+=e[n]*r[n];return t},yu=function(e,r,t){var n=t.length,a=Yc(r+2);e[a]=n&255,e[a+1]=n>>8,e[a+2]=e[a]^255,e[a+3]=e[a+1]^255;for(var s=0;s<n;++s)e[a+s+4]=t[s];return(a+4+n)*8},ah=function(e,r,t,n,a,s,l,c,f,u,d){Ha(r,d++,t),++a[256];for(var g=hc(a,15),x=g.t,p=g.l,w=hc(s,15),v=w.t,_=w.l,S=nh(x),b=S.c,A=S.n,E=nh(v),U=E.c,R=E.n,L=new Dn(19),C=0;C<b.length;++C)++L[b[C]&31];for(var C=0;C<U.length;++C)++L[U[C]&31];for(var P=hc(L,7),W=P.t,k=P.l,T=19;T>4&&!W[Fc[T-1]];--T);var H=u+5<<3,G=go(a,xi)+go(s,Fo)+l,ce=go(a,x)+go(s,v)+l+14+3*T+go(L,W)+2*L[16]+3*L[17]+7*L[18];if(f>=0&&H<=G&&H<=ce)return yu(r,d,e.subarray(f,f+u));var J,Q,oe,ae;if(Ha(r,d,1+(ce<G)),d+=2,ce<G){J=ka(x,p,0),Q=x,oe=ka(v,_,0),ae=v;var ge=ka(W,k,0);Ha(r,d,A-257),Ha(r,d+5,R-1),Ha(r,d+10,T-4),d+=14;for(var C=0;C<T;++C)Ha(r,d+3*C,W[Fc[C]]);d+=3*T;for(var ve=[b,U],j=0;j<2;++j)for(var O=ve[j],C=0;C<O.length;++C){var I=O[C]&31;Ha(r,d,ge[I]),d+=W[I],I>15&&(Ha(r,d,O[C]>>5&127),d+=O[C]>>12)}}else J=jp,Q=xi,oe=Tp,ae=Fo;for(var C=0;C<c;++C){var D=n[C];if(D>255){var I=D>>18&31;mo(r,d,J[I+257]),d+=Q[I+257],I>7&&(Ha(r,d,D>>23&31),d+=f0[I]);var X=D&31;mo(r,d,oe[X]),d+=ae[X],X>3&&(mo(r,d,D>>5&8191),d+=h0[X])}else mo(r,d,J[D]),d+=Q[D]}return mo(r,d,J[256]),d+Q[256]},Lp=new $c([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),wu=new an(0),Pp=function(e,r,t,n,a,s){var l=s.z||e.length,c=new an(n+l+5*(1+Math.ceil(l/7e3))+a),f=c.subarray(n,c.length-a),u=s.l,d=(s.r||0)&7;if(r){d&&(f[0]=s.r>>3);for(var g=Lp[r-1],x=g>>13,p=g&8191,w=(1<<t)-1,v=s.p||new Dn(32768),_=s.h||new Dn(w+1),S=Math.ceil(t/3),b=2*S,A=function(Je){return(e[Je]^e[Je+1]<<S^e[Je+2]<<b)&w},E=new $c(25e3),U=new Dn(288),R=new Dn(32),L=0,C=0,P=s.i||0,W=0,k=s.w||0,T=0;P+2<l;++P){var H=A(P),G=P&32767,ce=_[H];if(v[G]=ce,_[H]=G,k<=P){var J=l-P;if((L>7e3||W>24576)&&(J>423||!u)){d=ah(e,f,0,E,U,R,C,W,T,P-T,d),W=L=C=0,T=P;for(var Q=0;Q<286;++Q)U[Q]=0;for(var Q=0;Q<30;++Q)R[Q]=0}var oe=2,ae=0,ge=p,ve=G-ce&32767;if(J>2&&H==A(P-ve))for(var j=Math.min(x,J)-1,O=Math.min(32767,P),I=Math.min(258,J);ve<=O&&--ge&&G!=ce;){if(e[P+oe]==e[P+oe-ve]){for(var D=0;D<I&&e[P+D]==e[P+D-ve];++D);if(D>oe){if(oe=D,ae=ve,D>j)break;for(var X=Math.min(ve,D-2),fe=0,Q=0;Q<X;++Q){var he=P-ve+Q&32767,ue=v[he],be=he-ue&32767;be>fe&&(fe=be,ce=he)}}}G=ce,ce=v[G],ve+=G-ce&32767}if(ae){E[W++]=268435456|Cc[oe]<<18|rh[ae];var Oe=Cc[oe]&31,Me=rh[ae]&31;C+=f0[Oe]+h0[Me],++U[257+Oe],++R[Me],k=P+oe,++L}else E[W++]=e[P],++U[e[P]]}}for(P=Math.max(P,k);P<l;++P)E[W++]=e[P],++U[e[P]];d=ah(e,f,u,E,U,R,C,W,T,P-T,d),u||(s.r=d&7|f[d/8|0]<<3,d-=7,s.h=_,s.p=v,s.i=P,s.w=k)}else{for(var P=s.w||0;P<l+u;P+=65535){var Ve=P+65535;Ve>=l&&(f[d/8|0]=u,Ve=l),d=yu(f,d+1,e.subarray(P,Ve))}s.i=l}return vu(c,0,n+Yc(d)+a)},bu=function(){var e=1,r=0;return{p:function(t){for(var n=e,a=r,s=t.length|0,l=0;l!=s;){for(var c=Math.min(l+2655,s);l<c;++l)a+=n+=t[l];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}e=n,r=a},d:function(){return e%=65521,r%=65521,(e&255)<<24|(e&65280)<<8|(r&255)<<8|r>>8}}},Op=function(e,r,t,n,a){if(!a&&(a={l:1},r.dictionary)){var s=r.dictionary.subarray(-32768),l=new an(s.length+e.length);l.set(s),l.set(e,s.length),e=l,a.w=s.length}return Pp(e,r.level==null?6:r.level,r.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+r.mem,t,n,a)},Nu=function(e,r,t){for(;t;++r)e[r]=t,t>>>=8},Ip=function(e,r){var t=r.level,n=t==0?0:t<6?1:t==9?3:2;if(e[0]=120,e[1]=n<<6|(r.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,r.dictionary){var a=bu();a.p(r.dictionary),Nu(e,2,a.d())}},Dp=function(e,r){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&fa(6,"invalid zlib data"),(e[1]>>5&1)==1&&fa(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function Oc(e,r){r||(r={});var t=bu();t.p(e);var n=Op(e,r,r.dictionary?6:2,4);return Ip(n,r),Nu(n,n.length-4,t.d()),n}function Rp(e,r){return Cp(e.subarray(Dp(e),-4),{i:2},r,r)}var Mp=typeof TextDecoder<"u"&&new TextDecoder,Bp=0;try{Mp.decode(wu,{stream:!0}),Bp=1}catch{}var xt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function uc(){xt.console&&typeof xt.console.log=="function"&&xt.console.log.apply(xt.console,arguments)}var tr={log:uc,warn:function(e){xt.console&&(typeof xt.console.warn=="function"?xt.console.warn.apply(xt.console,arguments):uc.call(null,arguments))},error:function(e){xt.console&&(typeof xt.console.error=="function"?xt.console.error.apply(xt.console,arguments):uc(e))}};function dc(e,r,t){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){Pi(n.response,r,t)},n.onerror=function(){tr.error("could not download file")},n.send()}function ih(e){var r=new XMLHttpRequest;r.open("HEAD",e,!1);try{r.send()}catch{}return r.status>=200&&r.status<=299}function Dl(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(r)}}var yo,Ic,Pi=xt.saveAs||((typeof window>"u"?"undefined":rr(window))!=="object"||window!==xt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,r,t){var n=xt.URL||xt.webkitURL,a=document.createElement("a");r=r||e.name||"download",a.download=r,a.rel="noopener",typeof e=="string"?(a.href=e,a.origin!==location.origin?ih(a.href)?dc(e,r,t):Dl(a,a.target="_blank"):Dl(a)):(a.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){Dl(a)},0))}:"msSaveOrOpenBlob"in navigator?function(e,r,t){if(r=r||e.name||"download",typeof e=="string")if(ih(e))dc(e,r,t);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){Dl(n)})}else navigator.msSaveOrOpenBlob(function(a,s){return s===void 0?s={autoBom:!1}:rr(s)!=="object"&&(tr.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}(e,t),r)}:function(e,r,t,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return dc(e,r,t);var a=e.type==="application/octet-stream",s=/constructor/i.test(xt.HTMLElement)||xt.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||a&&s)&&(typeof FileReader>"u"?"undefined":rr(FileReader))==="object"){var c=new FileReader;c.onloadend=function(){var d=c.result;d=l?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=d:location=d,n=null},c.readAsDataURL(e)}else{var f=xt.URL||xt.webkitURL,u=f.createObjectURL(e);n?n.location=u:location.href=u,n=null,setTimeout(function(){f.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function _u(e){var r;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(c){return[parseInt(c[1]),parseInt(c[2]),parseInt(c[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(c){return[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(c){return[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)]}}],n=0;n<t.length;n++){var a=t[n].re,s=t[n].process,l=a.exec(e);l&&(r=s(l),this.r=r[0],this.g=r[1],this.b=r[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var c=this.r.toString(16),f=this.g.toString(16),u=this.b.toString(16);return c.length==1&&(c="0"+c),f.length==1&&(f="0"+f),u.length==1&&(u="0"+u),"#"+c+f+u}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function pc(e,r){var t=e[0],n=e[1],a=e[2],s=e[3];t=en(t,n,a,s,r[0],7,-680876936),s=en(s,t,n,a,r[1],12,-389564586),a=en(a,s,t,n,r[2],17,606105819),n=en(n,a,s,t,r[3],22,-1044525330),t=en(t,n,a,s,r[4],7,-176418897),s=en(s,t,n,a,r[5],12,1200080426),a=en(a,s,t,n,r[6],17,-1473231341),n=en(n,a,s,t,r[7],22,-45705983),t=en(t,n,a,s,r[8],7,1770035416),s=en(s,t,n,a,r[9],12,-1958414417),a=en(a,s,t,n,r[10],17,-42063),n=en(n,a,s,t,r[11],22,-1990404162),t=en(t,n,a,s,r[12],7,1804603682),s=en(s,t,n,a,r[13],12,-40341101),a=en(a,s,t,n,r[14],17,-1502002290),t=tn(t,n=en(n,a,s,t,r[15],22,1236535329),a,s,r[1],5,-165796510),s=tn(s,t,n,a,r[6],9,-1069501632),a=tn(a,s,t,n,r[11],14,643717713),n=tn(n,a,s,t,r[0],20,-373897302),t=tn(t,n,a,s,r[5],5,-701558691),s=tn(s,t,n,a,r[10],9,38016083),a=tn(a,s,t,n,r[15],14,-660478335),n=tn(n,a,s,t,r[4],20,-405537848),t=tn(t,n,a,s,r[9],5,568446438),s=tn(s,t,n,a,r[14],9,-1019803690),a=tn(a,s,t,n,r[3],14,-187363961),n=tn(n,a,s,t,r[8],20,1163531501),t=tn(t,n,a,s,r[13],5,-1444681467),s=tn(s,t,n,a,r[2],9,-51403784),a=tn(a,s,t,n,r[7],14,1735328473),t=rn(t,n=tn(n,a,s,t,r[12],20,-1926607734),a,s,r[5],4,-378558),s=rn(s,t,n,a,r[8],11,-2022574463),a=rn(a,s,t,n,r[11],16,1839030562),n=rn(n,a,s,t,r[14],23,-35309556),t=rn(t,n,a,s,r[1],4,-1530992060),s=rn(s,t,n,a,r[4],11,1272893353),a=rn(a,s,t,n,r[7],16,-155497632),n=rn(n,a,s,t,r[10],23,-1094730640),t=rn(t,n,a,s,r[13],4,681279174),s=rn(s,t,n,a,r[0],11,-358537222),a=rn(a,s,t,n,r[3],16,-722521979),n=rn(n,a,s,t,r[6],23,76029189),t=rn(t,n,a,s,r[9],4,-640364487),s=rn(s,t,n,a,r[12],11,-421815835),a=rn(a,s,t,n,r[15],16,530742520),t=nn(t,n=rn(n,a,s,t,r[2],23,-995338651),a,s,r[0],6,-198630844),s=nn(s,t,n,a,r[7],10,1126891415),a=nn(a,s,t,n,r[14],15,-1416354905),n=nn(n,a,s,t,r[5],21,-57434055),t=nn(t,n,a,s,r[12],6,1700485571),s=nn(s,t,n,a,r[3],10,-1894986606),a=nn(a,s,t,n,r[10],15,-1051523),n=nn(n,a,s,t,r[1],21,-2054922799),t=nn(t,n,a,s,r[8],6,1873313359),s=nn(s,t,n,a,r[15],10,-30611744),a=nn(a,s,t,n,r[6],15,-1560198380),n=nn(n,a,s,t,r[13],21,1309151649),t=nn(t,n,a,s,r[4],6,-145523070),s=nn(s,t,n,a,r[11],10,-1120210379),a=nn(a,s,t,n,r[2],15,718787259),n=nn(n,a,s,t,r[9],21,-343485551),e[0]=di(t,e[0]),e[1]=di(n,e[1]),e[2]=di(a,e[2]),e[3]=di(s,e[3])}function u0(e,r,t,n,a,s){return r=di(di(r,e),di(n,s)),di(r<<a|r>>>32-a,t)}function en(e,r,t,n,a,s,l){return u0(r&t|~r&n,e,r,a,s,l)}function tn(e,r,t,n,a,s,l){return u0(r&n|t&~n,e,r,a,s,l)}function rn(e,r,t,n,a,s,l){return u0(r^t^n,e,r,a,s,l)}function nn(e,r,t,n,a,s,l){return u0(t^(r|~n),e,r,a,s,l)}function Su(e){var r,t=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=e.length;r+=64)pc(n,Up(e.substring(r-64,r)));e=e.substring(r-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<e.length;r++)a[r>>2]|=e.charCodeAt(r)<<(r%4<<3);if(a[r>>2]|=128<<(r%4<<3),r>55)for(pc(n,a),r=0;r<16;r++)a[r]=0;return a[14]=8*t,pc(n,a),n}function Up(e){var r,t=[];for(r=0;r<64;r+=4)t[r>>2]=e.charCodeAt(r)+(e.charCodeAt(r+1)<<8)+(e.charCodeAt(r+2)<<16)+(e.charCodeAt(r+3)<<24);return t}yo=xt.atob.bind(xt),Ic=xt.btoa.bind(xt);var sh="0123456789abcdef".split("");function Hp(e){for(var r="",t=0;t<4;t++)r+=sh[e>>8*t+4&15]+sh[e>>8*t&15];return r}function Wp(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function Dc(e){return Su(e).map(Wp).join("")}var zp=function(e){for(var r=0;r<e.length;r++)e[r]=Hp(e[r]);return e.join("")}(Su("hello"))!="5d41402abc4b2a76b9719d911017c592";function di(e,r){if(zp){var t=(65535&e)+(65535&r);return(e>>16)+(r>>16)+(t>>16)<<16|65535&t}return e+r&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Rc(e,r){var t,n,a,s;if(e!==t){for(var l=(a=e,s=1+(256/e.length>>0),new Array(s+1).join(a)),c=[],f=0;f<256;f++)c[f]=f;var u=0;for(f=0;f<256;f++){var d=c[f];u=(u+d+l.charCodeAt(f))%256,c[f]=c[u],c[u]=d}t=e,n=c}else c=n;var g=r.length,x=0,p=0,w="";for(f=0;f<g;f++)p=(p+(d=c[x=(x+1)%256]))%256,c[x]=c[p],c[p]=d,l=c[(c[x]+c[p])%256],w+=String.fromCharCode(r.charCodeAt(f)^l);return w}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var oh={print:4,modify:8,copy:16,"annot-forms":32};function js(e,r,t,n){this.v=1,this.r=2;var a=192;e.forEach(function(c){if(oh.perm!==void 0)throw new Error("Invalid permission: "+c);a+=oh[c]}),this.padding="(Â¿N^NuÂŠAd\0NVÃ¿Ãº\b..\0Â¶Ãh>Â€/\fÂ©Ã¾dSiz";var s=(r+this.padding).substr(0,32),l=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,l),this.P=-(1+(255^a)),this.encryptionKey=Dc(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Rc(this.encryptionKey,this.padding)}function ks(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var r="",t=e.length,n=0;n<t;n++){var a=e.charCodeAt(n);a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?r+="#"+("0"+a.toString(16)).slice(-2):r+=e[n]}return r}function lh(e){if(rr(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var r={};this.subscribe=function(t,n,a){if(a=a||!1,typeof t!="string"||typeof n!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");r.hasOwnProperty(t)||(r[t]={});var s=Math.random().toString(35);return r[t][s]=[n,!!a],s},this.unsubscribe=function(t){for(var n in r)if(r[n][t])return delete r[n][t],Object.keys(r[n]).length===0&&delete r[n],!0;return!1},this.publish=function(t){if(r.hasOwnProperty(t)){var n=Array.prototype.slice.call(arguments,1),a=[];for(var s in r[t]){var l=r[t][s];try{l[0].apply(e,n)}catch(c){xt.console&&tr.error("jsPDF PubSub Error",c.message,c)}l[1]&&a.push(s)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return r}}function Co(e){if(!(this instanceof Co))return new Co(e);var r="opacity,stroke-opacity".split(",");for(var t in e)e.hasOwnProperty(t)&&r.indexOf(t)>=0&&(this[t]=e[t]);this.id="",this.objectNumber=-1}function Au(e,r){this.gState=e,this.matrix=r,this.id="",this.objectNumber=-1}function ui(e,r,t,n,a){if(!(this instanceof ui))return new ui(e,r,t,n,a);this.type=e==="axial"?2:3,this.coords=r,this.colors=t,Au.call(this,n,a)}function Ii(e,r,t,n,a){if(!(this instanceof Ii))return new Ii(e,r,t,n,a);this.boundingBox=e,this.xStep=r,this.yStep=t,this.stream="",this.cloneIndex=0,Au.call(this,n,a)}function mt(e){var r,t=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],a=arguments[2],s=arguments[3],l=[],c=1,f=16,u="S",d=null;rr(e=e||{})==="object"&&(t=e.orientation,n=e.unit||n,a=e.format||a,s=e.compress||e.compressPdf||s,(d=e.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),c=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(r=e.precision),e.floatPrecision!==void 0&&(f=e.floatPrecision),u=e.defaultPathOperation||"S"),l=e.filters||(s===!0?["FlateEncode"]:l),n=n||"mm",t=(""+(t||"P")).toLowerCase();var g=e.putOnlyUsedFonts||!1,x={},p={internal:{},__private__:{}};p.__private__.PubSub=lh;var w="1.3",v=p.__private__.getPdfVersion=function(){return w};p.__private__.setPdfVersion=function(y){w=y};var _={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};p.__private__.getPageFormats=function(){return _};var S=p.__private__.getPageFormat=function(y){return _[y]};a=a||"a4";var b={COMPAT:"compat",ADVANCED:"advanced"},A=b.COMPAT;function E(){this.saveGraphicsState(),le(new dt(rt,0,0,-rt,0,Ka()*rt).toString()+" cm"),this.setFontSize(this.getFontSize()/rt),u="n",A=b.ADVANCED}function U(){this.restoreGraphicsState(),u="S",A=b.COMPAT}var R=p.__private__.combineFontStyleAndFontWeight=function(y,B){if(y=="bold"&&B=="normal"||y=="bold"&&B==400||y=="normal"&&B=="italic"||y=="bold"&&B=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return B&&(y=B==400||B==="normal"?y==="italic"?"italic":"normal":B!=700&&B!=="bold"||y!=="normal"?(B==700?"bold":B)+""+y:"bold"),y};p.advancedAPI=function(y){var B=A===b.COMPAT;return B&&E.call(this),typeof y!="function"||(y(this),B&&U.call(this)),this},p.compatAPI=function(y){var B=A===b.ADVANCED;return B&&U.call(this),typeof y!="function"||(y(this),B&&E.call(this)),this},p.isAdvancedAPI=function(){return A===b.ADVANCED};var L,C=function(y){if(A!==b.ADVANCED)throw new Error(y+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},P=p.roundToPrecision=p.__private__.roundToPrecision=function(y,B){var se=r||B;if(isNaN(y)||isNaN(se))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return y.toFixed(se).replace(/0+$/,"")};L=p.hpf=p.__private__.hpf=typeof f=="number"?function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.hpf");return P(y,f)}:f==="smart"?function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.hpf");return P(y,y>-1&&y<1?16:5)}:function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.hpf");return P(y,16)};var W=p.f2=p.__private__.f2=function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.f2");return P(y,2)},k=p.__private__.f3=function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.f3");return P(y,3)},T=p.scale=p.__private__.scale=function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.scale");return A===b.COMPAT?y*rt:A===b.ADVANCED?y:void 0},H=function(y){return A===b.COMPAT?Ka()-y:A===b.ADVANCED?y:void 0},G=function(y){return T(H(y))};p.__private__.setPrecision=p.setPrecision=function(y){typeof parseInt(y,10)=="number"&&(r=parseInt(y,10))};var ce,J="00000000000000000000000000000000",Q=p.__private__.getFileId=function(){return J},oe=p.__private__.setFileId=function(y){return J=y!==void 0&&/^[a-fA-F0-9]{32}$/.test(y)?y.toUpperCase():J.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(Zr=new js(d.userPermissions,d.userPassword,d.ownerPassword,J)),J};p.setFileId=function(y){return oe(y),this},p.getFileId=function(){return Q()};var ae=p.__private__.convertDateToPDFDate=function(y){var B=y.getTimezoneOffset(),se=B<0?"+":"-",de=Math.floor(Math.abs(B/60)),we=Math.abs(B%60),Le=[se,I(de),"'",I(we),"'"].join("");return["D:",y.getFullYear(),I(y.getMonth()+1),I(y.getDate()),I(y.getHours()),I(y.getMinutes()),I(y.getSeconds()),Le].join("")},ge=p.__private__.convertPDFDateToDate=function(y){var B=parseInt(y.substr(2,4),10),se=parseInt(y.substr(6,2),10)-1,de=parseInt(y.substr(8,2),10),we=parseInt(y.substr(10,2),10),Le=parseInt(y.substr(12,2),10),ze=parseInt(y.substr(14,2),10);return new Date(B,se,de,we,Le,ze,0)},ve=p.__private__.setCreationDate=function(y){var B;if(y===void 0&&(y=new Date),y instanceof Date)B=ae(y);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(y))throw new Error("Invalid argument passed to jsPDF.setCreationDate");B=y}return ce=B},j=p.__private__.getCreationDate=function(y){var B=ce;return y==="jsDate"&&(B=ge(ce)),B};p.setCreationDate=function(y){return ve(y),this},p.getCreationDate=function(y){return j(y)};var O,I=p.__private__.padd2=function(y){return("0"+parseInt(y)).slice(-2)},D=p.__private__.padd2Hex=function(y){return("00"+(y=y.toString())).substr(y.length)},X=0,fe=[],he=[],ue=0,be=[],Oe=[],Me=!1,Ve=he,Je=function(){X=0,ue=0,he=[],fe=[],be=[],Z=fr(),ee=fr()};p.__private__.setCustomOutputDestination=function(y){Me=!0,Ve=y};var Ee=function(y){Me||(Ve=y)};p.__private__.resetCustomOutputDestination=function(){Me=!1,Ve=he};var le=p.__private__.out=function(y){return y=y.toString(),ue+=y.length+1,Ve.push(y),Ve},Be=p.__private__.write=function(y){return le(arguments.length===1?y.toString():Array.prototype.join.call(arguments," "))},it=p.__private__.getArrayBuffer=function(y){for(var B=y.length,se=new ArrayBuffer(B),de=new Uint8Array(se);B--;)de[B]=y.charCodeAt(B);return se},We=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];p.__private__.getStandardFonts=function(){return We};var $e=e.fontSize||16;p.__private__.setFontSize=p.setFontSize=function(y){return $e=A===b.ADVANCED?y/rt:y,this};var Ze,et=p.__private__.getFontSize=p.getFontSize=function(){return A===b.COMPAT?$e:$e*rt},ft=e.R2L||!1;p.__private__.setR2L=p.setR2L=function(y){return ft=y,this},p.__private__.getR2L=p.getR2L=function(){return ft};var ht,yt=p.__private__.setZoomMode=function(y){var B=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(y))Ze=y;else if(isNaN(y)){if(B.indexOf(y)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+y+'" is not recognized.');Ze=y}else Ze=parseInt(y,10)};p.__private__.getZoomMode=function(){return Ze};var At,Ft=p.__private__.setPageMode=function(y){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(y)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+y+'" is not recognized.');ht=y};p.__private__.getPageMode=function(){return ht};var Ct=p.__private__.setLayoutMode=function(y){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(y)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+y+'" is not recognized.');At=y};p.__private__.getLayoutMode=function(){return At},p.__private__.setDisplayMode=p.setDisplayMode=function(y,B,se){return yt(y),Ct(B),Ft(se),this};var gt={title:"",subject:"",author:"",keywords:"",creator:""};p.__private__.getDocumentProperty=function(y){if(Object.keys(gt).indexOf(y)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return gt[y]},p.__private__.getDocumentProperties=function(){return gt},p.__private__.setDocumentProperties=p.setProperties=p.setDocumentProperties=function(y){for(var B in gt)gt.hasOwnProperty(B)&&y[B]&&(gt[B]=y[B]);return this},p.__private__.setDocumentProperty=function(y,B){if(Object.keys(gt).indexOf(y)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return gt[y]=B};var kt,rt,Cr,Pt,pn,Wt={},nr={},Mn=[],Dt={},ga={},sr={},An={},Zn=null,Qt=0,wt=[],Mt=new lh(p),Fa=e.hotfixes||[],Lr={},Bn={},Un=[],dt=function y(B,se,de,we,Le,ze){if(!(this instanceof y))return new y(B,se,de,we,Le,ze);isNaN(B)&&(B=1),isNaN(se)&&(se=0),isNaN(de)&&(de=0),isNaN(we)&&(we=1),isNaN(Le)&&(Le=0),isNaN(ze)&&(ze=0),this._matrix=[B,se,de,we,Le,ze]};Object.defineProperty(dt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(y){this._matrix[0]=y}}),Object.defineProperty(dt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(y){this._matrix[1]=y}}),Object.defineProperty(dt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(y){this._matrix[2]=y}}),Object.defineProperty(dt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(y){this._matrix[3]=y}}),Object.defineProperty(dt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(y){this._matrix[4]=y}}),Object.defineProperty(dt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(y){this._matrix[5]=y}}),Object.defineProperty(dt.prototype,"a",{get:function(){return this._matrix[0]},set:function(y){this._matrix[0]=y}}),Object.defineProperty(dt.prototype,"b",{get:function(){return this._matrix[1]},set:function(y){this._matrix[1]=y}}),Object.defineProperty(dt.prototype,"c",{get:function(){return this._matrix[2]},set:function(y){this._matrix[2]=y}}),Object.defineProperty(dt.prototype,"d",{get:function(){return this._matrix[3]},set:function(y){this._matrix[3]=y}}),Object.defineProperty(dt.prototype,"e",{get:function(){return this._matrix[4]},set:function(y){this._matrix[4]=y}}),Object.defineProperty(dt.prototype,"f",{get:function(){return this._matrix[5]},set:function(y){this._matrix[5]=y}}),Object.defineProperty(dt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(dt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(dt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(dt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),dt.prototype.join=function(y){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(L).join(y)},dt.prototype.multiply=function(y){var B=y.sx*this.sx+y.shy*this.shx,se=y.sx*this.shy+y.shy*this.sy,de=y.shx*this.sx+y.sy*this.shx,we=y.shx*this.shy+y.sy*this.sy,Le=y.tx*this.sx+y.ty*this.shx+this.tx,ze=y.tx*this.shy+y.ty*this.sy+this.ty;return new dt(B,se,de,we,Le,ze)},dt.prototype.decompose=function(){var y=this.sx,B=this.shy,se=this.shx,de=this.sy,we=this.tx,Le=this.ty,ze=Math.sqrt(y*y+B*B),st=(y/=ze)*se+(B/=ze)*de;se-=y*st,de-=B*st;var ut=Math.sqrt(se*se+de*de);return st/=ut,y*(de/=ut)<B*(se/=ut)&&(y=-y,B=-B,st=-st,ze=-ze),{scale:new dt(ze,0,0,ut,0,0),translate:new dt(1,0,0,1,we,Le),rotate:new dt(y,B,-B,y,0,0),skew:new dt(1,0,st,1,0,0)}},dt.prototype.toString=function(y){return this.join(" ")},dt.prototype.inversed=function(){var y=this.sx,B=this.shy,se=this.shx,de=this.sy,we=this.tx,Le=this.ty,ze=1/(y*de-B*se),st=de*ze,ut=-B*ze,St=-se*ze,Nt=y*ze;return new dt(st,ut,St,Nt,-st*we-St*Le,-ut*we-Nt*Le)},dt.prototype.applyToPoint=function(y){var B=y.x*this.sx+y.y*this.shx+this.tx,se=y.x*this.shy+y.y*this.sy+this.ty;return new ns(B,se)},dt.prototype.applyToRectangle=function(y){var B=this.applyToPoint(y),se=this.applyToPoint(new ns(y.x+y.w,y.y+y.h));return new Ys(B.x,B.y,se.x-B.x,se.y-B.y)},dt.prototype.clone=function(){var y=this.sx,B=this.shy,se=this.shx,de=this.sy,we=this.tx,Le=this.ty;return new dt(y,B,se,de,we,Le)},p.Matrix=dt;var jn=p.matrixMult=function(y,B){return B.multiply(y)},mn=new dt(1,0,0,1,0,0);p.unitMatrix=p.identityMatrix=mn;var Jr=function(y,B){if(!ga[y]){var se=(B instanceof ui?"Sh":"P")+(Object.keys(Dt).length+1).toString(10);B.id=se,ga[y]=se,Dt[se]=B,Mt.publish("addPattern",B)}};p.ShadingPattern=ui,p.TilingPattern=Ii,p.addShadingPattern=function(y,B){return C("addShadingPattern()"),Jr(y,B),this},p.beginTilingPattern=function(y){C("beginTilingPattern()"),ol(y.boundingBox[0],y.boundingBox[1],y.boundingBox[2]-y.boundingBox[0],y.boundingBox[3]-y.boundingBox[1],y.matrix)},p.endTilingPattern=function(y,B){C("endTilingPattern()"),B.stream=Oe[O].join(`
`),Jr(y,B),Mt.publish("endTilingPattern",B),Un.pop().restore()};var xr=p.__private__.newObject=function(){var y=fr();return q(y,!0),y},fr=p.__private__.newObjectDeferred=function(){return X++,fe[X]=function(){return ue},X},q=function(y,B){return B=typeof B=="boolean"&&B,fe[y]=ue,B&&le(y+" 0 obj"),y},ne=p.__private__.newAdditionalObject=function(){var y={objId:fr(),content:""};return be.push(y),y},Z=fr(),ee=fr(),re=p.__private__.decodeColorString=function(y){var B=y.split(" ");if(B.length!==2||B[1]!=="g"&&B[1]!=="G")B.length===5&&(B[4]==="k"||B[4]==="K")&&(B=[(1-B[0])*(1-B[3]),(1-B[1])*(1-B[3]),(1-B[2])*(1-B[3]),"r"]);else{var se=parseFloat(B[0]);B=[se,se,se,"r"]}for(var de="#",we=0;we<3;we++)de+=("0"+Math.floor(255*parseFloat(B[we])).toString(16)).slice(-2);return de},ie=p.__private__.encodeColorString=function(y){var B;typeof y=="string"&&(y={ch1:y});var se=y.ch1,de=y.ch2,we=y.ch3,Le=y.ch4,ze=y.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof se=="string"&&se.charAt(0)!=="#"){var st=new _u(se);if(st.ok)se=st.toHex();else if(!/^\d*\.?\d*$/.test(se))throw new Error('Invalid color "'+se+'" passed to jsPDF.encodeColorString.')}if(typeof se=="string"&&/^#[0-9A-Fa-f]{3}$/.test(se)&&(se="#"+se[1]+se[1]+se[2]+se[2]+se[3]+se[3]),typeof se=="string"&&/^#[0-9A-Fa-f]{6}$/.test(se)){var ut=parseInt(se.substr(1),16);se=ut>>16&255,de=ut>>8&255,we=255&ut}if(de===void 0||Le===void 0&&se===de&&de===we)if(typeof se=="string")B=se+" "+ze[0];else switch(y.precision){case 2:B=W(se/255)+" "+ze[0];break;case 3:default:B=k(se/255)+" "+ze[0]}else if(Le===void 0||rr(Le)==="object"){if(Le&&!isNaN(Le.a)&&Le.a===0)return B=["1.","1.","1.",ze[1]].join(" ");if(typeof se=="string")B=[se,de,we,ze[1]].join(" ");else switch(y.precision){case 2:B=[W(se/255),W(de/255),W(we/255),ze[1]].join(" ");break;default:case 3:B=[k(se/255),k(de/255),k(we/255),ze[1]].join(" ")}}else if(typeof se=="string")B=[se,de,we,Le,ze[2]].join(" ");else switch(y.precision){case 2:B=[W(se),W(de),W(we),W(Le),ze[2]].join(" ");break;case 3:default:B=[k(se),k(de),k(we),k(Le),ze[2]].join(" ")}return B},_e=p.__private__.getFilters=function(){return l},Fe=p.__private__.putStream=function(y){var B=(y=y||{}).data||"",se=y.filters||_e(),de=y.alreadyAppliedFilters||[],we=y.addLength1||!1,Le=B.length,ze=y.objectId,st=function(Qr){return Qr};if(d!==null&&ze===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(st=Zr.encryptor(ze,0));var ut={};se===!0&&(se=["FlateEncode"]);var St=y.additionalKeyValues||[],Nt=(ut=mt.API.processDataByFilters!==void 0?mt.API.processDataByFilters(B,se):{data:B,reverseChain:[]}).reverseChain+(Array.isArray(de)?de.join(" "):de.toString());if(ut.data.length!==0&&(St.push({key:"Length",value:ut.data.length}),we===!0&&St.push({key:"Length1",value:Le})),Nt.length!=0)if(Nt.split("/").length-1==1)St.push({key:"Filter",value:Nt});else{St.push({key:"Filter",value:"["+Nt+"]"});for(var Ot=0;Ot<St.length;Ot+=1)if(St[Ot].key==="DecodeParms"){for(var cr=[],hr=0;hr<ut.reverseChain.split("/").length-1;hr+=1)cr.push("null");cr.push(St[Ot].value),St[Ot].value="["+cr.join(" ")+"]"}}le("<<");for(var Ar=0;Ar<St.length;Ar++)le("/"+St[Ar].key+" "+St[Ar].value);le(">>"),ut.data.length!==0&&(le("stream"),le(st(ut.data)),le("endstream"))},Ne=p.__private__.putPage=function(y){var B=y.number,se=y.data,de=y.objId,we=y.contentsObjId;q(de,!0),le("<</Type /Page"),le("/Parent "+y.rootDictionaryObjId+" 0 R"),le("/Resources "+y.resourceDictionaryObjId+" 0 R"),le("/MediaBox ["+parseFloat(L(y.mediaBox.bottomLeftX))+" "+parseFloat(L(y.mediaBox.bottomLeftY))+" "+L(y.mediaBox.topRightX)+" "+L(y.mediaBox.topRightY)+"]"),y.cropBox!==null&&le("/CropBox ["+L(y.cropBox.bottomLeftX)+" "+L(y.cropBox.bottomLeftY)+" "+L(y.cropBox.topRightX)+" "+L(y.cropBox.topRightY)+"]"),y.bleedBox!==null&&le("/BleedBox ["+L(y.bleedBox.bottomLeftX)+" "+L(y.bleedBox.bottomLeftY)+" "+L(y.bleedBox.topRightX)+" "+L(y.bleedBox.topRightY)+"]"),y.trimBox!==null&&le("/TrimBox ["+L(y.trimBox.bottomLeftX)+" "+L(y.trimBox.bottomLeftY)+" "+L(y.trimBox.topRightX)+" "+L(y.trimBox.topRightY)+"]"),y.artBox!==null&&le("/ArtBox ["+L(y.artBox.bottomLeftX)+" "+L(y.artBox.bottomLeftY)+" "+L(y.artBox.topRightX)+" "+L(y.artBox.topRightY)+"]"),typeof y.userUnit=="number"&&y.userUnit!==1&&le("/UserUnit "+y.userUnit),Mt.publish("putPage",{objId:de,pageContext:wt[B],pageNumber:B,page:se}),le("/Contents "+we+" 0 R"),le(">>"),le("endobj");var Le=se.join(`
`);return A===b.ADVANCED&&(Le+=`
Q`),q(we,!0),Fe({data:Le,filters:_e(),objectId:we}),le("endobj"),de},je=p.__private__.putPages=function(){var y,B,se=[];for(y=1;y<=Qt;y++)wt[y].objId=fr(),wt[y].contentsObjId=fr();for(y=1;y<=Qt;y++)se.push(Ne({number:y,data:Oe[y],objId:wt[y].objId,contentsObjId:wt[y].contentsObjId,mediaBox:wt[y].mediaBox,cropBox:wt[y].cropBox,bleedBox:wt[y].bleedBox,trimBox:wt[y].trimBox,artBox:wt[y].artBox,userUnit:wt[y].userUnit,rootDictionaryObjId:Z,resourceDictionaryObjId:ee}));q(Z,!0),le("<</Type /Pages");var de="/Kids [";for(B=0;B<Qt;B++)de+=se[B]+" 0 R ";le(de+"]"),le("/Count "+Qt),le(">>"),le("endobj"),Mt.publish("postPutPages")},ke=function(y){Mt.publish("putFont",{font:y,out:le,newObject:xr,putStream:Fe}),y.isAlreadyPutted!==!0&&(y.objectNumber=xr(),le("<<"),le("/Type /Font"),le("/BaseFont /"+ks(y.postScriptName)),le("/Subtype /Type1"),typeof y.encoding=="string"&&le("/Encoding /"+y.encoding),le("/FirstChar 32"),le("/LastChar 255"),le(">>"),le("endobj"))},qe=function(){for(var y in Wt)Wt.hasOwnProperty(y)&&(g===!1||g===!0&&x.hasOwnProperty(y))&&ke(Wt[y])},Ye=function(y){y.objectNumber=xr();var B=[];B.push({key:"Type",value:"/XObject"}),B.push({key:"Subtype",value:"/Form"}),B.push({key:"BBox",value:"["+[L(y.x),L(y.y),L(y.x+y.width),L(y.y+y.height)].join(" ")+"]"}),B.push({key:"Matrix",value:"["+y.matrix.toString()+"]"});var se=y.pages[1].join(`
`);Fe({data:se,additionalKeyValues:B,objectId:y.objectNumber}),le("endobj")},at=function(){for(var y in Lr)Lr.hasOwnProperty(y)&&Ye(Lr[y])},Ge=function(y,B){var se,de=[],we=1/(B-1);for(se=0;se<1;se+=we)de.push(se);if(de.push(1),y[0].offset!=0){var Le={offset:0,color:y[0].color};y.unshift(Le)}if(y[y.length-1].offset!=1){var ze={offset:1,color:y[y.length-1].color};y.push(ze)}for(var st="",ut=0,St=0;St<de.length;St++){for(se=de[St];se>y[ut+1].offset;)ut++;var Nt=y[ut].offset,Ot=(se-Nt)/(y[ut+1].offset-Nt),cr=y[ut].color,hr=y[ut+1].color;st+=D(Math.round((1-Ot)*cr[0]+Ot*hr[0]).toString(16))+D(Math.round((1-Ot)*cr[1]+Ot*hr[1]).toString(16))+D(Math.round((1-Ot)*cr[2]+Ot*hr[2]).toString(16))}return st.trim()},nt=function(y,B){B||(B=21);var se=xr(),de=Ge(y.colors,B),we=[];we.push({key:"FunctionType",value:"0"}),we.push({key:"Domain",value:"[0.0 1.0]"}),we.push({key:"Size",value:"["+B+"]"}),we.push({key:"BitsPerSample",value:"8"}),we.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),we.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Fe({data:de,additionalKeyValues:we,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:se}),le("endobj"),y.objectNumber=xr(),le("<< /ShadingType "+y.type),le("/ColorSpace /DeviceRGB");var Le="/Coords ["+L(parseFloat(y.coords[0]))+" "+L(parseFloat(y.coords[1]))+" ";y.type===2?Le+=L(parseFloat(y.coords[2]))+" "+L(parseFloat(y.coords[3])):Le+=L(parseFloat(y.coords[2]))+" "+L(parseFloat(y.coords[3]))+" "+L(parseFloat(y.coords[4]))+" "+L(parseFloat(y.coords[5])),le(Le+="]"),y.matrix&&le("/Matrix ["+y.matrix.toString()+"]"),le("/Function "+se+" 0 R"),le("/Extend [true true]"),le(">>"),le("endobj")},vt=function(y,B){var se=fr(),de=xr();B.push({resourcesOid:se,objectOid:de}),y.objectNumber=de;var we=[];we.push({key:"Type",value:"/Pattern"}),we.push({key:"PatternType",value:"1"}),we.push({key:"PaintType",value:"1"}),we.push({key:"TilingType",value:"1"}),we.push({key:"BBox",value:"["+y.boundingBox.map(L).join(" ")+"]"}),we.push({key:"XStep",value:L(y.xStep)}),we.push({key:"YStep",value:L(y.yStep)}),we.push({key:"Resources",value:se+" 0 R"}),y.matrix&&we.push({key:"Matrix",value:"["+y.matrix.toString()+"]"}),Fe({data:y.stream,additionalKeyValues:we,objectId:y.objectNumber}),le("endobj")},zt=function(y){var B;for(B in Dt)Dt.hasOwnProperty(B)&&(Dt[B]instanceof ui?nt(Dt[B]):Dt[B]instanceof Ii&&vt(Dt[B],y))},Kt=function(y){for(var B in y.objectNumber=xr(),le("<<"),y)switch(B){case"opacity":le("/ca "+W(y[B]));break;case"stroke-opacity":le("/CA "+W(y[B]))}le(">>"),le("endobj")},Sr=function(){var y;for(y in sr)sr.hasOwnProperty(y)&&Kt(sr[y])},Qn=function(){for(var y in le("/XObject <<"),Lr)Lr.hasOwnProperty(y)&&Lr[y].objectNumber>=0&&le("/"+y+" "+Lr[y].objectNumber+" 0 R");Mt.publish("putXobjectDict"),le(">>")},Ca=function(){Zr.oid=xr(),le("<<"),le("/Filter /Standard"),le("/V "+Zr.v),le("/R "+Zr.r),le("/U <"+Zr.toHexString(Zr.U)+">"),le("/O <"+Zr.toHexString(Zr.O)+">"),le("/P "+Zr.P),le(">>"),le("endobj")},xa=function(){for(var y in le("/Font <<"),Wt)Wt.hasOwnProperty(y)&&(g===!1||g===!0&&x.hasOwnProperty(y))&&le("/"+y+" "+Wt[y].objectNumber+" 0 R");le(">>")},ea=function(){if(Object.keys(Dt).length>0){for(var y in le("/Shading <<"),Dt)Dt.hasOwnProperty(y)&&Dt[y]instanceof ui&&Dt[y].objectNumber>=0&&le("/"+y+" "+Dt[y].objectNumber+" 0 R");Mt.publish("putShadingPatternDict"),le(">>")}},va=function(y){if(Object.keys(Dt).length>0){for(var B in le("/Pattern <<"),Dt)Dt.hasOwnProperty(B)&&Dt[B]instanceof p.TilingPattern&&Dt[B].objectNumber>=0&&Dt[B].objectNumber<y&&le("/"+B+" "+Dt[B].objectNumber+" 0 R");Mt.publish("putTilingPatternDict"),le(">>")}},kn=function(){if(Object.keys(sr).length>0){var y;for(y in le("/ExtGState <<"),sr)sr.hasOwnProperty(y)&&sr[y].objectNumber>=0&&le("/"+y+" "+sr[y].objectNumber+" 0 R");Mt.publish("putGStateDict"),le(">>")}},vr=function(y){q(y.resourcesOid,!0),le("<<"),le("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),xa(),ea(),va(y.objectOid),kn(),Qn(),le(">>"),le("endobj")},Go=function(){var y=[];qe(),Sr(),at(),zt(y),Mt.publish("putResources"),y.forEach(vr),vr({resourcesOid:ee,objectOid:Number.MAX_SAFE_INTEGER}),Mt.publish("postPutResources")},$o=function(){Mt.publish("putAdditionalObjects");for(var y=0;y<be.length;y++){var B=be[y];q(B.objId,!0),le(B.content),le("endobj")}Mt.publish("postPutAdditionalObjects")},Yo=function(y){nr[y.fontName]=nr[y.fontName]||{},nr[y.fontName][y.fontStyle]=y.id},Bs=function(y,B,se,de,we){var Le={id:"F"+(Object.keys(Wt).length+1).toString(10),postScriptName:y,fontName:B,fontStyle:se,encoding:de,isStandardFont:we||!1,metadata:{}};return Mt.publish("addFont",{font:Le,instance:this}),Wt[Le.id]=Le,Yo(Le),Le.id},b0=function(y){for(var B=0,se=We.length;B<se;B++){var de=Bs.call(this,y[B][0],y[B][1],y[B][2],We[B][3],!0);g===!1&&(x[de]=!0);var we=y[B][0].split("-");Yo({id:de,fontName:we[0],fontStyle:we[1]||""})}Mt.publish("addFonts",{fonts:Wt,dictionary:nr})},ta=function(y){return y.foo=function(){try{return y.apply(this,arguments)}catch(de){var B=de.stack||"";~B.indexOf(" at ")&&(B=B.split(" at ")[1]);var se="Error in function "+B.split(`
`)[0].split("<")[0]+": "+de.message;if(!xt.console)throw new Error(se);xt.console.error(se,de),xt.alert&&alert(se)}},y.foo.bar=y,y.foo},Ji=function(y,B){var se,de,we,Le,ze,st,ut,St,Nt;if(we=(B=B||{}).sourceEncoding||"Unicode",ze=B.outputEncoding,(B.autoencode||ze)&&Wt[kt].metadata&&Wt[kt].metadata[we]&&Wt[kt].metadata[we].encoding&&(Le=Wt[kt].metadata[we].encoding,!ze&&Wt[kt].encoding&&(ze=Wt[kt].encoding),!ze&&Le.codePages&&(ze=Le.codePages[0]),typeof ze=="string"&&(ze=Le[ze]),ze)){for(ut=!1,st=[],se=0,de=y.length;se<de;se++)(St=ze[y.charCodeAt(se)])?st.push(String.fromCharCode(St)):st.push(y[se]),st[se].charCodeAt(0)>>8&&(ut=!0);y=st.join("")}for(se=y.length;ut===void 0&&se!==0;)y.charCodeAt(se-1)>>8&&(ut=!0),se--;if(!ut)return y;for(st=B.noBOM?[]:[254,255],se=0,de=y.length;se<de;se++){if((Nt=(St=y.charCodeAt(se))>>8)>>8)throw new Error("Character at position "+se+" of string '"+y+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");st.push(Nt),st.push(St-(Nt<<8))}return String.fromCharCode.apply(void 0,st)},gn=p.__private__.pdfEscape=p.pdfEscape=function(y,B){return Ji(y,B).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Us=p.__private__.beginPage=function(y){Oe[++Qt]=[],wt[Qt]={objId:0,contentsObjId:0,userUnit:Number(c),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(y[0]),topRightY:Number(y[1])}},Ko(Qt),Ee(Oe[O])},Xo=function(y,B){var se,de,we;switch(t=B||t,typeof y=="string"&&(se=S(y.toLowerCase()),Array.isArray(se)&&(de=se[0],we=se[1])),Array.isArray(y)&&(de=y[0]*rt,we=y[1]*rt),isNaN(de)&&(de=a[0],we=a[1]),(de>14400||we>14400)&&(tr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),de=Math.min(14400,de),we=Math.min(14400,we)),a=[de,we],t.substr(0,1)){case"l":we>de&&(a=[we,de]);break;case"p":de>we&&(a=[we,de])}Us(a),rl(qs),le(ra),Gs!==0&&le(Gs+" J"),$s!==0&&le($s+" j"),Mt.publish("addPage",{pageNumber:Qt})},N0=function(y){y>0&&y<=Qt&&(Oe.splice(y,1),wt.splice(y,1),Qt--,O>Qt&&(O=Qt),this.setPage(O))},Ko=function(y){y>0&&y<=Qt&&(O=y)},_0=p.__private__.getNumberOfPages=p.getNumberOfPages=function(){return Oe.length-1},Jo=function(y,B,se){var de,we=void 0;return se=se||{},y=y!==void 0?y:Wt[kt].fontName,B=B!==void 0?B:Wt[kt].fontStyle,de=y.toLowerCase(),nr[de]!==void 0&&nr[de][B]!==void 0?we=nr[de][B]:nr[y]!==void 0&&nr[y][B]!==void 0?we=nr[y][B]:se.disableWarning===!1&&tr.warn("Unable to look up font label for font '"+y+"', '"+B+"'. Refer to getFontList() for available fonts."),we||se.noFallback||(we=nr.times[B])==null&&(we=nr.times.normal),we},S0=p.__private__.putInfo=function(){var y=xr(),B=function(de){return de};for(var se in d!==null&&(B=Zr.encryptor(y,0)),le("<<"),le("/Producer ("+gn(B("jsPDF "+mt.version))+")"),gt)gt.hasOwnProperty(se)&&gt[se]&&le("/"+se.substr(0,1).toUpperCase()+se.substr(1)+" ("+gn(B(gt[se]))+")");le("/CreationDate ("+gn(B(ce))+")"),le(">>"),le("endobj")},Hs=p.__private__.putCatalog=function(y){var B=(y=y||{}).rootDictionaryObjId||Z;switch(xr(),le("<<"),le("/Type /Catalog"),le("/Pages "+B+" 0 R"),Ze||(Ze="fullwidth"),Ze){case"fullwidth":le("/OpenAction [3 0 R /FitH null]");break;case"fullheight":le("/OpenAction [3 0 R /FitV null]");break;case"fullpage":le("/OpenAction [3 0 R /Fit]");break;case"original":le("/OpenAction [3 0 R /XYZ null null 1]");break;default:var se=""+Ze;se.substr(se.length-1)==="%"&&(Ze=parseInt(Ze)/100),typeof Ze=="number"&&le("/OpenAction [3 0 R /XYZ null null "+W(Ze)+"]")}switch(At||(At="continuous"),At){case"continuous":le("/PageLayout /OneColumn");break;case"single":le("/PageLayout /SinglePage");break;case"two":case"twoleft":le("/PageLayout /TwoColumnLeft");break;case"tworight":le("/PageLayout /TwoColumnRight")}ht&&le("/PageMode /"+ht),Mt.publish("putCatalog"),le(">>"),le("endobj")},A0=p.__private__.putTrailer=function(){le("trailer"),le("<<"),le("/Size "+(X+1)),le("/Root "+X+" 0 R"),le("/Info "+(X-1)+" 0 R"),d!==null&&le("/Encrypt "+Zr.oid+" 0 R"),le("/ID [ <"+J+"> <"+J+"> ]"),le(">>")},j0=p.__private__.putHeader=function(){le("%PDF-"+w),le("%ÂºÃŸÂ¬Ã ")},k0=p.__private__.putXRef=function(){var y="0000000000";le("xref"),le("0 "+(X+1)),le("0000000000 65535 f ");for(var B=1;B<=X;B++)typeof fe[B]=="function"?le((y+fe[B]()).slice(-10)+" 00000 n "):fe[B]!==void 0?le((y+fe[B]).slice(-10)+" 00000 n "):le("0000000000 00000 n ")},La=p.__private__.buildDocument=function(){Je(),Ee(he),Mt.publish("buildDocument"),j0(),je(),$o(),Go(),d!==null&&Ca(),S0(),Hs();var y=ue;return k0(),A0(),le("startxref"),le(""+y),le("%%EOF"),Ee(Oe[O]),he.join(`
`)},Zi=p.__private__.getBlob=function(y){return new Blob([it(y)],{type:"application/pdf"})},Qi=p.output=p.__private__.output=ta(function(y,B){switch(typeof(B=B||{})=="string"?B={filename:B}:B.filename=B.filename||"generated.pdf",y){case void 0:return La();case"save":p.save(B.filename);break;case"arraybuffer":return it(La());case"blob":return Zi(La());case"bloburi":case"bloburl":if(xt.URL!==void 0&&typeof xt.URL.createObjectURL=="function")return xt.URL&&xt.URL.createObjectURL(Zi(La()))||void 0;tr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var se="",de=La();try{se=Ic(de)}catch{se=Ic(unescape(encodeURIComponent(de)))}return"data:application/pdf;filename="+B.filename+";base64,"+se;case"pdfobjectnewwindow":if(Object.prototype.toString.call(xt)==="[object Window]"){var we="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Le=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';B.pdfObjectUrl&&(we=B.pdfObjectUrl,Le="");var ze='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+we+'"'+Le+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(B)+");<\/script></body></html>",st=xt.open();return st!==null&&st.document.write(ze),st}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(xt)==="[object Window]"){var ut='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(B.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+B.filename+'" width="500px" height="400px" /></body></html>',St=xt.open();if(St!==null){St.document.write(ut);var Nt=this;St.document.documentElement.querySelector("#pdfViewer").onload=function(){St.document.title=B.filename,St.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Nt.output("bloburl"))}}return St}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(xt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Ot='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",B)+'"></iframe></body></html>',cr=xt.open();if(cr!==null&&(cr.document.write(Ot),cr.document.title=B.filename),cr||typeof safari>"u")return cr;break;case"datauri":case"dataurl":return xt.document.location.href=this.output("datauristring",B);default:return null}}),Zo=function(y){return Array.isArray(Fa)===!0&&Fa.indexOf(y)>-1};switch(n){case"pt":rt=1;break;case"mm":rt=72/25.4;break;case"cm":rt=72/2.54;break;case"in":rt=72;break;case"px":rt=Zo("px_scaling")==1?.75:96/72;break;case"pc":case"em":rt=12;break;case"ex":rt=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);rt=n}var Zr=null;ve(),oe();var T0=function(y){return d!==null?Zr.encryptor(y,0):function(B){return B}},Qo=p.__private__.getPageInfo=p.getPageInfo=function(y){if(isNaN(y)||y%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:wt[y].objId,pageNumber:y,pageContext:wt[y]}},bt=p.__private__.getPageInfoByObjId=function(y){if(isNaN(y)||y%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var B in wt)if(wt[B].objId===y)break;return Qo(B)},E0=p.__private__.getCurrentPageInfo=p.getCurrentPageInfo=function(){return{objId:wt[O].objId,pageNumber:O,pageContext:wt[O]}};p.addPage=function(){return Xo.apply(this,arguments),this},p.setPage=function(){return Ko.apply(this,arguments),Ee.call(this,Oe[O]),this},p.insertPage=function(y){return this.addPage(),this.movePage(O,y),this},p.movePage=function(y,B){var se,de;if(y>B){se=Oe[y],de=wt[y];for(var we=y;we>B;we--)Oe[we]=Oe[we-1],wt[we]=wt[we-1];Oe[B]=se,wt[B]=de,this.setPage(B)}else if(y<B){se=Oe[y],de=wt[y];for(var Le=y;Le<B;Le++)Oe[Le]=Oe[Le+1],wt[Le]=wt[Le+1];Oe[B]=se,wt[B]=de,this.setPage(B)}return this},p.deletePage=function(){return N0.apply(this,arguments),this},p.__private__.text=p.text=function(y,B,se,de,we){var Le,ze,st,ut,St,Nt,Ot,cr,hr,Ar=(de=de||{}).scope||this;if(typeof y=="number"&&typeof B=="number"&&(typeof se=="string"||Array.isArray(se))){var Qr=se;se=B,B=y,y=Qr}if(arguments[3]instanceof dt?(C("The transform parameter of text() with a Matrix value"),hr=we):(st=arguments[4],ut=arguments[5],rr(Ot=arguments[3])==="object"&&Ot!==null||(typeof st=="string"&&(ut=st,st=null),typeof Ot=="string"&&(ut=Ot,Ot=null),typeof Ot=="number"&&(st=Ot,Ot=null),de={flags:Ot,angle:st,align:ut})),isNaN(B)||isNaN(se)||y==null)throw new Error("Invalid arguments passed to jsPDF.text");if(y.length===0)return Ar;var Rr="",na=!1,Tn=typeof de.lineHeightFactor=="number"?de.lineHeightFactor:Si,ba=Ar.internal.scaleFactor;function ll(ar){return ar=ar.split("	").join(Array(de.TabLen||9).join(" ")),gn(ar,Ot)}function Zs(ar){for(var ir,wr=ar.concat(),Pr=[],Ra=wr.length;Ra--;)typeof(ir=wr.shift())=="string"?Pr.push(ir):Array.isArray(ar)&&(ir.length===1||ir[1]===void 0&&ir[2]===void 0)?Pr.push(ir[0]):Pr.push([ir[0],ir[1],ir[2]]);return Pr}function Qs(ar,ir){var wr;if(typeof ar=="string")wr=ir(ar)[0];else if(Array.isArray(ar)){for(var Pr,Ra,oo=ar.concat(),ps=[],dl=oo.length;dl--;)typeof(Pr=oo.shift())=="string"?ps.push(ir(Pr)[0]):Array.isArray(Pr)&&typeof Pr[0]=="string"&&(Ra=ir(Pr[0],Pr[1],Pr[2]),ps.push([Ra[0],Ra[1],Ra[2]]));wr=ps}return wr}var is=!1,eo=!0;if(typeof y=="string")is=!0;else if(Array.isArray(y)){var to=y.concat();ze=[];for(var ss,zr=to.length;zr--;)(typeof(ss=to.shift())!="string"||Array.isArray(ss)&&typeof ss[0]!="string")&&(eo=!1);is=eo}if(is===!1)throw new Error('Type of text must be string or Array. "'+y+'" is not recognized.');typeof y=="string"&&(y=y.match(/[\r?\n]/)?y.split(/\r\n|\r|\n/g):[y]);var os=$e/Ar.internal.scaleFactor,ls=os*(Tn-1);switch(de.baseline){case"bottom":se-=ls;break;case"top":se+=os-ls;break;case"hanging":se+=os-2*ls;break;case"middle":se+=os/2-ls}if((Nt=de.maxWidth||0)>0&&(typeof y=="string"?y=Ar.splitTextToSize(y,Nt):Object.prototype.toString.call(y)==="[object Array]"&&(y=y.reduce(function(ar,ir){return ar.concat(Ar.splitTextToSize(ir,Nt))},[]))),Le={text:y,x:B,y:se,options:de,mutex:{pdfEscape:gn,activeFontKey:kt,fonts:Wt,activeFontSize:$e}},Mt.publish("preProcessText",Le),y=Le.text,st=(de=Le.options).angle,!(hr instanceof dt)&&st&&typeof st=="number"){st*=Math.PI/180,de.rotationDirection===0&&(st=-st),A===b.ADVANCED&&(st=-st);var cs=Math.cos(st),ro=Math.sin(st);hr=new dt(cs,ro,-ro,cs,0,0)}else st&&st instanceof dt&&(hr=st);A!==b.ADVANCED||hr||(hr=mn),(St=de.charSpace||rs)!==void 0&&(Rr+=L(T(St))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(cr=de.horizontalScale)!==void 0&&(Rr+=L(100*cr)+` Tz
`),de.lang;var xn=-1,B0=de.renderingMode!==void 0?de.renderingMode:de.stroke,no=Ar.internal.getCurrentPageInfo().pageContext;switch(B0){case 0:case!1:case"fill":xn=0;break;case 1:case!0:case"stroke":xn=1;break;case 2:case"fillThenStroke":xn=2;break;case 3:case"invisible":xn=3;break;case 4:case"fillAndAddForClipping":xn=4;break;case 5:case"strokeAndAddPathForClipping":xn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":xn=6;break;case 7:case"addToPathForClipping":xn=7}var cl=no.usedRenderingMode!==void 0?no.usedRenderingMode:-1;xn!==-1?Rr+=xn+` Tr
`:cl!==-1&&(Rr+=`0 Tr
`),xn!==-1&&(no.usedRenderingMode=xn),ut=de.align||"left";var Hn,fs=$e*Tn,fl=Ar.internal.pageSize.getWidth(),hl=Wt[kt];St=de.charSpace||rs,Nt=de.maxWidth||0,Ot=Object.assign({autoencode:!0,noBOM:!0},de.flags);var Ja=[],ki=function(ar){return Ar.getStringUnitWidth(ar,{font:hl,charSpace:St,fontSize:$e,doKerning:!1})*$e/ba};if(Object.prototype.toString.call(y)==="[object Array]"){var vn;ze=Zs(y),ut!=="left"&&(Hn=ze.map(ki));var ln,Za=0;if(ut==="right"){B-=Hn[0],y=[],zr=ze.length;for(var Oa=0;Oa<zr;Oa++)Oa===0?(ln=wa(B),vn=Pa(se)):(ln=T(Za-Hn[Oa]),vn=-fs),y.push([ze[Oa],ln,vn]),Za=Hn[Oa]}else if(ut==="center"){B-=Hn[0]/2,y=[],zr=ze.length;for(var Ia=0;Ia<zr;Ia++)Ia===0?(ln=wa(B),vn=Pa(se)):(ln=T((Za-Hn[Ia])/2),vn=-fs),y.push([ze[Ia],ln,vn]),Za=Hn[Ia]}else if(ut==="left"){y=[],zr=ze.length;for(var hs=0;hs<zr;hs++)y.push(ze[hs])}else if(ut==="justify"&&hl.encoding==="Identity-H"){y=[],zr=ze.length,Nt=Nt!==0?Nt:fl;for(var Da=0,yr=0;yr<zr;yr++)if(vn=yr===0?Pa(se):-fs,ln=yr===0?wa(B):Da,yr<zr-1){var ao=T((Nt-Hn[yr])/(ze[yr].split(" ").length-1)),cn=ze[yr].split(" ");y.push([cn[0]+" ",ln,vn]),Da=0;for(var Wn=1;Wn<cn.length;Wn++){var us=(ki(cn[Wn-1]+" "+cn[Wn])-ki(cn[Wn]))*ba+ao;Wn==cn.length-1?y.push([cn[Wn],us,0]):y.push([cn[Wn]+" ",us,0]),Da-=us}}else y.push([ze[yr],ln,vn]);y.push(["",Da,0])}else{if(ut!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(y=[],zr=ze.length,Nt=Nt!==0?Nt:fl,yr=0;yr<zr;yr++)vn=yr===0?Pa(se):-fs,ln=yr===0?wa(B):0,yr<zr-1?Ja.push(L(T((Nt-Hn[yr])/(ze[yr].split(" ").length-1)))):Ja.push(0),y.push([ze[yr],ln,vn])}}var ul=typeof de.R2L=="boolean"?de.R2L:ft;ul===!0&&(y=Qs(y,function(ar,ir,wr){return[ar.split("").reverse().join(""),ir,wr]})),Le={text:y,x:B,y:se,options:de,mutex:{pdfEscape:gn,activeFontKey:kt,fonts:Wt,activeFontSize:$e}},Mt.publish("postProcessText",Le),y=Le.text,na=Le.mutex.isHex||!1;var io=Wt[kt].encoding;io!=="WinAnsiEncoding"&&io!=="StandardEncoding"||(y=Qs(y,function(ar,ir,wr){return[ll(ar),ir,wr]})),ze=Zs(y),y=[];for(var Ti,Ei,Qa,Fi=0,ds=1,Ci=Array.isArray(ze[0])?ds:Fi,ei="",so=function(ar,ir,wr){var Pr="";return wr instanceof dt?(wr=typeof de.angle=="number"?jn(wr,new dt(1,0,0,1,ar,ir)):jn(new dt(1,0,0,1,ar,ir),wr),A===b.ADVANCED&&(wr=jn(new dt(1,0,0,-1,0,0),wr)),Pr=wr.join(" ")+` Tm
`):Pr=L(ar)+" "+L(ir)+` Td
`,Pr},zn=0;zn<ze.length;zn++){switch(ei="",Ci){case ds:Qa=(na?"<":"(")+ze[zn][0]+(na?">":")"),Ti=parseFloat(ze[zn][1]),Ei=parseFloat(ze[zn][2]);break;case Fi:Qa=(na?"<":"(")+ze[zn]+(na?">":")"),Ti=wa(B),Ei=Pa(se)}Ja!==void 0&&Ja[zn]!==void 0&&(ei=Ja[zn]+` Tw
`),zn===0?y.push(ei+so(Ti,Ei,hr)+Qa):Ci===Fi?y.push(ei+Qa):Ci===ds&&y.push(ei+so(Ti,Ei,hr)+Qa)}y=Ci===Fi?y.join(` Tj
T* `):y.join(` Tj
`),y+=` Tj
`;var qn=`BT
/`;return qn+=kt+" "+$e+` Tf
`,qn+=L($e*Tn)+` TL
`,qn+=Ai+`
`,qn+=Rr,qn+=y,le(qn+="ET"),x[kt]=!0,Ar};var F0=p.__private__.clip=p.clip=function(y){return le(y==="evenodd"?"W*":"W"),this};p.clipEvenOdd=function(){return F0("evenodd")},p.__private__.discardPath=p.discardPath=function(){return le("n"),this};var ya=p.__private__.isValidStyle=function(y){var B=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(y)!==-1&&(B=!0),B};p.__private__.setDefaultPathOperation=p.setDefaultPathOperation=function(y){return ya(y)&&(u=y),this};var el=p.__private__.getStyle=p.getStyle=function(y){var B=u;switch(y){case"D":case"S":B="S";break;case"F":B="f";break;case"FD":case"DF":B="B";break;case"f":case"f*":case"B":case"B*":B=y}return B},tl=p.close=function(){return le("h"),this};p.stroke=function(){return le("S"),this},p.fill=function(y){return es("f",y),this},p.fillEvenOdd=function(y){return es("f*",y),this},p.fillStroke=function(y){return es("B",y),this},p.fillStrokeEvenOdd=function(y){return es("B*",y),this};var es=function(y,B){rr(B)==="object"?L0(B,y):le(y)},Ws=function(y){y===null||A===b.ADVANCED&&y===void 0||(y=el(y),le(y))};function C0(y,B,se,de,we){var Le=new Ii(B||this.boundingBox,se||this.xStep,de||this.yStep,this.gState,we||this.matrix);Le.stream=this.stream;var ze=y+"$$"+this.cloneIndex+++"$$";return Jr(ze,Le),Le}var L0=function(y,B){var se=ga[y.key],de=Dt[se];if(de instanceof ui)le("q"),le(P0(B)),de.gState&&p.setGState(de.gState),le(y.matrix.toString()+" cm"),le("/"+se+" sh"),le("Q");else if(de instanceof Ii){var we=new dt(1,0,0,-1,0,Ka());y.matrix&&(we=we.multiply(y.matrix||mn),se=C0.call(de,y.key,y.boundingBox,y.xStep,y.yStep,we).id),le("q"),le("/Pattern cs"),le("/"+se+" scn"),de.gState&&p.setGState(de.gState),le(B),le("Q")}},P0=function(y){switch(y){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},zs=p.moveTo=function(y,B){return le(L(T(y))+" "+L(G(B))+" m"),this},_i=p.lineTo=function(y,B){return le(L(T(y))+" "+L(G(B))+" l"),this},Ya=p.curveTo=function(y,B,se,de,we,Le){return le([L(T(y)),L(G(B)),L(T(se)),L(G(de)),L(T(we)),L(G(Le)),"c"].join(" ")),this};p.__private__.line=p.line=function(y,B,se,de,we){if(isNaN(y)||isNaN(B)||isNaN(se)||isNaN(de)||!ya(we))throw new Error("Invalid arguments passed to jsPDF.line");return A===b.COMPAT?this.lines([[se-y,de-B]],y,B,[1,1],we||"S"):this.lines([[se-y,de-B]],y,B,[1,1]).stroke()},p.__private__.lines=p.lines=function(y,B,se,de,we,Le){var ze,st,ut,St,Nt,Ot,cr,hr,Ar,Qr,Rr,na;if(typeof y=="number"&&(na=se,se=B,B=y,y=na),de=de||[1,1],Le=Le||!1,isNaN(B)||isNaN(se)||!Array.isArray(y)||!Array.isArray(de)||!ya(we)||typeof Le!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(zs(B,se),ze=de[0],st=de[1],St=y.length,Qr=B,Rr=se,ut=0;ut<St;ut++)(Nt=y[ut]).length===2?(Qr=Nt[0]*ze+Qr,Rr=Nt[1]*st+Rr,_i(Qr,Rr)):(Ot=Nt[0]*ze+Qr,cr=Nt[1]*st+Rr,hr=Nt[2]*ze+Qr,Ar=Nt[3]*st+Rr,Qr=Nt[4]*ze+Qr,Rr=Nt[5]*st+Rr,Ya(Ot,cr,hr,Ar,Qr,Rr));return Le&&tl(),Ws(we),this},p.path=function(y){for(var B=0;B<y.length;B++){var se=y[B],de=se.c;switch(se.op){case"m":zs(de[0],de[1]);break;case"l":_i(de[0],de[1]);break;case"c":Ya.apply(this,de);break;case"h":tl()}}return this},p.__private__.rect=p.rect=function(y,B,se,de,we){if(isNaN(y)||isNaN(B)||isNaN(se)||isNaN(de)||!ya(we))throw new Error("Invalid arguments passed to jsPDF.rect");return A===b.COMPAT&&(de=-de),le([L(T(y)),L(G(B)),L(T(se)),L(T(de)),"re"].join(" ")),Ws(we),this},p.__private__.triangle=p.triangle=function(y,B,se,de,we,Le,ze){if(isNaN(y)||isNaN(B)||isNaN(se)||isNaN(de)||isNaN(we)||isNaN(Le)||!ya(ze))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[se-y,de-B],[we-se,Le-de],[y-we,B-Le]],y,B,[1,1],ze,!0),this},p.__private__.roundedRect=p.roundedRect=function(y,B,se,de,we,Le,ze){if(isNaN(y)||isNaN(B)||isNaN(se)||isNaN(de)||isNaN(we)||isNaN(Le)||!ya(ze))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var st=4/3*(Math.SQRT2-1);return we=Math.min(we,.5*se),Le=Math.min(Le,.5*de),this.lines([[se-2*we,0],[we*st,0,we,Le-Le*st,we,Le],[0,de-2*Le],[0,Le*st,-we*st,Le,-we,Le],[2*we-se,0],[-we*st,0,-we,-Le*st,-we,-Le],[0,2*Le-de],[0,-Le*st,we*st,-Le,we,-Le]],y+we,B,[1,1],ze,!0),this},p.__private__.ellipse=p.ellipse=function(y,B,se,de,we){if(isNaN(y)||isNaN(B)||isNaN(se)||isNaN(de)||!ya(we))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Le=4/3*(Math.SQRT2-1)*se,ze=4/3*(Math.SQRT2-1)*de;return zs(y+se,B),Ya(y+se,B-ze,y+Le,B-de,y,B-de),Ya(y-Le,B-de,y-se,B-ze,y-se,B),Ya(y-se,B+ze,y-Le,B+de,y,B+de),Ya(y+Le,B+de,y+se,B+ze,y+se,B),Ws(we),this},p.__private__.circle=p.circle=function(y,B,se,de){if(isNaN(y)||isNaN(B)||isNaN(se)||!ya(de))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(y,B,se,se,de)},p.setFont=function(y,B,se){return se&&(B=R(B,se)),kt=Jo(y,B,{disableWarning:!1}),this};var O0=p.__private__.getFont=p.getFont=function(){return Wt[Jo.apply(p,arguments)]};p.__private__.getFontList=p.getFontList=function(){var y,B,se={};for(y in nr)if(nr.hasOwnProperty(y))for(B in se[y]=[],nr[y])nr[y].hasOwnProperty(B)&&se[y].push(B);return se},p.addFont=function(y,B,se,de,we){var Le=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Le.indexOf(arguments[3])!==-1?we=arguments[3]:arguments[3]&&Le.indexOf(arguments[3])==-1&&(se=R(se,de)),we=we||"Identity-H",Bs.call(this,y,B,se,we)};var Si,qs=e.lineWidth||.200025,ts=p.__private__.getLineWidth=p.getLineWidth=function(){return qs},rl=p.__private__.setLineWidth=p.setLineWidth=function(y){return qs=y,le(L(T(y))+" w"),this};p.__private__.setLineDash=mt.API.setLineDash=mt.API.setLineDashPattern=function(y,B){if(y=y||[],B=B||0,isNaN(B)||!Array.isArray(y))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return y=y.map(function(se){return L(T(se))}).join(" "),B=L(T(B)),le("["+y+"] "+B+" d"),this};var nl=p.__private__.getLineHeight=p.getLineHeight=function(){return $e*Si};p.__private__.getLineHeight=p.getLineHeight=function(){return $e*Si};var al=p.__private__.setLineHeightFactor=p.setLineHeightFactor=function(y){return typeof(y=y||1.15)=="number"&&(Si=y),this},il=p.__private__.getLineHeightFactor=p.getLineHeightFactor=function(){return Si};al(e.lineHeight);var wa=p.__private__.getHorizontalCoordinate=function(y){return T(y)},Pa=p.__private__.getVerticalCoordinate=function(y){return A===b.ADVANCED?y:wt[O].mediaBox.topRightY-wt[O].mediaBox.bottomLeftY-T(y)},I0=p.__private__.getHorizontalCoordinateString=p.getHorizontalCoordinateString=function(y){return L(wa(y))},Xa=p.__private__.getVerticalCoordinateString=p.getVerticalCoordinateString=function(y){return L(Pa(y))},ra=e.strokeColor||"0 G";p.__private__.getStrokeColor=p.getDrawColor=function(){return re(ra)},p.__private__.setStrokeColor=p.setDrawColor=function(y,B,se,de){return ra=ie({ch1:y,ch2:B,ch3:se,ch4:de,pdfColorType:"draw",precision:2}),le(ra),this};var Vs=e.fillColor||"0 g";p.__private__.getFillColor=p.getFillColor=function(){return re(Vs)},p.__private__.setFillColor=p.setFillColor=function(y,B,se,de){return Vs=ie({ch1:y,ch2:B,ch3:se,ch4:de,pdfColorType:"fill",precision:2}),le(Vs),this};var Ai=e.textColor||"0 g",D0=p.__private__.getTextColor=p.getTextColor=function(){return re(Ai)};p.__private__.setTextColor=p.setTextColor=function(y,B,se,de){return Ai=ie({ch1:y,ch2:B,ch3:se,ch4:de,pdfColorType:"text",precision:3}),this};var rs=e.charSpace,R0=p.__private__.getCharSpace=p.getCharSpace=function(){return parseFloat(rs||0)};p.__private__.setCharSpace=p.setCharSpace=function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return rs=y,this};var Gs=0;p.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},p.__private__.setLineCap=p.setLineCap=function(y){var B=p.CapJoinStyles[y];if(B===void 0)throw new Error("Line cap style of '"+y+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Gs=B,le(B+" J"),this};var $s=0;p.__private__.setLineJoin=p.setLineJoin=function(y){var B=p.CapJoinStyles[y];if(B===void 0)throw new Error("Line join style of '"+y+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return $s=B,le(B+" j"),this},p.__private__.setLineMiterLimit=p.__private__.setMiterLimit=p.setLineMiterLimit=p.setMiterLimit=function(y){if(y=y||0,isNaN(y))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return le(L(T(y))+" M"),this},p.GState=Co,p.setGState=function(y){(y=typeof y=="string"?sr[An[y]]:sl(null,y)).equals(Zn)||(le("/"+y.id+" gs"),Zn=y)};var sl=function(y,B){if(!y||!An[y]){var se=!1;for(var de in sr)if(sr.hasOwnProperty(de)&&sr[de].equals(B)){se=!0;break}if(se)B=sr[de];else{var we="GS"+(Object.keys(sr).length+1).toString(10);sr[we]=B,B.id=we}return y&&(An[y]=B.id),Mt.publish("addGState",B),B}};p.addGState=function(y,B){return sl(y,B),this},p.saveGraphicsState=function(){return le("q"),Mn.push({key:kt,size:$e,color:Ai}),this},p.restoreGraphicsState=function(){le("Q");var y=Mn.pop();return kt=y.key,$e=y.size,Ai=y.color,Zn=null,this},p.setCurrentTransformationMatrix=function(y){return le(y.toString()+" cm"),this},p.comment=function(y){return le("#"+y),this};var ns=function(y,B){var se=y||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return se},set:function(Le){isNaN(Le)||(se=parseFloat(Le))}});var de=B||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return de},set:function(Le){isNaN(Le)||(de=parseFloat(Le))}});var we="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return we},set:function(Le){we=Le.toString()}}),this},Ys=function(y,B,se,de){ns.call(this,y,B),this.type="rect";var we=se||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return we},set:function(ze){isNaN(ze)||(we=parseFloat(ze))}});var Le=de||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Le},set:function(ze){isNaN(ze)||(Le=parseFloat(ze))}}),this},Xs=function(){this.page=Qt,this.currentPage=O,this.pages=Oe.slice(0),this.pagesContext=wt.slice(0),this.x=Cr,this.y=Pt,this.matrix=pn,this.width=ji(O),this.height=Ka(O),this.outputDestination=Ve,this.id="",this.objectNumber=-1};Xs.prototype.restore=function(){Qt=this.page,O=this.currentPage,wt=this.pagesContext,Oe=this.pages,Cr=this.x,Pt=this.y,pn=this.matrix,Ks(O,this.width),Js(O,this.height),Ve=this.outputDestination};var ol=function(y,B,se,de,we){Un.push(new Xs),Qt=O=0,Oe=[],Cr=y,Pt=B,pn=we,Us([se,de])},M0=function(y){if(Bn[y])Un.pop().restore();else{var B=new Xs,se="Xo"+(Object.keys(Lr).length+1).toString(10);B.id=se,Bn[y]=se,Lr[se]=B,Mt.publish("addFormObject",B),Un.pop().restore()}};for(var as in p.beginFormObject=function(y,B,se,de,we){return ol(y,B,se,de,we),this},p.endFormObject=function(y){return M0(y),this},p.doFormObject=function(y,B){var se=Lr[Bn[y]];return le("q"),le(B.toString()+" cm"),le("/"+se.id+" Do"),le("Q"),this},p.getFormObject=function(y){var B=Lr[Bn[y]];return{x:B.x,y:B.y,width:B.width,height:B.height,matrix:B.matrix}},p.save=function(y,B){return y=y||"generated.pdf",(B=B||{}).returnPromise=B.returnPromise||!1,B.returnPromise===!1?(Pi(Zi(La()),y),typeof Pi.unload=="function"&&xt.setTimeout&&setTimeout(Pi.unload,911),this):new Promise(function(se,de){try{var we=Pi(Zi(La()),y);typeof Pi.unload=="function"&&xt.setTimeout&&setTimeout(Pi.unload,911),se(we)}catch(Le){de(Le.message)}})},mt.API)mt.API.hasOwnProperty(as)&&(as==="events"&&mt.API.events.length?function(y,B){var se,de,we;for(we=B.length-1;we!==-1;we--)se=B[we][0],de=B[we][1],y.subscribe.apply(y,[se].concat(typeof de=="function"?[de]:de))}(Mt,mt.API.events):p[as]=mt.API[as]);var ji=p.getPageWidth=function(y){return(wt[y=y||O].mediaBox.topRightX-wt[y].mediaBox.bottomLeftX)/rt},Ks=p.setPageWidth=function(y,B){wt[y].mediaBox.topRightX=B*rt+wt[y].mediaBox.bottomLeftX},Ka=p.getPageHeight=function(y){return(wt[y=y||O].mediaBox.topRightY-wt[y].mediaBox.bottomLeftY)/rt},Js=p.setPageHeight=function(y,B){wt[y].mediaBox.topRightY=B*rt+wt[y].mediaBox.bottomLeftY};return p.internal={pdfEscape:gn,getStyle:el,getFont:O0,getFontSize:et,getCharSpace:R0,getTextColor:D0,getLineHeight:nl,getLineHeightFactor:il,getLineWidth:ts,write:Be,getHorizontalCoordinate:wa,getVerticalCoordinate:Pa,getCoordinateString:I0,getVerticalCoordinateString:Xa,collections:{},newObject:xr,newAdditionalObject:ne,newObjectDeferred:fr,newObjectDeferredBegin:q,getFilters:_e,putStream:Fe,events:Mt,scaleFactor:rt,pageSize:{getWidth:function(){return ji(O)},setWidth:function(y){Ks(O,y)},getHeight:function(){return Ka(O)},setHeight:function(y){Js(O,y)}},encryptionOptions:d,encryption:Zr,getEncryptor:T0,output:Qi,getNumberOfPages:_0,pages:Oe,out:le,f2:W,f3:k,getPageInfo:Qo,getPageInfoByObjId:bt,getCurrentPageInfo:E0,getPDFVersion:v,Point:ns,Rectangle:Ys,Matrix:dt,hasHotfix:Zo},Object.defineProperty(p.internal.pageSize,"width",{get:function(){return ji(O)},set:function(y){Ks(O,y)},enumerable:!0,configurable:!0}),Object.defineProperty(p.internal.pageSize,"height",{get:function(){return Ka(O)},set:function(y){Js(O,y)},enumerable:!0,configurable:!0}),b0.call(p,We),kt="F1",Xo(a,t),Mt.publish("initialized"),p}js.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},js.prototype.toHexString=function(e){return e.split("").map(function(r){return("0"+(255&r.charCodeAt(0)).toString(16)).slice(-2)}).join("")},js.prototype.hexToBytes=function(e){for(var r=[],t=0;t<e.length;t+=2)r.push(String.fromCharCode(parseInt(e.substr(t,2),16)));return r.join("")},js.prototype.processOwnerPassword=function(e,r){return Rc(Dc(r).substr(0,5),e)},js.prototype.encryptor=function(e,r){var t=Dc(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&r,r>>8&255)).substr(0,10);return function(n){return Rc(t,n)}},Co.prototype.equals=function(e){var r,t="id,objectNumber,equals";if(!e||rr(e)!==rr(this))return!1;var n=0;for(r in this)if(!(t.indexOf(r)>=0)){if(this.hasOwnProperty(r)&&!e.hasOwnProperty(r)||this[r]!==e[r])return!1;n++}for(r in e)e.hasOwnProperty(r)&&t.indexOf(r)<0&&n--;return n===0},mt.API={events:[]},mt.version="2.5.2";var dr=mt.API,Xc=1,Vi=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ys=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},_t=function(e){return e.toFixed(2)},fi=function(e){return e.toFixed(5)};dr.__acroform__={};var Sn=function(e,r){e.prototype=Object.create(r.prototype),e.prototype.constructor=e},ch=function(e){return e*Xc},_a=function(e){var r=new ku,t=lt.internal.getHeight(e)||0,n=lt.internal.getWidth(e)||0;return r.BBox=[0,0,Number(_t(n)),Number(_t(t))],r},qp=dr.__acroform__.setBit=function(e,r){if(e=e||0,r=r||0,isNaN(e)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<r},Vp=dr.__acroform__.clearBit=function(e,r){if(e=e||0,r=r||0,isNaN(e)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<r)},Gp=dr.__acroform__.getBit=function(e,r){if(isNaN(e)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<r?1:0},br=dr.__acroform__.getBitForPdf=function(e,r){if(isNaN(e)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Gp(e,r-1)},Nr=dr.__acroform__.setBitForPdf=function(e,r){if(isNaN(e)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return qp(e,r-1)},_r=dr.__acroform__.clearBitForPdf=function(e,r){if(isNaN(e)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Vp(e,r-1)},$p=dr.__acroform__.calculateCoordinates=function(e,r){var t=r.internal.getHorizontalCoordinate,n=r.internal.getVerticalCoordinate,a=e[0],s=e[1],l=e[2],c=e[3],f={};return f.lowerLeft_X=t(a)||0,f.lowerLeft_Y=n(s+c)||0,f.upperRight_X=t(a+l)||0,f.upperRight_Y=n(s)||0,[Number(_t(f.lowerLeft_X)),Number(_t(f.lowerLeft_Y)),Number(_t(f.upperRight_X)),Number(_t(f.upperRight_Y))]},Yp=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var r=[],t=e._V||e.DV,n=Mc(e,t),a=e.scope.internal.getFont(e.fontName,e.fontStyle).id;r.push("/Tx BMC"),r.push("q"),r.push("BT"),r.push(e.scope.__private__.encodeColorString(e.color)),r.push("/"+a+" "+_t(n.fontSize)+" Tf"),r.push("1 0 0 1 0 0 Tm"),r.push(n.text),r.push("ET"),r.push("Q"),r.push("EMC");var s=_a(e);return s.scope=e.scope,s.stream=r.join(`
`),s}},Mc=function(e,r){var t=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},a=(r=(r=r.substr(0,1)=="("?r.substr(1):r).substr(r.length-1)==")"?r.substr(0,r.length-1):r).split(" ");a=e.multiline?a.map(function(k){return k.split(`
`)}):a.map(function(k){return[k]});var s=t,l=lt.internal.getHeight(e)||0;l=l<0?-l:l;var c=lt.internal.getWidth(e)||0;c=c<0?-c:c;var f=function(k,T,H){if(k+1<a.length){var G=T+" "+a[k+1][0];return Rl(G,e,H).width<=c-4}return!1};s++;e:for(;s>0;){r="",s--;var u,d,g=Rl("3",e,s).height,x=e.multiline?l-s:(l-g)/2,p=x+=2,w=0,v=0,_=0;if(s<=0){r=`(...) Tj
`,r+="% Width of Text: "+Rl(r,e,s=12).width+", FieldWidth:"+c+`
`;break}for(var S="",b=0,A=0;A<a.length;A++)if(a.hasOwnProperty(A)){var E=!1;if(a[A].length!==1&&_!==a[A].length-1){if((g+2)*(b+2)+2>l)continue e;S+=a[A][_],E=!0,v=A,A--}else{S=(S+=a[A][_]+" ").substr(S.length-1)==" "?S.substr(0,S.length-1):S;var U=parseInt(A),R=f(U,S,s),L=A>=a.length-1;if(R&&!L){S+=" ",_=0;continue}if(R||L){if(L)v=U;else if(e.multiline&&(g+2)*(b+2)+2>l)continue e}else{if(!e.multiline||(g+2)*(b+2)+2>l)continue e;v=U}}for(var C="",P=w;P<=v;P++){var W=a[P];if(e.multiline){if(P===v){C+=W[_]+" ",_=(_+1)%W.length;continue}if(P===w){C+=W[W.length-1]+" ";continue}}C+=W[0]+" "}switch(C=C.substr(C.length-1)==" "?C.substr(0,C.length-1):C,d=Rl(C,e,s).width,e.textAlign){case"right":u=c-d-2;break;case"center":u=(c-d)/2;break;case"left":default:u=2}r+=_t(u)+" "+_t(p)+` Td
`,r+="("+Vi(C)+`) Tj
`,r+=-_t(u)+` 0 Td
`,p=-(s+2),d=0,w=E?v:v+1,b++,S=""}break}return n.text=r,n.fontSize=s,n},Rl=function(e,r,t){var n=r.scope.internal.getFont(r.fontName,r.fontStyle),a=r.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:r.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:a}},Xp={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Kp=function(e,r){var t={type:"reference",object:e};r.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===t.type&&n.object===t.object})===void 0&&r.internal.getPageInfo(e.page).pageContext.annotations.push(t)},Jp=function(e,r){for(var t in e)if(e.hasOwnProperty(t)){var n=t,a=e[t];r.internal.newObjectDeferredBegin(a.objId,!0),rr(a)==="object"&&typeof a.putStream=="function"&&a.putStream(),delete e[n]}},Zp=function(e,r){if(r.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(pa.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(Xp)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Xc=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new Tu,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in n)if(n.hasOwnProperty(a)){var s=n[a];s.objId=void 0,s.hasAnnotation&&Kp(s,t)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(t){(function(n,a){var s=!n;for(var l in n||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(l)){var c=n[l],f=[],u=c.Rect;if(c.Rect&&(c.Rect=$p(c.Rect,a)),a.internal.newObjectDeferredBegin(c.objId,!0),c.DA=lt.createDefaultAppearanceStream(c),rr(c)==="object"&&typeof c.getKeyValueListForStream=="function"&&(f=c.getKeyValueListForStream()),c.Rect=u,c.hasAppearanceStream&&!c.appearanceStreamContent){var d=Yp(c);f.push({key:"AP",value:"<</N "+d+">>"}),a.internal.acroformPlugin.xForms.push(d)}if(c.appearanceStreamContent){var g="";for(var x in c.appearanceStreamContent)if(c.appearanceStreamContent.hasOwnProperty(x)){var p=c.appearanceStreamContent[x];if(g+="/"+x+" ",g+="<<",Object.keys(p).length>=1||Array.isArray(p)){for(var l in p)if(p.hasOwnProperty(l)){var w=p[l];typeof w=="function"&&(w=w.call(a,c)),g+="/"+l+" "+w+" ",a.internal.acroformPlugin.xForms.indexOf(w)>=0||a.internal.acroformPlugin.xForms.push(w)}}else typeof(w=p)=="function"&&(w=w.call(a,c)),g+="/"+l+" "+w,a.internal.acroformPlugin.xForms.indexOf(w)>=0||a.internal.acroformPlugin.xForms.push(w);g+=">>"}f.push({key:"AP",value:`<<
`+g+">>"})}a.internal.putStream({additionalKeyValues:f,objectId:c.objId}),a.internal.out("endobj")}s&&Jp(a.internal.acroformPlugin.xForms,a)})(t,e)}),e.internal.acroformPlugin.isInitialized=!0}},ju=dr.__acroform__.arrayToPdfArray=function(e,r,t){var n=function(l){return l};if(Array.isArray(e)){for(var a="[",s=0;s<e.length;s++)switch(s!==0&&(a+=" "),rr(e[s])){case"boolean":case"number":case"object":a+=e[s].toString();break;case"string":e[s].substr(0,1)!=="/"?(r!==void 0&&t&&(n=t.internal.getEncryptor(r)),a+="("+Vi(n(e[s].toString()))+")"):a+=e[s].toString()}return a+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},mc=function(e,r,t){var n=function(a){return a};return r!==void 0&&t&&(n=t.internal.getEncryptor(r)),(e=e||"").toString(),e="("+Vi(n(e))+")"},ja=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};ja.prototype.toString=function(){return this.objId+" 0 R"},ja.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},ja.prototype.getKeyValueListForStream=function(){var e=[],r=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var t in r)if(Object.getOwnPropertyDescriptor(this,r[t]).configurable===!1){var n=r[t],a=this[n];a&&(Array.isArray(a)?e.push({key:n,value:ju(a,this.objId,this.scope)}):a instanceof ja?(a.scope=this.scope,e.push({key:n,value:a.objId+" 0 R"})):typeof a!="function"&&e.push({key:n,value:a}))}return e};var ku=function(){ja.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,r=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){e=t.trim()},get:function(){return e||null}})};Sn(ku,ja);var Tu=function(){ja.call(this);var e,r=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return r.length>0?r:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return r}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var t=function(n){return n};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+Vi(t(e))+")"}},set:function(t){e=t}})};Sn(Tu,ja);var pa=function e(){ja.call(this);var r=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return r},set:function(S){if(isNaN(S))throw new Error('Invalid value "'+S+'" for attribute F supplied.');r=S}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!br(r,3)},set:function(S){S?this.F=Nr(r,3):this.F=_r(r,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(S){if(isNaN(S))throw new Error('Invalid value "'+S+'" for attribute Ff supplied.');t=S}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(S){n=S!==void 0?S:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(S){n[0]=S}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(S){n[1]=S}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(S){n[2]=S}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(S){n[3]=S}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(S){switch(S){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=S;break;default:throw new Error('Invalid value "'+S+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof Yl)return;s="FieldObject"+e.FieldNum++}var S=function(b){return b};return this.scope&&(S=this.scope.internal.getEncryptor(this.objId)),"("+Vi(S(s))+")"},set:function(S){s=S.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(S){s=S}});var l="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return l},set:function(S){l=S}});var c="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return c},set:function(S){c=S}});var f=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return f},set:function(S){f=S}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/Xc:u},set:function(S){u=S}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(S){d=S}});var g="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!g||this instanceof Yl||this instanceof gi))return mc(g,this.objId,this.scope)},set:function(S){S=S.toString(),g=S}});var x=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(x)return this instanceof Dr?x:mc(x,this.objId,this.scope)},set:function(S){S=S.toString(),x=this instanceof Dr?S:S.substr(0,1)==="("?ys(S.substr(1,S.length-2)):ys(S)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Dr?ys(x.substr(1,x.length-1)):x},set:function(S){S=S.toString(),x=this instanceof Dr?"/"+S:S}});var p=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(p)return p},set:function(S){this.V=S}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof Dr?p:mc(p,this.objId,this.scope)},set:function(S){S=S.toString(),p=this instanceof Dr?S:S.substr(0,1)==="("?ys(S.substr(1,S.length-2)):ys(S)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Dr?ys(p.substr(1,p.length-1)):p},set:function(S){S=S.toString(),p=this instanceof Dr?"/"+S:S}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var w,v=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return v},set:function(S){S=!!S,v=S}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(w)return w},set:function(S){w=S}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!br(this.Ff,1)},set:function(S){S?this.Ff=Nr(this.Ff,1):this.Ff=_r(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!br(this.Ff,2)},set:function(S){S?this.Ff=Nr(this.Ff,2):this.Ff=_r(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!br(this.Ff,3)},set:function(S){S?this.Ff=Nr(this.Ff,3):this.Ff=_r(this.Ff,3)}});var _=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(_!==null)return _},set:function(S){if([0,1,2].indexOf(S)===-1)throw new Error('Invalid value "'+S+'" for attribute Q supplied.');_=S}}),Object.defineProperty(this,"textAlign",{get:function(){var S;switch(_){case 0:default:S="left";break;case 1:S="center";break;case 2:S="right"}return S},configurable:!0,enumerable:!0,set:function(S){switch(S){case"right":case 2:_=2;break;case"center":case 1:_=1;break;case"left":case 0:default:_=0}}})};Sn(pa,ja);var Di=function(){pa.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){e=t}});var r=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return ju(r,this.objId,this.scope)},set:function(t){var n,a;a=[],typeof(n=t)=="string"&&(a=function(s,l,c){c||(c=1);for(var f,u=[];f=l.exec(s);)u.push(f[c]);return u}(n,/\((.*?)\)/g)),r=a}}),this.getOptions=function(){return r},this.setOptions=function(t){r=t,this.sort&&r.sort()},this.addOption=function(t){t=(t=t||"").toString(),r.push(t),this.sort&&r.sort()},this.removeOption=function(t,n){for(n=n||!1,t=(t=t||"").toString();r.indexOf(t)!==-1&&(r.splice(r.indexOf(t),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!br(this.Ff,18)},set:function(t){t?this.Ff=Nr(this.Ff,18):this.Ff=_r(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!br(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=Nr(this.Ff,19):this.Ff=_r(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!br(this.Ff,20)},set:function(t){t?(this.Ff=Nr(this.Ff,20),r.sort()):this.Ff=_r(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!br(this.Ff,22)},set:function(t){t?this.Ff=Nr(this.Ff,22):this.Ff=_r(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!br(this.Ff,23)},set:function(t){t?this.Ff=Nr(this.Ff,23):this.Ff=_r(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!br(this.Ff,27)},set:function(t){t?this.Ff=Nr(this.Ff,27):this.Ff=_r(this.Ff,27)}}),this.hasAppearanceStream=!1};Sn(Di,pa);var Ri=function(){Di.call(this),this.fontName="helvetica",this.combo=!1};Sn(Ri,Di);var Mi=function(){Ri.call(this),this.combo=!0};Sn(Mi,Ri);var wo=function(){Mi.call(this),this.edit=!0};Sn(wo,Mi);var Dr=function(){pa.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!br(this.Ff,15)},set:function(t){t?this.Ff=Nr(this.Ff,15):this.Ff=_r(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!br(this.Ff,16)},set:function(t){t?this.Ff=Nr(this.Ff,16):this.Ff=_r(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!br(this.Ff,17)},set:function(t){t?this.Ff=Nr(this.Ff,17):this.Ff=_r(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!br(this.Ff,26)},set:function(t){t?this.Ff=Nr(this.Ff,26):this.Ff=_r(this.Ff,26)}});var e,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(s){return s};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(r).length!==0){var n,a=[];for(n in a.push("<<"),r)a.push("/"+n+" ("+Vi(t(r[n]))+")");return a.push(">>"),a.join(`
`)}},set:function(t){rr(t)==="object"&&(r=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(t){typeof t=="string"&&(r.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(t){e="/"+t}})};Sn(Dr,pa);var bo=function(){Dr.call(this),this.pushButton=!0};Sn(bo,Dr);var Bi=function(){Dr.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r!==void 0?r:[]}})};Sn(Bi,Dr);var Yl=function(){var e,r;pa.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(a){e=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return r},set:function(a){r=a}});var t,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(c){return c};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var s,l=[];for(s in l.push("<<"),n)l.push("/"+s+" ("+Vi(a(n[s]))+")");return l.push(">>"),l.join(`
`)},set:function(a){rr(a)==="object"&&(n=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(a){typeof a=="string"&&(n.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(a){t=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(a){t="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=lt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Sn(Yl,pa),Bi.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var r in this.Kids)if(this.Kids.hasOwnProperty(r)){var t=this.Kids[r];t.appearanceStreamContent=e.createAppearanceStream(t.optionName),t.caption=e.getCA()}},Bi.prototype.createOption=function(e){var r=new Yl;return r.Parent=this,r.optionName=e,this.Kids.push(r),Qp.call(this.scope,r),r};var No=function(){Dr.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=lt.CheckBox.createAppearanceStream()};Sn(No,Dr);var gi=function(){pa.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!br(this.Ff,13)},set:function(r){r?this.Ff=Nr(this.Ff,13):this.Ff=_r(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!br(this.Ff,21)},set:function(r){r?this.Ff=Nr(this.Ff,21):this.Ff=_r(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!br(this.Ff,23)},set:function(r){r?this.Ff=Nr(this.Ff,23):this.Ff=_r(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!br(this.Ff,24)},set:function(r){r?this.Ff=Nr(this.Ff,24):this.Ff=_r(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!br(this.Ff,25)},set:function(r){r?this.Ff=Nr(this.Ff,25):this.Ff=_r(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!br(this.Ff,26)},set:function(r){r?this.Ff=Nr(this.Ff,26):this.Ff=_r(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){Number.isInteger(r)&&(e=r)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Sn(gi,pa);var _o=function(){gi.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!br(this.Ff,14)},set:function(e){e?this.Ff=Nr(this.Ff,14):this.Ff=_r(this.Ff,14)}}),this.password=!0};Sn(_o,gi);var lt={CheckBox:{createAppearanceStream:function(){return{N:{On:lt.CheckBox.YesNormal},D:{On:lt.CheckBox.YesPushDown,Off:lt.CheckBox.OffPushDown}}},YesPushDown:function(e){var r=_a(e);r.scope=e.scope;var t=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),s=Mc(e,e.caption);return t.push("0.749023 g"),t.push("0 0 "+_t(lt.internal.getWidth(e))+" "+_t(lt.internal.getHeight(e))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+n+" "+_t(s.fontSize)+" Tf "+a),t.push("BT"),t.push(s.text),t.push("ET"),t.push("Q"),t.push("EMC"),r.stream=t.join(`
`),r},YesNormal:function(e){var r=_a(e);r.scope=e.scope;var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),a=[],s=lt.internal.getHeight(e),l=lt.internal.getWidth(e),c=Mc(e,e.caption);return a.push("1 g"),a.push("0 0 "+_t(l)+" "+_t(s)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+_t(l-1)+" "+_t(s-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+t+" "+_t(c.fontSize)+" Tf "+n),a.push(c.text),a.push("ET"),a.push("Q"),r.stream=a.join(`
`),r},OffPushDown:function(e){var r=_a(e);r.scope=e.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+_t(lt.internal.getWidth(e))+" "+_t(lt.internal.getHeight(e))+" re"),t.push("f"),r.stream=t.join(`
`),r}},RadioButton:{Circle:{createAppearanceStream:function(e){var r={D:{Off:lt.RadioButton.Circle.OffPushDown},N:{}};return r.N[e]=lt.RadioButton.Circle.YesNormal,r.D[e]=lt.RadioButton.Circle.YesPushDown,r},getCA:function(){return"l"},YesNormal:function(e){var r=_a(e);r.scope=e.scope;var t=[],n=lt.internal.getWidth(e)<=lt.internal.getHeight(e)?lt.internal.getWidth(e)/4:lt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=lt.internal.Bezier_C,s=Number((n*a).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+fi(lt.internal.getWidth(e)/2)+" "+fi(lt.internal.getHeight(e)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),t.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),t.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),t.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),t.push("f"),t.push("Q"),r.stream=t.join(`
`),r},YesPushDown:function(e){var r=_a(e);r.scope=e.scope;var t=[],n=lt.internal.getWidth(e)<=lt.internal.getHeight(e)?lt.internal.getWidth(e)/4:lt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),s=Number((a*lt.internal.Bezier_C).toFixed(5)),l=Number((n*lt.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+fi(lt.internal.getWidth(e)/2)+" "+fi(lt.internal.getHeight(e)/2)+" cm"),t.push(a+" 0 m"),t.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),t.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),t.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),t.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+fi(lt.internal.getWidth(e)/2)+" "+fi(lt.internal.getHeight(e)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+l+" "+l+" "+n+" 0 "+n+" c"),t.push("-"+l+" "+n+" -"+n+" "+l+" -"+n+" 0 c"),t.push("-"+n+" -"+l+" -"+l+" -"+n+" 0 -"+n+" c"),t.push(l+" -"+n+" "+n+" -"+l+" "+n+" 0 c"),t.push("f"),t.push("Q"),r.stream=t.join(`
`),r},OffPushDown:function(e){var r=_a(e);r.scope=e.scope;var t=[],n=lt.internal.getWidth(e)<=lt.internal.getHeight(e)?lt.internal.getWidth(e)/4:lt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),s=Number((a*lt.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+fi(lt.internal.getWidth(e)/2)+" "+fi(lt.internal.getHeight(e)/2)+" cm"),t.push(a+" 0 m"),t.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),t.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),t.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),t.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),t.push("f"),t.push("Q"),r.stream=t.join(`
`),r}},Cross:{createAppearanceStream:function(e){var r={D:{Off:lt.RadioButton.Cross.OffPushDown},N:{}};return r.N[e]=lt.RadioButton.Cross.YesNormal,r.D[e]=lt.RadioButton.Cross.YesPushDown,r},getCA:function(){return"8"},YesNormal:function(e){var r=_a(e);r.scope=e.scope;var t=[],n=lt.internal.calculateCross(e);return t.push("q"),t.push("1 1 "+_t(lt.internal.getWidth(e)-2)+" "+_t(lt.internal.getHeight(e)-2)+" re"),t.push("W"),t.push("n"),t.push(_t(n.x1.x)+" "+_t(n.x1.y)+" m"),t.push(_t(n.x2.x)+" "+_t(n.x2.y)+" l"),t.push(_t(n.x4.x)+" "+_t(n.x4.y)+" m"),t.push(_t(n.x3.x)+" "+_t(n.x3.y)+" l"),t.push("s"),t.push("Q"),r.stream=t.join(`
`),r},YesPushDown:function(e){var r=_a(e);r.scope=e.scope;var t=lt.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+_t(lt.internal.getWidth(e))+" "+_t(lt.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+_t(lt.internal.getWidth(e)-2)+" "+_t(lt.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(_t(t.x1.x)+" "+_t(t.x1.y)+" m"),n.push(_t(t.x2.x)+" "+_t(t.x2.y)+" l"),n.push(_t(t.x4.x)+" "+_t(t.x4.y)+" m"),n.push(_t(t.x3.x)+" "+_t(t.x3.y)+" l"),n.push("s"),n.push("Q"),r.stream=n.join(`
`),r},OffPushDown:function(e){var r=_a(e);r.scope=e.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+_t(lt.internal.getWidth(e))+" "+_t(lt.internal.getHeight(e))+" re"),t.push("f"),r.stream=t.join(`
`),r}}},createDefaultAppearanceStream:function(e){var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,t=e.scope.__private__.encodeColorString(e.color);return"/"+r+" "+e.fontSize+" Tf "+t}};lt.internal={Bezier_C:.551915024494,calculateCross:function(e){var r=lt.internal.getWidth(e),t=lt.internal.getHeight(e),n=Math.min(r,t);return{x1:{x:(r-n)/2,y:(t-n)/2+n},x2:{x:(r-n)/2+n,y:(t-n)/2},x3:{x:(r-n)/2,y:(t-n)/2},x4:{x:(r-n)/2+n,y:(t-n)/2+n}}}},lt.internal.getWidth=function(e){var r=0;return rr(e)==="object"&&(r=ch(e.Rect[2])),r},lt.internal.getHeight=function(e){var r=0;return rr(e)==="object"&&(r=ch(e.Rect[3])),r};var Qp=dr.addField=function(e){if(Zp(this,e),!(e instanceof pa))throw new Error("Invalid argument passed to jsPDF.addField.");var r;return(r=e).scope.internal.acroformPlugin.printedOut&&(r.scope.internal.acroformPlugin.printedOut=!1,r.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),r.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(r),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};dr.AcroFormChoiceField=Di,dr.AcroFormListBox=Ri,dr.AcroFormComboBox=Mi,dr.AcroFormEditBox=wo,dr.AcroFormButton=Dr,dr.AcroFormPushButton=bo,dr.AcroFormRadioButton=Bi,dr.AcroFormCheckBox=No,dr.AcroFormTextField=gi,dr.AcroFormPasswordField=_o,dr.AcroFormAppearance=lt,dr.AcroForm={ChoiceField:Di,ListBox:Ri,ComboBox:Mi,EditBox:wo,Button:Dr,PushButton:bo,RadioButton:Bi,CheckBox:No,TextField:gi,PasswordField:_o,Appearance:lt},mt.AcroForm={ChoiceField:Di,ListBox:Ri,ComboBox:Mi,EditBox:wo,Button:Dr,PushButton:bo,RadioButton:Bi,CheckBox:No,TextField:gi,PasswordField:_o,Appearance:lt};var em=mt.AcroForm;function Eu(e){return e.reduce(function(r,t,n){return r[t]=n,r},{})}(function(e){e.__addimage__={};var r="UNKNOWN",t={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=e.__addimage__.getImageFileTypeByImageData=function(k,T){var H,G,ce,J,Q,oe=r;if((T=T||r)==="RGBA"||k.data!==void 0&&k.data instanceof Uint8ClampedArray&&"height"in k&&"width"in k)return"RGBA";if(R(k))for(Q in t)for(ce=t[Q],H=0;H<ce.length;H+=1){for(J=!0,G=0;G<ce[H].length;G+=1)if(ce[H][G]!==void 0&&ce[H][G]!==k[G]){J=!1;break}if(J===!0){oe=Q;break}}else for(Q in t)for(ce=t[Q],H=0;H<ce.length;H+=1){for(J=!0,G=0;G<ce[H].length;G+=1)if(ce[H][G]!==void 0&&ce[H][G]!==k.charCodeAt(G)){J=!1;break}if(J===!0){oe=Q;break}}return oe===r&&T!==r&&(oe=T),oe},a=function k(T){for(var H=this.internal.write,G=this.internal.putStream,ce=(0,this.internal.getFilters)();ce.indexOf("FlateEncode")!==-1;)ce.splice(ce.indexOf("FlateEncode"),1);T.objectId=this.internal.newObject();var J=[];if(J.push({key:"Type",value:"/XObject"}),J.push({key:"Subtype",value:"/Image"}),J.push({key:"Width",value:T.width}),J.push({key:"Height",value:T.height}),T.colorSpace===_.INDEXED?J.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(T.palette.length/3-1)+" "+("sMask"in T&&T.sMask!==void 0?T.objectId+2:T.objectId+1)+" 0 R]"}):(J.push({key:"ColorSpace",value:"/"+T.colorSpace}),T.colorSpace===_.DEVICE_CMYK&&J.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),J.push({key:"BitsPerComponent",value:T.bitsPerComponent}),"decodeParameters"in T&&T.decodeParameters!==void 0&&J.push({key:"DecodeParms",value:"<<"+T.decodeParameters+">>"}),"transparency"in T&&Array.isArray(T.transparency)){for(var Q="",oe=0,ae=T.transparency.length;oe<ae;oe++)Q+=T.transparency[oe]+" "+T.transparency[oe]+" ";J.push({key:"Mask",value:"["+Q+"]"})}T.sMask!==void 0&&J.push({key:"SMask",value:T.objectId+1+" 0 R"});var ge=T.filter!==void 0?["/"+T.filter]:void 0;if(G({data:T.data,additionalKeyValues:J,alreadyAppliedFilters:ge,objectId:T.objectId}),H("endobj"),"sMask"in T&&T.sMask!==void 0){var ve="/Predictor "+T.predictor+" /Colors 1 /BitsPerComponent "+T.bitsPerComponent+" /Columns "+T.width,j={width:T.width,height:T.height,colorSpace:"DeviceGray",bitsPerComponent:T.bitsPerComponent,decodeParameters:ve,data:T.sMask};"filter"in T&&(j.filter=T.filter),k.call(this,j)}if(T.colorSpace===_.INDEXED){var O=this.internal.newObject();G({data:C(new Uint8Array(T.palette)),objectId:O}),H("endobj")}},s=function(){var k=this.internal.collections.addImage_images;for(var T in k)a.call(this,k[T])},l=function(){var k,T=this.internal.collections.addImage_images,H=this.internal.write;for(var G in T)H("/I"+(k=T[G]).index,k.objectId,"0","R")},c=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",l))},f=function(){var k=this.internal.collections.addImage_images;return c.call(this),k},u=function(){return Object.keys(this.internal.collections.addImage_images).length},d=function(k){return typeof e["process"+k.toUpperCase()]=="function"},g=function(k){return rr(k)==="object"&&k.nodeType===1},x=function(k,T){if(k.nodeName==="IMG"&&k.hasAttribute("src")){var H=""+k.getAttribute("src");if(H.indexOf("data:image/")===0)return yo(unescape(H).split("base64,").pop());var G=e.loadFile(H,!0);if(G!==void 0)return G}if(k.nodeName==="CANVAS"){if(k.width===0||k.height===0)throw new Error("Given canvas must have data. Canvas width: "+k.width+", height: "+k.height);var ce;switch(T){case"PNG":ce="image/png";break;case"WEBP":ce="image/webp";break;case"JPEG":case"JPG":default:ce="image/jpeg"}return yo(k.toDataURL(ce,1).split("base64,").pop())}},p=function(k){var T=this.internal.collections.addImage_images;if(T){for(var H in T)if(k===T[H].alias)return T[H]}},w=function(k,T,H){return k||T||(k=-96,T=-96),k<0&&(k=-1*H.width*72/k/this.internal.scaleFactor),T<0&&(T=-1*H.height*72/T/this.internal.scaleFactor),k===0&&(k=T*H.width/H.height),T===0&&(T=k*H.height/H.width),[k,T]},v=function(k,T,H,G,ce,J){var Q=w.call(this,H,G,ce),oe=this.internal.getCoordinateString,ae=this.internal.getVerticalCoordinateString,ge=f.call(this);if(H=Q[0],G=Q[1],ge[ce.index]=ce,J){J*=Math.PI/180;var ve=Math.cos(J),j=Math.sin(J),O=function(D){return D.toFixed(4)},I=[O(ve),O(j),O(-1*j),O(ve),0,0,"cm"]}this.internal.write("q"),J?(this.internal.write([1,"0","0",1,oe(k),ae(T+G),"cm"].join(" ")),this.internal.write(I.join(" ")),this.internal.write([oe(H),"0","0",oe(G),"0","0","cm"].join(" "))):this.internal.write([oe(H),"0","0",oe(G),oe(k),ae(T+G),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ce.index+" Do"),this.internal.write("Q")},_=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var S=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},b=e.__addimage__.sHashCode=function(k){var T,H,G=0;if(typeof k=="string")for(H=k.length,T=0;T<H;T++)G=(G<<5)-G+k.charCodeAt(T),G|=0;else if(R(k))for(H=k.byteLength/2,T=0;T<H;T++)G=(G<<5)-G+k[T],G|=0;return G},A=e.__addimage__.validateStringAsBase64=function(k){(k=k||"").toString().trim();var T=!0;return k.length===0&&(T=!1),k.length%4!=0&&(T=!1),/^[A-Za-z0-9+/]+$/.test(k.substr(0,k.length-2))===!1&&(T=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(k.substr(-2))===!1&&(T=!1),T},E=e.__addimage__.extractImageFromDataUrl=function(k){var T=(k=k||"").split("base64,"),H=null;if(T.length===2){var G=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(T[0]);Array.isArray(G)&&(H={mimeType:G[1],charset:G[2],data:T[1]})}return H},U=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(k){return U()&&k instanceof ArrayBuffer};var R=e.__addimage__.isArrayBufferView=function(k){return U()&&typeof Uint32Array<"u"&&(k instanceof Int8Array||k instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&k instanceof Uint8ClampedArray||k instanceof Int16Array||k instanceof Uint16Array||k instanceof Int32Array||k instanceof Uint32Array||k instanceof Float32Array||k instanceof Float64Array)},L=e.__addimage__.binaryStringToUint8Array=function(k){for(var T=k.length,H=new Uint8Array(T),G=0;G<T;G++)H[G]=k.charCodeAt(G);return H},C=e.__addimage__.arrayBufferToBinaryString=function(k){for(var T="",H=R(k)?k:new Uint8Array(k),G=0;G<H.length;G+=8192)T+=String.fromCharCode.apply(null,H.subarray(G,G+8192));return T};e.addImage=function(){var k,T,H,G,ce,J,Q,oe,ae;if(typeof arguments[1]=="number"?(T=r,H=arguments[1],G=arguments[2],ce=arguments[3],J=arguments[4],Q=arguments[5],oe=arguments[6],ae=arguments[7]):(T=arguments[1],H=arguments[2],G=arguments[3],ce=arguments[4],J=arguments[5],Q=arguments[6],oe=arguments[7],ae=arguments[8]),rr(k=arguments[0])==="object"&&!g(k)&&"imageData"in k){var ge=k;k=ge.imageData,T=ge.format||T||r,H=ge.x||H||0,G=ge.y||G||0,ce=ge.w||ge.width||ce,J=ge.h||ge.height||J,Q=ge.alias||Q,oe=ge.compression||oe,ae=ge.rotation||ge.angle||ae}var ve=this.internal.getFilters();if(oe===void 0&&ve.indexOf("FlateEncode")!==-1&&(oe="SLOW"),isNaN(H)||isNaN(G))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var j=P.call(this,k,T,Q,oe);return v.call(this,H,G,ce,J,j,ae),this};var P=function(k,T,H,G){var ce,J,Q;if(typeof k=="string"&&n(k)===r){k=unescape(k);var oe=W(k,!1);(oe!==""||(oe=e.loadFile(k,!0))!==void 0)&&(k=oe)}if(g(k)&&(k=x(k,T)),T=n(k,T),!d(T))throw new Error("addImage does not support files of type '"+T+"', please ensure that a plugin for '"+T+"' support is added.");if(((Q=H)==null||Q.length===0)&&(H=function(ae){return typeof ae=="string"||R(ae)?b(ae):R(ae.data)?b(ae.data):null}(k)),(ce=p.call(this,H))||(U()&&(k instanceof Uint8Array||T==="RGBA"||(J=k,k=L(k))),ce=this["process"+T.toUpperCase()](k,u.call(this),H,function(ae){return ae&&typeof ae=="string"&&(ae=ae.toUpperCase()),ae in e.image_compression?ae:S.NONE}(G),J)),!ce)throw new Error("An unknown error occurred whilst processing the image.");return ce},W=e.__addimage__.convertBase64ToBinaryString=function(k,T){var H;T=typeof T!="boolean"||T;var G,ce="";if(typeof k=="string"){G=(H=E(k))!==null?H.data:k;try{ce=yo(G)}catch(J){if(T)throw A(G)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+J.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return ce};e.getImageProperties=function(k){var T,H,G="";if(g(k)&&(k=x(k)),typeof k=="string"&&n(k)===r&&((G=W(k,!1))===""&&(G=e.loadFile(k)||""),k=G),H=n(k),!d(H))throw new Error("addImage does not support files of type '"+H+"', please ensure that a plugin for '"+H+"' support is added.");if(!U()||k instanceof Uint8Array||(k=L(k)),!(T=this["process"+H.toUpperCase()](k)))throw new Error("An unknown error occurred whilst processing the image");return T.fileType=H,T}})(mt.API),function(e){var r=function(t){if(t!==void 0&&t!="")return!0};mt.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(t){for(var n,a,s,l=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString,f=this.internal.getPageInfoByObjId(t.objId),u=t.pageContext.annotations,d=!1,g=0;g<u.length&&!d;g++)switch((n=u[g]).type){case"link":(r(n.options.url)||r(n.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var x=0;x<u.length;x++){n=u[x];var p=this.internal.pdfEscape,w=this.internal.getEncryptor(t.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var v=this.internal.newAdditionalObject(),_=this.internal.newAdditionalObject(),S=this.internal.getEncryptor(v.objId),b=n.title||"Note";s="<</Type /Annot /Subtype /Text "+(a="/Rect ["+l(n.bounds.x)+" "+c(n.bounds.y+n.bounds.h)+" "+l(n.bounds.x+n.bounds.w)+" "+c(n.bounds.y)+"] ")+"/Contents ("+p(S(n.contents))+")",s+=" /Popup "+_.objId+" 0 R",s+=" /P "+f.objId+" 0 R",s+=" /T ("+p(S(b))+") >>",v.content=s;var A=v.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+l(n.bounds.x+30)+" "+c(n.bounds.y+n.bounds.h)+" "+l(n.bounds.x+n.bounds.w+30)+" "+c(n.bounds.y)+"] ")+" /Parent "+A,n.open&&(s+=" /Open true"),s+=" >>",_.content=s,this.internal.write(v.objId,"0 R",_.objId,"0 R");break;case"freetext":a="/Rect ["+l(n.bounds.x)+" "+c(n.bounds.y)+" "+l(n.bounds.x+n.bounds.w)+" "+c(n.bounds.y+n.bounds.h)+"] ";var E=n.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+p(w(n.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+E+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(n.options.name){var U=this.annotations._nameMap[n.options.name];n.options.pageNumber=U.page,n.options.top=U.y}else n.options.top||(n.options.top=0);if(a="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",s="",n.options.url)s="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+p(w(n.options.url))+") >>";else if(n.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,s+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var R=c(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),s+=" /XYZ "+n.options.left+" "+R+" "+n.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),e.createAnnotation=function(t){var n=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":n.pageContext.annotations.push(t)}},e.link=function(t,n,a,s,l){var c=this.internal.getCurrentPageInfo(),f=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;c.pageContext.annotations.push({finalBounds:{x:f(t),y:u(n),w:f(t+a),h:u(n+s)},options:l,type:"link"})},e.textWithLink=function(t,n,a,s){var l,c,f=this.getTextWidth(t),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){c=s.maxWidth;var d=this.splitTextToSize(t,c).length;l=Math.ceil(u*d)}else c=f,l=u;return this.text(t,n,a,s),a+=.2*u,s.align==="center"&&(n-=f/2),s.align==="right"&&(n-=f),this.link(n,a-u,c,l,s),f},e.getTextWidth=function(t){var n=this.internal.getFontSize();return this.getStringUnitWidth(t)*n/this.internal.scaleFactor}}(mt.API),function(e){var r={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];e.__arabicParser__={};var s=e.__arabicParser__.isInArabicSubstitutionA=function(v){return r[v.charCodeAt(0)]!==void 0},l=e.__arabicParser__.isArabicLetter=function(v){return typeof v=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(v)},c=e.__arabicParser__.isArabicEndLetter=function(v){return l(v)&&s(v)&&r[v.charCodeAt(0)].length<=2},f=e.__arabicParser__.isArabicAlfLetter=function(v){return l(v)&&a.indexOf(v.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(v){return l(v)&&s(v)&&r[v.charCodeAt(0)].length>=1};var u=e.__arabicParser__.arabicLetterHasFinalForm=function(v){return l(v)&&s(v)&&r[v.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(v){return l(v)&&s(v)&&r[v.charCodeAt(0)].length>=3};var d=e.__arabicParser__.arabicLetterHasMedialForm=function(v){return l(v)&&s(v)&&r[v.charCodeAt(0)].length==4},g=e.__arabicParser__.resolveLigatures=function(v){var _=0,S=t,b="",A=0;for(_=0;_<v.length;_+=1)S[v.charCodeAt(_)]!==void 0?(A++,typeof(S=S[v.charCodeAt(_)])=="number"&&(b+=String.fromCharCode(S),S=t,A=0),_===v.length-1&&(S=t,b+=v.charAt(_-(A-1)),_-=A-1,A=0)):(S=t,b+=v.charAt(_-A),_-=A,A=0);return b};e.__arabicParser__.isArabicDiacritic=function(v){return v!==void 0&&n[v.charCodeAt(0)]!==void 0};var x=e.__arabicParser__.getCorrectForm=function(v,_,S){return l(v)?s(v)===!1?-1:!u(v)||!l(_)&&!l(S)||!l(S)&&c(_)||c(v)&&!l(_)||c(v)&&f(_)||c(v)&&c(_)?0:d(v)&&l(_)&&!c(_)&&l(S)&&u(S)?3:c(v)||!l(S)?1:2:-1},p=function(v){var _=0,S=0,b=0,A="",E="",U="",R=(v=v||"").split("\\s+"),L=[];for(_=0;_<R.length;_+=1){for(L.push(""),S=0;S<R[_].length;S+=1)A=R[_][S],E=R[_][S-1],U=R[_][S+1],l(A)?(b=x(A,E,U),L[_]+=b!==-1?String.fromCharCode(r[A.charCodeAt(0)][b]):A):L[_]+=A;L[_]=g(L[_])}return L.join(" ")},w=e.__arabicParser__.processArabic=e.processArabic=function(){var v,_=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,S=[];if(Array.isArray(_)){var b=0;for(S=[],b=0;b<_.length;b+=1)Array.isArray(_[b])?S.push([p(_[b][0]),_[b][1],_[b][2]]):S.push([p(_[b])]);v=S}else v=p(_);return typeof arguments[0]=="string"?v:(arguments[0].text=v,arguments[0])};e.events.push(["preProcessText",w])}(mt.API),mt.API.autoPrint=function(e){var r;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){r=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+r+" 0 R")})}return this},function(e){var r=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(c){t=c}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(c){n=isNaN(c)||Number.isInteger(c)===!1||c<0?150:c,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(c){a=isNaN(c)||Number.isInteger(c)===!1||c<0?300:c,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(c){s=c}});var l={};Object.defineProperty(this,"style",{get:function(){return l},set:function(c){l=c}}),Object.defineProperty(this,"parentNode",{})};r.prototype.getContext=function(t,n){var a;if((t=t||"2d")!=="2d")return null;for(a in n)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=n[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},r.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new r,this.canvas.pdf=this}])}(mt.API),function(e){var r={left:0,top:0,bottom:0,right:0},t=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},r),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var f=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return f},set:function(v){f=v}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(v){u=v}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(v){d=v}});var g=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return g},set:function(v){g=v}});var x=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return x},set:function(v){x=v}});var p=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return p},set:function(v){p=v}});var w=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return w},set:function(v){w=v}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(f){return n.call(this),this.internal.__cell__.headerFunction=typeof f=="function"?f:void 0,this},e.getTextDimensions=function(f,u){n.call(this);var d=(u=u||{}).fontSize||this.getFontSize(),g=u.font||this.getFont(),x=u.scaleFactor||this.internal.scaleFactor,p=0,w=0,v=0,_=this;if(!Array.isArray(f)&&typeof f!="string"){if(typeof f!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");f=String(f)}var S=u.maxWidth;S>0?typeof f=="string"?f=this.splitTextToSize(f,S):Object.prototype.toString.call(f)==="[object Array]"&&(f=f.reduce(function(A,E){return A.concat(_.splitTextToSize(E,S))},[])):f=Array.isArray(f)?f:[f];for(var b=0;b<f.length;b++)p<(v=this.getStringUnitWidth(f[b],{font:g})*d)&&(p=v);return p!==0&&(w=f.length),{w:p/=x,h:Math.max((w*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/x,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var f=this.internal.__cell__.margins||r;return this.internal.__cell__.lastCell=new s(f.left,f.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var l=e.cell=function(){var f;f=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var u=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,g=this.internal.__cell__.margins||r,x=this.internal.__cell__.tableHeaderRow,p=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===f.lineNumber?(f.x=(u.x||0)+(u.width||0),f.y=u.y||0):u.y+u.height+f.height+g.bottom>this.getPageHeight()?(this.cellAddPage(),f.y=g.top,p&&x&&(this.printHeaderRow(f.lineNumber,!0),f.y+=x[0].height)):f.y=u.y+u.height||f.y),f.text[0]!==void 0&&(this.rect(f.x,f.y,f.width,f.height,t===!0?"FD":void 0),f.align==="right"?this.text(f.text,f.x+f.width-d,f.y+d,{align:"right",baseline:"top"}):f.align==="center"?this.text(f.text,f.x+f.width/2,f.y+d,{align:"center",baseline:"top",maxWidth:f.width-d-d}):this.text(f.text,f.x+d,f.y+d,{align:"left",baseline:"top",maxWidth:f.width-d-d})),this.internal.__cell__.lastCell=f,this};e.table=function(f,u,d,g,x){if(n.call(this),!d)throw new Error("No data for PDF table.");var p,w,v,_,S=[],b=[],A=[],E={},U={},R=[],L=[],C=(x=x||{}).autoSize||!1,P=x.printHeaders!==!1,W=x.css&&x.css["font-size"]!==void 0?16*x.css["font-size"]:x.fontSize||12,k=x.margins||Object.assign({width:this.getPageWidth()},r),T=typeof x.padding=="number"?x.padding:3,H=x.headerBackgroundColor||"#c8c8c8",G=x.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=P,this.internal.__cell__.margins=k,this.internal.__cell__.table_font_size=W,this.internal.__cell__.padding=T,this.internal.__cell__.headerBackgroundColor=H,this.internal.__cell__.headerTextColor=G,this.setFontSize(W),g==null)b=S=Object.keys(d[0]),A=S.map(function(){return"left"});else if(Array.isArray(g)&&rr(g[0])==="object")for(S=g.map(function(ge){return ge.name}),b=g.map(function(ge){return ge.prompt||ge.name||""}),A=g.map(function(ge){return ge.align||"left"}),p=0;p<g.length;p+=1)U[g[p].name]=g[p].width*(19.049976/25.4);else Array.isArray(g)&&typeof g[0]=="string"&&(b=S=g,A=S.map(function(){return"left"}));if(C||Array.isArray(g)&&typeof g[0]=="string")for(p=0;p<S.length;p+=1){for(E[_=S[p]]=d.map(function(ge){return ge[_]}),this.setFont(void 0,"bold"),R.push(this.getTextDimensions(b[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),w=E[_],this.setFont(void 0,"normal"),v=0;v<w.length;v+=1)R.push(this.getTextDimensions(w[v],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);U[_]=Math.max.apply(null,R)+T+T,R=[]}if(P){var ce={};for(p=0;p<S.length;p+=1)ce[S[p]]={},ce[S[p]].text=b[p],ce[S[p]].align=A[p];var J=c.call(this,ce,U);L=S.map(function(ge){return new s(f,u,U[ge],J,ce[ge].text,void 0,ce[ge].align)}),this.setTableHeaderRow(L),this.printHeaderRow(1,!1)}var Q=g.reduce(function(ge,ve){return ge[ve.name]=ve.align,ge},{});for(p=0;p<d.length;p+=1){"rowStart"in x&&x.rowStart instanceof Function&&x.rowStart({row:p,data:d[p]},this);var oe=c.call(this,d[p],U);for(v=0;v<S.length;v+=1){var ae=d[p][S[v]];"cellStart"in x&&x.cellStart instanceof Function&&x.cellStart({row:p,col:v,data:ae},this),l.call(this,new s(f,u,U[S[v]],oe,ae,p+2,Q[S[v]]))}}return this.internal.__cell__.table_x=f,this.internal.__cell__.table_y=u,this};var c=function(f,u){var d=this.internal.__cell__.padding,g=this.internal.__cell__.table_font_size,x=this.internal.scaleFactor;return Object.keys(f).map(function(p){var w=f[p];return this.splitTextToSize(w.hasOwnProperty("text")?w.text:w,u[p]-d-d)},this).map(function(p){return this.getLineHeightFactor()*p.length*g/x+d+d},this).reduce(function(p,w){return Math.max(p,w)},0)};e.setTableHeaderRow=function(f){n.call(this),this.internal.__cell__.tableHeaderRow=f},e.printHeaderRow=function(f,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var g=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(g[0],g[1],g[2],g[3],void 0,-1)}this.setFont(void 0,"bold");for(var x=[],p=0;p<this.internal.__cell__.tableHeaderRow.length;p+=1){d=this.internal.__cell__.tableHeaderRow[p].clone(),u&&(d.y=this.internal.__cell__.margins.top||0,x.push(d)),d.lineNumber=f;var w=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),l.call(this,d),this.setTextColor(w)}x.length>0&&this.setTableHeaderRow(x),this.setFont(void 0,"normal"),t=!1}}(mt.API);var Fu={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Cu=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Bc=Eu(Cu),Lu=[100,200,300,400,500,600,700,800,900],tm=Eu(Lu);function Uc(e){var r=e.family.replace(/"|'/g,"").toLowerCase(),t=function(s){return Fu[s=s||"normal"]?s:"normal"}(e.style),n=function(s){if(!s)return 400;if(typeof s=="number")return s>=100&&s<=900&&s%100==0?s:400;if(/^\d00$/.test(s))return parseInt(s);switch(s){case"bold":return 700;case"normal":default:return 400}}(e.weight),a=function(s){return typeof Bc[s=s||"normal"]=="number"?s:"normal"}(e.stretch);return{family:r,style:t,weight:n,stretch:a,src:e.src||[],ref:e.ref||{name:r,style:[a,t,n].join(" ")}}}function fh(e,r,t,n){var a;for(a=t;a>=0&&a<r.length;a+=n)if(e[r[a]])return e[r[a]];for(a=t;a>=0&&a<r.length;a-=n)if(e[r[a]])return e[r[a]]}var rm={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},hh={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function uh(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function nm(e,r,t){for(var n=(t=t||{}).defaultFontFamily||"times",a=Object.assign({},rm,t.genericFontFamilies||{}),s=null,l=null,c=0;c<r.length;++c)if(a[(s=Uc(r[c])).family]&&(s.family=a[s.family]),e.hasOwnProperty(s.family)){l=e[s.family];break}if(!(l=l||e[n]))throw new Error("Could not find a font-family for the rule '"+uh(s)+"' and default family '"+n+"'.");if(l=function(f,u){if(u[f])return u[f];var d=Bc[f],g=d<=Bc.normal?-1:1,x=fh(u,Cu,d,g);if(!x)throw new Error("Could not find a matching font-stretch value for "+f);return x}(s.stretch,l),l=function(f,u){if(u[f])return u[f];for(var d=Fu[f],g=0;g<d.length;++g)if(u[d[g]])return u[d[g]];throw new Error("Could not find a matching font-style for "+f)}(s.style,l),!(l=function(f,u){if(u[f])return u[f];if(f===400&&u[500])return u[500];if(f===500&&u[400])return u[400];var d=tm[f],g=fh(u,Lu,d,f<400?-1:1);if(!g)throw new Error("Could not find a matching font-weight for value "+f);return g}(s.weight,l)))throw new Error("Failed to resolve a font for the rule '"+uh(s)+"'.");return l}function dh(e){return e.trimLeft()}function am(e,r){for(var t=0;t<e.length;){if(e.charAt(t)===r)return[e.substring(0,t),e.substring(t+1)];t+=1}return null}function im(e){var r=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return r===null?null:[r[0],e.substring(r[0].length)]}var Ml,ph,mh,gc=["times"];(function(e){var r,t,n,a,s,l,c,f,u,d=function(j){return j=j||{},this.isStrokeTransparent=j.isStrokeTransparent||!1,this.strokeOpacity=j.strokeOpacity||1,this.strokeStyle=j.strokeStyle||"#000000",this.fillStyle=j.fillStyle||"#000000",this.isFillTransparent=j.isFillTransparent||!1,this.fillOpacity=j.fillOpacity||1,this.font=j.font||"10px sans-serif",this.textBaseline=j.textBaseline||"alphabetic",this.textAlign=j.textAlign||"left",this.lineWidth=j.lineWidth||1,this.lineJoin=j.lineJoin||"miter",this.lineCap=j.lineCap||"butt",this.path=j.path||[],this.transform=j.transform!==void 0?j.transform.clone():new f,this.globalCompositeOperation=j.globalCompositeOperation||"normal",this.globalAlpha=j.globalAlpha||1,this.clip_path=j.clip_path||[],this.currentPoint=j.currentPoint||new l,this.miterLimit=j.miterLimit||10,this.lastPoint=j.lastPoint||new l,this.lineDashOffset=j.lineDashOffset||0,this.lineDash=j.lineDash||[],this.margin=j.margin||[0,0,0,0],this.prevPageLastElemOffset=j.prevPageLastElemOffset||0,this.ignoreClearRect=typeof j.ignoreClearRect!="boolean"||j.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new g(this),r=this.internal.f2,t=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,l=this.internal.Point,c=this.internal.Rectangle,f=this.internal.Matrix,u=new d}]);var g=function(j){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var O=j;Object.defineProperty(this,"pdf",{get:function(){return O}});var I=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return I},set:function(Ee){I=!!Ee}});var D=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return D},set:function(Ee){D=!!Ee}});var X=0;Object.defineProperty(this,"posX",{get:function(){return X},set:function(Ee){isNaN(Ee)||(X=Ee)}});var fe=0;Object.defineProperty(this,"posY",{get:function(){return fe},set:function(Ee){isNaN(Ee)||(fe=Ee)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(Ee){var le;typeof Ee=="number"?le=[Ee,Ee,Ee,Ee]:((le=new Array(4))[0]=Ee[0],le[1]=Ee.length>=2?Ee[1]:le[0],le[2]=Ee.length>=3?Ee[2]:le[0],le[3]=Ee.length>=4?Ee[3]:le[1]),u.margin=le}});var he=!1;Object.defineProperty(this,"autoPaging",{get:function(){return he},set:function(Ee){he=Ee}});var ue=0;Object.defineProperty(this,"lastBreak",{get:function(){return ue},set:function(Ee){ue=Ee}});var be=[];Object.defineProperty(this,"pageBreaks",{get:function(){return be},set:function(Ee){be=Ee}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(Ee){Ee instanceof d&&(u=Ee)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(Ee){u.path=Ee}});var Oe=[];Object.defineProperty(this,"ctxStack",{get:function(){return Oe},set:function(Ee){Oe=Ee}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Ee){var le;le=x(Ee),this.ctx.fillStyle=le.style,this.ctx.isFillTransparent=le.a===0,this.ctx.fillOpacity=le.a,this.pdf.setFillColor(le.r,le.g,le.b,{a:le.a}),this.pdf.setTextColor(le.r,le.g,le.b,{a:le.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Ee){var le=x(Ee);this.ctx.strokeStyle=le.style,this.ctx.isStrokeTransparent=le.a===0,this.ctx.strokeOpacity=le.a,le.a===0?this.pdf.setDrawColor(255,255,255):(le.a,this.pdf.setDrawColor(le.r,le.g,le.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Ee){["butt","round","square"].indexOf(Ee)!==-1&&(this.ctx.lineCap=Ee,this.pdf.setLineCap(Ee))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Ee){isNaN(Ee)||(this.ctx.lineWidth=Ee,this.pdf.setLineWidth(Ee))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Ee){["bevel","round","miter"].indexOf(Ee)!==-1&&(this.ctx.lineJoin=Ee,this.pdf.setLineJoin(Ee))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Ee){isNaN(Ee)||(this.ctx.miterLimit=Ee,this.pdf.setMiterLimit(Ee))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Ee){this.ctx.textBaseline=Ee}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Ee){["right","end","center","left","start"].indexOf(Ee)!==-1&&(this.ctx.textAlign=Ee)}});var Me=null;function Ve(Ee,le){if(Me===null){var Be=function(it){var We=[];return Object.keys(it).forEach(function($e){it[$e].forEach(function(Ze){var et=null;switch(Ze){case"bold":et={family:$e,weight:"bold"};break;case"italic":et={family:$e,style:"italic"};break;case"bolditalic":et={family:$e,weight:"bold",style:"italic"};break;case"":case"normal":et={family:$e}}et!==null&&(et.ref={name:$e,style:Ze},We.push(et))})}),We}(Ee.getFontList());Me=function(it){for(var We={},$e=0;$e<it.length;++$e){var Ze=Uc(it[$e]),et=Ze.family,ft=Ze.stretch,ht=Ze.style,yt=Ze.weight;We[et]=We[et]||{},We[et][ft]=We[et][ft]||{},We[et][ft][ht]=We[et][ft][ht]||{},We[et][ft][ht][yt]=Ze}return We}(Be.concat(le))}return Me}var Je=null;Object.defineProperty(this,"fontFaces",{get:function(){return Je},set:function(Ee){Me=null,Je=Ee}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Ee){var le;if(this.ctx.font=Ee,(le=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Ee))!==null){var Be=le[1],it=(le[2],le[3]),We=le[4],$e=(le[5],le[6]),Ze=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(We)[2];We=Math.floor(Ze==="px"?parseFloat(We)*this.pdf.internal.scaleFactor:Ze==="em"?parseFloat(We)*this.pdf.getFontSize():parseFloat(We)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(We);var et=function(gt){var kt,rt,Cr=[],Pt=gt.trim();if(Pt==="")return gc;if(Pt in hh)return[hh[Pt]];for(;Pt!=="";){switch(rt=null,kt=(Pt=dh(Pt)).charAt(0)){case'"':case"'":rt=am(Pt.substring(1),kt);break;default:rt=im(Pt)}if(rt===null||(Cr.push(rt[0]),(Pt=dh(rt[1]))!==""&&Pt.charAt(0)!==","))return gc;Pt=Pt.replace(/^,/,"")}return Cr}($e);if(this.fontFaces){var ft=nm(Ve(this.pdf,this.fontFaces),et.map(function(gt){return{family:gt,stretch:"normal",weight:it,style:Be}}));this.pdf.setFont(ft.ref.name,ft.ref.style)}else{var ht="";(it==="bold"||parseInt(it,10)>=700||Be==="bold")&&(ht="bold"),Be==="italic"&&(ht+="italic"),ht.length===0&&(ht="normal");for(var yt="",At={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Ft=0;Ft<et.length;Ft++){if(this.pdf.internal.getFont(et[Ft],ht,{noFallback:!0,disableWarning:!0})!==void 0){yt=et[Ft];break}if(ht==="bolditalic"&&this.pdf.internal.getFont(et[Ft],"bold",{noFallback:!0,disableWarning:!0})!==void 0)yt=et[Ft],ht="bold";else if(this.pdf.internal.getFont(et[Ft],"normal",{noFallback:!0,disableWarning:!0})!==void 0){yt=et[Ft],ht="normal";break}}if(yt===""){for(var Ct=0;Ct<et.length;Ct++)if(At[et[Ct]]){yt=At[et[Ct]];break}}yt=yt===""?"Times":yt,this.pdf.setFont(yt,ht)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Ee){this.ctx.globalCompositeOperation=Ee}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Ee){this.ctx.globalAlpha=Ee}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Ee){this.ctx.lineDashOffset=Ee,ve.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Ee){this.ctx.lineDash=Ee,ve.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Ee){this.ctx.ignoreClearRect=!!Ee}})};g.prototype.setLineDash=function(j){this.lineDash=j},g.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},g.prototype.fill=function(){E.call(this,"fill",!1)},g.prototype.stroke=function(){E.call(this,"stroke",!1)},g.prototype.beginPath=function(){this.path=[{type:"begin"}]},g.prototype.moveTo=function(j,O){if(isNaN(j)||isNaN(O))throw tr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var I=this.ctx.transform.applyToPoint(new l(j,O));this.path.push({type:"mt",x:I.x,y:I.y}),this.ctx.lastPoint=new l(j,O)},g.prototype.closePath=function(){var j=new l(0,0),O=0;for(O=this.path.length-1;O!==-1;O--)if(this.path[O].type==="begin"&&rr(this.path[O+1])==="object"&&typeof this.path[O+1].x=="number"){j=new l(this.path[O+1].x,this.path[O+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new l(j.x,j.y)},g.prototype.lineTo=function(j,O){if(isNaN(j)||isNaN(O))throw tr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var I=this.ctx.transform.applyToPoint(new l(j,O));this.path.push({type:"lt",x:I.x,y:I.y}),this.ctx.lastPoint=new l(I.x,I.y)},g.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),E.call(this,null,!0)},g.prototype.quadraticCurveTo=function(j,O,I,D){if(isNaN(I)||isNaN(D)||isNaN(j)||isNaN(O))throw tr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var X=this.ctx.transform.applyToPoint(new l(I,D)),fe=this.ctx.transform.applyToPoint(new l(j,O));this.path.push({type:"qct",x1:fe.x,y1:fe.y,x:X.x,y:X.y}),this.ctx.lastPoint=new l(X.x,X.y)},g.prototype.bezierCurveTo=function(j,O,I,D,X,fe){if(isNaN(X)||isNaN(fe)||isNaN(j)||isNaN(O)||isNaN(I)||isNaN(D))throw tr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var he=this.ctx.transform.applyToPoint(new l(X,fe)),ue=this.ctx.transform.applyToPoint(new l(j,O)),be=this.ctx.transform.applyToPoint(new l(I,D));this.path.push({type:"bct",x1:ue.x,y1:ue.y,x2:be.x,y2:be.y,x:he.x,y:he.y}),this.ctx.lastPoint=new l(he.x,he.y)},g.prototype.arc=function(j,O,I,D,X,fe){if(isNaN(j)||isNaN(O)||isNaN(I)||isNaN(D)||isNaN(X))throw tr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(fe=!!fe,!this.ctx.transform.isIdentity){var he=this.ctx.transform.applyToPoint(new l(j,O));j=he.x,O=he.y;var ue=this.ctx.transform.applyToPoint(new l(0,I)),be=this.ctx.transform.applyToPoint(new l(0,0));I=Math.sqrt(Math.pow(ue.x-be.x,2)+Math.pow(ue.y-be.y,2))}Math.abs(X-D)>=2*Math.PI&&(D=0,X=2*Math.PI),this.path.push({type:"arc",x:j,y:O,radius:I,startAngle:D,endAngle:X,counterclockwise:fe})},g.prototype.arcTo=function(j,O,I,D,X){throw new Error("arcTo not implemented.")},g.prototype.rect=function(j,O,I,D){if(isNaN(j)||isNaN(O)||isNaN(I)||isNaN(D))throw tr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(j,O),this.lineTo(j+I,O),this.lineTo(j+I,O+D),this.lineTo(j,O+D),this.lineTo(j,O),this.lineTo(j+I,O),this.lineTo(j,O)},g.prototype.fillRect=function(j,O,I,D){if(isNaN(j)||isNaN(O)||isNaN(I)||isNaN(D))throw tr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!p.call(this)){var X={};this.lineCap!=="butt"&&(X.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(X.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(j,O,I,D),this.fill(),X.hasOwnProperty("lineCap")&&(this.lineCap=X.lineCap),X.hasOwnProperty("lineJoin")&&(this.lineJoin=X.lineJoin)}},g.prototype.strokeRect=function(j,O,I,D){if(isNaN(j)||isNaN(O)||isNaN(I)||isNaN(D))throw tr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");w.call(this)||(this.beginPath(),this.rect(j,O,I,D),this.stroke())},g.prototype.clearRect=function(j,O,I,D){if(isNaN(j)||isNaN(O)||isNaN(I)||isNaN(D))throw tr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(j,O,I,D))},g.prototype.save=function(j){j=typeof j!="boolean"||j;for(var O=this.pdf.internal.getCurrentPageInfo().pageNumber,I=0;I<this.pdf.internal.getNumberOfPages();I++)this.pdf.setPage(I+1),this.pdf.internal.out("q");if(this.pdf.setPage(O),j){this.ctx.fontSize=this.pdf.internal.getFontSize();var D=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=D}},g.prototype.restore=function(j){j=typeof j!="boolean"||j;for(var O=this.pdf.internal.getCurrentPageInfo().pageNumber,I=0;I<this.pdf.internal.getNumberOfPages();I++)this.pdf.setPage(I+1),this.pdf.internal.out("Q");this.pdf.setPage(O),j&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},g.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var x=function(j){var O,I,D,X;if(j.isCanvasGradient===!0&&(j=j.getColor()),!j)return{r:0,g:0,b:0,a:0,style:j};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(j))O=0,I=0,D=0,X=0;else{var fe=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(j);if(fe!==null)O=parseInt(fe[1]),I=parseInt(fe[2]),D=parseInt(fe[3]),X=1;else if((fe=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(j))!==null)O=parseInt(fe[1]),I=parseInt(fe[2]),D=parseInt(fe[3]),X=parseFloat(fe[4]);else{if(X=1,typeof j=="string"&&j.charAt(0)!=="#"){var he=new _u(j);j=he.ok?he.toHex():"#000000"}j.length===4?(O=j.substring(1,2),O+=O,I=j.substring(2,3),I+=I,D=j.substring(3,4),D+=D):(O=j.substring(1,3),I=j.substring(3,5),D=j.substring(5,7)),O=parseInt(O,16),I=parseInt(I,16),D=parseInt(D,16)}}return{r:O,g:I,b:D,a:X,style:j}},p=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},w=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};g.prototype.fillText=function(j,O,I,D){if(isNaN(O)||isNaN(I)||typeof j!="string")throw tr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(D=isNaN(D)?void 0:D,!p.call(this)){var X=oe(this.ctx.transform.rotation),fe=this.ctx.transform.scaleX;T.call(this,{text:j,x:O,y:I,scale:fe,angle:X,align:this.textAlign,maxWidth:D})}},g.prototype.strokeText=function(j,O,I,D){if(isNaN(O)||isNaN(I)||typeof j!="string")throw tr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!w.call(this)){D=isNaN(D)?void 0:D;var X=oe(this.ctx.transform.rotation),fe=this.ctx.transform.scaleX;T.call(this,{text:j,x:O,y:I,scale:fe,renderingMode:"stroke",angle:X,align:this.textAlign,maxWidth:D})}},g.prototype.measureText=function(j){if(typeof j!="string")throw tr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var O=this.pdf,I=this.pdf.internal.scaleFactor,D=O.internal.getFontSize(),X=O.getStringUnitWidth(j)*D/O.internal.scaleFactor,fe=function(he){var ue=(he=he||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ue}}),this};return new fe({width:X*=Math.round(96*I/72*1e4)/1e4})},g.prototype.scale=function(j,O){if(isNaN(j)||isNaN(O))throw tr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var I=new f(j,0,0,O,0,0);this.ctx.transform=this.ctx.transform.multiply(I)},g.prototype.rotate=function(j){if(isNaN(j))throw tr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var O=new f(Math.cos(j),Math.sin(j),-Math.sin(j),Math.cos(j),0,0);this.ctx.transform=this.ctx.transform.multiply(O)},g.prototype.translate=function(j,O){if(isNaN(j)||isNaN(O))throw tr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var I=new f(1,0,0,1,j,O);this.ctx.transform=this.ctx.transform.multiply(I)},g.prototype.transform=function(j,O,I,D,X,fe){if(isNaN(j)||isNaN(O)||isNaN(I)||isNaN(D)||isNaN(X)||isNaN(fe))throw tr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var he=new f(j,O,I,D,X,fe);this.ctx.transform=this.ctx.transform.multiply(he)},g.prototype.setTransform=function(j,O,I,D,X,fe){j=isNaN(j)?1:j,O=isNaN(O)?0:O,I=isNaN(I)?0:I,D=isNaN(D)?1:D,X=isNaN(X)?0:X,fe=isNaN(fe)?0:fe,this.ctx.transform=new f(j,O,I,D,X,fe)};var v=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};g.prototype.drawImage=function(j,O,I,D,X,fe,he,ue,be){var Oe=this.pdf.getImageProperties(j),Me=1,Ve=1,Je=1,Ee=1;D!==void 0&&ue!==void 0&&(Je=ue/D,Ee=be/X,Me=Oe.width/D*ue/D,Ve=Oe.height/X*be/X),fe===void 0&&(fe=O,he=I,O=0,I=0),D!==void 0&&ue===void 0&&(ue=D,be=X),D===void 0&&ue===void 0&&(ue=Oe.width,be=Oe.height);for(var le,Be=this.ctx.transform.decompose(),it=oe(Be.rotate.shx),We=new f,$e=(We=(We=(We=We.multiply(Be.translate)).multiply(Be.skew)).multiply(Be.scale)).applyToRectangle(new c(fe-O*Je,he-I*Ee,D*Me,X*Ve)),Ze=_.call(this,$e),et=[],ft=0;ft<Ze.length;ft+=1)et.indexOf(Ze[ft])===-1&&et.push(Ze[ft]);if(A(et),this.autoPaging)for(var ht=et[0],yt=et[et.length-1],At=ht;At<yt+1;At++){this.pdf.setPage(At);var Ft=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ct=At===1?this.posY+this.margin[0]:this.margin[0],gt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],kt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],rt=At===1?0:gt+(At-2)*kt;if(this.ctx.clip_path.length!==0){var Cr=this.path;le=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(le,this.posX+this.margin[3],-rt+Ct+this.ctx.prevPageLastElemOffset),U.call(this,"fill",!0),this.path=Cr}var Pt=JSON.parse(JSON.stringify($e));Pt=b([Pt],this.posX+this.margin[3],-rt+Ct+this.ctx.prevPageLastElemOffset)[0];var pn=(At>ht||At<yt)&&v.call(this);pn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ft,kt,null).clip().discardPath()),this.pdf.addImage(j,"JPEG",Pt.x,Pt.y,Pt.w,Pt.h,null,null,it),pn&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(j,"JPEG",$e.x,$e.y,$e.w,$e.h,null,null,it)};var _=function(j,O,I){var D=[];O=O||this.pdf.internal.pageSize.width,I=I||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var X=this.posY+this.ctx.prevPageLastElemOffset;switch(j.type){default:case"mt":case"lt":D.push(Math.floor((j.y+X)/I)+1);break;case"arc":D.push(Math.floor((j.y+X-j.radius)/I)+1),D.push(Math.floor((j.y+X+j.radius)/I)+1);break;case"qct":var fe=ae(this.ctx.lastPoint.x,this.ctx.lastPoint.y,j.x1,j.y1,j.x,j.y);D.push(Math.floor((fe.y+X)/I)+1),D.push(Math.floor((fe.y+fe.h+X)/I)+1);break;case"bct":var he=ge(this.ctx.lastPoint.x,this.ctx.lastPoint.y,j.x1,j.y1,j.x2,j.y2,j.x,j.y);D.push(Math.floor((he.y+X)/I)+1),D.push(Math.floor((he.y+he.h+X)/I)+1);break;case"rect":D.push(Math.floor((j.y+X)/I)+1),D.push(Math.floor((j.y+j.h+X)/I)+1)}for(var ue=0;ue<D.length;ue+=1)for(;this.pdf.internal.getNumberOfPages()<D[ue];)S.call(this);return D},S=function(){var j=this.fillStyle,O=this.strokeStyle,I=this.font,D=this.lineCap,X=this.lineWidth,fe=this.lineJoin;this.pdf.addPage(),this.fillStyle=j,this.strokeStyle=O,this.font=I,this.lineCap=D,this.lineWidth=X,this.lineJoin=fe},b=function(j,O,I){for(var D=0;D<j.length;D++)switch(j[D].type){case"bct":j[D].x2+=O,j[D].y2+=I;case"qct":j[D].x1+=O,j[D].y1+=I;case"mt":case"lt":case"arc":default:j[D].x+=O,j[D].y+=I}return j},A=function(j){return j.sort(function(O,I){return O-I})},E=function(j,O){for(var I,D,X=this.fillStyle,fe=this.strokeStyle,he=this.lineCap,ue=this.lineWidth,be=Math.abs(ue*this.ctx.transform.scaleX),Oe=this.lineJoin,Me=JSON.parse(JSON.stringify(this.path)),Ve=JSON.parse(JSON.stringify(this.path)),Je=[],Ee=0;Ee<Ve.length;Ee++)if(Ve[Ee].x!==void 0)for(var le=_.call(this,Ve[Ee]),Be=0;Be<le.length;Be+=1)Je.indexOf(le[Be])===-1&&Je.push(le[Be]);for(var it=0;it<Je.length;it++)for(;this.pdf.internal.getNumberOfPages()<Je[it];)S.call(this);if(A(Je),this.autoPaging)for(var We=Je[0],$e=Je[Je.length-1],Ze=We;Ze<$e+1;Ze++){this.pdf.setPage(Ze),this.fillStyle=X,this.strokeStyle=fe,this.lineCap=he,this.lineWidth=be,this.lineJoin=Oe;var et=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ft=Ze===1?this.posY+this.margin[0]:this.margin[0],ht=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],yt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],At=Ze===1?0:ht+(Ze-2)*yt;if(this.ctx.clip_path.length!==0){var Ft=this.path;I=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(I,this.posX+this.margin[3],-At+ft+this.ctx.prevPageLastElemOffset),U.call(this,j,!0),this.path=Ft}if(D=JSON.parse(JSON.stringify(Me)),this.path=b(D,this.posX+this.margin[3],-At+ft+this.ctx.prevPageLastElemOffset),O===!1||Ze===0){var Ct=(Ze>We||Ze<$e)&&v.call(this);Ct&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],et,yt,null).clip().discardPath()),U.call(this,j,O),Ct&&this.pdf.restoreGraphicsState()}this.lineWidth=ue}else this.lineWidth=be,U.call(this,j,O),this.lineWidth=ue;this.path=Me},U=function(j,O){if((j!=="stroke"||O||!w.call(this))&&(j==="stroke"||O||!p.call(this))){for(var I,D,X=[],fe=this.path,he=0;he<fe.length;he++){var ue=fe[he];switch(ue.type){case"begin":X.push({begin:!0});break;case"close":X.push({close:!0});break;case"mt":X.push({start:ue,deltas:[],abs:[]});break;case"lt":var be=X.length;if(fe[he-1]&&!isNaN(fe[he-1].x)&&(I=[ue.x-fe[he-1].x,ue.y-fe[he-1].y],be>0)){for(;be>=0;be--)if(X[be-1].close!==!0&&X[be-1].begin!==!0){X[be-1].deltas.push(I),X[be-1].abs.push(ue);break}}break;case"bct":I=[ue.x1-fe[he-1].x,ue.y1-fe[he-1].y,ue.x2-fe[he-1].x,ue.y2-fe[he-1].y,ue.x-fe[he-1].x,ue.y-fe[he-1].y],X[X.length-1].deltas.push(I);break;case"qct":var Oe=fe[he-1].x+2/3*(ue.x1-fe[he-1].x),Me=fe[he-1].y+2/3*(ue.y1-fe[he-1].y),Ve=ue.x+2/3*(ue.x1-ue.x),Je=ue.y+2/3*(ue.y1-ue.y),Ee=ue.x,le=ue.y;I=[Oe-fe[he-1].x,Me-fe[he-1].y,Ve-fe[he-1].x,Je-fe[he-1].y,Ee-fe[he-1].x,le-fe[he-1].y],X[X.length-1].deltas.push(I);break;case"arc":X.push({deltas:[],abs:[],arc:!0}),Array.isArray(X[X.length-1].abs)&&X[X.length-1].abs.push(ue)}}D=O?null:j==="stroke"?"stroke":"fill";for(var Be=!1,it=0;it<X.length;it++)if(X[it].arc)for(var We=X[it].abs,$e=0;$e<We.length;$e++){var Ze=We[$e];Ze.type==="arc"?C.call(this,Ze.x,Ze.y,Ze.radius,Ze.startAngle,Ze.endAngle,Ze.counterclockwise,void 0,O,!Be):H.call(this,Ze.x,Ze.y),Be=!0}else if(X[it].close===!0)this.pdf.internal.out("h"),Be=!1;else if(X[it].begin!==!0){var et=X[it].start.x,ft=X[it].start.y;G.call(this,X[it].deltas,et,ft),Be=!0}D&&P.call(this,D),O&&W.call(this)}},R=function(j){var O=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,I=O*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return j-I;case"top":return j+O-I;case"hanging":return j+O-2*I;case"middle":return j+O/2-I;case"ideographic":return j;case"alphabetic":default:return j}},L=function(j){return j+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};g.prototype.createLinearGradient=function(){var j=function(){};return j.colorStops=[],j.addColorStop=function(O,I){this.colorStops.push([O,I])},j.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},j.isCanvasGradient=!0,j},g.prototype.createPattern=function(){return this.createLinearGradient()},g.prototype.createRadialGradient=function(){return this.createLinearGradient()};var C=function(j,O,I,D,X,fe,he,ue,be){for(var Oe=J.call(this,I,D,X,fe),Me=0;Me<Oe.length;Me++){var Ve=Oe[Me];Me===0&&(be?k.call(this,Ve.x1+j,Ve.y1+O):H.call(this,Ve.x1+j,Ve.y1+O)),ce.call(this,j,O,Ve.x2,Ve.y2,Ve.x3,Ve.y3,Ve.x4,Ve.y4)}ue?W.call(this):P.call(this,he)},P=function(j){switch(j){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},W=function(){this.pdf.clip(),this.pdf.discardPath()},k=function(j,O){this.pdf.internal.out(t(j)+" "+n(O)+" m")},T=function(j){var O;switch(j.align){case"right":case"end":O="right";break;case"center":O="center";break;case"left":case"start":default:O="left"}var I=this.pdf.getTextDimensions(j.text),D=R.call(this,j.y),X=L.call(this,D)-I.h,fe=this.ctx.transform.applyToPoint(new l(j.x,D)),he=this.ctx.transform.decompose(),ue=new f;ue=(ue=(ue=ue.multiply(he.translate)).multiply(he.skew)).multiply(he.scale);for(var be,Oe,Me,Ve=this.ctx.transform.applyToRectangle(new c(j.x,D,I.w,I.h)),Je=ue.applyToRectangle(new c(j.x,X,I.w,I.h)),Ee=_.call(this,Je),le=[],Be=0;Be<Ee.length;Be+=1)le.indexOf(Ee[Be])===-1&&le.push(Ee[Be]);if(A(le),this.autoPaging)for(var it=le[0],We=le[le.length-1],$e=it;$e<We+1;$e++){this.pdf.setPage($e);var Ze=$e===1?this.posY+this.margin[0]:this.margin[0],et=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ft=this.pdf.internal.pageSize.height-this.margin[2],ht=ft-this.margin[0],yt=this.pdf.internal.pageSize.width-this.margin[1],At=yt-this.margin[3],Ft=$e===1?0:et+($e-2)*ht;if(this.ctx.clip_path.length!==0){var Ct=this.path;be=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(be,this.posX+this.margin[3],-1*Ft+Ze),U.call(this,"fill",!0),this.path=Ct}var gt=b([JSON.parse(JSON.stringify(Je))],this.posX+this.margin[3],-Ft+Ze+this.ctx.prevPageLastElemOffset)[0];j.scale>=.01&&(Oe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Oe*j.scale),Me=this.lineWidth,this.lineWidth=Me*j.scale);var kt=this.autoPaging!=="text";if(kt||gt.y+gt.h<=ft){if(kt||gt.y>=Ze&&gt.x<=yt){var rt=kt?j.text:this.pdf.splitTextToSize(j.text,j.maxWidth||yt-gt.x)[0],Cr=b([JSON.parse(JSON.stringify(Ve))],this.posX+this.margin[3],-Ft+Ze+this.ctx.prevPageLastElemOffset)[0],Pt=kt&&($e>it||$e<We)&&v.call(this);Pt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],At,ht,null).clip().discardPath()),this.pdf.text(rt,Cr.x,Cr.y,{angle:j.angle,align:O,renderingMode:j.renderingMode}),Pt&&this.pdf.restoreGraphicsState()}}else gt.y<ft&&(this.ctx.prevPageLastElemOffset+=ft-gt.y);j.scale>=.01&&(this.pdf.setFontSize(Oe),this.lineWidth=Me)}else j.scale>=.01&&(Oe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Oe*j.scale),Me=this.lineWidth,this.lineWidth=Me*j.scale),this.pdf.text(j.text,fe.x+this.posX,fe.y+this.posY,{angle:j.angle,align:O,renderingMode:j.renderingMode,maxWidth:j.maxWidth}),j.scale>=.01&&(this.pdf.setFontSize(Oe),this.lineWidth=Me)},H=function(j,O,I,D){I=I||0,D=D||0,this.pdf.internal.out(t(j+I)+" "+n(O+D)+" l")},G=function(j,O,I){return this.pdf.lines(j,O,I,null,null)},ce=function(j,O,I,D,X,fe,he,ue){this.pdf.internal.out([r(a(I+j)),r(s(D+O)),r(a(X+j)),r(s(fe+O)),r(a(he+j)),r(s(ue+O)),"c"].join(" "))},J=function(j,O,I,D){for(var X=2*Math.PI,fe=Math.PI/2;O>I;)O-=X;var he=Math.abs(I-O);he<X&&D&&(he=X-he);for(var ue=[],be=D?-1:1,Oe=O;he>1e-5;){var Me=Oe+be*Math.min(he,fe);ue.push(Q.call(this,j,Oe,Me)),he-=Math.abs(Me-Oe),Oe=Me}return ue},Q=function(j,O,I){var D=(I-O)/2,X=j*Math.cos(D),fe=j*Math.sin(D),he=X,ue=-fe,be=he*he+ue*ue,Oe=be+he*X+ue*fe,Me=4/3*(Math.sqrt(2*be*Oe)-Oe)/(he*fe-ue*X),Ve=he-Me*ue,Je=ue+Me*he,Ee=Ve,le=-Je,Be=D+O,it=Math.cos(Be),We=Math.sin(Be);return{x1:j*Math.cos(O),y1:j*Math.sin(O),x2:Ve*it-Je*We,y2:Ve*We+Je*it,x3:Ee*it-le*We,y3:Ee*We+le*it,x4:j*Math.cos(I),y4:j*Math.sin(I)}},oe=function(j){return 180*j/Math.PI},ae=function(j,O,I,D,X,fe){var he=j+.5*(I-j),ue=O+.5*(D-O),be=X+.5*(I-X),Oe=fe+.5*(D-fe),Me=Math.min(j,X,he,be),Ve=Math.max(j,X,he,be),Je=Math.min(O,fe,ue,Oe),Ee=Math.max(O,fe,ue,Oe);return new c(Me,Je,Ve-Me,Ee-Je)},ge=function(j,O,I,D,X,fe,he,ue){var be,Oe,Me,Ve,Je,Ee,le,Be,it,We,$e,Ze,et,ft,ht=I-j,yt=D-O,At=X-I,Ft=fe-D,Ct=he-X,gt=ue-fe;for(Oe=0;Oe<41;Oe++)it=(le=(Me=j+(be=Oe/40)*ht)+be*((Je=I+be*At)-Me))+be*(Je+be*(X+be*Ct-Je)-le),We=(Be=(Ve=O+be*yt)+be*((Ee=D+be*Ft)-Ve))+be*(Ee+be*(fe+be*gt-Ee)-Be),Oe==0?($e=it,Ze=We,et=it,ft=We):($e=Math.min($e,it),Ze=Math.min(Ze,We),et=Math.max(et,it),ft=Math.max(ft,We));return new c(Math.round($e),Math.round(Ze),Math.round(et-$e),Math.round(ft-Ze))},ve=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var j,O,I=(j=this.ctx.lineDash,O=this.ctx.lineDashOffset,JSON.stringify({lineDash:j,lineDashOffset:O}));this.prevLineDash!==I&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=I)}}})(mt.API),function(e){var r=function(s){var l,c,f,u,d,g,x,p,w,v;for(c=[],f=0,u=(s+=l="\0\0\0\0".slice(s.length%4||4)).length;u>f;f+=4)(d=(s.charCodeAt(f)<<24)+(s.charCodeAt(f+1)<<16)+(s.charCodeAt(f+2)<<8)+s.charCodeAt(f+3))!==0?(g=(d=((d=((d=((d=(d-(v=d%85))/85)-(w=d%85))/85)-(p=d%85))/85)-(x=d%85))/85)%85,c.push(g+33,x+33,p+33,w+33,v+33)):c.push(122);return function(_,S){for(var b=S;b>0;b--)_.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},t=function(s){var l,c,f,u,d,g=String,x="length",p=255,w="charCodeAt",v="slice",_="replace";for(s[v](-2),s=s[v](0,-2)[_](/\s/g,"")[_]("z","!!!!!"),f=[],u=0,d=(s+=l="uuuuu"[v](s[x]%5||5))[x];d>u;u+=5)c=52200625*(s[w](u)-33)+614125*(s[w](u+1)-33)+7225*(s[w](u+2)-33)+85*(s[w](u+3)-33)+(s[w](u+4)-33),f.push(p&c>>24,p&c>>16,p&c>>8,p&c);return function(S,b){for(var A=b;A>0;A--)S.pop()}(f,l[x]),g.fromCharCode.apply(g,f)},n=function(s){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),l.test(s)===!1)return"";for(var c="",f=0;f<s.length;f+=2)c+=String.fromCharCode("0x"+(s[f]+s[f+1]));return c},a=function(s){for(var l=new Uint8Array(s.length),c=s.length;c--;)l[c]=s.charCodeAt(c);return s=(l=Oc(l)).reduce(function(f,u){return f+String.fromCharCode(u)},"")};e.processDataByFilters=function(s,l){var c=0,f=s||"",u=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":f=t(f),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":f=r(f),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":f=n(f),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":f=f.split("").map(function(d){return("0"+d.charCodeAt().toString(16)).slice(-2)}).join("")+">",u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":f=a(f),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:f,reverseChain:u.reverse().join(" ")}}}(mt.API),function(e){e.loadFile=function(r,t,n){return function(a,s,l){s=s!==!1,l=typeof l=="function"?l:function(){};var c=void 0;try{c=function(f,u,d){var g=new XMLHttpRequest,x=0,p=function(w){var v=w.length,_=[],S=String.fromCharCode;for(x=0;x<v;x+=1)_.push(S(255&w.charCodeAt(x)));return _.join("")};if(g.open("GET",f,!u),g.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(g.onload=function(){g.status===200?d(p(this.responseText)):d(void 0)}),g.send(null),u&&g.status===200)return p(g.responseText)}(a,s,l)}catch{}return c}(r,t,n)},e.loadImageFile=e.loadFile}(mt.API),function(e){function r(){return(xt.html2canvas?Promise.resolve(xt.html2canvas):Ec(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function t(){return(xt.DOMPurify?Promise.resolve(xt.DOMPurify):Ec(()=>import("./purify.es-C_uT9hQ1.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=rr(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},a=function(l,c){var f=document.createElement(l);for(var u in c.className&&(f.className=c.className),c.innerHTML&&c.dompurify&&(f.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)f.style[u]=c.style[u];return f},s=function l(c){var f=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),u=l.convert(Promise.resolve(),f);return u=(u=u.setProgress(1,l,1,[l])).set(c)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(l,c){return l.__proto__=c||s.prototype,l},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(f){switch(n(f)){case"string":return"string";case"element":return f.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l)){case"string":return this.then(t).then(function(f){return this.set({src:a("div",{innerHTML:l,dompurify:f})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},s.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=function f(u,d){for(var g=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),x=u.firstChild;x;x=x.nextSibling)d!==!0&&x.nodeType===1&&x.nodeName==="SCRIPT"||g.appendChild(f(x,d));return u.nodeType===1&&(u.nodeName==="CANVAS"?(g.width=u.width,g.height=u.height,g.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(g.value=u.value),g.addEventListener("load",function(){g.scrollTop=u.scrollTop,g.scrollLeft=u.scrollLeft},!0)),g}(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(r).then(function(c){var f=Object.assign({},this.opt.html2canvas);return delete f.onrendered,c(this.prop.container,f)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(r).then(function(c){var f=this.opt.jsPDF,u=this.opt.fontFaces,d=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,g=Object.assign({async:!0,allowTaint:!0,scale:d,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete g.onrendered,f.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,f.context2d.posX=this.opt.x,f.context2d.posY=this.opt.y,f.context2d.margin=this.opt.margin,f.context2d.fontFaces=u,u)for(var x=0;x<u.length;++x){var p=u[x],w=p.src.find(function(v){return v.format==="truetype"});w&&f.addFont(w.url,p.ref.name,p.ref.style)}return g.windowHeight=g.windowHeight||0,g.windowHeight=g.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):g.windowHeight,f.context2d.save(!0),c(this.prop.container,g)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(l,c,f){return(f=f||"pdf").toLowerCase()==="img"||f.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},s.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},s.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},s.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(f){if(f in s.template.prop)return function(){this.prop[f]=l[f]};switch(f){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[f]=l[f]}}},this);return this.then(function(){return this.thenList(c)})},s.prototype.get=function(l,c){return this.then(function(){var f=l in s.template.prop?this.prop[l]:this.opt[l];return c?c(f):f})},s.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},s.prototype.setPageSize=function(l){function c(f,u){return Math.floor(f*u/72*96)}return this.then(function(){(l=l||mt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},s.prototype.setProgress=function(l,c,f,u){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),f!=null&&(this.progress.n=f),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(l,c,f,u){return this.setProgress(l?this.progress.val+l:null,c||null,f?this.progress.n+f:null,u?this.progress.stack.concat(u):null)},s.prototype.then=function(l,c){var f=this;return this.thenCore(l,c,function(u,d){return f.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(g){return f.updateProgress(null,u),g}).then(u,d).then(function(g){return f.updateProgress(1),g})})},s.prototype.thenCore=function(l,c,f){f=f||Promise.prototype.then,l&&(l=l.bind(this)),c&&(c=c.bind(this));var u=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:s.convert(Object.assign({},this),Promise.prototype),d=f.call(u,l,c);return s.convert(d,this.__proto__)},s.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},s.prototype.thenList=function(l){var c=this;return l.forEach(function(f){c=c.thenCore(f)}),c},s.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return s.convert(c,this)},s.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},s.prototype.error=function(l){return this.then(function(){throw new Error(l)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,mt.getPageSize=function(l,c,f){if(rr(l)==="object"){var u=l;l=u.orientation,c=u.unit||c,f=u.format||f}c=c||"mm",f=f||"a4",l=(""+(l||"P")).toLowerCase();var d,g=(""+f).toLowerCase(),x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":d=1;break;case"mm":d=72/25.4;break;case"cm":d=72/2.54;break;case"in":d=72;break;case"px":d=.75;break;case"pc":case"em":d=12;break;case"ex":d=6;break;default:throw"Invalid unit: "+c}var p,w=0,v=0;if(x.hasOwnProperty(g))w=x[g][1]/d,v=x[g][0]/d;else try{w=f[1],v=f[0]}catch{throw new Error("Invalid format: "+f)}if(l==="p"||l==="portrait")l="p",v>w&&(p=v,v=w,w=p);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",w>v&&(p=v,v=w,w=p)}return{width:v,height:w,unit:c,k:d,orientation:l}},e.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(Uc):null;var f=new s(c);return c.worker?f:f.from(l).doCallback()}}(mt.API),mt.API.addJS=function(e){return mh=e,this.internal.events.subscribe("postPutResources",function(){Ml=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Ml+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),ph=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+mh+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Ml!==void 0&&ph!==void 0&&this.internal.out("/Names <</JavaScript "+Ml+" 0 R>>")}),this},function(e){var r;e.events.push(["postPutResources",function(){var t=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=t.outline.render().split(/\r\n/),s=0;s<a.length;s++){var l=a[s],c=n.exec(l);if(c!=null){var f=c[1];t.internal.newObjectDeferredBegin(f,!1)}t.internal.write(l)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,d=[];for(s=0;s<u;s++){var g=t.internal.newObject();d.push(g);var x=t.internal.getPageInfo(s+1);t.internal.write("<< /D["+x.objId+" 0 R /XYZ null null null]>> endobj")}var p=t.internal.newObject();for(t.internal.write("<< /Names [ "),s=0;s<d.length;s++)t.internal.write("(page_"+(s+1)+")"+d[s]+" 0 R");t.internal.write(" ] >>","endobj"),r=t.internal.newObject(),t.internal.write("<< /Dests "+p+" 0 R"),t.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+r+" 0 R"))}]),e.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(n,a,s){var l={title:a,options:s,children:[]};return n==null&&(n=this.root),n.children.push(l),l},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(n){n.id=t.internal.newObjectDeferred();for(var a=0;a<n.children.length;a++)this.genIds_r(n.children[a])},t.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},t.outline.renderItems=function(n){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<n.children.length;s++){var l=n.children[s];this.objStart(l),this.line("/Title "+this.makeString(l.title)),this.line("/Parent "+this.makeRef(n)),s>0&&this.line("/Prev "+this.makeRef(n.children[s-1])),s<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[s+1])),l.children.length>0&&(this.line("/First "+this.makeRef(l.children[0])),this.line("/Last "+this.makeRef(l.children[l.children.length-1])));var c=this.count=this.count_r({count:0},l);if(c>0&&this.line("/Count "+c),l.options&&l.options.pageNumber){var f=t.internal.getPageInfo(l.options.pageNumber);this.line("/Dest ["+f.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},t.outline.line=function(n){this.ctx.val+=n+`\r
`},t.outline.makeRef=function(n){return n.id+" 0 R"},t.outline.makeString=function(n){return"("+t.internal.pdfEscape(n)+")"},t.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(n,a){for(var s=0;s<a.children.length;s++)n.count++,this.count_r(n,a.children[s]);return n.count}}])}(mt.API),function(e){var r=[192,193,194,195,196,197,198,199];e.processJPEG=function(t,n,a,s,l,c){var f,u=this.decode.DCT_DECODE,d=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=l||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,(f=function(g){for(var x,p=256*g.charCodeAt(4)+g.charCodeAt(5),w=g.length,v={width:0,height:0,numcomponents:1},_=4;_<w;_+=2){if(_+=p,r.indexOf(g.charCodeAt(_+1))!==-1){x=256*g.charCodeAt(_+5)+g.charCodeAt(_+6),v={width:256*g.charCodeAt(_+7)+g.charCodeAt(_+8),height:x,numcomponents:g.charCodeAt(_+9)};break}p=256*g.charCodeAt(_+2)+g.charCodeAt(_+3)}return v}(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t)).numcomponents){case 1:c=this.color_spaces.DEVICE_GRAY;break;case 4:c=this.color_spaces.DEVICE_CMYK;break;case 3:c=this.color_spaces.DEVICE_RGB}d={data:t,width:f.width,height:f.height,colorSpace:c,bitsPerComponent:8,filter:u,index:n,alias:a}}return d}}(mt.API);var ws,Bl,gh,xh,vh,sm=function(){var e,r,t;function n(s){var l,c,f,u,d,g,x,p,w,v,_,S,b,A;for(this.data=s,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},g=null;;){switch(l=this.readUInt32(),w=(function(){var E,U;for(U=[],E=0;E<4;++E)U.push(String.fromCharCode(this.data[this.pos++]));return U}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(l);break;case"fcTL":g&&this.animation.frames.push(g),this.pos+=4,g={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},d=this.readUInt16(),u=this.readUInt16()||100,g.delay=1e3*d/u,g.disposeOp=this.data[this.pos++],g.blendOp=this.data[this.pos++],g.data=[];break;case"IDAT":case"fdAT":for(w==="fdAT"&&(this.pos+=4,l-=4),s=(g!=null?g.data:void 0)||this.imgData,S=0;0<=l?S<l:S>l;0<=l?++S:--S)s.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(f=this.palette.length/3,this.transparency.indexed=this.read(l),this.transparency.indexed.length>f)throw new Error("More transparent colors than palette size");if((v=f-this.transparency.indexed.length)>0)for(b=0;0<=v?b<v:b>v;0<=v?++b:--b)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(l)[0];break;case 2:this.transparency.rgb=this.read(l)}break;case"tEXt":x=(_=this.read(l)).indexOf(0),p=String.fromCharCode.apply(String,_.slice(0,x)),this.text[p]=String.fromCharCode.apply(String,_.slice(x+1));break;case"IEND":return g&&this.animation.frames.push(g),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(A=this.colorType)===4||A===6,c=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*c,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=l}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(s){var l,c;for(c=[],l=0;0<=s?l<s:l>s;0<=s?++l:--l)c.push(this.data[this.pos++]);return c},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(s){var l=this.pixelBitlength/8,c=new Uint8Array(this.width*this.height*l),f=0,u=this;if(s==null&&(s=this.imgData),s.length===0)return new Uint8Array(0);function d(g,x,p,w){var v,_,S,b,A,E,U,R,L,C,P,W,k,T,H,G,ce,J,Q,oe,ae,ge=Math.ceil((u.width-g)/p),ve=Math.ceil((u.height-x)/w),j=u.width==ge&&u.height==ve;for(T=l*ge,W=j?c:new Uint8Array(T*ve),E=s.length,k=0,_=0;k<ve&&f<E;){switch(s[f++]){case 0:for(b=ce=0;ce<T;b=ce+=1)W[_++]=s[f++];break;case 1:for(b=J=0;J<T;b=J+=1)v=s[f++],A=b<l?0:W[_-l],W[_++]=(v+A)%256;break;case 2:for(b=Q=0;Q<T;b=Q+=1)v=s[f++],S=(b-b%l)/l,H=k&&W[(k-1)*T+S*l+b%l],W[_++]=(H+v)%256;break;case 3:for(b=oe=0;oe<T;b=oe+=1)v=s[f++],S=(b-b%l)/l,A=b<l?0:W[_-l],H=k&&W[(k-1)*T+S*l+b%l],W[_++]=(v+Math.floor((A+H)/2))%256;break;case 4:for(b=ae=0;ae<T;b=ae+=1)v=s[f++],S=(b-b%l)/l,A=b<l?0:W[_-l],k===0?H=G=0:(H=W[(k-1)*T+S*l+b%l],G=S&&W[(k-1)*T+(S-1)*l+b%l]),U=A+H-G,R=Math.abs(U-A),C=Math.abs(U-H),P=Math.abs(U-G),L=R<=C&&R<=P?A:C<=P?H:G,W[_++]=(v+L)%256;break;default:throw new Error("Invalid filter algorithm: "+s[f-1])}if(!j){var O=((x+k*w)*u.width+g)*l,I=k*T;for(b=0;b<ge;b+=1){for(var D=0;D<l;D+=1)c[O++]=W[I++];O+=(p-1)*l}}k++}}return s=Rp(s),u.interlaceMethod==1?(d(0,0,8,8),d(4,0,8,8),d(0,4,4,8),d(2,0,4,4),d(0,2,2,4),d(1,0,2,2),d(0,1,1,2)):d(0,0,1,1),c},n.prototype.decodePalette=function(){var s,l,c,f,u,d,g,x,p;for(c=this.palette,d=this.transparency.indexed||[],u=new Uint8Array((d.length||0)+c.length),f=0,s=0,l=g=0,x=c.length;g<x;l=g+=3)u[f++]=c[l],u[f++]=c[l+1],u[f++]=c[l+2],u[f++]=(p=d[s++])!=null?p:255;return u},n.prototype.copyToImageData=function(s,l){var c,f,u,d,g,x,p,w,v,_,S;if(f=this.colors,v=null,c=this.hasAlphaChannel,this.palette.length&&(v=(S=this._decodedPalette)!=null?S:this._decodedPalette=this.decodePalette(),f=4,c=!0),w=(u=s.data||s).length,g=v||l,d=x=0,f===1)for(;d<w;)p=v?4*l[d/4]:x,_=g[p++],u[d++]=_,u[d++]=_,u[d++]=_,u[d++]=c?g[p++]:255,x=p;else for(;d<w;)p=v?4*l[d/4]:x,u[d++]=g[p++],u[d++]=g[p++],u[d++]=g[p++],u[d++]=c?g[p++]:255,x=p},n.prototype.decode=function(){var s;return s=new Uint8Array(this.width*this.height*4),this.copyToImageData(s,this.decodePixels()),s};var a=function(){if(Object.prototype.toString.call(xt)==="[object Window]"){try{r=xt.document.createElement("canvas"),t=r.getContext("2d")}catch{return!1}return!0}return!1};return a(),e=function(s){var l;if(a()===!0)return t.width=s.width,t.height=s.height,t.clearRect(0,0,s.width,s.height),t.putImageData(s,0,0),(l=new Image).src=r.toDataURL(),l;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(s){var l,c,f,u,d,g,x,p;if(this.animation){for(p=[],c=d=0,g=(x=this.animation.frames).length;d<g;c=++d)l=x[c],f=s.createImageData(l.width,l.height),u=this.decodePixels(new Uint8Array(l.data)),this.copyToImageData(f,u),l.imageData=f,p.push(l.image=e(f));return p}},n.prototype.renderFrame=function(s,l){var c,f,u;return c=(f=this.animation.frames)[l],u=f[l-1],l===0&&s.clearRect(0,0,this.width,this.height),(u!=null?u.disposeOp:void 0)===1?s.clearRect(u.xOffset,u.yOffset,u.width,u.height):(u!=null?u.disposeOp:void 0)===2&&s.putImageData(u.imageData,u.xOffset,u.yOffset),c.blendOp===0&&s.clearRect(c.xOffset,c.yOffset,c.width,c.height),s.drawImage(c.image,c.xOffset,c.yOffset)},n.prototype.animate=function(s){var l,c,f,u,d,g,x=this;return c=0,g=this.animation,u=g.numFrames,f=g.frames,d=g.numPlays,(l=function(){var p,w;if(p=c++%u,w=f[p],x.renderFrame(s,p),u>1&&c/u<d)return x.animation._timeout=setTimeout(l,w.delay)})()},n.prototype.stopAnimation=function(){var s;return clearTimeout((s=this.animation)!=null?s._timeout:void 0)},n.prototype.render=function(s){var l,c;return s._png&&s._png.stopAnimation(),s._png=this,s.width=this.width,s.height=this.height,l=s.getContext("2d"),this.animation?(this.decodeFrames(l),this.animate(l)):(c=l.createImageData(this.width,this.height),this.copyToImageData(c,this.decodePixels()),l.putImageData(c,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function om(e){var r=0;if(e[r++]!==71||e[r++]!==73||e[r++]!==70||e[r++]!==56||(e[r++]+1&253)!=56||e[r++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=e[r++]|e[r++]<<8,n=e[r++]|e[r++]<<8,a=e[r++],s=a>>7,l=1<<(7&a)+1;e[r++],e[r++];var c=null,f=null;s&&(c=r,f=l,r+=3*l);var u=!0,d=[],g=0,x=null,p=0,w=null;for(this.width=t,this.height=n;u&&r<e.length;)switch(e[r++]){case 33:switch(e[r++]){case 255:if(e[r]!==11||e[r+1]==78&&e[r+2]==69&&e[r+3]==84&&e[r+4]==83&&e[r+5]==67&&e[r+6]==65&&e[r+7]==80&&e[r+8]==69&&e[r+9]==50&&e[r+10]==46&&e[r+11]==48&&e[r+12]==3&&e[r+13]==1&&e[r+16]==0)r+=14,w=e[r++]|e[r++]<<8,r++;else for(r+=12;;){if(!((k=e[r++])>=0))throw Error("Invalid block size");if(k===0)break;r+=k}break;case 249:if(e[r++]!==4||e[r+4]!==0)throw new Error("Invalid graphics extension block.");var v=e[r++];g=e[r++]|e[r++]<<8,x=e[r++],!(1&v)&&(x=null),p=v>>2&7,r++;break;case 254:for(;;){if(!((k=e[r++])>=0))throw Error("Invalid block size");if(k===0)break;r+=k}break;default:throw new Error("Unknown graphic control label: 0x"+e[r-1].toString(16))}break;case 44:var _=e[r++]|e[r++]<<8,S=e[r++]|e[r++]<<8,b=e[r++]|e[r++]<<8,A=e[r++]|e[r++]<<8,E=e[r++],U=E>>6&1,R=1<<(7&E)+1,L=c,C=f,P=!1;E>>7&&(P=!0,L=r,C=R,r+=3*R);var W=r;for(r++;;){var k;if(!((k=e[r++])>=0))throw Error("Invalid block size");if(k===0)break;r+=k}d.push({x:_,y:S,width:b,height:A,has_local_palette:P,palette_offset:L,palette_size:C,data_offset:W,data_length:r-W,transparent_index:x,interlaced:!!U,delay:g,disposal:p});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+e[r-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return w},this.frameInfo=function(T){if(T<0||T>=d.length)throw new Error("Frame index out of range.");return d[T]},this.decodeAndBlitFrameBGRA=function(T,H){var G=this.frameInfo(T),ce=G.width*G.height,J=new Uint8Array(ce);yh(e,G.data_offset,J,ce);var Q=G.palette_offset,oe=G.transparent_index;oe===null&&(oe=256);var ae=G.width,ge=t-ae,ve=ae,j=4*(G.y*t+G.x),O=4*((G.y+G.height)*t+G.x),I=j,D=4*ge;G.interlaced===!0&&(D+=4*t*7);for(var X=8,fe=0,he=J.length;fe<he;++fe){var ue=J[fe];if(ve===0&&(ve=ae,(I+=D)>=O&&(D=4*ge+4*t*(X-1),I=j+(ae+ge)*(X<<1),X>>=1)),ue===oe)I+=4;else{var be=e[Q+3*ue],Oe=e[Q+3*ue+1],Me=e[Q+3*ue+2];H[I++]=Me,H[I++]=Oe,H[I++]=be,H[I++]=255}--ve}},this.decodeAndBlitFrameRGBA=function(T,H){var G=this.frameInfo(T),ce=G.width*G.height,J=new Uint8Array(ce);yh(e,G.data_offset,J,ce);var Q=G.palette_offset,oe=G.transparent_index;oe===null&&(oe=256);var ae=G.width,ge=t-ae,ve=ae,j=4*(G.y*t+G.x),O=4*((G.y+G.height)*t+G.x),I=j,D=4*ge;G.interlaced===!0&&(D+=4*t*7);for(var X=8,fe=0,he=J.length;fe<he;++fe){var ue=J[fe];if(ve===0&&(ve=ae,(I+=D)>=O&&(D=4*ge+4*t*(X-1),I=j+(ae+ge)*(X<<1),X>>=1)),ue===oe)I+=4;else{var be=e[Q+3*ue],Oe=e[Q+3*ue+1],Me=e[Q+3*ue+2];H[I++]=be,H[I++]=Oe,H[I++]=Me,H[I++]=255}--ve}}}function yh(e,r,t,n){for(var a=e[r++],s=1<<a,l=s+1,c=l+1,f=a+1,u=(1<<f)-1,d=0,g=0,x=0,p=e[r++],w=new Int32Array(4096),v=null;;){for(;d<16&&p!==0;)g|=e[r++]<<d,d+=8,p===1?p=e[r++]:--p;if(d<f)break;var _=g&u;if(g>>=f,d-=f,_!==s){if(_===l)break;for(var S=_<c?_:v,b=0,A=S;A>s;)A=w[A]>>8,++b;var E=A;if(x+b+(S!==_?1:0)>n)return void tr.log("Warning, gif stream longer than expected.");t[x++]=E;var U=x+=b;for(S!==_&&(t[x++]=E),A=S;b--;)A=w[A],t[--U]=255&A,A>>=8;v!==null&&c<4096&&(w[c++]=v<<8|E,c>=u+1&&f<12&&(++f,u=u<<1|1)),v=_}else c=l+1,u=(1<<(f=a+1))-1,v=null}return x!==n&&tr.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function xc(e){var r,t,n,a,s,l=Math.floor,c=new Array(64),f=new Array(64),u=new Array(64),d=new Array(64),g=new Array(65535),x=new Array(65535),p=new Array(64),w=new Array(64),v=[],_=0,S=7,b=new Array(64),A=new Array(64),E=new Array(64),U=new Array(256),R=new Array(2048),L=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],C=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],P=[0,1,2,3,4,5,6,7,8,9,10,11],W=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],k=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],T=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],H=[0,1,2,3,4,5,6,7,8,9,10,11],G=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ce=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function J(j,O){for(var I=0,D=0,X=new Array,fe=1;fe<=16;fe++){for(var he=1;he<=j[fe];he++)X[O[D]]=[],X[O[D]][0]=I,X[O[D]][1]=fe,D++,I++;I*=2}return X}function Q(j){for(var O=j[0],I=j[1]-1;I>=0;)O&1<<I&&(_|=1<<S),I--,--S<0&&(_==255?(oe(255),oe(0)):oe(_),S=7,_=0)}function oe(j){v.push(j)}function ae(j){oe(j>>8&255),oe(255&j)}function ge(j,O,I,D,X){for(var fe,he=X[0],ue=X[240],be=function(We,$e){var Ze,et,ft,ht,yt,At,Ft,Ct,gt,kt,rt=0;for(gt=0;gt<8;++gt){Ze=We[rt],et=We[rt+1],ft=We[rt+2],ht=We[rt+3],yt=We[rt+4],At=We[rt+5],Ft=We[rt+6];var Cr=Ze+(Ct=We[rt+7]),Pt=Ze-Ct,pn=et+Ft,Wt=et-Ft,nr=ft+At,Mn=ft-At,Dt=ht+yt,ga=ht-yt,sr=Cr+Dt,An=Cr-Dt,Zn=pn+nr,Qt=pn-nr;We[rt]=sr+Zn,We[rt+4]=sr-Zn;var wt=.707106781*(Qt+An);We[rt+2]=An+wt,We[rt+6]=An-wt;var Mt=.382683433*((sr=ga+Mn)-(Qt=Wt+Pt)),Fa=.5411961*sr+Mt,Lr=1.306562965*Qt+Mt,Bn=.707106781*(Zn=Mn+Wt),Un=Pt+Bn,dt=Pt-Bn;We[rt+5]=dt+Fa,We[rt+3]=dt-Fa,We[rt+1]=Un+Lr,We[rt+7]=Un-Lr,rt+=8}for(rt=0,gt=0;gt<8;++gt){Ze=We[rt],et=We[rt+8],ft=We[rt+16],ht=We[rt+24],yt=We[rt+32],At=We[rt+40],Ft=We[rt+48];var jn=Ze+(Ct=We[rt+56]),mn=Ze-Ct,Jr=et+Ft,xr=et-Ft,fr=ft+At,q=ft-At,ne=ht+yt,Z=ht-yt,ee=jn+ne,re=jn-ne,ie=Jr+fr,_e=Jr-fr;We[rt]=ee+ie,We[rt+32]=ee-ie;var Fe=.707106781*(_e+re);We[rt+16]=re+Fe,We[rt+48]=re-Fe;var Ne=.382683433*((ee=Z+q)-(_e=xr+mn)),je=.5411961*ee+Ne,ke=1.306562965*_e+Ne,qe=.707106781*(ie=q+xr),Ye=mn+qe,at=mn-qe;We[rt+40]=at+je,We[rt+24]=at-je,We[rt+8]=Ye+ke,We[rt+56]=Ye-ke,rt++}for(gt=0;gt<64;++gt)kt=We[gt]*$e[gt],p[gt]=kt>0?kt+.5|0:kt-.5|0;return p}(j,O),Oe=0;Oe<64;++Oe)w[L[Oe]]=be[Oe];var Me=w[0]-I;I=w[0],Me==0?Q(D[0]):(Q(D[x[fe=32767+Me]]),Q(g[fe]));for(var Ve=63;Ve>0&&w[Ve]==0;)Ve--;if(Ve==0)return Q(he),I;for(var Je,Ee=1;Ee<=Ve;){for(var le=Ee;w[Ee]==0&&Ee<=Ve;)++Ee;var Be=Ee-le;if(Be>=16){Je=Be>>4;for(var it=1;it<=Je;++it)Q(ue);Be&=15}fe=32767+w[Ee],Q(X[(Be<<4)+x[fe]]),Q(g[fe]),Ee++}return Ve!=63&&Q(he),I}function ve(j){j=Math.min(Math.max(j,1),100),s!=j&&(function(O){for(var I=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],D=0;D<64;D++){var X=l((I[D]*O+50)/100);X=Math.min(Math.max(X,1),255),c[L[D]]=X}for(var fe=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],he=0;he<64;he++){var ue=l((fe[he]*O+50)/100);ue=Math.min(Math.max(ue,1),255),f[L[he]]=ue}for(var be=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Oe=0,Me=0;Me<8;Me++)for(var Ve=0;Ve<8;Ve++)u[Oe]=1/(c[L[Oe]]*be[Me]*be[Ve]*8),d[Oe]=1/(f[L[Oe]]*be[Me]*be[Ve]*8),Oe++}(j<50?Math.floor(5e3/j):Math.floor(200-2*j)),s=j)}this.encode=function(j,O){O&&ve(O),v=new Array,_=0,S=7,ae(65496),ae(65504),ae(16),oe(74),oe(70),oe(73),oe(70),oe(0),oe(1),oe(1),oe(0),ae(1),ae(1),oe(0),oe(0),function(){ae(65499),ae(132),oe(0);for(var et=0;et<64;et++)oe(c[et]);oe(1);for(var ft=0;ft<64;ft++)oe(f[ft])}(),function(et,ft){ae(65472),ae(17),oe(8),ae(ft),ae(et),oe(3),oe(1),oe(17),oe(0),oe(2),oe(17),oe(1),oe(3),oe(17),oe(1)}(j.width,j.height),function(){ae(65476),ae(418),oe(0);for(var et=0;et<16;et++)oe(C[et+1]);for(var ft=0;ft<=11;ft++)oe(P[ft]);oe(16);for(var ht=0;ht<16;ht++)oe(W[ht+1]);for(var yt=0;yt<=161;yt++)oe(k[yt]);oe(1);for(var At=0;At<16;At++)oe(T[At+1]);for(var Ft=0;Ft<=11;Ft++)oe(H[Ft]);oe(17);for(var Ct=0;Ct<16;Ct++)oe(G[Ct+1]);for(var gt=0;gt<=161;gt++)oe(ce[gt])}(),ae(65498),ae(12),oe(3),oe(1),oe(0),oe(2),oe(17),oe(3),oe(17),oe(0),oe(63),oe(0);var I=0,D=0,X=0;_=0,S=7,this.encode.displayName="_encode_";for(var fe,he,ue,be,Oe,Me,Ve,Je,Ee,le=j.data,Be=j.width,it=j.height,We=4*Be,$e=0;$e<it;){for(fe=0;fe<We;){for(Oe=We*$e+fe,Ve=-1,Je=0,Ee=0;Ee<64;Ee++)Me=Oe+(Je=Ee>>3)*We+(Ve=4*(7&Ee)),$e+Je>=it&&(Me-=We*($e+1+Je-it)),fe+Ve>=We&&(Me-=fe+Ve-We+4),he=le[Me++],ue=le[Me++],be=le[Me++],b[Ee]=(R[he]+R[ue+256>>0]+R[be+512>>0]>>16)-128,A[Ee]=(R[he+768>>0]+R[ue+1024>>0]+R[be+1280>>0]>>16)-128,E[Ee]=(R[he+1280>>0]+R[ue+1536>>0]+R[be+1792>>0]>>16)-128;I=ge(b,u,I,r,n),D=ge(A,d,D,t,a),X=ge(E,d,X,t,a),fe+=32}$e+=8}if(S>=0){var Ze=[];Ze[1]=S+1,Ze[0]=(1<<S+1)-1,Q(Ze)}return ae(65497),new Uint8Array(v)},e=e||50,function(){for(var j=String.fromCharCode,O=0;O<256;O++)U[O]=j(O)}(),r=J(C,P),t=J(T,H),n=J(W,k),a=J(G,ce),function(){for(var j=1,O=2,I=1;I<=15;I++){for(var D=j;D<O;D++)x[32767+D]=I,g[32767+D]=[],g[32767+D][1]=I,g[32767+D][0]=D;for(var X=-(O-1);X<=-j;X++)x[32767+X]=I,g[32767+X]=[],g[32767+X][1]=I,g[32767+X][0]=O-1+X;j<<=1,O<<=1}}(),function(){for(var j=0;j<256;j++)R[j]=19595*j,R[j+256>>0]=38470*j,R[j+512>>0]=7471*j+32768,R[j+768>>0]=-11059*j,R[j+1024>>0]=-21709*j,R[j+1280>>0]=32768*j+8421375,R[j+1536>>0]=-27439*j,R[j+1792>>0]=-5329*j}(),ve(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function oa(e,r){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!r,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function wh(e){function r(C){if(!C)throw Error("assert :P")}function t(C,P,W){for(var k=0;4>k;k++)if(C[P+k]!=W.charCodeAt(k))return!0;return!1}function n(C,P,W,k,T){for(var H=0;H<T;H++)C[P+H]=W[k+H]}function a(C,P,W,k){for(var T=0;T<k;T++)C[P+T]=W}function s(C){return new Int32Array(C)}function l(C,P){for(var W=[],k=0;k<C;k++)W.push(new P);return W}function c(C,P){var W=[];return function k(T,H,G){for(var ce=G[H],J=0;J<ce&&(T.push(G.length>H+1?[]:new P),!(G.length<H+1));J++)k(T[J],H+1,G)}(W,0,C),W}var f=function(){var C=this;function P(h,m){for(var N=1<<m-1>>>0;h&N;)N>>>=1;return N?(h&N-1)+N:h}function W(h,m,N,F,M){r(!(F%N));do h[m+(F-=N)]=M;while(0<F)}function k(h,m,N,F,M){if(r(2328>=M),512>=M)var z=s(512);else if((z=s(M))==null)return 0;return function(V,Y,K,te,pe,Se){var Ae,ye,Re=Y,Ce=1<<K,me=s(16),xe=s(16);for(r(pe!=0),r(te!=null),r(V!=null),r(0<K),ye=0;ye<pe;++ye){if(15<te[ye])return 0;++me[te[ye]]}if(me[0]==pe)return 0;for(xe[1]=0,Ae=1;15>Ae;++Ae){if(me[Ae]>1<<Ae)return 0;xe[Ae+1]=xe[Ae]+me[Ae]}for(ye=0;ye<pe;++ye)Ae=te[ye],0<te[ye]&&(Se[xe[Ae]++]=ye);if(xe[15]==1)return(te=new T).g=0,te.value=Se[0],W(V,Re,1,Ce,te),Ce;var Ie,He=-1,De=Ce-1,ot=0,Qe=1,pt=1,tt=1<<K;for(ye=0,Ae=1,pe=2;Ae<=K;++Ae,pe<<=1){if(Qe+=pt<<=1,0>(pt-=me[Ae]))return 0;for(;0<me[Ae];--me[Ae])(te=new T).g=Ae,te.value=Se[ye++],W(V,Re+ot,pe,tt,te),ot=P(ot,Ae)}for(Ae=K+1,pe=2;15>=Ae;++Ae,pe<<=1){if(Qe+=pt<<=1,0>(pt-=me[Ae]))return 0;for(;0<me[Ae];--me[Ae]){if(te=new T,(ot&De)!=He){for(Re+=tt,Ie=1<<(He=Ae)-K;15>He&&!(0>=(Ie-=me[He]));)++He,Ie<<=1;Ce+=tt=1<<(Ie=He-K),V[Y+(He=ot&De)].g=Ie+K,V[Y+He].value=Re-Y-He}te.g=Ae-K,te.value=Se[ye++],W(V,Re+(ot>>K),pe,tt,te),ot=P(ot,Ae)}}return Qe!=2*xe[15]-1?0:Ce}(h,m,N,F,M,z)}function T(){this.value=this.g=0}function H(){this.value=this.g=0}function G(){this.G=l(5,T),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=l(zr,H)}function ce(h,m,N,F){r(h!=null),r(m!=null),r(2147483648>F),h.Ca=254,h.I=0,h.b=-8,h.Ka=0,h.oa=m,h.pa=N,h.Jd=m,h.Yc=N+F,h.Zc=4<=F?N+F-4+1:N,fe(h)}function J(h,m){for(var N=0;0<m--;)N|=ue(h,128)<<m;return N}function Q(h,m){var N=J(h,m);return he(h)?-N:N}function oe(h,m,N,F){var M,z=0;for(r(h!=null),r(m!=null),r(4294967288>F),h.Sb=F,h.Ra=0,h.u=0,h.h=0,4<F&&(F=4),M=0;M<F;++M)z+=m[N+M]<<8*M;h.Ra=z,h.bb=F,h.oa=m,h.pa=N}function ae(h){for(;8<=h.u&&h.bb<h.Sb;)h.Ra>>>=8,h.Ra+=h.oa[h.pa+h.bb]<<cs-8>>>0,++h.bb,h.u-=8;I(h)&&(h.h=1,h.u=0)}function ge(h,m){if(r(0<=m),!h.h&&m<=ls){var N=O(h)&os[m];return h.u+=m,ae(h),N}return h.h=1,h.u=0}function ve(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function j(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function O(h){return h.Ra>>>(h.u&cs-1)>>>0}function I(h){return r(h.bb<=h.Sb),h.h||h.bb==h.Sb&&h.u>cs}function D(h,m){h.u=m,h.h=I(h)}function X(h){h.u>=ro&&(r(h.u>=ro),ae(h))}function fe(h){r(h!=null&&h.oa!=null),h.pa<h.Zc?(h.I=(h.oa[h.pa++]|h.I<<8)>>>0,h.b+=8):(r(h!=null&&h.oa!=null),h.pa<h.Yc?(h.b+=8,h.I=h.oa[h.pa++]|h.I<<8):h.Ka?h.b=0:(h.I<<=8,h.b+=8,h.Ka=1))}function he(h){return J(h,1)}function ue(h,m){var N=h.Ca;0>h.b&&fe(h);var F=h.b,M=N*m>>>8,z=(h.I>>>F>M)+0;for(z?(N-=M,h.I-=M+1<<F>>>0):N=M+1,F=N,M=0;256<=F;)M+=8,F>>=8;return F=7^M+xn[F],h.b-=F,h.Ca=(N<<F)-1,z}function be(h,m,N){h[m+0]=N>>24&255,h[m+1]=N>>16&255,h[m+2]=N>>8&255,h[m+3]=N>>0&255}function Oe(h,m){return h[m+0]<<0|h[m+1]<<8}function Me(h,m){return Oe(h,m)|h[m+2]<<16}function Ve(h,m){return Oe(h,m)|Oe(h,m+2)<<16}function Je(h,m){var N=1<<m;return r(h!=null),r(0<m),h.X=s(N),h.X==null?0:(h.Mb=32-m,h.Xa=m,1)}function Ee(h,m){r(h!=null),r(m!=null),r(h.Xa==m.Xa),n(m.X,0,h.X,0,1<<m.Xa)}function le(){this.X=[],this.Xa=this.Mb=0}function Be(h,m,N,F){r(N!=null),r(F!=null);var M=N[0],z=F[0];return M==0&&(M=(h*z+m/2)/m),z==0&&(z=(m*M+h/2)/h),0>=M||0>=z?0:(N[0]=M,F[0]=z,1)}function it(h,m){return h+(1<<m)-1>>>m}function We(h,m){return((4278255360&h)+(4278255360&m)>>>0&4278255360)+((16711935&h)+(16711935&m)>>>0&16711935)>>>0}function $e(h,m){C[m]=function(N,F,M,z,V,Y,K){var te;for(te=0;te<V;++te){var pe=C[h](Y[K+te-1],M,z+te);Y[K+te]=We(N[F+te],pe)}}}function Ze(){this.ud=this.hd=this.jd=0}function et(h,m){return((4278124286&(h^m))>>>1)+(h&m)>>>0}function ft(h){return 0<=h&&256>h?h:0>h?0:255<h?255:void 0}function ht(h,m){return ft(h+(h-m+.5>>1))}function yt(h,m,N){return Math.abs(m-N)-Math.abs(h-N)}function At(h,m,N,F,M,z,V){for(F=z[V-1],N=0;N<M;++N)z[V+N]=F=We(h[m+N],F)}function Ft(h,m,N,F,M){var z;for(z=0;z<N;++z){var V=h[m+z],Y=V>>8&255,K=16711935&(K=(K=16711935&V)+((Y<<16)+Y));F[M+z]=(4278255360&V)+K>>>0}}function Ct(h,m){m.jd=h>>0&255,m.hd=h>>8&255,m.ud=h>>16&255}function gt(h,m,N,F,M,z){var V;for(V=0;V<F;++V){var Y=m[N+V],K=Y>>>8,te=Y,pe=255&(pe=(pe=Y>>>16)+((h.jd<<24>>24)*(K<<24>>24)>>>5));te=255&(te=(te=te+((h.hd<<24>>24)*(K<<24>>24)>>>5))+((h.ud<<24>>24)*(pe<<24>>24)>>>5)),M[z+V]=(4278255360&Y)+(pe<<16)+te}}function kt(h,m,N,F,M){C[m]=function(z,V,Y,K,te,pe,Se,Ae,ye){for(K=Se;K<Ae;++K)for(Se=0;Se<ye;++Se)te[pe++]=M(Y[F(z[V++])])},C[h]=function(z,V,Y,K,te,pe,Se){var Ae=8>>z.b,ye=z.Ea,Re=z.K[0],Ce=z.w;if(8>Ae)for(z=(1<<z.b)-1,Ce=(1<<Ae)-1;V<Y;++V){var me,xe=0;for(me=0;me<ye;++me)me&z||(xe=F(K[te++])),pe[Se++]=M(Re[xe&Ce]),xe>>=Ae}else C["VP8LMapColor"+N](K,te,Re,Ce,pe,Se,V,Y,ye)}}function rt(h,m,N,F,M){for(N=m+N;m<N;){var z=h[m++];F[M++]=z>>16&255,F[M++]=z>>8&255,F[M++]=z>>0&255}}function Cr(h,m,N,F,M){for(N=m+N;m<N;){var z=h[m++];F[M++]=z>>16&255,F[M++]=z>>8&255,F[M++]=z>>0&255,F[M++]=z>>24&255}}function Pt(h,m,N,F,M){for(N=m+N;m<N;){var z=(V=h[m++])>>16&240|V>>12&15,V=V>>0&240|V>>28&15;F[M++]=z,F[M++]=V}}function pn(h,m,N,F,M){for(N=m+N;m<N;){var z=(V=h[m++])>>16&248|V>>13&7,V=V>>5&224|V>>3&31;F[M++]=z,F[M++]=V}}function Wt(h,m,N,F,M){for(N=m+N;m<N;){var z=h[m++];F[M++]=z>>0&255,F[M++]=z>>8&255,F[M++]=z>>16&255}}function nr(h,m,N,F,M,z){if(z==0)for(N=m+N;m<N;)be(F,((z=h[m++])[0]>>24|z[1]>>8&65280|z[2]<<8&16711680|z[3]<<24)>>>0),M+=32;else n(F,M,h,m,N)}function Mn(h,m){C[m][0]=C[h+"0"],C[m][1]=C[h+"1"],C[m][2]=C[h+"2"],C[m][3]=C[h+"3"],C[m][4]=C[h+"4"],C[m][5]=C[h+"5"],C[m][6]=C[h+"6"],C[m][7]=C[h+"7"],C[m][8]=C[h+"8"],C[m][9]=C[h+"9"],C[m][10]=C[h+"10"],C[m][11]=C[h+"11"],C[m][12]=C[h+"12"],C[m][13]=C[h+"13"],C[m][14]=C[h+"0"],C[m][15]=C[h+"0"]}function Dt(h){return h==W0||h==z0||h==yl||h==q0}function ga(){this.eb=[],this.size=this.A=this.fb=0}function sr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function An(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ga,this.f.kb=new sr,this.sd=null}function Zn(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Qt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function wt(h){return alert("todo:WebPSamplerProcessPlane"),h.T}function Mt(h,m){var N=h.T,F=m.ba.f.RGBA,M=F.eb,z=F.fb+h.ka*F.A,V=Gn[m.ba.S],Y=h.y,K=h.O,te=h.f,pe=h.N,Se=h.ea,Ae=h.W,ye=m.cc,Re=m.dc,Ce=m.Mc,me=m.Nc,xe=h.ka,Ie=h.ka+h.T,He=h.U,De=He+1>>1;for(xe==0?V(Y,K,null,null,te,pe,Se,Ae,te,pe,Se,Ae,M,z,null,null,He):(V(m.ec,m.fc,Y,K,ye,Re,Ce,me,te,pe,Se,Ae,M,z-F.A,M,z,He),++N);xe+2<Ie;xe+=2)ye=te,Re=pe,Ce=Se,me=Ae,pe+=h.Rc,Ae+=h.Rc,z+=2*F.A,V(Y,(K+=2*h.fa)-h.fa,Y,K,ye,Re,Ce,me,te,pe,Se,Ae,M,z-F.A,M,z,He);return K+=h.fa,h.j+Ie<h.o?(n(m.ec,m.fc,Y,K,He),n(m.cc,m.dc,te,pe,De),n(m.Mc,m.Nc,Se,Ae,De),N--):1&Ie||V(Y,K,null,null,te,pe,Se,Ae,te,pe,Se,Ae,M,z+F.A,null,null,He),N}function Fa(h,m,N){var F=h.F,M=[h.J];if(F!=null){var z=h.U,V=m.ba.S,Y=V==vl||V==yl;m=m.ba.f.RGBA;var K=[0],te=h.ka;K[0]=h.T,h.Kb&&(te==0?--K[0]:(--te,M[0]-=h.width),h.j+h.ka+h.T==h.o&&(K[0]=h.o-h.j-te));var pe=m.eb;te=m.fb+te*m.A,h=ir(F,M[0],h.width,z,K,pe,te+(Y?0:3),m.A),r(N==K),h&&Dt(V)&&qn(pe,te,Y,z,K,m.A)}return 0}function Lr(h){var m=h.ma,N=m.ba.S,F=11>N,M=N==gl||N==xl||N==vl||N==H0||N==12||Dt(N);if(m.memory=null,m.Ib=null,m.Jb=null,m.Nd=null,!eo(m.Oa,h,M?11:12))return 0;if(M&&Dt(N)&&ze(),h.da)alert("todo:use_scaling");else{if(F){if(m.Ib=wt,h.Kb){if(N=h.U+1>>1,m.memory=s(h.U+2*N),m.memory==null)return 0;m.ec=m.memory,m.fc=0,m.cc=m.ec,m.dc=m.fc+h.U,m.Mc=m.cc,m.Nc=m.dc+N,m.Ib=Mt,ze()}}else alert("todo:EmitYUV");M&&(m.Jb=Fa,F&&we())}if(F&&!kf){for(h=0;256>h;++h)D1[h]=89858*(h-128)+bl>>wl,B1[h]=-22014*(h-128)+bl,M1[h]=-45773*(h-128),R1[h]=113618*(h-128)+bl>>wl;for(h=co;h<$0;++h)m=76283*(h-16)+bl>>wl,U1[h-co]=Tn(m,255),H1[h-co]=Tn(m+8>>4,15);kf=1}return 1}function Bn(h){var m=h.ma,N=h.U,F=h.T;return r(!(1&h.ka)),0>=N||0>=F?0:(N=m.Ib(h,m),m.Jb!=null&&m.Jb(h,m,N),m.Dc+=N,1)}function Un(h){h.ma.memory=null}function dt(h,m,N,F){return ge(h,8)!=47?0:(m[0]=ge(h,14)+1,N[0]=ge(h,14)+1,F[0]=ge(h,1),ge(h,3)!=0?0:!h.h)}function jn(h,m){if(4>h)return h+1;var N=h-2>>1;return(2+(1&h)<<N)+ge(m,N)+1}function mn(h,m){return 120<m?m-120:1<=(N=((N=N1[m-1])>>4)*h+(8-(15&N)))?N:1;var N}function Jr(h,m,N){var F=O(N),M=h[m+=255&F].g-8;return 0<M&&(D(N,N.u+8),F=O(N),m+=h[m].value,m+=F&(1<<M)-1),D(N,N.u+h[m].g),h[m].value}function xr(h,m,N){return N.g+=h.g,N.value+=h.value<<m>>>0,r(8>=N.g),h.g}function fr(h,m,N){var F=h.xc;return r((m=F==0?0:h.vc[h.md*(N>>F)+(m>>F)])<h.Wb),h.Ya[m]}function q(h,m,N,F){var M=h.ab,z=h.c*m,V=h.C;m=V+m;var Y=N,K=F;for(F=h.Ta,N=h.Ua;0<M--;){var te=h.gc[M],pe=V,Se=m,Ae=Y,ye=K,Re=(K=F,Y=N,te.Ea);switch(r(pe<Se),r(Se<=te.nc),te.hc){case 2:cl(Ae,ye,(Se-pe)*Re,K,Y);break;case 0:var Ce=pe,me=Se,xe=K,Ie=Y,He=(tt=te).Ea;Ce==0&&(B0(Ae,ye,null,null,1,xe,Ie),At(Ae,ye+1,0,0,He-1,xe,Ie+1),ye+=He,Ie+=He,++Ce);for(var De=1<<tt.b,ot=De-1,Qe=it(He,tt.b),pt=tt.K,tt=tt.w+(Ce>>tt.b)*Qe;Ce<me;){var Ut=pt,qt=tt,Rt=1;for(no(Ae,ye,xe,Ie-He,1,xe,Ie);Rt<He;){var Lt=(Rt&~ot)+De;Lt>He&&(Lt=He),(0,Ja[Ut[qt++]>>8&15])(Ae,ye+ +Rt,xe,Ie+Rt-He,Lt-Rt,xe,Ie+Rt),Rt=Lt}ye+=He,Ie+=He,++Ce&ot||(tt+=Qe)}Se!=te.nc&&n(K,Y-Re,K,Y+(Se-pe-1)*Re,Re);break;case 1:for(Re=Ae,me=ye,He=(Ae=te.Ea)-(Ie=Ae&~(xe=(ye=1<<te.b)-1)),Ce=it(Ae,te.b),De=te.K,te=te.w+(pe>>te.b)*Ce;pe<Se;){for(ot=De,Qe=te,pt=new Ze,tt=me+Ie,Ut=me+Ae;me<tt;)Ct(ot[Qe++],pt),ki(pt,Re,me,ye,K,Y),me+=ye,Y+=ye;me<Ut&&(Ct(ot[Qe++],pt),ki(pt,Re,me,He,K,Y),me+=He,Y+=He),++pe&xe||(te+=Ce)}break;case 3:if(Ae==K&&ye==Y&&0<te.b){for(me=K,Ae=Re=Y+(Se-pe)*Re-(Ie=(Se-pe)*it(te.Ea,te.b)),ye=K,xe=Y,Ce=[],Ie=(He=Ie)-1;0<=Ie;--Ie)Ce[Ie]=ye[xe+Ie];for(Ie=He-1;0<=Ie;--Ie)me[Ae+Ie]=Ce[Ie];Hn(te,pe,Se,K,Re,K,Y)}else Hn(te,pe,Se,Ae,ye,K,Y)}Y=F,K=N}K!=N&&n(F,N,Y,K,z)}function ne(h,m){var N=h.V,F=h.Ba+h.c*h.C,M=m-h.C;if(r(m<=h.l.o),r(16>=M),0<M){var z=h.l,V=h.Ta,Y=h.Ua,K=z.width;if(q(h,M,N,F),M=Y=[Y],r((N=h.C)<(F=m)),r(z.v<z.va),F>z.o&&(F=z.o),N<z.j){var te=z.j-N;N=z.j,M[0]+=te*K}if(N>=F?N=0:(M[0]+=4*z.v,z.ka=N-z.j,z.U=z.va-z.v,z.T=F-N,N=1),N){if(Y=Y[0],11>(N=h.ca).S){var pe=N.f.RGBA,Se=(F=N.S,M=z.U,z=z.T,te=pe.eb,pe.A),Ae=z;for(pe=pe.fb+h.Ma*pe.A;0<Ae--;){var ye=V,Re=Y,Ce=M,me=te,xe=pe;switch(F){case ml:vn(ye,Re,Ce,me,xe);break;case gl:ln(ye,Re,Ce,me,xe);break;case W0:ln(ye,Re,Ce,me,xe),qn(me,xe,0,Ce,1,0);break;case vf:Ia(ye,Re,Ce,me,xe);break;case xl:nr(ye,Re,Ce,me,xe,1);break;case z0:nr(ye,Re,Ce,me,xe,1),qn(me,xe,0,Ce,1,0);break;case vl:nr(ye,Re,Ce,me,xe,0);break;case yl:nr(ye,Re,Ce,me,xe,0),qn(me,xe,1,Ce,1,0);break;case H0:Za(ye,Re,Ce,me,xe);break;case q0:Za(ye,Re,Ce,me,xe),ar(me,xe,Ce,1,0);break;case yf:Oa(ye,Re,Ce,me,xe);break;default:r(0)}Y+=K,pe+=Se}h.Ma+=z}else alert("todo:EmitRescaledRowsYUVA");r(h.Ma<=N.height)}}h.C=m,r(h.C<=h.i)}function Z(h){var m;if(0<h.ua)return 0;for(m=0;m<h.Wb;++m){var N=h.Ya[m].G,F=h.Ya[m].H;if(0<N[1][F[1]+0].g||0<N[2][F[2]+0].g||0<N[3][F[3]+0].g)return 0}return 1}function ee(h,m,N,F,M,z){if(h.Z!=0){var V=h.qd,Y=h.rd;for(r(ri[h.Z]!=null);m<N;++m)ri[h.Z](V,Y,F,M,F,M,z),V=F,Y=M,M+=z;h.qd=V,h.rd=Y}}function re(h,m){var N=h.l.ma,F=N.Z==0||N.Z==1?h.l.j:h.C;if(F=h.C<F?F:h.C,r(m<=h.l.o),m>F){var M=h.l.width,z=N.ca,V=N.tb+M*F,Y=h.V,K=h.Ba+h.c*F,te=h.gc;r(h.ab==1),r(te[0].hc==3),fl(te[0],F,m,Y,K,z,V),ee(N,F,m,z,V,M)}h.C=h.Ma=m}function ie(h,m,N,F,M,z,V){var Y=h.$/F,K=h.$%F,te=h.m,pe=h.s,Se=N+h.$,Ae=Se;M=N+F*M;var ye=N+F*z,Re=280+pe.ua,Ce=h.Pb?Y:16777216,me=0<pe.ua?pe.Wa:null,xe=pe.wc,Ie=Se<ye?fr(pe,K,Y):null;r(h.C<z),r(ye<=M);var He=!1;e:for(;;){for(;He||Se<ye;){var De=0;if(Y>=Ce){var ot=Se-N;r((Ce=h).Pb),Ce.wd=Ce.m,Ce.xd=ot,0<Ce.s.ua&&Ee(Ce.s.Wa,Ce.s.vb),Ce=Y+S1}if(K&xe||(Ie=fr(pe,K,Y)),r(Ie!=null),Ie.Qb&&(m[Se]=Ie.qb,He=!0),!He)if(X(te),Ie.jc){De=te,ot=m;var Qe=Se,pt=Ie.pd[O(De)&zr-1];r(Ie.jc),256>pt.g?(D(De,De.u+pt.g),ot[Qe]=pt.value,De=0):(D(De,De.u+pt.g-256),r(256<=pt.value),De=pt.value),De==0&&(He=!0)}else De=Jr(Ie.G[0],Ie.H[0],te);if(te.h)break;if(He||256>De){if(!He)if(Ie.nd)m[Se]=(Ie.qb|De<<8)>>>0;else{if(X(te),He=Jr(Ie.G[1],Ie.H[1],te),X(te),ot=Jr(Ie.G[2],Ie.H[2],te),Qe=Jr(Ie.G[3],Ie.H[3],te),te.h)break;m[Se]=(Qe<<24|He<<16|De<<8|ot)>>>0}if(He=!1,++Se,++K>=F&&(K=0,++Y,V!=null&&Y<=z&&!(Y%16)&&V(h,Y),me!=null))for(;Ae<Se;)De=m[Ae++],me.X[(506832829*De&4294967295)>>>me.Mb]=De}else if(280>De){if(De=jn(De-256,te),ot=Jr(Ie.G[4],Ie.H[4],te),X(te),ot=mn(F,ot=jn(ot,te)),te.h)break;if(Se-N<ot||M-Se<De)break e;for(Qe=0;Qe<De;++Qe)m[Se+Qe]=m[Se+Qe-ot];for(Se+=De,K+=De;K>=F;)K-=F,++Y,V!=null&&Y<=z&&!(Y%16)&&V(h,Y);if(r(Se<=M),K&xe&&(Ie=fr(pe,K,Y)),me!=null)for(;Ae<Se;)De=m[Ae++],me.X[(506832829*De&4294967295)>>>me.Mb]=De}else{if(!(De<Re))break e;for(He=De-280,r(me!=null);Ae<Se;)De=m[Ae++],me.X[(506832829*De&4294967295)>>>me.Mb]=De;De=Se,r(!(He>>>(ot=me).Xa)),m[De]=ot.X[He],He=!0}He||r(te.h==I(te))}if(h.Pb&&te.h&&Se<M)r(h.m.h),h.a=5,h.m=h.wd,h.$=h.xd,0<h.s.ua&&Ee(h.s.vb,h.s.Wa);else{if(te.h)break e;V!=null&&V(h,Y>z?z:Y),h.a=0,h.$=Se-N}return 1}return h.a=3,0}function _e(h){r(h!=null),h.vc=null,h.yc=null,h.Ya=null;var m=h.Wa;m!=null&&(m.X=null),h.vb=null,r(h!=null)}function Fe(){var h=new M0;return h==null?null:(h.a=0,h.xb=Nf,Mn("Predictor","VP8LPredictors"),Mn("Predictor","VP8LPredictors_C"),Mn("PredictorAdd","VP8LPredictorsAdd"),Mn("PredictorAdd","VP8LPredictorsAdd_C"),cl=Ft,ki=gt,vn=rt,ln=Cr,Za=Pt,Oa=pn,Ia=Wt,C.VP8LMapColor32b=fs,C.VP8LMapColor8b=hl,h)}function Ne(h,m,N,F,M){var z=1,V=[h],Y=[m],K=F.m,te=F.s,pe=null,Se=0;e:for(;;){if(N)for(;z&&ge(K,1);){var Ae=V,ye=Y,Re=F,Ce=1,me=Re.m,xe=Re.gc[Re.ab],Ie=ge(me,2);if(Re.Oc&1<<Ie)z=0;else{switch(Re.Oc|=1<<Ie,xe.hc=Ie,xe.Ea=Ae[0],xe.nc=ye[0],xe.K=[null],++Re.ab,r(4>=Re.ab),Ie){case 0:case 1:xe.b=ge(me,3)+2,Ce=Ne(it(xe.Ea,xe.b),it(xe.nc,xe.b),0,Re,xe.K),xe.K=xe.K[0];break;case 3:var He,De=ge(me,8)+1,ot=16<De?0:4<De?1:2<De?2:3;if(Ae[0]=it(xe.Ea,ot),xe.b=ot,He=Ce=Ne(De,1,0,Re,xe.K)){var Qe,pt=De,tt=xe,Ut=1<<(8>>tt.b),qt=s(Ut);if(qt==null)He=0;else{var Rt=tt.K[0],Lt=tt.w;for(qt[0]=tt.K[0][0],Qe=1;Qe<1*pt;++Qe)qt[Qe]=We(Rt[Lt+Qe],qt[Qe-1]);for(;Qe<4*Ut;++Qe)qt[Qe]=0;tt.K[0]=null,tt.K[0]=qt,He=1}}Ce=He;break;case 2:break;default:r(0)}z=Ce}}if(V=V[0],Y=Y[0],z&&ge(K,1)&&!(z=1<=(Se=ge(K,4))&&11>=Se)){F.a=3;break e}var er;if(er=z)t:{var Jt,jt,jr,yn=F,kr=V,wn=Y,Vt=Se,Fn=N,Cn=yn.m,Mr=yn.s,qr=[null],fn=1,$n=0,Na=_1[Vt];r:for(;;){if(Fn&&ge(Cn,1)){var Br=ge(Cn,3)+2,Ba=it(kr,Br),Li=it(wn,Br),ms=Ba*Li;if(!Ne(Ba,Li,0,yn,qr))break r;for(qr=qr[0],Mr.xc=Br,Jt=0;Jt<ms;++Jt){var ni=qr[Jt]>>8&65535;qr[Jt]=ni,ni>=fn&&(fn=ni+1)}}if(Cn.h)break r;for(jt=0;5>jt;++jt){var ur=wf[jt];!jt&&0<Vt&&(ur+=1<<Vt),$n<ur&&($n=ur)}var Y0=l(fn*Na,T),Ff=fn,Cf=l(Ff,G);if(Cf==null)var _l=null;else r(65536>=Ff),_l=Cf;var fo=s($n);if(_l==null||fo==null||Y0==null){yn.a=1;break r}var Sl=Y0;for(Jt=jr=0;Jt<fn;++Jt){var ia=_l[Jt],gs=ia.G,xs=ia.H,Lf=0,Al=1,Pf=0;for(jt=0;5>jt;++jt){ur=wf[jt],gs[jt]=Sl,xs[jt]=jr,!jt&&0<Vt&&(ur+=1<<Vt);a:{var jl,X0=ur,kl=yn,ho=fo,q1=Sl,V1=jr,K0=0,ai=kl.m,G1=ge(ai,1);if(a(ho,0,0,X0),G1){var $1=ge(ai,1)+1,Y1=ge(ai,1),Of=ge(ai,Y1==0?1:8);ho[Of]=1,$1==2&&(ho[Of=ge(ai,8)]=1);var Tl=1}else{var If=s(19),Df=ge(ai,4)+4;if(19<Df){kl.a=3;var El=0;break a}for(jl=0;jl<Df;++jl)If[b1[jl]]=ge(ai,3);var J0=void 0,uo=void 0,Rf=kl,X1=If,Fl=X0,Mf=ho,Z0=0,ii=Rf.m,Bf=8,Uf=l(128,T);n:for(;k(Uf,0,7,X1,19);){if(ge(ii,1)){var K1=2+2*ge(ii,3);if((J0=2+ge(ii,K1))>Fl)break n}else J0=Fl;for(uo=0;uo<Fl&&J0--;){X(ii);var Hf=Uf[0+(127&O(ii))];D(ii,ii.u+Hf.g);var vs=Hf.value;if(16>vs)Mf[uo++]=vs,vs!=0&&(Bf=vs);else{var J1=vs==16,Wf=vs-16,Z1=y1[Wf],zf=ge(ii,v1[Wf])+Z1;if(uo+zf>Fl)break n;for(var Q1=J1?Bf:0;0<zf--;)Mf[uo++]=Q1}}Z0=1;break n}Z0||(Rf.a=3),Tl=Z0}(Tl=Tl&&!ai.h)&&(K0=k(q1,V1,8,ho,X0)),Tl&&K0!=0?El=K0:(kl.a=3,El=0)}if(El==0)break r;if(Al&&w1[jt]==1&&(Al=Sl[jr].g==0),Lf+=Sl[jr].g,jr+=El,3>=jt){var po,Q0=fo[0];for(po=1;po<ur;++po)fo[po]>Q0&&(Q0=fo[po]);Pf+=Q0}}if(ia.nd=Al,ia.Qb=0,Al&&(ia.qb=(gs[3][xs[3]+0].value<<24|gs[1][xs[1]+0].value<<16|gs[2][xs[2]+0].value)>>>0,Lf==0&&256>gs[0][xs[0]+0].value&&(ia.Qb=1,ia.qb+=gs[0][xs[0]+0].value<<8)),ia.jc=!ia.Qb&&6>Pf,ia.jc){var Cl,Ua=ia;for(Cl=0;Cl<zr;++Cl){var si=Cl,oi=Ua.pd[si],Ll=Ua.G[0][Ua.H[0]+si];256<=Ll.value?(oi.g=Ll.g+256,oi.value=Ll.value):(oi.g=0,oi.value=0,si>>=xr(Ll,8,oi),si>>=xr(Ua.G[1][Ua.H[1]+si],16,oi),si>>=xr(Ua.G[2][Ua.H[2]+si],0,oi),xr(Ua.G[3][Ua.H[3]+si],24,oi))}}}Mr.vc=qr,Mr.Wb=fn,Mr.Ya=_l,Mr.yc=Y0,er=1;break t}er=0}if(!(z=er)){F.a=3;break e}if(0<Se){if(te.ua=1<<Se,!Je(te.Wa,Se)){F.a=1,z=0;break e}}else te.ua=0;var ec=F,qf=V,e2=Y,tc=ec.s,rc=tc.xc;if(ec.c=qf,ec.i=e2,tc.md=it(qf,rc),tc.wc=rc==0?-1:(1<<rc)-1,N){F.xb=C1;break e}if((pe=s(V*Y))==null){F.a=1,z=0;break e}z=(z=ie(F,pe,0,V,Y,Y,null))&&!K.h;break e}return z?(M!=null?M[0]=pe:(r(pe==null),r(N)),F.$=0,N||_e(te)):_e(te),z}function je(h,m){var N=h.c*h.i,F=N+m+16*m;return r(h.c<=m),h.V=s(F),h.V==null?(h.Ta=null,h.Ua=0,h.a=1,0):(h.Ta=h.V,h.Ua=h.Ba+N+m,1)}function ke(h,m){var N=h.C,F=m-N,M=h.V,z=h.Ba+h.c*N;for(r(m<=h.l.o);0<F;){var V=16<F?16:F,Y=h.l.ma,K=h.l.width,te=K*V,pe=Y.ca,Se=Y.tb+K*N,Ae=h.Ta,ye=h.Ua;q(h,V,M,z),wr(Ae,ye,pe,Se,te),ee(Y,N,N+V,pe,Se,K),F-=V,M+=V*h.c,N+=V}r(N==m),h.C=h.Ma=m}function qe(){this.ub=this.yd=this.td=this.Rb=0}function Ye(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function at(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Ge(){this.Yb=function(){var h=[];return function m(N,F,M){for(var z=M[F],V=0;V<z&&(N.push(M.length>F+1?[]:0),!(M.length<F+1));V++)m(N[V],F+1,M)}(h,0,[3,11]),h}()}function nt(){this.jb=s(3),this.Wc=c([4,8],Ge),this.Xc=c([4,17],Ge)}function vt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function zt(){this.ld=this.La=this.dd=this.tc=0}function Kt(){this.Na=this.la=0}function Sr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Qn(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ca(){this.uc=this.M=this.Nb=0,this.wa=Array(new zt),this.Y=0,this.ya=Array(new Qn),this.aa=0,this.l=new va}function xa(){this.y=s(16),this.f=s(8),this.ea=s(8)}function ea(){this.cb=this.a=0,this.sc="",this.m=new ve,this.Od=new qe,this.Kc=new Ye,this.ed=new vt,this.Qa=new at,this.Ic=this.$c=this.Aa=0,this.D=new Ca,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=l(8,ve),this.ia=0,this.pb=l(4,Sr),this.Pa=new nt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new xa),this.Hd=0,this.rb=Array(new Kt),this.sb=0,this.wa=Array(new zt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Qn),this.L=this.aa=0,this.gd=c([4,2],zt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function va(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function kn(){var h=new ea;return h!=null&&(h.a=0,h.sc="OK",h.cb=0,h.Xb=0,lo||(lo=Yo)),h}function vr(h,m,N){return h.a==0&&(h.a=m,h.sc=N,h.cb=0),0}function Go(h,m,N){return 3<=N&&h[m+0]==157&&h[m+1]==1&&h[m+2]==42}function $o(h,m){if(h==null)return 0;if(h.a=0,h.sc="OK",m==null)return vr(h,2,"null VP8Io passed to VP8GetHeaders()");var N=m.data,F=m.w,M=m.ha;if(4>M)return vr(h,7,"Truncated header.");var z=N[F+0]|N[F+1]<<8|N[F+2]<<16,V=h.Od;if(V.Rb=!(1&z),V.td=z>>1&7,V.yd=z>>4&1,V.ub=z>>5,3<V.td)return vr(h,3,"Incorrect keyframe parameters.");if(!V.yd)return vr(h,4,"Frame not displayable.");F+=3,M-=3;var Y=h.Kc;if(V.Rb){if(7>M)return vr(h,7,"cannot parse picture header");if(!Go(N,F,M))return vr(h,3,"Bad code word");Y.c=16383&(N[F+4]<<8|N[F+3]),Y.Td=N[F+4]>>6,Y.i=16383&(N[F+6]<<8|N[F+5]),Y.Ud=N[F+6]>>6,F+=7,M-=7,h.za=Y.c+15>>4,h.Ub=Y.i+15>>4,m.width=Y.c,m.height=Y.i,m.Da=0,m.j=0,m.v=0,m.va=m.width,m.o=m.height,m.da=0,m.ib=m.width,m.hb=m.height,m.U=m.width,m.T=m.height,a((z=h.Pa).jb,0,255,z.jb.length),r((z=h.Qa)!=null),z.Cb=0,z.Bb=0,z.Fb=1,a(z.Zb,0,0,z.Zb.length),a(z.Lb,0,0,z.Lb)}if(V.ub>M)return vr(h,7,"bad partition length");ce(z=h.m,N,F,V.ub),F+=V.ub,M-=V.ub,V.Rb&&(Y.Ld=he(z),Y.Kd=he(z)),Y=h.Qa;var K,te=h.Pa;if(r(z!=null),r(Y!=null),Y.Cb=he(z),Y.Cb){if(Y.Bb=he(z),he(z)){for(Y.Fb=he(z),K=0;4>K;++K)Y.Zb[K]=he(z)?Q(z,7):0;for(K=0;4>K;++K)Y.Lb[K]=he(z)?Q(z,6):0}if(Y.Bb)for(K=0;3>K;++K)te.jb[K]=he(z)?J(z,8):255}else Y.Bb=0;if(z.Ka)return vr(h,3,"cannot parse segment header");if((Y=h.ed).zd=he(z),Y.Tb=J(z,6),Y.wb=J(z,3),Y.Pc=he(z),Y.Pc&&he(z)){for(te=0;4>te;++te)he(z)&&(Y.vd[te]=Q(z,6));for(te=0;4>te;++te)he(z)&&(Y.od[te]=Q(z,6))}if(h.L=Y.Tb==0?0:Y.zd?1:2,z.Ka)return vr(h,3,"cannot parse filter header");var pe=M;if(M=K=F,F=K+pe,Y=pe,h.Xb=(1<<J(h.m,2))-1,pe<3*(te=h.Xb))N=7;else{for(K+=3*te,Y-=3*te,pe=0;pe<te;++pe){var Se=N[M+0]|N[M+1]<<8|N[M+2]<<16;Se>Y&&(Se=Y),ce(h.Jc[+pe],N,K,Se),K+=Se,Y-=Se,M+=3}ce(h.Jc[+te],N,K,Y),N=K<F?0:5}if(N!=0)return vr(h,N,"cannot parse partitions");for(N=J(K=h.m,7),M=he(K)?Q(K,4):0,F=he(K)?Q(K,4):0,Y=he(K)?Q(K,4):0,te=he(K)?Q(K,4):0,K=he(K)?Q(K,4):0,pe=h.Qa,Se=0;4>Se;++Se){if(pe.Cb){var Ae=pe.Zb[Se];pe.Fb||(Ae+=N)}else{if(0<Se){h.pb[Se]=h.pb[0];continue}Ae=N}var ye=h.pb[Se];ye.Sc[0]=V0[Tn(Ae+M,127)],ye.Sc[1]=G0[Tn(Ae+0,127)],ye.Eb[0]=2*V0[Tn(Ae+F,127)],ye.Eb[1]=101581*G0[Tn(Ae+Y,127)]>>16,8>ye.Eb[1]&&(ye.Eb[1]=8),ye.Qc[0]=V0[Tn(Ae+te,117)],ye.Qc[1]=G0[Tn(Ae+K,127)],ye.lc=Ae+K}if(!V.Rb)return vr(h,4,"Not a key frame.");for(he(z),V=h.Pa,N=0;4>N;++N){for(M=0;8>M;++M)for(F=0;3>F;++F)for(Y=0;11>Y;++Y)te=ue(z,E1[N][M][F][Y])?J(z,8):k1[N][M][F][Y],V.Wc[N][M].Yb[F][Y]=te;for(M=0;17>M;++M)V.Xc[N][M]=V.Wc[N][F1[M]]}return h.kc=he(z),h.kc&&(h.Bd=J(z,8)),h.cb=1}function Yo(h,m,N,F,M,z,V){var Y=m[M].Yb[N];for(N=0;16>M;++M){if(!ue(h,Y[N+0]))return M;for(;!ue(h,Y[N+1]);)if(Y=m[++M].Yb[0],N=0,M==16)return 16;var K=m[M+1].Yb;if(ue(h,Y[N+2])){var te=h,pe=0;if(ue(te,(Ae=Y)[(Se=N)+3]))if(ue(te,Ae[Se+6])){for(Y=0,Se=2*(pe=ue(te,Ae[Se+8]))+(Ae=ue(te,Ae[Se+9+pe])),pe=0,Ae=A1[Se];Ae[Y];++Y)pe+=pe+ue(te,Ae[Y]);pe+=3+(8<<Se)}else ue(te,Ae[Se+7])?(pe=7+2*ue(te,165),pe+=ue(te,145)):pe=5+ue(te,159);else pe=ue(te,Ae[Se+4])?3+ue(te,Ae[Se+5]):2;Y=K[2]}else pe=1,Y=K[1];K=V+j1[M],0>(te=h).b&&fe(te);var Se,Ae=te.b,ye=(Se=te.Ca>>1)-(te.I>>Ae)>>31;--te.b,te.Ca+=ye,te.Ca|=1,te.I-=(Se+1&ye)<<Ae,z[K]=((pe^ye)-ye)*F[(0<M)+0]}return 16}function Bs(h){var m=h.rb[h.sb-1];m.la=0,m.Na=0,a(h.zc,0,0,h.zc.length),h.ja=0}function b0(h,m){if(h==null)return 0;if(m==null)return vr(h,2,"NULL VP8Io parameter in VP8Decode().");if(!h.cb&&!$o(h,m))return 0;if(r(h.cb),m.ac==null||m.ac(m)){m.ob&&(h.L=0);var N=Nl[h.L];if(h.L==2?(h.yb=0,h.zb=0):(h.yb=m.v-N>>4,h.zb=m.j-N>>4,0>h.yb&&(h.yb=0),0>h.zb&&(h.zb=0)),h.Va=m.o+15+N>>4,h.Hb=m.va+15+N>>4,h.Hb>h.za&&(h.Hb=h.za),h.Va>h.Ub&&(h.Va=h.Ub),0<h.L){var F=h.ed;for(N=0;4>N;++N){var M;if(h.Qa.Cb){var z=h.Qa.Lb[N];h.Qa.Fb||(z+=F.Tb)}else z=F.Tb;for(M=0;1>=M;++M){var V=h.gd[N][M],Y=z;if(F.Pc&&(Y+=F.vd[0],M&&(Y+=F.od[0])),0<(Y=0>Y?0:63<Y?63:Y)){var K=Y;0<F.wb&&(K=4<F.wb?K>>2:K>>1)>9-F.wb&&(K=9-F.wb),1>K&&(K=1),V.dd=K,V.tc=2*Y+K,V.ld=40<=Y?2:15<=Y?1:0}else V.tc=0;V.La=M}}}N=0}else vr(h,6,"Frame setup failed"),N=h.a;if(N=N==0){if(N){h.$c=0,0<h.Aa||(h.Ic=z1);e:{N=h.Ic,F=4*(K=h.za);var te=32*K,pe=K+1,Se=0<h.L?K*(0<h.Aa?2:1):0,Ae=(h.Aa==2?2:1)*K;if((V=F+832+(M=3*(16*N+Nl[h.L])/2*te)+(z=h.Fa!=null&&0<h.Fa.length?h.Kc.c*h.Kc.i:0))!=V)N=0;else{if(V>h.Vb){if(h.Vb=0,h.Ec=s(V),h.Fc=0,h.Ec==null){N=vr(h,1,"no memory during frame initialization.");break e}h.Vb=V}V=h.Ec,Y=h.Fc,h.Ac=V,h.Bc=Y,Y+=F,h.Gd=l(te,xa),h.Hd=0,h.rb=l(pe+1,Kt),h.sb=1,h.wa=Se?l(Se,zt):null,h.Y=0,h.D.Nb=0,h.D.wa=h.wa,h.D.Y=h.Y,0<h.Aa&&(h.D.Y+=K),r(!0),h.oc=V,h.pc=Y,Y+=832,h.ya=l(Ae,Qn),h.aa=0,h.D.ya=h.ya,h.D.aa=h.aa,h.Aa==2&&(h.D.aa+=K),h.R=16*K,h.B=8*K,K=(te=Nl[h.L])*h.R,te=te/2*h.B,h.sa=V,h.ta=Y+K,h.qa=h.sa,h.ra=h.ta+16*N*h.R+te,h.Ha=h.qa,h.Ia=h.ra+8*N*h.B+te,h.$c=0,Y+=M,h.mb=z?V:null,h.nb=z?Y:null,r(Y+z<=h.Fc+h.Vb),Bs(h),a(h.Ac,h.Bc,0,F),N=1}}if(N){if(m.ka=0,m.y=h.sa,m.O=h.ta,m.f=h.qa,m.N=h.ra,m.ea=h.Ha,m.Vd=h.Ia,m.fa=h.R,m.Rc=h.B,m.F=null,m.J=0,!dl){for(N=-255;255>=N;++N)Pr[255+N]=0>N?-N:N;for(N=-1020;1020>=N;++N)Ra[1020+N]=-128>N?-128:127<N?127:N;for(N=-112;112>=N;++N)oo[112+N]=-16>N?-16:15<N?15:N;for(N=-255;510>=N;++N)ps[255+N]=0>N?0:255<N?255:N;dl=1}hs=S0,Da=N0,ao=Ko,cn=_0,Wn=Jo,yr=Xo,us=Vs,ul=Ai,io=R0,Ti=Gs,Ei=D0,Qa=rs,Fi=$s,ds=sl,Ci=il,ei=wa,so=Pa,zn=I0,aa[0]=ya,aa[1]=A0,aa[2]=E0,aa[3]=F0,aa[4]=el,aa[5]=es,aa[6]=tl,aa[7]=Ws,aa[8]=L0,aa[9]=C0,ti[0]=Zo,ti[1]=k0,ti[2]=La,ti[3]=Zi,ti[4]=Zr,ti[5]=T0,ti[6]=Qo,Ma[0]=Ya,Ma[1]=j0,Ma[2]=P0,Ma[3]=zs,Ma[4]=Si,Ma[5]=O0,Ma[6]=qs,N=1}else N=0}N&&(N=function(ye,Re){for(ye.M=0;ye.M<ye.Va;++ye.M){var Ce,me=ye.Jc[ye.M&ye.Xb],xe=ye.m,Ie=ye;for(Ce=0;Ce<Ie.za;++Ce){var He=xe,De=Ie,ot=De.Ac,Qe=De.Bc+4*Ce,pt=De.zc,tt=De.ya[De.aa+Ce];if(De.Qa.Bb?tt.$b=ue(He,De.Pa.jb[0])?2+ue(He,De.Pa.jb[2]):ue(He,De.Pa.jb[1]):tt.$b=0,De.kc&&(tt.Ad=ue(He,De.Bd)),tt.Za=!ue(He,145)+0,tt.Za){var Ut=tt.Ob,qt=0;for(De=0;4>De;++De){var Rt,Lt=pt[0+De];for(Rt=0;4>Rt;++Rt){Lt=T1[ot[Qe+Rt]][Lt];for(var er=bf[ue(He,Lt[0])];0<er;)er=bf[2*er+ue(He,Lt[er])];Lt=-er,ot[Qe+Rt]=Lt}n(Ut,qt,ot,Qe,4),qt+=4,pt[0+De]=Lt}}else Lt=ue(He,156)?ue(He,128)?1:3:ue(He,163)?2:0,tt.Ob[0]=Lt,a(ot,Qe,Lt,4),a(pt,0,Lt,4);tt.Dd=ue(He,142)?ue(He,114)?ue(He,183)?1:3:2:0}if(Ie.m.Ka)return vr(ye,7,"Premature end-of-partition0 encountered.");for(;ye.ja<ye.za;++ye.ja){if(Ie=me,He=(xe=ye).rb[xe.sb-1],ot=xe.rb[xe.sb+xe.ja],Ce=xe.ya[xe.aa+xe.ja],Qe=xe.kc?Ce.Ad:0)He.la=ot.la=0,Ce.Za||(He.Na=ot.Na=0),Ce.Hc=0,Ce.Gc=0,Ce.ia=0;else{var Jt,jt;if(He=ot,ot=Ie,Qe=xe.Pa.Xc,pt=xe.ya[xe.aa+xe.ja],tt=xe.pb[pt.$b],De=pt.ad,Ut=0,qt=xe.rb[xe.sb-1],Lt=Rt=0,a(De,Ut,0,384),pt.Za)var jr=0,yn=Qe[3];else{er=s(16);var kr=He.Na+qt.Na;if(kr=lo(ot,Qe[1],kr,tt.Eb,0,er,0),He.Na=qt.Na=(0<kr)+0,1<kr)hs(er,0,De,Ut);else{var wn=er[0]+3>>3;for(er=0;256>er;er+=16)De[Ut+er]=wn}jr=1,yn=Qe[0]}var Vt=15&He.la,Fn=15&qt.la;for(er=0;4>er;++er){var Cn=1&Fn;for(wn=jt=0;4>wn;++wn)Vt=Vt>>1|(Cn=(kr=lo(ot,yn,kr=Cn+(1&Vt),tt.Sc,jr,De,Ut))>jr)<<7,jt=jt<<2|(3<kr?3:1<kr?2:De[Ut+0]!=0),Ut+=16;Vt>>=4,Fn=Fn>>1|Cn<<7,Rt=(Rt<<8|jt)>>>0}for(yn=Vt,jr=Fn>>4,Jt=0;4>Jt;Jt+=2){for(jt=0,Vt=He.la>>4+Jt,Fn=qt.la>>4+Jt,er=0;2>er;++er){for(Cn=1&Fn,wn=0;2>wn;++wn)kr=Cn+(1&Vt),Vt=Vt>>1|(Cn=0<(kr=lo(ot,Qe[2],kr,tt.Qc,0,De,Ut)))<<3,jt=jt<<2|(3<kr?3:1<kr?2:De[Ut+0]!=0),Ut+=16;Vt>>=2,Fn=Fn>>1|Cn<<5}Lt|=jt<<4*Jt,yn|=Vt<<4<<Jt,jr|=(240&Fn)<<Jt}He.la=yn,qt.la=jr,pt.Hc=Rt,pt.Gc=Lt,pt.ia=43690&Lt?0:tt.ia,Qe=!(Rt|Lt)}if(0<xe.L&&(xe.wa[xe.Y+xe.ja]=xe.gd[Ce.$b][Ce.Za],xe.wa[xe.Y+xe.ja].La|=!Qe),Ie.Ka)return vr(ye,7,"Premature end-of-file encountered.")}if(Bs(ye),xe=Re,Ie=1,Ce=(me=ye).D,He=0<me.L&&me.M>=me.zb&&me.M<=me.Va,me.Aa==0)e:{if(Ce.M=me.M,Ce.uc=He,Qs(me,Ce),Ie=1,Ce=(jt=me.D).Nb,He=(Lt=Nl[me.L])*me.R,ot=Lt/2*me.B,er=16*Ce*me.R,wn=8*Ce*me.B,Qe=me.sa,pt=me.ta-He+er,tt=me.qa,De=me.ra-ot+wn,Ut=me.Ha,qt=me.Ia-ot+wn,Fn=(Vt=jt.M)==0,Rt=Vt>=me.Va-1,me.Aa==2&&Qs(me,jt),jt.uc)for(Cn=(kr=me).D.M,r(kr.D.uc),jt=kr.yb;jt<kr.Hb;++jt){jr=jt,yn=Cn;var Mr=(qr=(ur=kr).D).Nb;Jt=ur.R;var qr=qr.wa[qr.Y+jr],fn=ur.sa,$n=ur.ta+16*Mr*Jt+16*jr,Na=qr.dd,Br=qr.tc;if(Br!=0)if(r(3<=Br),ur.L==1)0<jr&&ei(fn,$n,Jt,Br+4),qr.La&&zn(fn,$n,Jt,Br),0<yn&&Ci(fn,$n,Jt,Br+4),qr.La&&so(fn,$n,Jt,Br);else{var Ba=ur.B,Li=ur.qa,ms=ur.ra+8*Mr*Ba+8*jr,ni=ur.Ha,ur=ur.Ia+8*Mr*Ba+8*jr;Mr=qr.ld,0<jr&&(ul(fn,$n,Jt,Br+4,Na,Mr),Ti(Li,ms,ni,ur,Ba,Br+4,Na,Mr)),qr.La&&(Qa(fn,$n,Jt,Br,Na,Mr),ds(Li,ms,ni,ur,Ba,Br,Na,Mr)),0<yn&&(us(fn,$n,Jt,Br+4,Na,Mr),io(Li,ms,ni,ur,Ba,Br+4,Na,Mr)),qr.La&&(Ei(fn,$n,Jt,Br,Na,Mr),Fi(Li,ms,ni,ur,Ba,Br,Na,Mr))}}if(me.ia&&alert("todo:DitherRow"),xe.put!=null){if(jt=16*Vt,Vt=16*(Vt+1),Fn?(xe.y=me.sa,xe.O=me.ta+er,xe.f=me.qa,xe.N=me.ra+wn,xe.ea=me.Ha,xe.W=me.Ia+wn):(jt-=Lt,xe.y=Qe,xe.O=pt,xe.f=tt,xe.N=De,xe.ea=Ut,xe.W=qt),Rt||(Vt-=Lt),Vt>xe.o&&(Vt=xe.o),xe.F=null,xe.J=null,me.Fa!=null&&0<me.Fa.length&&jt<Vt&&(xe.J=Js(me,xe,jt,Vt-jt),xe.F=me.mb,xe.F==null&&xe.F.length==0)){Ie=vr(me,3,"Could not decode alpha data.");break e}jt<xe.j&&(Lt=xe.j-jt,jt=xe.j,r(!(1&Lt)),xe.O+=me.R*Lt,xe.N+=me.B*(Lt>>1),xe.W+=me.B*(Lt>>1),xe.F!=null&&(xe.J+=xe.width*Lt)),jt<Vt&&(xe.O+=xe.v,xe.N+=xe.v>>1,xe.W+=xe.v>>1,xe.F!=null&&(xe.J+=xe.v),xe.ka=jt-xe.j,xe.U=xe.va-xe.v,xe.T=Vt-jt,Ie=xe.put(xe))}Ce+1!=me.Ic||Rt||(n(me.sa,me.ta-He,Qe,pt+16*me.R,He),n(me.qa,me.ra-ot,tt,De+8*me.B,ot),n(me.Ha,me.Ia-ot,Ut,qt+8*me.B,ot))}if(!Ie)return vr(ye,6,"Output aborted.")}return 1}(h,m)),m.bc!=null&&m.bc(m),N&=1}return N?(h.cb=0,N):0}function ta(h,m,N,F,M){M=h[m+N+32*F]+(M>>3),h[m+N+32*F]=-256&M?0>M?0:255:M}function Ji(h,m,N,F,M,z){ta(h,m,0,N,F+M),ta(h,m,1,N,F+z),ta(h,m,2,N,F-z),ta(h,m,3,N,F-M)}function gn(h){return(20091*h>>16)+h}function Us(h,m,N,F){var M,z=0,V=s(16);for(M=0;4>M;++M){var Y=h[m+0]+h[m+8],K=h[m+0]-h[m+8],te=(35468*h[m+4]>>16)-gn(h[m+12]),pe=gn(h[m+4])+(35468*h[m+12]>>16);V[z+0]=Y+pe,V[z+1]=K+te,V[z+2]=K-te,V[z+3]=Y-pe,z+=4,m++}for(M=z=0;4>M;++M)Y=(h=V[z+0]+4)+V[z+8],K=h-V[z+8],te=(35468*V[z+4]>>16)-gn(V[z+12]),ta(N,F,0,0,Y+(pe=gn(V[z+4])+(35468*V[z+12]>>16))),ta(N,F,1,0,K+te),ta(N,F,2,0,K-te),ta(N,F,3,0,Y-pe),z++,F+=32}function Xo(h,m,N,F){var M=h[m+0]+4,z=35468*h[m+4]>>16,V=gn(h[m+4]),Y=35468*h[m+1]>>16;Ji(N,F,0,M+V,h=gn(h[m+1]),Y),Ji(N,F,1,M+z,h,Y),Ji(N,F,2,M-z,h,Y),Ji(N,F,3,M-V,h,Y)}function N0(h,m,N,F,M){Us(h,m,N,F),M&&Us(h,m+16,N,F+4)}function Ko(h,m,N,F){Da(h,m+0,N,F,1),Da(h,m+32,N,F+128,1)}function _0(h,m,N,F){var M;for(h=h[m+0]+4,M=0;4>M;++M)for(m=0;4>m;++m)ta(N,F,m,M,h)}function Jo(h,m,N,F){h[m+0]&&cn(h,m+0,N,F),h[m+16]&&cn(h,m+16,N,F+4),h[m+32]&&cn(h,m+32,N,F+128),h[m+48]&&cn(h,m+48,N,F+128+4)}function S0(h,m,N,F){var M,z=s(16);for(M=0;4>M;++M){var V=h[m+0+M]+h[m+12+M],Y=h[m+4+M]+h[m+8+M],K=h[m+4+M]-h[m+8+M],te=h[m+0+M]-h[m+12+M];z[0+M]=V+Y,z[8+M]=V-Y,z[4+M]=te+K,z[12+M]=te-K}for(M=0;4>M;++M)V=(h=z[0+4*M]+3)+z[3+4*M],Y=z[1+4*M]+z[2+4*M],K=z[1+4*M]-z[2+4*M],te=h-z[3+4*M],N[F+0]=V+Y>>3,N[F+16]=te+K>>3,N[F+32]=V-Y>>3,N[F+48]=te-K>>3,F+=64}function Hs(h,m,N){var F,M=m-32,z=En,V=255-h[M-1];for(F=0;F<N;++F){var Y,K=z,te=V+h[m-1];for(Y=0;Y<N;++Y)h[m+Y]=K[te+h[M+Y]];m+=32}}function A0(h,m){Hs(h,m,4)}function j0(h,m){Hs(h,m,8)}function k0(h,m){Hs(h,m,16)}function La(h,m){var N;for(N=0;16>N;++N)n(h,m+32*N,h,m-32,16)}function Zi(h,m){var N;for(N=16;0<N;--N)a(h,m,h[m-1],16),m+=32}function Qi(h,m,N){var F;for(F=0;16>F;++F)a(m,N+32*F,h,16)}function Zo(h,m){var N,F=16;for(N=0;16>N;++N)F+=h[m-1+32*N]+h[m+N-32];Qi(F>>5,h,m)}function Zr(h,m){var N,F=8;for(N=0;16>N;++N)F+=h[m-1+32*N];Qi(F>>4,h,m)}function T0(h,m){var N,F=8;for(N=0;16>N;++N)F+=h[m+N-32];Qi(F>>4,h,m)}function Qo(h,m){Qi(128,h,m)}function bt(h,m,N){return h+2*m+N+2>>2}function E0(h,m){var N,F=m-32;for(F=new Uint8Array([bt(h[F-1],h[F+0],h[F+1]),bt(h[F+0],h[F+1],h[F+2]),bt(h[F+1],h[F+2],h[F+3]),bt(h[F+2],h[F+3],h[F+4])]),N=0;4>N;++N)n(h,m+32*N,F,0,F.length)}function F0(h,m){var N=h[m-1],F=h[m-1+32],M=h[m-1+64],z=h[m-1+96];be(h,m+0,16843009*bt(h[m-1-32],N,F)),be(h,m+32,16843009*bt(N,F,M)),be(h,m+64,16843009*bt(F,M,z)),be(h,m+96,16843009*bt(M,z,z))}function ya(h,m){var N,F=4;for(N=0;4>N;++N)F+=h[m+N-32]+h[m-1+32*N];for(F>>=3,N=0;4>N;++N)a(h,m+32*N,F,4)}function el(h,m){var N=h[m-1+0],F=h[m-1+32],M=h[m-1+64],z=h[m-1-32],V=h[m+0-32],Y=h[m+1-32],K=h[m+2-32],te=h[m+3-32];h[m+0+96]=bt(F,M,h[m-1+96]),h[m+1+96]=h[m+0+64]=bt(N,F,M),h[m+2+96]=h[m+1+64]=h[m+0+32]=bt(z,N,F),h[m+3+96]=h[m+2+64]=h[m+1+32]=h[m+0+0]=bt(V,z,N),h[m+3+64]=h[m+2+32]=h[m+1+0]=bt(Y,V,z),h[m+3+32]=h[m+2+0]=bt(K,Y,V),h[m+3+0]=bt(te,K,Y)}function tl(h,m){var N=h[m+1-32],F=h[m+2-32],M=h[m+3-32],z=h[m+4-32],V=h[m+5-32],Y=h[m+6-32],K=h[m+7-32];h[m+0+0]=bt(h[m+0-32],N,F),h[m+1+0]=h[m+0+32]=bt(N,F,M),h[m+2+0]=h[m+1+32]=h[m+0+64]=bt(F,M,z),h[m+3+0]=h[m+2+32]=h[m+1+64]=h[m+0+96]=bt(M,z,V),h[m+3+32]=h[m+2+64]=h[m+1+96]=bt(z,V,Y),h[m+3+64]=h[m+2+96]=bt(V,Y,K),h[m+3+96]=bt(Y,K,K)}function es(h,m){var N=h[m-1+0],F=h[m-1+32],M=h[m-1+64],z=h[m-1-32],V=h[m+0-32],Y=h[m+1-32],K=h[m+2-32],te=h[m+3-32];h[m+0+0]=h[m+1+64]=z+V+1>>1,h[m+1+0]=h[m+2+64]=V+Y+1>>1,h[m+2+0]=h[m+3+64]=Y+K+1>>1,h[m+3+0]=K+te+1>>1,h[m+0+96]=bt(M,F,N),h[m+0+64]=bt(F,N,z),h[m+0+32]=h[m+1+96]=bt(N,z,V),h[m+1+32]=h[m+2+96]=bt(z,V,Y),h[m+2+32]=h[m+3+96]=bt(V,Y,K),h[m+3+32]=bt(Y,K,te)}function Ws(h,m){var N=h[m+0-32],F=h[m+1-32],M=h[m+2-32],z=h[m+3-32],V=h[m+4-32],Y=h[m+5-32],K=h[m+6-32],te=h[m+7-32];h[m+0+0]=N+F+1>>1,h[m+1+0]=h[m+0+64]=F+M+1>>1,h[m+2+0]=h[m+1+64]=M+z+1>>1,h[m+3+0]=h[m+2+64]=z+V+1>>1,h[m+0+32]=bt(N,F,M),h[m+1+32]=h[m+0+96]=bt(F,M,z),h[m+2+32]=h[m+1+96]=bt(M,z,V),h[m+3+32]=h[m+2+96]=bt(z,V,Y),h[m+3+64]=bt(V,Y,K),h[m+3+96]=bt(Y,K,te)}function C0(h,m){var N=h[m-1+0],F=h[m-1+32],M=h[m-1+64],z=h[m-1+96];h[m+0+0]=N+F+1>>1,h[m+2+0]=h[m+0+32]=F+M+1>>1,h[m+2+32]=h[m+0+64]=M+z+1>>1,h[m+1+0]=bt(N,F,M),h[m+3+0]=h[m+1+32]=bt(F,M,z),h[m+3+32]=h[m+1+64]=bt(M,z,z),h[m+3+64]=h[m+2+64]=h[m+0+96]=h[m+1+96]=h[m+2+96]=h[m+3+96]=z}function L0(h,m){var N=h[m-1+0],F=h[m-1+32],M=h[m-1+64],z=h[m-1+96],V=h[m-1-32],Y=h[m+0-32],K=h[m+1-32],te=h[m+2-32];h[m+0+0]=h[m+2+32]=N+V+1>>1,h[m+0+32]=h[m+2+64]=F+N+1>>1,h[m+0+64]=h[m+2+96]=M+F+1>>1,h[m+0+96]=z+M+1>>1,h[m+3+0]=bt(Y,K,te),h[m+2+0]=bt(V,Y,K),h[m+1+0]=h[m+3+32]=bt(N,V,Y),h[m+1+32]=h[m+3+64]=bt(F,N,V),h[m+1+64]=h[m+3+96]=bt(M,F,N),h[m+1+96]=bt(z,M,F)}function P0(h,m){var N;for(N=0;8>N;++N)n(h,m+32*N,h,m-32,8)}function zs(h,m){var N;for(N=0;8>N;++N)a(h,m,h[m-1],8),m+=32}function _i(h,m,N){var F;for(F=0;8>F;++F)a(m,N+32*F,h,8)}function Ya(h,m){var N,F=8;for(N=0;8>N;++N)F+=h[m+N-32]+h[m-1+32*N];_i(F>>4,h,m)}function O0(h,m){var N,F=4;for(N=0;8>N;++N)F+=h[m+N-32];_i(F>>3,h,m)}function Si(h,m){var N,F=4;for(N=0;8>N;++N)F+=h[m-1+32*N];_i(F>>3,h,m)}function qs(h,m){_i(128,h,m)}function ts(h,m,N){var F=h[m-N],M=h[m+0],z=3*(M-F)+U0[1020+h[m-2*N]-h[m+N]],V=pl[112+(z+4>>3)];h[m-N]=En[255+F+pl[112+(z+3>>3)]],h[m+0]=En[255+M-V]}function rl(h,m,N,F){var M=h[m+0],z=h[m+N];return Vn[255+h[m-2*N]-h[m-N]]>F||Vn[255+z-M]>F}function nl(h,m,N,F){return 4*Vn[255+h[m-N]-h[m+0]]+Vn[255+h[m-2*N]-h[m+N]]<=F}function al(h,m,N,F,M){var z=h[m-3*N],V=h[m-2*N],Y=h[m-N],K=h[m+0],te=h[m+N],pe=h[m+2*N],Se=h[m+3*N];return 4*Vn[255+Y-K]+Vn[255+V-te]>F?0:Vn[255+h[m-4*N]-z]<=M&&Vn[255+z-V]<=M&&Vn[255+V-Y]<=M&&Vn[255+Se-pe]<=M&&Vn[255+pe-te]<=M&&Vn[255+te-K]<=M}function il(h,m,N,F){var M=2*F+1;for(F=0;16>F;++F)nl(h,m+F,N,M)&&ts(h,m+F,N)}function wa(h,m,N,F){var M=2*F+1;for(F=0;16>F;++F)nl(h,m+F*N,1,M)&&ts(h,m+F*N,1)}function Pa(h,m,N,F){var M;for(M=3;0<M;--M)il(h,m+=4*N,N,F)}function I0(h,m,N,F){var M;for(M=3;0<M;--M)wa(h,m+=4,N,F)}function Xa(h,m,N,F,M,z,V,Y){for(z=2*z+1;0<M--;){if(al(h,m,N,z,V))if(rl(h,m,N,Y))ts(h,m,N);else{var K=h,te=m,pe=N,Se=K[te-2*pe],Ae=K[te-pe],ye=K[te+0],Re=K[te+pe],Ce=K[te+2*pe],me=27*(Ie=U0[1020+3*(ye-Ae)+U0[1020+Se-Re]])+63>>7,xe=18*Ie+63>>7,Ie=9*Ie+63>>7;K[te-3*pe]=En[255+K[te-3*pe]+Ie],K[te-2*pe]=En[255+Se+xe],K[te-pe]=En[255+Ae+me],K[te+0]=En[255+ye-me],K[te+pe]=En[255+Re-xe],K[te+2*pe]=En[255+Ce-Ie]}m+=F}}function ra(h,m,N,F,M,z,V,Y){for(z=2*z+1;0<M--;){if(al(h,m,N,z,V))if(rl(h,m,N,Y))ts(h,m,N);else{var K=h,te=m,pe=N,Se=K[te-pe],Ae=K[te+0],ye=K[te+pe],Re=pl[112+((Ce=3*(Ae-Se))+4>>3)],Ce=pl[112+(Ce+3>>3)],me=Re+1>>1;K[te-2*pe]=En[255+K[te-2*pe]+me],K[te-pe]=En[255+Se+Ce],K[te+0]=En[255+Ae-Re],K[te+pe]=En[255+ye-me]}m+=F}}function Vs(h,m,N,F,M,z){Xa(h,m,N,1,16,F,M,z)}function Ai(h,m,N,F,M,z){Xa(h,m,1,N,16,F,M,z)}function D0(h,m,N,F,M,z){var V;for(V=3;0<V;--V)ra(h,m+=4*N,N,1,16,F,M,z)}function rs(h,m,N,F,M,z){var V;for(V=3;0<V;--V)ra(h,m+=4,1,N,16,F,M,z)}function R0(h,m,N,F,M,z,V,Y){Xa(h,m,M,1,8,z,V,Y),Xa(N,F,M,1,8,z,V,Y)}function Gs(h,m,N,F,M,z,V,Y){Xa(h,m,1,M,8,z,V,Y),Xa(N,F,1,M,8,z,V,Y)}function $s(h,m,N,F,M,z,V,Y){ra(h,m+4*M,M,1,8,z,V,Y),ra(N,F+4*M,M,1,8,z,V,Y)}function sl(h,m,N,F,M,z,V,Y){ra(h,m+4,1,M,8,z,V,Y),ra(N,F+4,1,M,8,z,V,Y)}function ns(){this.ba=new An,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Qt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Ys(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Xs(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function ol(){this.ua=0,this.Wa=new le,this.vb=new le,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new G,this.yc=new T}function M0(){this.xb=this.a=0,this.l=new va,this.ca=new An,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new j,this.Pb=0,this.wd=new j,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new ol,this.ab=0,this.gc=l(4,Xs),this.Oc=0}function as(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new va,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function ji(h,m,N,F,M,z,V){for(h=h==null?0:h[m+0],m=0;m<V;++m)M[z+m]=h+N[F+m]&255,h=M[z+m]}function Ks(h,m,N,F,M,z,V){var Y;if(h==null)ji(null,null,N,F,M,z,V);else for(Y=0;Y<V;++Y)M[z+Y]=h[m+Y]+N[F+Y]&255}function Ka(h,m,N,F,M,z,V){if(h==null)ji(null,null,N,F,M,z,V);else{var Y,K=h[m+0],te=K,pe=K;for(Y=0;Y<V;++Y)te=pe+(K=h[m+Y])-te,pe=N[F+Y]+(-256&te?0>te?0:255:te)&255,te=K,M[z+Y]=pe}}function Js(h,m,N,F){var M=m.width,z=m.o;if(r(h!=null&&m!=null),0>N||0>=F||N+F>z)return null;if(!h.Cc){if(h.ga==null){var V;if(h.ga=new as,(V=h.ga==null)||(V=m.width*m.o,r(h.Gb.length==0),h.Gb=s(V),h.Uc=0,h.Gb==null?V=0:(h.mb=h.Gb,h.nb=h.Uc,h.rc=null,V=1),V=!V),!V){V=h.ga;var Y=h.Fa,K=h.P,te=h.qc,pe=h.mb,Se=h.nb,Ae=K+1,ye=te-1,Re=V.l;if(r(Y!=null&&pe!=null&&m!=null),ri[0]=null,ri[1]=ji,ri[2]=Ks,ri[3]=Ka,V.ca=pe,V.tb=Se,V.c=m.width,V.i=m.height,r(0<V.c&&0<V.i),1>=te)m=0;else if(V.$a=Y[K+0]>>0&3,V.Z=Y[K+0]>>2&3,V.Lc=Y[K+0]>>4&3,K=Y[K+0]>>6&3,0>V.$a||1<V.$a||4<=V.Z||1<V.Lc||K)m=0;else if(Re.put=Bn,Re.ac=Lr,Re.bc=Un,Re.ma=V,Re.width=m.width,Re.height=m.height,Re.Da=m.Da,Re.v=m.v,Re.va=m.va,Re.j=m.j,Re.o=m.o,V.$a)e:{r(V.$a==1),m=Fe();t:for(;;){if(m==null){m=0;break e}if(r(V!=null),V.mc=m,m.c=V.c,m.i=V.i,m.l=V.l,m.l.ma=V,m.l.width=V.c,m.l.height=V.i,m.a=0,oe(m.m,Y,Ae,ye),!Ne(V.c,V.i,1,m,null)||(m.ab==1&&m.gc[0].hc==3&&Z(m.s)?(V.ic=1,Y=m.c*m.i,m.Ta=null,m.Ua=0,m.V=s(Y),m.Ba=0,m.V==null?(m.a=1,m=0):m=1):(V.ic=0,m=je(m,V.c)),!m))break t;m=1;break e}V.mc=null,m=0}else m=ye>=V.c*V.i;V=!m}if(V)return null;h.ga.Lc!=1?h.Ga=0:F=z-N}r(h.ga!=null),r(N+F<=z);e:{if(m=(Y=h.ga).c,z=Y.l.o,Y.$a==0){if(Ae=h.rc,ye=h.Vc,Re=h.Fa,K=h.P+1+N*m,te=h.mb,pe=h.nb+N*m,r(K<=h.P+h.qc),Y.Z!=0)for(r(ri[Y.Z]!=null),V=0;V<F;++V)ri[Y.Z](Ae,ye,Re,K,te,pe,m),Ae=te,ye=pe,pe+=m,K+=m;else for(V=0;V<F;++V)n(te,pe,Re,K,m),Ae=te,ye=pe,pe+=m,K+=m;h.rc=Ae,h.Vc=ye}else{if(r(Y.mc!=null),m=N+F,r((V=Y.mc)!=null),r(m<=V.i),V.C>=m)m=1;else if(Y.ic||we(),Y.ic){Y=V.V,Ae=V.Ba,ye=V.c;var Ce=V.i,me=(Re=1,K=V.$/ye,te=V.$%ye,pe=V.m,Se=V.s,V.$),xe=ye*Ce,Ie=ye*m,He=Se.wc,De=me<Ie?fr(Se,te,K):null;r(me<=xe),r(m<=Ce),r(Z(Se));t:for(;;){for(;!pe.h&&me<Ie;){if(te&He||(De=fr(Se,te,K)),r(De!=null),X(pe),256>(Ce=Jr(De.G[0],De.H[0],pe)))Y[Ae+me]=Ce,++me,++te>=ye&&(te=0,++K<=m&&!(K%16)&&re(V,K));else{if(!(280>Ce)){Re=0;break t}Ce=jn(Ce-256,pe);var ot,Qe=Jr(De.G[4],De.H[4],pe);if(X(pe),!(me>=(Qe=mn(ye,Qe=jn(Qe,pe)))&&xe-me>=Ce)){Re=0;break t}for(ot=0;ot<Ce;++ot)Y[Ae+me+ot]=Y[Ae+me+ot-Qe];for(me+=Ce,te+=Ce;te>=ye;)te-=ye,++K<=m&&!(K%16)&&re(V,K);me<Ie&&te&He&&(De=fr(Se,te,K))}r(pe.h==I(pe))}re(V,K>m?m:K);break t}!Re||pe.h&&me<xe?(Re=0,V.a=pe.h?5:3):V.$=me,m=Re}else m=ie(V,V.V,V.Ba,V.c,V.i,m,ke);if(!m){F=0;break e}}N+F>=z&&(h.Cc=1),F=1}if(!F)return null;if(h.Cc&&((F=h.ga)!=null&&(F.mc=null),h.ga=null,0<h.Ga))return alert("todo:WebPDequantizeLevels"),null}return h.nb+N*M}function y(h,m,N,F,M,z){for(;0<M--;){var V,Y=h,K=m+(N?1:0),te=h,pe=m+(N?0:3);for(V=0;V<F;++V){var Se=te[pe+4*V];Se!=255&&(Se*=32897,Y[K+4*V+0]=Y[K+4*V+0]*Se>>23,Y[K+4*V+1]=Y[K+4*V+1]*Se>>23,Y[K+4*V+2]=Y[K+4*V+2]*Se>>23)}m+=z}}function B(h,m,N,F,M){for(;0<F--;){var z;for(z=0;z<N;++z){var V=h[m+2*z+0],Y=15&(te=h[m+2*z+1]),K=4369*Y,te=(240&te|te>>4)*K>>16;h[m+2*z+0]=(240&V|V>>4)*K>>16&240|(15&V|V<<4)*K>>16>>4&15,h[m+2*z+1]=240&te|Y}m+=M}}function se(h,m,N,F,M,z,V,Y){var K,te,pe=255;for(te=0;te<M;++te){for(K=0;K<F;++K){var Se=h[m+K];z[V+4*K]=Se,pe&=Se}m+=N,V+=Y}return pe!=255}function de(h,m,N,F,M){var z;for(z=0;z<M;++z)N[F+z]=h[m+z]>>8}function we(){qn=y,ar=B,ir=se,wr=de}function Le(h,m,N){C[h]=function(F,M,z,V,Y,K,te,pe,Se,Ae,ye,Re,Ce,me,xe,Ie,He){var De,ot=He-1>>1,Qe=Y[K+0]|te[pe+0]<<16,pt=Se[Ae+0]|ye[Re+0]<<16;r(F!=null);var tt=3*Qe+pt+131074>>2;for(m(F[M+0],255&tt,tt>>16,Ce,me),z!=null&&(tt=3*pt+Qe+131074>>2,m(z[V+0],255&tt,tt>>16,xe,Ie)),De=1;De<=ot;++De){var Ut=Y[K+De]|te[pe+De]<<16,qt=Se[Ae+De]|ye[Re+De]<<16,Rt=Qe+Ut+pt+qt+524296,Lt=Rt+2*(Ut+pt)>>3;tt=Lt+Qe>>1,Qe=(Rt=Rt+2*(Qe+qt)>>3)+Ut>>1,m(F[M+2*De-1],255&tt,tt>>16,Ce,me+(2*De-1)*N),m(F[M+2*De-0],255&Qe,Qe>>16,Ce,me+(2*De-0)*N),z!=null&&(tt=Rt+pt>>1,Qe=Lt+qt>>1,m(z[V+2*De-1],255&tt,tt>>16,xe,Ie+(2*De-1)*N),m(z[V+2*De+0],255&Qe,Qe>>16,xe,Ie+(2*De+0)*N)),Qe=Ut,pt=qt}1&He||(tt=3*Qe+pt+131074>>2,m(F[M+He-1],255&tt,tt>>16,Ce,me+(He-1)*N),z!=null&&(tt=3*pt+Qe+131074>>2,m(z[V+He-1],255&tt,tt>>16,xe,Ie+(He-1)*N)))}}function ze(){Gn[ml]=L1,Gn[gl]=_f,Gn[vf]=P1,Gn[xl]=Sf,Gn[vl]=Af,Gn[H0]=jf,Gn[yf]=O1,Gn[W0]=_f,Gn[z0]=Sf,Gn[yl]=Af,Gn[q0]=jf}function st(h){return h&-16384?0>h?0:255:h>>I1}function ut(h,m){return st((19077*h>>8)+(26149*m>>8)-14234)}function St(h,m,N){return st((19077*h>>8)-(6419*m>>8)-(13320*N>>8)+8708)}function Nt(h,m){return st((19077*h>>8)+(33050*m>>8)-17685)}function Ot(h,m,N,F,M){F[M+0]=ut(h,N),F[M+1]=St(h,m,N),F[M+2]=Nt(h,m)}function cr(h,m,N,F,M){F[M+0]=Nt(h,m),F[M+1]=St(h,m,N),F[M+2]=ut(h,N)}function hr(h,m,N,F,M){var z=St(h,m,N);m=z<<3&224|Nt(h,m)>>3,F[M+0]=248&ut(h,N)|z>>5,F[M+1]=m}function Ar(h,m,N,F,M){var z=240&Nt(h,m)|15;F[M+0]=240&ut(h,N)|St(h,m,N)>>4,F[M+1]=z}function Qr(h,m,N,F,M){F[M+0]=255,Ot(h,m,N,F,M+1)}function Rr(h,m,N,F,M){cr(h,m,N,F,M),F[M+3]=255}function na(h,m,N,F,M){Ot(h,m,N,F,M),F[M+3]=255}function Tn(h,m){return 0>h?0:h>m?m:h}function ba(h,m,N){C[h]=function(F,M,z,V,Y,K,te,pe,Se){for(var Ae=pe+(-2&Se)*N;pe!=Ae;)m(F[M+0],z[V+0],Y[K+0],te,pe),m(F[M+1],z[V+0],Y[K+0],te,pe+N),M+=2,++V,++K,pe+=2*N;1&Se&&m(F[M+0],z[V+0],Y[K+0],te,pe)}}function ll(h,m,N){return N==0?h==0?m==0?6:5:m==0?4:0:N}function Zs(h,m,N,F,M){switch(h>>>30){case 3:Da(m,N,F,M,0);break;case 2:yr(m,N,F,M);break;case 1:cn(m,N,F,M)}}function Qs(h,m){var N,F,M=m.M,z=m.Nb,V=h.oc,Y=h.pc+40,K=h.oc,te=h.pc+584,pe=h.oc,Se=h.pc+600;for(N=0;16>N;++N)V[Y+32*N-1]=129;for(N=0;8>N;++N)K[te+32*N-1]=129,pe[Se+32*N-1]=129;for(0<M?V[Y-1-32]=K[te-1-32]=pe[Se-1-32]=129:(a(V,Y-32-1,127,21),a(K,te-32-1,127,9),a(pe,Se-32-1,127,9)),F=0;F<h.za;++F){var Ae=m.ya[m.aa+F];if(0<F){for(N=-1;16>N;++N)n(V,Y+32*N-4,V,Y+32*N+12,4);for(N=-1;8>N;++N)n(K,te+32*N-4,K,te+32*N+4,4),n(pe,Se+32*N-4,pe,Se+32*N+4,4)}var ye=h.Gd,Re=h.Hd+F,Ce=Ae.ad,me=Ae.Hc;if(0<M&&(n(V,Y-32,ye[Re].y,0,16),n(K,te-32,ye[Re].f,0,8),n(pe,Se-32,ye[Re].ea,0,8)),Ae.Za){var xe=V,Ie=Y-32+16;for(0<M&&(F>=h.za-1?a(xe,Ie,ye[Re].y[15],4):n(xe,Ie,ye[Re+1].y,0,4)),N=0;4>N;N++)xe[Ie+128+N]=xe[Ie+256+N]=xe[Ie+384+N]=xe[Ie+0+N];for(N=0;16>N;++N,me<<=2)xe=V,Ie=Y+Tf[N],aa[Ae.Ob[N]](xe,Ie),Zs(me,Ce,16*+N,xe,Ie)}else if(xe=ll(F,M,Ae.Ob[0]),ti[xe](V,Y),me!=0)for(N=0;16>N;++N,me<<=2)Zs(me,Ce,16*+N,V,Y+Tf[N]);for(N=Ae.Gc,xe=ll(F,M,Ae.Dd),Ma[xe](K,te),Ma[xe](pe,Se),me=Ce,xe=K,Ie=te,255&(Ae=N>>0)&&(170&Ae?ao(me,256,xe,Ie):Wn(me,256,xe,Ie)),Ae=pe,me=Se,255&(N>>=8)&&(170&N?ao(Ce,320,Ae,me):Wn(Ce,320,Ae,me)),M<h.Ub-1&&(n(ye[Re].y,0,V,Y+480,16),n(ye[Re].f,0,K,te+224,8),n(ye[Re].ea,0,pe,Se+224,8)),N=8*z*h.B,ye=h.sa,Re=h.ta+16*F+16*z*h.R,Ce=h.qa,Ae=h.ra+8*F+N,me=h.Ha,xe=h.Ia+8*F+N,N=0;16>N;++N)n(ye,Re+N*h.R,V,Y+32*N,16);for(N=0;8>N;++N)n(Ce,Ae+N*h.B,K,te+32*N,8),n(me,xe+N*h.B,pe,Se+32*N,8)}}function is(h,m,N,F,M,z,V,Y,K){var te=[0],pe=[0],Se=0,Ae=K!=null?K.kd:0,ye=K??new Ys;if(h==null||12>N)return 7;ye.data=h,ye.w=m,ye.ha=N,m=[m],N=[N],ye.gb=[ye.gb];e:{var Re=m,Ce=N,me=ye.gb;if(r(h!=null),r(Ce!=null),r(me!=null),me[0]=0,12<=Ce[0]&&!t(h,Re[0],"RIFF")){if(t(h,Re[0]+8,"WEBP")){me=3;break e}var xe=Ve(h,Re[0]+4);if(12>xe||4294967286<xe){me=3;break e}if(Ae&&xe>Ce[0]-8){me=7;break e}me[0]=xe,Re[0]+=12,Ce[0]-=12}me=0}if(me!=0)return me;for(xe=0<ye.gb[0],N=N[0];;){e:{var Ie=h;Ce=m,me=N;var He=te,De=pe,ot=Re=[0];if((tt=Se=[Se])[0]=0,8>me[0])me=7;else{if(!t(Ie,Ce[0],"VP8X")){if(Ve(Ie,Ce[0]+4)!=10){me=3;break e}if(18>me[0]){me=7;break e}var Qe=Ve(Ie,Ce[0]+8),pt=1+Me(Ie,Ce[0]+12);if(2147483648<=pt*(Ie=1+Me(Ie,Ce[0]+15))){me=3;break e}ot!=null&&(ot[0]=Qe),He!=null&&(He[0]=pt),De!=null&&(De[0]=Ie),Ce[0]+=18,me[0]-=18,tt[0]=1}me=0}}if(Se=Se[0],Re=Re[0],me!=0)return me;if(Ce=!!(2&Re),!xe&&Se)return 3;if(z!=null&&(z[0]=!!(16&Re)),V!=null&&(V[0]=Ce),Y!=null&&(Y[0]=0),V=te[0],Re=pe[0],Se&&Ce&&K==null){me=0;break}if(4>N){me=7;break}if(xe&&Se||!xe&&!Se&&!t(h,m[0],"ALPH")){N=[N],ye.na=[ye.na],ye.P=[ye.P],ye.Sa=[ye.Sa];e:{Qe=h,me=m,xe=N;var tt=ye.gb;He=ye.na,De=ye.P,ot=ye.Sa,pt=22,r(Qe!=null),r(xe!=null),Ie=me[0];var Ut=xe[0];for(r(He!=null),r(ot!=null),He[0]=null,De[0]=null,ot[0]=0;;){if(me[0]=Ie,xe[0]=Ut,8>Ut){me=7;break e}var qt=Ve(Qe,Ie+4);if(4294967286<qt){me=3;break e}var Rt=8+qt+1&-2;if(pt+=Rt,0<tt&&pt>tt){me=3;break e}if(!t(Qe,Ie,"VP8 ")||!t(Qe,Ie,"VP8L")){me=0;break e}if(Ut[0]<Rt){me=7;break e}t(Qe,Ie,"ALPH")||(He[0]=Qe,De[0]=Ie+8,ot[0]=qt),Ie+=Rt,Ut-=Rt}}if(N=N[0],ye.na=ye.na[0],ye.P=ye.P[0],ye.Sa=ye.Sa[0],me!=0)break}N=[N],ye.Ja=[ye.Ja],ye.xa=[ye.xa];e:if(tt=h,me=m,xe=N,He=ye.gb[0],De=ye.Ja,ot=ye.xa,Qe=me[0],Ie=!t(tt,Qe,"VP8 "),pt=!t(tt,Qe,"VP8L"),r(tt!=null),r(xe!=null),r(De!=null),r(ot!=null),8>xe[0])me=7;else{if(Ie||pt){if(tt=Ve(tt,Qe+4),12<=He&&tt>He-12){me=3;break e}if(Ae&&tt>xe[0]-8){me=7;break e}De[0]=tt,me[0]+=8,xe[0]-=8,ot[0]=pt}else ot[0]=5<=xe[0]&&tt[Qe+0]==47&&!(tt[Qe+4]>>5),De[0]=xe[0];me=0}if(N=N[0],ye.Ja=ye.Ja[0],ye.xa=ye.xa[0],m=m[0],me!=0)break;if(4294967286<ye.Ja)return 3;if(Y==null||Ce||(Y[0]=ye.xa?2:1),V=[V],Re=[Re],ye.xa){if(5>N){me=7;break}Y=V,Ae=Re,Ce=z,h==null||5>N?h=0:5<=N&&h[m+0]==47&&!(h[m+4]>>5)?(xe=[0],tt=[0],He=[0],oe(De=new j,h,m,N),dt(De,xe,tt,He)?(Y!=null&&(Y[0]=xe[0]),Ae!=null&&(Ae[0]=tt[0]),Ce!=null&&(Ce[0]=He[0]),h=1):h=0):h=0}else{if(10>N){me=7;break}Y=Re,h==null||10>N||!Go(h,m+3,N-3)?h=0:(Ae=h[m+0]|h[m+1]<<8|h[m+2]<<16,Ce=16383&(h[m+7]<<8|h[m+6]),h=16383&(h[m+9]<<8|h[m+8]),1&Ae||3<(Ae>>1&7)||!(Ae>>4&1)||Ae>>5>=ye.Ja||!Ce||!h?h=0:(V&&(V[0]=Ce),Y&&(Y[0]=h),h=1))}if(!h||(V=V[0],Re=Re[0],Se&&(te[0]!=V||pe[0]!=Re)))return 3;K!=null&&(K[0]=ye,K.offset=m-K.w,r(4294967286>m-K.w),r(K.offset==K.ha-N));break}return me==0||me==7&&Se&&K==null?(z!=null&&(z[0]|=ye.na!=null&&0<ye.na.length),F!=null&&(F[0]=V),M!=null&&(M[0]=Re),0):me}function eo(h,m,N){var F=m.width,M=m.height,z=0,V=0,Y=F,K=M;if(m.Da=h!=null&&0<h.Da,m.Da&&(Y=h.cd,K=h.bd,z=h.v,V=h.j,11>N||(z&=-2,V&=-2),0>z||0>V||0>=Y||0>=K||z+Y>F||V+K>M))return 0;if(m.v=z,m.j=V,m.va=z+Y,m.o=V+K,m.U=Y,m.T=K,m.da=h!=null&&0<h.da,m.da){if(!Be(Y,K,N=[h.ib],z=[h.hb]))return 0;m.ib=N[0],m.hb=z[0]}return m.ob=h!=null&&h.ob,m.Kb=h==null||!h.Sd,m.da&&(m.ob=m.ib<3*F/4&&m.hb<3*M/4,m.Kb=0),1}function to(h){if(h==null)return 2;if(11>h.S){var m=h.f.RGBA;m.fb+=(h.height-1)*m.A,m.A=-m.A}else m=h.f.kb,h=h.height,m.O+=(h-1)*m.fa,m.fa=-m.fa,m.N+=(h-1>>1)*m.Ab,m.Ab=-m.Ab,m.W+=(h-1>>1)*m.Db,m.Db=-m.Db,m.F!=null&&(m.J+=(h-1)*m.lb,m.lb=-m.lb);return 0}function ss(h,m,N,F){if(F==null||0>=h||0>=m)return 2;if(N!=null){if(N.Da){var M=N.cd,z=N.bd,V=-2&N.v,Y=-2&N.j;if(0>V||0>Y||0>=M||0>=z||V+M>h||Y+z>m)return 2;h=M,m=z}if(N.da){if(!Be(h,m,M=[N.ib],z=[N.hb]))return 2;h=M[0],m=z[0]}}F.width=h,F.height=m;e:{var K=F.width,te=F.height;if(h=F.S,0>=K||0>=te||!(h>=ml&&13>h))h=2;else{if(0>=F.Rd&&F.sd==null){V=z=M=m=0;var pe=(Y=K*Ef[h])*te;if(11>h||(z=(te+1)/2*(m=(K+1)/2),h==12&&(V=(M=K)*te)),(te=s(pe+2*z+V))==null){h=1;break e}F.sd=te,11>h?((K=F.f.RGBA).eb=te,K.fb=0,K.A=Y,K.size=pe):((K=F.f.kb).y=te,K.O=0,K.fa=Y,K.Fd=pe,K.f=te,K.N=0+pe,K.Ab=m,K.Cd=z,K.ea=te,K.W=0+pe+z,K.Db=m,K.Ed=z,h==12&&(K.F=te,K.J=0+pe+2*z),K.Tc=V,K.lb=M)}if(m=1,M=F.S,z=F.width,V=F.height,M>=ml&&13>M)if(11>M)h=F.f.RGBA,m&=(Y=Math.abs(h.A))*(V-1)+z<=h.size,m&=Y>=z*Ef[M],m&=h.eb!=null;else{h=F.f.kb,Y=(z+1)/2,pe=(V+1)/2,K=Math.abs(h.fa),te=Math.abs(h.Ab);var Se=Math.abs(h.Db),Ae=Math.abs(h.lb),ye=Ae*(V-1)+z;m&=K*(V-1)+z<=h.Fd,m&=te*(pe-1)+Y<=h.Cd,m=(m&=Se*(pe-1)+Y<=h.Ed)&K>=z&te>=Y&Se>=Y,m&=h.y!=null,m&=h.f!=null,m&=h.ea!=null,M==12&&(m&=Ae>=z,m&=ye<=h.Tc,m&=h.F!=null)}else m=0;h=m?0:2}}return h!=0||N!=null&&N.fd&&(h=to(F)),h}var zr=64,os=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ls=24,cs=32,ro=8,xn=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];$e("Predictor0","PredictorAdd0"),C.Predictor0=function(){return 4278190080},C.Predictor1=function(h){return h},C.Predictor2=function(h,m,N){return m[N+0]},C.Predictor3=function(h,m,N){return m[N+1]},C.Predictor4=function(h,m,N){return m[N-1]},C.Predictor5=function(h,m,N){return et(et(h,m[N+1]),m[N+0])},C.Predictor6=function(h,m,N){return et(h,m[N-1])},C.Predictor7=function(h,m,N){return et(h,m[N+0])},C.Predictor8=function(h,m,N){return et(m[N-1],m[N+0])},C.Predictor9=function(h,m,N){return et(m[N+0],m[N+1])},C.Predictor10=function(h,m,N){return et(et(h,m[N-1]),et(m[N+0],m[N+1]))},C.Predictor11=function(h,m,N){var F=m[N+0];return 0>=yt(F>>24&255,h>>24&255,(m=m[N-1])>>24&255)+yt(F>>16&255,h>>16&255,m>>16&255)+yt(F>>8&255,h>>8&255,m>>8&255)+yt(255&F,255&h,255&m)?F:h},C.Predictor12=function(h,m,N){var F=m[N+0];return(ft((h>>24&255)+(F>>24&255)-((m=m[N-1])>>24&255))<<24|ft((h>>16&255)+(F>>16&255)-(m>>16&255))<<16|ft((h>>8&255)+(F>>8&255)-(m>>8&255))<<8|ft((255&h)+(255&F)-(255&m)))>>>0},C.Predictor13=function(h,m,N){var F=m[N-1];return(ht((h=et(h,m[N+0]))>>24&255,F>>24&255)<<24|ht(h>>16&255,F>>16&255)<<16|ht(h>>8&255,F>>8&255)<<8|ht(h>>0&255,F>>0&255))>>>0};var B0=C.PredictorAdd0;C.PredictorAdd1=At,$e("Predictor2","PredictorAdd2"),$e("Predictor3","PredictorAdd3"),$e("Predictor4","PredictorAdd4"),$e("Predictor5","PredictorAdd5"),$e("Predictor6","PredictorAdd6"),$e("Predictor7","PredictorAdd7"),$e("Predictor8","PredictorAdd8"),$e("Predictor9","PredictorAdd9"),$e("Predictor10","PredictorAdd10"),$e("Predictor11","PredictorAdd11"),$e("Predictor12","PredictorAdd12"),$e("Predictor13","PredictorAdd13");var no=C.PredictorAdd2;kt("ColorIndexInverseTransform","MapARGB","32b",function(h){return h>>8&255},function(h){return h}),kt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(h){return h},function(h){return h>>8&255});var cl,Hn=C.ColorIndexInverseTransform,fs=C.MapARGB,fl=C.VP8LColorIndexInverseTransformAlpha,hl=C.MapAlpha,Ja=C.VP8LPredictorsAdd=[];Ja.length=16,(C.VP8LPredictors=[]).length=16,(C.VP8LPredictorsAdd_C=[]).length=16,(C.VP8LPredictors_C=[]).length=16;var ki,vn,ln,Za,Oa,Ia,hs,Da,yr,ao,cn,Wn,us,ul,io,Ti,Ei,Qa,Fi,ds,Ci,ei,so,zn,qn,ar,ir,wr,Pr=s(511),Ra=s(2041),oo=s(225),ps=s(767),dl=0,U0=Ra,pl=oo,En=ps,Vn=Pr,ml=0,gl=1,vf=2,xl=3,vl=4,H0=5,yf=6,W0=7,z0=8,yl=9,q0=10,v1=[2,3,7],y1=[3,3,11],wf=[280,256,256,256,40],w1=[0,1,1,1,0],b1=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],N1=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],_1=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],S1=8,V0=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],G0=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],lo=null,A1=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],j1=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],bf=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],k1=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],T1=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],E1=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],F1=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ti=[],aa=[],Ma=[],C1=1,Nf=2,ri=[],Gn=[];Le("UpsampleRgbLinePair",Ot,3),Le("UpsampleBgrLinePair",cr,3),Le("UpsampleRgbaLinePair",na,4),Le("UpsampleBgraLinePair",Rr,4),Le("UpsampleArgbLinePair",Qr,4),Le("UpsampleRgba4444LinePair",Ar,2),Le("UpsampleRgb565LinePair",hr,2);var L1=C.UpsampleRgbLinePair,P1=C.UpsampleBgrLinePair,_f=C.UpsampleRgbaLinePair,Sf=C.UpsampleBgraLinePair,Af=C.UpsampleArgbLinePair,jf=C.UpsampleRgba4444LinePair,O1=C.UpsampleRgb565LinePair,wl=16,bl=1<<wl-1,co=-227,$0=482,I1=6,kf=0,D1=s(256),R1=s(256),M1=s(256),B1=s(256),U1=s($0-co),H1=s($0-co);ba("YuvToRgbRow",Ot,3),ba("YuvToBgrRow",cr,3),ba("YuvToRgbaRow",na,4),ba("YuvToBgraRow",Rr,4),ba("YuvToArgbRow",Qr,4),ba("YuvToRgba4444Row",Ar,2),ba("YuvToRgb565Row",hr,2);var Tf=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Nl=[0,2,8],W1=[8,7,6,4,4,2,2,2,1,1,1,1],z1=1;this.WebPDecodeRGBA=function(h,m,N,F,M){var z=gl,V=new ns,Y=new An;V.ba=Y,Y.S=z,Y.width=[Y.width],Y.height=[Y.height];var K=Y.width,te=Y.height,pe=new Zn;if(pe==null||h==null)var Se=2;else r(pe!=null),Se=is(h,m,N,pe.width,pe.height,pe.Pd,pe.Qd,pe.format,null);if(Se!=0?K=0:(K!=null&&(K[0]=pe.width[0]),te!=null&&(te[0]=pe.height[0]),K=1),K){Y.width=Y.width[0],Y.height=Y.height[0],F!=null&&(F[0]=Y.width),M!=null&&(M[0]=Y.height);e:{if(F=new va,(M=new Ys).data=h,M.w=m,M.ha=N,M.kd=1,m=[0],r(M!=null),((h=is(M.data,M.w,M.ha,null,null,null,m,null,M))==0||h==7)&&m[0]&&(h=4),(m=h)==0){if(r(V!=null),F.data=M.data,F.w=M.w+M.offset,F.ha=M.ha-M.offset,F.put=Bn,F.ac=Lr,F.bc=Un,F.ma=V,M.xa){if((h=Fe())==null){V=1;break e}if(function(Ae,ye){var Re=[0],Ce=[0],me=[0];t:for(;;){if(Ae==null)return 0;if(ye==null)return Ae.a=2,0;if(Ae.l=ye,Ae.a=0,oe(Ae.m,ye.data,ye.w,ye.ha),!dt(Ae.m,Re,Ce,me)){Ae.a=3;break t}if(Ae.xb=Nf,ye.width=Re[0],ye.height=Ce[0],!Ne(Re[0],Ce[0],1,Ae,null))break t;return 1}return r(Ae.a!=0),0}(h,F)){if(F=(m=ss(F.width,F.height,V.Oa,V.ba))==0){t:{F=h;r:for(;;){if(F==null){F=0;break t}if(r(F.s.yc!=null),r(F.s.Ya!=null),r(0<F.s.Wb),r((N=F.l)!=null),r((M=N.ma)!=null),F.xb!=0){if(F.ca=M.ba,F.tb=M.tb,r(F.ca!=null),!eo(M.Oa,N,xl)){F.a=2;break r}if(!je(F,N.width)||N.da)break r;if((N.da||Dt(F.ca.S))&&we(),11>F.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),F.ca.f.kb.F!=null&&we()),F.Pb&&0<F.s.ua&&F.s.vb.X==null&&!Je(F.s.vb,F.s.Wa.Xa)){F.a=1;break r}F.xb=0}if(!ie(F,F.V,F.Ba,F.c,F.i,N.o,ne))break r;M.Dc=F.Ma,F=1;break t}r(F.a!=0),F=0}F=!F}F&&(m=h.a)}else m=h.a}else{if((h=new kn)==null){V=1;break e}if(h.Fa=M.na,h.P=M.P,h.qc=M.Sa,$o(h,F)){if((m=ss(F.width,F.height,V.Oa,V.ba))==0){if(h.Aa=0,N=V.Oa,r((M=h)!=null),N!=null){if(0<(K=0>(K=N.Md)?0:100<K?255:255*K/100)){for(te=pe=0;4>te;++te)12>(Se=M.pb[te]).lc&&(Se.ia=K*W1[0>Se.lc?0:Se.lc]>>3),pe|=Se.ia;pe&&(alert("todo:VP8InitRandom"),M.ia=1)}M.Ga=N.Id,100<M.Ga?M.Ga=100:0>M.Ga&&(M.Ga=0)}b0(h,F)||(m=h.a)}}else m=h.a}m==0&&V.Oa!=null&&V.Oa.fd&&(m=to(V.ba))}V=m}z=V!=0?null:11>z?Y.f.RGBA.eb:Y.f.kb.y}else z=null;return z};var Ef=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(C,P){for(var W="",k=0;k<4;k++)W+=String.fromCharCode(C[P++]);return W}function d(C,P){return(C[P+0]<<0|C[P+1]<<8|C[P+2]<<16)>>>0}function g(C,P){return(C[P+0]<<0|C[P+1]<<8|C[P+2]<<16|C[P+3]<<24)>>>0}new f;var x=[0],p=[0],w=[],v=new f,_=e,S=function(C,P){var W={},k=0,T=!1,H=0,G=0;if(W.frames=[],!function(O,I,D,X){for(var fe=0;fe<X;fe++)if(O[I+fe]!=D.charCodeAt(fe))return!0;return!1}(C,P,"RIFF",4)){var ce,J;for(g(C,P+=4),P+=8;P<C.length;){var Q=u(C,P),oe=g(C,P+=4);P+=4;var ae=oe+(1&oe);switch(Q){case"VP8 ":case"VP8L":W.frames[k]===void 0&&(W.frames[k]={}),(j=W.frames[k]).src_off=T?G:P-8,j.src_size=H+oe+8,k++,T&&(T=!1,H=0,G=0);break;case"VP8X":(j=W.header={}).feature_flags=C[P];var ge=P+4;j.canvas_width=1+d(C,ge),ge+=3,j.canvas_height=1+d(C,ge),ge+=3;break;case"ALPH":T=!0,H=ae+8,G=P-8;break;case"ANIM":(j=W.header).bgcolor=g(C,P),ge=P+4,j.loop_count=(ce=C)[(J=ge)+0]<<0|ce[J+1]<<8,ge+=2;break;case"ANMF":var ve,j;(j=W.frames[k]={}).offset_x=2*d(C,P),P+=3,j.offset_y=2*d(C,P),P+=3,j.width=1+d(C,P),P+=3,j.height=1+d(C,P),P+=3,j.duration=d(C,P),P+=3,ve=C[P++],j.dispose=1&ve,j.blend=ve>>1&1}Q!="ANMF"&&(P+=ae)}return W}}(_,0);S.response=_,S.rgbaoutput=!0,S.dataurl=!1;var b=S.header?S.header:null,A=S.frames?S.frames:null;if(b){b.loop_counter=b.loop_count,x=[b.canvas_height],p=[b.canvas_width];for(var E=0;E<A.length&&A[E].blend!=0;E++);}var U=A[0],R=v.WebPDecodeRGBA(_,U.src_off,U.src_size,p,x);U.rgba=R,U.imgwidth=p[0],U.imgheight=x[0];for(var L=0;L<p[0]*x[0]*4;L++)w[L]=R[L];return this.width=p,this.height=x,this.data=w,this}(function(e){var r=function(){return typeof Oc=="function"},t=function(x,p,w,v){var _=4,S=l;switch(v){case e.image_compression.FAST:_=1,S=s;break;case e.image_compression.MEDIUM:_=6,S=c;break;case e.image_compression.SLOW:_=9,S=f}x=n(x,p,w,S);var b=Oc(x,{level:_});return e.__addimage__.arrayBufferToBinaryString(b)},n=function(x,p,w,v){for(var _,S,b,A=x.length/p,E=new Uint8Array(x.length+A),U=d(),R=0;R<A;R+=1){if(b=R*p,_=x.subarray(b,b+p),v)E.set(v(_,w,S),b+R);else{for(var L,C=U.length,P=[];L<C;L+=1)P[L]=U[L](_,w,S);var W=g(P.concat());E.set(P[W],b+R)}S=_}return E},a=function(x){var p=Array.apply([],x);return p.unshift(0),p},s=function(x,p){var w,v=[],_=x.length;v[0]=1;for(var S=0;S<_;S+=1)w=x[S-p]||0,v[S+1]=x[S]-w+256&255;return v},l=function(x,p,w){var v,_=[],S=x.length;_[0]=2;for(var b=0;b<S;b+=1)v=w&&w[b]||0,_[b+1]=x[b]-v+256&255;return _},c=function(x,p,w){var v,_,S=[],b=x.length;S[0]=3;for(var A=0;A<b;A+=1)v=x[A-p]||0,_=w&&w[A]||0,S[A+1]=x[A]+256-(v+_>>>1)&255;return S},f=function(x,p,w){var v,_,S,b,A=[],E=x.length;A[0]=4;for(var U=0;U<E;U+=1)v=x[U-p]||0,_=w&&w[U]||0,S=w&&w[U-p]||0,b=u(v,_,S),A[U+1]=x[U]-b+256&255;return A},u=function(x,p,w){if(x===p&&p===w)return x;var v=Math.abs(p-w),_=Math.abs(x-w),S=Math.abs(x+p-w-w);return v<=_&&v<=S?x:_<=S?p:w},d=function(){return[a,s,l,c,f]},g=function(x){var p=x.map(function(w){return w.reduce(function(v,_){return v+Math.abs(_)},0)});return p.indexOf(Math.min.apply(null,p))};e.processPNG=function(x,p,w,v){var _,S,b,A,E,U,R,L,C,P,W,k,T,H,G,ce=this.decode.FLATE_DECODE,J="";if(this.__addimage__.isArrayBuffer(x)&&(x=new Uint8Array(x)),this.__addimage__.isArrayBufferView(x)){if(x=(b=new sm(x)).imgData,S=b.bits,_=b.colorSpace,E=b.colors,[4,6].indexOf(b.colorType)!==-1){if(b.bits===8){C=(L=b.pixelBitlength==32?new Uint32Array(b.decodePixels().buffer):b.pixelBitlength==16?new Uint16Array(b.decodePixels().buffer):new Uint8Array(b.decodePixels().buffer)).length,W=new Uint8Array(C*b.colors),P=new Uint8Array(C);var Q,oe=b.pixelBitlength-b.bits;for(H=0,G=0;H<C;H++){for(T=L[H],Q=0;Q<oe;)W[G++]=T>>>Q&255,Q+=b.bits;P[H]=T>>>Q&255}}if(b.bits===16){C=(L=new Uint32Array(b.decodePixels().buffer)).length,W=new Uint8Array(C*(32/b.pixelBitlength)*b.colors),P=new Uint8Array(C*(32/b.pixelBitlength)),k=b.colors>1,H=0,G=0;for(var ae=0;H<C;)T=L[H++],W[G++]=T>>>0&255,k&&(W[G++]=T>>>16&255,T=L[H++],W[G++]=T>>>0&255),P[ae++]=T>>>16&255;S=8}v!==e.image_compression.NONE&&r()?(x=t(W,b.width*b.colors,b.colors,v),R=t(P,b.width,1,v)):(x=W,R=P,ce=void 0)}if(b.colorType===3&&(_=this.color_spaces.INDEXED,U=b.palette,b.transparency.indexed)){var ge=b.transparency.indexed,ve=0;for(H=0,C=ge.length;H<C;++H)ve+=ge[H];if((ve/=255)===C-1&&ge.indexOf(0)!==-1)A=[ge.indexOf(0)];else if(ve!==C){for(L=b.decodePixels(),P=new Uint8Array(L.length),H=0,C=L.length;H<C;H++)P[H]=ge[L[H]];R=t(P,b.width,1)}}var j=function(O){var I;switch(O){case e.image_compression.FAST:I=11;break;case e.image_compression.MEDIUM:I=13;break;case e.image_compression.SLOW:I=14;break;default:I=12}return I}(v);return ce===this.decode.FLATE_DECODE&&(J="/Predictor "+j+" "),J+="/Colors "+E+" /BitsPerComponent "+S+" /Columns "+b.width,(this.__addimage__.isArrayBuffer(x)||this.__addimage__.isArrayBufferView(x))&&(x=this.__addimage__.arrayBufferToBinaryString(x)),(R&&this.__addimage__.isArrayBuffer(R)||this.__addimage__.isArrayBufferView(R))&&(R=this.__addimage__.arrayBufferToBinaryString(R)),{alias:w,data:x,index:p,filter:ce,decodeParameters:J,transparency:A,palette:U,sMask:R,predictor:j,width:b.width,height:b.height,bitsPerComponent:S,colorSpace:_}}}})(mt.API),function(e){e.processGIF89A=function(r,t,n,a){var s=new om(r),l=s.width,c=s.height,f=[];s.decodeAndBlitFrameRGBA(0,f);var u={data:f,width:l,height:c},d=new xc(100).encode(u,100);return e.processJPEG.call(this,d,t,n,a)},e.processGIF87A=e.processGIF89A}(mt.API),oa.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var r=0;r<e;r++){var t=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[r]={red:a,green:n,blue:t,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},oa.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,r=this.width*this.height*4;this.data=new Uint8Array(r),this[e]()}catch(t){tr.log("bit decode error:"+t)}},oa.prototype.bit1=function(){var e,r=Math.ceil(this.width/8),t=r%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,a=0;a<r;a++)for(var s=this.datav.getUint8(this.pos++,!0),l=n*this.width*4+8*a*4,c=0;c<8&&8*a+c<this.width;c++){var f=this.palette[s>>7-c&1];this.data[l+4*c]=f.blue,this.data[l+4*c+1]=f.green,this.data[l+4*c+2]=f.red,this.data[l+4*c+3]=255}t!==0&&(this.pos+=4-t)}},oa.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),r=e%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,a=0;a<e;a++){var s=this.datav.getUint8(this.pos++,!0),l=n*this.width*4+2*a*4,c=s>>4,f=15&s,u=this.palette[c];if(this.data[l]=u.blue,this.data[l+1]=u.green,this.data[l+2]=u.red,this.data[l+3]=255,2*a+1>=this.width)break;u=this.palette[f],this.data[l+4]=u.blue,this.data[l+4+1]=u.green,this.data[l+4+2]=u.red,this.data[l+4+3]=255}r!==0&&(this.pos+=4-r)}},oa.prototype.bit8=function(){for(var e=this.width%4,r=this.height-1;r>=0;r--){for(var t=this.bottom_up?r:this.height-1-r,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*n;if(a<this.palette.length){var l=this.palette[a];this.data[s]=l.red,this.data[s+1]=l.green,this.data[s+2]=l.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}e!==0&&(this.pos+=4-e)}},oa.prototype.bit15=function(){for(var e=this.width%3,r=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,a=0;a<this.width;a++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(s&r)/r*255|0,c=(s>>5&r)/r*255|0,f=(s>>10&r)/r*255|0,u=s>>15?255:0,d=n*this.width*4+4*a;this.data[d]=f,this.data[d+1]=c,this.data[d+2]=l,this.data[d+3]=u}this.pos+=e}},oa.prototype.bit16=function(){for(var e=this.width%3,r=parseInt("11111",2),t=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var l=this.datav.getUint16(this.pos,!0);this.pos+=2;var c=(l&r)/r*255|0,f=(l>>5&t)/t*255|0,u=(l>>11)/r*255|0,d=a*this.width*4+4*s;this.data[d]=u,this.data[d+1]=f,this.data[d+2]=c,this.data[d+3]=255}this.pos+=e}},oa.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=r*this.width*4+4*t;this.data[l]=s,this.data[l+1]=a,this.data[l+2]=n,this.data[l+3]=255}this.pos+=this.width%4}},oa.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var r=this.bottom_up?e:this.height-1-e,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),c=r*this.width*4+4*t;this.data[c]=s,this.data[c+1]=a,this.data[c+2]=n,this.data[c+3]=l}},oa.prototype.getData=function(){return this.data},function(e){e.processBMP=function(r,t,n,a){var s=new oa(r,!1),l=s.width,c=s.height,f={data:s.getData(),width:l,height:c},u=new xc(100).encode(f,100);return e.processJPEG.call(this,u,t,n,a)}}(mt.API),wh.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(r,t,n,a){var s=new wh(r),l=s.width,c=s.height,f={data:s.getData(),width:l,height:c},u=new xc(100).encode(f,100);return e.processJPEG.call(this,u,t,n,a)}}(mt.API),mt.API.processRGBA=function(e,r,t){for(var n=e.data,a=n.length,s=new Uint8Array(a/4*3),l=new Uint8Array(a/4),c=0,f=0,u=0;u<a;u+=4){var d=n[u],g=n[u+1],x=n[u+2],p=n[u+3];s[c++]=d,s[c++]=g,s[c++]=x,l[f++]=p}var w=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(l),data:w,index:r,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},mt.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},ws=mt.API,Bl=ws.getCharWidthsArray=function(e,r){var t,n,a=(r=r||{}).font||this.internal.getFont(),s=r.fontSize||this.internal.getFontSize(),l=r.charSpace||this.internal.getCharSpace(),c=r.widths?r.widths:a.metadata.Unicode.widths,f=c.fof?c.fof:1,u=r.kerning?r.kerning:a.metadata.Unicode.kerning,d=u.fof?u.fof:1,g=r.doKerning!==!1,x=0,p=e.length,w=0,v=c[0]||f,_=[];for(t=0;t<p;t++)n=e.charCodeAt(t),typeof a.metadata.widthOfString=="function"?_.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(n))+l*(1e3/s)||0)/1e3):(x=g&&rr(u[n])==="object"&&!isNaN(parseInt(u[n][w],10))?u[n][w]/d:0,_.push((c[n]||v)/f+x)),w=n;return _},gh=ws.getStringUnitWidth=function(e,r){var t=(r=r||{}).fontSize||this.internal.getFontSize(),n=r.font||this.internal.getFont(),a=r.charSpace||this.internal.getCharSpace();return ws.processArabic&&(e=ws.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,t,a)/t:Bl.apply(this,arguments).reduce(function(s,l){return s+l},0)},xh=function(e,r,t,n){for(var a=[],s=0,l=e.length,c=0;s!==l&&c+r[s]<t;)c+=r[s],s++;a.push(e.slice(0,s));var f=s;for(c=0;s!==l;)c+r[s]>n&&(a.push(e.slice(f,s)),c=0,f=s),c+=r[s],s++;return f!==s&&a.push(e.slice(f,s)),a},vh=function(e,r,t){t||(t={});var n,a,s,l,c,f,u,d=[],g=[d],x=t.textIndent||0,p=0,w=0,v=e.split(" "),_=Bl.apply(this,[" ",t])[0];if(f=t.lineIndent===-1?v[0].length+2:t.lineIndent||0){var S=Array(f).join(" "),b=[];v.map(function(E){(E=E.split(/\s*\n/)).length>1?b=b.concat(E.map(function(U,R){return(R&&U.length?`
`:"")+U})):b.push(E[0])}),v=b,f=gh.apply(this,[S,t])}for(s=0,l=v.length;s<l;s++){var A=0;if(n=v[s],f&&n[0]==`
`&&(n=n.substr(1),A=1),x+p+(w=(a=Bl.apply(this,[n,t])).reduce(function(E,U){return E+U},0))>r||A){if(w>r){for(c=xh.apply(this,[n,a,r-(x+p),r]),d.push(c.shift()),d=[c.pop()];c.length;)g.push([c.shift()]);w=a.slice(n.length-(d[0]?d[0].length:0)).reduce(function(E,U){return E+U},0)}else d=[n];g.push(d),x=w+f,p=_}else d.push(n),x+=p+w,p=_}return u=f?function(E,U){return(U?S:"")+E.join(" ")}:function(E){return E.join(" ")},g.map(u)},ws.splitTextToSize=function(e,r,t){var n,a=(t=t||{}).fontSize||this.internal.getFontSize(),s=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var g=this.internal.getFont(d.fontName,d.fontStyle);return g.metadata.Unicode?{widths:g.metadata.Unicode.widths||{0:1},kerning:g.metadata.Unicode.kerning||{}}:{font:g.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var l=1*this.internal.scaleFactor*r/a;s.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/a:0,s.lineIndent=t.lineIndent;var c,f,u=[];for(c=0,f=n.length;c<f;c++)u=u.concat(vh.apply(this,[n[c],l,s]));return u},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var r="klmnopqrstuvwxyz",t={},n={},a=0;a<r.length;a++)t[r[a]]="0123456789abcdef"[a],n["0123456789abcdef"[a]]=r[a];var s=function(g){return"0x"+parseInt(g,10).toString(16)},l=e.__fontmetrics__.compress=function(g){var x,p,w,v,_=["{"];for(var S in g){if(x=g[S],isNaN(parseInt(S,10))?p="'"+S+"'":(S=parseInt(S,10),p=(p=s(S).slice(2)).slice(0,-1)+n[p.slice(-1)]),typeof x=="number")x<0?(w=s(x).slice(3),v="-"):(w=s(x).slice(2),v=""),w=v+w.slice(0,-1)+n[w.slice(-1)];else{if(rr(x)!=="object")throw new Error("Don't know what to do with value type "+rr(x)+".");w=l(x)}_.push(p+w)}return _.push("}"),_.join("")},c=e.__fontmetrics__.uncompress=function(g){if(typeof g!="string")throw new Error("Invalid argument passed to uncompress.");for(var x,p,w,v,_={},S=1,b=_,A=[],E="",U="",R=g.length-1,L=1;L<R;L+=1)(v=g[L])=="'"?x?(w=x.join(""),x=void 0):x=[]:x?x.push(v):v=="{"?(A.push([b,w]),b={},w=void 0):v=="}"?((p=A.pop())[0][p[1]]=b,w=void 0,b=p[0]):v=="-"?S=-1:w===void 0?t.hasOwnProperty(v)?(E+=t[v],w=parseInt(E,16)*S,S=1,E=""):E+=v:t.hasOwnProperty(v)?(U+=t[v],b[w]=parseInt(U,16)*S,S=1,w=void 0,U=""):U+=v;return _},f={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:f,"Courier-Bold":f,"Courier-BoldOblique":f,"Courier-Oblique":f,Helvetica:f,"Helvetica-Bold":f,"Helvetica-BoldOblique":f,"Helvetica-Oblique":f,"Times-Roman":f,"Times-Bold":f,"Times-BoldItalic":f,"Times-Italic":f}},d={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(g){var x=g.font,p=d.Unicode[x.postScriptName];p&&(x.metadata.Unicode={},x.metadata.Unicode.widths=p.widths,x.metadata.Unicode.kerning=p.kerning);var w=u.Unicode[x.postScriptName];w&&(x.metadata.Unicode.encoding=w,x.encoding=w.codePages[0])}])}(mt.API),function(e){var r=function(t){for(var n=t.length,a=new Uint8Array(n),s=0;s<n;s++)a[s]=t.charCodeAt(s);return a};e.API.events.push(["addFont",function(t){var n=void 0,a=t.font,s=t.instance;if(!a.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(n=s.existsFileInVFS(a.postScriptName)===!1?s.loadFile(a.postScriptName):s.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(l,c){c=/^\x00\x01\x00\x00/.test(c)?r(c):r(yo(c)),l.metadata=e.API.TTFFont.open(c),l.metadata.Unicode=l.metadata.Unicode||{encoding:{},kerning:{},widths:[]},l.metadata.glyIdsUsed=[0]})(a,n)}}])}(mt),function(e){function r(){return(xt.canvg?Promise.resolve(xt.canvg):Ec(()=>import("./index.es-CYUj7cQv.js"),__vite__mapDeps([0,1,2]))).catch(function(t){return Promise.reject(new Error("Could not load canvg: "+t))}).then(function(t){return t.default?t.default:t})}mt.API.addSvgAsImage=function(t,n,a,s,l,c,f,u){if(isNaN(n)||isNaN(a))throw tr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(s)||isNaN(l))throw tr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var d=document.createElement("canvas");d.width=s,d.height=l;var g=d.getContext("2d");g.fillStyle="#fff",g.fillRect(0,0,d.width,d.height);var x={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},p=this;return r().then(function(w){return w.fromString(g,t,x)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(w){return w.render(x)}).then(function(){p.addImage(d.toDataURL("image/jpeg",1),n,a,s,l,f,u)})}}(),mt.API.putTotalPages=function(e){var r,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(r=new RegExp(e,"g"),t=this.internal.getNumberOfPages()):(r=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(r,t);return this},mt.API.viewerPreferences=function(e,r){var t;e=e||{},r=r||!1;var n,a,s,l={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},c=Object.keys(l),f=[],u=0,d=0,g=0;function x(w,v){var _,S=!1;for(_=0;_<w.length;_+=1)w[_]===v&&(S=!0);return S}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(l)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,e==="reset"||r===!0){var p=c.length;for(g=0;g<p;g+=1)t[c[g]].value=t[c[g]].defaultValue,t[c[g]].explicitSet=!1}if(rr(e)==="object"){for(a in e)if(s=e[a],x(c,a)&&s!==void 0){if(t[a].type==="boolean"&&typeof s=="boolean")t[a].value=s;else if(t[a].type==="name"&&x(t[a].valueSet,s))t[a].value=s;else if(t[a].type==="integer"&&Number.isInteger(s))t[a].value=s;else if(t[a].type==="array"){for(u=0;u<s.length;u+=1)if(n=!0,s[u].length===1&&typeof s[u][0]=="number")f.push(String(s[u]-1));else if(s[u].length>1){for(d=0;d<s[u].length;d+=1)typeof s[u][d]!="number"&&(n=!1);n===!0&&f.push([s[u][0]-1,s[u][1]-1].join(" "))}t[a].value="["+f.join(" ")+"]"}else t[a].value=t[a].defaultValue;t[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var w,v=[];for(w in t)t[w].explicitSet===!0&&(t[w].type==="name"?v.push("/"+w+" /"+t[w].value):v.push("/"+w+" "+t[w].value));v.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+v.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},function(e){var r=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(n)),l=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),c=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),f=unescape(encodeURIComponent("</x:xmpmeta>")),u=s.length+l.length+c.length+a.length+f.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(a+s+l+c+f),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,a){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",r)),this}}(mt.API),function(e){var r=e.API,t=r.pdfEscape16=function(s,l){for(var c,f=l.metadata.Unicode.widths,u=["","0","00","000","0000"],d=[""],g=0,x=s.length;g<x;++g){if(c=l.metadata.characterToGlyph(s.charCodeAt(g)),l.metadata.glyIdsUsed.push(c),l.metadata.toUnicode[c]=s.charCodeAt(g),f.indexOf(c)==-1&&(f.push(c),f.push([parseInt(l.metadata.widthOfGlyph(c),10)])),c=="0")return d.join("");c=c.toString(16),d.push(u[4-c.length],c)}return d.join("")},n=function(s){var l,c,f,u,d,g,x;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,f=[],g=0,x=(c=Object.keys(s).sort(function(p,w){return p-w})).length;g<x;g++)l=c[g],f.length>=100&&(d+=`
`+f.length+` beginbfchar
`+f.join(`
`)+`
endbfchar`,f=[]),s[l]!==void 0&&s[l]!==null&&typeof s[l].toString=="function"&&(u=("0000"+s[l].toString(16)).slice(-4),l=("0000"+(+l).toString(16)).slice(-4),f.push("<"+l+"><"+u+">"));return f.length&&(d+=`
`+f.length+` beginbfchar
`+f.join(`
`)+`
endbfchar
`),d+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};r.events.push(["putFont",function(s){(function(l){var c=l.font,f=l.out,u=l.newObject,d=l.putStream;if(c.metadata instanceof e.API.TTFFont&&c.encoding==="Identity-H"){for(var g=c.metadata.Unicode.widths,x=c.metadata.subset.encode(c.metadata.glyIdsUsed,1),p="",w=0;w<x.length;w++)p+=String.fromCharCode(x[w]);var v=u();d({data:p,addLength1:!0,objectId:v}),f("endobj");var _=u();d({data:n(c.metadata.toUnicode),addLength1:!0,objectId:_}),f("endobj");var S=u();f("<<"),f("/Type /FontDescriptor"),f("/FontName /"+ks(c.fontName)),f("/FontFile2 "+v+" 0 R"),f("/FontBBox "+e.API.PDFObject.convert(c.metadata.bbox)),f("/Flags "+c.metadata.flags),f("/StemV "+c.metadata.stemV),f("/ItalicAngle "+c.metadata.italicAngle),f("/Ascent "+c.metadata.ascender),f("/Descent "+c.metadata.decender),f("/CapHeight "+c.metadata.capHeight),f(">>"),f("endobj");var b=u();f("<<"),f("/Type /Font"),f("/BaseFont /"+ks(c.fontName)),f("/FontDescriptor "+S+" 0 R"),f("/W "+e.API.PDFObject.convert(g)),f("/CIDToGIDMap /Identity"),f("/DW 1000"),f("/Subtype /CIDFontType2"),f("/CIDSystemInfo"),f("<<"),f("/Supplement 0"),f("/Registry (Adobe)"),f("/Ordering ("+c.encoding+")"),f(">>"),f(">>"),f("endobj"),c.objectNumber=u(),f("<<"),f("/Type /Font"),f("/Subtype /Type0"),f("/ToUnicode "+_+" 0 R"),f("/BaseFont /"+ks(c.fontName)),f("/Encoding /"+c.encoding),f("/DescendantFonts ["+b+" 0 R]"),f(">>"),f("endobj"),c.isAlreadyPutted=!0}})(s)}]),r.events.push(["putFont",function(s){(function(l){var c=l.font,f=l.out,u=l.newObject,d=l.putStream;if(c.metadata instanceof e.API.TTFFont&&c.encoding==="WinAnsiEncoding"){for(var g=c.metadata.rawData,x="",p=0;p<g.length;p++)x+=String.fromCharCode(g[p]);var w=u();d({data:x,addLength1:!0,objectId:w}),f("endobj");var v=u();d({data:n(c.metadata.toUnicode),addLength1:!0,objectId:v}),f("endobj");var _=u();f("<<"),f("/Descent "+c.metadata.decender),f("/CapHeight "+c.metadata.capHeight),f("/StemV "+c.metadata.stemV),f("/Type /FontDescriptor"),f("/FontFile2 "+w+" 0 R"),f("/Flags 96"),f("/FontBBox "+e.API.PDFObject.convert(c.metadata.bbox)),f("/FontName /"+ks(c.fontName)),f("/ItalicAngle "+c.metadata.italicAngle),f("/Ascent "+c.metadata.ascender),f(">>"),f("endobj"),c.objectNumber=u();for(var S=0;S<c.metadata.hmtx.widths.length;S++)c.metadata.hmtx.widths[S]=parseInt(c.metadata.hmtx.widths[S]*(1e3/c.metadata.head.unitsPerEm));f("<</Subtype/TrueType/Type/Font/ToUnicode "+v+" 0 R/BaseFont/"+ks(c.fontName)+"/FontDescriptor "+_+" 0 R/Encoding/"+c.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(c.metadata.hmtx.widths)+">>"),f("endobj"),c.isAlreadyPutted=!0}})(s)}]);var a=function(s){var l,c=s.text||"",f=s.x,u=s.y,d=s.options||{},g=s.mutex||{},x=g.pdfEscape,p=g.activeFontKey,w=g.fonts,v=p,_="",S=0,b="",A=w[v].encoding;if(w[v].encoding!=="Identity-H")return{text:c,x:f,y:u,options:d,mutex:g};for(b=c,v=p,Array.isArray(c)&&(b=c[0]),S=0;S<b.length;S+=1)w[v].metadata.hasOwnProperty("cmap")&&(l=w[v].metadata.cmap.unicode.codeMap[b[S].charCodeAt(0)]),l||b[S].charCodeAt(0)<256&&w[v].metadata.hasOwnProperty("Unicode")?_+=b[S]:_+="";var E="";return parseInt(v.slice(1))<14||A==="WinAnsiEncoding"?E=x(_,v).split("").map(function(U){return U.charCodeAt(0).toString(16)}).join(""):A==="Identity-H"&&(E=t(_,w[v])),g.isHex=!0,{text:E,x:f,y:u,options:d,mutex:g}};r.events.push(["postProcessText",function(s){var l=s.text||"",c=[],f={text:l,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(l)){var u=0;for(u=0;u<l.length;u+=1)Array.isArray(l[u])&&l[u].length===3?c.push([a(Object.assign({},f,{text:l[u][0]})).text,l[u][1],l[u][2]]):c.push(a(Object.assign({},f,{text:l[u]})).text);s.text=c}else s.text=a(Object.assign({},f,{text:l})).text}])}(mt),function(e){var r=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(t){return r.call(this),this.internal.vFS[t]!==void 0},e.addFileToVFS=function(t,n){return r.call(this),this.internal.vFS[t]=n,this},e.getFileFromVFS=function(t){return r.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}}(mt.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var a,s,l,c,f,u,d,g=r,x=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],p=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],w={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},v={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},_=["(",")","(","<",">","<","[","]","[","{","}","{","Â«","Â»","Â«","â€¹","â€º","â€¹","â…","â†","â…","â½","â¾","â½","â‚","â‚Ž","â‚","â‰¤","â‰¥","â‰¤","âŒ©","âŒª","âŒ©","ï¹™","ï¹š","ï¹™","ï¹›","ï¹œ","ï¹›","ï¹","ï¹ž","ï¹","ï¹¤","ï¹¥","ï¹¤"],S=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),b=!1,A=0;this.__bidiEngine__={};var E=function(k){var T=k.charCodeAt(),H=T>>8,G=v[H];return G!==void 0?g[256*G+(255&T)]:H===252||H===253?"AL":S.test(H)?"L":H===8?"R":"N"},U=function(k){for(var T,H=0;H<k.length;H++){if((T=E(k.charAt(H)))==="L")return!1;if(T==="R")return!0}return!1},R=function(k,T,H,G){var ce,J,Q,oe,ae=T[G];switch(ae){case"L":case"R":b=!1;break;case"N":case"AN":break;case"EN":b&&(ae="AN");break;case"AL":b=!0,ae="R";break;case"WS":ae="N";break;case"CS":G<1||G+1>=T.length||(ce=H[G-1])!=="EN"&&ce!=="AN"||(J=T[G+1])!=="EN"&&J!=="AN"?ae="N":b&&(J="AN"),ae=J===ce?J:"N";break;case"ES":ae=(ce=G>0?H[G-1]:"B")==="EN"&&G+1<T.length&&T[G+1]==="EN"?"EN":"N";break;case"ET":if(G>0&&H[G-1]==="EN"){ae="EN";break}if(b){ae="N";break}for(Q=G+1,oe=T.length;Q<oe&&T[Q]==="ET";)Q++;ae=Q<oe&&T[Q]==="EN"?"EN":"N";break;case"NSM":if(l&&!c){for(oe=T.length,Q=G+1;Q<oe&&T[Q]==="NSM";)Q++;if(Q<oe){var ge=k[G],ve=ge>=1425&&ge<=2303||ge===64286;if(ce=T[Q],ve&&(ce==="R"||ce==="AL")){ae="R";break}}}ae=G<1||(ce=T[G-1])==="B"?"N":H[G-1];break;case"B":b=!1,a=!0,ae=A;break;case"S":s=!0,ae="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":b=!1;break;case"BN":ae="N"}return ae},L=function(k,T,H){var G=k.split("");return H&&C(G,H,{hiLevel:A}),G.reverse(),T&&T.reverse(),G.join("")},C=function(k,T,H){var G,ce,J,Q,oe,ae=-1,ge=k.length,ve=0,j=[],O=A?p:x,I=[];for(b=!1,a=!1,s=!1,ce=0;ce<ge;ce++)I[ce]=E(k[ce]);for(J=0;J<ge;J++){if(oe=ve,j[J]=R(k,I,j,J),G=240&(ve=O[oe][w[j[J]]]),ve&=15,T[J]=Q=O[ve][5],G>0)if(G===16){for(ce=ae;ce<J;ce++)T[ce]=1;ae=-1}else ae=-1;if(O[ve][6])ae===-1&&(ae=J);else if(ae>-1){for(ce=ae;ce<J;ce++)T[ce]=Q;ae=-1}I[J]==="B"&&(T[J]=0),H.hiLevel|=Q}s&&function(D,X,fe){for(var he=0;he<fe;he++)if(D[he]==="S"){X[he]=A;for(var ue=he-1;ue>=0&&D[ue]==="WS";ue--)X[ue]=A}}(I,T,ge)},P=function(k,T,H,G,ce){if(!(ce.hiLevel<k)){if(k===1&&A===1&&!a)return T.reverse(),void(H&&H.reverse());for(var J,Q,oe,ae,ge=T.length,ve=0;ve<ge;){if(G[ve]>=k){for(oe=ve+1;oe<ge&&G[oe]>=k;)oe++;for(ae=ve,Q=oe-1;ae<Q;ae++,Q--)J=T[ae],T[ae]=T[Q],T[Q]=J,H&&(J=H[ae],H[ae]=H[Q],H[Q]=J);ve=oe}ve++}}},W=function(k,T,H){var G=k.split(""),ce={hiLevel:A};return H||(H=[]),C(G,H,ce),function(J,Q,oe){if(oe.hiLevel!==0&&d)for(var ae,ge=0;ge<J.length;ge++)Q[ge]===1&&(ae=_.indexOf(J[ge]))>=0&&(J[ge]=_[ae+1])}(G,H,ce),P(2,G,T,H,ce),P(1,G,T,H,ce),G.join("")};return this.__bidiEngine__.doBidiReorder=function(k,T,H){if(function(ce,J){if(J)for(var Q=0;Q<ce.length;Q++)J[Q]=Q;c===void 0&&(c=U(ce)),u===void 0&&(u=U(ce))}(k,T),l||!f||u)if(l&&f&&c^u)A=c?1:0,k=L(k,T,H);else if(!l&&f&&u)A=c?1:0,k=W(k,T,H),k=L(k,T);else if(!l||c||f||u){if(l&&!f&&c^u)k=L(k,T),c?(A=0,k=W(k,T,H)):(A=1,k=W(k,T,H),k=L(k,T));else if(l&&c&&!f&&u)A=1,k=W(k,T,H),k=L(k,T);else if(!l&&!f&&c^u){var G=d;c?(A=1,k=W(k,T,H),A=0,d=!1,k=W(k,T,H),d=G):(A=0,k=W(k,T,H),k=L(k,T),A=1,d=!1,k=W(k,T,H),d=G,k=L(k,T))}}else A=0,k=W(k,T,H);else A=c?1:0,k=W(k,T,H);return k},this.__bidiEngine__.setOptions=function(k){k&&(l=k.isInputVisual,f=k.isOutputVisual,c=k.isInputRtl,u=k.isOutputRtl,d=k.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var r=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var a=n.text,s=(n.x,n.y,n.options||{}),l=(n.mutex,s.lang,[]);if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,t.setOptions(s),Object.prototype.toString.call(a)==="[object Array]"){var c=0;for(l=[],c=0;c<a.length;c+=1)Object.prototype.toString.call(a[c])==="[object Array]"?l.push([t.doBidiReorder(a[c][0]),a[c][1],a[c][2]]):l.push([t.doBidiReorder(a[c])]);n.text=l}else n.text=t.doBidiReorder(a);t.setOptions({isInputVisual:!0})}])}(mt),mt.API.TTFFont=function(){function e(r){var t;if(this.rawData=r,t=this.contents=new vi(r),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new Nm(this),this.registerTTF()}return e.open=function(r){return new e(r)},e.prototype.parse=function(){return this.directory=new lm(this.contents),this.head=new fm(this),this.name=new mm(this),this.cmap=new Pu(this),this.toUnicode={},this.hhea=new hm(this),this.maxp=new gm(this),this.hmtx=new xm(this),this.post=new dm(this),this.os2=new um(this),this.loca=new bm(this),this.glyf=new vm(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var r,t,n,a,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var l,c,f,u;for(u=[],l=0,c=(f=this.bbox).length;l<c;l++)r=f[l],u.push(Math.round(r*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(n=255&(a=this.post.italic_angle),32768&(t=a>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(r){var t;return((t=this.cmap.unicode)!=null?t.codeMap[r]:void 0)||0},e.prototype.widthOfGlyph=function(r){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(r).advance*t},e.prototype.widthOfString=function(r,t,n){var a,s,l,c;for(l=0,s=0,c=(r=""+r).length;0<=c?s<c:s>c;s=0<=c?++s:--s)a=r.charCodeAt(s),l+=this.widthOfGlyph(this.characterToGlyph(a))+n*(1e3/t)||0;return l*(t/1e3)},e.prototype.lineHeight=function(r,t){var n;return t==null&&(t=!1),n=t?this.lineGap:0,(this.ascender+n-this.decender)/1e3*r},e}();var ma,vi=function(){function e(r){this.data=r??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(r){return this.data[this.pos++]=r},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(r){return this.writeByte(r>>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},e.prototype.readInt32=function(){var r;return(r=this.readUInt32())>=2147483648?r-4294967296:r},e.prototype.writeInt32=function(r){return r<0&&(r+=4294967296),this.writeUInt32(r)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(r){return this.writeByte(r>>8&255),this.writeByte(255&r)},e.prototype.readInt16=function(){var r;return(r=this.readUInt16())>=32768?r-65536:r},e.prototype.writeInt16=function(r){return r<0&&(r+=65536),this.writeUInt16(r)},e.prototype.readString=function(r){var t,n;for(n=[],t=0;0<=r?t<r:t>r;t=0<=r?++t:--t)n[t]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(r){var t,n,a;for(a=[],t=0,n=r.length;0<=n?t<n:t>n;t=0<=n?++t:--t)a.push(this.writeByte(r.charCodeAt(t)));return a},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(r){return this.writeInt16(r)},e.prototype.readLongLong=function(){var r,t,n,a,s,l,c,f;return r=this.readByte(),t=this.readByte(),n=this.readByte(),a=this.readByte(),s=this.readByte(),l=this.readByte(),c=this.readByte(),f=this.readByte(),128&r?-1*(72057594037927940*(255^r)+281474976710656*(255^t)+1099511627776*(255^n)+4294967296*(255^a)+16777216*(255^s)+65536*(255^l)+256*(255^c)+(255^f)+1):72057594037927940*r+281474976710656*t+1099511627776*n+4294967296*a+16777216*s+65536*l+256*c+f},e.prototype.writeLongLong=function(r){var t,n;return t=Math.floor(r/4294967296),n=4294967295&r,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(r){return this.writeInt32(r)},e.prototype.read=function(r){var t,n;for(t=[],n=0;0<=r?n<r:n>r;n=0<=r?++n:--n)t.push(this.readByte());return t},e.prototype.write=function(r){var t,n,a,s;for(s=[],n=0,a=r.length;n<a;n++)t=r[n],s.push(this.writeByte(t));return s},e}(),lm=function(){var e;function r(t){var n,a,s;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},a=0,s=this.tableCount;0<=s?a<s:a>s;a=0<=s?++a:--a)n={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[n.tag]=n}return r.prototype.encode=function(t){var n,a,s,l,c,f,u,d,g,x,p,w,v;for(v in p=Object.keys(t).length,f=Math.log(2),g=16*Math.floor(Math.log(p)/f),l=Math.floor(g/f),d=16*p-g,(a=new vi).writeInt(this.scalarType),a.writeShort(p),a.writeShort(g),a.writeShort(l),a.writeShort(d),s=16*p,u=a.pos+s,c=null,w=[],t)for(x=t[v],a.writeString(v),a.writeInt(e(x)),a.writeInt(u),a.writeInt(x.length),w=w.concat(x),v==="head"&&(c=u),u+=x.length;u%4;)w.push(0),u++;return a.write(w),n=2981146554-e(a.data),a.pos=c+8,a.writeUInt32(n),a.data},e=function(t){var n,a,s,l;for(t=Ou.call(t);t.length%4;)t.push(0);for(s=new vi(t),a=0,n=0,l=t.length;n<l;n=n+=4)a+=s.readUInt32();return 4294967295&a},r}(),cm={}.hasOwnProperty,Ea=function(e,r){for(var t in r)cm.call(r,t)&&(e[t]=r[t]);function n(){this.constructor=e}return n.prototype=r.prototype,e.prototype=new n,e.__super__=r.prototype,e};ma=function(){function e(r){var t;this.file=r,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var fm=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return Ea(r,ma),r.prototype.tag="head",r.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},r.prototype.encode=function(t){var n;return(n=new vi).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(t),n.writeShort(this.glyphDataFormat),n.data},r}(),bh=function(){function e(r,t){var n,a,s,l,c,f,u,d,g,x,p,w,v,_,S,b,A;switch(this.platformID=r.readUInt16(),this.encodingID=r.readShort(),this.offset=t+r.readInt(),g=r.pos,r.pos=this.offset,this.format=r.readUInt16(),this.length=r.readUInt16(),this.language=r.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(f=0;f<256;++f)this.codeMap[f]=r.readByte();break;case 4:for(p=r.readUInt16(),x=p/2,r.pos+=6,s=function(){var E,U;for(U=[],f=E=0;0<=x?E<x:E>x;f=0<=x?++E:--E)U.push(r.readUInt16());return U}(),r.pos+=2,v=function(){var E,U;for(U=[],f=E=0;0<=x?E<x:E>x;f=0<=x?++E:--E)U.push(r.readUInt16());return U}(),u=function(){var E,U;for(U=[],f=E=0;0<=x?E<x:E>x;f=0<=x?++E:--E)U.push(r.readUInt16());return U}(),d=function(){var E,U;for(U=[],f=E=0;0<=x?E<x:E>x;f=0<=x?++E:--E)U.push(r.readUInt16());return U}(),a=(this.length-r.pos+this.offset)/2,c=function(){var E,U;for(U=[],f=E=0;0<=a?E<a:E>a;f=0<=a?++E:--E)U.push(r.readUInt16());return U}(),f=S=0,A=s.length;S<A;f=++S)for(_=s[f],n=b=w=v[f];w<=_?b<=_:b>=_;n=w<=_?++b:--b)d[f]===0?l=n+u[f]:(l=c[d[f]/2+(n-w)-(x-f)]||0)!==0&&(l+=u[f]),this.codeMap[n]=65535&l}r.pos=g}return e.encode=function(r,t){var n,a,s,l,c,f,u,d,g,x,p,w,v,_,S,b,A,E,U,R,L,C,P,W,k,T,H,G,ce,J,Q,oe,ae,ge,ve,j,O,I,D,X,fe,he,ue,be,Oe,Me;switch(G=new vi,l=Object.keys(r).sort(function(Ve,Je){return Ve-Je}),t){case"macroman":for(v=0,_=function(){var Ve=[];for(w=0;w<256;++w)Ve.push(0);return Ve}(),b={0:0},s={},ce=0,ae=l.length;ce<ae;ce++)b[ue=r[a=l[ce]]]==null&&(b[ue]=++v),s[a]={old:r[a],new:b[r[a]]},_[a]=b[r[a]];return G.writeUInt16(1),G.writeUInt16(0),G.writeUInt32(12),G.writeUInt16(0),G.writeUInt16(262),G.writeUInt16(0),G.write(_),{charMap:s,subtable:G.data,maxGlyphID:v+1};case"unicode":for(T=[],g=[],A=0,b={},n={},S=u=null,J=0,ge=l.length;J<ge;J++)b[U=r[a=l[J]]]==null&&(b[U]=++A),n[a]={old:U,new:b[U]},c=b[U]-a,S!=null&&c===u||(S&&g.push(S),T.push(a),u=c),S=a;for(S&&g.push(S),g.push(65535),T.push(65535),W=2*(P=T.length),C=2*Math.pow(Math.log(P)/Math.LN2,2),x=Math.log(C/2)/Math.LN2,L=2*P-C,f=[],R=[],p=[],w=Q=0,ve=T.length;Q<ve;w=++Q){if(k=T[w],d=g[w],k===65535){f.push(0),R.push(0);break}if(k-(H=n[k].new)>=32768)for(f.push(0),R.push(2*(p.length+P-w)),a=oe=k;k<=d?oe<=d:oe>=d;a=k<=d?++oe:--oe)p.push(n[a].new);else f.push(H-k),R.push(0)}for(G.writeUInt16(3),G.writeUInt16(1),G.writeUInt32(12),G.writeUInt16(4),G.writeUInt16(16+8*P+2*p.length),G.writeUInt16(0),G.writeUInt16(W),G.writeUInt16(C),G.writeUInt16(x),G.writeUInt16(L),fe=0,j=g.length;fe<j;fe++)a=g[fe],G.writeUInt16(a);for(G.writeUInt16(0),he=0,O=T.length;he<O;he++)a=T[he],G.writeUInt16(a);for(be=0,I=f.length;be<I;be++)c=f[be],G.writeUInt16(c);for(Oe=0,D=R.length;Oe<D;Oe++)E=R[Oe],G.writeUInt16(E);for(Me=0,X=p.length;Me<X;Me++)v=p[Me],G.writeUInt16(v);return{charMap:n,subtable:G.data,maxGlyphID:A+1}}},e}(),Pu=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return Ea(r,ma),r.prototype.tag="cmap",r.prototype.parse=function(t){var n,a,s;for(t.pos=this.offset,this.version=t.readUInt16(),s=t.readUInt16(),this.tables=[],this.unicode=null,a=0;0<=s?a<s:a>s;a=0<=s?++a:--a)n=new bh(t,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},r.encode=function(t,n){var a,s;return n==null&&(n="macroman"),a=bh.encode(t,n),(s=new vi).writeUInt16(0),s.writeUInt16(1),a.table=s.data.concat(a.subtable),a},r}(),hm=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return Ea(r,ma),r.prototype.tag="hhea",r.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},r}(),um=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return Ea(r,ma),r.prototype.tag="OS/2",r.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var n,a;for(a=[],n=0;n<10;++n)a.push(t.readByte());return a}(),this.charRange=function(){var n,a;for(a=[],n=0;n<4;++n)a.push(t.readInt());return a}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var n,a;for(a=[],n=0;n<2;n=++n)a.push(t.readInt());return a}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},r}(),dm=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return Ea(r,ma),r.prototype.tag="post",r.prototype.parse=function(t){var n,a,s;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:break;case 131072:var l;for(a=t.readUInt16(),this.glyphNameIndex=[],l=0;0<=a?l<a:l>a;l=0<=a?++l:--l)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],s=[];t.pos<this.offset+this.length;)n=t.readByte(),s.push(this.names.push(t.readString(n)));return s;case 151552:return a=t.readUInt16(),this.offsets=t.read(a);case 196608:break;case 262144:return this.map=(function(){var c,f,u;for(u=[],l=c=0,f=this.file.maxp.numGlyphs;0<=f?c<f:c>f;l=0<=f?++c:--c)u.push(t.readUInt32());return u}).call(this)}},r}(),pm=function(e,r){this.raw=e,this.length=e.length,this.platformID=r.platformID,this.encodingID=r.encodingID,this.languageID=r.languageID},mm=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return Ea(r,ma),r.prototype.tag="name",r.prototype.parse=function(t){var n,a,s,l,c,f,u,d,g,x,p;for(t.pos=this.offset,t.readShort(),n=t.readShort(),f=t.readShort(),a=[],l=0;0<=n?l<n:l>n;l=0<=n?++l:--l)a.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+f+t.readShort()});for(u={},l=g=0,x=a.length;g<x;l=++g)s=a[l],t.pos=s.offset,d=t.readString(s.length),c=new pm(d,s),u[p=s.nameID]==null&&(u[p]=[]),u[s.nameID].push(c);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},r}(),gm=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return Ea(r,ma),r.prototype.tag="maxp",r.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},r}(),xm=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return Ea(r,ma),r.prototype.tag="hmtx",r.prototype.parse=function(t){var n,a,s,l,c,f,u;for(t.pos=this.offset,this.metrics=[],n=0,f=this.file.hhea.numberOfMetrics;0<=f?n<f:n>f;n=0<=f?++n:--n)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var d,g;for(g=[],n=d=0;0<=s?d<s:d>s;n=0<=s?++d:--d)g.push(t.readInt16());return g}(),this.widths=(function(){var d,g,x,p;for(p=[],d=0,g=(x=this.metrics).length;d<g;d++)l=x[d],p.push(l.advance);return p}).call(this),a=this.widths[this.widths.length-1],u=[],n=c=0;0<=s?c<s:c>s;n=0<=s?++c:--c)u.push(this.widths.push(a));return u},r.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},r}(),Ou=[].slice,vm=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return Ea(r,ma),r.prototype.tag="glyf",r.prototype.parse=function(){return this.cache={}},r.prototype.glyphFor=function(t){var n,a,s,l,c,f,u,d,g,x;return t in this.cache?this.cache[t]:(l=this.file.loca,n=this.file.contents,a=l.indexOf(t),(s=l.lengthOf(t))===0?this.cache[t]=null:(n.pos=this.offset+a,c=(f=new vi(n.read(s))).readShort(),d=f.readShort(),x=f.readShort(),u=f.readShort(),g=f.readShort(),this.cache[t]=c===-1?new wm(f,d,x,u,g):new ym(f,c,d,x,u,g),this.cache[t]))},r.prototype.encode=function(t,n,a){var s,l,c,f,u;for(c=[],l=[],f=0,u=n.length;f<u;f++)s=t[n[f]],l.push(c.length),s&&(c=c.concat(s.encode(a)));return l.push(c.length),{table:c,offsets:l}},r}(),ym=function(){function e(r,t,n,a,s,l){this.raw=r,this.numberOfContours=t,this.xMin=n,this.yMin=a,this.xMax=s,this.yMax=l,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),wm=function(){function e(r,t,n,a,s){var l,c;for(this.raw=r,this.xMin=t,this.yMin=n,this.xMax=a,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],l=this.raw;c=l.readShort(),this.glyphOffsets.push(l.pos),this.glyphIDs.push(l.readUInt16()),32&c;)l.pos+=1&c?4:2,128&c?l.pos+=8:64&c?l.pos+=4:8&c&&(l.pos+=2)}return e.prototype.encode=function(){var r,t,n;for(t=new vi(Ou.call(this.raw.data)),r=0,n=this.glyphIDs.length;r<n;++r)t.pos=this.glyphOffsets[r];return t.data},e}(),bm=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return Ea(r,ma),r.prototype.tag="loca",r.prototype.parse=function(t){var n,a;return t.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var s,l;for(l=[],a=0,s=this.length;a<s;a+=2)l.push(2*t.readUInt16());return l}).call(this):(function(){var s,l;for(l=[],a=0,s=this.length;a<s;a+=4)l.push(t.readUInt32());return l}).call(this)},r.prototype.indexOf=function(t){return this.offsets[t]},r.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},r.prototype.encode=function(t,n){for(var a=new Uint32Array(this.offsets.length),s=0,l=0,c=0;c<a.length;++c)if(a[c]=s,l<n.length&&n[l]==c){++l,a[c]=s;var f=this.offsets[c],u=this.offsets[c+1]-f;u>0&&(s+=u)}for(var d=new Array(4*a.length),g=0;g<a.length;++g)d[4*g+3]=255&a[g],d[4*g+2]=(65280&a[g])>>8,d[4*g+1]=(16711680&a[g])>>16,d[4*g]=(4278190080&a[g])>>24;return d},r}(),Nm=function(){function e(r){this.font=r,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var r,t,n,a,s;for(t in a=this.font.cmap.tables[0].codeMap,r={},s=this.subset)n=s[t],r[t]=a[n];return r},e.prototype.glyphsFor=function(r){var t,n,a,s,l,c,f;for(a={},l=0,c=r.length;l<c;l++)a[s=r[l]]=this.font.glyf.glyphFor(s);for(s in t=[],a)(n=a[s])!=null&&n.compound&&t.push.apply(t,n.glyphIDs);if(t.length>0)for(s in f=this.glyphsFor(t))n=f[s],a[s]=n;return a},e.prototype.encode=function(r,t){var n,a,s,l,c,f,u,d,g,x,p,w,v,_,S;for(a in n=Pu.encode(this.generateCmap(),"unicode"),l=this.glyphsFor(r),p={0:0},S=n.charMap)p[(f=S[a]).old]=f.new;for(w in x=n.maxGlyphID,l)w in p||(p[w]=x++);return d=function(b){var A,E;for(A in E={},b)E[b[A]]=A;return E}(p),g=Object.keys(d).sort(function(b,A){return b-A}),v=function(){var b,A,E;for(E=[],b=0,A=g.length;b<A;b++)c=g[b],E.push(d[c]);return E}(),s=this.font.glyf.encode(l,v,p),u=this.font.loca.encode(s.offsets,v),_={cmap:this.font.cmap.raw(),glyf:s.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(_["OS/2"]=this.font.os2.raw()),this.font.directory.encode(_)},e}();mt.API.PDFObject=function(){var e;function r(){}return e=function(t,n){return(Array(n+1).join("0")+t).slice(-n)},r.convert=function(t){var n,a,s,l;if(Array.isArray(t))return"["+function(){var c,f,u;for(u=[],c=0,f=t.length;c<f;c++)n=t[c],u.push(r.convert(n));return u}().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t!=null&&t.isString)return"("+t+")";if(t instanceof Date)return"(D:"+e(t.getUTCFullYear(),4)+e(t.getUTCMonth(),2)+e(t.getUTCDate(),2)+e(t.getUTCHours(),2)+e(t.getUTCMinutes(),2)+e(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(a in s=["<<"],t)l=t[a],s.push("/"+a+" "+r.convert(l));return s.push(">>"),s.join(`
`)}return""+t},r}();const _m=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:em,AcroFormAppearance:lt,AcroFormButton:Dr,AcroFormCheckBox:No,AcroFormChoiceField:Di,AcroFormComboBox:Mi,AcroFormEditBox:wo,AcroFormListBox:Ri,AcroFormPasswordField:_o,AcroFormPushButton:bo,AcroFormRadioButton:Bi,AcroFormTextField:gi,GState:Co,ShadingPattern:ui,TilingPattern:Ii,default:mt,jsPDF:mt},Symbol.toStringTag,{value:"Module"}));var Sm={exports:{}};const Am=r2(_m);/*!
 * 
 *               jsPDF AutoTable plugin v3.8.4
 *
 *               Copyright (c) 2024 Simon Bengtsson, https://github.com/simonbengtsson/jsPDF-AutoTable
 *               Licensed under the MIT License.
 *               http://opensource.org/licenses/mit-license
 *
 */(function(e,r){(function(n,a){e.exports=a(function(){try{return Am}catch{}}())})(typeof globalThis<"u"?globalThis:typeof nc<"u"?nc:typeof window<"u"?window:typeof self<"u"?self:nc,function(t){return function(){var n={172:function(c,f){var u=this&&this.__extends||function(){var x=function(p,w){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,_){v.__proto__=_}||function(v,_){for(var S in _)Object.prototype.hasOwnProperty.call(_,S)&&(v[S]=_[S])},x(p,w)};return function(p,w){if(typeof w!="function"&&w!==null)throw new TypeError("Class extends value "+String(w)+" is not a constructor or null");x(p,w);function v(){this.constructor=p}p.prototype=w===null?Object.create(w):(v.prototype=w.prototype,new v)}}();Object.defineProperty(f,"__esModule",{value:!0}),f.CellHookData=f.HookData=void 0;var d=function(){function x(p,w,v){this.table=w,this.pageNumber=w.pageNumber,this.pageCount=this.pageNumber,this.settings=w.settings,this.cursor=v,this.doc=p.getDocument()}return x}();f.HookData=d;var g=function(x){u(p,x);function p(w,v,_,S,b,A){var E=x.call(this,w,v,A)||this;return E.cell=_,E.row=S,E.column=b,E.section=S.section,E}return p}(d);f.CellHookData=g},340:function(c,f,u){Object.defineProperty(f,"__esModule",{value:!0});var d=u(4),g=u(136),x=u(744),p=u(776),w=u(664),v=u(972);function _(S){S.API.autoTable=function(){for(var b=[],A=0;A<arguments.length;A++)b[A]=arguments[A];var E;b.length===1?E=b[0]:(console.error("Use of deprecated autoTable initiation"),E=b[2]||{},E.columns=b[0],E.body=b[1]);var U=(0,p.parseInput)(this,E),R=(0,v.createTable)(this,U);return(0,w.drawTable)(this,R),this},S.API.lastAutoTable=!1,S.API.previousAutoTable=!1,S.API.autoTable.previous=!1,S.API.autoTableText=function(b,A,E,U){(0,g.default)(b,A,E,U,this)},S.API.autoTableSetDefaults=function(b){return x.DocHandler.setDefaults(b,this),this},S.autoTableSetDefaults=function(b,A){x.DocHandler.setDefaults(b,A)},S.API.autoTableHtmlToJson=function(b,A){var E;if(A===void 0&&(A=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var U=new x.DocHandler(this),R=(0,d.parseHtml)(U,b,window,A,!1),L=R.head,C=R.body,P=((E=L[0])===null||E===void 0?void 0:E.map(function(W){return W.content}))||[];return{columns:P,rows:C,data:C}},S.API.autoTableEndPosY=function(){console.error("Use of deprecated function: autoTableEndPosY. Use doc.lastAutoTable.finalY instead.");var b=this.lastAutoTable;return b&&b.finalY?b.finalY:0},S.API.autoTableAddPageContent=function(b){return console.error("Use of deprecated function: autoTableAddPageContent. Use jsPDF.autoTableSetDefaults({didDrawPage: () => {}}) instead."),S.API.autoTable.globalDefaults||(S.API.autoTable.globalDefaults={}),S.API.autoTable.globalDefaults.addPageContent=b,this},S.API.autoTableAddPage=function(){return console.error("Use of deprecated function: autoTableAddPage. Use doc.addPage()"),this.addPage(),this}}f.default=_},136:function(c,f){Object.defineProperty(f,"__esModule",{value:!0});function u(d,g,x,p,w){p=p||{};var v=1.15,_=w.internal.scaleFactor,S=w.internal.getFontSize()/_,b=w.getLineHeightFactor?w.getLineHeightFactor():v,A=S*b,E=/\r\n|\r|\n/g,U="",R=1;if((p.valign==="middle"||p.valign==="bottom"||p.halign==="center"||p.halign==="right")&&(U=typeof d=="string"?d.split(E):d,R=U.length||1),x+=S*(2-v),p.valign==="middle"?x-=R/2*A:p.valign==="bottom"&&(x-=R*A),p.halign==="center"||p.halign==="right"){var L=S;if(p.halign==="center"&&(L*=.5),U&&R>=1){for(var C=0;C<U.length;C++)w.text(U[C],g-w.getStringUnitWidth(U[C])*L,x),x+=A;return w}g-=w.getStringUnitWidth(d)*L}return p.halign==="justify"?w.text(d,g,x,{maxWidth:p.maxWidth||100,align:"justify"}):w.text(d,g,x),w}f.default=u},420:function(c,f){Object.defineProperty(f,"__esModule",{value:!0}),f.getPageAvailableWidth=f.parseSpacing=f.getFillStyle=f.addTableBorder=f.getStringWidth=void 0;function u(w,v,_){_.applyStyles(v,!0);var S=Array.isArray(w)?w:[w],b=S.map(function(A){return _.getTextWidth(A)}).reduce(function(A,E){return Math.max(A,E)},0);return b}f.getStringWidth=u;function d(w,v,_,S){var b=v.settings.tableLineWidth,A=v.settings.tableLineColor;w.applyStyles({lineWidth:b,lineColor:A});var E=g(b,!1);E&&w.rect(_.x,_.y,v.getWidth(w.pageSize().width),S.y-_.y,E)}f.addTableBorder=d;function g(w,v){var _=w>0,S=v||v===0;return _&&S?"DF":_?"S":S?"F":null}f.getFillStyle=g;function x(w,v){var _,S,b,A;if(w=w||v,Array.isArray(w)){if(w.length>=4)return{top:w[0],right:w[1],bottom:w[2],left:w[3]};if(w.length===3)return{top:w[0],right:w[1],bottom:w[2],left:w[1]};if(w.length===2)return{top:w[0],right:w[1],bottom:w[0],left:w[1]};w.length===1?w=w[0]:w=v}return typeof w=="object"?(typeof w.vertical=="number"&&(w.top=w.vertical,w.bottom=w.vertical),typeof w.horizontal=="number"&&(w.right=w.horizontal,w.left=w.horizontal),{left:(_=w.left)!==null&&_!==void 0?_:v,top:(S=w.top)!==null&&S!==void 0?S:v,right:(b=w.right)!==null&&b!==void 0?b:v,bottom:(A=w.bottom)!==null&&A!==void 0?A:v}):(typeof w!="number"&&(w=v),{top:w,right:w,bottom:w,left:w})}f.parseSpacing=x;function p(w,v){var _=x(v.settings.margin,0);return w.pageSize().width-(_.left+_.right)}f.getPageAvailableWidth=p},796:function(c,f){var u=this&&this.__extends||function(){var p=function(w,v){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_,S){_.__proto__=S}||function(_,S){for(var b in S)Object.prototype.hasOwnProperty.call(S,b)&&(_[b]=S[b])},p(w,v)};return function(w,v){if(typeof v!="function"&&v!==null)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");p(w,v);function _(){this.constructor=w}w.prototype=v===null?Object.create(v):(_.prototype=v.prototype,new _)}}();Object.defineProperty(f,"__esModule",{value:!0}),f.getTheme=f.defaultStyles=f.HtmlRowInput=void 0;var d=function(p){u(w,p);function w(v){var _=p.call(this)||this;return _._element=v,_}return w}(Array);f.HtmlRowInput=d;function g(p){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/p,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}f.defaultStyles=g;function x(p){var w={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return w[p]}f.getTheme=x},903:function(c,f,u){Object.defineProperty(f,"__esModule",{value:!0}),f.parseCss=void 0;var d=u(420);function g(_,S,b,A,E){var U={},R=1.3333333333333333,L=p(S,function(ae){return E.getComputedStyle(ae).backgroundColor});L!=null&&(U.fillColor=L);var C=p(S,function(ae){return E.getComputedStyle(ae).color});C!=null&&(U.textColor=C);var P=v(A,b);P&&(U.cellPadding=P);var W="borderTopColor",k=R*b,T=A.borderTopWidth;if(A.borderBottomWidth===T&&A.borderRightWidth===T&&A.borderLeftWidth===T){var H=(parseFloat(T)||0)/k;H&&(U.lineWidth=H)}else U.lineWidth={top:(parseFloat(A.borderTopWidth)||0)/k,right:(parseFloat(A.borderRightWidth)||0)/k,bottom:(parseFloat(A.borderBottomWidth)||0)/k,left:(parseFloat(A.borderLeftWidth)||0)/k},U.lineWidth.top||(U.lineWidth.right?W="borderRightColor":U.lineWidth.bottom?W="borderBottomColor":U.lineWidth.left&&(W="borderLeftColor"));var G=p(S,function(ae){return E.getComputedStyle(ae)[W]});G!=null&&(U.lineColor=G);var ce=["left","right","center","justify"];ce.indexOf(A.textAlign)!==-1&&(U.halign=A.textAlign),ce=["middle","bottom","top"],ce.indexOf(A.verticalAlign)!==-1&&(U.valign=A.verticalAlign);var J=parseInt(A.fontSize||"");isNaN(J)||(U.fontSize=J/R);var Q=x(A);Q&&(U.fontStyle=Q);var oe=(A.fontFamily||"").toLowerCase();return _.indexOf(oe)!==-1&&(U.font=oe),U}f.parseCss=g;function x(_){var S="";return(_.fontWeight==="bold"||_.fontWeight==="bolder"||parseInt(_.fontWeight)>=700)&&(S="bold"),(_.fontStyle==="italic"||_.fontStyle==="oblique")&&(S+="italic"),S}function p(_,S){var b=w(_,S);if(!b)return null;var A=b.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!A||!Array.isArray(A))return null;var E=[parseInt(A[1]),parseInt(A[2]),parseInt(A[3])],U=parseInt(A[4]);return U===0||isNaN(E[0])||isNaN(E[1])||isNaN(E[2])?null:E}function w(_,S){var b=S(_);return b==="rgba(0, 0, 0, 0)"||b==="transparent"||b==="initial"||b==="inherit"?_.parentElement==null?null:w(_.parentElement,S):b}function v(_,S){var b=[_.paddingTop,_.paddingRight,_.paddingBottom,_.paddingLeft],A=96/(72/S),E=(parseInt(_.lineHeight)-parseInt(_.fontSize))/S/2,U=b.map(function(L){return parseInt(L||"0")/A}),R=(0,d.parseSpacing)(U,0);return E>R.top&&(R.top=E),E>R.bottom&&(R.bottom=E),R}},744:function(c,f){Object.defineProperty(f,"__esModule",{value:!0}),f.DocHandler=void 0;var u={},d=function(){function g(x){this.jsPDFDocument=x,this.userStyles={textColor:x.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:x.internal.getFontSize(),fontStyle:x.internal.getFont().fontStyle,font:x.internal.getFont().fontName,lineWidth:x.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:x.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return g.setDefaults=function(x,p){p===void 0&&(p=null),p?p.__autoTableDocumentDefaults=x:u=x},g.unifyColor=function(x){return Array.isArray(x)?x:typeof x=="number"?[x,x,x]:typeof x=="string"?[x]:null},g.prototype.applyStyles=function(x,p){var w,v,_;p===void 0&&(p=!1),x.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(x.fontStyle);var S=this.jsPDFDocument.internal.getFont(),b=S.fontStyle,A=S.fontName;if(x.font&&(A=x.font),x.fontStyle){b=x.fontStyle;var E=this.getFontList()[A];E&&E.indexOf(b)===-1&&(this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(E[0]),b=E[0])}if(this.jsPDFDocument.setFont(A,b),x.fontSize&&this.jsPDFDocument.setFontSize(x.fontSize),!p){var U=g.unifyColor(x.fillColor);U&&(w=this.jsPDFDocument).setFillColor.apply(w,U),U=g.unifyColor(x.textColor),U&&(v=this.jsPDFDocument).setTextColor.apply(v,U),U=g.unifyColor(x.lineColor),U&&(_=this.jsPDFDocument).setDrawColor.apply(_,U),typeof x.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(x.lineWidth)}},g.prototype.splitTextToSize=function(x,p,w){return this.jsPDFDocument.splitTextToSize(x,p,w)},g.prototype.rect=function(x,p,w,v,_){return this.jsPDFDocument.rect(x,p,w,v,_)},g.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},g.prototype.getTextWidth=function(x){return this.jsPDFDocument.getTextWidth(x)},g.prototype.getDocument=function(){return this.jsPDFDocument},g.prototype.setPage=function(x){this.jsPDFDocument.setPage(x)},g.prototype.addPage=function(){return this.jsPDFDocument.addPage()},g.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},g.prototype.getGlobalOptions=function(){return u||{}},g.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},g.prototype.pageSize=function(){var x=this.jsPDFDocument.internal.pageSize;return x.width==null&&(x={width:x.getWidth(),height:x.getHeight()}),x},g.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},g.prototype.getLineHeightFactor=function(){var x=this.jsPDFDocument;return x.getLineHeightFactor?x.getLineHeightFactor():1.15},g.prototype.getLineHeight=function(x){return x/this.scaleFactor()*this.getLineHeightFactor()},g.prototype.pageNumber=function(){var x=this.jsPDFDocument.internal.getCurrentPageInfo();return x?x.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},g}();f.DocHandler=d},4:function(c,f,u){Object.defineProperty(f,"__esModule",{value:!0}),f.parseHtml=void 0;var d=u(903),g=u(796);function x(v,_,S,b,A){var E,U;b===void 0&&(b=!1),A===void 0&&(A=!1);var R;typeof _=="string"?R=S.document.querySelector(_):R=_;var L=Object.keys(v.getFontList()),C=v.scaleFactor(),P=[],W=[],k=[];if(!R)return console.error("Html table could not be found with input: ",_),{head:P,body:W,foot:k};for(var T=0;T<R.rows.length;T++){var H=R.rows[T],G=(U=(E=H==null?void 0:H.parentElement)===null||E===void 0?void 0:E.tagName)===null||U===void 0?void 0:U.toLowerCase(),ce=p(L,C,S,H,b,A);ce&&(G==="thead"?P.push(ce):G==="tfoot"?k.push(ce):W.push(ce))}return{head:P,body:W,foot:k}}f.parseHtml=x;function p(v,_,S,b,A,E){for(var U=new g.HtmlRowInput(b),R=0;R<b.cells.length;R++){var L=b.cells[R],C=S.getComputedStyle(L);if(A||C.display!=="none"){var P=void 0;E&&(P=(0,d.parseCss)(v,L,_,C,S)),U.push({rowSpan:L.rowSpan,colSpan:L.colSpan,styles:P,_element:L,content:w(L)})}}var W=S.getComputedStyle(b);if(U.length>0&&(A||W.display!=="none"))return U}function w(v){var _=v.cloneNode(!0);return _.innerHTML=_.innerHTML.replace(/\n/g,"").replace(/ +/g," "),_.innerHTML=_.innerHTML.split(/<br.*?>/).map(function(S){return S.trim()}).join(`
`),_.innerText||_.textContent||""}},776:function(c,f,u){Object.defineProperty(f,"__esModule",{value:!0}),f.parseInput=void 0;var d=u(4),g=u(356),x=u(420),p=u(744),w=u(792);function v(R,L){var C=new p.DocHandler(R),P=C.getDocumentOptions(),W=C.getGlobalOptions();(0,w.default)(C,W,P,L);var k=(0,g.assign)({},W,P,L),T;typeof window<"u"&&(T=window);var H=_(W,P,L),G=S(W,P,L),ce=b(C,k),J=E(C,k,T);return{id:L.tableId,content:J,hooks:G,styles:H,settings:ce}}f.parseInput=v;function _(R,L,C){for(var P={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},W=function(G){if(G==="columnStyles"){var ce=R[G],J=L[G],Q=C[G];P.columnStyles=(0,g.assign)({},ce,J,Q)}else{var oe=[R,L,C],ae=oe.map(function(ge){return ge[G]||{}});P[G]=(0,g.assign)({},ae[0],ae[1],ae[2])}},k=0,T=Object.keys(P);k<T.length;k++){var H=T[k];W(H)}return P}function S(R,L,C){for(var P=[R,L,C],W={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},k=0,T=P;k<T.length;k++){var H=T[k];H.didParseCell&&W.didParseCell.push(H.didParseCell),H.willDrawCell&&W.willDrawCell.push(H.willDrawCell),H.didDrawCell&&W.didDrawCell.push(H.didDrawCell),H.willDrawPage&&W.willDrawPage.push(H.willDrawPage),H.didDrawPage&&W.didDrawPage.push(H.didDrawPage)}return W}function b(R,L){var C,P,W,k,T,H,G,ce,J,Q,oe,ae,ge=(0,x.parseSpacing)(L.margin,40/R.scaleFactor()),ve=(C=A(R,L.startY))!==null&&C!==void 0?C:ge.top,j;L.showFoot===!0?j="everyPage":L.showFoot===!1?j="never":j=(P=L.showFoot)!==null&&P!==void 0?P:"everyPage";var O;L.showHead===!0?O="everyPage":L.showHead===!1?O="never":O=(W=L.showHead)!==null&&W!==void 0?W:"everyPage";var I=(k=L.useCss)!==null&&k!==void 0?k:!1,D=L.theme||(I?"plain":"striped"),X=!!L.horizontalPageBreak,fe=(T=L.horizontalPageBreakRepeat)!==null&&T!==void 0?T:null;return{includeHiddenHtml:(H=L.includeHiddenHtml)!==null&&H!==void 0?H:!1,useCss:I,theme:D,startY:ve,margin:ge,pageBreak:(G=L.pageBreak)!==null&&G!==void 0?G:"auto",rowPageBreak:(ce=L.rowPageBreak)!==null&&ce!==void 0?ce:"auto",tableWidth:(J=L.tableWidth)!==null&&J!==void 0?J:"auto",showHead:O,showFoot:j,tableLineWidth:(Q=L.tableLineWidth)!==null&&Q!==void 0?Q:0,tableLineColor:(oe=L.tableLineColor)!==null&&oe!==void 0?oe:200,horizontalPageBreak:X,horizontalPageBreakRepeat:fe,horizontalPageBreakBehaviour:(ae=L.horizontalPageBreakBehaviour)!==null&&ae!==void 0?ae:"afterAllRows"}}function A(R,L){var C=R.getLastAutoTable(),P=R.scaleFactor(),W=R.pageNumber(),k=!1;if(C&&C.startPageNumber){var T=C.startPageNumber+C.pageNumber-1;k=T===W}return typeof L=="number"?L:(L==null||L===!1)&&k&&(C==null?void 0:C.finalY)!=null?C.finalY+20/P:null}function E(R,L,C){var P=L.head||[],W=L.body||[],k=L.foot||[];if(L.html){var T=L.includeHiddenHtml;if(C){var H=(0,d.parseHtml)(R,L.html,C,T,L.useCss)||{};P=H.head||P,W=H.body||P,k=H.foot||P}else console.error("Cannot parse html in non browser environment")}var G=L.columns||U(P,W,k);return{columns:G,head:P,body:W,foot:k}}function U(R,L,C){var P=R[0]||L[0]||C[0]||[],W=[];return Object.keys(P).filter(function(k){return k!=="_element"}).forEach(function(k){var T=1,H;Array.isArray(P)?H=P[parseInt(k)]:H=P[k],typeof H=="object"&&!Array.isArray(H)&&(T=(H==null?void 0:H.colSpan)||1);for(var G=0;G<T;G++){var ce=void 0;Array.isArray(P)?ce=W.length:ce=k+(G>0?"_".concat(G):"");var J={dataKey:ce};W.push(J)}}),W}},792:function(c,f){Object.defineProperty(f,"__esModule",{value:!0});function u(g,x,p,w){for(var v=function(A){A&&typeof A!="object"&&console.error("The options parameter should be of type object, is: "+typeof A),typeof A.extendWidth<"u"&&(A.tableWidth=A.extendWidth?"auto":"wrap",console.error("Use of deprecated option: extendWidth, use tableWidth instead.")),typeof A.margins<"u"&&(typeof A.margin>"u"&&(A.margin=A.margins),console.error("Use of deprecated option: margins, use margin instead.")),A.startY&&typeof A.startY!="number"&&(console.error("Invalid value for startY option",A.startY),delete A.startY),!A.didDrawPage&&(A.afterPageContent||A.beforePageContent||A.afterPageAdd)&&(console.error("The afterPageContent, beforePageContent and afterPageAdd hooks are deprecated. Use didDrawPage instead"),A.didDrawPage=function(k){g.applyStyles(g.userStyles),A.beforePageContent&&A.beforePageContent(k),g.applyStyles(g.userStyles),A.afterPageContent&&A.afterPageContent(k),g.applyStyles(g.userStyles),A.afterPageAdd&&k.pageNumber>1&&k.afterPageAdd(k),g.applyStyles(g.userStyles)}),["createdHeaderCell","drawHeaderRow","drawRow","drawHeaderCell"].forEach(function(k){A[k]&&console.error('The "'.concat(k,'" hook has changed in version 3.0, check the changelog for how to migrate.'))}),[["showFoot","showFooter"],["showHead","showHeader"],["didDrawPage","addPageContent"],["didParseCell","createdCell"],["headStyles","headerStyles"]].forEach(function(k){var T=k[0],H=k[1];A[H]&&(console.error("Use of deprecated option ".concat(H,". Use ").concat(T," instead")),A[T]=A[H])}),[["padding","cellPadding"],["lineHeight","rowHeight"],"fontSize","overflow"].forEach(function(k){var T=typeof k=="string"?k:k[0],H=typeof k=="string"?k:k[1];typeof A[T]<"u"&&(typeof A.styles[H]>"u"&&(A.styles[H]=A[T]),console.error("Use of deprecated option: "+T+", use the style "+H+" instead."))});for(var E=0,U=["styles","bodyStyles","headStyles","footStyles"];E<U.length;E++){var R=U[E];d(A[R]||{})}for(var L=A.columnStyles||{},C=0,P=Object.keys(L);C<P.length;C++){var W=P[C];d(L[W]||{})}},_=0,S=[x,p,w];_<S.length;_++){var b=S[_];v(b)}}f.default=u;function d(g){g.rowHeight?(console.error("Use of deprecated style rowHeight. It is renamed to minCellHeight."),g.minCellHeight||(g.minCellHeight=g.rowHeight)):g.columnWidth&&(console.error("Use of deprecated style columnWidth. It is renamed to cellWidth."),g.cellWidth||(g.cellWidth=g.columnWidth))}},260:function(c,f,u){Object.defineProperty(f,"__esModule",{value:!0}),f.Column=f.Cell=f.Row=f.Table=void 0;var d=u(796),g=u(172),x=u(420),p=function(){function S(b,A){this.pageNumber=1,this.pageCount=1,this.id=b.id,this.settings=b.settings,this.styles=b.styles,this.hooks=b.hooks,this.columns=A.columns,this.head=A.head,this.body=A.body,this.foot=A.foot}return S.prototype.getHeadHeight=function(b){return this.head.reduce(function(A,E){return A+E.getMaxCellHeight(b)},0)},S.prototype.getFootHeight=function(b){return this.foot.reduce(function(A,E){return A+E.getMaxCellHeight(b)},0)},S.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},S.prototype.callCellHooks=function(b,A,E,U,R,L){for(var C=0,P=A;C<P.length;C++){var W=P[C],k=new g.CellHookData(b,this,E,U,R,L),T=W(k)===!1;if(E.text=Array.isArray(E.text)?E.text:[E.text],T)return!1}return!0},S.prototype.callEndPageHooks=function(b,A){b.applyStyles(b.userStyles);for(var E=0,U=this.hooks.didDrawPage;E<U.length;E++){var R=U[E];R(new g.HookData(b,this,A))}},S.prototype.callWillDrawPageHooks=function(b,A){for(var E=0,U=this.hooks.willDrawPage;E<U.length;E++){var R=U[E];R(new g.HookData(b,this,A))}},S.prototype.getWidth=function(b){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var A=this.columns.reduce(function(U,R){return U+R.wrappedWidth},0);return A}else{var E=this.settings.margin;return b-E.left-E.right}},S}();f.Table=p;var w=function(){function S(b,A,E,U,R){R===void 0&&(R=!1),this.height=0,this.raw=b,b instanceof d.HtmlRowInput&&(this.raw=b._element,this.element=b._element),this.index=A,this.section=E,this.cells=U,this.spansMultiplePages=R}return S.prototype.getMaxCellHeight=function(b){var A=this;return b.reduce(function(E,U){var R;return Math.max(E,((R=A.cells[U.index])===null||R===void 0?void 0:R.height)||0)},0)},S.prototype.hasRowSpan=function(b){var A=this;return b.filter(function(E){var U=A.cells[E.index];return U?U.rowSpan>1:!1}).length>0},S.prototype.canEntireRowFit=function(b,A){return this.getMaxCellHeight(A)<=b},S.prototype.getMinimumRowHeight=function(b,A){var E=this;return b.reduce(function(U,R){var L=E.cells[R.index];if(!L)return 0;var C=A.getLineHeight(L.styles.fontSize),P=L.padding("vertical"),W=P+C;return W>U?W:U},0)},S}();f.Row=w;var v=function(){function S(b,A,E){var U,R;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=A,this.section=E,this.raw=b;var L=b;b!=null&&typeof b=="object"&&!Array.isArray(b)?(this.rowSpan=b.rowSpan||1,this.colSpan=b.colSpan||1,L=(R=(U=b.content)!==null&&U!==void 0?U:b.title)!==null&&R!==void 0?R:b,b._element&&(this.raw=b._element)):(this.rowSpan=1,this.colSpan=1);var C=L!=null?""+L:"",P=/\r\n|\r|\n/g;this.text=C.split(P)}return S.prototype.getTextPos=function(){var b;if(this.styles.valign==="top")b=this.y+this.padding("top");else if(this.styles.valign==="bottom")b=this.y+this.height-this.padding("bottom");else{var A=this.height-this.padding("vertical");b=this.y+A/2+this.padding("top")}var E;if(this.styles.halign==="right")E=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var U=this.width-this.padding("horizontal");E=this.x+U/2+this.padding("left")}else E=this.x+this.padding("left");return{x:E,y:b}},S.prototype.getContentHeight=function(b,A){A===void 0&&(A=1.15);var E=Array.isArray(this.text)?this.text.length:1,U=this.styles.fontSize/b*A,R=E*U+this.padding("vertical");return Math.max(R,this.styles.minCellHeight)},S.prototype.padding=function(b){var A=(0,x.parseSpacing)(this.styles.cellPadding,0);return b==="vertical"?A.top+A.bottom:b==="horizontal"?A.left+A.right:A[b]},S}();f.Cell=v;var _=function(){function S(b,A,E){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=b,this.raw=A,this.index=E}return S.prototype.getMaxCustomCellWidth=function(b){for(var A=0,E=0,U=b.allRows();E<U.length;E++){var R=U[E],L=R.cells[this.index];L&&typeof L.styles.cellWidth=="number"&&(A=Math.max(A,L.styles.cellWidth))}return A},S}();f.Column=_},356:function(c,f){Object.defineProperty(f,"__esModule",{value:!0}),f.assign=void 0;function u(d,g,x,p,w){if(d==null)throw new TypeError("Cannot convert undefined or null to object");for(var v=Object(d),_=1;_<arguments.length;_++){var S=arguments[_];if(S!=null)for(var b in S)Object.prototype.hasOwnProperty.call(S,b)&&(v[b]=S[b])}return v}f.assign=u},972:function(c,f,u){Object.defineProperty(f,"__esModule",{value:!0}),f.createTable=void 0;var d=u(744),g=u(260),x=u(324),p=u(796),w=u(356);function v(R,L){var C=new d.DocHandler(R),P=_(L,C.scaleFactor()),W=new g.Table(L,P);return(0,x.calculateWidths)(C,W),C.applyStyles(C.userStyles),W}f.createTable=v;function _(R,L){var C=R.content,P=E(C.columns);if(C.head.length===0){var W=b(P,"head");W&&C.head.push(W)}if(C.foot.length===0){var W=b(P,"foot");W&&C.foot.push(W)}var k=R.settings.theme,T=R.styles;return{columns:P,head:S("head",C.head,P,T,k,L),body:S("body",C.body,P,T,k,L),foot:S("foot",C.foot,P,T,k,L)}}function S(R,L,C,P,W,k){var T={},H=L.map(function(G,ce){for(var J=0,Q={},oe=0,ae=0,ge=0,ve=C;ge<ve.length;ge++){var j=ve[ge];if(T[j.index]==null||T[j.index].left===0)if(ae===0){var O=void 0;Array.isArray(G)?O=G[j.index-oe-J]:O=G[j.dataKey];var I={};typeof O=="object"&&!Array.isArray(O)&&(I=(O==null?void 0:O.styles)||{});var D=U(R,j,ce,W,P,k,I),X=new g.Cell(O,D,R);Q[j.dataKey]=X,Q[j.index]=X,ae=X.colSpan-1,T[j.index]={left:X.rowSpan-1,times:ae}}else ae--,oe++;else T[j.index].left--,ae=T[j.index].times,J++}return new g.Row(G,ce,R,Q)});return H}function b(R,L){var C={};return R.forEach(function(P){if(P.raw!=null){var W=A(L,P.raw);W!=null&&(C[P.dataKey]=W)}}),Object.keys(C).length>0?C:null}function A(R,L){if(R==="head"){if(typeof L=="object")return L.header||L.title||null;if(typeof L=="string"||typeof L=="number")return L}else if(R==="foot"&&typeof L=="object")return L.footer;return null}function E(R){return R.map(function(L,C){var P,W,k;return typeof L=="object"?k=(W=(P=L.dataKey)!==null&&P!==void 0?P:L.key)!==null&&W!==void 0?W:C:k=C,new g.Column(k,L,C)})}function U(R,L,C,P,W,k,T){var H=(0,p.getTheme)(P),G;R==="head"?G=W.headStyles:R==="body"?G=W.bodyStyles:R==="foot"&&(G=W.footStyles);var ce=(0,w.assign)({},H.table,H[R],W.styles,G),J=W.columnStyles[L.dataKey]||W.columnStyles[L.index]||{},Q=R==="body"?J:{},oe=R==="body"&&C%2===0?(0,w.assign)({},H.alternateRow,W.alternateRowStyles):{},ae=(0,p.defaultStyles)(k),ge=(0,w.assign)({},ae,ce,oe,Q);return(0,w.assign)(ge,T)}},664:function(c,f,u){Object.defineProperty(f,"__esModule",{value:!0}),f.addPage=f.drawTable=void 0;var d=u(420),g=u(260),x=u(744),p=u(356),w=u(136),v=u(224);function _(J,Q){var oe=Q.settings,ae=oe.startY,ge=oe.margin,ve={x:ge.left,y:ae},j=Q.getHeadHeight(Q.columns)+Q.getFootHeight(Q.columns),O=ae+ge.bottom+j;if(oe.pageBreak==="avoid"){var I=Q.body,D=I.reduce(function(he,ue){return he+ue.height},0);O+=D}var X=new x.DocHandler(J);(oe.pageBreak==="always"||oe.startY!=null&&O>X.pageSize().height)&&(ce(X),ve.y=ge.top),Q.callWillDrawPageHooks(X,ve);var fe=(0,p.assign)({},ve);Q.startPageNumber=X.pageNumber(),oe.horizontalPageBreak?S(X,Q,fe,ve):(X.applyStyles(X.userStyles),(oe.showHead==="firstPage"||oe.showHead==="everyPage")&&Q.head.forEach(function(he){return W(X,Q,he,ve,Q.columns)}),X.applyStyles(X.userStyles),Q.body.forEach(function(he,ue){var be=ue===Q.body.length-1;P(X,Q,he,be,fe,ve,Q.columns)}),X.applyStyles(X.userStyles),(oe.showFoot==="lastPage"||oe.showFoot==="everyPage")&&Q.foot.forEach(function(he){return W(X,Q,he,ve,Q.columns)})),(0,d.addTableBorder)(X,Q,fe,ve),Q.callEndPageHooks(X,ve),Q.finalY=ve.y,J.lastAutoTable=Q,J.previousAutoTable=Q,J.autoTable&&(J.autoTable.previous=Q),X.applyStyles(X.userStyles)}f.drawTable=_;function S(J,Q,oe,ae){var ge=(0,v.calculateAllColumnsCanFitInPage)(J,Q),ve=Q.settings;if(ve.horizontalPageBreakBehaviour==="afterAllRows")ge.forEach(function(D,X){J.applyStyles(J.userStyles),X>0?G(J,Q,oe,ae,D.columns,!0):b(J,Q,ae,D.columns),A(J,Q,oe,ae,D.columns),U(J,Q,ae,D.columns)});else for(var j=-1,O=ge[0],I=function(){var D=j;if(O){J.applyStyles(J.userStyles);var X=O.columns;j>=0?G(J,Q,oe,ae,X,!0):b(J,Q,ae,X),D=E(J,Q,j+1,ae,X),U(J,Q,ae,X)}var fe=D-j;ge.slice(1).forEach(function(he){J.applyStyles(J.userStyles),G(J,Q,oe,ae,he.columns,!0),E(J,Q,j+1,ae,he.columns,fe),U(J,Q,ae,he.columns)}),j=D};j<Q.body.length-1;)I()}function b(J,Q,oe,ae){var ge=Q.settings;J.applyStyles(J.userStyles),(ge.showHead==="firstPage"||ge.showHead==="everyPage")&&Q.head.forEach(function(ve){return W(J,Q,ve,oe,ae)})}function A(J,Q,oe,ae,ge){J.applyStyles(J.userStyles),Q.body.forEach(function(ve,j){var O=j===Q.body.length-1;P(J,Q,ve,O,oe,ae,ge)})}function E(J,Q,oe,ae,ge,ve){J.applyStyles(J.userStyles),ve=ve??Q.body.length;var j=Math.min(oe+ve,Q.body.length),O=-1;return Q.body.slice(oe,j).forEach(function(I,D){var X=oe+D===Q.body.length-1,fe=H(J,Q,X,ae);I.canEntireRowFit(fe,ge)&&(W(J,Q,I,ae,ge),O=oe+D)}),O}function U(J,Q,oe,ae){var ge=Q.settings;J.applyStyles(J.userStyles),(ge.showFoot==="lastPage"||ge.showFoot==="everyPage")&&Q.foot.forEach(function(ve){return W(J,Q,ve,oe,ae)})}function R(J,Q,oe){var ae=oe.getLineHeight(J.styles.fontSize),ge=J.padding("vertical"),ve=Math.floor((Q-ge)/ae);return Math.max(0,ve)}function L(J,Q,oe,ae){var ge={};J.spansMultiplePages=!0,J.height=0;for(var ve=0,j=0,O=oe.columns;j<O.length;j++){var I=O[j],D=J.cells[I.index];if(D){Array.isArray(D.text)||(D.text=[D.text]);var X=new g.Cell(D.raw,D.styles,D.section);X=(0,p.assign)(X,D),X.text=[];var fe=R(D,Q,ae);D.text.length>fe&&(X.text=D.text.splice(fe,D.text.length));var he=ae.scaleFactor(),ue=ae.getLineHeightFactor();D.contentHeight=D.getContentHeight(he,ue),D.contentHeight>=Q&&(D.contentHeight=Q,X.styles.minCellHeight-=Q),D.contentHeight>J.height&&(J.height=D.contentHeight),X.contentHeight=X.getContentHeight(he,ue),X.contentHeight>ve&&(ve=X.contentHeight),ge[I.index]=X}}var be=new g.Row(J.raw,-1,J.section,ge,!0);be.height=ve;for(var Oe=0,Me=oe.columns;Oe<Me.length;Oe++){var I=Me[Oe],X=be.cells[I.index];X&&(X.height=be.height);var D=J.cells[I.index];D&&(D.height=J.height)}return be}function C(J,Q,oe,ae){var ge=J.pageSize().height,ve=ae.settings.margin,j=ve.top+ve.bottom,O=ge-j;Q.section==="body"&&(O-=ae.getHeadHeight(ae.columns)+ae.getFootHeight(ae.columns));var I=Q.getMinimumRowHeight(ae.columns,J),D=I<oe;if(I>O)return console.error("Will not be able to print row ".concat(Q.index," correctly since it's minimum height is larger than page height")),!0;if(!D)return!1;var X=Q.hasRowSpan(ae.columns),fe=Q.getMaxCellHeight(ae.columns)>O;return fe?(X&&console.error("The content of row ".concat(Q.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(X||ae.settings.rowPageBreak==="avoid")}function P(J,Q,oe,ae,ge,ve,j){var O=H(J,Q,ae,ve);if(oe.canEntireRowFit(O,j))W(J,Q,oe,ve,j);else if(C(J,oe,O,Q)){var I=L(oe,O,Q,J);W(J,Q,oe,ve,j),G(J,Q,ge,ve,j),P(J,Q,I,ae,ge,ve,j)}else G(J,Q,ge,ve,j),P(J,Q,oe,ae,ge,ve,j)}function W(J,Q,oe,ae,ge){ae.x=Q.settings.margin.left;for(var ve=0,j=ge;ve<j.length;ve++){var O=j[ve],I=oe.cells[O.index];if(!I){ae.x+=O.width;continue}J.applyStyles(I.styles),I.x=ae.x,I.y=ae.y;var D=Q.callCellHooks(J,Q.hooks.willDrawCell,I,oe,O,ae);if(D===!1){ae.x+=O.width;continue}k(J,I,ae);var X=I.getTextPos();(0,w.default)(I.text,X.x,X.y,{halign:I.styles.halign,valign:I.styles.valign,maxWidth:Math.ceil(I.width-I.padding("left")-I.padding("right"))},J.getDocument()),Q.callCellHooks(J,Q.hooks.didDrawCell,I,oe,O,ae),ae.x+=O.width}ae.y+=oe.height}function k(J,Q,oe){var ae=Q.styles;if(J.getDocument().setFillColor(J.getDocument().getFillColor()),typeof ae.lineWidth=="number"){var ge=(0,d.getFillStyle)(ae.lineWidth,ae.fillColor);ge&&J.rect(Q.x,oe.y,Q.width,Q.height,ge)}else typeof ae.lineWidth=="object"&&(ae.fillColor&&J.rect(Q.x,oe.y,Q.width,Q.height,"F"),T(J,Q,oe,ae.lineWidth))}function T(J,Q,oe,ae){var ge,ve,j,O;ae.top&&(ge=oe.x,ve=oe.y,j=oe.x+Q.width,O=oe.y,ae.right&&(j+=.5*ae.right),ae.left&&(ge-=.5*ae.left),I(ae.top,ge,ve,j,O)),ae.bottom&&(ge=oe.x,ve=oe.y+Q.height,j=oe.x+Q.width,O=oe.y+Q.height,ae.right&&(j+=.5*ae.right),ae.left&&(ge-=.5*ae.left),I(ae.bottom,ge,ve,j,O)),ae.left&&(ge=oe.x,ve=oe.y,j=oe.x,O=oe.y+Q.height,ae.top&&(ve-=.5*ae.top),ae.bottom&&(O+=.5*ae.bottom),I(ae.left,ge,ve,j,O)),ae.right&&(ge=oe.x+Q.width,ve=oe.y,j=oe.x+Q.width,O=oe.y+Q.height,ae.top&&(ve-=.5*ae.top),ae.bottom&&(O+=.5*ae.bottom),I(ae.right,ge,ve,j,O));function I(D,X,fe,he,ue){J.getDocument().setLineWidth(D),J.getDocument().line(X,fe,he,ue,"S")}}function H(J,Q,oe,ae){var ge=Q.settings.margin.bottom,ve=Q.settings.showFoot;return(ve==="everyPage"||ve==="lastPage"&&oe)&&(ge+=Q.getFootHeight(Q.columns)),J.pageSize().height-ae.y-ge}function G(J,Q,oe,ae,ge,ve){ge===void 0&&(ge=[]),ve===void 0&&(ve=!1),J.applyStyles(J.userStyles),Q.settings.showFoot==="everyPage"&&!ve&&Q.foot.forEach(function(O){return W(J,Q,O,ae,ge)}),Q.callEndPageHooks(J,ae);var j=Q.settings.margin;(0,d.addTableBorder)(J,Q,oe,ae),ce(J),Q.pageNumber++,Q.pageCount++,ae.x=j.left,ae.y=j.top,oe.y=j.top,Q.callWillDrawPageHooks(J,ae),Q.settings.showHead==="everyPage"&&(Q.head.forEach(function(O){return W(J,Q,O,ae,ge)}),J.applyStyles(J.userStyles))}f.addPage=G;function ce(J){var Q=J.pageNumber();J.setPage(Q+1);var oe=J.pageNumber();return oe===Q?(J.addPage(),!0):!1}},224:function(c,f,u){Object.defineProperty(f,"__esModule",{value:!0}),f.calculateAllColumnsCanFitInPage=void 0;var d=u(420);function g(p,w,v){var _;v===void 0&&(v={});var S=(0,d.getPageAvailableWidth)(p,w),b=new Map,A=[],E=[],U=[];w.settings.horizontalPageBreakRepeat,Array.isArray(w.settings.horizontalPageBreakRepeat)?U=w.settings.horizontalPageBreakRepeat:(typeof w.settings.horizontalPageBreakRepeat=="string"||typeof w.settings.horizontalPageBreakRepeat=="number")&&(U=[w.settings.horizontalPageBreakRepeat]),U.forEach(function(P){var W=w.columns.find(function(k){return k.dataKey===P||k.index===P});W&&!b.has(W.index)&&(b.set(W.index,!0),A.push(W.index),E.push(w.columns[W.index]),S-=W.wrappedWidth)});for(var R=!0,L=(_=v==null?void 0:v.start)!==null&&_!==void 0?_:0;L<w.columns.length;){if(b.has(L)){L++;continue}var C=w.columns[L].wrappedWidth;if(R||S>=C)R=!1,A.push(L),E.push(w.columns[L]),S-=C;else break;L++}return{colIndexes:A,columns:E,lastIndex:L-1}}function x(p,w){for(var v=[],_=0;_<w.columns.length;_++){var S=g(p,w,{start:_});S.columns.length&&(v.push(S),_=S.lastIndex)}return v}f.calculateAllColumnsCanFitInPage=x},324:function(c,f,u){Object.defineProperty(f,"__esModule",{value:!0}),f.ellipsize=f.resizeColumns=f.calculateWidths=void 0;var d=u(420);function g(A,E){x(A,E);var U=[],R=0;E.columns.forEach(function(C){var P=C.getMaxCustomCellWidth(E);P?C.width=P:(C.width=C.wrappedWidth,U.push(C)),R+=C.width});var L=E.getWidth(A.pageSize().width)-R;L&&(L=p(U,L,function(C){return Math.max(C.minReadableWidth,C.minWidth)})),L&&(L=p(U,L,function(C){return C.minWidth})),L=Math.abs(L),!E.settings.horizontalPageBreak&&L>.1/A.scaleFactor()&&(L=L<1?L:Math.round(L),console.warn("Of the table content, ".concat(L," units width could not fit page"))),v(E),_(E,A),w(E)}f.calculateWidths=g;function x(A,E){var U=A.scaleFactor(),R=E.settings.horizontalPageBreak,L=(0,d.getPageAvailableWidth)(A,E);E.allRows().forEach(function(C){for(var P=0,W=E.columns;P<W.length;P++){var k=W[P],T=C.cells[k.index];if(T){var H=E.hooks.didParseCell;E.callCellHooks(A,H,T,C,k,null);var G=T.padding("horizontal");T.contentWidth=(0,d.getStringWidth)(T.text,T.styles,A)+G;var ce=(0,d.getStringWidth)(T.text.join(" ").split(/[^\S\u00A0]+/),T.styles,A);if(T.minReadableWidth=ce+T.padding("horizontal"),typeof T.styles.cellWidth=="number")T.minWidth=T.styles.cellWidth,T.wrappedWidth=T.styles.cellWidth;else if(T.styles.cellWidth==="wrap"||R===!0)T.contentWidth>L?(T.minWidth=L,T.wrappedWidth=L):(T.minWidth=T.contentWidth,T.wrappedWidth=T.contentWidth);else{var J=10/U;T.minWidth=T.styles.minCellWidth||J,T.wrappedWidth=T.contentWidth,T.minWidth>T.wrappedWidth&&(T.wrappedWidth=T.minWidth)}}}}),E.allRows().forEach(function(C){for(var P=0,W=E.columns;P<W.length;P++){var k=W[P],T=C.cells[k.index];if(T&&T.colSpan===1)k.wrappedWidth=Math.max(k.wrappedWidth,T.wrappedWidth),k.minWidth=Math.max(k.minWidth,T.minWidth),k.minReadableWidth=Math.max(k.minReadableWidth,T.minReadableWidth);else{var H=E.styles.columnStyles[k.dataKey]||E.styles.columnStyles[k.index]||{},G=H.cellWidth||H.minCellWidth;G&&typeof G=="number"&&(k.minWidth=G,k.wrappedWidth=G)}T&&(T.colSpan>1&&!k.minWidth&&(k.minWidth=T.minWidth),T.colSpan>1&&!k.wrappedWidth&&(k.wrappedWidth=T.minWidth))}})}function p(A,E,U){for(var R=E,L=A.reduce(function(J,Q){return J+Q.wrappedWidth},0),C=0;C<A.length;C++){var P=A[C],W=P.wrappedWidth/L,k=R*W,T=P.width+k,H=U(P),G=T<H?H:T;E-=G-P.width,P.width=G}if(E=Math.round(E*1e10)/1e10,E){var ce=A.filter(function(J){return E<0?J.width>U(J):!0});ce.length&&(E=p(ce,E,U))}return E}f.resizeColumns=p;function w(A){for(var E={},U=1,R=A.allRows(),L=0;L<R.length;L++)for(var C=R[L],P=0,W=A.columns;P<W.length;P++){var k=W[P],T=E[k.index];if(U>1)U--,delete C.cells[k.index];else if(T)T.cell.height+=C.height,U=T.cell.colSpan,delete C.cells[k.index],T.left--,T.left<=1&&delete E[k.index];else{var H=C.cells[k.index];if(!H)continue;if(H.height=C.height,H.rowSpan>1){var G=R.length-L,ce=H.rowSpan>G?G:H.rowSpan;E[k.index]={cell:H,left:ce,row:C}}}}}function v(A){for(var E=A.allRows(),U=0;U<E.length;U++)for(var R=E[U],L=null,C=0,P=0,W=0;W<A.columns.length;W++){var k=A.columns[W];if(P-=1,P>1&&A.columns[W+1])C+=k.width,delete R.cells[k.index];else if(L){var T=L;delete R.cells[k.index],L=null,T.width=k.width+C}else{var T=R.cells[k.index];if(!T)continue;if(P=T.colSpan,C=0,T.colSpan>1){L=T,C+=k.width;continue}T.width=k.width+C}}}function _(A,E){for(var U={count:0,height:0},R=0,L=A.allRows();R<L.length;R++){for(var C=L[R],P=0,W=A.columns;P<W.length;P++){var k=W[P],T=C.cells[k.index];if(T){E.applyStyles(T.styles,!0);var H=T.width-T.padding("horizontal");if(T.styles.overflow==="linebreak")T.text=E.splitTextToSize(T.text,H+1/E.scaleFactor(),{fontSize:T.styles.fontSize});else if(T.styles.overflow==="ellipsize")T.text=S(T.text,H,T.styles,E,"...");else if(T.styles.overflow==="hidden")T.text=S(T.text,H,T.styles,E,"");else if(typeof T.styles.overflow=="function"){var G=T.styles.overflow(T.text,H);typeof G=="string"?T.text=[G]:T.text=G}T.contentHeight=T.getContentHeight(E.scaleFactor(),E.getLineHeightFactor());var ce=T.contentHeight/T.rowSpan;T.rowSpan>1&&U.count*U.height<ce*T.rowSpan?U={height:ce,count:T.rowSpan}:U&&U.count>0&&U.height>ce&&(ce=U.height),ce>C.height&&(C.height=ce)}}U.count--}}function S(A,E,U,R,L){return A.map(function(C){return b(C,E,U,R,L)})}f.ellipsize=S;function b(A,E,U,R,L){var C=1e4*R.scaleFactor();if(E=Math.ceil(E*C)/C,E>=(0,d.getStringWidth)(A,U,R))return A;for(;E<(0,d.getStringWidth)(A+L,U,R)&&!(A.length<=1);)A=A.substring(0,A.length-1);return A.trim()+L}},964:function(c){if(typeof t>"u"){var f=new Error("Cannot find module 'undefined'");throw f.code="MODULE_NOT_FOUND",f}c.exports=t}},a={};function s(c){var f=a[c];if(f!==void 0)return f.exports;var u=a[c]={exports:{}};return n[c].call(u.exports,u,u.exports,s),u.exports}var l={};return function(){var c=l;Object.defineProperty(c,"__esModule",{value:!0}),c.Cell=c.Column=c.Row=c.Table=c.CellHookData=c.__drawTable=c.__createTable=c.applyPlugin=void 0;var f=s(340),u=s(776),d=s(664),g=s(972),x=s(260);Object.defineProperty(c,"Table",{enumerable:!0,get:function(){return x.Table}});var p=s(172);Object.defineProperty(c,"CellHookData",{enumerable:!0,get:function(){return p.CellHookData}});var w=s(260);Object.defineProperty(c,"Cell",{enumerable:!0,get:function(){return w.Cell}}),Object.defineProperty(c,"Column",{enumerable:!0,get:function(){return w.Column}}),Object.defineProperty(c,"Row",{enumerable:!0,get:function(){return w.Row}});function v(E){(0,f.default)(E)}c.applyPlugin=v;function _(E,U){var R=(0,u.parseInput)(E,U),L=(0,g.createTable)(E,R);(0,d.drawTable)(E,L)}function S(E,U){var R=(0,u.parseInput)(E,U);return(0,g.createTable)(E,R)}c.__createTable=S;function b(E,U){(0,d.drawTable)(E,U)}c.__drawTable=b;try{var A=s(964);A.jsPDF&&(A=A.jsPDF),v(A)}catch{}c.default=_}(),l}()})})(Sm);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Xl={};Xl.version="0.18.5";var Iu=1252,jm=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Du=function(e){jm.indexOf(e)!=-1&&(Iu=e)};function km(){Du(1252)}var Lo=function(e){Du(e)};function Tm(){Lo(1200),km()}var Ul=function(r){return String.fromCharCode(r)},Nh=function(r){return String.fromCharCode(r)},Kl,pi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Po(e){for(var r="",t=0,n=0,a=0,s=0,l=0,c=0,f=0,u=0;u<e.length;)t=e.charCodeAt(u++),s=t>>2,n=e.charCodeAt(u++),l=(t&3)<<4|n>>4,a=e.charCodeAt(u++),c=(n&15)<<2|a>>6,f=a&63,isNaN(n)?c=f=64:isNaN(a)&&(f=64),r+=pi.charAt(s)+pi.charAt(l)+pi.charAt(c)+pi.charAt(f);return r}function Va(e){var r="",t=0,n=0,a=0,s=0,l=0,c=0,f=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=pi.indexOf(e.charAt(u++)),l=pi.indexOf(e.charAt(u++)),t=s<<2|l>>4,r+=String.fromCharCode(t),c=pi.indexOf(e.charAt(u++)),n=(l&15)<<4|c>>2,c!==64&&(r+=String.fromCharCode(n)),f=pi.indexOf(e.charAt(u++)),a=(c&3)<<6|f,f!==64&&(r+=String.fromCharCode(a));return r}var Ht=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),$a=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function Hi(e){return Ht?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function _h(e){return Ht?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ha=function(r){return Ht?$a(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function d0(e){if(typeof ArrayBuffer>"u")return ha(e);for(var r=new ArrayBuffer(e.length),t=new Uint8Array(r),n=0;n!=e.length;++n)t[n]=e.charCodeAt(n)&255;return r}function Uo(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function Em(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var $r=Ht?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:$a(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),a=0;for(r=0,t=0;r<e.length;t+=a,++r)if(a=e[r].length,e[r]instanceof Uint8Array)n.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";n.set(new Uint8Array(e[r]),t)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Fm(e){for(var r=[],t=0,n=e.length+250,a=Hi(e.length+255),s=0;s<e.length;++s){var l=e.charCodeAt(s);if(l<128)a[t++]=l;else if(l<2048)a[t++]=192|l>>6&31,a[t++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var c=e.charCodeAt(++s)&1023;a[t++]=240|l>>8&7,a[t++]=128|l>>2&63,a[t++]=128|c>>6&15|(l&3)<<4,a[t++]=128|c&63}else a[t++]=224|l>>12&15,a[t++]=128|l>>6&63,a[t++]=128|l&63;t>n&&(r.push(a.slice(0,t)),t=0,a=Hi(65535),n=65530)}return r.push(a.slice(0,t)),$r(r)}var So=/\u0000/g,Hl=/[\u0001-\u0006]/g;function Fs(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function ua(e,r){var t=""+e;return t.length>=r?t:pr("0",r-t.length)+t}function Kc(e,r){var t=""+e;return t.length>=r?t:pr(" ",r-t.length)+t}function Jl(e,r){var t=""+e;return t.length>=r?t:t+pr(" ",r-t.length)}function Cm(e,r){var t=""+Math.round(e);return t.length>=r?t:pr("0",r-t.length)+t}function Lm(e,r){var t=""+e;return t.length>=r?t:pr("0",r-t.length)+t}var Sh=Math.pow(2,32);function bs(e,r){if(e>Sh||e<-Sh)return Cm(e,r);var t=Math.round(e);return Lm(t,r)}function Zl(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var Ah=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],vc=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Pm(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "',e}var gr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "'},jh={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Om={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ql(e,r,t){for(var n=e<0?-1:1,a=e*n,s=0,l=1,c=0,f=1,u=0,d=0,g=Math.floor(a);u<r&&(g=Math.floor(a),c=g*l+s,d=g*u+f,!(a-g<5e-8));)a=1/(a-g),s=l,l=c,f=u,u=d;if(d>r&&(u>r?(d=f,c=s):(d=u,c=l)),!t)return[0,n*c,d];var x=Math.floor(n*c/d);return[x,n*c-x*d,d]}function Wl(e,r,t){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,l=[],c={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),r&&r.date1904&&(n+=1462),c.u>.9999&&(c.u=0,++a==86400&&(c.T=a=0,++n,++c.D)),n===60)l=t?[1317,10,29]:[1900,2,29],s=3;else if(n===0)l=t?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var f=new Date(1900,0,1);f.setDate(f.getDate()+n-1),l=[f.getFullYear(),f.getMonth()+1,f.getDate()],s=f.getDay(),n<60&&(s=(s+6)%7),t&&(s=Hm(f,l))}return c.y=l[0],c.m=l[1],c.d=l[2],c.S=a%60,a=Math.floor(a/60),c.M=a%60,a=Math.floor(a/60),c.H=a,c.q=s,c}var Ru=new Date(1899,11,31,0,0,0),Im=Ru.getTime(),Dm=new Date(1900,2,1,0,0,0);function Mu(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=Dm&&(t+=24*60*60*1e3),(t-(Im+(e.getTimezoneOffset()-Ru.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Jc(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Rm(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Mm(e){var r=e<0?12:11,t=Jc(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function Bm(e){var r=Jc(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function Um(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=Mm(e):r===10?t=e.toFixed(10).substr(0,12):t=Bm(e),Jc(Rm(t.toUpperCase()))}function Hc(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Um(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return yi(14,Mu(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function Hm(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function Wm(e,r,t,n){var a="",s=0,l=0,c=t.y,f,u=0;switch(e){case 98:c=t.y+543;case 121:switch(r.length){case 1:case 2:f=c%100,u=2;break;default:f=c%1e4,u=4;break}break;case 109:switch(r.length){case 1:case 2:f=t.m,u=r.length;break;case 3:return vc[t.m-1][1];case 5:return vc[t.m-1][0];default:return vc[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:f=t.d,u=r.length;break;case 3:return Ah[t.q][0];default:return Ah[t.q][1]}break;case 104:switch(r.length){case 1:case 2:f=1+(t.H+11)%12,u=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:f=t.H,u=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:f=t.M,u=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?ua(t.S,r.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,s=Math.round(l*(t.S+t.u)),s>=60*l&&(s=0),r==="s"?s===0?"0":""+s/l:(a=ua(s,2+n),r==="ss"?a.substr(0,2):"."+a.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":f=t.D*24+t.H;break;case"[m]":case"[mm]":f=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":f=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}u=r.length===3?1:2;break;case 101:f=c,u=1;break}var d=u>0?ua(f,u):"";return d}function mi(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,n=e.substr(0,t);t!=e.length;t+=r)n+=(n.length>0?",":"")+e.substr(t,r);return n}var Bu=/%/g;function zm(e,r,t){var n=r.replace(Bu,""),a=r.length-n.length;return Wa(e,n,t*Math.pow(10,2*a))+pr("%",a)}function qm(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Wa(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function Uu(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Uu(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(r)*Math.LOG10E)%a;if(s<0&&(s+=a),t=(r/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),t.indexOf("e")===-1){var l=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+s):t+="E+"+(l-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,a)+"."+t.substr(2+a),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,u,d){return f+u+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Hu=/# (\?+)( ?)\/( ?)(\d+)/;function Vm(e,r,t){var n=parseInt(e[4],10),a=Math.round(r*n),s=Math.floor(a/n),l=a-s*n,c=n;return t+(s===0?"":""+s)+" "+(l===0?pr(" ",e[1].length+1+e[4].length):Kc(l,e[1].length)+e[2]+"/"+e[3]+ua(c,e[4].length))}function Gm(e,r,t){return t+(r===0?"":""+r)+pr(" ",e[1].length+2+e[4].length)}var Wu=/^#*0*\.([0#]+)/,zu=/\).*[0#]/,qu=/\(###\) ###\\?-####/;function hn(e){for(var r="",t,n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function kh(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function Th(e,r){var t=e-Math.floor(e),n=Math.pow(10,r);return r<(""+Math.round(t*n)).length?0:Math.round(t*n)}function $m(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function Ym(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Xn(e,r,t){if(e.charCodeAt(0)===40&&!r.match(zu)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Xn("n",n,t):"("+Xn("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return qm(e,r,t);if(r.indexOf("%")!==-1)return zm(e,r,t);if(r.indexOf("E")!==-1)return Uu(r,t);if(r.charCodeAt(0)===36)return"$"+Xn(e,r.substr(r.charAt(1)==" "?2:1),t);var a,s,l,c,f=Math.abs(t),u=t<0?"-":"";if(r.match(/^00+$/))return u+bs(f,r.length);if(r.match(/^[#?]+$/))return a=bs(t,0),a==="0"&&(a=""),a.length>r.length?a:hn(r.substr(0,r.length-a.length))+a;if(s=r.match(Hu))return Vm(s,f,u);if(r.match(/^#+0+$/))return u+bs(f,r.length-r.indexOf("0"));if(s=r.match(Wu))return a=kh(t,s[1].length).replace(/^([^\.]+)$/,"$1."+hn(s[1])).replace(/\.$/,"."+hn(s[1])).replace(/\.(\d*)$/,function(w,v){return"."+v+pr("0",hn(s[1]).length-v.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),s=r.match(/^(0*)\.(#*)$/))return u+kh(f,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=r.match(/^#{1,3},##0(\.?)$/))return u+mi(bs(f,0));if(s=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Xn(e,r,-t):mi(""+(Math.floor(t)+$m(t,s[1].length)))+"."+ua(Th(t,s[1].length),s[1].length);if(s=r.match(/^#,#*,#0/))return Xn(e,r.replace(/^#,#*,/,""),t);if(s=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Fs(Xn(e,r.replace(/[\\-]/g,""),t)),l=0,Fs(Fs(r.replace(/\\/g,"")).replace(/[0#]/g,function(w){return l<a.length?a.charAt(l++):w==="0"?"0":""}));if(r.match(qu))return a=Xn(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),c=Ql(f,Math.pow(10,l)-1,!1),a=""+u,d=Wa("n",s[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=Jl(c[2],l),d.length<s[4].length&&(d=hn(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),c=Ql(f,Math.pow(10,l)-1,!0),u+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Kc(c[1],l)+s[2]+"/"+s[3]+Jl(c[2],l):pr(" ",2*l+1+s[2].length+s[3].length));if(s=r.match(/^[#0?]+$/))return a=bs(t,0),r.length<=a.length?a:hn(r.substr(0,r.length-a.length))+a;if(s=r.match(/^([#0?]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var g=r.indexOf(".")-l,x=r.length-a.length-g;return hn(r.substr(0,g)+a+r.substr(r.length-x))}if(s=r.match(/^00,000\.([#0]*0)$/))return l=Th(t,s[1].length),t<0?"-"+Xn(e,r,-t):mi(Ym(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?ua(0,3-w.length):"")+w})+"."+ua(l,s[1].length);switch(r){case"###,##0.00":return Xn(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var p=mi(bs(f,0));return p!=="0"?u+p:"";case"###,###.00":return Xn(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Xn(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function Xm(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Wa(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function Km(e,r,t){var n=r.replace(Bu,""),a=r.length-n.length;return Wa(e,n,t*Math.pow(10,2*a))+pr("%",a)}function Vu(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Vu(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(r)*Math.LOG10E)%a;if(s<0&&(s+=a),t=(r/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!t.match(/[Ee]/)){var l=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+s):t+="E+"+(l-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,u,d){return f+u+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Sa(e,r,t){if(e.charCodeAt(0)===40&&!r.match(zu)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Sa("n",n,t):"("+Sa("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return Xm(e,r,t);if(r.indexOf("%")!==-1)return Km(e,r,t);if(r.indexOf("E")!==-1)return Vu(r,t);if(r.charCodeAt(0)===36)return"$"+Sa(e,r.substr(r.charAt(1)==" "?2:1),t);var a,s,l,c,f=Math.abs(t),u=t<0?"-":"";if(r.match(/^00+$/))return u+ua(f,r.length);if(r.match(/^[#?]+$/))return a=""+t,t===0&&(a=""),a.length>r.length?a:hn(r.substr(0,r.length-a.length))+a;if(s=r.match(Hu))return Gm(s,f,u);if(r.match(/^#+0+$/))return u+ua(f,r.length-r.indexOf("0"));if(s=r.match(Wu))return a=(""+t).replace(/^([^\.]+)$/,"$1."+hn(s[1])).replace(/\.$/,"."+hn(s[1])),a=a.replace(/\.(\d*)$/,function(w,v){return"."+v+pr("0",hn(s[1]).length-v.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),s=r.match(/^(0*)\.(#*)$/))return u+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=r.match(/^#{1,3},##0(\.?)$/))return u+mi(""+f);if(s=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Sa(e,r,-t):mi(""+t)+"."+pr("0",s[1].length);if(s=r.match(/^#,#*,#0/))return Sa(e,r.replace(/^#,#*,/,""),t);if(s=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Fs(Sa(e,r.replace(/[\\-]/g,""),t)),l=0,Fs(Fs(r.replace(/\\/g,"")).replace(/[0#]/g,function(w){return l<a.length?a.charAt(l++):w==="0"?"0":""}));if(r.match(qu))return a=Sa(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),c=Ql(f,Math.pow(10,l)-1,!1),a=""+u,d=Wa("n",s[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=Jl(c[2],l),d.length<s[4].length&&(d=hn(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),c=Ql(f,Math.pow(10,l)-1,!0),u+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Kc(c[1],l)+s[2]+"/"+s[3]+Jl(c[2],l):pr(" ",2*l+1+s[2].length+s[3].length));if(s=r.match(/^[#0?]+$/))return a=""+t,r.length<=a.length?a:hn(r.substr(0,r.length-a.length))+a;if(s=r.match(/^([#0]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var g=r.indexOf(".")-l,x=r.length-a.length-g;return hn(r.substr(0,g)+a+r.substr(r.length-x))}if(s=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Sa(e,r,-t):mi(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?ua(0,3-w.length):"")+w})+"."+ua(0,s[1].length);switch(r){case"###,###":case"##,###":case"#,###":var p=mi(""+f);return p!=="0"?u+p:"";default:if(r.match(/\.[0#?]*$/))return Sa(e,r.slice(0,r.lastIndexOf(".")),t)+hn(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function Wa(e,r,t){return(t|0)===t?Sa(e,r,t):Xn(e,r,t)}function Jm(e){for(var r=[],t=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=e.substr(a,n-a),a=n+1}if(r[r.length]=e.substr(a),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var Gu=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function $u(e){for(var r=0,t="",n="";r<e.length;)switch(t=e.charAt(r)){case"G":Zl(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"ä¸Š":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="ä¸Šåˆ/ä¸‹åˆ")return!0;++r;break;case"[":for(n=t;e.charAt(r++)!=="]"&&r<e.length;)n+=e.charAt(r);if(n.match(Gu))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function Zm(e,r,t,n){for(var a=[],s="",l=0,c="",f="t",u,d,g,x="H";l<e.length;)switch(c=e.charAt(l)){case"G":if(!Zl(e,l))throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(s="";(g=e.charCodeAt(++l))!==34&&l<e.length;)s+=String.fromCharCode(g);a[a.length]={t:"t",v:s},++l;break;case"\\":var p=e.charAt(++l),w=p==="("||p===")"?p:"t";a[a.length]={t:w,v:p},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:r},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(u==null&&(u=Wl(r,t,e.charAt(l+1)==="2"),u==null))return"";a[a.length]={t:"X",v:e.substr(l,2)},f=c,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||u==null&&(u=Wl(r,t),u==null))return"";for(s=c;++l<e.length&&e.charAt(l).toLowerCase()===c;)s+=c;c==="m"&&f.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=x),a[a.length]={t:c,v:s},f=c;break;case"A":case"a":case"ä¸Š":var v={t:c,v:c};if(u==null&&(u=Wl(r,t)),e.substr(l,3).toUpperCase()==="A/P"?(u!=null&&(v.v=u.H>=12?"P":"A"),v.t="T",x="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(u!=null&&(v.v=u.H>=12?"PM":"AM"),v.t="T",l+=5,x="h"):e.substr(l,5).toUpperCase()==="ä¸Šåˆ/ä¸‹åˆ"?(u!=null&&(v.v=u.H>=12?"ä¸‹åˆ":"ä¸Šåˆ"),v.t="T",l+=5,x="h"):(v.t="t",++l),u==null&&v.t==="T")return"";a[a.length]=v,f=c;break;case"[":for(s=c;e.charAt(l++)!=="]"&&l<e.length;)s+=e.charAt(l);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Gu)){if(u==null&&(u=Wl(r,t),u==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},f=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",$u(e)||(a[a.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=c;++l<e.length&&(c=e.charAt(l))==="0";)s+=c;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=c;++l<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(l))>-1;)s+=c;a[a.length]={t:"n",v:s};break;case"?":for(s=c;e.charAt(++l)===c;)s+=c;a[a.length]={t:c,v:s},f=c;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:n===1?"t":c,v:c},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=c;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)s+=e.charAt(l);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:c,v:c},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=â‚¬acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"t",v:c},++l;break}var _=0,S=0,b;for(l=a.length-1,f="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=x,f="h",_<1&&(_=1);break;case"s":(b=a[l].v.match(/\.0+$/))&&(S=Math.max(S,b[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":f=a[l].t;break;case"m":f==="s"&&(a[l].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&a[l].v.match(/[Hh]/)&&(_=1),_<2&&a[l].v.match(/[Mm]/)&&(_=2),_<3&&a[l].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var A="",E;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=Wm(a[l].t.charCodeAt(0),a[l].v,u,S),a[l].t="t";break;case"n":case"?":for(E=l+1;a[E]!=null&&((c=a[E].t)==="?"||c==="D"||(c===" "||c==="t")&&a[E+1]!=null&&(a[E+1].t==="?"||a[E+1].t==="t"&&a[E+1].v==="/")||a[l].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(a[E].v==="/"||a[E].v===" "&&a[E+1]!=null&&a[E+1].t=="?"));)a[l].v+=a[E].v,a[E]={v:"",t:";"},++E;A+=a[l].v,l=E-1;break;case"G":a[l].t="t",a[l].v=Hc(r,t);break}var U="",R,L;if(A.length>0){A.charCodeAt(0)==40?(R=r<0&&A.charCodeAt(0)===45?-r:r,L=Wa("n",A,R)):(R=r<0&&n>1?-r:r,L=Wa("n",A,R),R<0&&a[0]&&a[0].t=="t"&&(L=L.substr(1),a[0].v="-"+a[0].v)),E=L.length-1;var C=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){C=l;break}var P=a.length;if(C===a.length&&L.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(E>=a[l].v.length-1?(E-=a[l].v.length,a[l].v=L.substr(E+1,a[l].v.length)):E<0?a[l].v="":(a[l].v=L.substr(0,E+1),E=-1),a[l].t="t",P=l);E>=0&&P<a.length&&(a[P].v=L.substr(0,E+1)+a[P].v)}else if(C!==a.length&&L.indexOf("E")===-1){for(E=L.indexOf(".")-1,l=C;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(d=a[l].v.indexOf(".")>-1&&l===C?a[l].v.indexOf(".")-1:a[l].v.length-1,U=a[l].v.substr(d+1);d>=0;--d)E>=0&&(a[l].v.charAt(d)==="0"||a[l].v.charAt(d)==="#")&&(U=L.charAt(E--)+U);a[l].v=U,a[l].t="t",P=l}for(E>=0&&P<a.length&&(a[P].v=L.substr(0,E+1)+a[P].v),E=L.indexOf(".")+1,l=C;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==C)){for(d=a[l].v.indexOf(".")>-1&&l===C?a[l].v.indexOf(".")+1:0,U=a[l].v.substr(0,d);d<a[l].v.length;++d)E<L.length&&(U+=L.charAt(E++));a[l].v=U,a[l].t="t",P=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(R=n>1&&r<0&&l>0&&a[l-1].v==="-"?-r:r,a[l].v=Wa(a[l].t,a[l].v,R),a[l].t="t");var W="";for(l=0;l!==a.length;++l)a[l]!=null&&(W+=a[l].v);return W}var Eh=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Fh(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function Qm(e,r){var t=Jm(e),n=t.length,a=t[n-1].indexOf("@");if(n<4&&a>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||a>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=a>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=a>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=a>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var l=t[0].match(Eh),c=t[1].match(Eh);return Fh(r,l)?[n,t[0]]:Fh(r,c)?[n,t[1]]:[n,t[l!=null&&c!=null?2:1]]}return[n,s]}function yi(e,r,t){t==null&&(t={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?n=t.dateNF:n=e;break;case"number":e==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:gr)[e],n==null&&(n=t.table&&t.table[jh[e]]||gr[jh[e]]),n==null&&(n=Om[e]||"General");break}if(Zl(n,0))return Hc(r,t);r instanceof Date&&(r=Mu(r,t.date1904));var a=Qm(n,r);if(Zl(a[1]))return Hc(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return Zm(a[1],r,t,a[0])}function Yu(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(gr[t]==null){r<0&&(r=t);continue}if(gr[t]==e){r=t;break}}r<0&&(r=391)}return gr[r]=e,r}function p0(e){for(var r=0;r!=392;++r)e[r]!==void 0&&Yu(e[r],r)}function m0(){gr=Pm()}var Xu=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function eg(e){var r=typeof e=="number"?gr[e]:e;return r=r.replace(Xu,"(\\d+)"),new RegExp("^"+r+"$")}function tg(e,r,t){var n=-1,a=-1,s=-1,l=-1,c=-1,f=-1;(r.match(Xu)||[]).forEach(function(g,x){var p=parseInt(t[x+1],10);switch(g.toLowerCase().charAt(0)){case"y":n=p;break;case"d":s=p;break;case"h":l=p;break;case"s":f=p;break;case"m":l>=0?c=p:a=p;break}}),f>=0&&c==-1&&a>=0&&(c=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return l==-1&&c==-1&&f==-1?u:n==-1&&a==-1&&s==-1?d:u+"T"+d}var rg=function(){var e={};e.version="1.2.0";function r(){for(var L=0,C=new Array(256),P=0;P!=256;++P)L=P,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,C[P]=L;return typeof Int32Array<"u"?new Int32Array(C):C}var t=r();function n(L){var C=0,P=0,W=0,k=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(W=0;W!=256;++W)k[W]=L[W];for(W=0;W!=256;++W)for(P=L[W],C=256+W;C<4096;C+=256)P=k[C]=P>>>8^L[P&255];var T=[];for(W=1;W!=16;++W)T[W-1]=typeof Int32Array<"u"?k.subarray(W*256,W*256+256):k.slice(W*256,W*256+256);return T}var a=n(t),s=a[0],l=a[1],c=a[2],f=a[3],u=a[4],d=a[5],g=a[6],x=a[7],p=a[8],w=a[9],v=a[10],_=a[11],S=a[12],b=a[13],A=a[14];function E(L,C){for(var P=C^-1,W=0,k=L.length;W<k;)P=P>>>8^t[(P^L.charCodeAt(W++))&255];return~P}function U(L,C){for(var P=C^-1,W=L.length-15,k=0;k<W;)P=A[L[k++]^P&255]^b[L[k++]^P>>8&255]^S[L[k++]^P>>16&255]^_[L[k++]^P>>>24]^v[L[k++]]^w[L[k++]]^p[L[k++]]^x[L[k++]]^g[L[k++]]^d[L[k++]]^u[L[k++]]^f[L[k++]]^c[L[k++]]^l[L[k++]]^s[L[k++]]^t[L[k++]];for(W+=15;k<W;)P=P>>>8^t[(P^L[k++])&255];return~P}function R(L,C){for(var P=C^-1,W=0,k=L.length,T=0,H=0;W<k;)T=L.charCodeAt(W++),T<128?P=P>>>8^t[(P^T)&255]:T<2048?(P=P>>>8^t[(P^(192|T>>6&31))&255],P=P>>>8^t[(P^(128|T&63))&255]):T>=55296&&T<57344?(T=(T&1023)+64,H=L.charCodeAt(W++)&1023,P=P>>>8^t[(P^(240|T>>8&7))&255],P=P>>>8^t[(P^(128|T>>2&63))&255],P=P>>>8^t[(P^(128|H>>6&15|(T&3)<<4))&255],P=P>>>8^t[(P^(128|H&63))&255]):(P=P>>>8^t[(P^(224|T>>12&15))&255],P=P>>>8^t[(P^(128|T>>6&63))&255],P=P>>>8^t[(P^(128|T&63))&255]);return~P}return e.table=t,e.bstr=E,e.buf=U,e.str=R,e}(),Zt=function(){var r={};r.version="1.2.1";function t(q,ne){for(var Z=q.split("/"),ee=ne.split("/"),re=0,ie=0,_e=Math.min(Z.length,ee.length);re<_e;++re){if(ie=Z[re].length-ee[re].length)return ie;if(Z[re]!=ee[re])return Z[re]<ee[re]?-1:1}return Z.length-ee.length}function n(q){if(q.charAt(q.length-1)=="/")return q.slice(0,-1).indexOf("/")===-1?q:n(q.slice(0,-1));var ne=q.lastIndexOf("/");return ne===-1?q:q.slice(0,ne+1)}function a(q){if(q.charAt(q.length-1)=="/")return a(q.slice(0,-1));var ne=q.lastIndexOf("/");return ne===-1?q:q.slice(ne+1)}function s(q,ne){typeof ne=="string"&&(ne=new Date(ne));var Z=ne.getHours();Z=Z<<6|ne.getMinutes(),Z=Z<<5|ne.getSeconds()>>>1,q.write_shift(2,Z);var ee=ne.getFullYear()-1980;ee=ee<<4|ne.getMonth()+1,ee=ee<<5|ne.getDate(),q.write_shift(2,ee)}function l(q){var ne=q.read_shift(2)&65535,Z=q.read_shift(2)&65535,ee=new Date,re=Z&31;Z>>>=5;var ie=Z&15;Z>>>=4,ee.setMilliseconds(0),ee.setFullYear(Z+1980),ee.setMonth(ie-1),ee.setDate(re);var _e=ne&31;ne>>>=5;var Fe=ne&63;return ne>>>=6,ee.setHours(ne),ee.setMinutes(Fe),ee.setSeconds(_e<<1),ee}function c(q){Pn(q,0);for(var ne={},Z=0;q.l<=q.length-4;){var ee=q.read_shift(2),re=q.read_shift(2),ie=q.l+re,_e={};switch(ee){case 21589:Z=q.read_shift(1),Z&1&&(_e.mtime=q.read_shift(4)),re>5&&(Z&2&&(_e.atime=q.read_shift(4)),Z&4&&(_e.ctime=q.read_shift(4))),_e.mtime&&(_e.mt=new Date(_e.mtime*1e3));break}q.l=ie,ne[ee]=_e}return ne}var f;function u(){return f||(f={})}function d(q,ne){if(q[0]==80&&q[1]==75)return sr(q,ne);if((q[0]|32)==109&&(q[1]|32)==105)return Un(q,ne);if(q.length<512)throw new Error("CFB file size "+q.length+" < 512");var Z=3,ee=512,re=0,ie=0,_e=0,Fe=0,Ne=0,je=[],ke=q.slice(0,512);Pn(ke,0);var qe=g(ke);switch(Z=qe[0],Z){case 3:ee=512;break;case 4:ee=4096;break;case 0:if(qe[1]==0)return sr(q,ne);default:throw new Error("Major Version: Expected 3 or 4 saw "+Z)}ee!==512&&(ke=q.slice(0,ee),Pn(ke,28));var Ye=q.slice(0,ee);x(ke,Z);var at=ke.read_shift(4,"i");if(Z===3&&at!==0)throw new Error("# Directory Sectors: Expected 0 saw "+at);ke.l+=4,_e=ke.read_shift(4,"i"),ke.l+=4,ke.chk("00100000","Mini Stream Cutoff Size: "),Fe=ke.read_shift(4,"i"),re=ke.read_shift(4,"i"),Ne=ke.read_shift(4,"i"),ie=ke.read_shift(4,"i");for(var Ge=-1,nt=0;nt<109&&(Ge=ke.read_shift(4,"i"),!(Ge<0));++nt)je[nt]=Ge;var vt=p(q,ee);_(Ne,ie,vt,ee,je);var zt=b(vt,_e,je,ee);zt[_e].name="!Directory",re>0&&Fe!==H&&(zt[Fe].name="!MiniFAT"),zt[je[0]].name="!FAT",zt.fat_addrs=je,zt.ssz=ee;var Kt={},Sr=[],Qn=[],Ca=[];A(_e,zt,vt,Sr,re,Kt,Qn,Fe),w(Qn,Ca,Sr),Sr.shift();var xa={FileIndex:Qn,FullPaths:Ca};return ne&&ne.raw&&(xa.raw={header:Ye,sectors:vt}),xa}function g(q){if(q[q.l]==80&&q[q.l+1]==75)return[0,0];q.chk(G,"Header Signature: "),q.l+=16;var ne=q.read_shift(2,"u");return[q.read_shift(2,"u"),ne]}function x(q,ne){var Z=9;switch(q.l+=2,Z=q.read_shift(2)){case 9:if(ne!=3)throw new Error("Sector Shift: Expected 9 saw "+Z);break;case 12:if(ne!=4)throw new Error("Sector Shift: Expected 12 saw "+Z);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Z)}q.chk("0600","Mini Sector Shift: "),q.chk("000000000000","Reserved: ")}function p(q,ne){for(var Z=Math.ceil(q.length/ne)-1,ee=[],re=1;re<Z;++re)ee[re-1]=q.slice(re*ne,(re+1)*ne);return ee[Z-1]=q.slice(Z*ne),ee}function w(q,ne,Z){for(var ee=0,re=0,ie=0,_e=0,Fe=0,Ne=Z.length,je=[],ke=[];ee<Ne;++ee)je[ee]=ke[ee]=ee,ne[ee]=Z[ee];for(;Fe<ke.length;++Fe)ee=ke[Fe],re=q[ee].L,ie=q[ee].R,_e=q[ee].C,je[ee]===ee&&(re!==-1&&je[re]!==re&&(je[ee]=je[re]),ie!==-1&&je[ie]!==ie&&(je[ee]=je[ie])),_e!==-1&&(je[_e]=ee),re!==-1&&ee!=je[ee]&&(je[re]=je[ee],ke.lastIndexOf(re)<Fe&&ke.push(re)),ie!==-1&&ee!=je[ee]&&(je[ie]=je[ee],ke.lastIndexOf(ie)<Fe&&ke.push(ie));for(ee=1;ee<Ne;++ee)je[ee]===ee&&(ie!==-1&&je[ie]!==ie?je[ee]=je[ie]:re!==-1&&je[re]!==re&&(je[ee]=je[re]));for(ee=1;ee<Ne;++ee)if(q[ee].type!==0){if(Fe=ee,Fe!=je[Fe])do Fe=je[Fe],ne[ee]=ne[Fe]+"/"+ne[ee];while(Fe!==0&&je[Fe]!==-1&&Fe!=je[Fe]);je[ee]=-1}for(ne[0]+="/",ee=1;ee<Ne;++ee)q[ee].type!==2&&(ne[ee]+="/")}function v(q,ne,Z){for(var ee=q.start,re=q.size,ie=[],_e=ee;Z&&re>0&&_e>=0;)ie.push(ne.slice(_e*T,_e*T+T)),re-=T,_e=Oi(Z,_e*4);return ie.length===0?Pe(0):$r(ie).slice(0,q.size)}function _(q,ne,Z,ee,re){var ie=H;if(q===H){if(ne!==0)throw new Error("DIFAT chain shorter than expected")}else if(q!==-1){var _e=Z[q],Fe=(ee>>>2)-1;if(!_e)return;for(var Ne=0;Ne<Fe&&(ie=Oi(_e,Ne*4))!==H;++Ne)re.push(ie);_(Oi(_e,ee-4),ne-1,Z,ee,re)}}function S(q,ne,Z,ee,re){var ie=[],_e=[];re||(re=[]);var Fe=ee-1,Ne=0,je=0;for(Ne=ne;Ne>=0;){re[Ne]=!0,ie[ie.length]=Ne,_e.push(q[Ne]);var ke=Z[Math.floor(Ne*4/ee)];if(je=Ne*4&Fe,ee<4+je)throw new Error("FAT boundary crossed: "+Ne+" 4 "+ee);if(!q[ke])break;Ne=Oi(q[ke],je)}return{nodes:ie,data:Mh([_e])}}function b(q,ne,Z,ee){var re=q.length,ie=[],_e=[],Fe=[],Ne=[],je=ee-1,ke=0,qe=0,Ye=0,at=0;for(ke=0;ke<re;++ke)if(Fe=[],Ye=ke+ne,Ye>=re&&(Ye-=re),!_e[Ye]){Ne=[];var Ge=[];for(qe=Ye;qe>=0;){Ge[qe]=!0,_e[qe]=!0,Fe[Fe.length]=qe,Ne.push(q[qe]);var nt=Z[Math.floor(qe*4/ee)];if(at=qe*4&je,ee<4+at)throw new Error("FAT boundary crossed: "+qe+" 4 "+ee);if(!q[nt]||(qe=Oi(q[nt],at),Ge[qe]))break}ie[Ye]={nodes:Fe,data:Mh([Ne])}}return ie}function A(q,ne,Z,ee,re,ie,_e,Fe){for(var Ne=0,je=ee.length?2:0,ke=ne[q].data,qe=0,Ye=0,at;qe<ke.length;qe+=128){var Ge=ke.slice(qe,qe+128);Pn(Ge,64),Ye=Ge.read_shift(2),at=rf(Ge,0,Ye-je),ee.push(at);var nt={name:at,type:Ge.read_shift(1),color:Ge.read_shift(1),L:Ge.read_shift(4,"i"),R:Ge.read_shift(4,"i"),C:Ge.read_shift(4,"i"),clsid:Ge.read_shift(16),state:Ge.read_shift(4,"i"),start:0,size:0},vt=Ge.read_shift(2)+Ge.read_shift(2)+Ge.read_shift(2)+Ge.read_shift(2);vt!==0&&(nt.ct=E(Ge,Ge.l-8));var zt=Ge.read_shift(2)+Ge.read_shift(2)+Ge.read_shift(2)+Ge.read_shift(2);zt!==0&&(nt.mt=E(Ge,Ge.l-8)),nt.start=Ge.read_shift(4,"i"),nt.size=Ge.read_shift(4,"i"),nt.size<0&&nt.start<0&&(nt.size=nt.type=0,nt.start=H,nt.name=""),nt.type===5?(Ne=nt.start,re>0&&Ne!==H&&(ne[Ne].name="!StreamData")):nt.size>=4096?(nt.storage="fat",ne[nt.start]===void 0&&(ne[nt.start]=S(Z,nt.start,ne.fat_addrs,ne.ssz)),ne[nt.start].name=nt.name,nt.content=ne[nt.start].data.slice(0,nt.size)):(nt.storage="minifat",nt.size<0?nt.size=0:Ne!==H&&nt.start!==H&&ne[Ne]&&(nt.content=v(nt,ne[Ne].data,(ne[Fe]||{}).data))),nt.content&&Pn(nt.content,0),ie[at]=nt,_e.push(nt)}}function E(q,ne){return new Date((In(q,ne+4)/1e7*Math.pow(2,32)+In(q,ne)/1e7-11644473600)*1e3)}function U(q,ne){return u(),d(f.readFileSync(q),ne)}function R(q,ne){var Z=ne&&ne.type;switch(Z||Ht&&Buffer.isBuffer(q)&&(Z="buffer"),Z||"base64"){case"file":return U(q,ne);case"base64":return d(ha(Va(q)),ne);case"binary":return d(ha(q),ne)}return d(q,ne)}function L(q,ne){var Z=ne||{},ee=Z.root||"Root Entry";if(q.FullPaths||(q.FullPaths=[]),q.FileIndex||(q.FileIndex=[]),q.FullPaths.length!==q.FileIndex.length)throw new Error("inconsistent CFB structure");q.FullPaths.length===0&&(q.FullPaths[0]=ee+"/",q.FileIndex[0]={name:ee,type:5}),Z.CLSID&&(q.FileIndex[0].clsid=Z.CLSID),C(q)}function C(q){var ne="Sh33tJ5";if(!Zt.find(q,"/"+ne)){var Z=Pe(4);Z[0]=55,Z[1]=Z[3]=50,Z[2]=54,q.FileIndex.push({name:ne,type:2,content:Z,size:4,L:69,R:69,C:69}),q.FullPaths.push(q.FullPaths[0]+ne),P(q)}}function P(q,ne){L(q);for(var Z=!1,ee=!1,re=q.FullPaths.length-1;re>=0;--re){var ie=q.FileIndex[re];switch(ie.type){case 0:ee?Z=!0:(q.FileIndex.pop(),q.FullPaths.pop());break;case 1:case 2:case 5:ee=!0,isNaN(ie.R*ie.L*ie.C)&&(Z=!0),ie.R>-1&&ie.L>-1&&ie.R==ie.L&&(Z=!0);break;default:Z=!0;break}}if(!(!Z&&!ne)){var _e=new Date(1987,1,19),Fe=0,Ne=Object.create?Object.create(null):{},je=[];for(re=0;re<q.FullPaths.length;++re)Ne[q.FullPaths[re]]=!0,q.FileIndex[re].type!==0&&je.push([q.FullPaths[re],q.FileIndex[re]]);for(re=0;re<je.length;++re){var ke=n(je[re][0]);ee=Ne[ke],ee||(je.push([ke,{name:a(ke).replace("/",""),type:1,clsid:J,ct:_e,mt:_e,content:null}]),Ne[ke]=!0)}for(je.sort(function(at,Ge){return t(at[0],Ge[0])}),q.FullPaths=[],q.FileIndex=[],re=0;re<je.length;++re)q.FullPaths[re]=je[re][0],q.FileIndex[re]=je[re][1];for(re=0;re<je.length;++re){var qe=q.FileIndex[re],Ye=q.FullPaths[re];if(qe.name=a(Ye).replace("/",""),qe.L=qe.R=qe.C=-(qe.color=1),qe.size=qe.content?qe.content.length:0,qe.start=0,qe.clsid=qe.clsid||J,re===0)qe.C=je.length>1?1:-1,qe.size=0,qe.type=5;else if(Ye.slice(-1)=="/"){for(Fe=re+1;Fe<je.length&&n(q.FullPaths[Fe])!=Ye;++Fe);for(qe.C=Fe>=je.length?-1:Fe,Fe=re+1;Fe<je.length&&n(q.FullPaths[Fe])!=n(Ye);++Fe);qe.R=Fe>=je.length?-1:Fe,qe.type=1}else n(q.FullPaths[re+1]||"")==n(Ye)&&(qe.R=re+1),qe.type=2}}}function W(q,ne){var Z=ne||{};if(Z.fileType=="mad")return dt(q,Z);switch(P(q),Z.fileType){case"zip":return Zn(q,Z)}var ee=function(at){for(var Ge=0,nt=0,vt=0;vt<at.FileIndex.length;++vt){var zt=at.FileIndex[vt];if(zt.content){var Kt=zt.content.length;Kt>0&&(Kt<4096?Ge+=Kt+63>>6:nt+=Kt+511>>9)}}for(var Sr=at.FullPaths.length+3>>2,Qn=Ge+7>>3,Ca=Ge+127>>7,xa=Qn+nt+Sr+Ca,ea=xa+127>>7,va=ea<=109?0:Math.ceil((ea-109)/127);xa+ea+va+127>>7>ea;)va=++ea<=109?0:Math.ceil((ea-109)/127);var kn=[1,va,ea,Ca,Sr,nt,Ge,0];return at.FileIndex[0].size=Ge<<6,kn[7]=(at.FileIndex[0].start=kn[0]+kn[1]+kn[2]+kn[3]+kn[4]+kn[5])+(kn[6]+7>>3),kn}(q),re=Pe(ee[7]<<9),ie=0,_e=0;{for(ie=0;ie<8;++ie)re.write_shift(1,ce[ie]);for(ie=0;ie<8;++ie)re.write_shift(2,0);for(re.write_shift(2,62),re.write_shift(2,3),re.write_shift(2,65534),re.write_shift(2,9),re.write_shift(2,6),ie=0;ie<3;++ie)re.write_shift(2,0);for(re.write_shift(4,0),re.write_shift(4,ee[2]),re.write_shift(4,ee[0]+ee[1]+ee[2]+ee[3]-1),re.write_shift(4,0),re.write_shift(4,4096),re.write_shift(4,ee[3]?ee[0]+ee[1]+ee[2]-1:H),re.write_shift(4,ee[3]),re.write_shift(-4,ee[1]?ee[0]-1:H),re.write_shift(4,ee[1]),ie=0;ie<109;++ie)re.write_shift(-4,ie<ee[2]?ee[1]+ie:-1)}if(ee[1])for(_e=0;_e<ee[1];++_e){for(;ie<236+_e*127;++ie)re.write_shift(-4,ie<ee[2]?ee[1]+ie:-1);re.write_shift(-4,_e===ee[1]-1?H:_e+1)}var Fe=function(at){for(_e+=at;ie<_e-1;++ie)re.write_shift(-4,ie+1);at&&(++ie,re.write_shift(-4,H))};for(_e=ie=0,_e+=ee[1];ie<_e;++ie)re.write_shift(-4,Q.DIFSECT);for(_e+=ee[2];ie<_e;++ie)re.write_shift(-4,Q.FATSECT);Fe(ee[3]),Fe(ee[4]);for(var Ne=0,je=0,ke=q.FileIndex[0];Ne<q.FileIndex.length;++Ne)ke=q.FileIndex[Ne],ke.content&&(je=ke.content.length,!(je<4096)&&(ke.start=_e,Fe(je+511>>9)));for(Fe(ee[6]+7>>3);re.l&511;)re.write_shift(-4,Q.ENDOFCHAIN);for(_e=ie=0,Ne=0;Ne<q.FileIndex.length;++Ne)ke=q.FileIndex[Ne],ke.content&&(je=ke.content.length,!(!je||je>=4096)&&(ke.start=_e,Fe(je+63>>6)));for(;re.l&511;)re.write_shift(-4,Q.ENDOFCHAIN);for(ie=0;ie<ee[4]<<2;++ie){var qe=q.FullPaths[ie];if(!qe||qe.length===0){for(Ne=0;Ne<17;++Ne)re.write_shift(4,0);for(Ne=0;Ne<3;++Ne)re.write_shift(4,-1);for(Ne=0;Ne<12;++Ne)re.write_shift(4,0);continue}ke=q.FileIndex[ie],ie===0&&(ke.start=ke.size?ke.start-1:H);var Ye=ie===0&&Z.root||ke.name;if(je=2*(Ye.length+1),re.write_shift(64,Ye,"utf16le"),re.write_shift(2,je),re.write_shift(1,ke.type),re.write_shift(1,ke.color),re.write_shift(-4,ke.L),re.write_shift(-4,ke.R),re.write_shift(-4,ke.C),ke.clsid)re.write_shift(16,ke.clsid,"hex");else for(Ne=0;Ne<4;++Ne)re.write_shift(4,0);re.write_shift(4,ke.state||0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,ke.start),re.write_shift(4,ke.size),re.write_shift(4,0)}for(ie=1;ie<q.FileIndex.length;++ie)if(ke=q.FileIndex[ie],ke.size>=4096)if(re.l=ke.start+1<<9,Ht&&Buffer.isBuffer(ke.content))ke.content.copy(re,re.l,0,ke.size),re.l+=ke.size+511&-512;else{for(Ne=0;Ne<ke.size;++Ne)re.write_shift(1,ke.content[Ne]);for(;Ne&511;++Ne)re.write_shift(1,0)}for(ie=1;ie<q.FileIndex.length;++ie)if(ke=q.FileIndex[ie],ke.size>0&&ke.size<4096)if(Ht&&Buffer.isBuffer(ke.content))ke.content.copy(re,re.l,0,ke.size),re.l+=ke.size+63&-64;else{for(Ne=0;Ne<ke.size;++Ne)re.write_shift(1,ke.content[Ne]);for(;Ne&63;++Ne)re.write_shift(1,0)}if(Ht)re.l=re.length;else for(;re.l<re.length;)re.write_shift(1,0);return re}function k(q,ne){var Z=q.FullPaths.map(function(Ne){return Ne.toUpperCase()}),ee=Z.map(function(Ne){var je=Ne.split("/");return je[je.length-(Ne.slice(-1)=="/"?2:1)]}),re=!1;ne.charCodeAt(0)===47?(re=!0,ne=Z[0].slice(0,-1)+ne):re=ne.indexOf("/")!==-1;var ie=ne.toUpperCase(),_e=re===!0?Z.indexOf(ie):ee.indexOf(ie);if(_e!==-1)return q.FileIndex[_e];var Fe=!ie.match(Hl);for(ie=ie.replace(So,""),Fe&&(ie=ie.replace(Hl,"!")),_e=0;_e<Z.length;++_e)if((Fe?Z[_e].replace(Hl,"!"):Z[_e]).replace(So,"")==ie||(Fe?ee[_e].replace(Hl,"!"):ee[_e]).replace(So,"")==ie)return q.FileIndex[_e];return null}var T=64,H=-2,G="d0cf11e0a1b11ae1",ce=[208,207,17,224,161,177,26,225],J="00000000000000000000000000000000",Q={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:H,FREESECT:-1,HEADER_SIGNATURE:G,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:J,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function oe(q,ne,Z){u();var ee=W(q,Z);f.writeFileSync(ne,ee)}function ae(q){for(var ne=new Array(q.length),Z=0;Z<q.length;++Z)ne[Z]=String.fromCharCode(q[Z]);return ne.join("")}function ge(q,ne){var Z=W(q,ne);switch(ne&&ne.type||"buffer"){case"file":return u(),f.writeFileSync(ne.filename,Z),Z;case"binary":return typeof Z=="string"?Z:ae(Z);case"base64":return Po(typeof Z=="string"?Z:ae(Z));case"buffer":if(Ht)return Buffer.isBuffer(Z)?Z:$a(Z);case"array":return typeof Z=="string"?ha(Z):Z}return Z}var ve;function j(q){try{var ne=q.InflateRaw,Z=new ne;if(Z._processChunk(new Uint8Array([3,0]),Z._finishFlushFlag),Z.bytesRead)ve=q;else throw new Error("zlib does not expose bytesRead")}catch(ee){console.error("cannot use native zlib: "+(ee.message||ee))}}function O(q,ne){if(!ve)return Dt(q,ne);var Z=ve.InflateRaw,ee=new Z,re=ee._processChunk(q.slice(q.l),ee._finishFlushFlag);return q.l+=ee.bytesRead,re}function I(q){return ve?ve.deflateRawSync(q):kt(q)}var D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],X=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],fe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function he(q){var ne=(q<<1|q<<11)&139536|(q<<5|q<<15)&558144;return(ne>>16|ne>>8|ne)&255}for(var ue=typeof Uint8Array<"u",be=ue?new Uint8Array(256):[],Oe=0;Oe<256;++Oe)be[Oe]=he(Oe);function Me(q,ne){var Z=be[q&255];return ne<=8?Z>>>8-ne:(Z=Z<<8|be[q>>8&255],ne<=16?Z>>>16-ne:(Z=Z<<8|be[q>>16&255],Z>>>24-ne))}function Ve(q,ne){var Z=ne&7,ee=ne>>>3;return(q[ee]|(Z<=6?0:q[ee+1]<<8))>>>Z&3}function Je(q,ne){var Z=ne&7,ee=ne>>>3;return(q[ee]|(Z<=5?0:q[ee+1]<<8))>>>Z&7}function Ee(q,ne){var Z=ne&7,ee=ne>>>3;return(q[ee]|(Z<=4?0:q[ee+1]<<8))>>>Z&15}function le(q,ne){var Z=ne&7,ee=ne>>>3;return(q[ee]|(Z<=3?0:q[ee+1]<<8))>>>Z&31}function Be(q,ne){var Z=ne&7,ee=ne>>>3;return(q[ee]|(Z<=1?0:q[ee+1]<<8))>>>Z&127}function it(q,ne,Z){var ee=ne&7,re=ne>>>3,ie=(1<<Z)-1,_e=q[re]>>>ee;return Z<8-ee||(_e|=q[re+1]<<8-ee,Z<16-ee)||(_e|=q[re+2]<<16-ee,Z<24-ee)||(_e|=q[re+3]<<24-ee),_e&ie}function We(q,ne,Z){var ee=ne&7,re=ne>>>3;return ee<=5?q[re]|=(Z&7)<<ee:(q[re]|=Z<<ee&255,q[re+1]=(Z&7)>>8-ee),ne+3}function $e(q,ne,Z){var ee=ne&7,re=ne>>>3;return Z=(Z&1)<<ee,q[re]|=Z,ne+1}function Ze(q,ne,Z){var ee=ne&7,re=ne>>>3;return Z<<=ee,q[re]|=Z&255,Z>>>=8,q[re+1]=Z,ne+8}function et(q,ne,Z){var ee=ne&7,re=ne>>>3;return Z<<=ee,q[re]|=Z&255,Z>>>=8,q[re+1]=Z&255,q[re+2]=Z>>>8,ne+16}function ft(q,ne){var Z=q.length,ee=2*Z>ne?2*Z:ne+5,re=0;if(Z>=ne)return q;if(Ht){var ie=_h(ee);if(q.copy)q.copy(ie);else for(;re<q.length;++re)ie[re]=q[re];return ie}else if(ue){var _e=new Uint8Array(ee);if(_e.set)_e.set(q);else for(;re<Z;++re)_e[re]=q[re];return _e}return q.length=ee,q}function ht(q){for(var ne=new Array(q),Z=0;Z<q;++Z)ne[Z]=0;return ne}function yt(q,ne,Z){var ee=1,re=0,ie=0,_e=0,Fe=0,Ne=q.length,je=ue?new Uint16Array(32):ht(32);for(ie=0;ie<32;++ie)je[ie]=0;for(ie=Ne;ie<Z;++ie)q[ie]=0;Ne=q.length;var ke=ue?new Uint16Array(Ne):ht(Ne);for(ie=0;ie<Ne;++ie)je[re=q[ie]]++,ee<re&&(ee=re),ke[ie]=0;for(je[0]=0,ie=1;ie<=ee;++ie)je[ie+16]=Fe=Fe+je[ie-1]<<1;for(ie=0;ie<Ne;++ie)Fe=q[ie],Fe!=0&&(ke[ie]=je[Fe+16]++);var qe=0;for(ie=0;ie<Ne;++ie)if(qe=q[ie],qe!=0)for(Fe=Me(ke[ie],ee)>>ee-qe,_e=(1<<ee+4-qe)-1;_e>=0;--_e)ne[Fe|_e<<qe]=qe&15|ie<<4;return ee}var At=ue?new Uint16Array(512):ht(512),Ft=ue?new Uint16Array(32):ht(32);if(!ue){for(var Ct=0;Ct<512;++Ct)At[Ct]=0;for(Ct=0;Ct<32;++Ct)Ft[Ct]=0}(function(){for(var q=[],ne=0;ne<32;ne++)q.push(5);yt(q,Ft,32);var Z=[];for(ne=0;ne<=143;ne++)Z.push(8);for(;ne<=255;ne++)Z.push(9);for(;ne<=279;ne++)Z.push(7);for(;ne<=287;ne++)Z.push(8);yt(Z,At,288)})();var gt=function(){for(var ne=ue?new Uint8Array(32768):[],Z=0,ee=0;Z<fe.length-1;++Z)for(;ee<fe[Z+1];++ee)ne[ee]=Z;for(;ee<32768;++ee)ne[ee]=29;var re=ue?new Uint8Array(259):[];for(Z=0,ee=0;Z<X.length-1;++Z)for(;ee<X[Z+1];++ee)re[ee]=Z;function ie(Fe,Ne){for(var je=0;je<Fe.length;){var ke=Math.min(65535,Fe.length-je),qe=je+ke==Fe.length;for(Ne.write_shift(1,+qe),Ne.write_shift(2,ke),Ne.write_shift(2,~ke&65535);ke-- >0;)Ne[Ne.l++]=Fe[je++]}return Ne.l}function _e(Fe,Ne){for(var je=0,ke=0,qe=ue?new Uint16Array(32768):[];ke<Fe.length;){var Ye=Math.min(65535,Fe.length-ke);if(Ye<10){for(je=We(Ne,je,+(ke+Ye==Fe.length)),je&7&&(je+=8-(je&7)),Ne.l=je/8|0,Ne.write_shift(2,Ye),Ne.write_shift(2,~Ye&65535);Ye-- >0;)Ne[Ne.l++]=Fe[ke++];je=Ne.l*8;continue}je=We(Ne,je,+(ke+Ye==Fe.length)+2);for(var at=0;Ye-- >0;){var Ge=Fe[ke];at=(at<<5^Ge)&32767;var nt=-1,vt=0;if((nt=qe[at])&&(nt|=ke&-32768,nt>ke&&(nt-=32768),nt<ke))for(;Fe[nt+vt]==Fe[ke+vt]&&vt<250;)++vt;if(vt>2){Ge=re[vt],Ge<=22?je=Ze(Ne,je,be[Ge+1]>>1)-1:(Ze(Ne,je,3),je+=5,Ze(Ne,je,be[Ge-23]>>5),je+=3);var zt=Ge<8?0:Ge-4>>2;zt>0&&(et(Ne,je,vt-X[Ge]),je+=zt),Ge=ne[ke-nt],je=Ze(Ne,je,be[Ge]>>3),je-=3;var Kt=Ge<4?0:Ge-2>>1;Kt>0&&(et(Ne,je,ke-nt-fe[Ge]),je+=Kt);for(var Sr=0;Sr<vt;++Sr)qe[at]=ke&32767,at=(at<<5^Fe[ke])&32767,++ke;Ye-=vt-1}else Ge<=143?Ge=Ge+48:je=$e(Ne,je,1),je=Ze(Ne,je,be[Ge]),qe[at]=ke&32767,++ke}je=Ze(Ne,je,0)-1}return Ne.l=(je+7)/8|0,Ne.l}return function(Ne,je){return Ne.length<8?ie(Ne,je):_e(Ne,je)}}();function kt(q){var ne=Pe(50+Math.floor(q.length*1.1)),Z=gt(q,ne);return ne.slice(0,Z)}var rt=ue?new Uint16Array(32768):ht(32768),Cr=ue?new Uint16Array(32768):ht(32768),Pt=ue?new Uint16Array(128):ht(128),pn=1,Wt=1;function nr(q,ne){var Z=le(q,ne)+257;ne+=5;var ee=le(q,ne)+1;ne+=5;var re=Ee(q,ne)+4;ne+=4;for(var ie=0,_e=ue?new Uint8Array(19):ht(19),Fe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ne=1,je=ue?new Uint8Array(8):ht(8),ke=ue?new Uint8Array(8):ht(8),qe=_e.length,Ye=0;Ye<re;++Ye)_e[D[Ye]]=ie=Je(q,ne),Ne<ie&&(Ne=ie),je[ie]++,ne+=3;var at=0;for(je[0]=0,Ye=1;Ye<=Ne;++Ye)ke[Ye]=at=at+je[Ye-1]<<1;for(Ye=0;Ye<qe;++Ye)(at=_e[Ye])!=0&&(Fe[Ye]=ke[at]++);var Ge=0;for(Ye=0;Ye<qe;++Ye)if(Ge=_e[Ye],Ge!=0){at=be[Fe[Ye]]>>8-Ge;for(var nt=(1<<7-Ge)-1;nt>=0;--nt)Pt[at|nt<<Ge]=Ge&7|Ye<<3}var vt=[];for(Ne=1;vt.length<Z+ee;)switch(at=Pt[Be(q,ne)],ne+=at&7,at>>>=3){case 16:for(ie=3+Ve(q,ne),ne+=2,at=vt[vt.length-1];ie-- >0;)vt.push(at);break;case 17:for(ie=3+Je(q,ne),ne+=3;ie-- >0;)vt.push(0);break;case 18:for(ie=11+Be(q,ne),ne+=7;ie-- >0;)vt.push(0);break;default:vt.push(at),Ne<at&&(Ne=at);break}var zt=vt.slice(0,Z),Kt=vt.slice(Z);for(Ye=Z;Ye<286;++Ye)zt[Ye]=0;for(Ye=ee;Ye<30;++Ye)Kt[Ye]=0;return pn=yt(zt,rt,286),Wt=yt(Kt,Cr,30),ne}function Mn(q,ne){if(q[0]==3&&!(q[1]&3))return[Hi(ne),2];for(var Z=0,ee=0,re=_h(ne||1<<18),ie=0,_e=re.length>>>0,Fe=0,Ne=0;!(ee&1);){if(ee=Je(q,Z),Z+=3,ee>>>1)ee>>1==1?(Fe=9,Ne=5):(Z=nr(q,Z),Fe=pn,Ne=Wt);else{Z&7&&(Z+=8-(Z&7));var je=q[Z>>>3]|q[(Z>>>3)+1]<<8;if(Z+=32,je>0)for(!ne&&_e<ie+je&&(re=ft(re,ie+je),_e=re.length);je-- >0;)re[ie++]=q[Z>>>3],Z+=8;continue}for(;;){!ne&&_e<ie+32767&&(re=ft(re,ie+32767),_e=re.length);var ke=it(q,Z,Fe),qe=ee>>>1==1?At[ke]:rt[ke];if(Z+=qe&15,qe>>>=4,!(qe>>>8&255))re[ie++]=qe;else{if(qe==256)break;qe-=257;var Ye=qe<8?0:qe-4>>2;Ye>5&&(Ye=0);var at=ie+X[qe];Ye>0&&(at+=it(q,Z,Ye),Z+=Ye),ke=it(q,Z,Ne),qe=ee>>>1==1?Ft[ke]:Cr[ke],Z+=qe&15,qe>>>=4;var Ge=qe<4?0:qe-2>>1,nt=fe[qe];for(Ge>0&&(nt+=it(q,Z,Ge),Z+=Ge),!ne&&_e<at&&(re=ft(re,at+100),_e=re.length);ie<at;)re[ie]=re[ie-nt],++ie}}}return ne?[re,Z+7>>>3]:[re.slice(0,ie),Z+7>>>3]}function Dt(q,ne){var Z=q.slice(q.l||0),ee=Mn(Z,ne);return q.l+=ee[1],ee[0]}function ga(q,ne){if(q)typeof console<"u"&&console.error(ne);else throw new Error(ne)}function sr(q,ne){var Z=q;Pn(Z,0);var ee=[],re=[],ie={FileIndex:ee,FullPaths:re};L(ie,{root:ne.root});for(var _e=Z.length-4;(Z[_e]!=80||Z[_e+1]!=75||Z[_e+2]!=5||Z[_e+3]!=6)&&_e>=0;)--_e;Z.l=_e+4,Z.l+=4;var Fe=Z.read_shift(2);Z.l+=6;var Ne=Z.read_shift(4);for(Z.l=Ne,_e=0;_e<Fe;++_e){Z.l+=20;var je=Z.read_shift(4),ke=Z.read_shift(4),qe=Z.read_shift(2),Ye=Z.read_shift(2),at=Z.read_shift(2);Z.l+=8;var Ge=Z.read_shift(4),nt=c(Z.slice(Z.l+qe,Z.l+qe+Ye));Z.l+=qe+Ye+at;var vt=Z.l;Z.l=Ge+4,An(Z,je,ke,ie,nt),Z.l=vt}return ie}function An(q,ne,Z,ee,re){q.l+=2;var ie=q.read_shift(2),_e=q.read_shift(2),Fe=l(q);if(ie&8257)throw new Error("Unsupported ZIP encryption");for(var Ne=q.read_shift(4),je=q.read_shift(4),ke=q.read_shift(4),qe=q.read_shift(2),Ye=q.read_shift(2),at="",Ge=0;Ge<qe;++Ge)at+=String.fromCharCode(q[q.l++]);if(Ye){var nt=c(q.slice(q.l,q.l+Ye));(nt[21589]||{}).mt&&(Fe=nt[21589].mt),((re||{})[21589]||{}).mt&&(Fe=re[21589].mt)}q.l+=Ye;var vt=q.slice(q.l,q.l+je);switch(_e){case 8:vt=O(q,ke);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+_e)}var zt=!1;ie&8&&(Ne=q.read_shift(4),Ne==134695760&&(Ne=q.read_shift(4),zt=!0),je=q.read_shift(4),ke=q.read_shift(4)),je!=ne&&ga(zt,"Bad compressed size: "+ne+" != "+je),ke!=Z&&ga(zt,"Bad uncompressed size: "+Z+" != "+ke),mn(ee,at,vt,{unsafe:!0,mt:Fe})}function Zn(q,ne){var Z=ne||{},ee=[],re=[],ie=Pe(1),_e=Z.compression?8:0,Fe=0,Ne=0,je=0,ke=0,qe=0,Ye=q.FullPaths[0],at=Ye,Ge=q.FileIndex[0],nt=[],vt=0;for(Ne=1;Ne<q.FullPaths.length;++Ne)if(at=q.FullPaths[Ne].slice(Ye.length),Ge=q.FileIndex[Ne],!(!Ge.size||!Ge.content||at=="Sh33tJ5")){var zt=ke,Kt=Pe(at.length);for(je=0;je<at.length;++je)Kt.write_shift(1,at.charCodeAt(je)&127);Kt=Kt.slice(0,Kt.l),nt[qe]=rg.buf(Ge.content,0);var Sr=Ge.content;_e==8&&(Sr=I(Sr)),ie=Pe(30),ie.write_shift(4,67324752),ie.write_shift(2,20),ie.write_shift(2,Fe),ie.write_shift(2,_e),Ge.mt?s(ie,Ge.mt):ie.write_shift(4,0),ie.write_shift(-4,nt[qe]),ie.write_shift(4,Sr.length),ie.write_shift(4,Ge.content.length),ie.write_shift(2,Kt.length),ie.write_shift(2,0),ke+=ie.length,ee.push(ie),ke+=Kt.length,ee.push(Kt),ke+=Sr.length,ee.push(Sr),ie=Pe(46),ie.write_shift(4,33639248),ie.write_shift(2,0),ie.write_shift(2,20),ie.write_shift(2,Fe),ie.write_shift(2,_e),ie.write_shift(4,0),ie.write_shift(-4,nt[qe]),ie.write_shift(4,Sr.length),ie.write_shift(4,Ge.content.length),ie.write_shift(2,Kt.length),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(4,0),ie.write_shift(4,zt),vt+=ie.l,re.push(ie),vt+=Kt.length,re.push(Kt),++qe}return ie=Pe(22),ie.write_shift(4,101010256),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(2,qe),ie.write_shift(2,qe),ie.write_shift(4,vt),ie.write_shift(4,ke),ie.write_shift(2,0),$r([$r(ee),$r(re),ie])}var Qt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function wt(q,ne){if(q.ctype)return q.ctype;var Z=q.name||"",ee=Z.match(/\.([^\.]+)$/);return ee&&Qt[ee[1]]||ne&&(ee=(Z=ne).match(/[\.\\]([^\.\\])+$/),ee&&Qt[ee[1]])?Qt[ee[1]]:"application/octet-stream"}function Mt(q){for(var ne=Po(q),Z=[],ee=0;ee<ne.length;ee+=76)Z.push(ne.slice(ee,ee+76));return Z.join(`\r
`)+`\r
`}function Fa(q){var ne=q.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(je){var ke=je.charCodeAt(0).toString(16).toUpperCase();return"="+(ke.length==1?"0"+ke:ke)});ne=ne.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ne.charAt(0)==`
`&&(ne="=0D"+ne.slice(1)),ne=ne.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Z=[],ee=ne.split(`\r
`),re=0;re<ee.length;++re){var ie=ee[re];if(ie.length==0){Z.push("");continue}for(var _e=0;_e<ie.length;){var Fe=76,Ne=ie.slice(_e,_e+Fe);Ne.charAt(Fe-1)=="="?Fe--:Ne.charAt(Fe-2)=="="?Fe-=2:Ne.charAt(Fe-3)=="="&&(Fe-=3),Ne=ie.slice(_e,_e+Fe),_e+=Fe,_e<ie.length&&(Ne+="="),Z.push(Ne)}}return Z.join(`\r
`)}function Lr(q){for(var ne=[],Z=0;Z<q.length;++Z){for(var ee=q[Z];Z<=q.length&&ee.charAt(ee.length-1)=="=";)ee=ee.slice(0,ee.length-1)+q[++Z];ne.push(ee)}for(var re=0;re<ne.length;++re)ne[re]=ne[re].replace(/[=][0-9A-Fa-f]{2}/g,function(ie){return String.fromCharCode(parseInt(ie.slice(1),16))});return ha(ne.join(`\r
`))}function Bn(q,ne,Z){for(var ee="",re="",ie="",_e,Fe=0;Fe<10;++Fe){var Ne=ne[Fe];if(!Ne||Ne.match(/^\s*$/))break;var je=Ne.match(/^(.*?):\s*([^\s].*)$/);if(je)switch(je[1].toLowerCase()){case"content-location":ee=je[2].trim();break;case"content-type":ie=je[2].trim();break;case"content-transfer-encoding":re=je[2].trim();break}}switch(++Fe,re.toLowerCase()){case"base64":_e=ha(Va(ne.slice(Fe).join("")));break;case"quoted-printable":_e=Lr(ne.slice(Fe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+re)}var ke=mn(q,ee.slice(Z.length),_e,{unsafe:!0});ie&&(ke.ctype=ie)}function Un(q,ne){if(ae(q.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Z=ne&&ne.root||"",ee=(Ht&&Buffer.isBuffer(q)?q.toString("binary"):ae(q)).split(`\r
`),re=0,ie="";for(re=0;re<ee.length;++re)if(ie=ee[re],!!/^Content-Location:/i.test(ie)&&(ie=ie.slice(ie.indexOf("file")),Z||(Z=ie.slice(0,ie.lastIndexOf("/")+1)),ie.slice(0,Z.length)!=Z))for(;Z.length>0&&(Z=Z.slice(0,Z.length-1),Z=Z.slice(0,Z.lastIndexOf("/")+1),ie.slice(0,Z.length)!=Z););var _e=(ee[1]||"").match(/boundary="(.*?)"/);if(!_e)throw new Error("MAD cannot find boundary");var Fe="--"+(_e[1]||""),Ne=[],je=[],ke={FileIndex:Ne,FullPaths:je};L(ke);var qe,Ye=0;for(re=0;re<ee.length;++re){var at=ee[re];at!==Fe&&at!==Fe+"--"||(Ye++&&Bn(ke,ee.slice(qe,re),Z),qe=re)}return ke}function dt(q,ne){var Z=ne||{},ee=Z.boundary||"SheetJS";ee="------="+ee;for(var re=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ee.slice(2)+'"',"","",""],ie=q.FullPaths[0],_e=ie,Fe=q.FileIndex[0],Ne=1;Ne<q.FullPaths.length;++Ne)if(_e=q.FullPaths[Ne].slice(ie.length),Fe=q.FileIndex[Ne],!(!Fe.size||!Fe.content||_e=="Sh33tJ5")){_e=_e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(vt){return"_x"+vt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(vt){return"_u"+vt.charCodeAt(0).toString(16)+"_"});for(var je=Fe.content,ke=Ht&&Buffer.isBuffer(je)?je.toString("binary"):ae(je),qe=0,Ye=Math.min(1024,ke.length),at=0,Ge=0;Ge<=Ye;++Ge)(at=ke.charCodeAt(Ge))>=32&&at<128&&++qe;var nt=qe>=Ye*4/5;re.push(ee),re.push("Content-Location: "+(Z.root||"file:///C:/SheetJS/")+_e),re.push("Content-Transfer-Encoding: "+(nt?"quoted-printable":"base64")),re.push("Content-Type: "+wt(Fe,_e)),re.push(""),re.push(nt?Fa(ke):Mt(ke))}return re.push(ee+`--\r
`),re.join(`\r
`)}function jn(q){var ne={};return L(ne,q),ne}function mn(q,ne,Z,ee){var re=ee&&ee.unsafe;re||L(q);var ie=!re&&Zt.find(q,ne);if(!ie){var _e=q.FullPaths[0];ne.slice(0,_e.length)==_e?_e=ne:(_e.slice(-1)!="/"&&(_e+="/"),_e=(_e+ne).replace("//","/")),ie={name:a(ne),type:2},q.FileIndex.push(ie),q.FullPaths.push(_e),re||Zt.utils.cfb_gc(q)}return ie.content=Z,ie.size=Z?Z.length:0,ee&&(ee.CLSID&&(ie.clsid=ee.CLSID),ee.mt&&(ie.mt=ee.mt),ee.ct&&(ie.ct=ee.ct)),ie}function Jr(q,ne){L(q);var Z=Zt.find(q,ne);if(Z){for(var ee=0;ee<q.FileIndex.length;++ee)if(q.FileIndex[ee]==Z)return q.FileIndex.splice(ee,1),q.FullPaths.splice(ee,1),!0}return!1}function xr(q,ne,Z){L(q);var ee=Zt.find(q,ne);if(ee){for(var re=0;re<q.FileIndex.length;++re)if(q.FileIndex[re]==ee)return q.FileIndex[re].name=a(Z),q.FullPaths[re]=Z,!0}return!1}function fr(q){P(q,!0)}return r.find=k,r.read=R,r.parse=d,r.write=ge,r.writeFile=oe,r.utils={cfb_new:jn,cfb_add:mn,cfb_del:Jr,cfb_mov:xr,cfb_gc:fr,ReadShift:jo,CheckField:dd,prep_blob:Pn,bconcat:$r,use_zlib:j,_deflateRaw:kt,_inflateRaw:Dt,consts:Q},r}();function ng(e){return typeof e=="string"?d0(e):Array.isArray(e)?Em(e):e}function Ho(e,r,t){if(typeof Deno<"u"){if(t&&typeof r=="string")switch(t){case"utf8":r=new TextEncoder(t).encode(r);break;case"binary":r=d0(r);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(e,r)}var n=t=="utf8"?Io(r):r;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([ng(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=s,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(e);return c.open("w"),c.encoding="binary",Array.isArray(r)&&(r=Uo(r)),c.write(r),c.close(),r}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+e)}function Kr(e){for(var r=Object.keys(e),t=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(e,r[n])&&t.push(r[n]);return t}function Ch(e,r){for(var t=[],n=Kr(e),a=0;a!==n.length;++a)t[e[n[a]][r]]==null&&(t[e[n[a]][r]]=n[a]);return t}function Zc(e){for(var r=[],t=Kr(e),n=0;n!==t.length;++n)r[e[t[n]]]=t[n];return r}function g0(e){for(var r=[],t=Kr(e),n=0;n!==t.length;++n)r[e[t[n]]]=parseInt(t[n],10);return r}function ag(e){for(var r=[],t=Kr(e),n=0;n!==t.length;++n)r[e[t[n]]]==null&&(r[e[t[n]]]=[]),r[e[t[n]]].push(t[n]);return r}var e0=new Date(1899,11,30,0,0,0);function Nn(e,r){var t=e.getTime(),n=e0.getTime()+(e.getTimezoneOffset()-e0.getTimezoneOffset())*6e4;return(t-n)/(24*60*60*1e3)}var Ku=new Date,ig=e0.getTime()+(Ku.getTimezoneOffset()-e0.getTimezoneOffset())*6e4,Lh=Ku.getTimezoneOffset();function Ju(e){var r=new Date;return r.setTime(e*24*60*60*1e3+ig),r.getTimezoneOffset()!==Lh&&r.setTime(r.getTime()+(r.getTimezoneOffset()-Lh)*6e4),r}var Ph=new Date("2017-02-19T19:06:09.000Z"),Zu=isNaN(Ph.getFullYear())?new Date("2/19/17"):Ph,sg=Zu.getFullYear()==2017;function dn(e,r){var t=new Date(e);if(sg)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(Zu.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return e.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function x0(e,r){if(Ht&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var t={"â‚¬":"Â€","â€š":"Â‚",Æ’:"Âƒ","â€ž":"Â„","â€¦":"Â…","â€ ":"Â†","â€¡":"Â‡","Ë†":"Âˆ","â€°":"Â‰",Å :"ÂŠ","â€¹":"Â‹",Å’:"ÂŒ",Å½:"ÂŽ","â€˜":"Â‘","â€™":"Â’","â€œ":"Â“","â€":"Â”","â€¢":"Â•","â€“":"Â–","â€”":"Â—","Ëœ":"Â˜","â„¢":"Â™",Å¡:"Âš","â€º":"Â›",Å“:"Âœ",Å¾:"Âž",Å¸:"ÂŸ"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[â‚¬â€šÆ’â€žâ€¦â€ â€¡Ë†â€°Å â€¹Å’Å½â€˜â€™â€œâ€â€¢â€“â€”Ëœâ„¢Å¡â€ºÅ“Å¾Å¸]/g,function(s){return t[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function _n(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=_n(e[t]));return r}function pr(e,r){for(var t="";t.length<r;)t+=e;return t}function za(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return t=-t,s}),!isNaN(r=Number(n)))?r/t:r}var og=["january","february","march","april","may","june","july","august","september","october","november","december"];function Oo(e){var r=new Date(e),t=new Date(NaN),n=r.getYear(),a=r.getMonth(),s=r.getDate();if(isNaN(s))return t;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&og.indexOf(l)==-1)return t}else if(l.match(/[a-z]/))return t;return n<0||n>8099?t:(a>0||s>1)&&n!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}function Tt(e,r,t){if(e.FullPaths){if(typeof t=="string"){var n;return Ht?n=$a(t):n=Fm(t),Zt.utils.cfb_add(e,r,n)}Zt.utils.cfb_add(e,r,t)}else e.file(r,t)}function Qc(){return Zt.utils.cfb_new()}var Fr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,lg={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ef=Zc(lg),tf=/[&<>'"]/g,cg=/[\u0000-\u0008\u000b-\u001f]/g;function Yt(e){var r=e+"";return r.replace(tf,function(t){return ef[t]}).replace(cg,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Oh(e){return Yt(e).replace(/ /g,"_x0020_")}var Qu=/[\u0000-\u001f]/g;function fg(e){var r=e+"";return r.replace(tf,function(t){return ef[t]}).replace(/\n/g,"<br/>").replace(Qu,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function hg(e){var r=e+"";return r.replace(tf,function(t){return ef[t]}).replace(Qu,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function ug(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function dg(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function yc(e){for(var r="",t=0,n=0,a=0,s=0,l=0,c=0;t<e.length;){if(n=e.charCodeAt(t++),n<128){r+=String.fromCharCode(n);continue}if(a=e.charCodeAt(t++),n>191&&n<224){l=(n&31)<<6,l|=a&63,r+=String.fromCharCode(l);continue}if(s=e.charCodeAt(t++),n<240){r+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}l=e.charCodeAt(t++),c=((n&7)<<18|(a&63)<<12|(s&63)<<6|l&63)-65536,r+=String.fromCharCode(55296+(c>>>10&1023)),r+=String.fromCharCode(56320+(c&1023))}return r}function Ih(e){var r=Hi(2*e.length),t,n,a=1,s=0,l=0,c;for(n=0;n<e.length;n+=a)a=1,(c=e.charCodeAt(n))<128?t=c:c<224?(t=(c&31)*64+(e.charCodeAt(n+1)&63),a=2):c<240?(t=(c&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,t=(c&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),t-=65536,l=55296+(t>>>10&1023),t=56320+(t&1023)),l!==0&&(r[s++]=l&255,r[s++]=l>>>8,l=0),r[s++]=t%256,r[s++]=t>>>8;return r.slice(0,s).toString("ucs2")}function Dh(e){return $a(e,"binary").toString("utf8")}var zl="foo bar bazÃ¢Â˜ÂƒÃ°ÂŸÂÂ£",Ao=Ht&&(Dh(zl)==yc(zl)&&Dh||Ih(zl)==yc(zl)&&Ih)||yc,Io=Ht?function(e){return $a(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,n=0,a=0;t<e.length;)switch(n=e.charCodeAt(t++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(t++)-56320+(n<<10),r.push(String.fromCharCode(240+(a>>18&7))),r.push(String.fromCharCode(144+(a>>12&63))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},pg=function(){var e=[["nbsp"," "],["middot","Â·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),ed=/(^\s|\s$|\n)/;function Yr(e,r){return"<"+e+(r.match(ed)?' xml:space="preserve"':"")+">"+r+"</"+e+">"}function Do(e){return Kr(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function Xe(e,r,t){return"<"+e+(t!=null?Do(t):"")+(r!=null?(r.match(ed)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function Wc(e,r){try{return e.toISOString().replace(/\.\d*/,"")}catch(t){if(r)throw t}return""}function mg(e,r){switch(typeof e){case"string":var t=Xe("vt:lpwstr",Yt(e));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return Xe((e|0)==e?"vt:i4":"vt:r8",Yt(String(e)));case"boolean":return Xe("vt:bool",e?"true":"false")}if(e instanceof Date)return Xe("vt:filetime",Wc(e));throw new Error("Unable to serialize "+e)}var Ur={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Is=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],On={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function gg(e,r){for(var t=1-2*(e[r+7]>>>7),n=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),a=e[r+6]&15,s=5;s>=0;--s)a=a*256+e[r+s];return n==2047?a==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),t*Math.pow(2,n-52)*a)}function xg(e,r,t){var n=(r<0||1/r==-1/0?1:0)<<7,a=0,s=0,l=n?-r:r;isFinite(l)?l==0?a=s=0:(a=Math.floor(Math.log(l)/Math.LN2),s=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(r)?26985:0);for(var c=0;c<=5;++c,s/=256)e[t+c]=s&255;e[t+6]=(a&15)<<4|s&15,e[t+7]=a>>4|n}var Rh=function(e){for(var r=[],t=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=t)r.push.apply(r,e[0][n].slice(a,a+t));return r},Mh=Ht?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:$a(r)})):Rh(e)}:Rh,Bh=function(e,r,t){for(var n=[],a=r;a<t;a+=2)n.push(String.fromCharCode(vo(e,a)));return n.join("").replace(So,"")},rf=Ht?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(So,""):Bh(e,r,t)}:Bh,Uh=function(e,r,t){for(var n=[],a=r;a<r+t;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},td=Ht?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):Uh(e,r,t)}:Uh,Hh=function(e,r,t){for(var n=[],a=r;a<t;a++)n.push(String.fromCharCode(Ts(e,a)));return n.join("")},Wo=Ht?function(r,t,n){return Buffer.isBuffer(r)?r.toString("utf8",t,n):Hh(r,t,n)}:Hh,rd=function(e,r){var t=In(e,r);return t>0?Wo(e,r+4,r+4+t-1):""},nd=rd,ad=function(e,r){var t=In(e,r);return t>0?Wo(e,r+4,r+4+t-1):""},id=ad,sd=function(e,r){var t=2*In(e,r);return t>0?Wo(e,r+4,r+4+t-1):""},od=sd,ld=function(r,t){var n=In(r,t);return n>0?rf(r,t+4,t+4+n):""},cd=ld,fd=function(e,r){var t=In(e,r);return t>0?Wo(e,r+4,r+4+t):""},hd=fd,ud=function(e,r){return gg(e,r)},t0=ud,nf=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};Ht&&(nd=function(r,t){if(!Buffer.isBuffer(r))return rd(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},id=function(r,t){if(!Buffer.isBuffer(r))return ad(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},od=function(r,t){if(!Buffer.isBuffer(r))return sd(r,t);var n=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n-1)},cd=function(r,t){if(!Buffer.isBuffer(r))return ld(r,t);var n=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n)},hd=function(r,t){if(!Buffer.isBuffer(r))return fd(r,t);var n=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+n)},t0=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):ud(r,t)},nf=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var Ts=function(e,r){return e[r]},vo=function(e,r){return e[r+1]*256+e[r]},vg=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},In=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},Oi=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},yg=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function jo(e,r){var t="",n,a,s=[],l,c,f,u;switch(r){case"dbcs":if(u=this.l,Ht&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(f=0;f<e;++f)t+=String.fromCharCode(vo(this,u)),u+=2;e*=2;break;case"utf8":t=Wo(this,this.l,this.l+e);break;case"utf16le":e*=2,t=rf(this,this.l,this.l+e);break;case"wstr":return jo.call(this,e,"dbcs");case"lpstr-ansi":t=nd(this,this.l),e=4+In(this,this.l);break;case"lpstr-cp":t=id(this,this.l),e=4+In(this,this.l);break;case"lpwstr":t=od(this,this.l),e=4+2*In(this,this.l);break;case"lpp4":e=4+In(this,this.l),t=cd(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+In(this,this.l),t=hd(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(l=Ts(this,this.l+e++))!==0;)s.push(Ul(l));t=s.join("");break;case"_wstr":for(e=0,t="";(l=vo(this,this.l+e))!==0;)s.push(Ul(l)),e+=2;e+=2,t=s.join("");break;case"dbcs-cont":for(t="",u=this.l,f=0;f<e;++f){if(this.lens&&this.lens.indexOf(u)!==-1)return l=Ts(this,u),this.l=u+1,c=jo.call(this,e-f,l?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(Ul(vo(this,u))),u+=2}t=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",u=this.l,f=0;f!=e;++f){if(this.lens&&this.lens.indexOf(u)!==-1)return l=Ts(this,u),this.l=u+1,c=jo.call(this,e-f,l?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(Ul(Ts(this,u))),u+=1}t=s.join("");break;default:switch(e){case 1:return n=Ts(this,this.l),this.l++,n;case 2:return n=(r==="i"?vg:vo)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||!(this[this.l+3]&128)?(n=(e>0?Oi:yg)(this,this.l),this.l+=4,n):(a=In(this,this.l),this.l+=4,a);case 8:case-8:if(r==="f")return e==8?a=t0(this,this.l):a=t0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:t=td(this,this.l,e);break}}return this.l+=e,t}var wg=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},bg=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},Ng=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function _g(e,r,t){var n=0,a=0;if(t==="dbcs"){for(a=0;a!=r.length;++a)Ng(this,r.charCodeAt(a),this.l+2*a);n=2*r.length}else if(t==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=r.length;++a)this[this.l+a]=r.charCodeAt(a)&255;n=r.length}else if(t==="hex"){for(;a<e;++a)this[this.l++]=parseInt(r.slice(2*a,2*a+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(r.length,e);++a){var l=r.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,wg(this,r,this.l);break;case 8:if(n=8,t==="f"){xg(this,r,this.l);break}case 16:break;case-4:n=4,bg(this,r,this.l);break}return this.l+=n,this}function dd(e,r){var t=td(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function Pn(e,r){e.l=r,e.read_shift=jo,e.chk=dd,e.write_shift=_g}function Ta(e,r){e.l+=r}function Pe(e){var r=Hi(e);return Pn(r,0),r}function bn(){var e=[],r=Ht?256:2048,t=function(u){var d=Pe(u);return Pn(d,0),d},n=t(r),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(a(),n=t(Math.max(u+1,r)))},l=function(){return a(),$r(e)},c=function(u){a(),n=u,n.l==null&&(n.l=n.length),s(r)};return{next:s,push:c,end:l,_bufs:e}}function Ue(e,r,t,n){var a=+r,s;if(!isNaN(a)){n||(n=gw[a].p||(t||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var l=e.next(s);a<=127?l.write_shift(1,a):(l.write_shift(1,(a&127)+128),l.write_shift(1,a>>7));for(var c=0;c!=4;++c)if(n>=128)l.write_shift(1,(n&127)+128),n>>=7;else{l.write_shift(1,n);break}n>0&&nf(t)&&e.push(t)}}function ko(e,r,t){var n=_n(e);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Wh(e,r,t){var n=_n(e);return n.s=ko(n.s,r.s,t),n.e=ko(n.e,r.s,t),n}function To(e,r){if(e.cRel&&e.c<0)for(e=_n(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=_n(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=Xt(e);return!e.cRel&&e.cRel!=null&&(t=jg(t)),!e.rRel&&e.rRel!=null&&(t=Sg(t)),t}function wc(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+sn(e.s.c)+":"+(e.e.cRel?"":"$")+sn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Xr(e.s.r)+":"+(e.e.rRel?"":"$")+Xr(e.e.r):To(e.s,r.biff)+":"+To(e.e,r.biff)}function af(e){return parseInt(Ag(e),10)-1}function Xr(e){return""+(e+1)}function Sg(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Ag(e){return e.replace(/\$(\d+)$/,"$1")}function sf(e){for(var r=kg(e),t=0,n=0;n!==r.length;++n)t=26*t+r.charCodeAt(n)-64;return t-1}function sn(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function jg(e){return e.replace(/^([A-Z])/,"$$$1")}function kg(e){return e.replace(/^\$([A-Z])/,"$1")}function Tg(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Hr(e){for(var r=0,t=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?r=10*r+(a-48):a>=65&&a<=90&&(t=26*t+(a-64))}return{c:t-1,r:r-1}}function Xt(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function Rn(e){var r=e.indexOf(":");return r==-1?{s:Hr(e),e:Hr(e)}:{s:Hr(e.slice(0,r)),e:Hr(e.slice(r+1))}}function Er(e,r){return typeof r>"u"||typeof r=="number"?Er(e.s,e.e):(typeof e!="string"&&(e=Xt(e)),typeof r!="string"&&(r=Xt(r)),e==r?e:e+":"+r)}function lr(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,a=0,s=e.length;for(t=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(r.s.c=--t,t=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;if(r.s.r=--t,n===s||a!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,t=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(r.e.c=--t,t=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;return r.e.r=--t,r}function zh(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=yi(e.z,t?Nn(r):r)}catch{}try{return e.w=yi((e.XF||{}).numFmtId||(t?14:0),t?Nn(r):r)}catch{return""+r}}function Ga(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?zo[e.v]||e.v:r==null?zh(e,e.v):zh(e,r))}function Gi(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",n={};return n[t]=e,{SheetNames:[t],Sheets:n}}function pd(e,r,t){var n=t||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),l=0,c=0;if(s&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var f=typeof n.origin=="string"?Hr(n.origin):n.origin;l=f.r,c=f.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=lr(s["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),l==-1&&(u.e.r=l=d.e.r+1)}for(var g=0;g!=r.length;++g)if(r[g]){if(!Array.isArray(r[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=r[g].length;++x)if(!(typeof r[g][x]>"u")){var p={v:r[g][x]},w=l+g,v=c+x;if(u.s.r>w&&(u.s.r=w),u.s.c>v&&(u.s.c=v),u.e.r<w&&(u.e.r=w),u.e.c<v&&(u.e.c=v),r[g][x]&&typeof r[g][x]=="object"&&!Array.isArray(r[g][x])&&!(r[g][x]instanceof Date))p=r[g][x];else if(Array.isArray(p.v)&&(p.f=r[g][x][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||gr[14],n.cellDates?(p.t="d",p.w=yi(p.z,Nn(p.v))):(p.t="n",p.v=Nn(p.v),p.w=yi(p.z,p.v))):p.t="s";if(a)s[w]||(s[w]=[]),s[w][v]&&s[w][v].z&&(p.z=s[w][v].z),s[w][v]=p;else{var _=Xt({c:v,r:w});s[_]&&s[_].z&&(p.z=s[_].z),s[_]=p}}}return u.s.c<1e7&&(s["!ref"]=Er(u)),s}function Ds(e,r){return pd(null,e,r)}function Eg(e){return e.read_shift(4,"i")}function da(e,r){return r||(r=Pe(4)),r.write_shift(4,e),r}function on(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function Wr(e,r){var t=!1;return r==null&&(t=!0,r=Pe(4+2*e.length)),r.write_shift(4,e.length),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}function Fg(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Cg(e,r){return r||(r=Pe(4)),r.write_shift(2,0),r.write_shift(2,0),r}function of(e,r){var t=e.l,n=e.read_shift(1),a=on(e),s=[],l={t:a,h:a};if(n&1){for(var c=e.read_shift(4),f=0;f!=c;++f)s.push(Fg(e));l.r=s}else l.r=[{ich:0,ifnt:0}];return e.l=t+r,l}function Lg(e,r){var t=!1;return r==null&&(t=!0,r=Pe(15+4*e.t.length)),r.write_shift(1,0),Wr(e.t,r),t?r.slice(0,r.l):r}var Pg=of;function Og(e,r){var t=!1;return r==null&&(t=!0,r=Pe(23+4*e.t.length)),r.write_shift(1,1),Wr(e.t,r),r.write_shift(4,1),Cg({},r),t?r.slice(0,r.l):r}function Jn(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function $i(e,r){return r==null&&(r=Pe(8)),r.write_shift(-4,e.c),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}function Yi(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}function Xi(e,r){return r==null&&(r=Pe(4)),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}var Ig=on,md=Wr;function lf(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}function r0(e,r){var t=!1;return r==null&&(t=!0,r=Pe(127)),r.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}var Dg=on,zc=lf,cf=r0;function gd(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,n=r[0]&2;e.l+=4;var a=n===0?t0([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):Oi(r,0)>>2;return t?a/100:a}function xd(e,r){r==null&&(r=Pe(4));var t=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,t=1),n)r.write_shift(-4,((t?a:e)<<2)+(t+2));else throw new Error("unsupported RkNumber "+e)}function vd(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}function Rg(e,r){return r||(r=Pe(16)),r.write_shift(4,e.s.r),r.write_shift(4,e.e.r),r.write_shift(4,e.s.c),r.write_shift(4,e.e.c),r}var Ki=vd,Rs=Rg;function Ms(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Wi(e,r){return(r||Pe(8)).write_shift(8,e,"f")}function Mg(e){var r={},t=e.read_shift(1),n=t>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),l=e.read_shift(1),c=e.read_shift(1),f=e.read_shift(1);switch(e.l++,n){case 0:r.auto=1;break;case 1:r.index=a;var u=$g[a];u&&(r.rgb=eu(u));break;case 2:r.rgb=eu([l,c,f]);break;case 3:r.theme=a;break}return s!=0&&(r.tint=s>0?s/32767:s/32768),r}function n0(e,r){if(r||(r=Pe(8)),!e||e.auto)return r.write_shift(4,0),r.write_shift(4,0),r;e.index!=null?(r.write_shift(1,2),r.write_shift(1,e.index)):e.theme!=null?(r.write_shift(1,6),r.write_shift(1,e.theme)):(r.write_shift(1,5),r.write_shift(1,0));var t=e.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),r.write_shift(2,t),!e.rgb||e.theme!=null)r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),r.write_shift(1,parseInt(n.slice(0,2),16)),r.write_shift(1,parseInt(n.slice(2,4),16)),r.write_shift(1,parseInt(n.slice(4,6),16)),r.write_shift(1,255)}return r}function Bg(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function Ug(e,r){r||(r=Pe(2));var t=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return r.write_shift(1,t),r.write_shift(1,0),r}var yd=2,Ln=3,ql=11,a0=19,Vl=64,Hg=65,Wg=71,zg=4108,qg=4126,Gr=80,qh={1:{n:"CodePage",t:yd},2:{n:"Category",t:Gr},3:{n:"PresentationFormat",t:Gr},4:{n:"ByteCount",t:Ln},5:{n:"LineCount",t:Ln},6:{n:"ParagraphCount",t:Ln},7:{n:"SlideCount",t:Ln},8:{n:"NoteCount",t:Ln},9:{n:"HiddenCount",t:Ln},10:{n:"MultimediaClipCount",t:Ln},11:{n:"ScaleCrop",t:ql},12:{n:"HeadingPairs",t:zg},13:{n:"TitlesOfParts",t:qg},14:{n:"Manager",t:Gr},15:{n:"Company",t:Gr},16:{n:"LinksUpToDate",t:ql},17:{n:"CharacterCount",t:Ln},19:{n:"SharedDoc",t:ql},22:{n:"HyperlinksChanged",t:ql},23:{n:"AppVersion",t:Ln,p:"version"},24:{n:"DigSig",t:Hg},26:{n:"ContentType",t:Gr},27:{n:"ContentStatus",t:Gr},28:{n:"Language",t:Gr},29:{n:"Version",t:Gr},255:{},2147483648:{n:"Locale",t:a0},2147483651:{n:"Behavior",t:a0},1919054434:{}},Vh={1:{n:"CodePage",t:yd},2:{n:"Title",t:Gr},3:{n:"Subject",t:Gr},4:{n:"Author",t:Gr},5:{n:"Keywords",t:Gr},6:{n:"Comments",t:Gr},7:{n:"Template",t:Gr},8:{n:"LastAuthor",t:Gr},9:{n:"RevNumber",t:Gr},10:{n:"EditTime",t:Vl},11:{n:"LastPrinted",t:Vl},12:{n:"CreatedDate",t:Vl},13:{n:"ModifiedDate",t:Vl},14:{n:"PageCount",t:Ln},15:{n:"WordCount",t:Ln},16:{n:"CharCount",t:Ln},17:{n:"Thumbnail",t:Wg},18:{n:"Application",t:Gr},19:{n:"DocSecurity",t:Ln},255:{},2147483648:{n:"Locale",t:a0},2147483651:{n:"Behavior",t:a0},1919054434:{}};function Vg(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var Gg=Vg([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),$g=_n(Gg),zo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Yg={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Gl={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function wd(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function bd(e,r){var t=ag(Yg),n=[],a;n[n.length]=Fr,n[n.length]=Xe("Types",null,{xmlns:Ur.CT,"xmlns:xsd":Ur.xsd,"xmlns:xsi":Ur.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return Xe("Default",null,{Extension:f[0],ContentType:f[1]})}));var s=function(f){e[f]&&e[f].length>0&&(a=e[f][0],n[n.length]=Xe("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:Gl[f][r.bookType]||Gl[f].xlsx}))},l=function(f){(e[f]||[]).forEach(function(u){n[n.length]=Xe("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Gl[f][r.bookType]||Gl[f].xlsx})})},c=function(f){(e[f]||[]).forEach(function(u){n[n.length]=Xe("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:t[f][0]})})};return s("workbooks"),l("sheets"),l("charts"),c("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),l("metadata"),c("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Bt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Nd(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function Cs(e){var r=[Fr,Xe("Relationships",null,{xmlns:Ur.RELS})];return Kr(e["!id"]).forEach(function(t){r[r.length]=Xe("Relationship",null,e["!id"][t])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function $t(e,r,t,n,a,s){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),r<0)for(r=e["!idx"];e["!id"]["rId"+r];++r);if(e["!idx"]=r+1,a.Id="rId"+r,a.Type=n,a.Target=t,[Bt.HLINK,Bt.XPATH,Bt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+r);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,r}function Xg(e){var r=[Fr];r.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),r.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<e.length;++t)r.push('  <manifest:file-entry manifest:full-path="'+e[t][0]+'" manifest:media-type="'+e[t][1]+`"/>
`);return r.push("</manifest:manifest>"),r.join("")}function Gh(e,r,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+r+`"/>
`,`  </rdf:Description>
`].join("")}function Kg(e,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+`"/>
`,`  </rdf:Description>
`].join("")}function Jg(e){var r=[Fr];r.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=e.length;++t)r.push(Gh(e[t][0],e[t][1])),r.push(Kg("",e[t][0]));return r.push(Gh("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}function _d(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Xl.version+"</meta:generator></office:meta></office:document-meta>"}var Ui=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function bc(e,r,t,n,a){a[e]!=null||r==null||r===""||(a[e]=r,r=Yt(r),n[n.length]=t?Xe(e,r,t):Yr(e,r))}function Sd(e,r){var t=r||{},n=[Fr,Xe("cp:coreProperties",null,{"xmlns:cp":Ur.CORE_PROPS,"xmlns:dc":Ur.dc,"xmlns:dcterms":Ur.dcterms,"xmlns:dcmitype":Ur.dcmitype,"xmlns:xsi":Ur.xsi})],a={};if(!e&&!t.Props)return n.join("");e&&(e.CreatedDate!=null&&bc("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Wc(e.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&bc("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Wc(e.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=Ui.length;++s){var l=Ui[s],c=t.Props&&t.Props[l[1]]!=null?t.Props[l[1]]:e?e[l[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&bc(l[0],c,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ls=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Ad=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function jd(e){var r=[],t=Xe;return e||(e={}),e.Application="SheetJS",r[r.length]=Fr,r[r.length]=Xe("Properties",null,{xmlns:Ur.EXT_PROPS,"xmlns:vt":Ur.vt}),Ls.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Yt(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(r[r.length]=t(n[0],a))}}),r[r.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=t("TitlesOfParts",t("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Yt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}function kd(e){var r=[Fr,Xe("Properties",null,{xmlns:Ur.CUST_PROPS,"xmlns:vt":Ur.vt})];if(!e)return r.join("");var t=1;return Kr(e).forEach(function(a){++t,r[r.length]=Xe("property",mg(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Yt(a)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var $h={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Zg(e,r){var t=[];return Kr($h).map(function(n){for(var a=0;a<Ui.length;++a)if(Ui[a][1]==n)return Ui[a];for(a=0;a<Ls.length;++a)if(Ls[a][1]==n)return Ls[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=r&&r.Props&&r.Props[n[1]]!=null?r.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),t.push(Yr($h[n[1]]||n[1],a))}}),Xe("DocumentProperties",t.join(""),{xmlns:On.o})}function Qg(e,r){var t=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Kr(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var l=0;l<Ui.length;++l)if(s==Ui[l][1])return;for(l=0;l<Ls.length;++l)if(s==Ls[l][1])return;for(l=0;l<t.length;++l)if(s==t[l])return;var c=e[s],f="string";typeof c=="number"?(f="float",c=String(c)):c===!0||c===!1?(f="boolean",c=c?"1":"0"):c=String(c),a.push(Xe(Oh(s),c,{"dt:dt":f}))}}),r&&Kr(r).forEach(function(s){if(Object.prototype.hasOwnProperty.call(r,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var l=r[s],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l instanceof Date?(c="dateTime.tz",l=l.toISOString()):l=String(l),a.push(Xe(Oh(s),l,{"dt:dt":c}))}}),"<"+n+' xmlns="'+On.o+'">'+a.join("")+"</"+n+">"}function ex(e){var r=typeof e=="string"?new Date(Date.parse(e)):e,t=r.getTime()/1e3+11644473600,n=t%Math.pow(2,32),a=(t-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var l=Pe(8);return l.write_shift(4,n),l.write_shift(4,a),l}function Yh(e,r){var t=Pe(4),n=Pe(4);switch(t.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,r);break;case 5:n=Pe(8),n.write_shift(8,r,"f");break;case 11:n.write_shift(4,r?1:0);break;case 64:n=ex(r);break;case 31:case 80:for(n=Pe(4+2*(r.length+1)+(r.length%2?0:2)),n.write_shift(4,r.length+1),n.write_shift(0,r,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}return $r([t,n])}var Td=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function tx(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Xh(e,r,t){var n=Pe(8),a=[],s=[],l=8,c=0,f=Pe(8),u=Pe(8);if(f.write_shift(4,2),f.write_shift(4,1200),u.write_shift(4,1),s.push(f),a.push(u),l+=8+f.length,!r){u=Pe(8),u.write_shift(4,0),a.unshift(u);var d=[Pe(4)];for(d[0].write_shift(4,e.length),c=0;c<e.length;++c){var g=e[c][0];for(f=Pe(8+2*(g.length+1)+(g.length%2?0:2)),f.write_shift(4,c+2),f.write_shift(4,g.length+1),f.write_shift(0,g,"dbcs");f.l!=f.length;)f.write_shift(1,0);d.push(f)}f=$r(d),s.unshift(f),l+=8+f.length}for(c=0;c<e.length;++c)if(!(r&&!r[e[c][0]])&&!(Td.indexOf(e[c][0])>-1||Ad.indexOf(e[c][0])>-1)&&e[c][1]!=null){var x=e[c][1],p=0;if(r){p=+r[e[c][0]];var w=t[p];if(w.p=="version"&&typeof x=="string"){var v=x.split(".");x=(+v[0]<<16)+(+v[1]||0)}f=Yh(w.t,x)}else{var _=tx(x);_==-1&&(_=31,x=String(x)),f=Yh(_,x)}s.push(f),u=Pe(8),u.write_shift(4,r?p:2+c),a.push(u),l+=8+f.length}var S=8*(s.length+1);for(c=0;c<s.length;++c)a[c].write_shift(4,S),S+=s[c].length;return n.write_shift(4,l),n.write_shift(4,s.length),$r([n].concat(a).concat(s))}function Kh(e,r,t,n,a,s){var l=Pe(a?68:48),c=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,Zt.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,a?2:1),l.write_shift(16,r,"hex"),l.write_shift(4,a?68:48);var f=Xh(e,t,n);if(c.push(f),a){var u=Xh(a,null,null);l.write_shift(16,s,"hex"),l.write_shift(4,68+f.length),c.push(u)}return $r(c)}function rx(e,r){r||(r=Pe(e));for(var t=0;t<e;++t)r.write_shift(1,0);return r}function nx(e,r){return e.read_shift(r)===1}function un(e,r){return r||(r=Pe(2)),r.write_shift(2,+!!e),r}function Ed(e){return e.read_shift(2,"u")}function Kn(e,r){return r||(r=Pe(2)),r.write_shift(2,e),r}function Fd(e,r,t){return t||(t=Pe(2)),t.write_shift(1,r=="e"?+e:+!!e),t.write_shift(1,r=="e"?1:0),t}function Cd(e,r,t){var n=e.read_shift(t&&t.biff>=12?2:1),a="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else t.biff==12&&(a="wstr");t.biff>=2&&t.biff<=5&&(a="cpstr");var l=n?e.read_shift(n,a):"";return l}function ax(e){var r=e.t||"",t=Pe(3);t.write_shift(2,r.length),t.write_shift(1,1);var n=Pe(2*r.length);n.write_shift(2*r.length,r,"utf16le");var a=[t,n];return $r(a)}function ix(e,r,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(r,"sbcs-cont"):n=e.read_shift(r,"dbcs-cont"),n}function sx(e,r,t){var n=e.read_shift(t&&t.biff==2?1:2);return n===0?(e.l++,""):ix(e,n,t)}function ox(e,r,t){if(t.biff>5)return sx(e,r,t);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Ld(e,r,t){return t||(t=Pe(3+2*e.length)),t.write_shift(2,e.length),t.write_shift(1,1),t.write_shift(31,e,"utf16le"),t}function Jh(e,r){r||(r=Pe(6+e.length*2)),r.write_shift(4,1+e.length);for(var t=0;t<e.length;++t)r.write_shift(2,e.charCodeAt(t));return r.write_shift(2,0),r}function lx(e){var r=Pe(512),t=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}r.write_shift(4,2),r.write_shift(4,s);var l=[8,6815827,6619237,4849780,83];for(t=0;t<l.length;++t)r.write_shift(4,l[t]);if(s==28)n=n.slice(1),Jh(n,r);else if(s&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<l.length;++t)r.write_shift(1,parseInt(l[t],16));var c=a>-1?n.slice(0,a):n;for(r.write_shift(4,2*(c.length+1)),t=0;t<c.length;++t)r.write_shift(2,c.charCodeAt(t));r.write_shift(2,0),s&8&&Jh(a>-1?n.slice(a+1):"",r)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<l.length;++t)r.write_shift(1,parseInt(l[t],16));for(var f=0;n.slice(f*3,f*3+3)=="../"||n.slice(f*3,f*3+3)=="..\\";)++f;for(r.write_shift(2,f),r.write_shift(4,n.length-3*f+1),t=0;t<n.length-3*f;++t)r.write_shift(1,n.charCodeAt(t+3*f)&255);for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),t=0;t<6;++t)r.write_shift(4,0)}return r.slice(0,r.l)}function zi(e,r,t,n){return n||(n=Pe(6)),n.write_shift(2,e),n.write_shift(2,r),n.write_shift(2,t||0),n}function cx(e,r,t){var n=t.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),l=e.read_shift(n,"i");return[a,s,l]}function fx(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r},e:{c:a,r:t}}}function Pd(e,r){return r||(r=Pe(8)),r.write_shift(2,e.s.r),r.write_shift(2,e.e.r),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c),r}function ff(e,r,t){var n=1536,a=16;switch(t.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Pe(a);return s.write_shift(2,n),s.write_shift(2,r),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function hx(e,r){var t=!r||r.biff==8,n=Pe(t?112:54);for(n.write_shift(r.biff==8?2:1,7),t&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(t?0:536870912));n.l<n.length;)n.write_shift(1,t?0:32);return n}function ux(e,r){var t=!r||r.biff>=8?2:1,n=Pe(8+t*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),r.biff>=8&&n.write_shift(1,1),n.write_shift(t*e.name.length,e.name,r.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function dx(e,r){var t=Pe(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=ax(e[a]);var s=$r([t].concat(n));return s.parts=[t.length].concat(n.map(function(l){return l.length})),s}function px(){var e=Pe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function mx(e){var r=Pe(18),t=1718;return e&&e.RTL&&(t|=64),r.write_shift(2,t),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}function gx(e,r){var t=e.name||"Arial",n=r&&r.biff==5,a=n?15+t.length:16+2*t.length,s=Pe(a);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,t.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le"),s}function xx(e,r,t,n){var a=Pe(10);return zi(e,r,n,a),a.write_shift(4,t),a}function vx(e,r,t,n,a){var s=!a||a.biff==8,l=Pe(8+ +s+(1+s)*t.length);return zi(e,r,n,l),l.write_shift(2,t.length),s&&l.write_shift(1,1),l.write_shift((1+s)*t.length,t,s?"utf16le":"sbcs"),l}function yx(e,r,t,n){var a=t&&t.biff==5;n||(n=Pe(a?3+r.length:5+2*r.length)),n.write_shift(2,e),n.write_shift(a?1:2,r.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}function wx(e,r){var t=r.biff==8||!r.biff?4:2,n=Pe(2*t+6);return n.write_shift(t,e.s.r),n.write_shift(t,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function Zh(e,r,t,n){var a=t&&t.biff==5;n||(n=Pe(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,r<<4));var s=0;return e.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function bx(e){var r=Pe(8);return r.write_shift(4,0),r.write_shift(2,0),r.write_shift(2,0),r}function Nx(e,r,t,n,a,s){var l=Pe(8);return zi(e,r,n,l),Fd(t,s,l),l}function _x(e,r,t,n){var a=Pe(14);return zi(e,r,n,a),Wi(t,a),a}function Sx(e,r,t){if(t.biff<8)return Ax(e,r,t);for(var n=[],a=e.l+r,s=e.read_shift(t.biff>8?4:2);s--!==0;)n.push(cx(e,t.biff>8?12:6,t));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function Ax(e,r,t){e[e.l+1]==3&&e[e.l]++;var n=Cd(e,r,t);return n.charCodeAt(0)==3?n.slice(1):n}function jx(e){var r=Pe(2+e.length*8);r.write_shift(2,e.length);for(var t=0;t<e.length;++t)Pd(e[t],r);return r}function kx(e){var r=Pe(24),t=Hr(e[0]);r.write_shift(2,t.r),r.write_shift(2,t.r),r.write_shift(2,t.c),r.write_shift(2,t.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)r.write_shift(1,parseInt(n[a],16));return $r([r,lx(e[1])])}function Tx(e){var r=e[1].Tooltip,t=Pe(10+2*(r.length+1));t.write_shift(2,2048);var n=Hr(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var a=0;a<r.length;++a)t.write_shift(2,r.charCodeAt(a));return t.write_shift(2,0),t}function Ex(e){return e||(e=Pe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Fx(e,r,t){if(!t.cellStyles)return Ta(e,r);var n=t&&t.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(n),f=e.read_shift(2);n==2&&(e.l+=2);var u={s:a,e:s,w:l,ixfe:c,flags:f};return(t.biff>=5||!t.biff)&&(u.level=f>>8&7),u}function Cx(e,r){var t=Pe(12);t.write_shift(2,r),t.write_shift(2,r),t.write_shift(2,e.width*256),t.write_shift(2,0);var n=0;return e.hidden&&(n|=1),t.write_shift(1,n),n=e.level||0,t.write_shift(1,n),t.write_shift(2,0),t}function Lx(e){for(var r=Pe(2*e),t=0;t<e;++t)r.write_shift(2,t+1);return r}function Px(e,r,t){var n=Pe(15);return Vo(n,e,r),n.write_shift(8,t,"f"),n}function Ox(e,r,t){var n=Pe(9);return Vo(n,e,r),n.write_shift(2,t),n}var Ix=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=Zc({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(c,f){var u=[],d=Hi(1);switch(f.type){case"base64":d=ha(Va(c));break;case"binary":d=ha(c);break;case"buffer":case"array":d=c;break}Pn(d,0);var g=d.read_shift(1),x=!!(g&136),p=!1,w=!1;switch(g){case 2:break;case 3:break;case 48:p=!0,x=!0;break;case 49:p=!0,x=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var v=0,_=521;g==2&&(v=d.read_shift(2)),d.l+=3,g!=2&&(v=d.read_shift(4)),v>1048576&&(v=1e6),g!=2&&(_=d.read_shift(2));var S=d.read_shift(2),b=f.codepage||1252;g!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(b=e[d[d.l]]),d.l+=1,d.l+=2),w&&(d.l+=36);for(var A=[],E={},U=Math.min(d.length,g==2?521:_-10-(p?264:0)),R=w?32:11;d.l<U&&d[d.l]!=13;)switch(E={},E.name=Kl.utils.decode(b,d.slice(d.l,d.l+R)).replace(/[\u0000\r\n].*$/g,""),d.l+=R,E.type=String.fromCharCode(d.read_shift(1)),g!=2&&!w&&(E.offset=d.read_shift(4)),E.len=d.read_shift(1),g==2&&(E.offset=d.read_shift(2)),E.dec=d.read_shift(1),E.name.length&&A.push(E),g!=2&&(d.l+=w?13:14),E.type){case"B":(!p||E.len!=8)&&f.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+E.type)}if(d[d.l]!==13&&(d.l=_-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=_;var L=0,C=0;for(u[0]=[],C=0;C!=A.length;++C)u[0][C]=A[C].name;for(;v-- >0;){if(d[d.l]===42){d.l+=S;continue}for(++d.l,u[++L]=[],C=0,C=0;C!=A.length;++C){var P=d.slice(d.l,d.l+A[C].len);d.l+=A[C].len,Pn(P,0);var W=Kl.utils.decode(b,P);switch(A[C].type){case"C":W.trim().length&&(u[L][C]=W.replace(/\s+$/,""));break;case"D":W.length===8?u[L][C]=new Date(+W.slice(0,4),+W.slice(4,6)-1,+W.slice(6,8)):u[L][C]=W;break;case"F":u[L][C]=parseFloat(W.trim());break;case"+":case"I":u[L][C]=w?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(W.trim().toUpperCase()){case"Y":case"T":u[L][C]=!0;break;case"N":case"F":u[L][C]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+W+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));u[L][C]="##MEMO##"+(w?parseInt(W.trim(),10):P.read_shift(4));break;case"N":W=W.replace(/\u0000/g,"").trim(),W&&W!="."&&(u[L][C]=+W||0);break;case"@":u[L][C]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":u[L][C]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":u[L][C]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[L][C]=-P.read_shift(-8,"f");break;case"B":if(p&&A[C].len==8){u[L][C]=P.read_shift(8,"f");break}case"G":case"P":P.l+=A[C].len;break;case"0":if(A[C].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+A[C].type)}}}if(g!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return f&&f.sheetRows&&(u=u.slice(0,f.sheetRows)),f.DBF=A,u}function n(c,f){var u=f||{};u.dateNF||(u.dateNF="yyyymmdd");var d=Ds(t(c,u),u);return d["!cols"]=u.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete u.DBF,d}function a(c,f){try{return Gi(n(c,f),f)}catch(u){if(f&&f.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function l(c,f){var u=f||{};if(+u.codepage>=0&&Lo(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=bn(),g=c0(c,{header:1,raw:!0,cellDates:!0}),x=g[0],p=g.slice(1),w=c["!cols"]||[],v=0,_=0,S=0,b=1;for(v=0;v<x.length;++v){if(((w[v]||{}).DBF||{}).name){x[v]=w[v].DBF.name,++S;continue}if(x[v]!=null){if(++S,typeof x[v]=="number"&&(x[v]=x[v].toString(10)),typeof x[v]!="string")throw new Error("DBF Invalid column name "+x[v]+" |"+typeof x[v]+"|");if(x.indexOf(x[v])!==v){for(_=0;_<1024;++_)if(x.indexOf(x[v]+"_"+_)==-1){x[v]+="_"+_;break}}}}var A=lr(c["!ref"]),E=[],U=[],R=[];for(v=0;v<=A.e.c-A.s.c;++v){var L="",C="",P=0,W=[];for(_=0;_<p.length;++_)p[_][v]!=null&&W.push(p[_][v]);if(W.length==0||x[v]==null){E[v]="?";continue}for(_=0;_<W.length;++_){switch(typeof W[_]){case"number":C="B";break;case"string":C="C";break;case"boolean":C="L";break;case"object":C=W[_]instanceof Date?"D":"C";break;default:C="C"}P=Math.max(P,String(W[_]).length),L=L&&L!=C?"C":C}P>250&&(P=250),C=((w[v]||{}).DBF||{}).type,C=="C"&&w[v].DBF.len>P&&(P=w[v].DBF.len),L=="B"&&C=="N"&&(L="N",R[v]=w[v].DBF.dec,P=w[v].DBF.len),U[v]=L=="C"||C=="N"?P:s[L]||0,b+=U[v],E[v]=L}var k=d.next(32);for(k.write_shift(4,318902576),k.write_shift(4,p.length),k.write_shift(2,296+32*S),k.write_shift(2,b),v=0;v<4;++v)k.write_shift(4,0);for(k.write_shift(4,0|(+r[Iu]||3)<<8),v=0,_=0;v<x.length;++v)if(x[v]!=null){var T=d.next(32),H=(x[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);T.write_shift(1,H,"sbcs"),T.write_shift(1,E[v]=="?"?"C":E[v],"sbcs"),T.write_shift(4,_),T.write_shift(1,U[v]||s[E[v]]||0),T.write_shift(1,R[v]||0),T.write_shift(1,2),T.write_shift(4,0),T.write_shift(1,0),T.write_shift(4,0),T.write_shift(4,0),_+=U[v]||s[E[v]]||0}var G=d.next(264);for(G.write_shift(4,13),v=0;v<65;++v)G.write_shift(4,0);for(v=0;v<p.length;++v){var ce=d.next(b);for(ce.write_shift(1,0),_=0;_<x.length;++_)if(x[_]!=null)switch(E[_]){case"L":ce.write_shift(1,p[v][_]==null?63:p[v][_]?84:70);break;case"B":ce.write_shift(8,p[v][_]||0,"f");break;case"N":var J="0";for(typeof p[v][_]=="number"&&(J=p[v][_].toFixed(R[_]||0)),S=0;S<U[_]-J.length;++S)ce.write_shift(1,32);ce.write_shift(1,J,"sbcs");break;case"D":p[v][_]?(ce.write_shift(4,("0000"+p[v][_].getFullYear()).slice(-4),"sbcs"),ce.write_shift(2,("00"+(p[v][_].getMonth()+1)).slice(-2),"sbcs"),ce.write_shift(2,("00"+p[v][_].getDate()).slice(-2),"sbcs")):ce.write_shift(8,"00000000","sbcs");break;case"C":var Q=String(p[v][_]!=null?p[v][_]:"").slice(0,U[_]);for(ce.write_shift(1,Q,"sbcs"),S=0;S<U[_]-Q.length;++S)ce.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:a,to_sheet:n,from_sheet:l}}(),Dx=function(){var e={AA:"Ã€",BA:"Ã",CA:"Ã‚",DA:195,HA:"Ã„",JA:197,AE:"Ãˆ",BE:"Ã‰",CE:"ÃŠ",HE:"Ã‹",AI:"ÃŒ",BI:"Ã",CI:"ÃŽ",HI:"Ã",AO:"Ã’",BO:"Ã“",CO:"Ã”",DO:213,HO:"Ã–",AU:"Ã™",BU:"Ãš",CU:"Ã›",HU:"Ãœ",Aa:"Ã ",Ba:"Ã¡",Ca:"Ã¢",Da:227,Ha:"Ã¤",Ja:229,Ae:"Ã¨",Be:"Ã©",Ce:"Ãª",He:"Ã«",Ai:"Ã¬",Bi:"Ã­",Ci:"Ã®",Hi:"Ã¯",Ao:"Ã²",Bo:"Ã³",Co:"Ã´",Do:245,Ho:"Ã¶",Au:"Ã¹",Bu:"Ãº",Cu:"Ã»",Hu:"Ã¼",KC:"Ã‡",Kc:"Ã§",q:"Ã¦",z:"Å“",a:"Ã†",j:"Å’",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+Kr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(x,p){var w=e[p];return typeof w=="number"?Nh(w):w},n=function(x,p,w){var v=p.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return v==59?x:Nh(v)};e["|"]=254;function a(x,p){switch(p.type){case"base64":return s(Va(x),p);case"binary":return s(x,p);case"buffer":return s(Ht&&Buffer.isBuffer(x)?x.toString("binary"):Uo(x),p);case"array":return s(x0(x),p)}throw new Error("Unrecognized type "+p.type)}function s(x,p){var w=x.split(/[\n\r]+/),v=-1,_=-1,S=0,b=0,A=[],E=[],U=null,R={},L=[],C=[],P=[],W=0,k;for(+p.codepage>=0&&Lo(+p.codepage);S!==w.length;++S){W=0;var T=w[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,t),H=T.replace(/;;/g,"\0").split(";").map(function(D){return D.replace(/\u0000/g,";")}),G=H[0],ce;if(T.length>0)switch(G){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":H[1].charAt(0)=="P"&&E.push(T.slice(3).replace(/;;/g,";"));break;case"C":var J=!1,Q=!1,oe=!1,ae=!1,ge=-1,ve=-1;for(b=1;b<H.length;++b)switch(H[b].charAt(0)){case"A":break;case"X":_=parseInt(H[b].slice(1))-1,Q=!0;break;case"Y":for(v=parseInt(H[b].slice(1))-1,Q||(_=0),k=A.length;k<=v;++k)A[k]=[];break;case"K":ce=H[b].slice(1),ce.charAt(0)==='"'?ce=ce.slice(1,ce.length-1):ce==="TRUE"?ce=!0:ce==="FALSE"?ce=!1:isNaN(za(ce))?isNaN(Oo(ce).getDate())||(ce=dn(ce)):(ce=za(ce),U!==null&&$u(U)&&(ce=Ju(ce))),J=!0;break;case"E":ae=!0;var j=O5(H[b].slice(1),{r:v,c:_});A[v][_]=[A[v][_],j];break;case"S":oe=!0,A[v][_]=[A[v][_],"S5S"];break;case"G":break;case"R":ge=parseInt(H[b].slice(1))-1;break;case"C":ve=parseInt(H[b].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+T)}if(J&&(A[v][_]&&A[v][_].length==2?A[v][_][0]=ce:A[v][_]=ce,U=null),oe){if(ae)throw new Error("SYLK shared formula cannot have own formula");var O=ge>-1&&A[ge][ve];if(!O||!O[1])throw new Error("SYLK shared formula cannot find base");A[v][_][1]=I5(O[1],{r:v-ge,c:_-ve})}break;case"F":var I=0;for(b=1;b<H.length;++b)switch(H[b].charAt(0)){case"X":_=parseInt(H[b].slice(1))-1,++I;break;case"Y":for(v=parseInt(H[b].slice(1))-1,k=A.length;k<=v;++k)A[k]=[];break;case"M":W=parseInt(H[b].slice(1))/20;break;case"F":break;case"G":break;case"P":U=E[parseInt(H[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=H[b].slice(1).split(" "),k=parseInt(P[0],10);k<=parseInt(P[1],10);++k)W=parseInt(P[2],10),C[k-1]=W===0?{hidden:!0}:{wch:W},hf(C[k-1]);break;case"C":_=parseInt(H[b].slice(1))-1,C[_]||(C[_]={});break;case"R":v=parseInt(H[b].slice(1))-1,L[v]||(L[v]={}),W>0?(L[v].hpt=W,L[v].hpx=Md(W)):W===0&&(L[v].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+T)}I<1&&(U=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+T)}}return L.length>0&&(R["!rows"]=L),C.length>0&&(R["!cols"]=C),p&&p.sheetRows&&(A=A.slice(0,p.sheetRows)),[A,R]}function l(x,p){var w=a(x,p),v=w[0],_=w[1],S=Ds(v,p);return Kr(_).forEach(function(b){S[b]=_[b]}),S}function c(x,p){return Gi(l(x,p),p)}function f(x,p,w,v){var _="C;Y"+(w+1)+";X"+(v+1)+";K";switch(x.t){case"n":_+=x.v||0,x.f&&!x.F&&(_+=";E"+df(x.f,{r:w,c:v}));break;case"b":_+=x.v?"TRUE":"FALSE";break;case"e":_+=x.w||x.v;break;case"d":_+='"'+(x.w||x.v)+'"';break;case"s":_+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function u(x,p){p.forEach(function(w,v){var _="F;W"+(v+1)+" "+(v+1)+" ";w.hidden?_+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=i0(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=s0(w.wpx)),typeof w.wch=="number"&&(_+=Math.round(w.wch))),_.charAt(_.length-1)!=" "&&x.push(_)})}function d(x,p){p.forEach(function(w,v){var _="F;";w.hidden?_+="M0;":w.hpt?_+="M"+20*w.hpt+";":w.hpx&&(_+="M"+20*o0(w.hpx)+";"),_.length>2&&x.push(_+"R"+(v+1))})}function g(x,p){var w=["ID;PWXL;N;E"],v=[],_=lr(x["!ref"]),S,b=Array.isArray(x),A=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),x["!cols"]&&u(w,x["!cols"]),x["!rows"]&&d(w,x["!rows"]),w.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var E=_.s.r;E<=_.e.r;++E)for(var U=_.s.c;U<=_.e.c;++U){var R=Xt({r:E,c:U});S=b?(x[E]||[])[U]:x[R],!(!S||S.v==null&&(!S.f||S.F))&&v.push(f(S,x,E,U))}return w.join(A)+A+v.join(A)+A+"E"+A}return{to_workbook:c,to_sheet:l,from_sheet:g}}(),Rx=function(){function e(s,l){switch(l.type){case"base64":return r(Va(s),l);case"binary":return r(s,l);case"buffer":return r(Ht&&Buffer.isBuffer(s)?s.toString("binary"):Uo(s),l);case"array":return r(x0(s),l)}throw new Error("Unrecognized type "+l.type)}function r(s,l){for(var c=s.split(`
`),f=-1,u=-1,d=0,g=[];d!==c.length;++d){if(c[d].trim()==="BOT"){g[++f]=[],u=0;continue}if(!(f<0)){var x=c[d].trim().split(","),p=x[0],w=x[1];++d;for(var v=c[d]||"";(v.match(/["]/g)||[]).length&1&&d<c.length-1;)v+=`
`+c[++d];switch(v=v.trim(),+p){case-1:if(v==="BOT"){g[++f]=[],u=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?g[f][u]=!0:v==="FALSE"?g[f][u]=!1:isNaN(za(w))?isNaN(Oo(w).getDate())?g[f][u]=w:g[f][u]=dn(w):g[f][u]=za(w),++u;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),g[f][u++]=v!==""?v:null;break}if(v==="EOD")break}}return l&&l.sheetRows&&(g=g.slice(0,l.sheetRows)),g}function t(s,l){return Ds(e(s,l),l)}function n(s,l){return Gi(t(s,l),l)}var a=function(){var s=function(f,u,d,g,x){f.push(u),f.push(d+","+g),f.push('"'+x.replace(/"/g,'""')+'"')},l=function(f,u,d,g){f.push(u+","+d),f.push(u==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(f){var u=[],d=lr(f["!ref"]),g,x=Array.isArray(f);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,d.e.r-d.s.r+1,""),s(u,"TUPLES",0,d.e.c-d.s.c+1,""),s(u,"DATA",0,0,"");for(var p=d.s.r;p<=d.e.r;++p){l(u,-1,0,"BOT");for(var w=d.s.c;w<=d.e.c;++w){var v=Xt({r:p,c:w});if(g=x?(f[p]||[])[w]:f[v],!g){l(u,1,0,"");continue}switch(g.t){case"n":var _=g.w;!_&&g.v!=null&&(_=g.v),_==null?g.f&&!g.F?l(u,1,0,"="+g.f):l(u,1,0,""):l(u,0,_,"V");break;case"b":l(u,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":l(u,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=yi(g.z||gr[14],Nn(dn(g.v)))),l(u,0,g.w,"V");break;default:l(u,1,0,"")}}}l(u,-1,0,"EOD");var S=`\r
`,b=u.join(S);return b}}();return{to_workbook:n,to_sheet:t,from_sheet:a}}(),Od=function(){function e(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(g,x){for(var p=g.split(`
`),w=-1,v=-1,_=0,S=[];_!==p.length;++_){var b=p[_].trim().split(":");if(b[0]==="cell"){var A=Hr(b[1]);if(S.length<=A.r)for(w=S.length;w<=A.r;++w)S[w]||(S[w]=[]);switch(w=A.r,v=A.c,b[2]){case"t":S[w][v]=e(b[3]);break;case"v":S[w][v]=+b[3];break;case"vtf":var E=b[b.length-1];case"vtc":switch(b[3]){case"nl":S[w][v]=!!+b[4];break;default:S[w][v]=+b[4];break}b[2]=="vtf"&&(S[w][v]=[S[w][v],E])}}}return x&&x.sheetRows&&(S=S.slice(0,x.sheetRows)),S}function n(g,x){return Ds(t(g,x),x)}function a(g,x){return Gi(n(g,x),x)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function u(g){if(!g||!g["!ref"])return"";for(var x=[],p=[],w,v="",_=Rn(g["!ref"]),S=Array.isArray(g),b=_.s.r;b<=_.e.r;++b)for(var A=_.s.c;A<=_.e.c;++A)if(v=Xt({r:b,c:A}),w=S?(g[b]||[])[A]:g[v],!(!w||w.v==null||w.t==="z")){switch(p=["cell",v,"t"],w.t){case"s":case"str":p.push(r(w.v));break;case"n":w.f?(p[2]="vtf",p[3]="n",p[4]=w.v,p[5]=r(w.f)):(p[2]="v",p[3]=w.v);break;case"b":p[2]="vt"+(w.f?"f":"c"),p[3]="nl",p[4]=w.v?"1":"0",p[5]=r(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var E=Nn(dn(w.v));p[2]="vtc",p[3]="nd",p[4]=""+E,p[5]=w.w||yi(w.z||gr[14],E);break;case"e":continue}x.push(p.join(":"))}return x.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function d(g){return[s,l,c,l,u(g),f].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:d}}(),Mx=function(){function e(d,g,x,p,w){w.raw?g[x][p]=d:d===""||(d==="TRUE"?g[x][p]=!0:d==="FALSE"?g[x][p]=!1:isNaN(za(d))?isNaN(Oo(d).getDate())?g[x][p]=d:g[x][p]=dn(d):g[x][p]=za(d))}function r(d,g){var x=g||{},p=[];if(!d||d.length===0)return p;for(var w=d.split(/[\r\n]/),v=w.length-1;v>=0&&w[v].length===0;)--v;for(var _=10,S=0,b=0;b<=v;++b)S=w[b].indexOf(" "),S==-1?S=w[b].length:S++,_=Math.max(_,S);for(b=0;b<=v;++b){p[b]=[];var A=0;for(e(w[b].slice(0,_).trim(),p,b,A,x),A=1;A<=(w[b].length-_)/10+1;++A)e(w[b].slice(_+(A-1)*10,_+A*10).trim(),p,b,A,x)}return x.sheetRows&&(p=p.slice(0,x.sheetRows)),p}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(d){for(var g={},x=!1,p=0,w=0;p<d.length;++p)(w=d.charCodeAt(p))==34?x=!x:!x&&w in t&&(g[w]=(g[w]||0)+1);w=[];for(p in g)Object.prototype.hasOwnProperty.call(g,p)&&w.push([g[p],p]);if(!w.length){g=n;for(p in g)Object.prototype.hasOwnProperty.call(g,p)&&w.push([g[p],p])}return w.sort(function(v,_){return v[0]-_[0]||n[v[1]]-n[_[1]]}),t[w.pop()[1]]||44}function s(d,g){var x=g||{},p="",w=x.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(p=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(p=d.charAt(4),d=d.slice(6)):p=a(d.slice(0,1024)):x&&x.FS?p=x.FS:p=a(d.slice(0,1024));var _=0,S=0,b=0,A=0,E=0,U=p.charCodeAt(0),R=!1,L=0,C=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var P=x.dateNF!=null?eg(x.dateNF):null;function W(){var k=d.slice(A,E),T={};if(k.charAt(0)=='"'&&k.charAt(k.length-1)=='"'&&(k=k.slice(1,-1).replace(/""/g,'"')),k.length===0)T.t="z";else if(x.raw)T.t="s",T.v=k;else if(k.trim().length===0)T.t="s",T.v=k;else if(k.charCodeAt(0)==61)k.charCodeAt(1)==34&&k.charCodeAt(k.length-1)==34?(T.t="s",T.v=k.slice(2,-1).replace(/""/g,'"')):D5(k)?(T.t="n",T.f=k.slice(1)):(T.t="s",T.v=k);else if(k=="TRUE")T.t="b",T.v=!0;else if(k=="FALSE")T.t="b",T.v=!1;else if(!isNaN(b=za(k)))T.t="n",x.cellText!==!1&&(T.w=k),T.v=b;else if(!isNaN(Oo(k).getDate())||P&&k.match(P)){T.z=x.dateNF||gr[14];var H=0;P&&k.match(P)&&(k=tg(k,x.dateNF,k.match(P)||[]),H=1),x.cellDates?(T.t="d",T.v=dn(k,H)):(T.t="n",T.v=Nn(dn(k,H))),x.cellText!==!1&&(T.w=yi(T.z,T.v instanceof Date?Nn(T.v):T.v)),x.cellNF||delete T.z}else T.t="s",T.v=k;if(T.t=="z"||(x.dense?(w[_]||(w[_]=[]),w[_][S]=T):w[Xt({c:S,r:_})]=T),A=E+1,C=d.charCodeAt(A),v.e.c<S&&(v.e.c=S),v.e.r<_&&(v.e.r=_),L==U)++S;else if(S=0,++_,x.sheetRows&&x.sheetRows<=_)return!0}e:for(;E<d.length;++E)switch(L=d.charCodeAt(E)){case 34:C===34&&(R=!R);break;case U:case 10:case 13:if(!R&&W())break e;break}return E-A>0&&W(),w["!ref"]=Er(v),w}function l(d,g){return!(g&&g.PRN)||g.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,g):Ds(r(d,g),g)}function c(d,g){var x="",p=g.type=="string"?[0,0,0,0]:Kw(d,g);switch(g.type){case"base64":x=Va(d);break;case"binary":x=d;break;case"buffer":g.codepage==65001?x=d.toString("utf8"):g.codepage&&typeof Kl<"u"||(x=Ht&&Buffer.isBuffer(d)?d.toString("binary"):Uo(d));break;case"array":x=x0(d);break;case"string":x=d;break;default:throw new Error("Unrecognized type "+g.type)}return p[0]==239&&p[1]==187&&p[2]==191?x=Ao(x.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?x=Ao(x):g.type=="binary"&&typeof Kl<"u",x.slice(0,19)=="socialcalc:version:"?Od.to_sheet(g.type=="string"?x:Ao(x),g):l(x,g)}function f(d,g){return Gi(c(d,g),g)}function u(d){for(var g=[],x=lr(d["!ref"]),p,w=Array.isArray(d),v=x.s.r;v<=x.e.r;++v){for(var _=[],S=x.s.c;S<=x.e.c;++S){var b=Xt({r:v,c:S});if(p=w?(d[v]||[])[S]:d[b],!p||p.v==null){_.push("          ");continue}for(var A=(p.w||(Ga(p),p.w)||"").slice(0,10);A.length<10;)A+=" ";_.push(A+(S===0?" ":""))}g.push(_.join(""))}return g.join(`
`)}return{to_workbook:f,to_sheet:c,from_sheet:u}}(),Qh=function(){function e(j,O,I){if(j){Pn(j,j.l||0);for(var D=I.Enum||ge;j.l<j.length;){var X=j.read_shift(2),fe=D[X]||D[65535],he=j.read_shift(2),ue=j.l+he,be=fe.f&&fe.f(j,he,I);if(j.l=ue,O(be,fe,X))return}}}function r(j,O){switch(O.type){case"base64":return t(ha(Va(j)),O);case"binary":return t(ha(j),O);case"buffer":case"array":return t(j,O)}throw"Unsupported type "+O.type}function t(j,O){if(!j)return j;var I=O||{},D=I.dense?[]:{},X="Sheet1",fe="",he=0,ue={},be=[],Oe=[],Me={s:{r:0,c:0},e:{r:0,c:0}},Ve=I.sheetRows||0;if(j[2]==0&&(j[3]==8||j[3]==9)&&j.length>=16&&j[14]==5&&j[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(j[2]==2)I.Enum=ge,e(j,function(Be,it,We){switch(We){case 0:I.vers=Be,Be>=4096&&(I.qpro=!0);break;case 6:Me=Be;break;case 204:Be&&(fe=Be);break;case 222:fe=Be;break;case 15:case 51:I.qpro||(Be[1].v=Be[1].v.slice(1));case 13:case 14:case 16:We==14&&(Be[2]&112)==112&&(Be[2]&15)>1&&(Be[2]&15)<15&&(Be[1].z=I.dateNF||gr[14],I.cellDates&&(Be[1].t="d",Be[1].v=Ju(Be[1].v))),I.qpro&&Be[3]>he&&(D["!ref"]=Er(Me),ue[X]=D,be.push(X),D=I.dense?[]:{},Me={s:{r:0,c:0},e:{r:0,c:0}},he=Be[3],X=fe||"Sheet"+(he+1),fe="");var $e=I.dense?(D[Be[0].r]||[])[Be[0].c]:D[Xt(Be[0])];if($e){$e.t=Be[1].t,$e.v=Be[1].v,Be[1].z!=null&&($e.z=Be[1].z),Be[1].f!=null&&($e.f=Be[1].f);break}I.dense?(D[Be[0].r]||(D[Be[0].r]=[]),D[Be[0].r][Be[0].c]=Be[1]):D[Xt(Be[0])]=Be[1];break}},I);else if(j[2]==26||j[2]==14)I.Enum=ve,j[2]==14&&(I.qpro=!0,j.l=0),e(j,function(Be,it,We){switch(We){case 204:X=Be;break;case 22:Be[1].v=Be[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Be[3]>he&&(D["!ref"]=Er(Me),ue[X]=D,be.push(X),D=I.dense?[]:{},Me={s:{r:0,c:0},e:{r:0,c:0}},he=Be[3],X="Sheet"+(he+1)),Ve>0&&Be[0].r>=Ve)break;I.dense?(D[Be[0].r]||(D[Be[0].r]=[]),D[Be[0].r][Be[0].c]=Be[1]):D[Xt(Be[0])]=Be[1],Me.e.c<Be[0].c&&(Me.e.c=Be[0].c),Me.e.r<Be[0].r&&(Me.e.r=Be[0].r);break;case 27:Be[14e3]&&(Oe[Be[14e3][0]]=Be[14e3][1]);break;case 1537:Oe[Be[0]]=Be[1],Be[0]==he&&(X=Be[1]);break}},I);else throw new Error("Unrecognized LOTUS BOF "+j[2]);if(D["!ref"]=Er(Me),ue[fe||X]=D,be.push(fe||X),!Oe.length)return{SheetNames:be,Sheets:ue};for(var Je={},Ee=[],le=0;le<Oe.length;++le)ue[be[le]]?(Ee.push(Oe[le]||be[le]),Je[Oe[le]]=ue[Oe[le]]||ue[be[le]]):(Ee.push(Oe[le]),Je[Oe[le]]={"!ref":"A1"});return{SheetNames:Ee,Sheets:Je}}function n(j,O){var I=O||{};if(+I.codepage>=0&&Lo(+I.codepage),I.type=="string")throw new Error("Cannot write WK1 to JS string");var D=bn(),X=lr(j["!ref"]),fe=Array.isArray(j),he=[];Ke(D,0,s(1030)),Ke(D,6,f(X));for(var ue=Math.min(X.e.r,8191),be=X.s.r;be<=ue;++be)for(var Oe=Xr(be),Me=X.s.c;Me<=X.e.c;++Me){be===X.s.r&&(he[Me]=sn(Me));var Ve=he[Me]+Oe,Je=fe?(j[be]||[])[Me]:j[Ve];if(!(!Je||Je.t=="z"))if(Je.t=="n")(Je.v|0)==Je.v&&Je.v>=-32768&&Je.v<=32767?Ke(D,13,p(be,Me,Je.v)):Ke(D,14,v(be,Me,Je.v));else{var Ee=Ga(Je);Ke(D,15,g(be,Me,Ee.slice(0,239)))}}return Ke(D,1),D.end()}function a(j,O){var I=O||{};if(+I.codepage>=0&&Lo(+I.codepage),I.type=="string")throw new Error("Cannot write WK3 to JS string");var D=bn();Ke(D,0,l(j));for(var X=0,fe=0;X<j.SheetNames.length;++X)(j.Sheets[j.SheetNames[X]]||{})["!ref"]&&Ke(D,27,ae(j.SheetNames[X],fe++));var he=0;for(X=0;X<j.SheetNames.length;++X){var ue=j.Sheets[j.SheetNames[X]];if(!(!ue||!ue["!ref"])){for(var be=lr(ue["!ref"]),Oe=Array.isArray(ue),Me=[],Ve=Math.min(be.e.r,8191),Je=be.s.r;Je<=Ve;++Je)for(var Ee=Xr(Je),le=be.s.c;le<=be.e.c;++le){Je===be.s.r&&(Me[le]=sn(le));var Be=Me[le]+Ee,it=Oe?(ue[Je]||[])[le]:ue[Be];if(!(!it||it.t=="z"))if(it.t=="n")Ke(D,23,W(Je,le,he,it.v));else{var We=Ga(it);Ke(D,22,L(Je,le,he,We.slice(0,239)))}}++he}}return Ke(D,1),D.end()}function s(j){var O=Pe(2);return O.write_shift(2,j),O}function l(j){var O=Pe(26);O.write_shift(2,4096),O.write_shift(2,4),O.write_shift(4,0);for(var I=0,D=0,X=0,fe=0;fe<j.SheetNames.length;++fe){var he=j.SheetNames[fe],ue=j.Sheets[he];if(!(!ue||!ue["!ref"])){++X;var be=Rn(ue["!ref"]);I<be.e.r&&(I=be.e.r),D<be.e.c&&(D=be.e.c)}}return I>8191&&(I=8191),O.write_shift(2,I),O.write_shift(1,X),O.write_shift(1,D),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(1,1),O.write_shift(1,2),O.write_shift(4,0),O.write_shift(4,0),O}function c(j,O,I){var D={s:{c:0,r:0},e:{c:0,r:0}};return O==8&&I.qpro?(D.s.c=j.read_shift(1),j.l++,D.s.r=j.read_shift(2),D.e.c=j.read_shift(1),j.l++,D.e.r=j.read_shift(2),D):(D.s.c=j.read_shift(2),D.s.r=j.read_shift(2),O==12&&I.qpro&&(j.l+=2),D.e.c=j.read_shift(2),D.e.r=j.read_shift(2),O==12&&I.qpro&&(j.l+=2),D.s.c==65535&&(D.s.c=D.e.c=D.s.r=D.e.r=0),D)}function f(j){var O=Pe(8);return O.write_shift(2,j.s.c),O.write_shift(2,j.s.r),O.write_shift(2,j.e.c),O.write_shift(2,j.e.r),O}function u(j,O,I){var D=[{c:0,r:0},{t:"n",v:0},0,0];return I.qpro&&I.vers!=20768?(D[0].c=j.read_shift(1),D[3]=j.read_shift(1),D[0].r=j.read_shift(2),j.l+=2):(D[2]=j.read_shift(1),D[0].c=j.read_shift(2),D[0].r=j.read_shift(2)),D}function d(j,O,I){var D=j.l+O,X=u(j,O,I);if(X[1].t="s",I.vers==20768){j.l++;var fe=j.read_shift(1);return X[1].v=j.read_shift(fe,"utf8"),X}return I.qpro&&j.l++,X[1].v=j.read_shift(D-j.l,"cstr"),X}function g(j,O,I){var D=Pe(7+I.length);D.write_shift(1,255),D.write_shift(2,O),D.write_shift(2,j),D.write_shift(1,39);for(var X=0;X<D.length;++X){var fe=I.charCodeAt(X);D.write_shift(1,fe>=128?95:fe)}return D.write_shift(1,0),D}function x(j,O,I){var D=u(j,O,I);return D[1].v=j.read_shift(2,"i"),D}function p(j,O,I){var D=Pe(7);return D.write_shift(1,255),D.write_shift(2,O),D.write_shift(2,j),D.write_shift(2,I,"i"),D}function w(j,O,I){var D=u(j,O,I);return D[1].v=j.read_shift(8,"f"),D}function v(j,O,I){var D=Pe(13);return D.write_shift(1,255),D.write_shift(2,O),D.write_shift(2,j),D.write_shift(8,I,"f"),D}function _(j,O,I){var D=j.l+O,X=u(j,O,I);if(X[1].v=j.read_shift(8,"f"),I.qpro)j.l=D;else{var fe=j.read_shift(2);E(j.slice(j.l,j.l+fe),X),j.l+=fe}return X}function S(j,O,I){var D=O&32768;return O&=-32769,O=(D?j:0)+(O>=8192?O-16384:O),(D?"":"$")+(I?sn(O):Xr(O))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},A=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function E(j,O){Pn(j,0);for(var I=[],D=0,X="",fe="",he="",ue="";j.l<j.length;){var be=j[j.l++];switch(be){case 0:I.push(j.read_shift(8,"f"));break;case 1:fe=S(O[0].c,j.read_shift(2),!0),X=S(O[0].r,j.read_shift(2),!1),I.push(fe+X);break;case 2:{var Oe=S(O[0].c,j.read_shift(2),!0),Me=S(O[0].r,j.read_shift(2),!1);fe=S(O[0].c,j.read_shift(2),!0),X=S(O[0].r,j.read_shift(2),!1),I.push(Oe+Me+":"+fe+X)}break;case 3:if(j.l<j.length){console.error("WK1 premature formula end");return}break;case 4:I.push("("+I.pop()+")");break;case 5:I.push(j.read_shift(2));break;case 6:{for(var Ve="";be=j[j.l++];)Ve+=String.fromCharCode(be);I.push('"'+Ve.replace(/"/g,'""')+'"')}break;case 8:I.push("-"+I.pop());break;case 23:I.push("+"+I.pop());break;case 22:I.push("NOT("+I.pop()+")");break;case 20:case 21:ue=I.pop(),he=I.pop(),I.push(["AND","OR"][be-20]+"("+he+","+ue+")");break;default:if(be<32&&A[be])ue=I.pop(),he=I.pop(),I.push(he+A[be]+ue);else if(b[be]){if(D=b[be][1],D==69&&(D=j[j.l++]),D>I.length){console.error("WK1 bad formula parse 0x"+be.toString(16)+":|"+I.join("|")+"|");return}var Je=I.slice(-D);I.length-=D,I.push(b[be][0]+"("+Je.join(",")+")")}else return be<=7?console.error("WK1 invalid opcode "+be.toString(16)):be<=24?console.error("WK1 unsupported op "+be.toString(16)):be<=30?console.error("WK1 invalid opcode "+be.toString(16)):be<=115?console.error("WK1 unsupported function opcode "+be.toString(16)):console.error("WK1 unrecognized opcode "+be.toString(16))}}I.length==1?O[1].f=""+I[0]:console.error("WK1 bad formula parse |"+I.join("|")+"|")}function U(j){var O=[{c:0,r:0},{t:"n",v:0},0];return O[0].r=j.read_shift(2),O[3]=j[j.l++],O[0].c=j[j.l++],O}function R(j,O){var I=U(j);return I[1].t="s",I[1].v=j.read_shift(O-4,"cstr"),I}function L(j,O,I,D){var X=Pe(6+D.length);X.write_shift(2,j),X.write_shift(1,I),X.write_shift(1,O),X.write_shift(1,39);for(var fe=0;fe<D.length;++fe){var he=D.charCodeAt(fe);X.write_shift(1,he>=128?95:he)}return X.write_shift(1,0),X}function C(j,O){var I=U(j);I[1].v=j.read_shift(2);var D=I[1].v>>1;if(I[1].v&1)switch(D&7){case 0:D=(D>>3)*5e3;break;case 1:D=(D>>3)*500;break;case 2:D=(D>>3)/20;break;case 3:D=(D>>3)/200;break;case 4:D=(D>>3)/2e3;break;case 5:D=(D>>3)/2e4;break;case 6:D=(D>>3)/16;break;case 7:D=(D>>3)/64;break}return I[1].v=D,I}function P(j,O){var I=U(j),D=j.read_shift(4),X=j.read_shift(4),fe=j.read_shift(2);if(fe==65535)return D===0&&X===3221225472?(I[1].t="e",I[1].v=15):D===0&&X===3489660928?(I[1].t="e",I[1].v=42):I[1].v=0,I;var he=fe&32768;return fe=(fe&32767)-16446,I[1].v=(1-he*2)*(X*Math.pow(2,fe+32)+D*Math.pow(2,fe)),I}function W(j,O,I,D){var X=Pe(14);if(X.write_shift(2,j),X.write_shift(1,I),X.write_shift(1,O),D==0)return X.write_shift(4,0),X.write_shift(4,0),X.write_shift(2,65535),X;var fe=0,he=0,ue=0,be=0;return D<0&&(fe=1,D=-D),he=Math.log2(D)|0,D/=Math.pow(2,he-31),be=D>>>0,be&2147483648||(D/=2,++he,be=D>>>0),D-=be,be|=2147483648,be>>>=0,D*=Math.pow(2,32),ue=D>>>0,X.write_shift(4,ue),X.write_shift(4,be),he+=16383+(fe?32768:0),X.write_shift(2,he),X}function k(j,O){var I=P(j);return j.l+=O-14,I}function T(j,O){var I=U(j),D=j.read_shift(4);return I[1].v=D>>6,I}function H(j,O){var I=U(j),D=j.read_shift(8,"f");return I[1].v=D,I}function G(j,O){var I=H(j);return j.l+=O-10,I}function ce(j,O){return j[j.l+O-1]==0?j.read_shift(O,"cstr"):""}function J(j,O){var I=j[j.l++];I>O-1&&(I=O-1);for(var D="";D.length<I;)D+=String.fromCharCode(j[j.l++]);return D}function Q(j,O,I){if(!(!I.qpro||O<21)){var D=j.read_shift(1);j.l+=17,j.l+=1,j.l+=2;var X=j.read_shift(O-21,"cstr");return[D,X]}}function oe(j,O){for(var I={},D=j.l+O;j.l<D;){var X=j.read_shift(2);if(X==14e3){for(I[X]=[0,""],I[X][0]=j.read_shift(2);j[j.l];)I[X][1]+=String.fromCharCode(j[j.l]),j.l++;j.l++}}return I}function ae(j,O){var I=Pe(5+j.length);I.write_shift(2,14e3),I.write_shift(2,O);for(var D=0;D<j.length;++D){var X=j.charCodeAt(D);I[I.l++]=X>127?95:X}return I[I.l++]=0,I}var ge={0:{n:"BOF",f:Ed},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ce},222:{n:"SHEETNAMELP",f:J},65535:{n:""}},ve={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:R},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:C},25:{n:"FORMULA19",f:k},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:oe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:T},38:{n:"??"},39:{n:"NUMBER27",f:H},40:{n:"FORMULA28",f:G},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ce},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Q},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:r}}(),Bx=/^\s|\s$|[\t\n\r]/;function Id(e,r){if(!r.bookSST)return"";var t=[Fr];t[t.length]=Xe("sst",null,{xmlns:Is[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(Bx)&&(s+=' xml:space="preserve"'),s+=">"+Yt(a.t)+"</t>"),s+="</si>",t[t.length]=s}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function Ux(e){return[e.read_shift(4),e.read_shift(4)]}function Hx(e,r){return r||(r=Pe(8)),r.write_shift(4,e.Count),r.write_shift(4,e.Unique),r}var Wx=Lg;function zx(e){var r=bn();Ue(r,159,Hx(e));for(var t=0;t<e.length;++t)Ue(r,19,Wx(e[t]));return Ue(r,160),r.end()}function qx(e){for(var r=[],t=e.split(""),n=0;n<t.length;++n)r[n]=t[n].charCodeAt(0);return r}function Dd(e){var r=0,t,n=qx(e),a=n.length+1,s,l,c,f,u;for(t=Hi(a),t[0]=n.length,s=1;s!=a;++s)t[s]=n[s-1];for(s=a-1;s>=0;--s)l=t[s],c=r&16384?1:0,f=r<<1&32767,u=c|f,r=u^l;return r^52811}var Vx=function(){function e(a,s){switch(s.type){case"base64":return r(Va(a),s);case"binary":return r(a,s);case"buffer":return r(Ht&&Buffer.isBuffer(a)?a.toString("binary"):Uo(a),s);case"array":return r(x0(a),s)}throw new Error("Unrecognized type "+s.type)}function r(a,s){var l=s||{},c=l.dense?[]:{},f=a.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(d,g){Array.isArray(c)&&(c[g]=[]);for(var x=/\\\w+\b/g,p=0,w,v=-1;w=x.exec(d);){switch(w[0]){case"\\cell":var _=d.slice(p,x.lastIndex-w[0].length);if(_[0]==" "&&(_=_.slice(1)),++v,_.length){var S={v:_,t:"s"};Array.isArray(c)?c[g][v]=S:c[Xt({r:g,c:v})]=S}break}p=x.lastIndex}v>u.e.c&&(u.e.c=v)}),c["!ref"]=Er(u),c}function t(a,s){return Gi(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],l=lr(a["!ref"]),c,f=Array.isArray(a),u=l.s.r;u<=l.e.r;++u){s.push("\\trowd\\trautofit1");for(var d=l.s.c;d<=l.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=l.s.c;d<=l.e.c;++d){var g=Xt({r:u,c:d});c=f?(a[u]||[])[d]:a[g],!(!c||c.v==null&&(!c.f||c.F))&&(s.push(" "+(c.w||(Ga(c),c.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:n}}();function eu(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}var Gx=6,qa=Gx;function i0(e){return Math.floor((e+Math.round(128/qa)/256)*qa)}function s0(e){return Math.floor((e-5)/qa*100+.5)/100}function qc(e){return Math.round((e*qa+5)/qa*256)/256}function hf(e){e.width?(e.wpx=i0(e.width),e.wch=s0(e.wpx),e.MDW=qa):e.wpx?(e.wch=s0(e.wpx),e.width=qc(e.wch),e.MDW=qa):typeof e.wch=="number"&&(e.width=qc(e.wch),e.wpx=i0(e.width),e.MDW=qa),e.customWidth&&delete e.customWidth}var $x=96,Rd=$x;function o0(e){return e*96/Rd}function Md(e){return e*Rd/96}function Yx(e){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var n=t[0];n<=t[1];++n)e[n]!=null&&(r[r.length]=Xe("numFmt",null,{numFmtId:n,formatCode:Yt(e[n])}))}),r.length===1?"":(r[r.length]="</numFmts>",r[0]=Xe("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function Xx(e){var r=[];return r[r.length]=Xe("cellXfs",null),e.forEach(function(t){r[r.length]=Xe("xf",null,t)}),r[r.length]="</cellXfs>",r.length===2?"":(r[0]=Xe("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function Bd(e,r){var t=[Fr,Xe("styleSheet",null,{xmlns:Is[0],"xmlns:vt":Ur.vt})],n;return e.SSF&&(n=Yx(e.SSF))!=null&&(t[t.length]=n),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Xx(r.cellXfs))&&(t[t.length]=n),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function Kx(e,r){var t=e.read_shift(2),n=on(e);return[t,n]}function Jx(e,r,t){t||(t=Pe(6+4*r.length)),t.write_shift(2,e),Wr(r,t);var n=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),n}function Zx(e,r,t){var n={};n.sz=e.read_shift(2)/20;var a=Bg(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(n.underline=l);var c=e.read_shift(1);c>0&&(n.family=c);var f=e.read_shift(1);switch(f>0&&(n.charset=f),e.l++,n.color=Mg(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=on(e),n}function Qx(e,r){r||(r=Pe(25+4*32)),r.write_shift(2,e.sz*20),Ug(e,r),r.write_shift(2,e.bold?700:400);var t=0;e.vertAlign=="superscript"?t=1:e.vertAlign=="subscript"&&(t=2),r.write_shift(2,t),r.write_shift(1,e.underline||0),r.write_shift(1,e.family||0),r.write_shift(1,e.charset||0),r.write_shift(1,0),n0(e.color,r);var n=0;return n=2,r.write_shift(1,n),Wr(e.name,r),r.length>r.l?r.slice(0,r.l):r}var e5=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Nc,t5=Ta;function tu(e,r){r||(r=Pe(4*3+8*7+16*1)),Nc||(Nc=Zc(e5));var t=Nc[e.patternType];t==null&&(t=40),r.write_shift(4,t);var n=0;if(t!=40)for(n0({auto:1},r),n0({auto:1},r);n<12;++n)r.write_shift(4,0);else{for(;n<4;++n)r.write_shift(4,0);for(;n<12;++n)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function r5(e,r){var t=e.l+r,n=e.read_shift(2),a=e.read_shift(2);return e.l=t,{ixfe:n,numFmtId:a}}function Ud(e,r,t){t||(t=Pe(16)),t.write_shift(2,r||0),t.write_shift(2,e.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var n=0;return t.write_shift(1,n),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function xo(e,r){return r||(r=Pe(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var n5=Ta;function a5(e,r){return r||(r=Pe(51)),r.write_shift(1,0),xo(null,r),xo(null,r),xo(null,r),xo(null,r),xo(null,r),r.length>r.l?r.slice(0,r.l):r}function i5(e,r){return r||(r=Pe(12+4*10)),r.write_shift(4,e.xfId),r.write_shift(2,1),r.write_shift(1,0),r.write_shift(1,0),r0(e.name||"",r),r.length>r.l?r.slice(0,r.l):r}function s5(e,r,t){var n=Pe(2052);return n.write_shift(4,e),r0(r,n),r0(t,n),n.length>n.l?n.slice(0,n.l):n}function o5(e,r){if(r){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)r[a]!=null&&++t}),t!=0&&(Ue(e,615,da(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)r[a]!=null&&Ue(e,44,Jx(a,r[a]))}),Ue(e,616))}}function l5(e){var r=1;Ue(e,611,da(r)),Ue(e,43,Qx({sz:12,color:{theme:1},name:"Calibri",family:2})),Ue(e,612)}function c5(e){var r=2;Ue(e,603,da(r)),Ue(e,45,tu({patternType:"none"})),Ue(e,45,tu({patternType:"gray125"})),Ue(e,604)}function f5(e){var r=1;Ue(e,613,da(r)),Ue(e,46,a5()),Ue(e,614)}function h5(e){var r=1;Ue(e,626,da(r)),Ue(e,47,Ud({numFmtId:0},65535)),Ue(e,627)}function u5(e,r){Ue(e,617,da(r.length)),r.forEach(function(t){Ue(e,47,Ud(t,0))}),Ue(e,618)}function d5(e){var r=1;Ue(e,619,da(r)),Ue(e,48,i5({xfId:0,name:"Normal"})),Ue(e,620)}function p5(e){var r=0;Ue(e,505,da(r)),Ue(e,506)}function m5(e){var r=0;Ue(e,508,s5(r,"TableStyleMedium9","PivotStyleMedium4")),Ue(e,509)}function g5(e,r){var t=bn();return Ue(t,278),o5(t,e.SSF),l5(t),c5(t),f5(t),h5(t),u5(t,r.cellXfs),d5(t),p5(t),m5(t),Ue(t,279),t.end()}function Hd(e,r){if(r&&r.themeXLSX)return r.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var t=[Fr];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',t[t.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',t[t.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',t[t.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜Žé«”"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',t[t.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',t[t.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',t[t.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜Žé«”"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function x5(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:on(e)}}function v5(e){var r=Pe(12+2*e.name.length);return r.write_shift(4,e.flags),r.write_shift(4,e.version),Wr(e.name,r),r.slice(0,r.l)}function y5(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function w5(e){var r=Pe(4+8*e.length);r.write_shift(4,e.length);for(var t=0;t<e.length;++t)r.write_shift(4,e[t][0]),r.write_shift(4,e[t][1]);return r}function b5(e,r){var t=Pe(8+2*r.length);return t.write_shift(4,e),Wr(r,t),t.slice(0,t.l)}function N5(e){return e.l+=4,e.read_shift(4)!=0}function _5(e,r){var t=Pe(8);return t.write_shift(4,e),t.write_shift(4,1),t}function S5(){var e=bn();return Ue(e,332),Ue(e,334,da(1)),Ue(e,335,v5({name:"XLDAPR",version:12e4,flags:3496657072})),Ue(e,336),Ue(e,339,b5(1,"XLDAPR")),Ue(e,52),Ue(e,35,da(514)),Ue(e,4096,da(0)),Ue(e,4097,Kn(1)),Ue(e,36),Ue(e,53),Ue(e,340),Ue(e,337,_5(1)),Ue(e,51,w5([[1,0]])),Ue(e,338),Ue(e,333),e.end()}function Wd(){var e=[Fr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function A5(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=Xt(t);var n=e.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}var Es=1024;function zd(e,r){for(var t=[21600,21600],n=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),a=[Xe("xml",null,{"xmlns:v":On.v,"xmlns:o":On.o,"xmlns:x":On.x,"xmlns:mv":On.mv}).replace(/\/>/,">"),Xe("o:shapelayout",Xe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Xe("v:shapetype",[Xe("v:stroke",null,{joinstyle:"miter"}),Xe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:n})];Es<e*1e3;)Es+=1e3;return r.forEach(function(s){var l=Hr(s[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var f=c.type=="gradient"?Xe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Xe("v:fill",f,c),d={on:"t",obscured:"t"};++Es,a=a.concat(["<v:shape"+Do({id:"_x0000_s"+Es,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Xe("v:shadow",null,d),Xe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Yr("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),Yr("x:AutoFill","False"),Yr("x:Row",String(l.r)),Yr("x:Column",String(l.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function qd(e){var r=[Fr,Xe("comments",null,{xmlns:Is[0]})],t=[];return r.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var s=Yt(a.a);t.indexOf(s)==-1&&(t.push(s),r.push("<author>"+s+"</author>")),a.T&&a.ID&&t.indexOf("tc="+a.ID)==-1&&(t.push("tc="+a.ID),r.push("<author>tc="+a.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),e.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=t.indexOf("tc="+n[1][0].ID):n[1].forEach(function(f){f.a&&(a=t.indexOf(Yt(f.a))),s.push(f.t||"")}),r.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)r.push(Yr("t",Yt(s[0]||"")));else{for(var l=`Comment:
    `+s[0]+`
`,c=1;c<s.length;++c)l+=`Reply:
    `+s[c]+`
`;r.push(Yr("t",Yt(l)))}r.push("</text></comment>")}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function j5(e,r,t){var n=[Fr,Xe("ThreadedComments",null,{xmlns:Ur.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var s="";(a[1]||[]).forEach(function(l,c){if(!l.T){delete l.ID;return}l.a&&r.indexOf(l.a)==-1&&r.push(l.a);var f={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};c==0?s=f.id:f.parentId=s,l.ID=f.id,l.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(l.a)).slice(-12)+"}"),n.push(Xe("threadedComment",Yr("text",l.t||""),f))})}),n.push("</ThreadedComments>"),n.join("")}function k5(e){var r=[Fr,Xe("personList",null,{xmlns:Ur.TCMNT,"xmlns:x":Is[0]}).replace(/[\/]>/,">")];return e.forEach(function(t,n){r.push(Xe("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:t,providerId:"None"}))}),r.push("</personList>"),r.join("")}function T5(e){var r={};r.iauthor=e.read_shift(4);var t=Ki(e);return r.rfx=t.s,r.ref=Xt(t.s),e.l+=16,r}function E5(e,r){return r==null&&(r=Pe(36)),r.write_shift(4,e[1].iauthor),Rs(e[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}var F5=on;function C5(e){return Wr(e.slice(0,54))}function L5(e){var r=bn(),t=[];return Ue(r,628),Ue(r,630),e.forEach(function(n){n[1].forEach(function(a){t.indexOf(a.a)>-1||(t.push(a.a.slice(0,54)),Ue(r,632,C5(a.a)))})}),Ue(r,631),Ue(r,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=t.indexOf(a.a);var s={s:Hr(n[0]),e:Hr(n[0])};Ue(r,635,E5([s,a])),a.t&&a.t.length>0&&Ue(r,637,Og(a)),Ue(r,636),delete a.iauthor})}),Ue(r,634),Ue(r,629),r.end()}function P5(e,r){r.FullPaths.forEach(function(t,n){if(n!=0){var a=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Zt.utils.cfb_add(e,a,r.FileIndex[n].content)}})}var Vd=["xlsb","xlsm","xlam","biff8","xla"],O5=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(n,a,s,l){var c=!1,f=!1;s.length==0?f=!0:s.charAt(0)=="["&&(f=!0,s=s.slice(1,-1)),l.length==0?c=!0:l.charAt(0)=="["&&(c=!0,l=l.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,d=l.length>0?parseInt(l,10)|0:0;return c?d+=r.c:--d,f?u+=r.r:--u,a+(c?"":"$")+sn(d)+(f?"":"$")+Xr(u)}return function(a,s){return r=s,a.replace(e,t)}}(),uf=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,df=function(){return function(r,t){return r.replace(uf,function(n,a,s,l,c,f){var u=sf(l)-(s?0:t.c),d=af(f)-(c?0:t.r),g=d==0?"":c?d+1:"["+d+"]",x=u==0?"":s?u+1:"["+u+"]";return a+"R"+g+"C"+x})}}();function I5(e,r){return e.replace(uf,function(t,n,a,s,l,c){return n+(a=="$"?a+s:sn(sf(s)+r.c))+(l=="$"?l+c:Xr(af(c)+r.r))})}function D5(e){return e.length!=1}function Tr(e){e.l+=1}function wi(e,r){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function Gd(e,r,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return $d(e);t.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),l=wi(e),c=wi(e);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:c[0],cRel:c[1],rRel:c[2]}}}function $d(e){var r=wi(e),t=wi(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:t[0],c:a,cRel:t[1],rRel:t[2]}}}function R5(e,r,t){if(t.biff<8)return $d(e);var n=e.read_shift(t.biff==12?4:2),a=e.read_shift(t.biff==12?4:2),s=wi(e),l=wi(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function Yd(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return M5(e);var n=e.read_shift(t&&t.biff==12?4:2),a=wi(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function M5(e){var r=wi(e),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function B5(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function U5(e,r,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return H5(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),l=(s&16384)>>14,c=(s&32768)>>15;if(s&=16383,c==1)for(;a>524287;)a-=1048576;if(l==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:l,rRel:c}}function H5(e){var r=e.read_shift(2),t=e.read_shift(1),n=(r&32768)>>15,a=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),a==1&&t>=128&&(t=t-256),{r,c:t,cRel:a,rRel:n}}function W5(e,r,t){var n=(e[e.l++]&96)>>5,a=Gd(e,t.biff>=2&&t.biff<=5?6:8,t);return[n,a]}function z5(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var l=Gd(e,s,t);return[n,a,l]}function q5(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function V5(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(t)switch(t.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function G5(e,r,t){var n=(e[e.l++]&96)>>5,a=R5(e,r-1,t);return[n,a]}function $5(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[n]}function ru(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function Y5(e,r,t){e.l+=2;for(var n=e.read_shift(t&&t.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(t&&t.biff==2?1:2));return a}function X5(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function K5(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function J5(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function Z5(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[n]}function Xd(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function Q5(e){return e.read_shift(2),Xd(e)}function ev(e){return e.read_shift(2),Xd(e)}function tv(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=Yd(e,0,t);return[n,a]}function rv(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=U5(e,0,t);return[n,a]}function nv(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var s=Yd(e,0,t);return[n,a,s]}function av(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(t&&t.biff<=3?1:2);return[ay[a],Zd[a],n]}function iv(e,r,t){var n=e[e.l++],a=e.read_shift(1),s=t&&t.biff<=3?[n==88?-1:0,e.read_shift(1)]:sv(e);return[a,(s[0]===0?Zd:ny)[s[1]]]}function sv(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function ov(e,r,t){e.l+=t&&t.biff==2?3:4}function lv(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function cv(e){return e.l++,zo[e.read_shift(1)]}function fv(e){return e.l++,e.read_shift(2)}function hv(e){return e.l++,e.read_shift(1)!==0}function uv(e){return e.l++,Ms(e)}function dv(e,r,t){return e.l++,Cd(e,r-1,t)}function pv(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=nx(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=zo[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Ms(e);break;case 2:t[1]=ox(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function mv(e,r,t){for(var n=e.read_shift(t.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((t.biff==12?Ki:fx)(e));return a}function gv(e,r,t){var n=0,a=0;t.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--a==0&&(a=256));for(var s=0,l=[];s!=n&&(l[s]=[]);++s)for(var c=0;c!=a;++c)l[s][c]=pv(e,t.biff);return l}function xv(e,r,t){var n=e.read_shift(1)>>>5&3,a=!t||t.biff>=8?4:2,s=e.read_shift(a);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function vv(e,r,t){if(t.biff==5)return yv(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function yv(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[r,t,n]}function wv(e,r,t){var n=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function bv(e,r,t){var n=e.read_shift(1)>>>5&3,a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function Nv(e,r,t){var n=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[n]}function _v(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var Sv=Ta,Av=Ta,jv=Ta;function qo(e,r,t){return e.l+=2,[B5(e)]}function pf(e){return e.l+=6,[]}var kv=qo,Tv=pf,Ev=pf,Fv=qo;function Kd(e){return e.l+=2,[Ed(e),e.read_shift(2)&1]}var Cv=qo,Lv=Kd,Pv=pf,Ov=qo,Iv=qo,Dv=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Rv(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),l=Dv[t>>2&31];return{ixti:r,coltype:t&3,rt:l,idx:n,c:a,C:s}}function Mv(e){return e.l+=2,[e.read_shift(4)]}function Bv(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function Uv(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function Hv(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function Wv(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function zv(e){return e.l+=4,[0,0]}var nu={1:{n:"PtgExp",f:lv},2:{n:"PtgTbl",f:jv},3:{n:"PtgAdd",f:Tr},4:{n:"PtgSub",f:Tr},5:{n:"PtgMul",f:Tr},6:{n:"PtgDiv",f:Tr},7:{n:"PtgPower",f:Tr},8:{n:"PtgConcat",f:Tr},9:{n:"PtgLt",f:Tr},10:{n:"PtgLe",f:Tr},11:{n:"PtgEq",f:Tr},12:{n:"PtgGe",f:Tr},13:{n:"PtgGt",f:Tr},14:{n:"PtgNe",f:Tr},15:{n:"PtgIsect",f:Tr},16:{n:"PtgUnion",f:Tr},17:{n:"PtgRange",f:Tr},18:{n:"PtgUplus",f:Tr},19:{n:"PtgUminus",f:Tr},20:{n:"PtgPercent",f:Tr},21:{n:"PtgParen",f:Tr},22:{n:"PtgMissArg",f:Tr},23:{n:"PtgStr",f:dv},26:{n:"PtgSheet",f:Bv},27:{n:"PtgEndSheet",f:Uv},28:{n:"PtgErr",f:cv},29:{n:"PtgBool",f:hv},30:{n:"PtgInt",f:fv},31:{n:"PtgNum",f:uv},32:{n:"PtgArray",f:$5},33:{n:"PtgFunc",f:av},34:{n:"PtgFuncVar",f:iv},35:{n:"PtgName",f:xv},36:{n:"PtgRef",f:tv},37:{n:"PtgArea",f:W5},38:{n:"PtgMemArea",f:wv},39:{n:"PtgMemErr",f:Sv},40:{n:"PtgMemNoMem",f:Av},41:{n:"PtgMemFunc",f:bv},42:{n:"PtgRefErr",f:Nv},43:{n:"PtgAreaErr",f:q5},44:{n:"PtgRefN",f:rv},45:{n:"PtgAreaN",f:G5},46:{n:"PtgMemAreaN",f:Hv},47:{n:"PtgMemNoMemN",f:Wv},57:{n:"PtgNameX",f:vv},58:{n:"PtgRef3d",f:nv},59:{n:"PtgArea3d",f:z5},60:{n:"PtgRefErr3d",f:_v},61:{n:"PtgAreaErr3d",f:V5},255:{}},qv={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Vv={1:{n:"PtgElfLel",f:Kd},2:{n:"PtgElfRw",f:Ov},3:{n:"PtgElfCol",f:kv},6:{n:"PtgElfRwV",f:Iv},7:{n:"PtgElfColV",f:Fv},10:{n:"PtgElfRadical",f:Cv},11:{n:"PtgElfRadicalS",f:Pv},13:{n:"PtgElfColS",f:Tv},15:{n:"PtgElfColSV",f:Ev},16:{n:"PtgElfRadicalLel",f:Lv},25:{n:"PtgList",f:Rv},29:{n:"PtgSxName",f:Mv},255:{}},Gv={0:{n:"PtgAttrNoop",f:zv},1:{n:"PtgAttrSemi",f:Z5},2:{n:"PtgAttrIf",f:K5},4:{n:"PtgAttrChoose",f:Y5},8:{n:"PtgAttrGoto",f:X5},16:{n:"PtgAttrSum",f:ov},32:{n:"PtgAttrBaxcel",f:ru},33:{n:"PtgAttrBaxcel",f:ru},64:{n:"PtgAttrSpace",f:Q5},65:{n:"PtgAttrSpaceSemi",f:ev},128:{n:"PtgAttrIfError",f:J5},255:{}};function $v(e,r,t,n){if(n.biff<8)return Ta(e,r);for(var a=e.l+r,s=[],l=0;l!==t.length;++l)switch(t[l][0]){case"PtgArray":t[l][1]=gv(e,0,n),s.push(t[l][1]);break;case"PtgMemArea":t[l][2]=mv(e,t[l][1],n),s.push(t[l][2]);break;case"PtgExp":n&&n.biff==12&&(t[l][1][1]=e.read_shift(4),s.push(t[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[l][0]}return r=a-e.l,r!==0&&s.push(Ta(e,r)),s}function Yv(e,r,t){for(var n=e.l+r,a,s,l=[];n!=e.l;)r=n-e.l,s=e[e.l],a=nu[s]||nu[qv[s]],(s===24||s===25)&&(a=(s===24?Vv:Gv)[e[e.l+1]]),!a||!a.f?Ta(e,r):l.push([a.n,a.f(e,r,t)]);return l}function Xv(e){for(var r=[],t=0;t<e.length;++t){for(var n=e[t],a=[],s=0;s<n.length;++s){var l=n[s];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}r.push(a.join(","))}return r.join(";")}var Kv={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Jv(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Jd(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!n)return"SH33TJSERR1";var a="";if(t.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function au(e,r,t){var n=Jd(e,r,t);return n=="#REF"?n:Jv(n,t)}function Os(e,r,t,n,a){var s=a&&a.biff||8,l={s:{c:0,r:0}},c=[],f,u,d,g=0,x=0,p,w="";if(!e[0]||!e[0][0])return"";for(var v=-1,_="",S=0,b=e[0].length;S<b;++S){var A=e[0][S];switch(A[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=c.pop(),u=c.pop(),v>=0){switch(e[0][v][1][0]){case 0:_=pr(" ",e[0][v][1][1]);break;case 1:_=pr("\r",e[0][v][1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}u=u+_,v=-1}c.push(u+Kv[A[0]]+f);break;case"PtgIsect":f=c.pop(),u=c.pop(),c.push(u+" "+f);break;case"PtgUnion":f=c.pop(),u=c.pop(),c.push(u+","+f);break;case"PtgRange":f=c.pop(),u=c.pop(),c.push(u+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=ko(A[1][1],l,a),c.push(To(d,s));break;case"PtgRefN":d=t?ko(A[1][1],t,a):A[1][1],c.push(To(d,s));break;case"PtgRef3d":g=A[1][1],d=ko(A[1][2],l,a),w=au(n,g,a),c.push(w+"!"+To(d,s));break;case"PtgFunc":case"PtgFuncVar":var E=A[1][0],U=A[1][1];E||(E=0),E&=127;var R=E==0?[]:c.slice(-E);c.length-=E,U==="User"&&(U=R.shift()),c.push(U+"("+R.join(",")+")");break;case"PtgBool":c.push(A[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(A[1]);break;case"PtgNum":c.push(String(A[1]));break;case"PtgStr":c.push('"'+A[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(A[1]);break;case"PtgAreaN":p=Wh(A[1][1],t?{s:t}:l,a),c.push(wc(p,a));break;case"PtgArea":p=Wh(A[1][1],l,a),c.push(wc(p,a));break;case"PtgArea3d":g=A[1][1],p=A[1][2],w=au(n,g,a),c.push(w+"!"+wc(p,a));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=A[1][2];var L=(n.names||[])[x-1]||(n[0]||[])[x],C=L?L.Name:"SH33TJSNAME"+String(x);C&&C.slice(0,6)=="_xlfn."&&!a.xlfn&&(C=C.slice(6)),c.push(C);break;case"PtgNameX":var P=A[1][1];x=A[1][2];var W;if(a.biff<=5)P<0&&(P=-P),n[P]&&(W=n[P][x]);else{var k="";if(((n[P]||[])[0]||[])[0]==14849||(((n[P]||[])[0]||[])[0]==1025?n[P][x]&&n[P][x].itab>0&&(k=n.SheetNames[n[P][x].itab-1]+"!"):k=n.SheetNames[x-1]+"!"),n[P]&&n[P][x])k+=n[P][x].Name;else if(n[0]&&n[0][x])k+=n[0][x].Name;else{var T=(Jd(n,P,a)||"").split(";;");T[x-1]?k=T[x-1]:k+="SH33TJSERRX"}c.push(k);break}W||(W={Name:"SH33TJSERRY"}),c.push(W.Name);break;case"PtgParen":var H="(",G=")";if(v>=0){switch(_="",e[0][v][1][0]){case 2:H=pr(" ",e[0][v][1][1])+H;break;case 3:H=pr("\r",e[0][v][1][1])+H;break;case 4:G=pr(" ",e[0][v][1][1])+G;break;case 5:G=pr("\r",e[0][v][1][1])+G;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}v=-1}c.push(H+c.pop()+G);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":d={c:A[1][1],r:A[1][0]};var ce={c:t.c,r:t.r};if(n.sharedf[Xt(d)]){var J=n.sharedf[Xt(d)];c.push(Os(J,l,ce,n,a))}else{var Q=!1;for(f=0;f!=n.arrayf.length;++f)if(u=n.arrayf[f],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){c.push(Os(u[1],l,ce,n,a)),Q=!0;break}Q||c.push(A[1])}break;case"PtgArray":c.push("{"+Xv(A[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=S;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+A[1].idx+"[#"+A[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(A));default:throw new Error("Unrecognized Formula Token: "+String(A))}var oe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&v>=0&&oe.indexOf(e[0][S][0])==-1){A=e[0][v];var ae=!0;switch(A[1][0]){case 4:ae=!1;case 0:_=pr(" ",A[1][1]);break;case 5:ae=!1;case 1:_=pr("\r",A[1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+A[1][0])}c.push((ae?_:"")+c.pop()+(ae?"":_)),v=-1}}if(c.length>1&&a.WTF)throw new Error("bad formula stack");return c[0]}function Zv(e){if(e==null){var r=Pe(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}else if(typeof e=="number")return Wi(e);return Wi(0)}function Qv(e,r,t,n,a){var s=zi(r,t,a),l=Zv(e.v),c=Pe(6),f=33;c.write_shift(2,f),c.write_shift(4,0);for(var u=Pe(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var g=$r([s,l,c,u]);return g}function v0(e,r,t){var n=e.read_shift(4),a=Yv(e,n,t),s=e.read_shift(4),l=s>0?$v(e,s,a,t):null;return[a,l]}var ey=v0,y0=v0,ty=v0,ry=v0,ny={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Zd={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},ay={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function iy(e){var r="of:="+e.replace(uf,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return r.replace(/;/g,"|").replace(/,/g,";")}function sy(e){return e.replace(/\./,"!")}var Eo=typeof Map<"u";function mf(e,r,t){var n=0,a=e.length;if(t){if(Eo?t.has(r):Object.prototype.hasOwnProperty.call(t,r)){for(var s=Eo?t.get(r):t[r];n<s.length;++n)if(e[s[n]].t===r)return e.Count++,s[n]}}else for(;n<a;++n)if(e[n].t===r)return e.Count++,n;return e[a]={t:r},e.Count++,e.Unique++,t&&(Eo?(t.has(r)||t.set(r,[]),t.get(r).push(a)):(Object.prototype.hasOwnProperty.call(t,r)||(t[r]=[]),t[r].push(a))),a}function w0(e,r){var t={min:e+1,max:e+1},n=-1;return r.MDW&&(qa=r.MDW),r.width!=null?t.customWidth=1:r.wpx!=null?n=s0(r.wpx):r.wch!=null&&(n=r.wch),n>-1?(t.width=qc(n),t.customWidth=1):r.width!=null&&(t.width=r.width),r.hidden&&(t.hidden=!0),r.level!=null&&(t.outlineLevel=t.level=r.level),t}function Qd(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function Ni(e,r,t){var n=t.revssf[r.z!=null?r.z:"General"],a=60,s=e.length;if(n==null&&t.ssf){for(;a<392;++a)if(t.ssf[a]==null){Yu(r.z,a),t.ssf[a]=r.z,t.revssf[r.z]=n=a;break}}for(a=0;a!=s;++a)if(e[a].numFmtId===n)return a;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function oy(e,r,t){if(e&&e["!ref"]){var n=lr(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+t+"): "+e["!ref"])}}function ly(e){if(e.length===0)return"";for(var r='<mergeCells count="'+e.length+'">',t=0;t!=e.length;++t)r+='<mergeCell ref="'+Er(e[t])+'"/>';return r+"</mergeCells>"}function cy(e,r,t,n,a){var s=!1,l={},c=null;if(n.bookType!=="xlsx"&&r.vbaraw){var f=r.SheetNames[t];try{r.Workbook&&(f=r.Workbook.Sheets[t].CodeName||f)}catch{}s=!0,l.codeName=Io(Yt(f))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),c=(c||"")+Xe("outlinePr",null,u)}!s&&!c||(a[a.length]=Xe("sheetPr",c,l))}var fy=["objects","scenarios","selectLockedCells","selectUnlockedCells"],hy=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function uy(e){var r={sheet:1};return fy.forEach(function(t){e[t]!=null&&e[t]&&(r[t]="1")}),hy.forEach(function(t){e[t]!=null&&!e[t]&&(r[t]="0")}),e.password&&(r.password=Dd(e.password).toString(16).toUpperCase()),Xe("sheetProtection",null,r)}function dy(e){return Qd(e),Xe("pageMargins",null,e)}function py(e,r){for(var t=["<cols>"],n,a=0;a!=r.length;++a)(n=r[a])&&(t[t.length]=Xe("col",null,w0(a,n)));return t[t.length]="</cols>",t.join("")}function my(e,r,t,n){var a=typeof e.ref=="string"?e.ref:Er(e.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,l=Rn(a);l.s.r==l.e.r&&(l.e.r=Rn(r["!ref"]).e.r,a=Er(l));for(var c=0;c<s.length;++c){var f=s[c];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+t.SheetNames[n]+"'!"+a;break}}return c==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+a}),Xe("autoFilter",null,{ref:a})}function gy(e,r,t,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Xe("sheetViews",Xe("sheetView",null,a),{})}function xy(e,r,t,n){if(e.c&&t["!comments"].push([r,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",s=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=zo[e.v];break;case"d":n&&n.cellDates?a=dn(e.v,-1).toISOString():(e=_n(e),e.t="n",a=""+(e.v=Nn(dn(e.v)))),typeof e.z>"u"&&(e.z=gr[14]);break;default:a=e.v;break}var c=Yr("v",Yt(a)),f={r},u=Ni(n.cellXfs,e,n);switch(u!==0&&(f.s=u),e.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){c=Yr("v",""+mf(n.Strings,e.v,n.revStrings)),f.t="s";break}f.t="str";break}if(e.t!=s&&(e.t=s,e.v=l),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,r.length)==r?{t:"array",ref:e.F}:null;c=Xe("f",Yt(e.f),d)+(e.v!=null?c:"")}return e.l&&t["!links"].push([r,e.l]),e.D&&(f.cm=1),Xe("c",c,f)}function vy(e,r,t,n){var a=[],s=[],l=lr(e["!ref"]),c="",f,u="",d=[],g=0,x=0,p=e["!rows"],w=Array.isArray(e),v={r:u},_,S=-1;for(x=l.s.c;x<=l.e.c;++x)d[x]=sn(x);for(g=l.s.r;g<=l.e.r;++g){for(s=[],u=Xr(g),x=l.s.c;x<=l.e.c;++x){f=d[x]+u;var b=w?(e[g]||[])[x]:e[f];b!==void 0&&(c=xy(b,f,e,r))!=null&&s.push(c)}(s.length>0||p&&p[g])&&(v={r:u},p&&p[g]&&(_=p[g],_.hidden&&(v.hidden=1),S=-1,_.hpx?S=o0(_.hpx):_.hpt&&(S=_.hpt),S>-1&&(v.ht=S,v.customHeight=1),_.level&&(v.outlineLevel=_.level)),a[a.length]=Xe("row",s.join(""),v))}if(p)for(;g<p.length;++g)p&&p[g]&&(v={r:g+1},_=p[g],_.hidden&&(v.hidden=1),S=-1,_.hpx?S=o0(_.hpx):_.hpt&&(S=_.hpt),S>-1&&(v.ht=S,v.customHeight=1),_.level&&(v.outlineLevel=_.level),a[a.length]=Xe("row","",v));return a.join("")}function e1(e,r,t,n){var a=[Fr,Xe("worksheet",null,{xmlns:Is[0],"xmlns:r":Ur.r})],s=t.SheetNames[e],l=0,c="",f=t.Sheets[s];f==null&&(f={});var u=f["!ref"]||"A1",d=lr(u);if(d.e.c>16383||d.e.r>1048575){if(r.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=Er(d)}n||(n={}),f["!comments"]=[];var g=[];cy(f,t,e,r,a),a[a.length]=Xe("dimension",null,{ref:u}),a[a.length]=gy(f,r,e,t),r.sheetFormat&&(a[a.length]=Xe("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(a[a.length]=py(f,f["!cols"])),a[l=a.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(c=vy(f,r),c.length>0&&(a[a.length]=c)),a.length>l+1&&(a[a.length]="</sheetData>",a[l]=a[l].replace("/>",">")),f["!protect"]&&(a[a.length]=uy(f["!protect"])),f["!autofilter"]!=null&&(a[a.length]=my(f["!autofilter"],f,t,e)),f["!merges"]!=null&&f["!merges"].length>0&&(a[a.length]=ly(f["!merges"]));var x=-1,p,w=-1;return f["!links"].length>0&&(a[a.length]="<hyperlinks>",f["!links"].forEach(function(v){v[1].Target&&(p={ref:v[0]},v[1].Target.charAt(0)!="#"&&(w=$t(n,-1,Yt(v[1].Target).replace(/#.*$/,""),Bt.HLINK),p["r:id"]="rId"+w),(x=v[1].Target.indexOf("#"))>-1&&(p.location=Yt(v[1].Target.slice(x+1))),v[1].Tooltip&&(p.tooltip=Yt(v[1].Tooltip)),a[a.length]=Xe("hyperlink",null,p))}),a[a.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(a[a.length]=dy(f["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&(a[a.length]=Yr("ignoredErrors",Xe("ignoredError",null,{numberStoredAsText:1,sqref:u}))),g.length>0&&(w=$t(n,-1,"../drawings/drawing"+(e+1)+".xml",Bt.DRAW),a[a.length]=Xe("drawing",null,{"r:id":"rId"+w}),f["!drawing"]=g),f["!comments"].length>0&&(w=$t(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Bt.VML),a[a.length]=Xe("legacyDrawing",null,{"r:id":"rId"+w}),f["!legacy"]=w),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function yy(e,r){var t={},n=e.l+r;t.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=a/20),t}function wy(e,r,t){var n=Pe(145),a=(t["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;a.hpx?s=o0(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var l=0;a.level&&(l|=a.level),a.hidden&&(l|=16),(a.hpx||a.hpt)&&(l|=32),n.write_shift(1,l),n.write_shift(1,0);var c=0,f=n.l;n.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(r.s.c>d+1<<10||r.e.c<d<<10)){for(var g=-1,x=-1,p=d<<10;p<d+1<<10;++p){u.c=p;var w=Array.isArray(t)?(t[u.r]||[])[u.c]:t[Xt(u)];w&&(g<0&&(g=p),x=p)}g<0||(++c,n.write_shift(4,g),n.write_shift(4,x))}var v=n.l;return n.l=f,n.write_shift(4,c),n.l=v,n.length>n.l?n.slice(0,n.l):n}function by(e,r,t,n){var a=wy(n,t,r);(a.length>17||(r["!rows"]||[])[n])&&Ue(e,0,a)}var Ny=Ki,_y=Rs;function Sy(){}function Ay(e,r){var t={},n=e[e.l];return++e.l,t.above=!(n&64),t.left=!(n&128),e.l+=18,t.name=Ig(e),t}function jy(e,r,t){t==null&&(t=Pe(84+4*e.length));var n=192;r&&(r.above&&(n&=-65),r.left&&(n&=-129)),t.write_shift(1,n);for(var a=1;a<3;++a)t.write_shift(1,0);return n0({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),md(e,t),t.slice(0,t.l)}function ky(e){var r=Jn(e);return[r]}function Ty(e,r,t){return t==null&&(t=Pe(8)),$i(r,t)}function Ey(e){var r=Yi(e);return[r]}function Fy(e,r,t){return t==null&&(t=Pe(4)),Xi(r,t)}function Cy(e){var r=Jn(e),t=e.read_shift(1);return[r,t,"b"]}function Ly(e,r,t){return t==null&&(t=Pe(9)),$i(r,t),t.write_shift(1,e.v?1:0),t}function Py(e){var r=Yi(e),t=e.read_shift(1);return[r,t,"b"]}function Oy(e,r,t){return t==null&&(t=Pe(5)),Xi(r,t),t.write_shift(1,e.v?1:0),t}function Iy(e){var r=Jn(e),t=e.read_shift(1);return[r,t,"e"]}function Dy(e,r,t){return t==null&&(t=Pe(9)),$i(r,t),t.write_shift(1,e.v),t}function Ry(e){var r=Yi(e),t=e.read_shift(1);return[r,t,"e"]}function My(e,r,t){return t==null&&(t=Pe(8)),Xi(r,t),t.write_shift(1,e.v),t.write_shift(2,0),t.write_shift(1,0),t}function By(e){var r=Jn(e),t=e.read_shift(4);return[r,t,"s"]}function Uy(e,r,t){return t==null&&(t=Pe(12)),$i(r,t),t.write_shift(4,r.v),t}function Hy(e){var r=Yi(e),t=e.read_shift(4);return[r,t,"s"]}function Wy(e,r,t){return t==null&&(t=Pe(8)),Xi(r,t),t.write_shift(4,r.v),t}function zy(e){var r=Jn(e),t=Ms(e);return[r,t,"n"]}function qy(e,r,t){return t==null&&(t=Pe(16)),$i(r,t),Wi(e.v,t),t}function Vy(e){var r=Yi(e),t=Ms(e);return[r,t,"n"]}function Gy(e,r,t){return t==null&&(t=Pe(12)),Xi(r,t),Wi(e.v,t),t}function $y(e){var r=Jn(e),t=gd(e);return[r,t,"n"]}function Yy(e,r,t){return t==null&&(t=Pe(12)),$i(r,t),xd(e.v,t),t}function Xy(e){var r=Yi(e),t=gd(e);return[r,t,"n"]}function Ky(e,r,t){return t==null&&(t=Pe(8)),Xi(r,t),xd(e.v,t),t}function Jy(e){var r=Jn(e),t=of(e);return[r,t,"is"]}function Zy(e){var r=Jn(e),t=on(e);return[r,t,"str"]}function Qy(e,r,t){return t==null&&(t=Pe(12+4*e.v.length)),$i(r,t),Wr(e.v,t),t.length>t.l?t.slice(0,t.l):t}function e4(e){var r=Yi(e),t=on(e);return[r,t,"str"]}function t4(e,r,t){return t==null&&(t=Pe(8+4*e.v.length)),Xi(r,t),Wr(e.v,t),t.length>t.l?t.slice(0,t.l):t}function r4(e,r,t){var n=e.l+r,a=Jn(e);a.r=t["!row"];var s=e.read_shift(1),l=[a,s,"b"];if(t.cellFormula){e.l+=2;var c=y0(e,n-e.l,t);l[3]=Os(c,null,a,t.supbooks,t)}else e.l=n;return l}function n4(e,r,t){var n=e.l+r,a=Jn(e);a.r=t["!row"];var s=e.read_shift(1),l=[a,s,"e"];if(t.cellFormula){e.l+=2;var c=y0(e,n-e.l,t);l[3]=Os(c,null,a,t.supbooks,t)}else e.l=n;return l}function a4(e,r,t){var n=e.l+r,a=Jn(e);a.r=t["!row"];var s=Ms(e),l=[a,s,"n"];if(t.cellFormula){e.l+=2;var c=y0(e,n-e.l,t);l[3]=Os(c,null,a,t.supbooks,t)}else e.l=n;return l}function i4(e,r,t){var n=e.l+r,a=Jn(e);a.r=t["!row"];var s=on(e),l=[a,s,"str"];if(t.cellFormula){e.l+=2;var c=y0(e,n-e.l,t);l[3]=Os(c,null,a,t.supbooks,t)}else e.l=n;return l}var s4=Ki,o4=Rs;function l4(e,r){return r==null&&(r=Pe(4)),r.write_shift(4,e),r}function c4(e,r){var t=e.l+r,n=Ki(e),a=lf(e),s=on(e),l=on(e),c=on(e);e.l=t;var f={rfx:n,relId:a,loc:s,display:c};return l&&(f.Tooltip=l),f}function f4(e,r){var t=Pe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Rs({s:Hr(e[0]),e:Hr(e[0])},t),cf("rId"+r,t);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return Wr(a||"",t),Wr(e[1].Tooltip||"",t),Wr("",t),t.slice(0,t.l)}function h4(){}function u4(e,r,t){var n=e.l+r,a=vd(e),s=e.read_shift(1),l=[a];if(l[2]=s,t.cellFormula){var c=ey(e,n-e.l,t);l[1]=c}else e.l=n;return l}function d4(e,r,t){var n=e.l+r,a=Ki(e),s=[a];if(t.cellFormula){var l=ry(e,n-e.l,t);s[1]=l,e.l=n}else e.l=n;return s}function p4(e,r,t){t==null&&(t=Pe(18));var n=w0(e,r);t.write_shift(-4,e),t.write_shift(-4,e),t.write_shift(4,(n.width||10)*256),t.write_shift(4,0);var a=0;return r.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),r.level&&(a|=r.level<<8),t.write_shift(2,a),t}var t1=["left","right","top","bottom","header","footer"];function m4(e){var r={};return t1.forEach(function(t){r[t]=Ms(e)}),r}function g4(e,r){return r==null&&(r=Pe(6*8)),Qd(e),t1.forEach(function(t){Wi(e[t],r)}),r}function x4(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function v4(e,r,t){t==null&&(t=Pe(30));var n=924;return(((r||{}).Views||[])[0]||{}).RTL&&(n|=32),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function y4(e){var r=Pe(24);return r.write_shift(4,4),r.write_shift(4,1),Rs(e,r),r}function w4(e,r){return r==null&&(r=Pe(16*4+2)),r.write_shift(2,e.password?Dd(e.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?r.write_shift(4,e[t[0]]!=null&&!e[t[0]]?1:0):r.write_shift(4,e[t[0]]!=null&&e[t[0]]?0:1)}),r}function b4(){}function N4(){}function _4(e,r,t,n,a,s,l){if(r.v===void 0)return!1;var c="";switch(r.t){case"b":c=r.v?"1":"0";break;case"d":r=_n(r),r.z=r.z||gr[14],r.v=Nn(dn(r.v)),r.t="n";break;case"n":case"e":c=""+r.v;break;default:c=r.v;break}var f={r:t,c:n};switch(f.s=Ni(a.cellXfs,r,a),r.l&&s["!links"].push([Xt(f),r.l]),r.c&&s["!comments"].push([Xt(f),r.c]),r.t){case"s":case"str":return a.bookSST?(c=mf(a.Strings,r.v,a.revStrings),f.t="s",f.v=c,l?Ue(e,18,Wy(r,f)):Ue(e,7,Uy(r,f))):(f.t="str",l?Ue(e,17,t4(r,f)):Ue(e,6,Qy(r,f))),!0;case"n":return r.v==(r.v|0)&&r.v>-1e3&&r.v<1e3?l?Ue(e,13,Ky(r,f)):Ue(e,2,Yy(r,f)):l?Ue(e,16,Gy(r,f)):Ue(e,5,qy(r,f)),!0;case"b":return f.t="b",l?Ue(e,15,Oy(r,f)):Ue(e,4,Ly(r,f)),!0;case"e":return f.t="e",l?Ue(e,14,My(r,f)):Ue(e,3,Dy(r,f)),!0}return l?Ue(e,12,Fy(r,f)):Ue(e,1,Ty(r,f)),!0}function S4(e,r,t,n){var a=lr(r["!ref"]||"A1"),s,l="",c=[];Ue(e,145);var f=Array.isArray(r),u=a.e.r;r["!rows"]&&(u=Math.max(a.e.r,r["!rows"].length-1));for(var d=a.s.r;d<=u;++d){l=Xr(d),by(e,r,a,d);var g=!1;if(d<=a.e.r)for(var x=a.s.c;x<=a.e.c;++x){d===a.s.r&&(c[x]=sn(x)),s=c[x]+l;var p=f?(r[d]||[])[x]:r[s];if(!p){g=!1;continue}g=_4(e,p,d,x,n,r,g)}}Ue(e,146)}function A4(e,r){!r||!r["!merges"]||(Ue(e,177,l4(r["!merges"].length)),r["!merges"].forEach(function(t){Ue(e,176,o4(t))}),Ue(e,178))}function j4(e,r){!r||!r["!cols"]||(Ue(e,390),r["!cols"].forEach(function(t,n){t&&Ue(e,60,p4(n,t))}),Ue(e,391))}function k4(e,r){!r||!r["!ref"]||(Ue(e,648),Ue(e,649,y4(lr(r["!ref"]))),Ue(e,650))}function T4(e,r,t){r["!links"].forEach(function(n){if(n[1].Target){var a=$t(t,-1,n[1].Target.replace(/#.*$/,""),Bt.HLINK);Ue(e,494,f4(n,a))}}),delete r["!links"]}function E4(e,r,t,n){if(r["!comments"].length>0){var a=$t(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Bt.VML);Ue(e,551,cf("rId"+a)),r["!legacy"]=a}}function F4(e,r,t,n){if(r["!autofilter"]){var a=r["!autofilter"],s=typeof a.ref=="string"?a.ref:Er(a.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var l=t.Workbook.Names,c=Rn(s);c.s.r==c.e.r&&(c.e.r=Rn(r["!ref"]).e.r,s=Er(c));for(var f=0;f<l.length;++f){var u=l[f];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+t.SheetNames[n]+"'!"+s;break}}f==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+s}),Ue(e,161,Rs(lr(s))),Ue(e,162)}}function C4(e,r,t){Ue(e,133),Ue(e,137,v4(r,t)),Ue(e,138),Ue(e,134)}function L4(e,r){r["!protect"]&&Ue(e,535,w4(r["!protect"]))}function P4(e,r,t,n){var a=bn(),s=t.SheetNames[e],l=t.Sheets[s]||{},c=s;try{t&&t.Workbook&&(c=t.Workbook.Sheets[e].CodeName||c)}catch{}var f=lr(l["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(r.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],Ue(a,129),(t.vbaraw||l["!outline"])&&Ue(a,147,jy(c,l["!outline"])),Ue(a,148,_y(f)),C4(a,l,t.Workbook),j4(a,l),S4(a,l,e,r),L4(a,l),F4(a,l,t,e),A4(a,l),T4(a,l,n),l["!margins"]&&Ue(a,476,g4(l["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&k4(a,l),E4(a,l,e,n),Ue(a,130),a.end()}function O4(e,r){e.l+=10;var t=on(e);return{name:t}}var I4=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function D4(e){return!e.Workbook||!e.Workbook.WBProps?"false":dg(e.Workbook.WBProps.date1904)?"true":"false"}var R4="][*?/\\".split("");function r1(e,r){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return R4.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function M4(e,r,t){e.forEach(function(n,a){r1(n);for(var s=0;s<a;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(t){var l=r&&r[a]&&r[a].CodeName||n;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function B4(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var r=e.Workbook&&e.Workbook.Sheets||[];M4(e.SheetNames,r,!!e.vbaraw);for(var t=0;t<e.SheetNames.length;++t)oy(e.Sheets[e.SheetNames[t]],e.SheetNames[t],t)}function n1(e){var r=[Fr];r[r.length]=Xe("workbook",null,{xmlns:Is[0],"xmlns:r":Ur.r});var t=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(I4.forEach(function(c){e.Workbook.WBProps[c[0]]!=null&&e.Workbook.WBProps[c[0]]!=c[1]&&(n[c[0]]=e.Workbook.WBProps[c[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),r[r.length]=Xe("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(r[r.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==e.SheetNames.length&&(s=0),r[r.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var l={name:Yt(e.SheetNames[s].slice(0,31))};if(l.sheetId=""+(s+1),l["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}r[r.length]=Xe("sheet",null,l)}return r[r.length]="</sheets>",t&&(r[r.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(c){var f={name:c.Name};c.Comment&&(f.comment=c.Comment),c.Sheet!=null&&(f.localSheetId=""+c.Sheet),c.Hidden&&(f.hidden="1"),c.Ref&&(r[r.length]=Xe("definedName",Yt(c.Ref),f))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function U4(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=zc(e),t.name=on(e),t}function H4(e,r){return r||(r=Pe(127)),r.write_shift(4,e.Hidden),r.write_shift(4,e.iTabID),cf(e.strRelID,r),Wr(e.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function W4(e,r){var t={},n=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var a=r>8?on(e):"";return a.length>0&&(t.CodeName=a),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function z4(e,r){r||(r=Pe(72));var t=0;return e&&e.filterPrivacy&&(t|=8),r.write_shift(4,t),r.write_shift(4,0),md(e&&e.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}function q4(e,r,t){var n=e.l+r;e.l+=4,e.l+=1;var a=e.read_shift(4),s=Dg(e),l=ty(e,0,t),c=lf(e);e.l=n;var f={Name:s,Ptg:l};return a<268435455&&(f.Sheet=a),c&&(f.Comment=c),f}function V4(e,r){Ue(e,143);for(var t=0;t!=r.SheetNames.length;++t){var n=r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t]&&r.Workbook.Sheets[t].Hidden||0,a={Hidden:n,iTabID:t+1,strRelID:"rId"+(t+1),name:r.SheetNames[t]};Ue(e,156,H4(a))}Ue(e,144)}function G4(e,r){r||(r=Pe(127));for(var t=0;t!=4;++t)r.write_shift(4,0);return Wr("SheetJS",r),Wr(Xl.version,r),Wr(Xl.version,r),Wr("7262",r),r.length>r.l?r.slice(0,r.l):r}function $4(e,r){r||(r=Pe(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,e),r.write_shift(4,e);var t=120;return r.write_shift(1,t),r.length>r.l?r.slice(0,r.l):r}function Y4(e,r){if(!(!r.Workbook||!r.Workbook.Sheets)){for(var t=r.Workbook.Sheets,n=0,a=-1,s=-1;n<t.length;++n)!t[n]||!t[n].Hidden&&a==-1?a=n:t[n].Hidden==1&&s==-1&&(s=n);s>a||(Ue(e,135),Ue(e,158,$4(a)),Ue(e,136))}}function X4(e,r){var t=bn();return Ue(t,131),Ue(t,128,G4()),Ue(t,153,z4(e.Workbook&&e.Workbook.WBProps||null)),Y4(t,e),V4(t,e),Ue(t,132),t.end()}function K4(e,r,t){return(r.slice(-4)===".bin"?X4:n1)(e)}function J4(e,r,t,n,a){return(r.slice(-4)===".bin"?P4:e1)(e,t,n,a)}function Z4(e,r,t){return(r.slice(-4)===".bin"?g5:Bd)(e,t)}function Q4(e,r,t){return(r.slice(-4)===".bin"?zx:Id)(e,t)}function ew(e,r,t){return(r.slice(-4)===".bin"?L5:qd)(e)}function tw(e){return(e.slice(-4)===".bin"?S5:Wd)()}function rw(e,r){var t=[];return e.Props&&t.push(Zg(e.Props,r)),e.Custprops&&t.push(Qg(e.Props,e.Custprops)),t.join("")}function nw(){return""}function aw(e,r){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(n,a){var s=[];s.push(Xe("NumberFormat",null,{"ss:Format":Yt(gr[n.numFmtId])}));var l={"ss:ID":"s"+(21+a)};t.push(Xe("Style",s.join(""),l))}),Xe("Styles",t.join(""))}function a1(e){return Xe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+df(e.Ref,{r:0,c:0})})}function iw(e){if(!((e||{}).Workbook||{}).Names)return"";for(var r=e.Workbook.Names,t=[],n=0;n<r.length;++n){var a=r[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||t.push(a1(a)))}return Xe("Names",t.join(""))}function sw(e,r,t,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],l=0;l<a.length;++l){var c=a[l];c.Sheet==t&&(c.Name.match(/^_xlfn\./)||s.push(a1(c)))}return s.join("")}function ow(e,r,t,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Xe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Xe("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Xe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[t])if(n.Workbook.Sheets[t].Hidden)a.push(Xe("Visible",n.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<t&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==t&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(Yr("ProtectContents","True")),e["!protect"].objects&&a.push(Yr("ProtectObjects","True")),e["!protect"].scenarios&&a.push(Yr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(Yr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(Yr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&a.push("<"+l[1]+"/>")})),a.length==0?"":Xe("WorksheetOptions",a.join(""),{xmlns:On.x})}function lw(e){return e.map(function(r){var t=ug(r.t||""),n=Xe("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return Xe("Comment",n,{"ss:Author":r.a})}).join("")}function cw(e,r,t,n,a,s,l){if(!e||e.v==null&&e.f==null)return"";var c={};if(e.f&&(c["ss:Formula"]="="+Yt(df(e.f,l))),e.F&&e.F.slice(0,r.length)==r){var f=Hr(e.F.slice(r.length+1));c["ss:ArrayRange"]="RC:R"+(f.r==l.r?"":"["+(f.r-l.r)+"]")+"C"+(f.c==l.c?"":"["+(f.c-l.c)+"]")}if(e.l&&e.l.Target&&(c["ss:HRef"]=Yt(e.l.Target),e.l.Tooltip&&(c["x:HRefScreenTip"]=Yt(e.l.Tooltip))),t["!merges"])for(var u=t["!merges"],d=0;d!=u.length;++d)u[d].s.c!=l.c||u[d].s.r!=l.r||(u[d].e.c>u[d].s.c&&(c["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(c["ss:MergeDown"]=u[d].e.r-u[d].s.r));var g="",x="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":g="Number",x=String(e.v);break;case"b":g="Boolean",x=e.v?"1":"0";break;case"e":g="Error",x=zo[e.v];break;case"d":g="DateTime",x=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||gr[14]);break;case"s":g="String",x=hg(e.v||"");break}var p=Ni(n.cellXfs,e,n);c["ss:StyleID"]="s"+(21+p),c["ss:Index"]=l.c+1;var w=e.v!=null?x:"",v=e.t=="z"?"":'<Data ss:Type="'+g+'">'+w+"</Data>";return(e.c||[]).length>0&&(v+=lw(e.c)),Xe("Cell",v,c)}function fw(e,r){var t='<Row ss:Index="'+(e+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=Md(r.hpt)),r.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(t+=' ss:Hidden="1"')),t+">"}function hw(e,r,t,n){if(!e["!ref"])return"";var a=lr(e["!ref"]),s=e["!merges"]||[],l=0,c=[];e["!cols"]&&e["!cols"].forEach(function(_,S){hf(_);var b=!!_.width,A=w0(S,_),E={"ss:Index":S+1};b&&(E["ss:Width"]=i0(A.width)),_.hidden&&(E["ss:Hidden"]="1"),c.push(Xe("Column",null,E))});for(var f=Array.isArray(e),u=a.s.r;u<=a.e.r;++u){for(var d=[fw(u,(e["!rows"]||[])[u])],g=a.s.c;g<=a.e.c;++g){var x=!1;for(l=0;l!=s.length;++l)if(!(s[l].s.c>g)&&!(s[l].s.r>u)&&!(s[l].e.c<g)&&!(s[l].e.r<u)){(s[l].s.c!=g||s[l].s.r!=u)&&(x=!0);break}if(!x){var p={r:u,c:g},w=Xt(p),v=f?(e[u]||[])[g]:e[w];d.push(cw(v,w,e,r,t,n,p))}}d.push("</Row>"),d.length>2&&c.push(d.join(""))}return c.join("")}function uw(e,r,t){var n=[],a=t.SheetNames[e],s=t.Sheets[a],l=s?sw(s,r,e,t):"";return l.length>0&&n.push("<Names>"+l+"</Names>"),l=s?hw(s,r,e,t):"",l.length>0&&n.push("<Table>"+l+"</Table>"),n.push(ow(s,r,e,t)),n.join("")}function dw(e,r){r||(r={}),e.SSF||(e.SSF=_n(gr)),e.SSF&&(m0(),p0(e.SSF),r.revssf=g0(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF,r.cellXfs=[],Ni(r.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(rw(e,r)),t.push(nw()),t.push(""),t.push("");for(var n=0;n<e.SheetNames.length;++n)t.push(Xe("Worksheet",uw(n,r,e),{"ss:Name":Yt(e.SheetNames[n])}));return t[2]=aw(e,r),t[3]=iw(e),Fr+Xe("Workbook",t.join(""),{xmlns:On.ss,"xmlns:o":On.o,"xmlns:x":On.x,"xmlns:ss":On.ss,"xmlns:dt":On.dt,"xmlns:html":On.html})}var _c={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function pw(e,r){var t=[],n=[],a=[],s=0,l,c=Ch(qh,"n"),f=Ch(Vh,"n");if(e.Props)for(l=Kr(e.Props),s=0;s<l.length;++s)(Object.prototype.hasOwnProperty.call(c,l[s])?t:Object.prototype.hasOwnProperty.call(f,l[s])?n:a).push([l[s],e.Props[l[s]]]);if(e.Custprops)for(l=Kr(e.Custprops),s=0;s<l.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},l[s])||(Object.prototype.hasOwnProperty.call(c,l[s])?t:Object.prototype.hasOwnProperty.call(f,l[s])?n:a).push([l[s],e.Custprops[l[s]]]);var u=[];for(s=0;s<a.length;++s)Td.indexOf(a[s][0])>-1||Ad.indexOf(a[s][0])>-1||a[s][1]!=null&&u.push(a[s]);n.length&&Zt.utils.cfb_add(r,"/SummaryInformation",Kh(n,_c.SI,f,Vh)),(t.length||u.length)&&Zt.utils.cfb_add(r,"/DocumentSummaryInformation",Kh(t,_c.DSI,c,qh,u.length?u:null,_c.UDI))}function mw(e,r){var t=r||{},n=Zt.utils.cfb_new({root:"R"}),a="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":a="/Workbook",t.biff=8;break;case"biff5":a="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Zt.utils.cfb_add(n,a,i1(e,t)),t.biff==8&&(e.Props||e.Custprops)&&pw(e,n),t.biff==8&&e.vbaraw&&P5(n,Zt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var gw={0:{f:yy},1:{f:ky},2:{f:$y},3:{f:Iy},4:{f:Cy},5:{f:zy},6:{f:Zy},7:{f:By},8:{f:i4},9:{f:a4},10:{f:r4},11:{f:n4},12:{f:Ey},13:{f:Xy},14:{f:Ry},15:{f:Py},16:{f:Vy},17:{f:e4},18:{f:Hy},19:{f:of},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:q4},40:{},42:{},43:{f:Zx},44:{f:Kx},45:{f:t5},46:{f:n5},47:{f:r5},48:{},49:{f:Eg},50:{},51:{f:y5},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Fx},62:{f:Jy},63:{f:A5},64:{f:b4},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ta,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:x4},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Ay},148:{f:Ny,p:16},151:{f:h4},152:{},153:{f:W4},154:{},155:{},156:{f:U4},157:{},158:{},159:{T:1,f:Ux},160:{T:-1},161:{T:1,f:Ki},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:s4},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:x5},336:{T:-1},337:{f:N5,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:zc},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Sx},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:u4},427:{f:d4},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:m4},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Sy},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:c4},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:zc},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:F5},633:{T:1},634:{T:-1},635:{T:1,f:T5},636:{T:-1},637:{f:Pg},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:O4},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:N4},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Ke(e,r,t,n){var a=r;if(!isNaN(a)){var s=n||(t||[]).length||0,l=e.next(4);l.write_shift(2,a),l.write_shift(2,s),s>0&&nf(t)&&e.push(t)}}function xw(e,r,t,n){var a=(t||[]).length||0;if(a<=8224)return Ke(e,r,t,a);var s=r;if(!isNaN(s)){for(var l=t.parts||[],c=0,f=0,u=0;u+(l[c]||8224)<=8224;)u+=l[c]||8224,c++;var d=e.next(4);for(d.write_shift(2,s),d.write_shift(2,u),e.push(t.slice(f,f+u)),f+=u;f<a;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(l[c]||8224)<=8224;)u+=l[c]||8224,c++;d.write_shift(2,u),e.push(t.slice(f,f+u)),f+=u}}}function Vo(e,r,t){return e||(e=Pe(7)),e.write_shift(2,r),e.write_shift(2,t),e.write_shift(2,0),e.write_shift(1,0),e}function vw(e,r,t,n){var a=Pe(9);return Vo(a,e,r),Fd(t,n||"b",a),a}function yw(e,r,t){var n=Pe(8+2*t.length);return Vo(n,e,r),n.write_shift(1,t.length),n.write_shift(t.length,t,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function ww(e,r,t,n){if(r.v!=null)switch(r.t){case"d":case"n":var a=r.t=="d"?Nn(dn(r.v)):r.v;a==(a|0)&&a>=0&&a<65536?Ke(e,2,Ox(t,n,a)):Ke(e,3,Px(t,n,a));return;case"b":case"e":Ke(e,5,vw(t,n,r.v,r.t));return;case"s":case"str":Ke(e,4,yw(t,n,(r.v||"").slice(0,255)));return}Ke(e,1,Vo(null,t,n))}function bw(e,r,t,n){var a=Array.isArray(r),s=lr(r["!ref"]||"A1"),l,c="",f=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),l=Er(s)}for(var u=s.s.r;u<=s.e.r;++u){c=Xr(u);for(var d=s.s.c;d<=s.e.c;++d){u===s.s.r&&(f[d]=sn(d)),l=f[d]+c;var g=a?(r[u]||[])[d]:r[l];g&&ww(e,g,u,d)}}}function Nw(e,r){for(var t=r||{},n=bn(),a=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==t.sheet&&(a=s);if(a==0&&t.sheet&&e.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return Ke(n,t.biff==4?1033:t.biff==3?521:9,ff(e,16,t)),bw(n,e.Sheets[e.SheetNames[a]],a,t),Ke(n,10),n.end()}function _w(e,r,t){Ke(e,49,gx({sz:12,name:"Arial"},t))}function Sw(e,r,t){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)r[a]!=null&&Ke(e,1054,yx(a,r[a],t))})}function Aw(e,r){var t=Pe(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),Ke(e,2151,t),t=Pe(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),Pd(lr(r["!ref"]||"A1"),t),t.write_shift(4,4),Ke(e,2152,t)}function jw(e,r){for(var t=0;t<16;++t)Ke(e,224,Zh({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(n){Ke(e,224,Zh(n,0,r))})}function kw(e,r){for(var t=0;t<r["!links"].length;++t){var n=r["!links"][t];Ke(e,440,kx(n)),n[1].Tooltip&&Ke(e,2048,Tx(n))}delete r["!links"]}function Tw(e,r){if(r){var t=0;r.forEach(function(n,a){++t<=256&&n&&Ke(e,125,Cx(w0(a,n),a))})}}function Ew(e,r,t,n,a){var s=16+Ni(a.cellXfs,r,a);if(r.v==null&&!r.bf){Ke(e,513,zi(t,n,s));return}if(r.bf)Ke(e,6,Qv(r,t,n,a,s));else switch(r.t){case"d":case"n":var l=r.t=="d"?Nn(dn(r.v)):r.v;Ke(e,515,_x(t,n,l,s));break;case"b":case"e":Ke(e,517,Nx(t,n,r.v,s,a,r.t));break;case"s":case"str":if(a.bookSST){var c=mf(a.Strings,r.v,a.revStrings);Ke(e,253,xx(t,n,c,s))}else Ke(e,516,vx(t,n,(r.v||"").slice(0,255),s,a));break;default:Ke(e,513,zi(t,n,s))}}function Fw(e,r,t){var n=bn(),a=t.SheetNames[e],s=t.Sheets[a]||{},l=(t||{}).Workbook||{},c=(l.Sheets||[])[e]||{},f=Array.isArray(s),u=r.biff==8,d,g="",x=[],p=lr(s["!ref"]||"A1"),w=u?65536:16384;if(p.e.c>255||p.e.r>=w){if(r.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,w-1)}Ke(n,2057,ff(t,16,r)),Ke(n,13,Kn(1)),Ke(n,12,Kn(100)),Ke(n,15,un(!0)),Ke(n,17,un(!1)),Ke(n,16,Wi(.001)),Ke(n,95,un(!0)),Ke(n,42,un(!1)),Ke(n,43,un(!1)),Ke(n,130,Kn(1)),Ke(n,128,bx()),Ke(n,131,un(!1)),Ke(n,132,un(!1)),u&&Tw(n,s["!cols"]),Ke(n,512,wx(p,r)),u&&(s["!links"]=[]);for(var v=p.s.r;v<=p.e.r;++v){g=Xr(v);for(var _=p.s.c;_<=p.e.c;++_){v===p.s.r&&(x[_]=sn(_)),d=x[_]+g;var S=f?(s[v]||[])[_]:s[d];S&&(Ew(n,S,v,_,r),u&&S.l&&s["!links"].push([d,S.l]))}}var b=c.CodeName||c.name||a;return u&&Ke(n,574,mx((l.Views||[])[0])),u&&(s["!merges"]||[]).length&&Ke(n,229,jx(s["!merges"])),u&&kw(n,s),Ke(n,442,Ld(b)),u&&Aw(n,s),Ke(n,10),n.end()}function Cw(e,r,t){var n=bn(),a=(e||{}).Workbook||{},s=a.Sheets||[],l=a.WBProps||{},c=t.biff==8,f=t.biff==5;if(Ke(n,2057,ff(e,5,t)),t.bookType=="xla"&&Ke(n,135),Ke(n,225,c?Kn(1200):null),Ke(n,193,rx(2)),f&&Ke(n,191),f&&Ke(n,192),Ke(n,226),Ke(n,92,hx("SheetJS",t)),Ke(n,66,Kn(c?1200:1252)),c&&Ke(n,353,Kn(0)),c&&Ke(n,448),Ke(n,317,Lx(e.SheetNames.length)),c&&e.vbaraw&&Ke(n,211),c&&e.vbaraw){var u=l.CodeName||"ThisWorkbook";Ke(n,442,Ld(u))}Ke(n,156,Kn(17)),Ke(n,25,un(!1)),Ke(n,18,un(!1)),Ke(n,19,Kn(0)),c&&Ke(n,431,un(!1)),c&&Ke(n,444,Kn(0)),Ke(n,61,px()),Ke(n,64,un(!1)),Ke(n,141,Kn(0)),Ke(n,34,un(D4(e)=="true")),Ke(n,14,un(!0)),c&&Ke(n,439,un(!1)),Ke(n,218,Kn(0)),_w(n,e,t),Sw(n,e.SSF,t),jw(n,t),c&&Ke(n,352,un(!1));var d=n.end(),g=bn();c&&Ke(g,140,Ex()),c&&t.Strings&&xw(g,252,dx(t.Strings)),Ke(g,10);var x=g.end(),p=bn(),w=0,v=0;for(v=0;v<e.SheetNames.length;++v)w+=(c?12:11)+(c?2:1)*e.SheetNames[v].length;var _=d.length+w+x.length;for(v=0;v<e.SheetNames.length;++v){var S=s[v]||{};Ke(p,133,ux({pos:_,hs:S.Hidden||0,dt:0,name:e.SheetNames[v]},t)),_+=r[v].length}var b=p.end();if(w!=b.length)throw new Error("BS8 "+w+" != "+b.length);var A=[];return d.length&&A.push(d),b.length&&A.push(b),x.length&&A.push(x),$r(A)}function Lw(e,r){var t=r||{},n=[];e&&!e.SSF&&(e.SSF=_n(gr)),e&&e.SSF&&(m0(),p0(e.SSF),t.revssf=g0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,gf(t),t.cellXfs=[],Ni(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=Fw(a,t,e);return n.unshift(Cw(e,n,t)),$r(n)}function i1(e,r){for(var t=0;t<=e.SheetNames.length;++t){var n=e.Sheets[e.SheetNames[t]];if(!(!n||!n["!ref"])){var a=Rn(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var s=r||{};switch(s.biff||2){case 8:case 5:return Lw(e,r);case 4:case 3:case 2:return Nw(e,r)}throw new Error("invalid type "+s.bookType+" for BIFF")}function Pw(e,r,t,n){for(var a=e["!merges"]||[],s=[],l=r.s.c;l<=r.e.c;++l){for(var c=0,f=0,u=0;u<a.length;++u)if(!(a[u].s.r>t||a[u].s.c>l)&&!(a[u].e.r<t||a[u].e.c<l)){if(a[u].s.r<t||a[u].s.c<l){c=-1;break}c=a[u].e.r-a[u].s.r+1,f=a[u].e.c-a[u].s.c+1;break}if(!(c<0)){var d=Xt({r:t,c:l}),g=n.dense?(e[t]||[])[l]:e[d],x=g&&g.v!=null&&(g.h||fg(g.w||(Ga(g),g.w)||""))||"",p={};c>1&&(p.rowspan=c),f>1&&(p.colspan=f),n.editable?x='<span contenteditable="true">'+x+"</span>":g&&(p["data-t"]=g&&g.t||"z",g.v!=null&&(p["data-v"]=g.v),g.z!=null&&(p["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+g.l.Target+'">'+x+"</a>")),p.id=(n.id||"sjs")+"-"+d,s.push(Xe("td",x,p))}}var w="<tr>";return w+s.join("")+"</tr>"}var Ow='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Iw="</body></html>";function Dw(e,r,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function s1(e,r){var t=r||{},n=t.header!=null?t.header:Ow,a=t.footer!=null?t.footer:Iw,s=[n],l=Rn(e["!ref"]);t.dense=Array.isArray(e),s.push(Dw(e,l,t));for(var c=l.s.r;c<=l.e.r;++c)s.push(Pw(e,l,c,t));return s.push("</table>"+a),s.join("")}function o1(e,r,t){var n=t||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Hr(n.origin):n.origin;a=l.r,s=l.c}var c=r.getElementsByTagName("tr"),f=Math.min(n.sheetRows||1e7,c.length),u={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var d=Rn(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),a==-1&&(u.e.r=a=d.e.r+1)}var g=[],x=0,p=e["!rows"]||(e["!rows"]=[]),w=0,v=0,_=0,S=0,b=0,A=0;for(e["!cols"]||(e["!cols"]=[]);w<c.length&&v<f;++w){var E=c[w];if(iu(E)){if(n.display)continue;p[v]={hidden:!0}}var U=E.children;for(_=S=0;_<U.length;++_){var R=U[_];if(!(n.display&&iu(R))){var L=R.hasAttribute("data-v")?R.getAttribute("data-v"):R.hasAttribute("v")?R.getAttribute("v"):pg(R.innerHTML),C=R.getAttribute("data-z")||R.getAttribute("z");for(x=0;x<g.length;++x){var P=g[x];P.s.c==S+s&&P.s.r<v+a&&v+a<=P.e.r&&(S=P.e.c+1-s,x=-1)}A=+R.getAttribute("colspan")||1,((b=+R.getAttribute("rowspan")||1)>1||A>1)&&g.push({s:{r:v+a,c:S+s},e:{r:v+a+(b||1)-1,c:S+s+(A||1)-1}});var W={t:"s",v:L},k=R.getAttribute("data-t")||R.getAttribute("t")||"";L!=null&&(L.length==0?W.t=k||"z":n.raw||L.trim().length==0||k=="s"||(L==="TRUE"?W={t:"b",v:!0}:L==="FALSE"?W={t:"b",v:!1}:isNaN(za(L))?isNaN(Oo(L).getDate())||(W={t:"d",v:dn(L)},n.cellDates||(W={t:"n",v:Nn(W.v)}),W.z=n.dateNF||gr[14]):W={t:"n",v:za(L)})),W.z===void 0&&C!=null&&(W.z=C);var T="",H=R.getElementsByTagName("A");if(H&&H.length)for(var G=0;G<H.length&&!(H[G].hasAttribute("href")&&(T=H[G].getAttribute("href"),T.charAt(0)!="#"));++G);T&&T.charAt(0)!="#"&&(W.l={Target:T}),n.dense?(e[v+a]||(e[v+a]=[]),e[v+a][S+s]=W):e[Xt({c:S+s,r:v+a})]=W,u.e.c<S+s&&(u.e.c=S+s),S+=A}}++v}return g.length&&(e["!merges"]=(e["!merges"]||[]).concat(g)),u.e.r=Math.max(u.e.r,v-1+a),e["!ref"]=Er(u),v>=f&&(e["!fullref"]=Er((u.e.r=c.length-w+v-1+a,u))),e}function l1(e,r){var t=r||{},n=t.dense?[]:{};return o1(n,e,r)}function Rw(e,r){return Gi(l1(e,r),r)}function iu(e){var r="",t=Mw(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function Mw(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var Bw=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+Do({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Fr+r}}(),su=function(){var e=function(s){return Yt(s).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,n=function(s,l,c){var f=[];f.push('      <table:table table:name="'+Yt(l.SheetNames[c])+`" table:style-name="ta1">
`);var u=0,d=0,g=Rn(s["!ref"]||"A1"),x=s["!merges"]||[],p=0,w=Array.isArray(s);if(s["!cols"])for(d=0;d<=g.e.c;++d)f.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var v="",_=s["!rows"]||[];for(u=0;u<g.s.r;++u)v=_[u]?' table:style-name="ro'+_[u].ods+'"':"",f.push("        <table:table-row"+v+`></table:table-row>
`);for(;u<=g.e.r;++u){for(v=_[u]?' table:style-name="ro'+_[u].ods+'"':"",f.push("        <table:table-row"+v+`>
`),d=0;d<g.s.c;++d)f.push(r);for(;d<=g.e.c;++d){var S=!1,b={},A="";for(p=0;p!=x.length;++p)if(!(x[p].s.c>d)&&!(x[p].s.r>u)&&!(x[p].e.c<d)&&!(x[p].e.r<u)){(x[p].s.c!=d||x[p].s.r!=u)&&(S=!0),b["table:number-columns-spanned"]=x[p].e.c-x[p].s.c+1,b["table:number-rows-spanned"]=x[p].e.r-x[p].s.r+1;break}if(S){f.push(t);continue}var E=Xt({r:u,c:d}),U=w?(s[u]||[])[d]:s[E];if(U&&U.f&&(b["table:formula"]=Yt(iy(U.f)),U.F&&U.F.slice(0,E.length)==E)){var R=Rn(U.F);b["table:number-matrix-columns-spanned"]=R.e.c-R.s.c+1,b["table:number-matrix-rows-spanned"]=R.e.r-R.s.r+1}if(!U){f.push(r);continue}switch(U.t){case"b":A=U.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=U.v?"true":"false";break;case"n":A=U.w||String(U.v||0),b["office:value-type"]="float",b["office:value"]=U.v||0;break;case"s":case"str":A=U.v==null?"":U.v,b["office:value-type"]="string";break;case"d":A=U.w||dn(U.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=dn(U.v).toISOString(),b["table:style-name"]="ce1";break;default:f.push(r);continue}var L=e(A);if(U.l&&U.l.Target){var C=U.l.Target;C=C.charAt(0)=="#"?"#"+sy(C.slice(1)):C,C.charAt(0)!="#"&&!C.match(/^\w+:/)&&(C="../"+C),L=Xe("text:a",L,{"xlink:href":C.replace(/&/g,"&amp;")})}f.push("          "+Xe("table:table-cell",Xe("text:p",L,{}),b)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},a=function(s,l){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var c=0;l.SheetNames.map(function(u){return l.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var g=u["!cols"][d];if(g.width==null&&g.wpx==null&&g.wch==null)continue;hf(g),g.ods=c;var x=u["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),s.push(`  </style:style>
`),++c}}});var f=0;l.SheetNames.map(function(u){return l.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=f;var g=u["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+g+`"/>
`),s.push(`  </style:style>
`),++f}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(l,c){var f=[Fr],u=Do({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=Do({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(f.push("<office:document"+u+d+`>
`),f.push(_d().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+u+`>
`),a(f,l),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var g=0;g!=l.SheetNames.length;++g)f.push(n(l.Sheets[l.SheetNames[g]],l,g));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),c.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}}();function c1(e,r){if(r.bookType=="fods")return su(e,r);var t=Qc(),n="",a=[],s=[];return n="mimetype",Tt(t,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Tt(t,n,su(e,r)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Tt(t,n,Bw(e,r)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Tt(t,n,Fr+_d()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Tt(t,n,Jg(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Tt(t,n,Xg(a)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function l0(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Uw(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):ha(Io(e))}function Hw(e,r){e:for(var t=0;t<=e.length-r.length;++t){for(var n=0;n<r.length;++n)if(e[t+n]!=r[n])continue e;return!0}return!1}function bi(e){var r=e.reduce(function(a,s){return a+s.length},0),t=new Uint8Array(r),n=0;return e.forEach(function(a){t.set(a,n),n+=a.length}),t}function Ww(e,r,t){var n=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,a=t/Math.pow(10,n-6176);e[r+15]|=n>>7,e[r+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)e[r+s]=a&255;e[r+15]|=t>=0?0:128}function Ro(e,r){var t=r?r[0]:0,n=e[t]&127;e:if(e[t++]>=128&&(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),n}function Gt(e){var r=new Uint8Array(7);r[0]=e&127;var t=1;e:if(e>127){if(r[t-1]|=128,r[t]=e>>7&127,++t,e<=16383||(r[t-1]|=128,r[t]=e>>14&127,++t,e<=2097151)||(r[t-1]|=128,r[t]=e>>21&127,++t,e<=268435455)||(r[t-1]|=128,r[t]=e/256>>>21&127,++t,e<=34359738367)||(r[t-1]|=128,r[t]=e/65536>>>21&127,++t,e<=4398046511103))break e;r[t-1]|=128,r[t]=e/16777216>>>21&127,++t}return r.slice(0,t)}function Ps(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function Ir(e){for(var r=[],t=[0];t[0]<e.length;){var n=t[0],a=Ro(e,t),s=a&7;a=Math.floor(a/8);var l=0,c;if(a==0)break;switch(s){case 0:{for(var f=t[0];e[t[0]++]>=128;);c=e.slice(f,t[0])}break;case 5:l=4,c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 1:l=8,c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 2:l=Ro(e,t),c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var u={data:c,type:s};r[a]==null?r[a]=[u]:r[a].push(u)}return r}function Vr(e){var r=[];return e.forEach(function(t,n){t.forEach(function(a){a.data&&(r.push(Gt(n*8+a.type)),a.type==2&&r.push(Gt(a.data.length)),r.push(a.data))})}),bi(r)}function la(e){for(var r,t=[],n=[0];n[0]<e.length;){var a=Ro(e,n),s=Ir(e.slice(n[0],n[0]+a));n[0]+=a;var l={id:Ps(s[1][0].data),messages:[]};s[2].forEach(function(c){var f=Ir(c.data),u=Ps(f[3][0].data);l.messages.push({meta:f,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(r=s[3])!=null&&r[0]&&(l.merge=Ps(s[3][0].data)>>>0>0),t.push(l)}return t}function Ns(e){var r=[];return e.forEach(function(t){var n=[];n[1]=[{data:Gt(t.id),type:0}],n[2]=[],t.merge!=null&&(n[3]=[{data:Gt(+!!t.merge),type:0}]);var a=[];t.messages.forEach(function(l){a.push(l.data),l.meta[3]=[{type:0,data:Gt(l.data.length)}],n[2].push({data:Vr(l.meta),type:2})});var s=Vr(n);r.push(Gt(s.length)),r.push(s),a.forEach(function(l){return r.push(l)})}),bi(r)}function zw(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],n=Ro(r,t),a=[];t[0]<r.length;){var s=r[t[0]]&3;if(s==0){var l=r[t[0]++]>>2;if(l<60)++l;else{var c=l-59;l=r[t[0]],c>1&&(l|=r[t[0]+1]<<8),c>2&&(l|=r[t[0]+2]<<16),c>3&&(l|=r[t[0]+3]<<24),l>>>=0,l++,t[0]+=c}a.push(r.slice(t[0],t[0]+l)),t[0]+=l;continue}else{var f=0,u=0;if(s==1?(u=(r[t[0]]>>2&7)+4,f=(r[t[0]++]&224)<<3,f|=r[t[0]++]):(u=(r[t[0]++]>>2)+1,s==2?(f=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(f=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),a=[bi(a)],f==0)throw new Error("Invalid offset 0");if(f>a[0].length)throw new Error("Invalid offset beyond length");if(u>=f)for(a.push(a[0].slice(-f)),u-=f;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-f,-f+u))}}var d=bi(a);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function ca(e){for(var r=[],t=0;t<e.length;){var n=e[t++],a=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(zw(n,e.slice(t,t+a))),t+=a}if(t!==e.length)throw new Error("data is not a valid framed stream!");return bi(r)}function _s(e){for(var r=[],t=0;t<e.length;){var n=Math.min(e.length-t,268435455),a=new Uint8Array(4);r.push(a);var s=Gt(n),l=s.length;r.push(s),n<=60?(l++,r.push(new Uint8Array([n-1<<2]))):n<=256?(l+=2,r.push(new Uint8Array([240,n-1&255]))):n<=65536?(l+=3,r.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(l+=4,r.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(l+=5,r.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),r.push(e.slice(t,t+n)),l+=n,a[0]=0,a[1]=l&255,a[2]=l>>8&255,a[3]=l>>16&255,t+=n}return bi(r)}function Sc(e,r){var t=new Uint8Array(32),n=l0(t),a=12,s=0;switch(t[0]=5,e.t){case"n":t[1]=2,Ww(t,a,e.v),s|=1,a+=16;break;case"b":t[1]=6,n.setFloat64(a,e.v?1:0,!0),s|=2,a+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[1]=3,n.setUint32(a,r.indexOf(e.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),t.slice(0,a)}function Ac(e,r){var t=new Uint8Array(32),n=l0(t),a=12,s=0;switch(t[0]=3,e.t){case"n":t[2]=2,n.setFloat64(a,e.v,!0),s|=32,a+=8;break;case"b":t[2]=6,n.setFloat64(a,e.v?1:0,!0),s|=32,a+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[2]=3,n.setUint32(a,r.indexOf(e.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),t.slice(0,a)}function hi(e){var r=Ir(e);return Ro(r[1][0].data)}function qw(e,r,t){var n,a,s,l;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var c=((l=(s=e[8])==null?void 0:s[0])==null?void 0:l.data)&&Ps(e[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var f=0,u=l0(e[7][0].data),d=0,g=[],x=l0(e[4][0].data),p=0,w=[],v=0;v<r.length;++v){if(r[v]==null){u.setUint16(v*2,65535,!0),x.setUint16(v*2,65535);continue}u.setUint16(v*2,d,!0),x.setUint16(v*2,p,!0);var _,S;switch(typeof r[v]){case"string":_=Sc({t:"s",v:r[v]},t),S=Ac({t:"s",v:r[v]},t);break;case"number":_=Sc({t:"n",v:r[v]},t),S=Ac({t:"n",v:r[v]},t);break;case"boolean":_=Sc({t:"b",v:r[v]},t),S=Ac({t:"b",v:r[v]},t);break;default:throw new Error("Unsupported value "+r[v])}g.push(_),d+=_.length,w.push(S),p+=S.length,++f}for(e[2][0].data=Gt(f);v<e[7][0].data.length/2;++v)u.setUint16(v*2,65535,!0),x.setUint16(v*2,65535,!0);return e[6][0].data=bi(g),e[3][0].data=bi(w),f}function Vw(e,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Rn(t["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Er(n)));var s=c0(t,{range:n,header:1}),l=["~Sh33tJ5~"];s.forEach(function(O){return O.forEach(function(I){typeof I=="string"&&l.push(I)})});var c={},f=[],u=Zt.read(r.numbers,{type:"base64"});u.FileIndex.map(function(O,I){return[O,u.FullPaths[I]]}).forEach(function(O){var I=O[0],D=O[1];if(I.type==2&&I.name.match(/\.iwa/)){var X=I.content,fe=ca(X),he=la(fe);he.forEach(function(ue){f.push(ue.id),c[ue.id]={deps:[],location:D,type:Ps(ue.messages[0].meta[1][0].data)}})}}),f.sort(function(O,I){return O-I});var d=f.filter(function(O){return O>1}).map(function(O){return[O,Gt(O)]});u.FileIndex.map(function(O,I){return[O,u.FullPaths[I]]}).forEach(function(O){var I=O[0];if(O[1],!!I.name.match(/\.iwa/)){var D=la(ca(I.content));D.forEach(function(X){X.messages.forEach(function(fe){d.forEach(function(he){X.messages.some(function(ue){return Ps(ue.meta[1][0].data)!=11006&&Hw(ue.data,he[1])})&&c[he[0]].deps.push(X.id)})})})}});for(var g=Zt.find(u,c[1].location),x=la(ca(g.content)),p,w=0;w<x.length;++w){var v=x[w];v.id==1&&(p=v)}var _=hi(Ir(p.messages[0].data)[1][0].data);for(g=Zt.find(u,c[_].location),x=la(ca(g.content)),w=0;w<x.length;++w)v=x[w],v.id==_&&(p=v);for(_=hi(Ir(p.messages[0].data)[2][0].data),g=Zt.find(u,c[_].location),x=la(ca(g.content)),w=0;w<x.length;++w)v=x[w],v.id==_&&(p=v);for(_=hi(Ir(p.messages[0].data)[2][0].data),g=Zt.find(u,c[_].location),x=la(ca(g.content)),w=0;w<x.length;++w)v=x[w],v.id==_&&(p=v);var S=Ir(p.messages[0].data);{S[6][0].data=Gt(n.e.r+1),S[7][0].data=Gt(n.e.c+1);var b=hi(S[46][0].data),A=Zt.find(u,c[b].location),E=la(ca(A.content));{for(var U=0;U<E.length&&E[U].id!=b;++U);if(E[U].id!=b)throw"Bad ColumnRowUIDMapArchive";var R=Ir(E[U].messages[0].data);R[1]=[],R[2]=[],R[3]=[];for(var L=0;L<=n.e.c;++L){var C=[];C[1]=C[2]=[{type:0,data:Gt(L+420690)}],R[1].push({type:2,data:Vr(C)}),R[2].push({type:0,data:Gt(L)}),R[3].push({type:0,data:Gt(L)})}R[4]=[],R[5]=[],R[6]=[];for(var P=0;P<=n.e.r;++P)C=[],C[1]=C[2]=[{type:0,data:Gt(P+726270)}],R[4].push({type:2,data:Vr(C)}),R[5].push({type:0,data:Gt(P)}),R[6].push({type:0,data:Gt(P)});E[U].messages[0].data=Vr(R)}A.content=_s(Ns(E)),A.size=A.content.length,delete S[46];var W=Ir(S[4][0].data);{W[7][0].data=Gt(n.e.r+1);var k=Ir(W[1][0].data),T=hi(k[2][0].data);A=Zt.find(u,c[T].location),E=la(ca(A.content));{if(E[0].id!=T)throw"Bad HeaderStorageBucket";var H=Ir(E[0].messages[0].data);for(P=0;P<s.length;++P){var G=Ir(H[2][0].data);G[1][0].data=Gt(P),G[4][0].data=Gt(s[P].length),H[2][P]={type:H[2][0].type,data:Vr(G)}}E[0].messages[0].data=Vr(H)}A.content=_s(Ns(E)),A.size=A.content.length;var ce=hi(W[2][0].data);A=Zt.find(u,c[ce].location),E=la(ca(A.content));{if(E[0].id!=ce)throw"Bad HeaderStorageBucket";for(H=Ir(E[0].messages[0].data),L=0;L<=n.e.c;++L)G=Ir(H[2][0].data),G[1][0].data=Gt(L),G[4][0].data=Gt(n.e.r+1),H[2][L]={type:H[2][0].type,data:Vr(G)};E[0].messages[0].data=Vr(H)}A.content=_s(Ns(E)),A.size=A.content.length;var J=hi(W[4][0].data);(function(){for(var O=Zt.find(u,c[J].location),I=la(ca(O.content)),D,X=0;X<I.length;++X){var fe=I[X];fe.id==J&&(D=fe)}var he=Ir(D.messages[0].data);{he[3]=[];var ue=[];l.forEach(function(Me,Ve){ue[1]=[{type:0,data:Gt(Ve)}],ue[2]=[{type:0,data:Gt(1)}],ue[3]=[{type:2,data:Uw(Me)}],he[3].push({type:2,data:Vr(ue)})})}D.messages[0].data=Vr(he);var be=Ns(I),Oe=_s(be);O.content=Oe,O.size=O.content.length})();var Q=Ir(W[3][0].data);{var oe=Q[1][0];delete Q[2];var ae=Ir(oe.data);{var ge=hi(ae[2][0].data);(function(){for(var O=Zt.find(u,c[ge].location),I=la(ca(O.content)),D,X=0;X<I.length;++X){var fe=I[X];fe.id==ge&&(D=fe)}var he=Ir(D.messages[0].data);{delete he[6],delete Q[7];var ue=new Uint8Array(he[5][0].data);he[5]=[];for(var be=0,Oe=0;Oe<=n.e.r;++Oe){var Me=Ir(ue);be+=qw(Me,s[Oe],l),Me[1][0].data=Gt(Oe),he[5].push({data:Vr(Me),type:2})}he[1]=[{type:0,data:Gt(n.e.c+1)}],he[2]=[{type:0,data:Gt(n.e.r+1)}],he[3]=[{type:0,data:Gt(be)}],he[4]=[{type:0,data:Gt(n.e.r+1)}]}D.messages[0].data=Vr(he);var Ve=Ns(I),Je=_s(Ve);O.content=Je,O.size=O.content.length})()}oe.data=Vr(ae)}W[3][0].data=Vr(Q)}S[4][0].data=Vr(W)}p.messages[0].data=Vr(S);var ve=Ns(x),j=_s(ve);return g.content=j,g.size=g.content.length,u}function Gw(e){return function(t){for(var n=0;n!=e.length;++n){var a=e[n];t[a[0]]===void 0&&(t[a[0]]=a[1]),a[2]==="n"&&(t[a[0]]=Number(t[a[0]]))}}}function gf(e){Gw([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function $w(e,r){return r.bookType=="ods"?c1(e,r):r.bookType=="numbers"?Vw(e,r):r.bookType=="xlsb"?Yw(e,r):Xw(e,r)}function Yw(e,r){Es=1024,e&&!e.SSF&&(e.SSF=_n(gr)),e&&e.SSF&&(m0(),p0(e.SSF),r.revssf=g0(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Eo?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t=r.bookType=="xlsb"?"bin":"xml",n=Vd.indexOf(r.bookType)>-1,a=wd();gf(r=r||{});var s=Qc(),l="",c=0;if(r.cellXfs=[],Ni(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",Tt(s,l,Sd(e.Props,r)),a.coreprops.push(l),$t(r.rels,2,l,Bt.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var f=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&f.push(e.SheetNames[u]);e.Props.SheetNames=f}for(e.Props.Worksheets=e.Props.SheetNames.length,Tt(s,l,jd(e.Props)),a.extprops.push(l),$t(r.rels,3,l,Bt.EXT_PROPS),e.Custprops!==e.Props&&Kr(e.Custprops||{}).length>0&&(l="docProps/custom.xml",Tt(s,l,kd(e.Custprops)),a.custprops.push(l),$t(r.rels,4,l,Bt.CUST_PROPS)),c=1;c<=e.SheetNames.length;++c){var d={"!id":{}},g=e.Sheets[e.SheetNames[c-1]],x=(g||{})["!type"]||"sheet";switch(x){case"chart":default:l="xl/worksheets/sheet"+c+"."+t,Tt(s,l,J4(c-1,l,r,e,d)),a.sheets.push(l),$t(r.wbrels,-1,"worksheets/sheet"+c+"."+t,Bt.WS[0])}if(g){var p=g["!comments"],w=!1,v="";p&&p.length>0&&(v="xl/comments"+c+"."+t,Tt(s,v,ew(p,v)),a.comments.push(v),$t(d,-1,"../comments"+c+"."+t,Bt.CMNT),w=!0),g["!legacy"]&&w&&Tt(s,"xl/drawings/vmlDrawing"+c+".vml",zd(c,g["!comments"])),delete g["!comments"],delete g["!legacy"]}d["!id"].rId1&&Tt(s,Nd(l),Cs(d))}return r.Strings!=null&&r.Strings.length>0&&(l="xl/sharedStrings."+t,Tt(s,l,Q4(r.Strings,l,r)),a.strs.push(l),$t(r.wbrels,-1,"sharedStrings."+t,Bt.SST)),l="xl/workbook."+t,Tt(s,l,K4(e,l)),a.workbooks.push(l),$t(r.rels,1,l,Bt.WB),l="xl/theme/theme1.xml",Tt(s,l,Hd(e.Themes,r)),a.themes.push(l),$t(r.wbrels,-1,"theme/theme1.xml",Bt.THEME),l="xl/styles."+t,Tt(s,l,Z4(e,l,r)),a.styles.push(l),$t(r.wbrels,-1,"styles."+t,Bt.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",Tt(s,l,e.vbaraw),a.vba.push(l),$t(r.wbrels,-1,"vbaProject.bin",Bt.VBA)),l="xl/metadata."+t,Tt(s,l,tw(l)),a.metadata.push(l),$t(r.wbrels,-1,"metadata."+t,Bt.XLMETA),Tt(s,"[Content_Types].xml",bd(a,r)),Tt(s,"_rels/.rels",Cs(r.rels)),Tt(s,"xl/_rels/workbook."+t+".rels",Cs(r.wbrels)),delete r.revssf,delete r.ssf,s}function Xw(e,r){Es=1024,e&&!e.SSF&&(e.SSF=_n(gr)),e&&e.SSF&&(m0(),p0(e.SSF),r.revssf=g0(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Eo?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t="xml",n=Vd.indexOf(r.bookType)>-1,a=wd();gf(r=r||{});var s=Qc(),l="",c=0;if(r.cellXfs=[],Ni(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",Tt(s,l,Sd(e.Props,r)),a.coreprops.push(l),$t(r.rels,2,l,Bt.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var f=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&f.push(e.SheetNames[u]);e.Props.SheetNames=f}e.Props.Worksheets=e.Props.SheetNames.length,Tt(s,l,jd(e.Props)),a.extprops.push(l),$t(r.rels,3,l,Bt.EXT_PROPS),e.Custprops!==e.Props&&Kr(e.Custprops||{}).length>0&&(l="docProps/custom.xml",Tt(s,l,kd(e.Custprops)),a.custprops.push(l),$t(r.rels,4,l,Bt.CUST_PROPS));var d=["SheetJ5"];for(r.tcid=0,c=1;c<=e.SheetNames.length;++c){var g={"!id":{}},x=e.Sheets[e.SheetNames[c-1]],p=(x||{})["!type"]||"sheet";switch(p){case"chart":default:l="xl/worksheets/sheet"+c+"."+t,Tt(s,l,e1(c-1,r,e,g)),a.sheets.push(l),$t(r.wbrels,-1,"worksheets/sheet"+c+"."+t,Bt.WS[0])}if(x){var w=x["!comments"],v=!1,_="";if(w&&w.length>0){var S=!1;w.forEach(function(b){b[1].forEach(function(A){A.T==!0&&(S=!0)})}),S&&(_="xl/threadedComments/threadedComment"+c+"."+t,Tt(s,_,j5(w,d,r)),a.threadedcomments.push(_),$t(g,-1,"../threadedComments/threadedComment"+c+"."+t,Bt.TCMNT)),_="xl/comments"+c+"."+t,Tt(s,_,qd(w)),a.comments.push(_),$t(g,-1,"../comments"+c+"."+t,Bt.CMNT),v=!0}x["!legacy"]&&v&&Tt(s,"xl/drawings/vmlDrawing"+c+".vml",zd(c,x["!comments"])),delete x["!comments"],delete x["!legacy"]}g["!id"].rId1&&Tt(s,Nd(l),Cs(g))}return r.Strings!=null&&r.Strings.length>0&&(l="xl/sharedStrings."+t,Tt(s,l,Id(r.Strings,r)),a.strs.push(l),$t(r.wbrels,-1,"sharedStrings."+t,Bt.SST)),l="xl/workbook."+t,Tt(s,l,n1(e)),a.workbooks.push(l),$t(r.rels,1,l,Bt.WB),l="xl/theme/theme1.xml",Tt(s,l,Hd(e.Themes,r)),a.themes.push(l),$t(r.wbrels,-1,"theme/theme1.xml",Bt.THEME),l="xl/styles."+t,Tt(s,l,Bd(e,r)),a.styles.push(l),$t(r.wbrels,-1,"styles."+t,Bt.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",Tt(s,l,e.vbaraw),a.vba.push(l),$t(r.wbrels,-1,"vbaProject.bin",Bt.VBA)),l="xl/metadata."+t,Tt(s,l,Wd()),a.metadata.push(l),$t(r.wbrels,-1,"metadata."+t,Bt.XLMETA),d.length>1&&(l="xl/persons/person.xml",Tt(s,l,k5(d)),a.people.push(l),$t(r.wbrels,-1,"persons/person.xml",Bt.PEOPLE)),Tt(s,"[Content_Types].xml",bd(a,r)),Tt(s,"_rels/.rels",Cs(r.rels)),Tt(s,"xl/_rels/workbook."+t+".rels",Cs(r.wbrels)),delete r.revssf,delete r.ssf,s}function Kw(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Va(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function f1(e,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return Ho(r.file,Zt.write(e,{type:Ht?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return Zt.write(e,r)}function Jw(e,r){var t=_n(r||{}),n=$w(e,t);return Zw(n,t)}function Zw(e,r){var t={},n=Ht?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(r.compression&&(t.compression="DEFLATE"),r.password)t.type=n;else switch(r.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":t.type=n;break;default:throw new Error("Unrecognized type "+r.type)}var a=e.FullPaths?Zt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!r.compression}):e.generate(t);if(typeof Deno<"u"&&typeof a=="string"){if(r.type=="binary"||r.type=="base64")return a;a=new Uint8Array(d0(a))}return r.password&&typeof encrypt_agile<"u"?f1(encrypt_agile(a,r.password),r):r.type==="file"?Ho(r.file,a):r.type=="string"?Ao(a):a}function Qw(e,r){var t=r||{},n=mw(e,t);return f1(n,t)}function Aa(e,r,t){t||(t="");var n=t+e;switch(r.type){case"base64":return Po(Io(n));case"binary":return Io(n);case"string":return e;case"file":return Ho(r.file,n,"utf8");case"buffer":return Ht?$a(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Aa(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function e3(e,r){switch(r.type){case"base64":return Po(e);case"binary":return e;case"string":return e;case"file":return Ho(r.file,e,"binary");case"buffer":return Ht?$a(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function $l(e,r){switch(r.type){case"string":case"base64":case"binary":for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return r.type=="base64"?Po(t):r.type=="string"?Ao(t):t;case"file":return Ho(r.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+r.type)}}function h1(e,r){Tm(),B4(e);var t=_n(r||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var n=h1(e,t);return t.type="array",d0(n)}var a=0;if(t.sheet&&(typeof t.sheet=="number"?a=t.sheet:a=e.SheetNames.indexOf(t.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Aa(dw(e,t),t);case"slk":case"sylk":return Aa(Dx.from_sheet(e.Sheets[e.SheetNames[a]],t),t);case"htm":case"html":return Aa(s1(e.Sheets[e.SheetNames[a]],t),t);case"txt":return e3(u1(e.Sheets[e.SheetNames[a]],t),t);case"csv":return Aa(xf(e.Sheets[e.SheetNames[a]],t),t,"\uFEFF");case"dif":return Aa(Rx.from_sheet(e.Sheets[e.SheetNames[a]],t),t);case"dbf":return $l(Ix.from_sheet(e.Sheets[e.SheetNames[a]],t),t);case"prn":return Aa(Mx.from_sheet(e.Sheets[e.SheetNames[a]],t),t);case"rtf":return Aa(Vx.from_sheet(e.Sheets[e.SheetNames[a]],t),t);case"eth":return Aa(Od.from_sheet(e.Sheets[e.SheetNames[a]],t),t);case"fods":return Aa(c1(e,t),t);case"wk1":return $l(Qh.sheet_to_wk1(e.Sheets[e.SheetNames[a]],t),t);case"wk3":return $l(Qh.book_to_wk3(e,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),$l(i1(e,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),Qw(e,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Jw(e,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function t3(e){if(!e.bookType){var r={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType=r[e.bookType]||e.bookType}}function r3(e,r,t){var n={};return n.type="file",n.file=r,t3(n),h1(e,n)}function n3(e,r,t,n,a,s,l,c){var f=Xr(t),u=c.defval,d=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),g=!0,x=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:t,enumerable:!1})}catch{x.__rowNum__=t}else x.__rowNum__=t;if(!l||e[t])for(var p=r.s.c;p<=r.e.c;++p){var w=l?e[t][p]:e[n[p]+f];if(w===void 0||w.t===void 0){if(u===void 0)continue;s[p]!=null&&(x[s[p]]=u);continue}var v=w.v;switch(w.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(s[p]!=null){if(v==null)if(w.t=="e"&&v===null)x[s[p]]=null;else if(u!==void 0)x[s[p]]=u;else if(d&&v===null)x[s[p]]=null;else continue;else x[s[p]]=d&&(w.t!=="n"||w.t==="n"&&c.rawNumbers!==!1)?v:Ga(w,v,c);v!=null&&(g=!1)}}return{row:x,isempty:g}}function c0(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},n=0,a=1,s=[],l=0,c="",f={s:{r:0,c:0},e:{r:0,c:0}},u=r||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":f=lr(d);break;case"number":f=lr(e["!ref"]),f.s.r=d;break;default:f=d}n>0&&(a=0);var g=Xr(f.s.r),x=[],p=[],w=0,v=0,_=Array.isArray(e),S=f.s.r,b=0,A={};_&&!e[S]&&(e[S]=[]);var E=u.skipHidden&&e["!cols"]||[],U=u.skipHidden&&e["!rows"]||[];for(b=f.s.c;b<=f.e.c;++b)if(!(E[b]||{}).hidden)switch(x[b]=sn(b),t=_?e[S][b]:e[x[b]+g],n){case 1:s[b]=b-f.s.c;break;case 2:s[b]=x[b];break;case 3:s[b]=u.header[b-f.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),c=l=Ga(t,null,u),v=A[l]||0,!v)A[l]=1;else{do c=l+"_"+v++;while(A[c]);A[l]=v,A[c]=1}s[b]=c}for(S=f.s.r+a;S<=f.e.r;++S)if(!(U[S]||{}).hidden){var R=n3(e,f,S,x,n,s,_,u);(R.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(p[w++]=R.row)}return p.length=w,p}var ou=/"/g;function a3(e,r,t,n,a,s,l,c){for(var f=!0,u=[],d="",g=Xr(t),x=r.s.c;x<=r.e.c;++x)if(n[x]){var p=c.dense?(e[t]||[])[x]:e[n[x]+g];if(p==null)d="";else if(p.v!=null){f=!1,d=""+(c.rawNumbers&&p.t=="n"?p.v:Ga(p,null,c));for(var w=0,v=0;w!==d.length;++w)if((v=d.charCodeAt(w))===a||v===s||v===34||c.forceQuotes){d='"'+d.replace(ou,'""')+'"';break}d=="ID"&&(d='"ID"')}else p.f!=null&&!p.F?(f=!1,d="="+p.f,d.indexOf(",")>=0&&(d='"'+d.replace(ou,'""')+'"')):d="";u.push(d)}return c.blankrows===!1&&f?null:u.join(l)}function xf(e,r){var t=[],n=r??{};if(e==null||e["!ref"]==null)return"";var a=lr(e["!ref"]),s=n.FS!==void 0?n.FS:",",l=s.charCodeAt(0),c=n.RS!==void 0?n.RS:`
`,f=c.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),d="",g=[];n.dense=Array.isArray(e);for(var x=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],w=a.s.c;w<=a.e.c;++w)(x[w]||{}).hidden||(g[w]=sn(w));for(var v=0,_=a.s.r;_<=a.e.r;++_)(p[_]||{}).hidden||(d=a3(e,a,_,g,l,f,s,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&t.push((v++?c:"")+d)));return delete n.dense,t.join("")}function u1(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=xf(e,r);return t}function i3(e){var r="",t,n="";if(e==null||e["!ref"]==null)return[];var a=lr(e["!ref"]),s="",l=[],c,f=[],u=Array.isArray(e);for(c=a.s.c;c<=a.e.c;++c)l[c]=sn(c);for(var d=a.s.r;d<=a.e.r;++d)for(s=Xr(d),c=a.s.c;c<=a.e.c;++c)if(r=l[c]+s,t=u?(e[d]||[])[c]:e[r],n="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;n=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}f[f.length]=r+"="+n}return f}function d1(e,r,t){var n=t||{},a=+!n.skipHeader,s=e||{},l=0,c=0;if(s&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var f=typeof n.origin=="string"?Hr(n.origin):n.origin;l=f.r,c=f.c}var u,d={s:{c:0,r:0},e:{c,r:l+r.length-1+a}};if(s["!ref"]){var g=lr(s["!ref"]);d.e.c=Math.max(d.e.c,g.e.c),d.e.r=Math.max(d.e.r,g.e.r),l==-1&&(l=g.e.r+1,d.e.r=l+r.length-1+a)}else l==-1&&(l=0,d.e.r=r.length-1+a);var x=n.header||[],p=0;r.forEach(function(v,_){Kr(v).forEach(function(S){(p=x.indexOf(S))==-1&&(x[p=x.length]=S);var b=v[S],A="z",E="",U=Xt({c:c+p,r:l+_+a});u=Mo(s,U),b&&typeof b=="object"&&!(b instanceof Date)?s[U]=b:(typeof b=="number"?A="n":typeof b=="boolean"?A="b":typeof b=="string"?A="s":b instanceof Date?(A="d",n.cellDates||(A="n",b=Nn(b)),E=n.dateNF||gr[14]):b===null&&n.nullError&&(A="e",b=0),u?(u.t=A,u.v=b,delete u.w,delete u.R,E&&(u.z=E)):s[U]=u={t:A,v:b},E&&(u.z=E))})}),d.e.c=Math.max(d.e.c,c+x.length-1);var w=Xr(l);if(a)for(p=0;p<x.length;++p)s[sn(p+c)+w]={t:"s",v:x[p]};return s["!ref"]=Er(d),s}function s3(e,r){return d1(null,e,r)}function Mo(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var n=Hr(r);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?Mo(e,Xt(r)):Mo(e,Xt({r,c:t||0}))}function o3(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function l3(){return{SheetNames:[],Sheets:{}}}function c3(e,r,t,n){var a=1;if(!t)for(;a<=65535&&e.SheetNames.indexOf(t="Sheet"+a)!=-1;++a,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var l=s&&s[1]||t;for(++a;a<=65535&&e.SheetNames.indexOf(t=l+a)!=-1;++a);}if(r1(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function f3(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=o3(e,r);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[n].Hidden=t}function h3(e,r){return e.z=r,e}function p1(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function u3(e,r,t){return p1(e,"#"+r,t)}function d3(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function p3(e,r,t,n){for(var a=typeof r!="string"?r:lr(r),s=typeof r=="string"?r:Er(r),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c){var f=Mo(e,l,c);f.t="n",f.F=s,delete f.v,l==a.s.r&&c==a.s.c&&(f.f=t,n&&(f.D=!0))}return e}var Or={encode_col:sn,encode_row:Xr,encode_cell:Xt,encode_range:Er,decode_col:sf,decode_row:af,split_cell:Tg,decode_cell:Hr,decode_range:Rn,format_cell:Ga,sheet_add_aoa:pd,sheet_add_json:d1,sheet_add_dom:o1,aoa_to_sheet:Ds,json_to_sheet:s3,table_to_sheet:l1,table_to_book:Rw,sheet_to_csv:xf,sheet_to_txt:u1,sheet_to_json:c0,sheet_to_html:s1,sheet_to_formulae:i3,sheet_to_row_object_array:c0,sheet_get_cell:Mo,book_new:l3,book_append_sheet:c3,book_set_sheet_visibility:f3,cell_set_number_format:h3,cell_set_hyperlink:p1,cell_set_internal_link:u3,cell_add_comment:d3,sheet_set_array_formula:p3,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const jc=[{id:"sales",name:"Sales Report",description:"Revenue, orders, and sales performance",icon:"ðŸ“Š",color:"afri-green"},{id:"inventory",name:"Inventory Report",description:"Stock levels, low stock items, and product performance",icon:"ðŸ“¦",color:"blue-600"},{id:"orders",name:"Order Report",description:"Order history, status breakdown, and delivery metrics",icon:"ðŸ“‹",color:"purple-600"},{id:"revenue",name:"Revenue Report",description:"Earnings breakdown, payment status, and financial summary",icon:"ðŸ’°",color:"afri-yellow-dark"}],m3=[{label:"Today",value:"today"},{label:"Yesterday",value:"yesterday"},{label:"Last 7 Days",value:"week"},{label:"Last 30 Days",value:"month"},{label:"This Month",value:"thisMonth"},{label:"Last Month",value:"lastMonth"},{label:"Custom Range",value:"custom"}];function g3(){const[e,r]=Te.useState(null),[t,n]=Te.useState("week"),[a,s]=Te.useState(""),[l,c]=Te.useState(""),[f,u]=Te.useState(!1),[d,g]=Te.useState(null),[x,p]=Te.useState(!1),w=async()=>{if(!e){alert("Please select a report type");return}u(!0);try{const{startDate:b,endDate:A}=v();let E;switch(e){case"sales":E=await mr.getSalesReport({startDate:b,endDate:A});break;case"inventory":E=await mr.getInventoryReport();break;case"orders":E=await mr.getOrdersReport({startDate:b,endDate:A});break;case"revenue":E=await mr.getRevenueReport({startDate:b,endDate:A});break;default:throw new Error("Invalid report type")}E.success&&(g(E.data),p(!0))}catch(b){console.error("Error generating report:",b),alert(b.message||"Failed to generate report")}finally{u(!1)}},v=()=>{const b=new Date;let A,E;switch(t){case"today":A=new Date(b.setHours(0,0,0,0)),E=new Date(b.setHours(23,59,59,999));break;case"yesterday":A=new Date(b.setDate(b.getDate()-1)),A.setHours(0,0,0,0),E=new Date(A),E.setHours(23,59,59,999);break;case"week":A=new Date(b.setDate(b.getDate()-7)),E=new Date;break;case"month":A=new Date(b.setDate(b.getDate()-30)),E=new Date;break;case"thisMonth":A=new Date(b.getFullYear(),b.getMonth(),1),E=new Date;break;case"lastMonth":A=new Date(b.getFullYear(),b.getMonth()-1,1),E=new Date(b.getFullYear(),b.getMonth(),0);break;case"custom":A=new Date(a),E=new Date(l);break;default:A=new Date(b.setDate(b.getDate()-7)),E=new Date}return{startDate:A.toISOString(),endDate:E.toISOString()}},_=()=>{var C,P,W,k,T,H;if(!d)return;const b=new mt,A=jc.find(G=>G.id===e);b.setFontSize(20),b.setTextColor(0,178,7),b.text(A.name,14,20),b.setFontSize(10),b.setTextColor(100);const{startDate:E,endDate:U}=v();b.text(`Generated: ${new Date().toLocaleDateString()} | Period: ${new Date(E).toLocaleDateString()} - ${new Date(U).toLocaleDateString()}`,14,28);let R=40;if(e==="sales"){b.setFontSize(14),b.setTextColor(0),b.text("Summary",14,R),R+=10;const G=[["Total Revenue",`Â£${((C=d.totalRevenue)==null?void 0:C.toFixed(2))||"0.00"}`],["Total Orders",d.totalOrders||0],["Average Order Value",`Â£${((P=d.avgOrderValue)==null?void 0:P.toFixed(2))||"0.00"}`],["Total Items Sold",d.totalItemsSold||0]];if(b.autoTable({startY:R,head:[["Metric","Value"]],body:G,theme:"grid",headStyles:{fillColor:[0,178,7]}}),d.topProducts&&d.topProducts.length>0){R=b.lastAutoTable.finalY+15,b.setFontSize(14),b.text("Top Products",14,R),R+=5;const ce=d.topProducts.map((J,Q)=>{var oe;return[Q+1,J.name,J.soldQuantity,`Â£${((oe=J.revenue)==null?void 0:oe.toFixed(2))||"0.00"}`]});b.autoTable({startY:R+5,head:[["#","Product","Qty Sold","Revenue"]],body:ce,theme:"striped",headStyles:{fillColor:[0,178,7]}})}}else if(e==="inventory"){b.setFontSize(14),b.text("Stock Overview",14,R),R+=10;const G=[["Total Products",d.totalProducts||0],["In Stock",d.inStock||0],["Out of Stock",d.outOfStock||0],["Low Stock",d.lowStock||0]];if(b.autoTable({startY:R,head:[["Category","Count"]],body:G,theme:"grid",headStyles:{fillColor:[0,178,7]}}),d.lowStockItems&&d.lowStockItems.length>0){R=b.lastAutoTable.finalY+15,b.setFontSize(14),b.text("Low Stock Items",14,R),R+=5;const ce=d.lowStockItems.map(J=>[J.name,J.currentStock,J.lowStockThreshold,J.status]);b.autoTable({startY:R+5,head:[["Product","Current Stock","Threshold","Status"]],body:ce,theme:"striped",headStyles:{fillColor:[255,138,0]}})}}else if(e==="orders"){b.setFontSize(14),b.text("Orders Summary",14,R),R+=10;const G=[["Total Orders",d.totalOrders||0],["Completed",d.completed||0],["Pending",d.pending||0],["Cancelled",d.cancelled||0]];if(b.autoTable({startY:R,head:[["Status","Count"]],body:G,theme:"grid",headStyles:{fillColor:[0,178,7]}}),d.orders&&d.orders.length>0){R=b.lastAutoTable.finalY+15,b.setFontSize(14),b.text("Order Details",14,R),R+=5;const ce=d.orders.map(J=>{var Q;return[J.orderNumber,new Date(J.createdAt).toLocaleDateString(),J.status,`Â£${((Q=J.total)==null?void 0:Q.toFixed(2))||"0.00"}`]});b.autoTable({startY:R+5,head:[["Order #","Date","Status","Total"]],body:ce,theme:"striped",headStyles:{fillColor:[0,178,7]}})}}else if(e==="revenue"){b.setFontSize(14),b.text("Revenue Summary",14,R),R+=10;const G=[["Total Revenue",`Â£${((W=d.totalRevenue)==null?void 0:W.toFixed(2))||"0.00"}`],["Paid",`Â£${((k=d.paidRevenue)==null?void 0:k.toFixed(2))||"0.00"}`],["Pending",`Â£${((T=d.pendingRevenue)==null?void 0:T.toFixed(2))||"0.00"}`],["Refunded",`Â£${((H=d.refundedRevenue)==null?void 0:H.toFixed(2))||"0.00"}`]];if(b.autoTable({startY:R,head:[["Category","Amount"]],body:G,theme:"grid",headStyles:{fillColor:[0,178,7]}}),d.dailyRevenue&&d.dailyRevenue.length>0){R=b.lastAutoTable.finalY+15,b.setFontSize(14),b.text("Daily Revenue Breakdown",14,R),R+=5;const ce=d.dailyRevenue.map(J=>{var Q;return[new Date(J.date).toLocaleDateString(),J.orders,`Â£${((Q=J.revenue)==null?void 0:Q.toFixed(2))||"0.00"}`]});b.autoTable({startY:R+5,head:[["Date","Orders","Revenue"]],body:ce,theme:"striped",headStyles:{fillColor:[0,178,7]}})}}const L=b.internal.getNumberOfPages();for(let G=1;G<=L;G++)b.setPage(G),b.setFontSize(8),b.setTextColor(150),b.text(`Afrimercato - ${A.name} | Page ${G} of ${L}`,14,b.internal.pageSize.height-10);b.save(`${e}-report-${new Date().toISOString().split("T")[0]}.pdf`)},S=()=>{var E,U,R,L,C,P;if(!d)return;const b=jc.find(W=>W.id===e),A=Or.book_new();if(e==="sales"){const W=[["Metric","Value"],["Total Revenue",((E=d.totalRevenue)==null?void 0:E.toFixed(2))||"0.00"],["Total Orders",d.totalOrders||0],["Average Order Value",((U=d.avgOrderValue)==null?void 0:U.toFixed(2))||"0.00"],["Total Items Sold",d.totalItemsSold||0]],k=Or.aoa_to_sheet(W);if(Or.book_append_sheet(A,k,"Summary"),d.topProducts&&d.topProducts.length>0){const T=[["Rank","Product","Quantity Sold","Revenue"],...d.topProducts.map((G,ce)=>{var J;return[ce+1,G.name,G.soldQuantity,((J=G.revenue)==null?void 0:J.toFixed(2))||"0.00"]})],H=Or.aoa_to_sheet(T);Or.book_append_sheet(A,H,"Top Products")}}else if(e==="inventory"){const W=[["Category","Count"],["Total Products",d.totalProducts||0],["In Stock",d.inStock||0],["Out of Stock",d.outOfStock||0],["Low Stock",d.lowStock||0]],k=Or.aoa_to_sheet(W);if(Or.book_append_sheet(A,k,"Overview"),d.lowStockItems&&d.lowStockItems.length>0){const T=[["Product","Current Stock","Threshold","Status"],...d.lowStockItems.map(G=>[G.name,G.currentStock,G.lowStockThreshold,G.status])],H=Or.aoa_to_sheet(T);Or.book_append_sheet(A,H,"Low Stock Items")}if(d.allProducts&&d.allProducts.length>0){const T=[["Name","Category","Stock","Price","Status"],...d.allProducts.map(G=>[G.name,G.category,G.stock,G.price,G.inStock?"In Stock":"Out of Stock"])],H=Or.aoa_to_sheet(T);Or.book_append_sheet(A,H,"All Products")}}else if(e==="orders"){const W=[["Status","Count"],["Total Orders",d.totalOrders||0],["Completed",d.completed||0],["Pending",d.pending||0],["Cancelled",d.cancelled||0]],k=Or.aoa_to_sheet(W);if(Or.book_append_sheet(A,k,"Summary"),d.orders&&d.orders.length>0){const T=[["Order Number","Date","Customer","Status","Items","Total"],...d.orders.map(G=>{var ce;return[G.orderNumber,new Date(G.createdAt).toLocaleDateString(),G.customerName||"N/A",G.status,G.itemsCount||0,((ce=G.total)==null?void 0:ce.toFixed(2))||"0.00"]})],H=Or.aoa_to_sheet(T);Or.book_append_sheet(A,H,"Orders")}}else if(e==="revenue"){const W=[["Category","Amount (Â£)"],["Total Revenue",((R=d.totalRevenue)==null?void 0:R.toFixed(2))||"0.00"],["Paid",((L=d.paidRevenue)==null?void 0:L.toFixed(2))||"0.00"],["Pending",((C=d.pendingRevenue)==null?void 0:C.toFixed(2))||"0.00"],["Refunded",((P=d.refundedRevenue)==null?void 0:P.toFixed(2))||"0.00"]],k=Or.aoa_to_sheet(W);if(Or.book_append_sheet(A,k,"Summary"),d.dailyRevenue&&d.dailyRevenue.length>0){const T=[["Date","Orders","Revenue (Â£)"],...d.dailyRevenue.map(G=>{var ce;return[new Date(G.date).toLocaleDateString(),G.orders,((ce=G.revenue)==null?void 0:ce.toFixed(2))||"0.00"]})],H=Or.aoa_to_sheet(T);Or.book_append_sheet(A,H,"Daily Revenue")}}r3(A,`${b.name.replace(" ","-")}-${new Date().toISOString().split("T")[0]}.xlsx`)};return o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"mb-8",children:[o.jsx("h1",{className:"text-3xl font-bold text-afri-gray-900",children:"Reports"}),o.jsx("p",{className:"text-afri-gray-600 mt-1",children:"Generate and export business reports"})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[o.jsx("div",{className:"lg:col-span-1",children:o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsx("h2",{className:"text-lg font-semibold text-afri-gray-900 mb-4",children:"Select Report Type"}),o.jsx("div",{className:"space-y-3",children:jc.map(b=>o.jsx("button",{onClick:()=>r(b.id),className:`w-full text-left p-4 rounded-lg border-2 transition ${e===b.id?`border-${b.color} bg-${b.color} bg-opacity-10`:"border-gray-200 hover:border-gray-300"}`,children:o.jsxs("div",{className:"flex items-start",children:[o.jsx("span",{className:"text-2xl mr-3",children:b.icon}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"font-semibold text-afri-gray-900",children:b.name}),o.jsx("p",{className:"text-sm text-afri-gray-600 mt-1",children:b.description})]})]})},b.id))})]})}),o.jsx("div",{className:"lg:col-span-2",children:o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsx("h2",{className:"text-lg font-semibold text-afri-gray-900 mb-4",children:"Report Configuration"}),e?o.jsxs("div",{className:"space-y-6",children:[e!=="inventory"&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-afri-gray-700 mb-2",children:"Date Range"}),o.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:m3.map(b=>o.jsx("button",{onClick:()=>n(b.value),className:`px-4 py-2 rounded-lg font-medium transition ${t===b.value?"bg-afri-green text-white":"bg-afri-gray-50 text-afri-gray-700 hover:bg-afri-gray-100"}`,children:b.label},b.value))}),t==="custom"&&o.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-afri-gray-700 mb-1",children:"Start Date"}),o.jsx("input",{type:"date",value:a,onChange:b=>s(b.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-afri-gray-700 mb-1",children:"End Date"}),o.jsx("input",{type:"date",value:l,onChange:b=>c(b.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent"})]})]})]}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx("button",{onClick:w,disabled:f,className:"flex-1 bg-afri-green text-white px-6 py-3 rounded-lg font-semibold hover:bg-afri-green-dark transition disabled:opacity-50 disabled:cursor-not-allowed",children:f?o.jsxs("span",{className:"flex items-center justify-center",children:[o.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generating..."]}):"Generate Report"}),d&&o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:_,className:"bg-red-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-red-700 transition",children:"Export PDF"}),o.jsx("button",{onClick:S,className:"bg-green-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-green-700 transition",children:"Export Excel"})]})]}),x&&d&&o.jsxs("div",{className:"mt-6 border-t pt-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-afri-gray-900 mb-4",children:"Report Preview"}),o.jsx("div",{className:"bg-afri-gray-50 rounded-lg p-6",children:o.jsx("pre",{className:"text-sm text-afri-gray-700 whitespace-pre-wrap",children:JSON.stringify(d,null,2)})})]})]}):o.jsxs("div",{className:"text-center py-12",children:[o.jsx("svg",{className:"w-16 h-16 text-afri-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),o.jsx("p",{className:"text-afri-gray-600",children:"Select a report type to get started"})]})]})})]})]})}function x3(){const{user:e}=Bo(),[r,t]=Te.useState("profile"),[n,a]=Te.useState(null),[s,l]=Te.useState(!0),c=[{id:"profile",name:"Vendor Profile",icon:"ðŸª"},{id:"account",name:"Account Settings",icon:"ðŸ‘¤"},{id:"notifications",name:"Notifications",icon:"ðŸ””"}];Te.useEffect(()=>{f()},[]);const f=async()=>{try{const u=await mr.getProfile();u.data.success&&a(u.data.data.vendor)}catch{console.log("No vendor profile found")}finally{l(!1)}};return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Settings"}),o.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your account and preferences"})]}),o.jsxs("div",{className:"bg-white rounded-xl shadow-sm",children:[o.jsx("div",{className:"border-b border-gray-200",children:o.jsx("nav",{className:"flex space-x-8 px-6","aria-label":"Tabs",children:c.map(u=>o.jsxs("button",{onClick:()=>t(u.id),className:`py-4 px-1 border-b-2 font-medium text-sm transition ${r===u.id?"border-afri-green text-afri-green":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[o.jsx("span",{className:"mr-2",children:u.icon}),u.name]},u.id))})}),o.jsx("div",{className:"p-6",children:s?o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-afri-green"})}):o.jsxs(o.Fragment,{children:[r==="profile"&&o.jsx(v3,{vendorProfile:n,onUpdate:f}),r==="account"&&o.jsx(y3,{user:e}),r==="notifications"&&o.jsx(w3,{})]})})]})]})}function v3({vendorProfile:e,onUpdate:r}){var x,p,w,v;const[t,n]=Te.useState({storeName:(e==null?void 0:e.storeName)||"",description:(e==null?void 0:e.description)||"",category:(e==null?void 0:e.category)||"fresh-produce",phone:(e==null?void 0:e.phone)||"",address:{street:((x=e==null?void 0:e.address)==null?void 0:x.street)||"",city:((p=e==null?void 0:e.address)==null?void 0:p.city)||"",state:((w=e==null?void 0:e.address)==null?void 0:w.state)||"",country:((v=e==null?void 0:e.address)==null?void 0:v.country)||"Nigeria"}}),[a,s]=Te.useState(!1),[l,c]=Te.useState(!1),[f,u]=Te.useState(""),d=_=>{const{name:S,value:b}=_.target;if(S.startsWith("address.")){const A=S.split(".")[1];n({...t,address:{...t.address,[A]:b}})}else n({...t,[S]:b})},g=async _=>{var S,b;_.preventDefault(),s(!0),u(""),c(!1);try{e?await mr.updateProfile(t):await mr.createProfile(t),c(!0),r(),setTimeout(()=>c(!1),3e3)}catch(A){u(((b=(S=A.response)==null?void 0:S.data)==null?void 0:b.message)||"Failed to save profile")}finally{s(!1)}};return o.jsxs("form",{onSubmit:g,className:"space-y-6",children:[l&&o.jsx("div",{className:"bg-green-50 border-l-4 border-green-500 p-4 rounded",children:o.jsx("p",{className:"text-green-700",children:"Profile updated successfully!"})}),f&&o.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded",children:o.jsx("p",{className:"text-red-700",children:f})}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Store Name"}),o.jsx("input",{type:"text",name:"storeName",required:!0,value:t.storeName,onChange:d,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green",placeholder:"My Fresh Store"})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),o.jsx("textarea",{name:"description",required:!0,rows:4,value:t.description,onChange:d,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green",placeholder:"Tell customers about your store..."})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),o.jsxs("select",{name:"category",value:t.category,onChange:d,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green",children:[o.jsx("option",{value:"fresh-produce",children:"Fresh Produce"}),o.jsx("option",{value:"groceries",children:"Groceries"}),o.jsx("option",{value:"meat-fish",children:"Meat & Fish"}),o.jsx("option",{value:"bakery",children:"Bakery"}),o.jsx("option",{value:"dairy",children:"Dairy"}),o.jsx("option",{value:"beverages",children:"Beverages"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone"}),o.jsx("input",{type:"tel",name:"phone",required:!0,value:t.phone,onChange:d,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green",placeholder:"+234-800-555-0000"})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Street Address"}),o.jsx("input",{type:"text",name:"address.street",required:!0,value:t.address.street,onChange:d,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green",placeholder:"123 Market Street"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City"}),o.jsx("input",{type:"text",name:"address.city",required:!0,value:t.address.city,onChange:d,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green",placeholder:"Lagos"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"State"}),o.jsx("input",{type:"text",name:"address.state",required:!0,value:t.address.state,onChange:d,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green",placeholder:"Lagos"})]})]}),o.jsx("div",{className:"flex justify-end",children:o.jsx("button",{type:"submit",disabled:a,className:"px-6 py-2 bg-afri-green text-white rounded-lg hover:bg-afri-green-dark transition font-medium disabled:opacity-50",children:a?"Saving...":"Save Changes"})})]})}function y3({user:e}){const[r,t]=Te.useState({name:(e==null?void 0:e.name)||"",email:(e==null?void 0:e.email)||""});return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Account Information"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name"}),o.jsx("input",{type:"text",value:r.name,readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),o.jsx("input",{type:"email",value:r.email,readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-50"})]})]})]}),o.jsxs("div",{className:"border-t pt-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Change Password"}),o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[o.jsx("p",{className:"text-sm text-gray-600 mb-4",children:'To change your password, please contact support or use the "Forgot Password" option on the login page.'}),o.jsx("button",{className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition font-medium",children:"Contact Support"})]})]})]})}function w3(){const[e,r]=Te.useState({emailOrders:!0,emailPromotions:!1,smsOrders:!0,pushNotifications:!0}),t=n=>{r({...e,[n]:!e[n]})};return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Notification Preferences"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-gray-900",children:"Order Notifications (Email)"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Receive email updates about new orders"})]}),o.jsx("button",{onClick:()=>t("emailOrders"),className:`relative inline-flex h-6 w-11 items-center rounded-full transition ${e.emailOrders?"bg-afri-green":"bg-gray-300"}`,children:o.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition ${e.emailOrders?"translate-x-6":"translate-x-1"}`})})]}),o.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-gray-900",children:"Promotional Emails"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Receive offers and promotions"})]}),o.jsx("button",{onClick:()=>t("emailPromotions"),className:`relative inline-flex h-6 w-11 items-center rounded-full transition ${e.emailPromotions?"bg-afri-green":"bg-gray-300"}`,children:o.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition ${e.emailPromotions?"translate-x-6":"translate-x-1"}`})})]}),o.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-gray-900",children:"SMS Notifications"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Receive SMS for important updates"})]}),o.jsx("button",{onClick:()=>t("smsOrders"),className:`relative inline-flex h-6 w-11 items-center rounded-full transition ${e.smsOrders?"bg-afri-green":"bg-gray-300"}`,children:o.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition ${e.smsOrders?"translate-x-6":"translate-x-1"}`})})]}),o.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-gray-900",children:"Push Notifications"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Receive push notifications on your device"})]}),o.jsx("button",{onClick:()=>t("pushNotifications"),className:`relative inline-flex h-6 w-11 items-center rounded-full transition ${e.pushNotifications?"bg-afri-green":"bg-gray-300"}`,children:o.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition ${e.pushNotifications?"translate-x-6":"translate-x-1"}`})})]})]})]}),o.jsx("div",{className:"flex justify-end",children:o.jsx("button",{className:"px-6 py-2 bg-afri-green text-white rounded-lg hover:bg-afri-green-dark transition font-medium",children:"Save Preferences"})})]})}function b3(){const[e,r]=Te.useState([]),[t,n]=Te.useState(null),[a,s]=Te.useState(!0),[l,c]=Te.useState("");Te.useEffect(()=>{f()},[]);const f=async()=>{var g,x,p;try{const[w,v]=await Promise.all([sc.getPlans(),sc.getMySubscription().catch(()=>({data:{data:null}}))]);w.data.success&&r(w.data.data.plans||[]),(g=v.data)!=null&&g.data&&n(v.data.data)}catch(w){c(((p=(x=w.response)==null?void 0:x.data)==null?void 0:p.message)||"Failed to load subscription data")}finally{s(!1)}},u=async g=>{var x,p;try{await sc.subscribe({planId:g}),f(),alert("Subscription upgraded successfully!")}catch(w){alert(((p=(x=w.response)==null?void 0:x.data)==null?void 0:p.message)||"Failed to subscribe")}};if(a)return o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-afri-green"})});const d=t==null?void 0:t.plan;return o.jsxs("div",{className:"space-y-8",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("h1",{className:"text-4xl font-bold text-gray-900",children:"Choose Your Plan"}),o.jsx("p",{className:"text-gray-600 mt-3 text-lg",children:"Unlock premium features for your Afrimercato marketplace"})]}),t&&o.jsxs("div",{className:"bg-gradient-to-r from-afri-green to-afri-green-dark rounded-xl p-6 text-white text-center",children:[o.jsx("p",{className:"text-sm font-medium mb-1",children:"CURRENT PLAN"}),o.jsxs("p",{className:"text-3xl font-bold capitalize",children:[t.plan," Plan"]}),t.endDate&&o.jsxs("p",{className:"text-sm mt-2 opacity-90",children:["Valid until ",new Date(t.endDate).toLocaleDateString()]})]}),l&&o.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded",children:o.jsx("p",{className:"text-red-700",children:l})}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:e.map(g=>{var w,v;const x=g.id===d,p=!x&&!N3(d,g.id);return o.jsxs("div",{className:`relative bg-white rounded-2xl shadow-lg overflow-hidden transition-all hover:shadow-2xl ${g.id==="premium"?"border-4 border-afri-yellow scale-105":"border border-gray-200"}`,children:[g.id==="premium"&&o.jsx("div",{className:"absolute top-0 right-0 bg-afri-yellow text-gray-900 px-4 py-1 text-xs font-bold rounded-bl-lg",children:"RECOMMENDED"}),x&&o.jsx("div",{className:"absolute top-0 left-0 bg-afri-green text-white px-4 py-1 text-xs font-bold rounded-br-lg",children:"CURRENT PLAN"}),o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"text-4xl mb-4",children:[g.id==="free"&&"ðŸŒ±",g.id==="standard"&&"ðŸš€",g.id==="premium"&&"â­",g.id==="enterprise"&&"ðŸ‘‘"]}),o.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:g.name}),o.jsx("div",{className:"mb-6",children:typeof g.price=="number"?o.jsxs(o.Fragment,{children:[o.jsxs("span",{className:"text-4xl font-bold text-afri-green",children:["Â£",g.price.toLocaleString()]}),o.jsx("span",{className:"text-gray-600 ml-2",children:"/month"})]}):o.jsx("span",{className:"text-2xl font-bold text-gray-900",children:g.price})}),o.jsxs("div",{className:"space-y-3 mb-6",children:[o.jsxs("div",{className:"flex items-start",children:[o.jsx("span",{className:"text-green-500 mr-2",children:"âœ“"}),o.jsxs("span",{className:"text-sm text-gray-600",children:[g.features.maxProducts==="unlimited"?"Unlimited":g.features.maxProducts," products"]})]}),o.jsxs("div",{className:"flex items-start",children:[o.jsx("span",{className:"text-green-500 mr-2",children:"âœ“"}),o.jsxs("span",{className:"text-sm text-gray-600",children:[g.features.maxMonthlyOrders==="unlimited"?"Unlimited":g.features.maxMonthlyOrders," orders/month"]})]}),(w=g.features.jumiaIntegration)!=null&&w.enabled?o.jsxs("div",{className:"flex items-start",children:[o.jsx("span",{className:"text-green-500 mr-2",children:"âœ“"}),o.jsxs("span",{className:"text-sm text-gray-600",children:["Marketplace ",g.features.jumiaIntegration.tier==="premium"?"Premium":"Standard"]})]}):o.jsxs("div",{className:"flex items-start",children:[o.jsx("span",{className:"text-gray-400 mr-2",children:"âœ—"}),o.jsx("span",{className:"text-sm text-gray-400",children:"No marketplace features"})]}),(v=g.features.kongaIntegration)!=null&&v.enabled?o.jsxs("div",{className:"flex items-start",children:[o.jsx("span",{className:"text-green-500 mr-2",children:"âœ“"}),o.jsxs("span",{className:"text-sm text-gray-600",children:["Advanced ",g.features.kongaIntegration.tier==="premium"?"Premium":"Standard"]})]}):o.jsxs("div",{className:"flex items-start",children:[o.jsx("span",{className:"text-gray-400 mr-2",children:"âœ—"}),o.jsx("span",{className:"text-sm text-gray-400",children:"No advanced features"})]}),o.jsxs("div",{className:"flex items-start",children:[o.jsx("span",{className:"text-green-500 mr-2",children:"âœ“"}),o.jsxs("span",{className:"text-sm text-gray-600",children:[g.features.commissionRate,"% commission"]})]}),o.jsxs("div",{className:"flex items-start",children:[o.jsx("span",{className:"text-green-500 mr-2",children:"âœ“"}),o.jsxs("span",{className:"text-sm text-gray-600",children:[g.features.analytics," analytics"]})]}),o.jsxs("div",{className:"flex items-start",children:[o.jsx("span",{className:"text-green-500 mr-2",children:"âœ“"}),o.jsxs("span",{className:"text-sm text-gray-600",children:[g.features.customerSupport," support"]})]})]}),x?o.jsx("button",{disabled:!0,className:"w-full py-3 bg-gray-200 text-gray-500 rounded-lg font-semibold cursor-not-allowed",children:"Current Plan"}):o.jsx("button",{onClick:()=>u(g.id),className:`w-full py-3 rounded-lg font-semibold transition ${g.id==="premium"?"bg-gradient-to-r from-afri-yellow to-yellow-500 text-gray-900 hover:from-yellow-500 hover:to-afri-yellow":"bg-afri-green text-white hover:bg-afri-green-dark"}`,children:p?"Upgrade Now":"Get Started"})]}),g.id==="premium"&&o.jsxs("div",{className:"bg-gradient-to-r from-afri-yellow to-yellow-500 p-4",children:[o.jsx("p",{className:"text-xs font-bold text-gray-900 mb-2",children:"PREMIUM FEATURES:"}),o.jsxs("ul",{className:"text-xs text-gray-900 space-y-1",children:[o.jsx("li",{children:"â€¢ 5 promotional spots/month on Afrimercato"}),o.jsx("li",{children:"â€¢ 10 featured products simultaneously"}),o.jsx("li",{children:"â€¢ Flash sale access"}),o.jsx("li",{children:"â€¢ Dedicated account manager"}),o.jsx("li",{children:"â€¢ Priority 24/7 support"})]})]})]},g.id)})}),o.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6 text-center",children:"Marketplace Integration Comparison"}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b-2 border-gray-200",children:[o.jsx("th",{className:"py-3 px-4 text-left text-sm font-semibold text-gray-900",children:"Feature"}),o.jsx("th",{className:"py-3 px-4 text-center text-sm font-semibold text-gray-900",children:"Standard"}),o.jsx("th",{className:"py-3 px-4 text-center text-sm font-semibold text-gray-900 bg-afri-yellow bg-opacity-10",children:"Premium"})]})}),o.jsxs("tbody",{className:"divide-y divide-gray-200",children:[o.jsxs("tr",{children:[o.jsx("td",{className:"py-3 px-4 text-sm text-gray-700",children:"Product Listing"}),o.jsx("td",{className:"py-3 px-4 text-center text-green-600",children:"âœ“"}),o.jsx("td",{className:"py-3 px-4 text-center text-green-600 bg-afri-yellow bg-opacity-5",children:"âœ“"})]}),o.jsxs("tr",{children:[o.jsx("td",{className:"py-3 px-4 text-sm text-gray-700",children:"Inventory Sync"}),o.jsx("td",{className:"py-3 px-4 text-center text-green-600",children:"âœ“"}),o.jsx("td",{className:"py-3 px-4 text-center text-green-600 bg-afri-yellow bg-opacity-5",children:"âœ“"})]}),o.jsxs("tr",{children:[o.jsx("td",{className:"py-3 px-4 text-sm text-gray-700",children:"Order Management"}),o.jsx("td",{className:"py-3 px-4 text-center text-green-600",children:"âœ“"}),o.jsx("td",{className:"py-3 px-4 text-center text-green-600 bg-afri-yellow bg-opacity-5",children:"âœ“"})]}),o.jsxs("tr",{children:[o.jsx("td",{className:"py-3 px-4 text-sm text-gray-700",children:"Promotional Spots"}),o.jsx("td",{className:"py-3 px-4 text-center text-gray-400",children:"âœ—"}),o.jsx("td",{className:"py-3 px-4 text-center text-green-600 bg-afri-yellow bg-opacity-5",children:"5/month"})]}),o.jsxs("tr",{children:[o.jsx("td",{className:"py-3 px-4 text-sm text-gray-700",children:"Featured Products"}),o.jsx("td",{className:"py-3 px-4 text-center text-gray-400",children:"âœ—"}),o.jsx("td",{className:"py-3 px-4 text-center text-green-600 bg-afri-yellow bg-opacity-5",children:"10 items"})]}),o.jsxs("tr",{children:[o.jsx("td",{className:"py-3 px-4 text-sm text-gray-700",children:"Flash Sales"}),o.jsx("td",{className:"py-3 px-4 text-center text-gray-400",children:"âœ—"}),o.jsx("td",{className:"py-3 px-4 text-center text-green-600 bg-afri-yellow bg-opacity-5",children:"âœ“"})]}),o.jsxs("tr",{children:[o.jsx("td",{className:"py-3 px-4 text-sm text-gray-700",children:"Category Placement"}),o.jsx("td",{className:"py-3 px-4 text-center text-gray-600",children:"Standard"}),o.jsx("td",{className:"py-3 px-4 text-center text-green-600 bg-afri-yellow bg-opacity-5",children:"Premium"})]}),o.jsxs("tr",{children:[o.jsx("td",{className:"py-3 px-4 text-sm text-gray-700",children:"Commission Rate"}),o.jsx("td",{className:"py-3 px-4 text-center text-gray-600",children:"8%"}),o.jsx("td",{className:"py-3 px-4 text-center text-green-600 font-semibold bg-afri-yellow bg-opacity-5",children:"6%"})]}),o.jsxs("tr",{children:[o.jsx("td",{className:"py-3 px-4 text-sm text-gray-700",children:"Account Manager"}),o.jsx("td",{className:"py-3 px-4 text-center text-gray-400",children:"âœ—"}),o.jsx("td",{className:"py-3 px-4 text-center text-green-600 bg-afri-yellow bg-opacity-5",children:"âœ“"})]})]})]})})]}),o.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Frequently Asked Questions"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("details",{className:"group",children:[o.jsx("summary",{className:"cursor-pointer font-semibold text-gray-900 py-3 border-b border-gray-200",children:"Can I upgrade or downgrade my plan anytime?"}),o.jsx("p",{className:"text-gray-600 text-sm mt-3",children:"Yes, you can upgrade or downgrade your plan at any time. Changes take effect immediately."})]}),o.jsxs("details",{className:"group",children:[o.jsx("summary",{className:"cursor-pointer font-semibold text-gray-900 py-3 border-b border-gray-200",children:"What payment methods do you accept?"}),o.jsx("p",{className:"text-gray-600 text-sm mt-3",children:"We accept all major payment methods including cards, bank transfers, and mobile money."})]}),o.jsxs("details",{className:"group",children:[o.jsx("summary",{className:"cursor-pointer font-semibold text-gray-900 py-3 border-b border-gray-200",children:"How does the marketplace integration work?"}),o.jsx("p",{className:"text-gray-600 text-sm mt-3",children:"Once subscribed, your products are automatically listed on the Afrimercato marketplace with enhanced visibility. All orders are managed directly in your vendor dashboard with real-time sync."})]})]})]})]})}function N3(e,r){if(!e)return!0;const t=["free","standard","premium","enterprise"];return t.indexOf(e)>=t.indexOf(r)}function _3({title:e,titleId:r,...t},n){return Te.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?Te.createElement("title",{id:r},e):null,Te.createElement("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25ZM12.75 6a.75.75 0 0 0-1.5 0v6c0 .414.336.75.75.75h4.5a.75.75 0 0 0 0-1.5h-3.75V6Z",clipRule:"evenodd"}))}const m1=Te.forwardRef(_3);function S3({title:e,titleId:r,...t},n){return Te.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?Te.createElement("title",{id:r},e):null,Te.createElement("path",{fillRule:"evenodd",d:"M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z",clipRule:"evenodd"}))}const g1=Te.forwardRef(S3);function A3({title:e,titleId:r,...t},n){return Te.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?Te.createElement("title",{id:r},e):null,Te.createElement("path",{fillRule:"evenodd",d:"m11.54 22.351.07.04.028.016a.76.76 0 0 0 .723 0l.028-.015.071-.041a16.975 16.975 0 0 0 1.144-.742 19.58 19.58 0 0 0 2.683-2.282c1.944-1.99 3.963-4.98 3.963-8.827a8.25 8.25 0 0 0-16.5 0c0 3.846 2.02 6.837 3.963 8.827a19.58 19.58 0 0 0 2.682 2.282 16.975 16.975 0 0 0 1.145.742ZM12 13.5a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z",clipRule:"evenodd"}))}const Vc=Te.forwardRef(A3);function j3({title:e,titleId:r,...t},n){return Te.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?Te.createElement("title",{id:r},e):null,Te.createElement("path",{fillRule:"evenodd",d:"M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z",clipRule:"evenodd"}))}const x1=Te.forwardRef(j3);function k3(){const e=qi(),[r,t]=Te.useState(""),[n,a]=Te.useState(!1),s=[{id:1,name:"Green Valley Farms",category:"Fresh Produce",image:"https://images.unsplash.com/photo-1542838132-92c53300491e?w=600",rating:4.8,deliveryTime:"20-30 min",minOrder:"Â£10",tags:["Vegetables","Fruits","Organic"]},{id:2,name:"African Spice Market",category:"African Groceries",image:"https://images.unsplash.com/photo-1488459716781-31db52582fe9?w=600",rating:4.9,deliveryTime:"25-35 min",minOrder:"Â£15",tags:["Spices","Grains","Authentic"]},{id:3,name:"Fresh Meat & Fish",category:"Butcher & Seafood",image:"https://images.unsplash.com/photo-1607623814075-e51df1bdc82f?w=600",rating:4.7,deliveryTime:"30-40 min",minOrder:"Â£20",tags:["Halal","Fresh Fish","Quality"]},{id:4,name:"Daily Dairy",category:"Dairy & Bakery",image:"https://images.unsplash.com/photo-1563636619-e9143da7973b?w=600",rating:4.6,deliveryTime:"15-25 min",minOrder:"Â£8",tags:["Milk","Cheese","Bread"]},{id:5,name:"Tropical Fruits Hub",category:"Exotic Fruits",image:"https://images.unsplash.com/photo-1619566636858-adf3ef46400b?w=600",rating:4.8,deliveryTime:"20-30 min",minOrder:"Â£12",tags:["Plantain","Mango","Yam"]},{id:6,name:"Lagos Kitchen Store",category:"Nigerian Foods",image:"https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=600",rating:4.9,deliveryTime:"25-35 min",minOrder:"Â£15",tags:["Nigerian","Palm Oil","Cassava"]}],l=c=>{c.preventDefault(),r.trim()&&e(`/stores?location=${encodeURIComponent(r)}`)};return o.jsxs("div",{className:"min-h-screen bg-white",children:[o.jsx("nav",{className:"bg-white border-b border-gray-200 sticky top-0 z-50 shadow-sm",children:o.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:[o.jsxs("div",{className:"flex justify-between items-center h-16",children:[o.jsxs(Et,{to:"/",className:"flex items-center space-x-2",children:[o.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-green-600 to-yellow-500 rounded-lg flex items-center justify-center",children:o.jsx("span",{className:"text-white font-bold text-lg",children:"ðŸ›’"})}),o.jsxs("span",{className:"text-xl font-bold text-gray-900",children:["Afri",o.jsx("span",{className:"text-green-600",children:"Hub"})]})]}),o.jsxs("div",{className:"hidden md:flex items-center space-x-6",children:[o.jsx("a",{href:"#stores",className:"text-gray-600 hover:text-green-600",children:"Browse Stores"}),o.jsx("a",{href:"#how-it-works",className:"text-gray-600 hover:text-green-600",children:"How It Works"}),o.jsx(Et,{to:"/partner",className:"text-gray-600 hover:text-green-600",children:"Partner With Us"}),o.jsx(Et,{to:"/login",className:"text-green-600 hover:text-green-700 font-medium",children:"Sign In"}),o.jsx(Et,{to:"/register?role=customer",className:"bg-green-600 hover:bg-green-700 text-white px-5 py-2 rounded-lg font-medium",children:"Sign Up"})]}),o.jsx("button",{onClick:()=>a(!n),className:"md:hidden p-2",children:o.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:n?"M6 18L18 6M6 6l12 12":"M4 6h16M4 12h16M4 18h16"})})})]}),n&&o.jsxs("div",{className:"md:hidden py-4 border-t",children:[o.jsx("a",{href:"#stores",className:"block py-2 text-gray-600",children:"Browse Stores"}),o.jsx("a",{href:"#how-it-works",className:"block py-2 text-gray-600",children:"How It Works"}),o.jsx(Et,{to:"/partner",className:"block py-2 text-gray-600",children:"Partner With Us"}),o.jsx(Et,{to:"/login",className:"block py-2 text-green-600 font-medium",children:"Sign In"}),o.jsx(Et,{to:"/register?role=customer",className:"block mt-2 bg-green-600 text-white px-4 py-2 rounded-lg text-center font-medium",children:"Sign Up"})]})]})}),o.jsxs("section",{className:"relative bg-gradient-to-br from-green-600 via-green-700 to-yellow-500 overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 opacity-10",children:o.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.4'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}})}),o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 py-16 sm:py-24 relative",children:o.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 items-center",children:[o.jsxs("div",{className:"text-center lg:text-left",children:[o.jsxs(ct.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-4xl sm:text-5xl lg:text-6xl font-bold text-white mb-6 leading-tight",children:["African Online Store",o.jsx("br",{}),o.jsx("span",{className:"text-yellow-300",children:"In the United Kingdom"})]}),o.jsx(ct.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"text-lg sm:text-xl text-white/95 mb-8 max-w-2xl mx-auto lg:mx-0",children:"Use existing infrastructure of African products you depend on delivered to your doorstep. Open stores, fresh products delivered to you whenever convenient."}),o.jsxs(ct.form,{onSubmit:l,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-2xl shadow-2xl p-3 flex flex-col sm:flex-row gap-3 max-w-2xl mx-auto lg:mx-0",children:[o.jsxs("div",{className:"flex-1 flex items-center gap-3 bg-gray-50 rounded-xl px-4 py-3",children:[o.jsx(Vc,{className:"w-6 h-6 text-green-600 flex-shrink-0"}),o.jsx("input",{type:"text",value:r,onChange:c=>t(c.target.value),placeholder:"Enter your location (e.g., London, Manchester)",className:"flex-1 bg-transparent border-none outline-none text-gray-900 placeholder-gray-500"})]}),o.jsxs("button",{type:"submit",className:"bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white px-8 py-3 rounded-xl font-bold shadow-lg flex items-center justify-center gap-2 transition-all",children:[o.jsx(g1,{className:"w-5 h-5"}),"Find Store"]})]}),o.jsxs(ct.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"mt-6 text-white/90 flex items-center justify-center lg:justify-start gap-2",children:[o.jsx("span",{className:"text-2xl",children:"ðŸ‘¥"}),o.jsxs("span",{className:"font-semibold",children:["Trusted by: ",o.jsx("span",{className:"text-yellow-300",children:"4,320+ Vendors"})]})]})]}),o.jsx(ct.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2},className:"hidden lg:block",children:o.jsx("img",{src:"https://images.unsplash.com/photo-1567393537607-1e1a6df6763a?w=800",alt:"Happy customer with groceries",className:"rounded-3xl shadow-2xl w-full object-cover"})})]})})]}),o.jsx("section",{className:"py-8 bg-gray-50 border-b",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4",children:o.jsx("div",{className:"flex gap-4 overflow-x-auto pb-2 scrollbar-hide",children:[{icon:"ðŸ¥¬",name:"Vegetables",color:"bg-green-100 text-green-700"},{icon:"ðŸŒ",name:"Fruits",color:"bg-yellow-100 text-yellow-700"},{icon:"ðŸ¥©",name:"Meat & Fish",color:"bg-red-100 text-red-700"},{icon:"ðŸ¥›",name:"Dairy",color:"bg-blue-100 text-blue-700"},{icon:"ðŸŒ¶ï¸",name:"Spices",color:"bg-orange-100 text-orange-700"},{icon:"ðŸŒ¾",name:"Grains",color:"bg-amber-100 text-amber-700"}].map((c,f)=>o.jsxs("button",{className:`${c.color} px-6 py-3 rounded-xl font-semibold whitespace-nowrap flex items-center gap-2 hover:scale-105 transition-transform`,children:[o.jsx("span",{className:"text-2xl",children:c.icon}),c.name]},f))})})}),o.jsx("section",{id:"stores",className:"py-16",children:o.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-8",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-2",children:"Browse Nearby"}),o.jsx("p",{className:"text-gray-600",children:"Popular stores in your area"})]}),o.jsxs("div",{className:"flex gap-4",children:[o.jsx("button",{className:"px-4 py-2 bg-green-600 text-white rounded-lg font-semibold",children:"Top Stores"}),o.jsx("button",{className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg font-semibold hover:bg-gray-200",children:"Featured Stores"})]})]}),o.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(c=>o.jsxs(ct.div,{whileHover:{y:-5},className:"bg-white rounded-2xl shadow-lg hover:shadow-xl border border-gray-100 overflow-hidden cursor-pointer transition-all",onClick:()=>e(`/store/${c.id}`),children:[o.jsxs("div",{className:"relative h-48",children:[o.jsx("img",{src:c.image,alt:c.name,className:"w-full h-full object-cover"}),o.jsxs("div",{className:"absolute top-3 right-3 bg-white px-3 py-1 rounded-full shadow-md flex items-center gap-1",children:[o.jsx(x1,{className:"w-4 h-4 text-yellow-500"}),o.jsx("span",{className:"font-bold text-gray-900",children:c.rating})]})]}),o.jsxs("div",{className:"p-5",children:[o.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:c.name}),o.jsx("p",{className:"text-sm text-gray-600 mb-3",children:c.category}),o.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:c.tags.slice(0,3).map((f,u)=>o.jsx("span",{className:"bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-xs font-medium",children:f},u))}),o.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 pt-3 border-t",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(m1,{className:"w-4 h-4"}),o.jsx("span",{children:c.deliveryTime})]}),o.jsxs("div",{className:"font-semibold text-gray-900",children:["Min. ",c.minOrder]})]})]})]},c.id))}),o.jsx("div",{className:"text-center mt-10",children:o.jsx("button",{className:"bg-green-600 hover:bg-green-700 text-white px-8 py-3 rounded-xl font-bold shadow-lg",children:"View All Stores"})})]})}),o.jsx("section",{id:"how-it-works",className:"py-16 bg-gradient-to-br from-green-50 to-yellow-50",children:o.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[o.jsxs("div",{className:"text-center mb-12",children:[o.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-2",children:"How It Works"}),o.jsx("p",{className:"text-lg text-gray-600",children:"Get fresh African groceries delivered in 3 simple steps"})]}),o.jsx("div",{className:"grid sm:grid-cols-3 gap-8",children:[{num:1,icon:"ðŸ”",title:"Find Stores Near You",desc:"Enter your location and browse stores in your area"},{num:2,icon:"ðŸ›’",title:"Add to Cart",desc:"Choose products from multiple vendors in one order"},{num:3,icon:"ðŸšš",title:"Fast Delivery",desc:"Get your groceries delivered same-day"}].map(c=>o.jsxs(ct.div,{className:"text-center",whileHover:{y:-5},children:[o.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-green-500 to-green-700 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg",children:o.jsx("span",{className:"text-4xl",children:c.icon})}),o.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:c.title}),o.jsx("p",{className:"text-gray-600",children:c.desc})]},c.num))})]})}),o.jsx("section",{className:"bg-gradient-to-r from-yellow-400 via-yellow-500 to-green-600 py-16",children:o.jsxs("div",{className:"max-w-4xl mx-auto px-4 text-center",children:[o.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-4",children:"Are You a Food Vendor?"}),o.jsx("p",{className:"text-lg text-gray-800 mb-8",children:"Join 4,320+ vendors already selling on AfriHub. Reach thousands of customers and grow your business online."}),o.jsx(Et,{to:"/partner",className:"inline-block bg-gray-900 text-white hover:bg-gray-800 px-10 py-4 rounded-xl font-bold shadow-2xl text-lg",children:"Partner With Us â†’"})]})}),o.jsx("footer",{className:"bg-gray-900 text-gray-300 py-12",children:o.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[o.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-8",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"text-white font-bold mb-4",children:"AfriHub"}),o.jsx("p",{className:"text-sm",children:"African groceries delivered to your door across the UK."})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-white font-bold mb-4",children:"For Customers"}),o.jsxs("ul",{className:"space-y-2 text-sm",children:[o.jsx("li",{children:o.jsx("a",{href:"#stores",className:"hover:text-yellow-400",children:"Browse Stores"})}),o.jsx("li",{children:o.jsx("a",{href:"#how-it-works",className:"hover:text-yellow-400",children:"How It Works"})}),o.jsx("li",{children:o.jsx(Et,{to:"/register?role=customer",className:"hover:text-yellow-400",children:"Sign Up"})})]})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-white font-bold mb-4",children:"For Partners"}),o.jsxs("ul",{className:"space-y-2 text-sm",children:[o.jsx("li",{children:o.jsx(Et,{to:"/partner",className:"hover:text-yellow-400",children:"Become a Vendor"})}),o.jsx("li",{children:o.jsx(Et,{to:"/register?role=rider",className:"hover:text-yellow-400",children:"Become a Rider"})}),o.jsx("li",{children:o.jsx(Et,{to:"/register?role=picker",className:"hover:text-yellow-400",children:"Become a Picker"})})]})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-white font-bold mb-4",children:"Company"}),o.jsxs("ul",{className:"space-y-2 text-sm",children:[o.jsx("li",{children:o.jsx("a",{href:"#",className:"hover:text-yellow-400",children:"About Us"})}),o.jsx("li",{children:o.jsx("a",{href:"#",className:"hover:text-yellow-400",children:"Contact"})}),o.jsx("li",{children:o.jsx("a",{href:"#",className:"hover:text-yellow-400",children:"Privacy Policy"})})]})]})]}),o.jsx("div",{className:"border-t border-gray-800 mt-8 pt-8 text-center text-sm",children:o.jsx("p",{children:"Â© 2025 AfriHub. All rights reserved."})})]})})]})}function T3({title:e,titleId:r,...t},n){return Te.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?Te.createElement("title",{id:r},e):null,Te.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const E3=Te.forwardRef(T3);function F3({title:e,titleId:r,...t},n){return Te.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?Te.createElement("title",{id:r},e):null,Te.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const lu=Te.forwardRef(F3);function C3({title:e,titleId:r,...t},n){return Te.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?Te.createElement("title",{id:r},e):null,Te.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 1.5H8.25A2.25 2.25 0 0 0 6 3.75v16.5a2.25 2.25 0 0 0 2.25 2.25h7.5A2.25 2.25 0 0 0 18 20.25V3.75a2.25 2.25 0 0 0-2.25-2.25H13.5m-3 0V3h3V1.5m-3 0h3m-3 18.75h3"}))}const L3=Te.forwardRef(C3);function P3({title:e,titleId:r,...t},n){return Te.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?Te.createElement("title",{id:r},e):null,Te.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 10.5V6a3.75 3.75 0 1 0-7.5 0v4.5m11.356-1.993 1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 0 1-1.12-1.243l1.264-12A1.125 1.125 0 0 1 5.513 7.5h12.974c.576 0 1.059.435 1.119 1.007ZM8.625 10.5a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm7.5 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const O3=Te.forwardRef(P3);function I3({title:e,titleId:r,...t},n){return Te.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?Te.createElement("title",{id:r},e):null,Te.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 18.75a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 0 1-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h1.125c.621 0 1.129-.504 1.09-1.124a17.902 17.902 0 0 0-3.213-9.193 2.056 2.056 0 0 0-1.58-.86H14.25M16.5 18.75h-2.25m0-11.177v-.958c0-.568-.422-1.048-.987-1.106a48.554 48.554 0 0 0-10.026 0 1.106 1.106 0 0 0-.987 1.106v7.635m12-6.677v6.677m0 4.5v-4.5m0 0h-12"}))}const D3=Te.forwardRef(I3);function R3({title:e,titleId:r,...t},n){return Te.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?Te.createElement("title",{id:r},e):null,Te.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"}))}const M3=Te.forwardRef(R3);function B3(){const e=[{icon:O3,title:"Reach Thousands of Customers",description:"Get your products in front of 4,320+ active shoppers looking for African groceries."},{icon:E3,title:"Grow Your Business Online",description:"Track sales, manage inventory, and grow your revenue with our easy-to-use vendor dashboard."},{icon:L3,title:"Easy Store Management",description:"Manage your store from anywhere with our mobile-friendly vendor dashboard."},{icon:D3,title:"We Handle Delivery",description:"Focus on preparing quality products. Our riders handle pickup and delivery to customers."},{icon:M3,title:"Dedicated Support",description:"24/7 support to help you succeed. We're here to answer questions and solve problems."},{icon:lu,title:"Verified & Trusted",description:"Join a trusted marketplace where quality vendors are verified and customer trust is high."}],r=[{number:1,title:"Submit Application",description:"Fill out the vendor application form with your business details and documents.",color:"from-green-500 to-green-600"},{number:2,title:"Verification Process",description:"Our team reviews your application and verifies your business credentials (1-3 business days).",color:"from-yellow-500 to-yellow-600"},{number:3,title:"Set Up Your Store",description:"Once approved, set up your store profile, add products, and configure delivery settings.",color:"from-green-600 to-green-700"},{number:4,title:"Start Selling",description:"Go live and start receiving orders from customers in your area!",color:"from-yellow-600 to-yellow-700"}],t=["Valid business registration or tax ID","Proof of address (business location)","Food safety/handling certification (for food vendors)","Bank account for receiving payments","High-quality photos of your products","Commitment to quality and customer service"],n=[{q:"How much does it cost to join?",a:"Joining AfriHub is free! We charge a small commission (12-15%) on each sale to cover platform costs, payment processing, and support."},{q:"How long does verification take?",a:"Verification typically takes 1-3 business days. We'll review your documents and get back to you via email."},{q:"What products can I sell?",a:"You can sell fresh produce, meats, dairy, African foods, spices, grains, and packaged goods. All products must meet UK food safety standards."},{q:"How do I receive payments?",a:"Payments are processed through Paystack and deposited directly to your bank account weekly."},{q:"Can I manage multiple stores?",a:"Yes! You can manage multiple store locations from a single vendor account."}];return o.jsxs("div",{className:"min-h-screen bg-white",children:[o.jsx("nav",{className:"bg-white border-b border-gray-200 sticky top-0 z-50 shadow-sm",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:o.jsxs("div",{className:"flex justify-between items-center h-16",children:[o.jsxs(Et,{to:"/",className:"flex items-center space-x-2",children:[o.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-green-600 to-yellow-500 rounded-lg flex items-center justify-center",children:o.jsx("span",{className:"text-white font-bold text-lg",children:"ðŸ›’"})}),o.jsxs("span",{className:"text-xl font-bold text-gray-900",children:["Afri",o.jsx("span",{className:"text-green-600",children:"Hub"})]})]}),o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx(Et,{to:"/",className:"text-gray-600 hover:text-green-600",children:"Home"}),o.jsx(Et,{to:"/login",className:"text-green-600 hover:text-green-700 font-medium",children:"Vendor Sign In"})]})]})})}),o.jsx("section",{className:"bg-gradient-to-br from-green-600 via-green-700 to-yellow-500 py-20",children:o.jsxs("div",{className:"max-w-7xl mx-auto px-4 text-center",children:[o.jsx(ct.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-4xl sm:text-5xl lg:text-6xl font-bold text-white mb-6",children:"Grow Your Food Business with AfriHub"}),o.jsx(ct.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"text-xl text-white/95 mb-8 max-w-3xl mx-auto",children:"Join 4,320+ vendors already selling African groceries and reaching thousands of customers across the UK."}),o.jsxs(ct.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"flex flex-col sm:flex-row gap-4 justify-center",children:[o.jsx(Et,{to:"/register?role=vendor",className:"bg-yellow-400 text-gray-900 hover:bg-yellow-300 px-10 py-4 rounded-xl font-bold text-lg shadow-2xl inline-flex items-center justify-center gap-2",children:"Apply Now â†’"}),o.jsx("a",{href:"#how-it-works",className:"bg-white/10 backdrop-blur text-white hover:bg-white/20 px-10 py-4 rounded-xl font-bold text-lg border-2 border-white/30 inline-flex items-center justify-center",children:"Learn More"})]}),o.jsx("div",{className:"grid grid-cols-3 gap-8 max-w-3xl mx-auto mt-16",children:[{value:"4,320+",label:"Active Vendors"},{value:"Â£2.5M+",label:"Monthly Sales"},{value:"98%",label:"Satisfaction Rate"}].map((a,s)=>o.jsxs(ct.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:.3+s*.1},className:"text-center",children:[o.jsx("div",{className:"text-3xl sm:text-4xl font-bold text-white mb-2",children:a.value}),o.jsx("div",{className:"text-sm text-white/80",children:a.label})]},s))})]})}),o.jsx("section",{className:"py-20 bg-gray-50",children:o.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[o.jsxs("div",{className:"text-center mb-12",children:[o.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-4",children:"Why Sell on AfriHub?"}),o.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Everything you need to run a successful online grocery business"})]}),o.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-8",children:e.map((a,s)=>o.jsxs(ct.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:s*.1},className:"bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all",children:[o.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-green-500 to-green-700 rounded-xl flex items-center justify-center mb-4",children:o.jsx(a.icon,{className:"w-8 h-8 text-white"})}),o.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:a.title}),o.jsx("p",{className:"text-gray-600",children:a.description})]},s))})]})}),o.jsx("section",{id:"how-it-works",className:"py-20",children:o.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[o.jsxs("div",{className:"text-center mb-12",children:[o.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-4",children:"How to Get Started"}),o.jsx("p",{className:"text-lg text-gray-600",children:"Simple 4-step process to start selling"})]}),o.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-8",children:r.map((a,s)=>o.jsxs(ct.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:s*.1},className:"text-center",children:[o.jsx("div",{className:`w-20 h-20 bg-gradient-to-br ${a.color} rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg`,children:o.jsx("span",{className:"text-3xl font-bold text-white",children:a.number})}),o.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:a.title}),o.jsx("p",{className:"text-gray-600 text-sm",children:a.description})]},s))})]})}),o.jsx("section",{className:"py-20 bg-gray-50",children:o.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[o.jsxs("div",{className:"text-center mb-12",children:[o.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-4",children:"What You'll Need"}),o.jsx("p",{className:"text-lg text-gray-600",children:"Requirements for vendor verification"})]}),o.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:o.jsx("ul",{className:"space-y-4",children:t.map((a,s)=>o.jsxs("li",{className:"flex items-start gap-3",children:[o.jsx(lu,{className:"w-6 h-6 text-green-600 flex-shrink-0 mt-0.5"}),o.jsx("span",{className:"text-gray-700",children:a})]},s))})})]})}),o.jsx("section",{className:"py-20",children:o.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[o.jsx("div",{className:"text-center mb-12",children:o.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-4",children:"Frequently Asked Questions"})}),o.jsx("div",{className:"space-y-6",children:n.map((a,s)=>o.jsxs(ct.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:s*.1},className:"bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition-all",children:[o.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:a.q}),o.jsx("p",{className:"text-gray-600",children:a.a})]},s))})]})}),o.jsx("section",{className:"bg-gradient-to-r from-green-600 via-green-700 to-yellow-500 py-20",children:o.jsxs("div",{className:"max-w-4xl mx-auto px-4 text-center",children:[o.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-white mb-6",children:"Ready to Start Selling?"}),o.jsx("p",{className:"text-xl text-white/95 mb-8",children:"Join thousands of vendors growing their business on AfriHub"}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[o.jsx(Et,{to:"/register?role=vendor",className:"bg-yellow-400 text-gray-900 hover:bg-yellow-300 px-10 py-4 rounded-xl font-bold text-lg shadow-2xl inline-flex items-center justify-center gap-2",children:"Apply as Vendor â†’"}),o.jsx(Et,{to:"/login",className:"bg-white text-green-700 hover:bg-gray-100 px-10 py-4 rounded-xl font-bold text-lg shadow-2xl inline-flex items-center justify-center",children:"Already a Vendor? Sign In"})]})]})}),o.jsx("footer",{className:"bg-gray-900 text-gray-300 py-12",children:o.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[o.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-8",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"text-white font-bold mb-4",children:"AfriHub"}),o.jsx("p",{className:"text-sm",children:"African groceries delivered to your door across the UK."})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-white font-bold mb-4",children:"For Customers"}),o.jsxs("ul",{className:"space-y-2 text-sm",children:[o.jsx("li",{children:o.jsx(Et,{to:"/",className:"hover:text-yellow-400",children:"Browse Stores"})}),o.jsx("li",{children:o.jsx(Et,{to:"/#how-it-works",className:"hover:text-yellow-400",children:"How It Works"})})]})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-white font-bold mb-4",children:"For Partners"}),o.jsxs("ul",{className:"space-y-2 text-sm",children:[o.jsx("li",{children:o.jsx(Et,{to:"/partner",className:"hover:text-yellow-400",children:"Become a Vendor"})}),o.jsx("li",{children:o.jsx(Et,{to:"/register?role=rider",className:"hover:text-yellow-400",children:"Become a Rider"})})]})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-white font-bold mb-4",children:"Company"}),o.jsxs("ul",{className:"space-y-2 text-sm",children:[o.jsx("li",{children:o.jsx("a",{href:"#",className:"hover:text-yellow-400",children:"About"})}),o.jsx("li",{children:o.jsx("a",{href:"#",className:"hover:text-yellow-400",children:"Contact"})})]})]})]}),o.jsx("div",{className:"border-t border-gray-800 mt-8 pt-8 text-center text-sm",children:o.jsx("p",{children:"Â© 2025 AfriHub. All rights reserved."})})]})})]})}function U3(){const[e]=n2(),r=e.get("location")||"",t=qi(),[n,a]=Te.useState([]),[s,l]=Te.useState(!0),[c,f]=Te.useState(r);Te.useEffect(()=>{u()},[r]);const u=async()=>{var x;try{l(!0);const p=await U2(r,50);p.success&&((x=p.data)!=null&&x.vendors)&&p.data.vendors.length>0?a(p.data.vendors):a(d(r))}catch(p){console.log("Using sample stores:",p.message),a(d(r))}finally{l(!1)}},d=x=>{const p=[{id:1,name:"Green Valley Farms",category:"Fresh Produce",image:"https://images.unsplash.com/photo-1542838132-92c53300491e?w=600",rating:4.8,deliveryTime:"20-30 min",minOrder:"Â£10",tags:["Vegetables","Fruits","Organic"],location:"London",address:"123 High Street, London E1 6AN"},{id:2,name:"African Spice Market",category:"African Groceries",image:"https://images.unsplash.com/photo-1488459716781-31db52582fe9?w=600",rating:4.9,deliveryTime:"25-35 min",minOrder:"Â£15",tags:["Spices","Grains","Authentic"],location:"London",address:"45 Peckham High St, London SE15"},{id:3,name:"Lagos Kitchen Store",category:"Nigerian Foods",image:"https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=600",rating:4.9,deliveryTime:"25-35 min",minOrder:"Â£15",tags:["Nigerian","Palm Oil","Cassava"],location:"London",address:"78 Brixton Road, London SW9"},{id:4,name:"Tropical Fruits Hub",category:"Exotic Fruits",image:"https://images.unsplash.com/photo-1619566636858-adf3ef46400b?w=600",rating:4.8,deliveryTime:"20-30 min",minOrder:"Â£12",tags:["Plantain","Mango","Yam"],location:"London",address:"12 Ridley Road Market, London E8"},{id:5,name:"Hackney Fresh Foods",category:"Fresh Produce",image:"https://images.unsplash.com/photo-1542838132-92c53300491e?w=600",rating:4.7,deliveryTime:"20-30 min",minOrder:"Â£10",tags:["Vegetables","Fruits"],location:"London",address:"Hackney Market, London E8 5RT"},{id:6,name:"Manchester African Market",category:"African Groceries",image:"https://images.unsplash.com/photo-1488459716781-31db52582fe9?w=600",rating:4.6,deliveryTime:"30-40 min",minOrder:"Â£12",tags:["African","Spices","Grains"],location:"Manchester",address:"34 Cheetham Hill Road, Manchester M8"},{id:7,name:"Moss Side Grocers",category:"Fresh Produce",image:"https://images.unsplash.com/photo-1542838132-92c53300491e?w=600",rating:4.5,deliveryTime:"25-35 min",minOrder:"Â£10",tags:["Vegetables","Fruits"],location:"Manchester",address:"56 Great Western Street, Manchester M14"},{id:8,name:"Afro-Caribbean Store MCR",category:"Caribbean Foods",image:"https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=600",rating:4.7,deliveryTime:"30-40 min",minOrder:"Â£15",tags:["Caribbean","Plantain","Rice"],location:"Manchester",address:"89 Princess Road, Manchester M14"},{id:9,name:"Handsworth African Foods",category:"African Groceries",image:"https://images.unsplash.com/photo-1488459716781-31db52582fe9?w=600",rating:4.8,deliveryTime:"20-30 min",minOrder:"Â£10",tags:["African","Fresh","Halal"],location:"Birmingham",address:"23 Soho Road, Birmingham B21"},{id:10,name:"Birmingham Tropical Market",category:"Tropical Foods",image:"https://images.unsplash.com/photo-1619566636858-adf3ef46400b?w=600",rating:4.6,deliveryTime:"25-35 min",minOrder:"Â£12",tags:["Plantain","Yam","Cassava"],location:"Birmingham",address:"45 Stratford Road, Birmingham B11"},{id:11,name:"Bristol African Store",category:"African Groceries",image:"https://images.unsplash.com/photo-1488459716781-31db52582fe9?w=600",rating:4.7,deliveryTime:"30-40 min",minOrder:"Â£12",tags:["African","Caribbean","Fresh"],location:"Bristol",address:"12 Stapleton Road, Bristol BS5"},{id:12,name:"St Pauls Fresh Market",category:"Fresh Produce",image:"https://images.unsplash.com/photo-1542838132-92c53300491e?w=600",rating:4.5,deliveryTime:"25-35 min",minOrder:"Â£10",tags:["Vegetables","Fruits"],location:"Bristol",address:"34 Grosvenor Road, Bristol BS2"},{id:13,name:"Leeds African Groceries",category:"African Foods",image:"https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=600",rating:4.6,deliveryTime:"30-40 min",minOrder:"Â£12",tags:["African","Spices","Grains"],location:"Leeds",address:"67 Harehills Lane, Leeds LS8"},{id:14,name:"Chapeltown Fresh Foods",category:"Fresh Produce",image:"https://images.unsplash.com/photo-1542838132-92c53300491e?w=600",rating:4.5,deliveryTime:"25-35 min",minOrder:"Â£10",tags:["Vegetables","Fruits"],location:"Leeds",address:"89 Chapeltown Road, Leeds LS7"},{id:15,name:"Liverpool African Market",category:"African Groceries",image:"https://images.unsplash.com/photo-1488459716781-31db52582fe9?w=600",rating:4.7,deliveryTime:"30-40 min",minOrder:"Â£15",tags:["African","Caribbean","Halal"],location:"Liverpool",address:"45 Granby Street, Liverpool L8"},{id:16,name:"Toxteth Tropical Foods",category:"Tropical Foods",image:"https://images.unsplash.com/photo-1619566636858-adf3ef46400b?w=600",rating:4.6,deliveryTime:"25-35 min",minOrder:"Â£12",tags:["Plantain","Yam"],location:"Liverpool",address:"23 Upper Parliament Street, Liverpool L8"}];if(x){const w=p.filter(v=>v.location.toLowerCase().includes(x.toLowerCase())||v.address.toLowerCase().includes(x.toLowerCase()));return w.length>0?w:p.slice(0,6)}return p},g=x=>{x.preventDefault(),c.trim()&&t(`/stores?location=${encodeURIComponent(c)}`)};return o.jsxs("div",{className:"min-h-screen bg-white",children:[o.jsx("nav",{className:"bg-white border-b border-gray-200 sticky top-0 z-50 shadow-sm",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:o.jsxs("div",{className:"flex justify-between items-center h-16",children:[o.jsxs(Et,{to:"/",className:"flex items-center space-x-2",children:[o.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-green-600 to-yellow-500 rounded-lg flex items-center justify-center",children:o.jsx("span",{className:"text-white font-bold text-lg",children:"ðŸ›’"})}),o.jsxs("span",{className:"text-xl font-bold text-gray-900",children:["Afri",o.jsx("span",{className:"text-green-600",children:"Hub"})]})]}),o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx(Et,{to:"/",className:"text-gray-600 hover:text-green-600",children:"Home"}),o.jsx(Et,{to:"/partner",className:"text-gray-600 hover:text-green-600",children:"Partner With Us"}),o.jsx(Et,{to:"/login",className:"text-green-600 hover:text-green-700 font-medium",children:"Sign In"})]})]})})}),o.jsx("section",{className:"bg-gradient-to-br from-green-600 to-green-700 py-12",children:o.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[o.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-white mb-4 text-center",children:"Find African Stores Near You"}),o.jsxs("form",{onSubmit:g,className:"max-w-2xl mx-auto bg-white rounded-2xl shadow-2xl p-3 flex flex-col sm:flex-row gap-3",children:[o.jsxs("div",{className:"flex-1 flex items-center gap-3 bg-gray-50 rounded-xl px-4 py-3",children:[o.jsx(Vc,{className:"w-6 h-6 text-green-600 flex-shrink-0"}),o.jsx("input",{type:"text",value:c,onChange:x=>f(x.target.value),placeholder:"Enter location (London, Manchester, Birmingham...)",className:"flex-1 bg-transparent border-none outline-none text-gray-900 placeholder-gray-500"})]}),o.jsxs("button",{type:"submit",className:"bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white px-8 py-3 rounded-xl font-bold shadow-lg flex items-center justify-center gap-2",children:[o.jsx(g1,{className:"w-5 h-5"}),"Search"]})]})]})}),o.jsx("section",{className:"py-12",children:o.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:[o.jsxs("div",{className:"mb-8",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:r?`Stores in ${r}`:"All Stores"}),o.jsx("p",{className:"text-gray-600",children:s?"Searching...":`${n.length} stores found`})]}),s&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),o.jsx("p",{className:"text-gray-600 mt-4",children:"Finding stores..."})]}),!s&&n.length===0&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"text-6xl mb-4",children:"ðŸ˜”"}),o.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"No stores found in this area"}),o.jsx("p",{className:"text-gray-600 mb-6",children:"Try searching for London, Manchester, or Birmingham"}),o.jsx(Et,{to:"/",className:"text-green-600 hover:text-green-700 font-semibold",children:"â† Back to Home"})]}),!s&&n.length>0&&o.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(x=>{var p;return o.jsxs(ct.div,{whileHover:{y:-5},className:"bg-white rounded-2xl shadow-lg hover:shadow-xl border border-gray-100 overflow-hidden cursor-pointer transition-all",onClick:()=>t(`/store/${x.id}`),children:[o.jsxs("div",{className:"relative h-48",children:[o.jsx("img",{src:x.image,alt:x.name,className:"w-full h-full object-cover"}),o.jsxs("div",{className:"absolute top-3 right-3 bg-white px-3 py-1 rounded-full shadow-md flex items-center gap-1",children:[o.jsx(x1,{className:"w-4 h-4 text-yellow-500"}),o.jsx("span",{className:"font-bold text-gray-900",children:x.rating})]})]}),o.jsxs("div",{className:"p-5",children:[o.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:x.name}),o.jsx("p",{className:"text-sm text-gray-600 mb-1",children:x.category}),o.jsxs("p",{className:"text-xs text-gray-500 mb-3 flex items-center gap-1",children:[o.jsx(Vc,{className:"w-3 h-3"}),x.address||x.location]}),o.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:(p=x.tags)==null?void 0:p.slice(0,3).map((w,v)=>o.jsx("span",{className:"bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-xs font-medium",children:w},v))}),o.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 pt-3 border-t",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(m1,{className:"w-4 h-4"}),o.jsx("span",{children:x.deliveryTime})]}),o.jsxs("div",{className:"font-semibold text-gray-900",children:["Min. ",x.minOrder]})]})]})]},x.id)})})]})})]})}function H3(){const{vendorId:e}=a2(),r=qi(),[t,n]=Te.useState(null),[a,s]=Te.useState([]),[l,c]=Te.useState(["All"]),[f,u]=Te.useState("All"),[d,g]=Te.useState(!0),[x,p]=Te.useState(null),[w,v]=Te.useState([]),[_,S]=Te.useState(!1),[b,A]=Te.useState("");Te.useEffect(()=>{E()},[e]);const E=async()=>{var k;try{g(!0),p(null);const T=await H2(e);n(T.data||T);const H=await W2(e),G=((k=H.data)==null?void 0:k.products)||H.products||[];s(G);const ce=["All",...new Set(G.map(J=>J.category).filter(Boolean))];c(ce)}catch(T){console.error("Error fetching vendor:",T),p(T.message||"Failed to load store")}finally{g(!1)}},U=k=>{const T=w.find(H=>H._id===k._id);v(T?w.map(H=>H._id===k._id?{...H,quantity:H.quantity+1}:H):[...w,{...k,quantity:1}]),S(!0)},R=(k,T)=>{T<=0?L(k):v(w.map(H=>H._id===k?{...H,quantity:T}:H))},L=k=>{v(w.filter(T=>T._id!==k))},C=w.reduce((k,T)=>k+T.price*T.quantity,0),P=w.reduce((k,T)=>k+T.quantity,0),W=a.filter(k=>{const T=f==="All"||k.category===f,H=k.name.toLowerCase().includes(b.toLowerCase());return T&&H&&k.inStock});return d?o.jsx("div",{className:"min-h-screen flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-4 border-b-4 border-[#FFB300] mx-auto"}),o.jsx("p",{className:"text-gray-600 mt-4",children:"Loading store..."})]})}):x||!t?o.jsx("div",{className:"min-h-screen flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-2xl mb-4",children:"ðŸ˜”"}),o.jsx("p",{className:"text-gray-600 mb-4",children:x||"Store not found"}),o.jsx("button",{onClick:()=>r("/stores"),className:"bg-[#FFB300] text-white px-6 py-2 rounded-lg hover:bg-[#FFA726] transition",children:"Browse All Stores"})]})}):o.jsxs("div",{className:"min-h-screen bg-gray-50",children:[o.jsx("header",{className:"bg-white border-b sticky top-0 z-40 shadow-sm",children:o.jsx("div",{className:"container mx-auto px-6 py-4",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("button",{onClick:()=>r(-1),className:"text-gray-600 hover:text-gray-900",children:"â¬…ï¸ Go Back"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-2xl",children:"ðŸ›’"}),o.jsx("span",{className:"text-xl font-bold text-gray-900",children:"AfriHub"})]})]}),o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("button",{onClick:()=>r("/login"),className:"text-gray-600 hover:text-gray-900",children:"ðŸ‘¤ Account"}),o.jsxs("button",{onClick:()=>S(!_),className:"relative bg-[#FFB300] text-white px-4 py-2 rounded-lg hover:bg-[#FFA726] transition",children:["ðŸ›’ Cart",P>0&&o.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold",children:P})]})]})]})})}),o.jsx("div",{className:"bg-gradient-to-r from-[#E0F7F4] to-[#FFF4E0] py-12",children:o.jsx("div",{className:"container mx-auto px-6",children:o.jsxs("div",{className:"grid md:grid-cols-2 gap-8 items-center",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-5xl font-bold text-gray-900 mb-2",children:t.storeName||t.businessName}),o.jsx("p",{className:"text-2xl text-gray-600 mb-4",children:"Got You."}),o.jsx("p",{className:"text-lg text-[#00897B] font-semibold mb-6",children:"Save up to 60% off on your first order"}),o.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-600",children:[o.jsx("span",{children:"ðŸ›ï¸ Shopping Method: In-Shopping, Delivery"}),o.jsx("span",{children:"âš¡ Deliveries in 20-30 mins"}),o.jsxs("span",{children:["ðŸ“ž ",t.phone||"+44 - 2071 - 234567"]})]})]}),o.jsx("div",{className:"hidden md:block",children:o.jsx("img",{src:rp(t),alt:t.storeName||t.businessName,className:"rounded-2xl shadow-xl w-full h-64 object-cover"})})]})})}),o.jsx("div",{className:"bg-white border-b sticky top-16 z-30",children:o.jsx("div",{className:"container mx-auto px-6 py-4",children:o.jsxs("div",{className:"flex items-center justify-between gap-4",children:[o.jsx("div",{className:"flex gap-4 overflow-x-auto",children:l.map(k=>o.jsx("button",{onClick:()=>u(k),className:`px-4 py-2 font-semibold whitespace-nowrap transition ${f===k?"text-[#FFB300] border-b-2 border-[#FFB300]":"text-gray-600 hover:text-gray-900"}`,children:k},k))}),o.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg px-4 py-2 min-w-[200px]",children:[o.jsx("span",{children:"ðŸ”"}),o.jsx("input",{type:"text",placeholder:"Search products...",value:b,onChange:k=>A(k.target.value),className:"bg-transparent outline-none flex-1"})]})]})})}),o.jsxs("div",{className:"container mx-auto px-6 py-8",children:[o.jsxs("div",{className:"mb-12",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:f==="All"?"All Products":f}),W.length===0?o.jsx("div",{className:"text-center py-12",children:o.jsx("p",{className:"text-gray-600",children:"No products found"})}):o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:W.map(k=>o.jsx(W3,{product:k,onAddToCart:()=>U(k)},k._id))})]}),o.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mb-12",children:[o.jsxs("div",{className:"bg-gradient-to-r from-[#00897B] to-[#00695C] text-white p-6 rounded-xl",children:[o.jsx("h3",{className:"text-xl font-bold mb-2",children:"Free delivery"}),o.jsx("p",{className:"mb-4",children:"over Â£50"}),o.jsx("button",{className:"bg-white text-[#00897B] px-4 py-2 rounded-lg font-semibold hover:bg-gray-100 transition",children:"Shop Now â†’"})]}),o.jsxs("div",{className:"bg-gradient-to-r from-[#FFB300] to-[#FFA726] text-white p-6 rounded-xl",children:[o.jsx("h3",{className:"text-xl font-bold mb-2",children:"60% off"}),o.jsx("p",{className:"mb-4",children:"Organic Food"}),o.jsx("button",{className:"bg-white text-[#FFB300] px-4 py-2 rounded-lg font-semibold hover:bg-gray-100 transition",children:"Order Now â†’"})]}),o.jsxs("div",{className:"bg-gradient-to-r from-[#00897B] to-[#00695C] text-white p-6 rounded-xl",children:[o.jsx("h3",{className:"text-xl font-bold mb-2",children:"Free delivery"}),o.jsx("p",{className:"mb-4",children:"Shop Â£50 get..."}),o.jsx("button",{className:"bg-white text-[#00897B] px-4 py-2 rounded-lg font-semibold hover:bg-gray-100 transition",children:"Shop Now â†’"})]})]})]}),_&&o.jsxs("div",{className:"fixed inset-0 z-50 flex",children:[o.jsx("div",{onClick:()=>S(!1),className:"flex-1 bg-black/50"}),o.jsx("div",{className:"w-full max-w-md bg-white shadow-2xl overflow-y-auto",children:o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Shopping Cart"}),o.jsx("button",{onClick:()=>S(!1),className:"text-gray-400 hover:text-gray-600 text-2xl",children:"âœ•"})]}),w.length===0?o.jsxs("div",{className:"text-center py-12",children:[o.jsx("p",{className:"text-2xl mb-2",children:"ðŸ›’"}),o.jsx("p",{className:"text-gray-600",children:"Your cart is empty"})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"space-y-4 mb-6",children:w.map(k=>o.jsxs("div",{className:"flex gap-4 border-b pb-4",children:[o.jsx("img",{src:uu(k),alt:k.name,className:"w-20 h-20 object-cover rounded-lg"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"font-semibold text-gray-900",children:k.name}),o.jsxs("p",{className:"text-sm text-gray-600",children:["Â£",k.price.toFixed(2)]}),o.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[o.jsx("button",{onClick:()=>R(k._id,k.quantity-1),className:"w-6 h-6 bg-gray-200 rounded hover:bg-gray-300 transition",children:"-"}),o.jsx("span",{className:"font-semibold",children:k.quantity}),o.jsx("button",{onClick:()=>R(k._id,k.quantity+1),className:"w-6 h-6 bg-gray-200 rounded hover:bg-gray-300 transition",children:"+"}),o.jsx("button",{onClick:()=>L(k._id),className:"ml-auto text-red-500 hover:text-red-700",children:"ðŸ—‘ï¸"})]})]})]},k._id))}),o.jsxs("div",{className:"border-t pt-4 mb-6",children:[o.jsxs("div",{className:"flex justify-between mb-2",children:[o.jsx("span",{className:"text-gray-600",children:"Subtotal:"}),o.jsxs("span",{className:"font-semibold",children:["Â£",C.toFixed(2)]})]}),o.jsxs("div",{className:"flex justify-between mb-2",children:[o.jsx("span",{className:"text-gray-600",children:"Delivery:"}),o.jsxs("span",{className:"font-semibold",children:["Â£",C>=50?"0.00":"5.00"]})]}),o.jsxs("div",{className:"flex justify-between text-xl font-bold border-t pt-2",children:[o.jsx("span",{children:"Total:"}),o.jsxs("span",{children:["Â£",(C+(C>=50?0:5)).toFixed(2)]})]})]}),o.jsx("button",{onClick:()=>r("/checkout"),className:"w-full bg-gradient-to-r from-[#FFB300] to-[#FFA726] text-white py-4 rounded-lg font-bold text-lg hover:shadow-lg transition",children:"Proceed to Checkout"})]})]})})]}),o.jsx("footer",{className:"bg-[#1A1A1A] text-white py-8",children:o.jsx("div",{className:"container mx-auto px-6 text-center",children:o.jsx("p",{className:"text-gray-400",children:"Â© 2025 AfriHub. All rights reserved."})})})]})}function W3({product:e,onAddToCart:r}){const[t,n]=Te.useState(!1),a=()=>{r(),n(!0),setTimeout(()=>n(!1),1e3)};return o.jsxs("div",{className:"bg-white rounded-xl shadow-md hover:shadow-xl transition overflow-hidden group",children:[o.jsxs("div",{className:"relative h-40 bg-gray-100 overflow-hidden",children:[o.jsx("img",{src:uu(e),alt:e.name,className:"w-full h-full object-cover group-hover:scale-110 transition duration-300"}),e.discount>0&&o.jsxs("span",{className:"absolute top-2 right-2 bg-red-500 text-white px-2 py-1 rounded-full text-xs font-bold",children:["-",e.discount,"%"]})]}),o.jsxs("div",{className:"p-4",children:[o.jsx("p",{className:"text-xs text-gray-500 mb-1",children:e.category}),o.jsx("h3",{className:"font-semibold text-gray-900 mb-2 truncate",children:e.name}),o.jsx("div",{className:"flex items-center gap-1 mb-2",children:[...Array(5)].map((s,l)=>o.jsx("span",{className:l<4?"text-yellow-400 text-sm":"text-gray-300 text-sm",children:"â­"},l))}),o.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.discount>0&&o.jsxs("span",{className:"text-sm text-gray-400 line-through",children:["Â£",(e.price/(1-e.discount/100)).toFixed(2)]}),o.jsxs("span",{className:"text-lg font-bold text-[#00B207]",children:["Â£",e.price.toFixed(2)]})]}),o.jsx("button",{onClick:a,className:`w-full py-2 rounded-lg font-semibold transition ${t?"bg-green-500 text-white":"bg-gradient-to-r from-[#FFB300] to-[#FFA726] text-white hover:shadow-lg"}`,children:t?"âœ“ Added!":"ðŸ›’ Add"})]})]})}function Ss({children:e}){var d;const r=i2(),t=qi(),{user:n,logout:a}=Bo(),[s,l]=Te.useState(!1),c=[{name:"Dashboard",path:"/dashboard",icon:"ðŸ“Š"},{name:"Products",path:"/products",icon:"ðŸ“¦"},{name:"Orders",path:"/orders",icon:"ðŸ›’"},{name:"Reports",path:"/reports",icon:"ðŸ“ˆ"},{name:"Subscription",path:"/subscription",icon:"ðŸ’³"},{name:"Settings",path:"/settings",icon:"âš™ï¸"}],f=()=>{a(),t("/login")},u=g=>r.pathname===g;return o.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden",onClick:()=>l(!1)}),o.jsx("div",{className:`fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-xl transform transition-transform duration-300 ease-in-out lg:translate-x-0 ${s?"translate-x-0":"-translate-x-full"}`,children:o.jsxs("div",{className:"flex flex-col h-full",children:[o.jsxs("div",{className:"flex items-center justify-between h-16 px-6 bg-gradient-to-r from-afri-green to-afri-green-dark",children:[o.jsx(Et,{to:"/dashboard",className:"flex items-center",children:o.jsx("span",{className:"text-2xl font-bold text-white",children:"Afrimercato"})}),o.jsx("button",{onClick:()=>l(!1),className:"lg:hidden text-white hover:text-afri-yellow",children:o.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),o.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx("div",{className:"w-10 h-10 rounded-full bg-afri-green text-white flex items-center justify-center font-bold",children:((d=n==null?void 0:n.name)==null?void 0:d.charAt(0).toUpperCase())||"V"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate",children:(n==null?void 0:n.name)||"Vendor"}),o.jsx("p",{className:"text-xs text-gray-500 truncate",children:(n==null?void 0:n.email)||""})]})]})}),o.jsx("nav",{className:"flex-1 px-4 py-4 space-y-1 overflow-y-auto",children:c.map(g=>o.jsxs(Et,{to:g.path,className:`flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${u(g.path)?"bg-afri-green text-white":"text-gray-700 hover:bg-gray-100"}`,children:[o.jsx("span",{className:"text-xl",children:g.icon}),o.jsx("span",{className:"font-medium",children:g.name})]},g.name))}),o.jsx("div",{className:"p-4 border-t border-gray-200",children:o.jsxs("button",{onClick:f,className:"w-full flex items-center space-x-3 px-4 py-3 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[o.jsx("span",{className:"text-xl",children:"ðŸšª"}),o.jsx("span",{className:"font-medium",children:"Logout"})]})})]})}),o.jsxs("div",{className:"lg:ml-64",children:[o.jsx("div",{className:"sticky top-0 z-30 bg-white shadow-sm",children:o.jsxs("div",{className:"flex items-center justify-between h-16 px-4 sm:px-6 lg:px-8",children:[o.jsx("button",{onClick:()=>l(!0),className:"lg:hidden text-gray-500 hover:text-gray-700",children:o.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),o.jsx("div",{className:"flex-1 lg:flex-none"}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs("button",{className:"relative p-2 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100",children:[o.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),o.jsx("span",{className:"absolute top-1 right-1 block h-2 w-2 rounded-full bg-red-500"})]}),o.jsx("div",{className:"hidden lg:flex items-center space-x-2 text-sm",children:o.jsx("span",{className:"font-medium text-gray-700",children:n==null?void 0:n.name})})]})]})}),o.jsx("main",{className:"p-4 sm:p-6 lg:p-8",children:e})]})]})}function z3(){const{isAuthenticated:e,loading:r}=Bo();return r?o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-afri-green to-afri-green-dark",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-white mx-auto"}),o.jsx("p",{className:"text-white mt-4 text-lg font-semibold",children:"Loading Afrimercato..."})]})}):o.jsxs(s2,{children:[o.jsx(Yn,{path:"/",element:o.jsx(k3,{})}),o.jsx(Yn,{path:"/partner",element:o.jsx(B3,{})}),o.jsx(Yn,{path:"/stores",element:o.jsx(U3,{})}),o.jsx(Yn,{path:"/store/:vendorId",element:o.jsx(H3,{})}),o.jsx(Yn,{path:"/login",element:e?o.jsx(li,{to:"/dashboard"}):o.jsx(Q2,{})}),o.jsx(Yn,{path:"/register",element:e?o.jsx(li,{to:"/dashboard"}):o.jsx(np,{})}),o.jsx(Yn,{path:"/dashboard",element:e?o.jsx(Ss,{children:o.jsx(op,{})}):o.jsx(li,{to:"/login"})}),o.jsx(Yn,{path:"/products",element:e?o.jsx(Ss,{children:o.jsx(dp,{})}):o.jsx(li,{to:"/login"})}),o.jsx(Yn,{path:"/orders",element:e?o.jsx(Ss,{children:o.jsx(Np,{})}):o.jsx(li,{to:"/login"})}),o.jsx(Yn,{path:"/reports",element:e?o.jsx(Ss,{children:o.jsx(g3,{})}):o.jsx(li,{to:"/login"})}),o.jsx(Yn,{path:"/subscription",element:e?o.jsx(Ss,{children:o.jsx(b3,{})}):o.jsx(li,{to:"/login"})}),o.jsx(Yn,{path:"/settings",element:e?o.jsx(Ss,{children:o.jsx(x3,{})}):o.jsx(li,{to:"/login"})})]})}function q3(){return o.jsx(Z2,{children:o.jsx(z3,{})})}class V3 extends cu.Component{constructor(r){super(r),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0}}componentDidCatch(r,t){this.setState({error:r,errorInfo:t}),console.error("ErrorBoundary caught an error:",r,t)}render(){return this.state.hasError?o.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center px-4",children:o.jsxs("div",{className:"max-w-lg w-full bg-white rounded-lg shadow-xl p-8",children:[o.jsx("div",{className:"flex items-center justify-center w-16 h-16 bg-red-100 rounded-full mx-auto mb-4",children:o.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),o.jsx("h1",{className:"text-2xl font-bold text-center text-gray-900 mb-4",children:"Oops! Something went wrong"}),o.jsx("p",{className:"text-gray-600 text-center mb-6",children:"We're sorry for the inconvenience. Please try refreshing the page."}),o.jsxs("div",{className:"flex justify-center space-x-4",children:[o.jsx("button",{onClick:()=>window.location.reload(),className:"bg-green-600 text-white px-6 py-2 rounded-lg font-medium hover:bg-green-700",children:"Refresh Page"}),o.jsx("a",{href:"/",className:"bg-gray-200 text-gray-800 px-6 py-2 rounded-lg font-medium hover:bg-gray-300",children:"Go Home"})]}),!1]})}):this.props.children}}kc.createRoot(document.getElementById("root")).render(o.jsx(cu.StrictMode,{children:o.jsxs(o2,{children:["  ",o.jsx(V3,{children:o.jsx(q3,{})})]})}));
