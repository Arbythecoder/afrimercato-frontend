import{j as e}from"./date-iP6_brdS.js";import{i as S,u as k,r}from"./vendor-CPDP2aPO.js";import{p as P}from"./index-BU-ROFLt.js";import{g as C}from"./defaultImages-jUbsX-qu.js";import"./ui-Tzc8TJql.js";function F(){var b;const{productId:d}=S(),w=k(),[i,j]=r.useState(null),[a,m]=r.useState([]),[v,x]=r.useState(!0),[c,g]=r.useState(!1),[l,o]=r.useState({rating:5,comment:""}),[h,u]=r.useState(!1);r.useEffect(()=>{N()},[d]);const N=async()=>{try{x(!0);const t=await P.getById(d);t.success&&(j(t.data),m(t.data.reviews||[]))}catch(t){console.error("Error:",t)}finally{x(!1)}},y=async t=>{if(t.preventDefault(),!l.comment.trim()){alert("Please write a review");return}u(!0);try{const s={...l,user:{name:"You"},createdAt:new Date().toISOString()};m([s,...a]),o({rating:5,comment:""}),g(!1),alert("Review submitted successfully!")}catch(s){console.error("Error submitting review:",s)}finally{u(!1)}},f=a.length?(a.reduce((t,s)=>t+s.rating,0)/a.length).toFixed(1):0,R=[5,4,3,2,1].map(t=>({star:t,count:a.filter(s=>s.rating===t).length,percentage:a.length?a.filter(s=>s.rating===t).length/a.length*100:0}));return v?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-afri-green"})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-gradient-to-r from-afri-green to-afri-green-dark text-white py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[e.jsx("button",{onClick:()=>w(-1),className:"mb-4 text-white/80 hover:text-white",children:"â† Back to Product"}),e.jsx("h1",{className:"text-3xl font-bold",children:"Reviews & Ratings"})]})}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[i&&e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-8 flex gap-6",children:[e.jsx("img",{src:C(i),alt:i.name,className:"w-24 h-24 rounded-lg object-cover"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:i.name}),e.jsxs("p",{className:"text-afri-green font-semibold",children:["Â£",(b=i.price)==null?void 0:b.toFixed(2)]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("div",{className:"flex",children:[1,2,3,4,5].map(t=>e.jsx("span",{className:t<=f?"text-yellow-400":"text-gray-300",children:"â˜…"},t))}),e.jsx("span",{className:"font-semibold",children:f}),e.jsxs("span",{className:"text-gray-500",children:["(",a.length," reviews)"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-8",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Rating Distribution"}),e.jsx("div",{className:"space-y-3",children:R.map(({star:t,count:s,percentage:n})=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"w-12 text-sm text-gray-600",children:[t," stars"]}),e.jsx("div",{className:"flex-1 h-3 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-yellow-400 rounded-full transition-all duration-500",style:{width:`${n}%`}})}),e.jsx("span",{className:"w-12 text-sm text-gray-600 text-right",children:s})]},t))})]}),e.jsx("button",{onClick:()=>g(!c),className:"w-full mb-6 py-3 bg-afri-green text-white rounded-xl font-semibold hover:bg-afri-green-dark",children:c?"Cancel":"âœï¸ Write a Review"}),c&&e.jsxs("form",{onSubmit:y,className:"bg-white rounded-xl shadow-lg p-6 mb-8",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Your Review"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rating"}),e.jsx("div",{className:"flex gap-2",children:[1,2,3,4,5].map(t=>e.jsx("button",{type:"button",onClick:()=>o({...l,rating:t}),className:`text-3xl transition-colors ${t<=l.rating?"text-yellow-400":"text-gray-300"}`,children:"â˜…"},t))})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Your Review"}),e.jsx("textarea",{value:l.comment,onChange:t=>o({...l,comment:t.target.value}),rows:4,className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-afri-green",placeholder:"Share your experience with this product..."})]}),e.jsx("button",{type:"submit",disabled:h,className:"px-6 py-3 bg-afri-green text-white rounded-lg font-semibold hover:bg-afri-green-dark disabled:opacity-50",children:h?"Submitting...":"Submit Review"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900",children:["All Reviews (",a.length,")"]}),a.length===0?e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl shadow-lg",children:[e.jsx("span",{className:"text-5xl",children:"ðŸ“"}),e.jsx("p",{className:"text-gray-500 mt-4",children:"No reviews yet. Be the first to review!"})]}):a.map((t,s)=>{var n;return e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:((n=t.user)==null?void 0:n.name)||"Customer"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("div",{className:"flex",children:[1,2,3,4,5].map(p=>e.jsx("span",{className:`text-sm ${p<=t.rating?"text-yellow-400":"text-gray-300"}`,children:"â˜…"},p))}),e.jsx("span",{className:"text-sm text-gray-500",children:new Date(t.createdAt).toLocaleDateString("en-GB")})]})]})}),e.jsx("p",{className:"text-gray-600",children:t.comment})]},s)})]})]})]})}export{F as default};
