import{j as e}from"./date-C9mDCBzx.js";import{i as D,b as O,r as l}from"./vendor-BfFvvk5l.js";import{p as v,e as y}from"./index-CfgvYoI6.js";import{g as w}from"./defaultImages-jUbsX-qu.js";import"./ui-qKdnnCNY.js";function B(){var j,f,N,b;const{productId:i}=D(),r=O(),[s,k]=l.useState(null),[S,x]=l.useState(!0),[n,m]=l.useState(1),[h,C]=l.useState(0),[c,I]=l.useState(!1),[g,P]=l.useState([]);l.useEffect(()=>{F()},[i]);const F=async()=>{try{x(!0);const a=await v.getById(i);if(a.success){k(a.data);const t=await v.getProducts({category:a.data.category,limit:4});t.success&&P((t.data.products||t.data||[]).filter(o=>o._id!==i).slice(0,4))}}catch(a){console.error("Error fetching product:",a)}finally{x(!1)}},p=()=>{const a=JSON.parse(localStorage.getItem("afrimercato_cart")||"[]"),t=a.findIndex(o=>o._id===s._id);t>=0?a[t].quantity+=n:a.push({...s,quantity:n}),localStorage.setItem("afrimercato_cart",JSON.stringify(a)),window.dispatchEvent(new Event("cartUpdated")),alert(`${s.name} added to cart!`)},E=()=>{p(),r("/cart")},_=async()=>{try{c?await y.removeFromWishlist(i):await y.addToWishlist(i),I(!c)}catch(a){console.error("Error updating wishlist:",a)}};if(S)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-afri-green"})});if(!s)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-6xl",children:"ðŸ”"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mt-4",children:"Product not found"}),e.jsx("button",{onClick:()=>r("/products"),className:"mt-4 px-6 py-3 bg-afri-green text-white rounded-xl font-semibold",children:"Browse Products"})]})});const d=((j=s.images)==null?void 0:j.length)>0?s.images.map(a=>a.url||a):[w(s)],u=(f=s.reviews)!=null&&f.length?(s.reviews.reduce((a,t)=>a+t.rating,0)/s.reviews.length).toFixed(1):4.5;return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-3",children:e.jsxs("nav",{className:"text-sm",children:[e.jsx("button",{onClick:()=>r("/"),className:"text-gray-500 hover:text-afri-green",children:"Home"}),e.jsx("span",{className:"mx-2 text-gray-400",children:"/"}),e.jsx("button",{onClick:()=>r("/products"),className:"text-gray-500 hover:text-afri-green",children:"Products"}),e.jsx("span",{className:"mx-2 text-gray-400",children:"/"}),e.jsx("span",{className:"text-gray-900",children:s.name})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12",children:[e.jsxs("div",{children:[e.jsx("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden mb-4",children:e.jsx("img",{src:d[h],alt:s.name,className:"w-full h-96 object-cover"})}),d.length>1&&e.jsx("div",{className:"flex gap-3 overflow-x-auto",children:d.map((a,t)=>e.jsx("button",{onClick:()=>C(t),className:`flex-shrink-0 w-20 h-20 rounded-lg overflow-hidden border-2 transition-all ${h===t?"border-afri-green":"border-transparent"}`,children:e.jsx("img",{src:a,alt:"",className:"w-full h-full object-cover"})},t))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[s.vendor&&e.jsxs("button",{onClick:()=>r(`/store/${s.vendor._id||s.vendor}`),className:"inline-flex items-center gap-2 px-3 py-1 bg-gray-100 rounded-full text-sm text-gray-600 hover:bg-gray-200 mb-4",children:[e.jsx("span",{children:"ðŸª"}),e.jsx("span",{children:s.vendor.storeName||"AfriMercato Vendor"})]}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:s.name}),e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(a=>e.jsx("span",{className:a<=u?"text-yellow-400":"text-gray-300",children:"â˜…"},a))}),e.jsx("span",{className:"font-semibold",children:u}),e.jsxs("button",{onClick:()=>r(`/product/${i}/reviews`),className:"text-afri-green hover:underline",children:["(",((N=s.reviews)==null?void 0:N.length)||0," reviews)"]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("span",{className:"text-4xl font-bold text-afri-green",children:["Â£",(b=s.price)==null?void 0:b.toFixed(2)]}),s.originalPrice&&s.originalPrice>s.price&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-xl text-gray-400 line-through ml-3",children:["Â£",s.originalPrice.toFixed(2)]}),e.jsxs("span",{className:"ml-2 text-sm text-red-500 font-semibold",children:[Math.round((1-s.price/s.originalPrice)*100),"% OFF"]})]}),e.jsxs("p",{className:"text-gray-500 mt-1",children:["per ",s.unit||"item"]})]}),e.jsx("p",{className:"text-gray-600 mb-6",children:s.description}),e.jsx("div",{className:"mb-6",children:s.inStock!==!1&&s.stock>0?e.jsxs("span",{className:"inline-flex items-center gap-2 text-green-600",children:[e.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),"In Stock (",s.stock," available)"]}):e.jsxs("span",{className:"inline-flex items-center gap-2 text-red-600",children:[e.jsx("span",{className:"w-2 h-2 bg-red-500 rounded-full"}),"Out of Stock"]})}),e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Quantity:"}),e.jsxs("div",{className:"flex items-center border rounded-lg",children:[e.jsx("button",{onClick:()=>m(Math.max(1,n-1)),className:"px-4 py-2 text-xl hover:bg-gray-100",children:"âˆ’"}),e.jsx("span",{className:"px-6 py-2 font-semibold",children:n}),e.jsx("button",{onClick:()=>m(Math.min(s.stock||10,n+1)),className:"px-4 py-2 text-xl hover:bg-gray-100",children:"+"})]})]}),e.jsxs("div",{className:"flex gap-3 mb-6",children:[e.jsx("button",{onClick:p,disabled:!s.inStock,className:"flex-1 py-4 bg-afri-green text-white rounded-xl font-semibold hover:bg-afri-green-dark disabled:opacity-50 disabled:cursor-not-allowed",children:"Add to Cart"}),e.jsx("button",{onClick:E,disabled:!s.inStock,className:"flex-1 py-4 bg-afri-gold text-gray-900 rounded-xl font-semibold hover:bg-yellow-400 disabled:opacity-50 disabled:cursor-not-allowed",children:"Buy Now"}),e.jsx("button",{onClick:_,className:`p-4 rounded-xl border-2 transition-colors ${c?"border-red-500 text-red-500 bg-red-50":"border-gray-300 text-gray-500 hover:border-red-500 hover:text-red-500"}`,children:c?"â¤ï¸":"ðŸ¤"})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h3",{className:"font-bold text-gray-900 mb-3",children:"Product Details"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[s.category&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Category"}),e.jsx("span",{className:"font-medium",children:s.category})]}),s.origin&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Origin"}),e.jsx("span",{className:"font-medium",children:s.origin})]}),s.weight&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Weight"}),e.jsx("span",{className:"font-medium",children:s.weight})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 mt-6",children:[e.jsx("h3",{className:"font-bold text-gray-900 mb-4",children:"Delivery Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx("span",{className:"text-2xl",children:"ðŸšš"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Standard Delivery"}),e.jsx("p",{className:"text-gray-500",children:"2-4 business days â€¢ Â£2.99"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx("span",{className:"text-2xl",children:"âš¡"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Express Delivery"}),e.jsx("p",{className:"text-gray-500",children:"Next day â€¢ Â£5.99"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx("span",{className:"text-2xl",children:"ðŸŽ"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Free Delivery"}),e.jsx("p",{className:"text-gray-500",children:"On orders over Â£30"})]})]})]})]})]})]}),g.length>0&&e.jsxs("div",{className:"mt-16",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"You May Also Like"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:g.map(a=>{var t;return e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-all cursor-pointer group",onClick:()=>{r(`/product/${a._id}`),window.scrollTo(0,0)},children:[e.jsx("div",{className:"relative",children:e.jsx("img",{src:w(a),alt:a.name,className:"w-full h-40 object-cover group-hover:scale-105 transition-transform"})}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-1 line-clamp-1",children:a.name}),e.jsxs("p",{className:"text-lg font-bold text-afri-green",children:["Â£",(t=a.price)==null?void 0:t.toFixed(2)]})]})]},a._id)})})]})]})]})}export{B as default};
