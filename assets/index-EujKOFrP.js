const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.es-CYUj7cQv.js","assets/vendor-BOvbtTVj.js","assets/date-CmiLJgMe.js"])))=>i.map(i=>d[i]);
import{j as a,_ as rr}from"./date-CmiLJgMe.js";import{a as sm,r as ge,u as xn,L as Ie,b as im,c as c0,d as om,e as J0,f as lm,h as cm,i as Tr,N as hn,R as gf,H as dm}from"./vendor-BOvbtTVj.js";import{m as Re,A as Ql,u as hm,a as Xd}from"./ui-CtdPSpMm.js";import{R as d0,L as fm,C as Jd,X as Zd,Y as Qd,T as h0,a as eh,b as um,B as mm,c as xm,P as pm,d as gm,e as vm}from"./charts-C7uDCmWg.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();var P0={},th=sm;P0.createRoot=th.createRoot,P0.hydrateRoot=th.hydrateRoot;const Z0="https://afrimercato-backend-production-0329.up.railway.app";console.log("ðŸ”— API Base URL:",Z0);let Ol=!1,O0=[];const rh=(e,r=null)=>{O0.forEach(t=>{e?t.reject(e):t.resolve(r)}),O0=[]},ym=async()=>{var r;const e=localStorage.getItem("afrimercato_refresh_token");if(!e)throw new Error("No refresh token available");try{const t=await fetch(`${Z0}/api/auth/refresh-token`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:e})});if(!t.ok)throw new Error("Failed to refresh token");const n=await t.json();if(n.success&&((r=n.data)!=null&&r.token))return localStorage.setItem("afrimercato_token",n.data.token),n.data.token;throw new Error("Invalid refresh response")}catch(t){throw localStorage.removeItem("afrimercato_token"),localStorage.removeItem("afrimercato_refresh_token"),t}},gt=async(e,r={},t=!1)=>{try{const n=`${Z0}/api${e}`,s={headers:{...r.headers},credentials:"include",...r};r.body instanceof FormData||(s.headers["Content-Type"]="application/json");const o=localStorage.getItem("afrimercato_token");o&&(s.headers.Authorization=`Bearer ${o}`),console.log("ðŸŒ Fetching:",n);const l=await fetch(n,s);if(!l.ok){const d=await l.json().catch(()=>({}));if(l.status===401&&!t&&(d.errorCode==="TOKEN_EXPIRED"||d.errorCode==="INVALID_TOKEN")){if(Ol)return new Promise((f,u)=>{O0.push({resolve:f,reject:u})}).then(f=>gt(e,r,!0)).catch(f=>{throw f});Ol=!0;try{const f=await ym();return rh(null,f),Ol=!1,gt(e,r,!0)}catch(f){throw rh(f,null),Ol=!1,window.location.href="/login",new Error("Session expired. Please log in again.")}}throw l.status===401?(localStorage.removeItem("afrimercato_token"),localStorage.removeItem("afrimercato_refresh_token"),new Error("Session expired. Please log in again.")):new Error(d.message||`HTTP error! status: ${l.status}`)}return await l.json()}catch(n){throw console.error(`âŒ API Error (${e}):`,n),n}},bm=async e=>{var t;const r=await gt("/auth/login",{method:"POST",body:JSON.stringify(e)});return r.success&&((t=r.data)!=null&&t.token)&&(localStorage.setItem("afrimercato_token",r.data.token),r.data.refreshToken&&localStorage.setItem("afrimercato_refresh_token",r.data.refreshToken)),r},wm=async e=>{var t;const r=await gt("/auth/register",{method:"POST",body:JSON.stringify(e)});return r.success&&((t=r.data)!=null&&t.token)&&(localStorage.setItem("afrimercato_token",r.data.token),r.data.refreshToken&&localStorage.setItem("afrimercato_refresh_token",r.data.refreshToken)),r},Nm=async()=>{try{await gt("/auth/logout",{method:"POST"})}finally{localStorage.removeItem("afrimercato_token"),localStorage.removeItem("afrimercato_refresh_token"),window.location.href="/login"}},jm=async()=>gt("/auth/refresh",{method:"POST"}),Sm=async()=>gt("/vendor/profile"),_m=async e=>gt("/vendor/profile",{method:"PUT",body:JSON.stringify(e)}),vf=async e=>gt("/vendor/profile",{method:"POST",body:JSON.stringify(e)}),Am=async(e={})=>{const r=new URLSearchParams(e).toString();return gt(`/vendor/products?${r}`)},km=async e=>gt("/vendor/products",{method:"POST",body:JSON.stringify(e)}),Tm=async(e,r)=>gt(`/vendor/products/${e}`,{method:"PUT",body:JSON.stringify(r)}),Cm=async e=>gt(`/vendor/products/${e}`,{method:"DELETE"}),Em=async(e={})=>{const r=new URLSearchParams(e).toString();return gt(`/vendor/orders?${r}`)},Lm=async e=>gt(`/vendor/orders/${e}`),Fm=async(e,r)=>gt(`/vendor/orders/${e}/status`,{method:"PUT",body:JSON.stringify(r)}),Pm=async(e,r)=>gt(`/vendor/orders/${e}/rate-rider`,{method:"POST",body:JSON.stringify(r)}),Om=async()=>gt("/vendor/dashboard/stats"),Im=async(e="7d")=>gt(`/vendor/dashboard/chart-data?timeRange=${e}`),Dm=async(e={})=>{const r=new URLSearchParams(e).toString();return gt(`/vendor/reports/sales?${r}`)},Rm=async()=>gt("/vendor/reports/inventory"),Bm=async(e={})=>{const r=new URLSearchParams(e).toString();return gt(`/vendor/reports/orders?${r}`)},Mm=async(e={})=>{const r=new URLSearchParams(e).toString();return gt(`/vendor/reports/revenue?${r}`)},Um=async()=>gt("/subscription/plans"),Hm=async e=>gt("/subscription/subscribe",{method:"POST",body:JSON.stringify(e)}),Wm=async()=>gt("/subscription/my-subscription"),zm=async()=>gt("/subscription/cancel",{method:"POST"}),qm=async(e,r=50)=>{const t=new URLSearchParams({location:e,radius:r});return gt(`/location/search-vendors?${t}`)},Vm=async e=>gt(`/location/vendor/${e}`),Gm=async e=>gt(`/products/vendor/${e}`),$m=async()=>gt("/users/profile"),Ym=async e=>gt("/users/profile",{method:"PATCH",body:JSON.stringify(e)}),Km=async e=>gt("/users/change-password",{method:"PATCH",body:JSON.stringify(e)}),Xm=async e=>{const r=new FormData;e.forEach(n=>{r.append("productImages",n)});const t=localStorage.getItem("afrimercato_token");return gt("/vendor/upload/images",{method:"POST",headers:{...t&&{Authorization:`Bearer ${t}`}},body:r})},Jm=async e=>gt("/vendor/products/bulk-delete",{method:"POST",body:JSON.stringify(e)}),Zm=async e=>gt("/vendor/products/bulk-status",{method:"POST",body:JSON.stringify(e)}),Qm=async e=>gt("/vendor/products/bulk-price",{method:"POST",body:JSON.stringify(e)}),ex=async e=>gt("/vendor/products/bulk-stock",{method:"POST",body:JSON.stringify(e)}),tx=()=>!!localStorage.getItem("afrimercato_token"),rx=()=>localStorage.getItem("afrimercato_token"),ax=e=>{localStorage.setItem("afrimercato_token",e)},nx=()=>{localStorage.removeItem("afrimercato_token"),localStorage.removeItem("afrimercato_refresh_token")},ah={login:bm,register:wm,logout:Nm,refreshToken:jm,isAuthenticated:tx,getAuthToken:rx,setAuthToken:ax,clearAuthToken:nx},sx=async()=>gt("/vendor/delivery-settings"),ix=async e=>gt("/vendor/delivery-settings",{method:"PUT",body:JSON.stringify(e)}),xr={getProfile:Sm,updateProfile:_m,createProfile:vf,getProducts:Am,createProduct:km,updateProduct:Tm,deleteProduct:Cm,getOrders:Em,getOrder:Lm,updateOrderStatus:Fm,rateRider:Pm,getDashboardStats:Om,getChartData:Im,getSalesReport:Dm,getInventoryReport:Rm,getOrdersReport:Bm,getRevenueReport:Mm,uploadProductImages:Xm,bulkDeleteProducts:Jm,bulkUpdateStatus:Zm,bulkUpdatePrices:Qm,bulkUpdateStock:ex,getDeliverySettings:sx,updateDeliverySettings:ix},ox=async()=>gt("/customers/dashboard/stats"),lx=async(e={})=>{const r=new URLSearchParams(e).toString();return gt(`/customers/orders/recent?${r}`)},cx=async(e={})=>{const r=new URLSearchParams(e).toString();return gt(`/customers/products/recommended?${r}`)},dx=async()=>gt("/customers/wishlist"),hx=async e=>gt("/customers/wishlist",{method:"POST",body:JSON.stringify({productId:e})}),fx=async e=>gt(`/customers/wishlist/${e}`,{method:"DELETE"}),f0={getDashboardStats:ox,getRecentOrders:lx,getRecommendedProducts:cx,getWishlist:dx,addToWishlist:hx,removeFromWishlist:fx},u0={getProfile:$m,updateProfile:Ym,changePassword:Km},Il={getPlans:Um,subscribe:Hm,getMySubscription:Wm,cancel:zm},ux=async(e={})=>{const r=new URLSearchParams(e).toString();return gt(`/notifications?${r}`)},mx=async()=>gt("/notifications/unread-count"),xx=async e=>gt(`/notifications/${e}/read`,{method:"PUT"}),px=async()=>gt("/notifications/mark-all-read",{method:"PUT"}),gx=async e=>gt(`/notifications/${e}`,{method:"DELETE"}),vx=async()=>gt("/notifications",{method:"DELETE"}),Dl={getNotifications:ux,getUnreadCount:mx,markAsRead:xx,markAllAsRead:px,deleteNotification:gx,deleteAllRead:vx},yf=ge.createContext(),Di=()=>{const e=ge.useContext(yf);if(!e)throw new Error("useAuth must be used within AuthProvider");return e},yx=({children:e})=>{const[r,t]=ge.useState(null),[n,s]=ge.useState(!0),[o,l]=ge.useState(!1);ge.useEffect(()=>{c()},[]);const c=async()=>{const p=localStorage.getItem("afrimercato_token"),m=localStorage.getItem("afrimercato_user");if(p&&(l(!0),m))try{t(JSON.parse(m))}catch(j){console.error("Error parsing user data:",j)}s(!1)},g={user:r,isAuthenticated:o,loading:n,login:async(p,m)=>{try{const j=await ah.login({email:p,password:m});if(j.success){const{token:v,user:N}=j.data;return localStorage.setItem("afrimercato_token",v),localStorage.setItem("afrimercato_user",JSON.stringify(N)),t(N),l(!0),{success:!0,user:N}}}catch(j){return{success:!1,message:j.message||"Login failed"}}},register:async p=>{try{const m=await ah.register(p);if(m.success){const{token:j,user:v}=m.data;return localStorage.setItem("afrimercato_token",j),localStorage.setItem("afrimercato_user",JSON.stringify(v)),t(v),l(!0),{success:!0,user:v}}}catch(m){return{success:!1,message:m.message||"Registration failed"}}},logout:()=>{localStorage.removeItem("afrimercato_token"),localStorage.removeItem("afrimercato_user"),t(null),l(!1)},checkAuth:c};return a.jsx(yf.Provider,{value:g,children:e})};function bx(){const e=xn(),{login:r}=Di(),[t,n]=ge.useState({email:"",password:""}),[s,o]=ge.useState(""),[l,c]=ge.useState(!1),[d,f]=ge.useState(!1),u=p=>{n({...t,[p.target.name]:p.target.value}),o("")},g=async p=>{var j,v;p.preventDefault(),o(""),c(!0);const m=await r(t.email,t.password);if(m.success)switch(((j=m.user)==null?void 0:j.role)||((v=m.user)==null?void 0:v.primaryRole)||"customer"){case"vendor":e("/dashboard");break;case"rider":e("/rider/dashboard");break;case"picker":e("/picker/dashboard");break;case"customer":default:e("/");break}else o(m.message||"Login failed. Please try again.");c(!1)};return a.jsxs("div",{className:"min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8 overflow-hidden relative bg-gradient-to-br from-afri-green to-afri-green-dark",style:{backgroundSize:"400% 400%",animation:"gradient 15s ease infinite"},children:[a.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:a.jsx("div",{className:"absolute inset-0",style:{background:"radial-gradient(circle at center, rgba(255,255,255,0.1) 0%, transparent 60%)",animation:"pulse 4s ease-in-out infinite"}})}),a.jsxs(Re.div,{className:"max-w-md w-full relative",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[a.jsxs(Re.div,{className:"text-center mb-8",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5},children:[a.jsx(Re.h1,{className:"text-5xl font-bold text-white mb-2",initial:{y:-20},animate:{y:0},transition:{type:"spring",stiffness:300,damping:20},children:"Afrimercato"}),a.jsx(Re.p,{className:"text-afri-yellow text-lg",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:"Fresh African Groceries"})]}),a.jsxs(Re.div,{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl p-8",initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.4,delay:.3},children:[a.jsx(Re.h2,{className:"text-3xl font-bold text-gray-900 mb-2",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{duration:.4,delay:.4},children:"Welcome Back"}),a.jsx(Re.p,{className:"text-gray-600 mb-6",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{duration:.4,delay:.5},children:"Sign in to your account"}),s&&a.jsx(Re.div,{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-6 rounded",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3},children:a.jsx("p",{className:"text-red-700 text-sm",children:s})}),a.jsxs("form",{onSubmit:g,className:"space-y-6",children:[a.jsxs(Re.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.6},children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),a.jsx(Re.input,{whileFocus:{scale:1.01},transition:{type:"spring",stiffness:300,damping:20},id:"email",name:"email",type:"email",required:!0,value:t.email,onChange:u,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"vendor@example.com"})]}),a.jsxs(Re.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.7},children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx(Re.input,{whileFocus:{scale:1.01},transition:{type:"spring",stiffness:300,damping:20},id:"password",name:"password",type:d?"text":"password",required:!0,value:t.password,onChange:u,className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"}),a.jsx("button",{type:"button",onClick:()=>f(!d),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700 focus:outline-none",children:d?a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):a.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),a.jsxs(Re.div,{className:"flex items-center justify-between",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.8},children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(Re.input,{whileHover:{scale:1.1},transition:{type:"spring",stiffness:400,damping:10},id:"remember",name:"remember",type:"checkbox",className:"h-4 w-4 text-afri-green focus:ring-afri-green border-gray-300 rounded"}),a.jsx("label",{htmlFor:"remember",className:"ml-2 block text-sm text-gray-700",children:"Remember me"})]}),a.jsx(Re.div,{whileHover:{scale:1.05},children:a.jsx(Ie,{to:"/forgot-password",className:"text-sm text-afri-green hover:text-afri-green-dark font-medium",children:"Forgot password?"})})]}),a.jsx(Re.button,{type:"submit",disabled:l,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-white bg-gradient-to-r from-afri-green to-afri-green-dark hover:from-afri-green-dark hover:to-afri-green focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-afri-green font-semibold text-lg transition disabled:opacity-50 disabled:cursor-not-allowed",whileHover:{scale:1.02},whileTap:{scale:.98},initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.9},children:l?a.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):"Sign In"})]}),a.jsxs(Re.div,{className:"mt-6",initial:{opacity:0},animate:{opacity:1},transition:{delay:1},children:[a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-0 flex items-center",children:a.jsx("div",{className:"w-full border-t border-gray-300"})}),a.jsx("div",{className:"relative flex justify-center text-sm",children:a.jsx("span",{className:"px-4 bg-white text-gray-500",children:"New to Afrimercato?"})})]}),a.jsx(Re.div,{className:"mt-6 text-center",whileHover:{scale:1.05},children:a.jsxs(Ie,{to:"/register",className:"text-afri-green hover:text-afri-green-dark font-semibold text-base inline-flex items-center",children:["Create an account",a.jsx(Re.span,{animate:{x:[0,5,0]},transition:{repeat:1/0,duration:1.5},className:"ml-2",children:"â†’"})]})})]})]}),a.jsx(Re.p,{className:"mt-8 text-center text-sm text-white",initial:{opacity:0},animate:{opacity:1},transition:{delay:1.1},children:"Â© 2025 Afrimercato. Fresh African Groceries Delivered."})]}),a.jsx("style",{jsx:!0,children:`
        @keyframes gradient {
          0% { background-position: 0% 50% }
          50% { background-position: 100% 50% }
          100% { background-position: 0% 50% }
        }
        @keyframes pulse {
          0% { opacity: 0.4 }
          50% { opacity: 0.6 }
          100% { opacity: 0.4 }
        }
      `})]})}const m0={vegetables:"https://images.unsplash.com/photo-1598170845058-32b9d6a5da37?w=800&q=80",fruits:"https://images.unsplash.com/photo-1619566636858-adf3ef46400b?w=800&q=80","meat-fish":"https://images.unsplash.com/photo-1546964053-d018e345e490?w=800&q=80",dairy:"https://images.unsplash.com/photo-1563636619-e9143da7973b?w=800&q=80",grains:"https://images.unsplash.com/photo-1596797882870-8c33deeac224?w=800&q=80",beverages:"https://images.unsplash.com/photo-1598614187854-26a60e982dc4?w=800&q=80",spices:"https://images.unsplash.com/photo-1596040033229-a0b3b46fe6b6?w=800&q=80","fresh-produce":"https://images.unsplash.com/photo-1610832958506-aa56368176cf?w=800&q=80",bakery:"https://images.unsplash.com/photo-1509440159596-0249088772ff?w=800&q=80",snacks:"https://images.unsplash.com/photo-1599490659213-e2b9527bd087?w=800&q=80",groceries:"https://images.unsplash.com/photo-1542838132-92c53300491e?w=800&q=80",household:"https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?w=800&q=80","beauty-health":"https://images.unsplash.com/photo-1596462502278-27bfdc403348?w=800&q=80",default:"https://images.unsplash.com/photo-1604719312566-8912e9227c6a?w=800&q=80"},Rl={hero1:"https://images.unsplash.com/photo-1578916171728-46686eac8d58?w=1600&q=80",hero2:"https://images.unsplash.com/photo-1573496359142-b8d87734a5a2?w=1600&q=80",store1:"https://images.unsplash.com/photo-1604719312566-8912e9227c6a?w=1600&q=80",store2:"https://images.unsplash.com/photo-1534723328310-e82dad3ee43f?w=1600&q=80"},wx=e=>{if(!e)return m0.default;const r=e.toLowerCase().replace(/\s+/g,"-");return m0[r]||m0.default},Nx=e=>{var r;if(e!=null&&e.images&&e.images.length>0){const t=e.images.find(n=>n.isPrimary);if(t!=null&&t.url)return t.url;if((r=e.images[0])!=null&&r.url)return e.images[0].url}return wx(e==null?void 0:e.category)};function jx(){const e=xn(),{register:r}=Di(),[t,n]=ge.useState({name:"",email:"",password:"",confirmPassword:"",role:"customer"}),[s,o]=ge.useState(""),[l,c]=ge.useState(!1),[d,f]=ge.useState(!1),[u,g]=ge.useState(!1),p=y=>{n({...t,[y.target.name]:y.target.value}),o("")},m=async y=>{if(y.preventDefault(),o(""),t.password!==t.confirmPassword){o("Passwords do not match");return}if(t.password.length<6){o("Password must be at least 6 characters");return}c(!0);const _=await r(t);if(_.success)switch(t.role){case"vendor":e("/dashboard");break;case"rider":e("/rider/dashboard");break;case"picker":e("/picker/dashboard");break;case"customer":default:e("/");break}else o(_.message);c(!1)},j={hidden:{opacity:0},visible:{opacity:1,transition:{delayChildren:.1,staggerChildren:.1}}},v={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",stiffness:100}}},b=(()=>{switch(t.role){case"vendor":return{title:"Start Selling Today",subtitle:"Join thousands of vendors on Afrimercato",benefit1:"ðŸ“Š Real-time sales analytics",benefit2:"ðŸš€ Instant order notifications",benefit3:"ðŸ’° Low commission rates",image:Rl.store1};case"rider":return{title:"Become a Delivery Partner",subtitle:"Deliver groceries and earn on your schedule",benefit1:"â° Flexible working hours",benefit2:"ðŸ’µ Competitive earnings",benefit3:"ðŸ“± Easy-to-use rider app",image:Rl.hero2};case"picker":return{title:"Join Our Fulfillment Team",subtitle:"Help fulfill orders from local stores",benefit1:"ðŸª Work with top vendors",benefit2:"ðŸ“¦ Simple picking process",benefit3:"ðŸ’ª Great team environment",image:Rl.store2};default:return{title:"Join Our Community",subtitle:"Start shopping for fresh African groceries",benefit1:"ðŸ¥¬ Fresh produce daily",benefit2:"ðŸšš Fast delivery",benefit3:"ðŸŽ Exclusive deals",image:Rl.hero1}}})();return a.jsxs("div",{className:"min-h-screen flex bg-gray-50",children:[a.jsxs(Re.div,{initial:{x:-50,opacity:0},animate:{x:0,opacity:1},transition:{duration:.6},className:"hidden lg:flex lg:w-1/2 bg-gradient-to-br from-afri-green via-afri-green-dark to-green-900 p-12 flex-col justify-between relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 opacity-10",children:a.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 2px 2px, white 1px, transparent 0)",backgroundSize:"40px 40px"}})}),a.jsxs("div",{className:"relative z-10",children:[a.jsxs(Re.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.6},children:[a.jsx("h1",{className:"text-6xl font-bold text-white mb-2",children:"Afrimercato"}),a.jsx("p",{className:"text-afri-yellow text-xl font-semibold",children:b.title})]}),a.jsxs(Re.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4,duration:.6},className:"mt-12 space-y-6",children:[a.jsxs("div",{className:"flex items-start space-x-4",children:[a.jsx("div",{className:"bg-white/20 rounded-lg p-3 backdrop-blur-sm",children:a.jsx("svg",{className:"w-6 h-6 text-afri-yellow",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),a.jsx("div",{children:a.jsx("p",{className:"text-white text-lg font-medium",children:b.benefit1})})]}),a.jsxs("div",{className:"flex items-start space-x-4",children:[a.jsx("div",{className:"bg-white/20 rounded-lg p-3 backdrop-blur-sm",children:a.jsx("svg",{className:"w-6 h-6 text-afri-yellow",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),a.jsx("div",{children:a.jsx("p",{className:"text-white text-lg font-medium",children:b.benefit2})})]}),a.jsxs("div",{className:"flex items-start space-x-4",children:[a.jsx("div",{className:"bg-white/20 rounded-lg p-3 backdrop-blur-sm",children:a.jsx("svg",{className:"w-6 h-6 text-afri-yellow",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),a.jsx("div",{children:a.jsx("p",{className:"text-white text-lg font-medium",children:b.benefit3})})]})]})]}),a.jsx(Re.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.6,duration:.6},className:"relative z-10",children:a.jsx("img",{src:b.image,alt:b.title,className:"rounded-2xl shadow-2xl w-full h-64 object-cover border-4 border-white/20"})}),a.jsx(Re.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},className:"relative z-10 text-white/70 text-sm",children:"Â© 2025 Afrimercato. Fresh African Groceries Delivered."})]}),a.jsx("div",{className:"w-full lg:w-1/2 flex items-center justify-center p-8",children:a.jsxs(Re.div,{variants:j,initial:"hidden",animate:"visible",className:"w-full max-w-md",children:[a.jsxs(Re.div,{variants:v,className:"lg:hidden text-center mb-8",children:[a.jsx("h1",{className:"text-4xl font-bold text-afri-green mb-2",children:"Afrimercato"}),a.jsx("p",{className:"text-gray-600",children:b.title})]}),a.jsxs(Re.div,{variants:v,className:"bg-white rounded-2xl shadow-xl p-8 border border-gray-100",children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Create Account"}),a.jsxs("p",{className:"text-gray-600 mb-6",children:[t.role==="vendor"&&"Join thousands of vendors on Afrimercato",t.role==="customer"&&"Start shopping for fresh African groceries",t.role==="rider"&&"Deliver groceries and earn on your schedule",t.role==="picker"&&"Help fulfill orders from local stores"]}),s&&a.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-6 rounded",children:a.jsx("p",{className:"text-red-700 text-sm",children:s})}),a.jsxs("form",{onSubmit:m,className:"space-y-5",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 mb-2",children:"I want to register as"}),a.jsxs("select",{id:"role",name:"role",required:!0,value:t.role,onChange:p,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition bg-white",children:[a.jsx("option",{value:"customer",children:"Customer - Shop for groceries"}),a.jsx("option",{value:"vendor",children:"Vendor - Sell products"}),a.jsx("option",{value:"rider",children:"Rider - Deliver orders"}),a.jsx("option",{value:"picker",children:"Picker - Fulfill orders"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name"}),a.jsx("input",{id:"name",name:"name",type:"text",required:!0,value:t.name,onChange:p,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"John Doe"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),a.jsx("input",{id:"email",name:"email",type:"email",required:!0,value:t.email,onChange:p,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"vendor@example.com"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{id:"password",name:"password",type:d?"text":"password",required:!0,value:t.password,onChange:p,className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"}),a.jsx("button",{type:"button",onClick:()=>f(!d),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700 focus:outline-none",children:d?a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.542 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):a.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"At least 6 characters"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:u?"text":"password",required:!0,value:t.confirmPassword,onChange:p,className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"}),a.jsx("button",{type:"button",onClick:()=>g(!u),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700 focus:outline-none",children:u?a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.542 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):a.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("input",{id:"terms",name:"terms",type:"checkbox",required:!0,className:"h-4 w-4 mt-1 text-afri-green focus:ring-afri-green border-gray-300 rounded"}),a.jsxs("label",{htmlFor:"terms",className:"ml-2 block text-sm text-gray-700",children:["I agree to the"," ",a.jsx(Ie,{to:"/terms",className:"text-afri-green hover:text-afri-green-dark font-medium",children:"Terms of Service"})," ","and"," ",a.jsx(Ie,{to:"/privacy",className:"text-afri-green hover:text-afri-green-dark font-medium",children:"Privacy Policy"})]})]}),a.jsx("button",{type:"submit",disabled:l,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-white bg-gradient-to-r from-afri-green to-afri-green-dark hover:from-afri-green-dark hover:to-afri-green focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-afri-green font-semibold text-lg transition disabled:opacity-50 disabled:cursor-not-allowed",children:l?a.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):"Create Account"})]}),a.jsxs("div",{className:"mt-6",children:[a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-0 flex items-center",children:a.jsx("div",{className:"w-full border-t border-gray-300"})}),a.jsx("div",{className:"relative flex justify-center text-sm",children:a.jsx("span",{className:"px-4 bg-white text-gray-500",children:"Already have an account?"})})]}),a.jsx("div",{className:"mt-6 text-center",children:a.jsx(Ie,{to:"/login",className:"text-afri-green hover:text-afri-green-dark font-semibold text-base",children:"Sign in here â†’"})})]})]}),a.jsx("p",{className:"mt-8 text-center text-sm text-gray-600 lg:hidden",children:"Â© 2025 Afrimercato. Fresh African Groceries Delivered."})]})})]})}var Bl=function(e,r){return e<r?-1:e>r?1:0},nh=function(e){return e.reduce(function(r,t){return r+t},0)},Sx=function(){function e(t){this.colors=t}var r=e.prototype;return r.palette=function(){return this.colors},r.map=function(t){return t},e}(),_x=function(){function e(o,l,c){return(o<<10)+(l<<5)+c}function r(o){var l=[],c=!1;function d(){l.sort(o),c=!0}return{push:function(f){l.push(f),c=!1},peek:function(f){return c||d(),f===void 0&&(f=l.length-1),l[f]},pop:function(){return c||d(),l.pop()},size:function(){return l.length},map:function(f){return l.map(f)},debug:function(){return c||d(),l}}}function t(o,l,c,d,f,u,g){var p=this;p.r1=o,p.r2=l,p.g1=c,p.g2=d,p.b1=f,p.b2=u,p.histo=g}function n(){this.vboxes=new r(function(o,l){return Bl(o.vbox.count()*o.vbox.volume(),l.vbox.count()*l.vbox.volume())})}function s(o,l){if(l.count()){var c=l.r2-l.r1+1,d=l.g2-l.g1+1,f=Math.max.apply(null,[c,d,l.b2-l.b1+1]);if(l.count()==1)return[l.copy()];var u,g,p,m,j=0,v=[],N=[];if(f==c)for(u=l.r1;u<=l.r2;u++){for(m=0,g=l.g1;g<=l.g2;g++)for(p=l.b1;p<=l.b2;p++)m+=o[e(u,g,p)]||0;v[u]=j+=m}else if(f==d)for(u=l.g1;u<=l.g2;u++){for(m=0,g=l.r1;g<=l.r2;g++)for(p=l.b1;p<=l.b2;p++)m+=o[e(g,u,p)]||0;v[u]=j+=m}else for(u=l.b1;u<=l.b2;u++){for(m=0,g=l.r1;g<=l.r2;g++)for(p=l.g1;p<=l.g2;p++)m+=o[e(g,p,u)]||0;v[u]=j+=m}return v.forEach(function(b,y){N[y]=j-b}),function(b){var y,_,T,O,B,L=b+"1",E=b+"2",P=0;for(u=l[L];u<=l[E];u++)if(v[u]>j/2){for(T=l.copy(),O=l.copy(),B=(y=u-l[L])<=(_=l[E]-u)?Math.min(l[E]-1,~~(u+_/2)):Math.max(l[L],~~(u-1-y/2));!v[B];)B++;for(P=N[B];!P&&v[B-1];)P=N[--B];return T[E]=B,O[L]=T[E]+1,[T,O]}}(f==c?"r":f==d?"g":"b")}}return t.prototype={volume:function(o){var l=this;return l._volume&&!o||(l._volume=(l.r2-l.r1+1)*(l.g2-l.g1+1)*(l.b2-l.b1+1)),l._volume},count:function(o){var l=this,c=l.histo;if(!l._count_set||o){var d,f,u,g=0;for(d=l.r1;d<=l.r2;d++)for(f=l.g1;f<=l.g2;f++)for(u=l.b1;u<=l.b2;u++)g+=c[e(d,f,u)]||0;l._count=g,l._count_set=!0}return l._count},copy:function(){var o=this;return new t(o.r1,o.r2,o.g1,o.g2,o.b1,o.b2,o.histo)},avg:function(o){var l=this,c=l.histo;if(!l._avg||o){var d,f,u,g,p=0,m=0,j=0,v=0;if(l.r1===l.r2&&l.g1===l.g2&&l.b1===l.b2)l._avg=[l.r1<<3,l.g1<<3,l.b1<<3];else{for(f=l.r1;f<=l.r2;f++)for(u=l.g1;u<=l.g2;u++)for(g=l.b1;g<=l.b2;g++)p+=d=c[e(f,u,g)]||0,m+=d*(f+.5)*8,j+=d*(u+.5)*8,v+=d*(g+.5)*8;l._avg=p?[~~(m/p),~~(j/p),~~(v/p)]:[~~(8*(l.r1+l.r2+1)/2),~~(8*(l.g1+l.g2+1)/2),~~(8*(l.b1+l.b2+1)/2)]}}return l._avg},contains:function(o){var l=this,c=o[0]>>3;return gval=o[1]>>3,bval=o[2]>>3,c>=l.r1&&c<=l.r2&&gval>=l.g1&&gval<=l.g2&&bval>=l.b1&&bval<=l.b2}},n.prototype={push:function(o){this.vboxes.push({vbox:o,color:o.avg()})},palette:function(){return this.vboxes.map(function(o){return o.color})},size:function(){return this.vboxes.size()},map:function(o){for(var l=this.vboxes,c=0;c<l.size();c++)if(l.peek(c).vbox.contains(o))return l.peek(c).color;return this.nearest(o)},nearest:function(o){for(var l,c,d,f=this.vboxes,u=0;u<f.size();u++)((c=Math.sqrt(Math.pow(o[0]-f.peek(u).color[0],2)+Math.pow(o[1]-f.peek(u).color[1],2)+Math.pow(o[2]-f.peek(u).color[2],2)))<l||l===void 0)&&(l=c,d=f.peek(u).color);return d},forcebw:function(){var o=this.vboxes;o.sort(function(f,u){return Bl(nh(f.color),nh(u.color))});var l=o[0].color;l[0]<5&&l[1]<5&&l[2]<5&&(o[0].color=[0,0,0]);var c=o.length-1,d=o[c].color;d[0]>251&&d[1]>251&&d[2]>251&&(o[c].color=[255,255,255])}},{quantize:function(o,l){if(!Number.isInteger(l)||l<1||l>256)throw new Error("Invalid maximum color count. It must be an integer between 1 and 256.");if(!o.length||l<2||l>256||!o.length||l<2||l>256)return!1;for(var c=[],d=new Set,f=0;f<o.length;f++){var u=o[f],g=u.join(",");d.has(g)||(d.add(g),c.push(u))}if(c.length<=l)return new Sx(c);var p=function(y){var _,T=new Array(32768);return y.forEach(function(O){_=e(O[0]>>3,O[1]>>3,O[2]>>3),T[_]=(T[_]||0)+1}),T}(o);p.forEach(function(){});var m=function(y,_){var T,O,B,L=1e6,E=0,P=1e6,D=0,k=1e6,C=0;return y.forEach(function(z){(T=z[0]>>3)<L?L=T:T>E&&(E=T),(O=z[1]>>3)<P?P=O:O>D&&(D=O),(B=z[2]>>3)<k?k=B:B>C&&(C=B)}),new t(L,E,P,D,k,C,_)}(o,p),j=new r(function(y,_){return Bl(y.count(),_.count())});function v(y,_){for(var T,O=y.size(),B=0;B<1e3;){if(O>=_||B++>1e3)return;if((T=y.pop()).count()){var L=s(p,T),E=L[0],P=L[1];if(!E)return;y.push(E),P&&(y.push(P),O++)}else y.push(T),B++}}j.push(m),v(j,.75*l);for(var N=new r(function(y,_){return Bl(y.count()*y.volume(),_.count()*_.volume())});j.size();)N.push(j.pop());v(N,l);for(var b=new n;N.size();)b.push(N.pop());return b}}}().quantize,bf=function(e){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.width=this.canvas.width=e.naturalWidth,this.height=this.canvas.height=e.naturalHeight,this.context.drawImage(e,0,0,this.width,this.height)};bf.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)};var Ai=function(){};Ai.prototype.getColor=function(e,r){return r===void 0&&(r=10),this.getPalette(e,5,r)[0]},Ai.prototype.getPalette=function(e,r,t){var n=function(c){var d=c.colorCount,f=c.quality;if(d!==void 0&&Number.isInteger(d)){if(d===1)throw new Error("colorCount should be between 2 and 20. To get one color, call getColor() instead of getPalette()");d=Math.max(d,2),d=Math.min(d,20)}else d=10;return(f===void 0||!Number.isInteger(f)||f<1)&&(f=10),{colorCount:d,quality:f}}({colorCount:r,quality:t}),s=new bf(e),o=function(c,d,f){for(var u,g,p,m,j,v=c,N=[],b=0;b<d;b+=f)g=v[0+(u=4*b)],p=v[u+1],m=v[u+2],((j=v[u+3])===void 0||j>=125)&&(g>250&&p>250&&m>250||N.push([g,p,m]));return N}(s.getImageData().data,s.width*s.height,n.quality),l=_x(o,n.colorCount);return l?l.palette():null},Ai.prototype.getColorFromUrl=function(e,r,t){var n=this,s=document.createElement("img");s.addEventListener("load",function(){var o=n.getPalette(s,5,t);r(o[0],e)}),s.src=e},Ai.prototype.getImageData=function(e,r){var t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="arraybuffer",t.onload=function(){if(this.status==200){var n=new Uint8Array(this.response);i=n.length;for(var s=new Array(i),o=0;o<n.length;o++)s[o]=String.fromCharCode(n[o]);var l=s.join(""),c=window.btoa(l);r("data:image/png;base64,"+c)}},t.send()},Ai.prototype.getColorAsync=function(e,r,t){var n=this;this.getImageData(e,function(s){var o=document.createElement("img");o.addEventListener("load",function(){var l=n.getPalette(o,5,t);r(l[0],this)}),o.src=s})};const Ax=({onComplete:e})=>{const r=xn(),[t,n]=ge.useState(1),[s,o]=ge.useState(!1),[l,c]=ge.useState(""),d=ge.useRef(null),f=ge.useRef(new Ai),[u,g]=ge.useState({storeName:"",description:"",category:"fresh-produce",phone:"",alternativePhone:"",address:{street:"",city:"",state:"",country:"Nigeria",postalCode:""},businessHours:{monday:{open:"09:00",close:"18:00",closed:!1},tuesday:{open:"09:00",close:"18:00",closed:!1},wednesday:{open:"09:00",close:"18:00",closed:!1},thursday:{open:"09:00",close:"18:00",closed:!1},friday:{open:"09:00",close:"18:00",closed:!1},saturday:{open:"09:00",close:"18:00",closed:!1},sunday:{open:"09:00",close:"18:00",closed:!0}},logo:null,logoPreview:null,brandColors:{primary:"#059669",secondary:"#FFC107"}}),p=[{value:"fresh-produce",label:"Fresh Produce",icon:"ðŸ¥¬"},{value:"meat-seafood",label:"Meat & Seafood",icon:"ðŸ¥©"},{value:"dairy-eggs",label:"Dairy & Eggs",icon:"ðŸ¥›"},{value:"bakery",label:"Bakery",icon:"ðŸž"},{value:"pantry-staples",label:"Pantry Staples",icon:"ðŸŒ¾"},{value:"beverages",label:"Beverages",icon:"ðŸ¥¤"},{value:"snacks",label:"Snacks",icon:"ðŸ¿"},{value:"specialty",label:"Specialty Items",icon:"âœ¨"}],m=B=>{const{name:L,value:E}=B.target;if(L.startsWith("address.")){const P=L.split(".")[1];g(D=>({...D,address:{...D.address,[P]:E}}))}else g(P=>({...P,[L]:E}))},j=async B=>{const L=B.target.files[0];if(!L)return;if(!L.type.startsWith("image/")){c("Please upload an image file");return}if(L.size>5*1024*1024){c("Image size should be less than 5MB");return}const E=new FileReader;E.onload=async P=>{const D=new Image;D.crossOrigin="Anonymous",D.onload=()=>{try{const k=f.current.getPalette(D,5),C=k[0],z=(J,Z,oe)=>"#"+[J,Z,oe].map(ne=>ne.toString(16).padStart(2,"0")).join(""),G=z(...C),de=k[1]?z(...k[1]):"#FFC107";g(J=>({...J,logo:L,logoPreview:P.target.result,brandColors:{primary:G,secondary:de}}))}catch(k){console.error("Color extraction error:",k),g(C=>({...C,logo:L,logoPreview:P.target.result}))}},D.src=P.target.result},E.readAsDataURL(L),c("")},v=(B,L,E)=>{g(P=>({...P,businessHours:{...P.businessHours,[B]:{...P.businessHours[B],[L]:E}}}))},N=B=>{switch(B){case 1:if(!u.storeName.trim())return c("Store name is required"),!1;if(!u.description.trim())return c("Store description is required"),!1;break;case 2:if(!u.phone.trim())return c("Phone number is required"),!1;break;case 3:if(!u.address.street.trim()||!u.address.city.trim()||!u.address.state.trim())return c("Please fill in all address fields"),!1;break}return c(""),!0},b=()=>{N(t)&&n(B=>Math.min(B+1,5))},y=()=>{n(B=>Math.max(B-1,1)),c("")},_=async()=>{var B,L,E,P;o(!0),c("");try{const D={storeName:u.storeName,description:u.description,category:u.category,phone:u.phone,alternativePhone:u.alternativePhone||void 0,address:u.address,businessHours:u.businessHours,brandColors:u.brandColors};console.log("Sending profile data:",JSON.stringify(D,null,2));const k=await vf(D);k.success?(u.logo&&console.log("Logo upload will be implemented"),e?e():r("/dashboard")):c(k.message||"Failed to create vendor profile")}catch(D){if(console.error("Onboarding error:",D),(L=(B=D.response)==null?void 0:B.data)!=null&&L.errors&&Array.isArray(D.response.data.errors)){const k=D.response.data.errors.map(C=>`â€¢ ${C.field}: ${C.message}`).join(`
`);c(`Validation errors:
${k}`),console.error("Validation errors:",D.response.data.errors)}else c(((P=(E=D.response)==null?void 0:E.data)==null?void 0:P.message)||D.message||"Failed to create vendor profile")}finally{o(!1)}},T=[{number:1,title:"Store Info",icon:"ðŸª"},{number:2,title:"Contact",icon:"ðŸ“ž"},{number:3,title:"Location",icon:"ðŸ“"},{number:4,title:"Hours",icon:"ðŸ•"},{number:5,title:"Branding",icon:"ðŸŽ¨"}],O={enter:B=>({x:B>0?1e3:-1e3,opacity:0}),center:{zIndex:1,x:0,opacity:1},exit:B=>({zIndex:0,x:B<0?1e3:-1e3,opacity:0})};return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 py-12 px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"max-w-4xl mx-auto",children:[a.jsxs(Re.div,{className:"text-center mb-8",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},children:[a.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Welcome to Afrimercato! ðŸŽ‰"}),a.jsx("p",{className:"text-lg text-gray-600",children:"Let's set up your store in just 5 easy steps"})]}),a.jsx(Re.div,{className:"mb-8",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:a.jsx("div",{className:"flex justify-between items-center",children:T.map((B,L)=>a.jsxs("div",{className:"flex items-center flex-1",children:[a.jsxs("div",{className:"flex flex-col items-center flex-1",children:[a.jsx(Re.div,{className:`w-12 h-12 rounded-full flex items-center justify-center text-2xl border-4 transition-all duration-300 ${t>=B.number?"bg-afri-green border-afri-green text-white":"bg-white border-gray-300 text-gray-400"}`,whileHover:{scale:1.1},animate:{scale:t===B.number?[1,1.1,1]:1},transition:{duration:.3},children:B.icon}),a.jsx("span",{className:`mt-2 text-xs font-medium ${t>=B.number?"text-afri-green":"text-gray-400"}`,children:B.title})]}),L<T.length-1&&a.jsx("div",{className:`h-1 flex-1 mx-2 rounded transition-all duration-300 ${t>B.number?"bg-afri-green":"bg-gray-300"}`})]},B.number))})}),a.jsxs(Re.div,{className:"bg-white rounded-2xl shadow-xl p-8",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.5,delay:.3},children:[l&&a.jsx(Re.div,{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-6 rounded",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:a.jsx("p",{className:"text-red-700",children:l})}),a.jsxs(Ql,{mode:"wait",custom:t,children:[t===1&&a.jsxs(Re.div,{custom:1,variants:O,initial:"enter",animate:"center",exit:"exit",transition:{duration:.3},className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Tell us about your store"}),a.jsx("p",{className:"text-gray-600",children:"This information will help customers find and learn about your business"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Store Name *"}),a.jsx("input",{type:"text",name:"storeName",value:u.storeName,onChange:m,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"e.g., Fresh Valley Farms"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Store Description *"}),a.jsx("textarea",{name:"description",value:u.description,onChange:m,rows:"4",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"Describe what makes your store special..."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Store Category *"}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:p.map(B=>a.jsxs(Re.button,{type:"button",onClick:()=>g(L=>({...L,category:B.value})),className:`p-4 rounded-lg border-2 transition-all ${u.category===B.value?"border-afri-green bg-afri-green/10 text-afri-green":"border-gray-200 hover:border-gray-300"}`,whileHover:{scale:1.05},whileTap:{scale:.95},children:[a.jsx("div",{className:"text-3xl mb-1",children:B.icon}),a.jsx("div",{className:"text-xs font-medium",children:B.label})]},B.value))})]})]},"step1"),t===2&&a.jsxs(Re.div,{custom:2,variants:O,initial:"enter",animate:"center",exit:"exit",transition:{duration:.3},className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Contact Information"}),a.jsx("p",{className:"text-gray-600",children:"How can customers reach you?"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Primary Phone Number *"}),a.jsx("input",{type:"tel",name:"phone",value:u.phone,onChange:m,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"+234-800-555-0001"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Alternative Phone (Optional)"}),a.jsx("input",{type:"tel",name:"alternativePhone",value:u.alternativePhone,onChange:m,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"+234-800-555-0002"})]})]},"step2"),t===3&&a.jsxs(Re.div,{custom:3,variants:O,initial:"enter",animate:"center",exit:"exit",transition:{duration:.3},className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Where are you located?"}),a.jsx("p",{className:"text-gray-600",children:"Your business address"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Street Address *"}),a.jsx("input",{type:"text",name:"address.street",value:u.address.street,onChange:m,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"123 Main Street"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City *"}),a.jsx("input",{type:"text",name:"address.city",value:u.address.city,onChange:m,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"Lagos"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"State *"}),a.jsx("input",{type:"text",name:"address.state",value:u.address.state,onChange:m,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"Lagos State"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Country"}),a.jsx("input",{type:"text",name:"address.country",value:u.address.country,onChange:m,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition bg-gray-50",readOnly:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Postal Code"}),a.jsx("input",{type:"text",name:"address.postalCode",value:u.address.postalCode,onChange:m,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"100001"})]})]})]},"step3"),t===4&&a.jsxs(Re.div,{custom:4,variants:O,initial:"enter",animate:"center",exit:"exit",transition:{duration:.3},className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"When are you open?"}),a.jsx("p",{className:"text-gray-600",children:"Set your business hours for each day"})]}),a.jsx("div",{className:"space-y-4",children:Object.keys(u.businessHours).map(B=>a.jsxs("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-lg",children:[a.jsx("div",{className:"w-28",children:a.jsx("span",{className:"font-medium text-gray-700 capitalize",children:B})}),a.jsx("input",{type:"checkbox",checked:!u.businessHours[B].closed,onChange:L=>v(B,"closed",!L.target.checked),className:"h-5 w-5 text-afri-green focus:ring-afri-green border-gray-300 rounded"}),u.businessHours[B].closed?a.jsx("span",{className:"text-gray-400 italic",children:"Closed"}):a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"time",value:u.businessHours[B].open,onChange:L=>v(B,"open",L.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent"}),a.jsx("span",{className:"text-gray-500",children:"to"}),a.jsx("input",{type:"time",value:u.businessHours[B].close,onChange:L=>v(B,"close",L.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent"})]})]},B))})]},"step4"),t===5&&a.jsxs(Re.div,{custom:5,variants:O,initial:"enter",animate:"center",exit:"exit",transition:{duration:.3},className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Make it yours!"}),a.jsx("p",{className:"text-gray-600",children:"Upload your logo and we'll extract your brand colors automatically"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Store Logo"}),a.jsxs("div",{className:"flex items-center gap-6",children:[u.logoPreview?a.jsxs(Re.div,{className:"relative",initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200},children:[a.jsx("img",{src:u.logoPreview,alt:"Logo preview",className:"w-32 h-32 rounded-lg object-cover border-4 border-gray-200"}),a.jsx(Re.button,{type:"button",onClick:()=>g(B=>({...B,logo:null,logoPreview:null})),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 shadow-lg",whileHover:{scale:1.1},whileTap:{scale:.9},children:a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):a.jsxs(Re.button,{type:"button",onClick:()=>{var B;return(B=d.current)==null?void 0:B.click()},className:"w-32 h-32 border-2 border-dashed border-gray-300 rounded-lg flex flex-col items-center justify-center hover:border-afri-green hover:bg-afri-green/5 transition-all",whileHover:{scale:1.05},whileTap:{scale:.95},children:[a.jsx("svg",{className:"w-8 h-8 text-gray-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),a.jsx("span",{className:"text-xs text-gray-500",children:"Upload Logo"})]}),a.jsx("input",{ref:d,type:"file",accept:"image/*",onChange:j,className:"hidden"}),u.logoPreview&&a.jsxs(Re.div,{className:"flex-1",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:[a.jsx("p",{className:"text-sm font-medium text-gray-700 mb-3",children:"Extracted Brand Colors:"}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"h-16 rounded-lg shadow-md mb-2 border-2 border-white",style:{backgroundColor:u.brandColors.primary}}),a.jsx("p",{className:"text-xs text-gray-600 text-center font-mono",children:u.brandColors.primary}),a.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Primary"})]}),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"h-16 rounded-lg shadow-md mb-2 border-2 border-white",style:{backgroundColor:u.brandColors.secondary}}),a.jsx("p",{className:"text-xs text-gray-600 text-center font-mono",children:u.brandColors.secondary}),a.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Secondary"})]})]})]})]}),a.jsx("p",{className:"mt-3 text-sm text-gray-500",children:"Upload a square image (recommended: 500x500px, max 5MB)"})]}),a.jsxs(Re.div,{className:"bg-gradient-to-r from-afri-green/10 to-afri-yellow/10 p-6 rounded-lg border border-afri-green/20",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:[a.jsx("h4",{className:"font-bold text-gray-900 mb-2",children:"You're all set! ðŸŽ‰"}),a.jsx("p",{className:"text-gray-600 text-sm",children:'Click "Complete Setup" to create your vendor profile and start selling on Afrimercato!'})]})]},"step5")]}),a.jsxs("div",{className:"flex justify-between mt-8 pt-6 border-t",children:[a.jsx(Re.button,{type:"button",onClick:y,disabled:t===1,className:`px-6 py-3 rounded-lg font-medium transition-all ${t===1?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,whileHover:t!==1?{scale:1.05}:{},whileTap:t!==1?{scale:.95}:{},children:"â† Previous"}),t<5?a.jsx(Re.button,{type:"button",onClick:b,className:"px-8 py-3 bg-gradient-to-r from-afri-green to-afri-green-dark text-white rounded-lg font-semibold hover:from-afri-green-dark hover:to-afri-green transition-all shadow-lg",whileHover:{scale:1.05},whileTap:{scale:.95},children:"Next â†’"}):a.jsx(Re.button,{type:"button",onClick:_,disabled:s,className:"px-8 py-3 bg-gradient-to-r from-afri-green to-afri-green-dark text-white rounded-lg font-semibold hover:from-afri-green-dark hover:to-afri-green transition-all shadow-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",whileHover:{scale:s?1:1.05},whileTap:{scale:s?1:.95},children:s?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating..."]}):a.jsx(a.Fragment,{children:"Complete Setup âœ¨"})})]})]}),a.jsx(Re.p,{className:"mt-6 text-center text-sm text-gray-500",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:"Need help? Contact our support team at support@afrimercato.com"})]})})},sh=["#00B207","#FFD700","#FF6B6B","#4ECDC4","#95E1D3"];function kx(){var v,N,b,y,_,T,O,B,L,E;const[e,r]=ge.useState(null),[t,n]=ge.useState(null),[s,o]=ge.useState(!0),[l,c]=ge.useState("7d"),[d,f]=ge.useState(!1),[u,g]=ge.useState(!1);ge.useEffect(()=>{p(),setTimeout(()=>f(!0),100)},[l]);const p=async()=>{try{o(!0);const[P,D]=await Promise.all([xr.getDashboardStats(),xr.getChartData({timeRange:l})]);P.success&&r(P.data),D.success&&n(D.data),g(!1)}catch(P){console.error("Dashboard error:",P),P.message&&P.message.includes("Vendor profile not found")&&g(!0)}finally{o(!1)}},m=()=>{g(!1),p()},j=({title:P,value:D,icon:k,trend:C,color:z,delay:G})=>a.jsx("div",{className:`bg-white rounded-xl shadow-lg p-6 transform transition-all duration-700 hover:scale-105 hover:shadow-2xl ${d?"translate-y-0 opacity-100":"translate-y-4 opacity-0"}`,style:{transitionDelay:`${G}ms`},children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-medium text-afri-gray-600 mb-1",children:P}),a.jsx("h3",{className:"text-3xl font-bold text-afri-gray-900",children:D}),C&&a.jsxs("div",{className:`flex items-center mt-2 text-sm ${C>=0?"text-green-600":"text-red-600"}`,children:[a.jsx("svg",{className:`w-4 h-4 mr-1 transform ${C>=0?"":"rotate-180"}`,fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M12 7a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0V8.414l-4.293 4.293a1 1 0 01-1.414 0L8 10.414l-4.293 4.293a1 1 0 01-1.414-1.414l5-5a1 1 0 011.414 0L11 10.586 14.586 7H12z",clipRule:"evenodd"})}),a.jsxs("span",{className:"font-semibold",children:[Math.abs(C),"%"]}),a.jsx("span",{className:"ml-1 text-afri-gray-500",children:"vs last period"})]})]}),a.jsx("div",{className:`w-16 h-16 rounded-full bg-gradient-to-br ${z} flex items-center justify-center text-white text-3xl shadow-lg transform transition-transform duration-300 hover:rotate-12`,children:k})]})});return u&&!s?a.jsx(Ax,{onComplete:m}):s?a.jsx("div",{className:"flex justify-center items-center h-screen",children:a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"w-20 h-20 border-4 border-afri-green border-t-transparent rounded-full animate-spin"}),a.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:a.jsx("div",{className:"w-12 h-12 border-4 border-afri-yellow border-t-transparent rounded-full animate-spin"})})]})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-afri-green to-afri-green-dark bg-clip-text text-transparent",children:"Dashboard"}),a.jsx("p",{className:"text-afri-gray-600 mt-2",children:"Welcome back! Here's what's happening with your store."})]}),a.jsx("div",{className:"mt-4 md:mt-0",children:a.jsx("div",{className:"inline-flex rounded-lg border border-gray-200 bg-white p-1 shadow-sm",children:["7d","30d","90d"].map(P=>a.jsx("button",{onClick:()=>c(P),className:`px-4 py-2 rounded-md font-medium transition-all duration-300 ${l===P?"bg-gradient-to-r from-afri-green to-afri-green-dark text-white shadow-md":"text-afri-gray-700 hover:bg-afri-gray-50"}`,children:P==="7d"?"Last 7 Days":P==="30d"?"Last 30 Days":"Last 90 Days"},P))})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[a.jsx(j,{title:"Total Revenue",value:`Â£${((N=(v=e==null?void 0:e.revenue)==null?void 0:v.total)==null?void 0:N.toFixed(2))||"0.00"}`,icon:"ðŸ’°",trend:(b=e==null?void 0:e.revenue)==null?void 0:b.trend,color:"from-green-400 to-green-600",delay:0}),a.jsx(j,{title:"Total Orders",value:((y=e==null?void 0:e.orders)==null?void 0:y.total)||0,icon:"ðŸ›’",trend:(_=e==null?void 0:e.orders)==null?void 0:_.trend,color:"from-blue-400 to-blue-600",delay:100}),a.jsx(j,{title:"Total Products",value:((T=e==null?void 0:e.products)==null?void 0:T.total)||0,icon:"ðŸ“¦",trend:(O=e==null?void 0:e.products)==null?void 0:O.trend,color:"from-purple-400 to-purple-600",delay:200}),a.jsx(j,{title:"Average Order Value",value:`Â£${((L=(B=e==null?void 0:e.revenue)==null?void 0:B.avgOrderValue)==null?void 0:L.toFixed(2))||"0.00"}`,icon:"ðŸ“Š",trend:(E=e==null?void 0:e.revenue)==null?void 0:E.avgTrend,color:"from-yellow-400 to-yellow-600",delay:300})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 transform transition-all duration-500 hover:shadow-2xl",children:[a.jsxs("h3",{className:"text-lg font-semibold text-afri-gray-900 mb-4 flex items-center",children:[a.jsx("span",{className:"w-3 h-3 bg-gradient-to-r from-afri-green to-afri-green-dark rounded-full mr-2"}),"Revenue Trend"]}),a.jsx(d0,{width:"100%",height:300,children:a.jsxs(fm,{data:(t==null?void 0:t.revenueData)||[],children:[a.jsx("defs",{children:a.jsxs("linearGradient",{id:"revenueGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[a.jsx("stop",{offset:"5%",stopColor:"#00B207",stopOpacity:.8}),a.jsx("stop",{offset:"95%",stopColor:"#00B207",stopOpacity:.1})]})}),a.jsx(Jd,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),a.jsx(Zd,{dataKey:"date",stroke:"#6B7280"}),a.jsx(Qd,{stroke:"#6B7280"}),a.jsx(h0,{contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"}}),a.jsx(eh,{}),a.jsx(um,{type:"monotone",dataKey:"revenue",stroke:"#00B207",strokeWidth:3,fill:"url(#revenueGradient)",dot:{fill:"#00B207",r:5},activeDot:{r:8,stroke:"#FFD700",strokeWidth:2}})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 transform transition-all duration-500 hover:shadow-2xl",children:[a.jsxs("h3",{className:"text-lg font-semibold text-afri-gray-900 mb-4 flex items-center",children:[a.jsx("span",{className:"w-3 h-3 bg-gradient-to-r from-blue-400 to-blue-600 rounded-full mr-2"}),"Orders Overview"]}),a.jsx(d0,{width:"100%",height:300,children:a.jsxs(mm,{data:(t==null?void 0:t.ordersData)||[],children:[a.jsx("defs",{children:a.jsxs("linearGradient",{id:"ordersGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[a.jsx("stop",{offset:"5%",stopColor:"#3B82F6",stopOpacity:.8}),a.jsx("stop",{offset:"95%",stopColor:"#3B82F6",stopOpacity:.3})]})}),a.jsx(Jd,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),a.jsx(Zd,{dataKey:"date",stroke:"#6B7280"}),a.jsx(Qd,{stroke:"#6B7280"}),a.jsx(h0,{contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"}}),a.jsx(eh,{}),a.jsx(xm,{dataKey:"orders",fill:"url(#ordersGradient)",radius:[8,8,0,0]})]})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 transform transition-all duration-500 hover:shadow-2xl",children:[a.jsxs("h3",{className:"text-lg font-semibold text-afri-gray-900 mb-4 flex items-center",children:[a.jsx("span",{className:"w-3 h-3 bg-gradient-to-r from-purple-400 to-purple-600 rounded-full mr-2"}),"Order Status Distribution"]}),a.jsx(d0,{width:"100%",height:300,children:a.jsxs(pm,{children:[a.jsx(gm,{data:(t==null?void 0:t.orderStatusData)||[],cx:"50%",cy:"50%",labelLine:!1,label:({name:P,percent:D})=>`${P}: ${(D*100).toFixed(0)}%`,outerRadius:100,fill:"#8884d8",dataKey:"value",animationBegin:0,animationDuration:800,children:((t==null?void 0:t.orderStatusData)||[]).map((P,D)=>a.jsx(vm,{fill:sh[D%sh.length]},`cell-${D}`))}),a.jsx(h0,{})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 transform transition-all duration-500 hover:shadow-2xl",children:[a.jsxs("h3",{className:"text-lg font-semibold text-afri-gray-900 mb-4 flex items-center",children:[a.jsx("span",{className:"w-3 h-3 bg-gradient-to-r from-afri-yellow to-afri-yellow-dark rounded-full mr-2"}),"Top Selling Products"]}),a.jsx("div",{className:"space-y-3",children:((e==null?void 0:e.topProducts)||[]).slice(0,5).map((P,D)=>{var k;return a.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-gradient-to-r from-afri-gray-50 to-white hover:from-afri-green hover:to-afri-green-dark hover:text-white transition-all duration-300 cursor-pointer group",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-afri-green to-afri-green-dark text-white flex items-center justify-center font-bold group-hover:scale-110 transition-transform",children:D+1}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium group-hover:text-white",children:P.name}),a.jsxs("p",{className:"text-sm text-afri-gray-500 group-hover:text-white group-hover:opacity-80",children:[P.soldQuantity," sold"]})]})]}),a.jsxs("span",{className:"font-bold text-afri-green group-hover:text-white",children:["Â£",(k=P.revenue)==null?void 0:k.toFixed(2)]})]},P._id)})})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 transform transition-all duration-500 hover:shadow-2xl",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h3",{className:"text-lg font-semibold text-afri-gray-900 flex items-center",children:[a.jsx("span",{className:"w-3 h-3 bg-gradient-to-r from-afri-green to-afri-green-dark rounded-full mr-2"}),"Recent Orders"]}),a.jsxs(Ie,{to:"/orders",className:"text-afri-green hover:text-afri-green-dark font-medium transition-colors duration-200 flex items-center group",children:["View All",a.jsx("svg",{className:"w-4 h-4 ml-1 transform group-hover:translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full",children:[a.jsx("thead",{className:"bg-afri-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Order #"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Customer"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Total"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Date"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:((e==null?void 0:e.recentOrders)||[]).slice(0,5).map(P=>{var D,k,C;return a.jsxs("tr",{className:"hover:bg-gradient-to-r hover:from-afri-gray-50 hover:to-white transition-all duration-200 cursor-pointer",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-afri-gray-900",children:P.orderNumber}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-afri-gray-500",children:((D=P.customer)==null?void 0:D.name)||"N/A"}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-afri-green",children:["Â£",((C=(k=P.pricing)==null?void 0:k.total)==null?void 0:C.toFixed(2))||"0.00"]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-gradient-to-r from-afri-green to-afri-green-dark text-white",children:P.status})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-afri-gray-500",children:new Date(P.createdAt).toLocaleDateString()})]},P._id)})})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsx(Ie,{to:"/products",className:"bg-gradient-to-br from-afri-green to-afri-green-dark text-white rounded-xl shadow-lg p-6 transform transition-all duration-300 hover:scale-105 hover:shadow-2xl group",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-semibold mb-2",children:"Manage Products"}),a.jsx("p",{className:"text-sm opacity-90",children:"Add, edit, or remove products"})]}),a.jsx("svg",{className:"w-10 h-10 opacity-75 group-hover:scale-110 transition-transform",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{d:"M3 1a1 1 0 000 2h1.22l.305 1.222a.997.997 0 00.01.042l1.358 5.43-.893.892C3.74 11.846 4.632 14 6.414 14H15a1 1 0 000-2H6.414l1-1H14a1 1 0 00.894-.553l3-6A1 1 0 0017 3H6.28l-.31-1.243A1 1 0 005 1H3zM16 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM6.5 18a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"})})]})}),a.jsx(Ie,{to:"/orders",className:"bg-gradient-to-br from-blue-500 to-blue-700 text-white rounded-xl shadow-lg p-6 transform transition-all duration-300 hover:scale-105 hover:shadow-2xl group",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-semibold mb-2",children:"Process Orders"}),a.jsx("p",{className:"text-sm opacity-90",children:"View and manage orders"})]}),a.jsxs("svg",{className:"w-10 h-10 opacity-75 group-hover:scale-110 transition-transform",fill:"currentColor",viewBox:"0 0 20 20",children:[a.jsx("path",{d:"M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"}),a.jsx("path",{fillRule:"evenodd",d:"M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm9.707 5.707a1 1 0 00-1.414-1.414L9 12.586l-1.293-1.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})]})]})}),a.jsx(Ie,{to:"/reports",className:"bg-gradient-to-br from-purple-500 to-purple-700 text-white rounded-xl shadow-lg p-6 transform transition-all duration-300 hover:scale-105 hover:shadow-2xl group",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-semibold mb-2",children:"View Reports"}),a.jsx("p",{className:"text-sm opacity-90",children:"Analytics and insights"})]}),a.jsx("svg",{className:"w-10 h-10 opacity-75 group-hover:scale-110 transition-transform",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{d:"M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z"})})]})})]})]})}const Tx=["fruits","vegetables","grains","dairy","meat","fish","poultry","bakery","beverages","spices","snacks","household","beauty","other"],Cx=["kg","g","lb","piece","bunch","pack","liter","ml","dozen"];function Ex({product:e,onClose:r,onSave:t}){const[n,s]=ge.useState({name:"",description:"",category:"fruits",price:"",originalPrice:"",unit:"kg",stock:"",lowStockThreshold:10,inStock:!0,isActive:!0}),[o,l]=ge.useState([]),[c,d]=ge.useState([]),[f,u]=ge.useState(!1),[g,p]=ge.useState({});ge.useEffect(()=>{e&&(s({name:e.name||"",description:e.description||"",category:e.category||"fruits",price:e.price||"",originalPrice:e.originalPrice||"",unit:e.unit||"kg",stock:e.stock||"",lowStockThreshold:e.lowStockThreshold||10,inStock:e.inStock!==void 0?e.inStock:!0,isActive:e.isActive!==void 0?e.isActive:!0}),e.images&&e.images.length>0&&d(e.images.map(y=>y.url)))},[e]);const m=y=>{const{name:_,value:T,type:O,checked:B}=y.target;s(L=>({...L,[_]:O==="checkbox"?B:T})),g[_]&&p(L=>({...L,[_]:""}))},j=y=>{const _=Array.from(y.target.files);if(_.length>5){alert("You can only upload up to 5 images");return}l(_);const T=_.map(O=>URL.createObjectURL(O));d(T)},v=y=>{l(_=>_.filter((T,O)=>O!==y)),d(_=>_.filter((T,O)=>O!==y))},N=()=>{const y={};return n.name.trim()||(y.name="Product name is required"),n.description.trim()||(y.description="Description is required"),(!n.price||n.price<=0)&&(y.price="Valid price is required"),(!n.stock||n.stock<0)&&(y.stock="Valid stock quantity is required"),p(y),Object.keys(y).length===0},b=async y=>{var _,T;if(y.preventDefault(),!!N())try{u(!0);let O=(e==null?void 0:e.images)||[];if(o.length>0){const E=await xr.uploadProductImages(o);E.success&&(O=E.data.images)}const B={...n,price:parseFloat(n.price),originalPrice:n.originalPrice?parseFloat(n.originalPrice):void 0,stock:parseInt(n.stock),lowStockThreshold:parseInt(n.lowStockThreshold),images:O};let L;e?L=await xr.updateProduct(e._id,B):L=await xr.createProduct(B),L.success&&(alert(e?"Product updated successfully!":"Product created successfully!"),t())}catch(O){console.error("Product save error:",O),alert(((T=(_=O.response)==null?void 0:_.data)==null?void 0:T.message)||"Failed to save product")}finally{u(!1)}};return a.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm transition-opacity",onClick:r}),a.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:a.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto transform transition-all animate-slideUp",children:[a.jsx("div",{className:"sticky top-0 bg-gradient-to-r from-afri-green to-afri-green-dark text-white px-6 py-4 rounded-t-2xl z-10",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h2",{className:"text-2xl font-bold",children:e?"Edit Product":"Add New Product"}),a.jsx("button",{onClick:r,className:"text-white hover:text-afri-yellow transition-colors p-2 hover:bg-white hover:bg-opacity-20 rounded-lg",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),a.jsxs("form",{onSubmit:b,className:"p-6 space-y-6",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:["Product Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"name",value:n.name,onChange:m,className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all ${g.name?"border-red-500":"border-gray-300"}`,placeholder:"e.g., Fresh Organic Tomatoes"}),g.name&&a.jsx("p",{className:"mt-1 text-sm text-red-500",children:g.name})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:["Description ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("textarea",{name:"description",value:n.description,onChange:m,rows:4,className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all ${g.description?"border-red-500":"border-gray-300"}`,placeholder:"Describe your product..."}),g.description&&a.jsx("p",{className:"mt-1 text-sm text-red-500",children:g.description})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Category"}),a.jsx("select",{name:"category",value:n.category,onChange:m,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all",children:Tx.map(y=>a.jsx("option",{value:y,children:y.charAt(0).toUpperCase()+y.slice(1)},y))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Unit"}),a.jsx("select",{name:"unit",value:n.unit,onChange:m,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all",children:Cx.map(y=>a.jsx("option",{value:y,children:y},y))})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:["Price (Â£) ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"number",name:"price",value:n.price,onChange:m,step:"0.01",min:"0",className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all ${g.price?"border-red-500":"border-gray-300"}`,placeholder:"0.00"}),g.price&&a.jsx("p",{className:"mt-1 text-sm text-red-500",children:g.price})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Original Price (Â£)"}),a.jsx("input",{type:"number",name:"originalPrice",value:n.originalPrice,onChange:m,step:"0.01",min:"0",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all",placeholder:"0.00 (optional)"}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"For showing discounts"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:["Stock Quantity ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"number",name:"stock",value:n.stock,onChange:m,min:"0",className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all ${g.stock?"border-red-500":"border-gray-300"}`,placeholder:"0"}),g.stock&&a.jsx("p",{className:"mt-1 text-sm text-red-500",children:g.stock})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Low Stock Alert"}),a.jsx("input",{type:"number",name:"lowStockThreshold",value:n.lowStockThreshold,onChange:m,min:"0",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all",placeholder:"10"}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Get alert when stock is below this number"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Product Images"}),a.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 hover:border-afri-green transition-colors",children:[a.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:j,className:"hidden",id:"product-images"}),a.jsxs("label",{htmlFor:"product-images",className:"flex flex-col items-center cursor-pointer text-center",children:[a.jsx("svg",{className:"w-12 h-12 text-gray-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),a.jsx("p",{className:"text-sm text-gray-600",children:"Click to upload images (max 5)"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"PNG, JPG, GIF up to 10MB"})]})]}),c.length>0&&a.jsx("div",{className:"mt-4 grid grid-cols-5 gap-4",children:c.map((y,_)=>a.jsxs("div",{className:"relative group",children:[a.jsx("img",{src:y,alt:`Preview ${_+1}`,className:"w-full h-24 object-cover rounded-lg border-2 border-gray-200 group-hover:border-afri-green transition-all"}),a.jsx("button",{type:"button",onClick:()=>v(_),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity shadow-lg hover:bg-red-600",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},_))})]}),a.jsxs("div",{className:"flex items-center space-x-6",children:[a.jsxs("label",{className:"flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",name:"inStock",checked:n.inStock,onChange:m,className:"w-5 h-5 text-afri-green border-gray-300 rounded focus:ring-afri-green cursor-pointer"}),a.jsx("span",{className:"ml-2 text-sm font-medium text-afri-gray-900",children:"In Stock"})]}),a.jsxs("label",{className:"flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",name:"isActive",checked:n.isActive,onChange:m,className:"w-5 h-5 text-afri-green border-gray-300 rounded focus:ring-afri-green cursor-pointer"}),a.jsx("span",{className:"ml-2 text-sm font-medium text-afri-gray-900",children:"Active"})]})]}),a.jsxs("div",{className:"flex items-center justify-end space-x-4 pt-6 border-t",children:[a.jsx("button",{type:"button",onClick:r,className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-all",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:f,className:"px-6 py-3 bg-gradient-to-r from-afri-green to-afri-green-dark text-white rounded-lg font-semibold shadow-lg hover:shadow-xl transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center",children:f?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):a.jsx(a.Fragment,{children:e?"Update Product":"Create Product"})})]})]})]})}),a.jsx("style",{jsx:!0,children:`
        @keyframes slideUp {
          from {
            opacity: 0;
            transform: translateY(20px) scale(0.95);
          }
          to {
            opacity: 1;
            transform: translateY(0) scale(1);
          }
        }

        .animate-slideUp {
          animation: slideUp 0.3s ease-out;
        }
      `})]})}function Lx({selectedProducts:e,onClose:r,onComplete:t}){const[n,s]=ge.useState("delete"),[o,l]=ge.useState({isActive:!0,priceType:"percentage",priceValue:"",stockType:"adjust",stockValue:""}),[c,d]=ge.useState(!1),f=async g=>{var p,m;g.preventDefault(),d(!0);try{let j;switch(n){case"delete":if(!confirm(`Delete ${e.length} products? This cannot be undone.`)){d(!1);return}j=await xr.bulkDeleteProducts({productIds:e});break;case"status":j=await xr.bulkUpdateStatus({productIds:e,isActive:o.isActive});break;case"price":if(!o.priceValue||o.priceValue==="0"){alert("Please enter a valid price value"),d(!1);return}j=await xr.bulkUpdatePrices({productIds:e,type:o.priceType,value:parseFloat(o.priceValue)});break;case"stock":if(!o.stockValue||o.stockValue==="0"){alert("Please enter a valid stock value"),d(!1);return}j=await xr.bulkUpdateStock({productIds:e,type:o.stockType,value:parseInt(o.stockValue)});break;default:throw new Error("Invalid action")}j.success&&(alert(`Successfully updated ${e.length} products!`),t())}catch(j){console.error("Bulk action error:",j),alert(((m=(p=j.response)==null?void 0:p.data)==null?void 0:m.message)||"Failed to perform bulk action")}finally{d(!1)}},u=()=>{switch(n){case"delete":return a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start",children:[a.jsx("svg",{className:"w-6 h-6 text-red-600 mt-0.5 mr-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold text-red-900 mb-1",children:"Warning: Permanent Deletion"}),a.jsxs("p",{className:"text-sm text-red-700",children:["You are about to delete ",a.jsxs("span",{className:"font-bold",children:[e.length," products"]}),". This action cannot be undone."]})]})]})});case"status":return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("p",{className:"text-sm text-afri-gray-600",children:["Change status for ",a.jsxs("span",{className:"font-semibold",children:[e.length," products"]})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("label",{className:"flex items-center cursor-pointer",children:[a.jsx("input",{type:"radio",name:"status",checked:o.isActive===!0,onChange:()=>l({...o,isActive:!0}),className:"w-5 h-5 text-afri-green border-gray-300 focus:ring-afri-green cursor-pointer"}),a.jsx("span",{className:"ml-2 text-sm font-medium text-afri-gray-900",children:"Activate"})]}),a.jsxs("label",{className:"flex items-center cursor-pointer",children:[a.jsx("input",{type:"radio",name:"status",checked:o.isActive===!1,onChange:()=>l({...o,isActive:!1}),className:"w-5 h-5 text-afri-green border-gray-300 focus:ring-afri-green cursor-pointer"}),a.jsx("span",{className:"ml-2 text-sm font-medium text-afri-gray-900",children:"Deactivate"})]})]})]});case"price":return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("p",{className:"text-sm text-afri-gray-600",children:["Update prices for ",a.jsxs("span",{className:"font-semibold",children:[e.length," products"]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-afri-gray-700 mb-2",children:"Update Type"}),a.jsxs("select",{value:o.priceType,onChange:g=>l({...o,priceType:g.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent",children:[a.jsx("option",{value:"percentage",children:"Percentage (%)"}),a.jsx("option",{value:"fixed",children:"Fixed Amount (Â£)"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-afri-gray-700 mb-2",children:o.priceType==="percentage"?"Percentage":"Amount (Â£)"}),a.jsx("input",{type:"number",step:"0.01",value:o.priceValue,onChange:g=>l({...o,priceValue:g.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent",placeholder:"0.00"})]})]}),a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:a.jsx("p",{className:"text-sm text-blue-800",children:o.priceType==="percentage"?a.jsxs(a.Fragment,{children:[o.priceValue>0?"Increase":"Decrease"," prices by"," ",a.jsxs("span",{className:"font-bold",children:[Math.abs(o.priceValue),"%"]})]}):a.jsxs(a.Fragment,{children:[o.priceValue>0?"Add":"Subtract"," ",a.jsxs("span",{className:"font-bold",children:["Â£",Math.abs(o.priceValue)]})," to/from prices"]})})})]});case"stock":return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("p",{className:"text-sm text-afri-gray-600",children:["Update stock for ",a.jsxs("span",{className:"font-semibold",children:[e.length," products"]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-afri-gray-700 mb-2",children:"Update Type"}),a.jsxs("select",{value:o.stockType,onChange:g=>l({...o,stockType:g.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent",children:[a.jsx("option",{value:"adjust",children:"Adjust (+/-)"}),a.jsx("option",{value:"set",children:"Set to Value"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-afri-gray-700 mb-2",children:"Quantity"}),a.jsx("input",{type:"number",value:o.stockValue,onChange:g=>l({...o,stockValue:g.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent",placeholder:"0"})]})]}),a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:a.jsx("p",{className:"text-sm text-blue-800",children:o.stockType==="adjust"?a.jsxs(a.Fragment,{children:[o.stockValue>0?"Add":"Remove"," ",a.jsx("span",{className:"font-bold",children:Math.abs(o.stockValue)})," units"]}):a.jsxs(a.Fragment,{children:["Set stock to ",a.jsx("span",{className:"font-bold",children:o.stockValue})," units"]})})})]});default:return null}};return a.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm transition-opacity",onClick:r}),a.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:a.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl max-w-2xl w-full transform transition-all animate-slideUp",children:[a.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white px-6 py-4 rounded-t-2xl",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Bulk Actions"}),a.jsx("button",{onClick:r,className:"text-white hover:text-afri-yellow transition-colors p-2 hover:bg-white hover:bg-opacity-20 rounded-lg",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsxs("p",{className:"text-sm opacity-90 mt-1",children:[e.length," product",e.length>1?"s":""," selected"]})]}),a.jsxs("form",{onSubmit:f,className:"p-6 space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-3",children:"Select Action"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("button",{type:"button",onClick:()=>s("delete"),className:`p-4 rounded-lg border-2 transition-all transform hover:scale-105 ${n==="delete"?"border-red-500 bg-red-50 shadow-lg":"border-gray-200 hover:border-gray-300"}`,children:[a.jsx("div",{className:"text-3xl mb-2",children:"ðŸ—‘ï¸"}),a.jsx("div",{className:"font-semibold text-afri-gray-900",children:"Delete"}),a.jsx("div",{className:"text-xs text-afri-gray-500 mt-1",children:"Remove products"})]}),a.jsxs("button",{type:"button",onClick:()=>s("status"),className:`p-4 rounded-lg border-2 transition-all transform hover:scale-105 ${n==="status"?"border-afri-green bg-green-50 shadow-lg":"border-gray-200 hover:border-gray-300"}`,children:[a.jsx("div",{className:"text-3xl mb-2",children:"ðŸ”„"}),a.jsx("div",{className:"font-semibold text-afri-gray-900",children:"Status"}),a.jsx("div",{className:"text-xs text-afri-gray-500 mt-1",children:"Activate/Deactivate"})]}),a.jsxs("button",{type:"button",onClick:()=>s("price"),className:`p-4 rounded-lg border-2 transition-all transform hover:scale-105 ${n==="price"?"border-blue-500 bg-blue-50 shadow-lg":"border-gray-200 hover:border-gray-300"}`,children:[a.jsx("div",{className:"text-3xl mb-2",children:"ðŸ’°"}),a.jsx("div",{className:"font-semibold text-afri-gray-900",children:"Price"}),a.jsx("div",{className:"text-xs text-afri-gray-500 mt-1",children:"Update prices"})]}),a.jsxs("button",{type:"button",onClick:()=>s("stock"),className:`p-4 rounded-lg border-2 transition-all transform hover:scale-105 ${n==="stock"?"border-purple-500 bg-purple-50 shadow-lg":"border-gray-200 hover:border-gray-300"}`,children:[a.jsx("div",{className:"text-3xl mb-2",children:"ðŸ“¦"}),a.jsx("div",{className:"font-semibold text-afri-gray-900",children:"Stock"}),a.jsx("div",{className:"text-xs text-afri-gray-500 mt-1",children:"Adjust inventory"})]})]})]}),a.jsx("div",{className:"border-t pt-6",children:u()}),a.jsxs("div",{className:"flex items-center justify-end space-x-4 pt-6 border-t",children:[a.jsx("button",{type:"button",onClick:r,className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-all",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:c,className:`px-6 py-3 text-white rounded-lg font-semibold shadow-lg hover:shadow-xl transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center ${n==="delete"?"bg-gradient-to-r from-red-600 to-red-700":"bg-gradient-to-r from-afri-green to-afri-green-dark"}`,children:c?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):`Apply to ${e.length} Product${e.length>1?"s":""}`})]})]})]})}),a.jsx("style",{jsx:!0,children:`
        @keyframes slideUp {
          from {
            opacity: 0;
            transform: translateY(20px) scale(0.95);
          }
          to {
            opacity: 1;
            transform: translateY(0) scale(1);
          }
        }

        .animate-slideUp {
          animation: slideUp 0.3s ease-out;
        }
      `})]})}const Fx=["fruits","vegetables","grains","dairy","meat","fish","poultry","bakery","beverages","spices","snacks","household","beauty","other"];function Px(){const[e,r]=ge.useState([]),[t,n]=ge.useState(!0),[s,o]=ge.useState(!1),[l,c]=ge.useState(!1),[d,f]=ge.useState(null),[u,g]=ge.useState([]),[p,m]=ge.useState({search:"",category:"",status:"",page:1,limit:20}),[j,v]=ge.useState({});ge.useEffect(()=>{N()},[p]);const N=async()=>{try{n(!0);const E=await xr.getProducts(p);E.success&&(r(E.data.products),v(E.data.pagination))}catch(E){console.error("Error fetching products:",E)}finally{n(!1)}},b=()=>{f(null),o(!0)},y=E=>{f(E),o(!0)},_=async E=>{var P,D;if(confirm("Are you sure you want to delete this product?"))try{(await xr.deleteProduct(E)).success&&(N(),alert("Product deleted successfully!"))}catch(k){alert(((D=(P=k.response)==null?void 0:P.data)==null?void 0:D.message)||"Failed to delete product")}},T=E=>{g(P=>P.includes(E)?P.filter(D=>D!==E):[...P,E])},O=()=>{u.length===e.length?g([]):g(e.map(E=>E._id))},B=()=>{if(u.length===0){alert("Please select products first");return}c(!0)},L=E=>E.inStock?E.stock<=E.lowStockThreshold?a.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800",children:"Low Stock"}):a.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800",children:"In Stock"}):a.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800",children:"Out of Stock"});return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-afri-green to-afri-green-dark bg-clip-text text-transparent",children:"Products"}),a.jsx("p",{className:"text-afri-gray-600 mt-2",children:"Manage your inventory and product listings"})]}),a.jsxs("button",{onClick:b,className:"mt-4 md:mt-0 bg-gradient-to-r from-afri-green to-afri-green-dark text-white px-6 py-3 rounded-lg font-semibold shadow-lg transform transition-all duration-300 hover:scale-105 hover:shadow-xl flex items-center group",children:[a.jsx("svg",{className:"w-5 h-5 mr-2 transform group-hover:rotate-90 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Product"]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsx("div",{className:"md:col-span-2",children:a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Search products...",value:p.search,onChange:E=>m({...p,search:E.target.value,page:1}),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all"}),a.jsx("svg",{className:"absolute left-3 top-3.5 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})}),a.jsxs("select",{value:p.category,onChange:E=>m({...p,category:E.target.value,page:1}),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all",children:[a.jsx("option",{value:"",children:"All Categories"}),Fx.map(E=>a.jsx("option",{value:E,children:E.charAt(0).toUpperCase()+E.slice(1)},E))]}),a.jsxs("select",{value:p.status,onChange:E=>m({...p,status:E.target.value,page:1}),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all",children:[a.jsx("option",{value:"",children:"All Status"}),a.jsx("option",{value:"active",children:"Active"}),a.jsx("option",{value:"inactive",children:"Inactive"}),a.jsx("option",{value:"low-stock",children:"Low Stock"}),a.jsx("option",{value:"out-of-stock",children:"Out of Stock"})]})]}),u.length>0&&a.jsxs("div",{className:"mt-4 p-4 bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg border border-blue-200 flex items-center justify-between animate-slideDown",children:[a.jsx("div",{className:"flex items-center",children:a.jsxs("span",{className:"font-semibold text-blue-900",children:[u.length," products selected"]})}),a.jsx("button",{onClick:B,className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white px-4 py-2 rounded-lg font-medium hover:from-blue-700 hover:to-blue-800 transition-all transform hover:scale-105",children:"Bulk Actions"})]})]}),t?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"relative",children:a.jsx("div",{className:"w-20 h-20 border-4 border-afri-green border-t-transparent rounded-full animate-spin"})})}):e.length===0?a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-12 text-center",children:[a.jsx("svg",{className:"w-24 h-24 text-afri-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),a.jsx("h3",{className:"text-xl font-semibold text-afri-gray-900 mb-2",children:"No products found"}),a.jsx("p",{className:"text-afri-gray-500 mb-6",children:p.search||p.category||p.status?"Try adjusting your filters":"Get started by adding your first product"}),a.jsx("button",{onClick:b,className:"bg-gradient-to-r from-afri-green to-afri-green-dark text-white px-6 py-3 rounded-lg font-semibold shadow-lg hover:shadow-xl transition-all transform hover:scale-105",children:"Add Your First Product"})]}):a.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gradient-to-r from-afri-gray-50 to-afri-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-4",children:a.jsx("input",{type:"checkbox",checked:u.length===e.length,onChange:O,className:"w-4 h-4 text-afri-green border-gray-300 rounded focus:ring-afri-green cursor-pointer"})}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-afri-gray-700 uppercase tracking-wider",children:"Product"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-afri-gray-700 uppercase tracking-wider",children:"Category"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-afri-gray-700 uppercase tracking-wider",children:"Price"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-afri-gray-700 uppercase tracking-wider",children:"Stock"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-afri-gray-700 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-afri-gray-700 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map((E,P)=>a.jsxs("tr",{className:"hover:bg-gradient-to-r hover:from-afri-gray-50 hover:to-white transition-all duration-200 animate-fadeIn",style:{animationDelay:`${P*50}ms`},children:[a.jsx("td",{className:"px-6 py-4",children:a.jsx("input",{type:"checkbox",checked:u.includes(E._id),onChange:()=>T(E._id),className:"w-4 h-4 text-afri-green border-gray-300 rounded focus:ring-afri-green cursor-pointer"})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"h-12 w-12 flex-shrink-0 rounded-lg overflow-hidden bg-afri-gray-100 shadow-sm",children:E.images&&E.images.length>0?a.jsx("img",{src:E.images[0].url,alt:E.name,className:"h-full w-full object-cover transform hover:scale-110 transition-transform duration-300"}):a.jsx("div",{className:"h-full w-full flex items-center justify-center text-afri-gray-400",children:"ðŸ“¦"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("div",{className:"text-sm font-semibold text-afri-gray-900",children:E.name}),a.jsx("div",{className:"text-sm text-afri-gray-500",children:E.unit})]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800",children:E.category})}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[a.jsxs("div",{className:"text-sm font-bold text-afri-green",children:["Â£",E.price.toFixed(2)]}),E.originalPrice&&E.originalPrice>E.price&&a.jsxs("div",{className:"text-xs text-gray-400 line-through",children:["Â£",E.originalPrice.toFixed(2)]})]}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[a.jsx("div",{className:"text-sm text-afri-gray-900 font-semibold",children:E.stock}),E.lowStockThreshold&&a.jsxs("div",{className:"text-xs text-gray-500",children:["Min: ",E.lowStockThreshold]})]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:L(E)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:a.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[a.jsx("button",{onClick:()=>y(E),className:"text-blue-600 hover:text-blue-900 transition-colors p-2 hover:bg-blue-50 rounded-lg group",title:"Edit",children:a.jsx("svg",{className:"w-5 h-5 transform group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),a.jsx("button",{onClick:()=>_(E._id),className:"text-red-600 hover:text-red-900 transition-colors p-2 hover:bg-red-50 rounded-lg group",title:"Delete",children:a.jsx("svg",{className:"w-5 h-5 transform group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},E._id))})]})}),j.pages>1&&a.jsx("div",{className:"px-6 py-4 bg-gradient-to-r from-afri-gray-50 to-white border-t border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"text-sm text-afri-gray-700",children:["Showing ",a.jsx("span",{className:"font-semibold",children:(j.currentPage-1)*p.limit+1})," to"," ",a.jsx("span",{className:"font-semibold",children:Math.min(j.currentPage*p.limit,j.total)})," ","of ",a.jsx("span",{className:"font-semibold",children:j.total})," products"]}),a.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[a.jsx("button",{onClick:()=>m({...p,page:p.page-1}),disabled:j.currentPage===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:a.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),[...Array(j.pages)].map((E,P)=>a.jsx("button",{onClick:()=>m({...p,page:P+1}),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium transition-all ${j.currentPage===P+1?"z-10 bg-gradient-to-r from-afri-green to-afri-green-dark text-white border-afri-green":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:P+1},P)),a.jsx("button",{onClick:()=>m({...p,page:p.page+1}),disabled:j.currentPage===j.pages,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:a.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]})})]}),s&&a.jsx(Ex,{product:d,onClose:()=>{o(!1),f(null)},onSave:()=>{N(),o(!1),f(null)}}),l&&a.jsx(Lx,{selectedProducts:u,onClose:()=>c(!1),onComplete:()=>{N(),g([]),c(!1)}}),a.jsx("style",{jsx:!0,children:`
        @keyframes fadeIn {
          from {
            opacity: 0;
            transform: translateY(10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        @keyframes slideDown {
          from {
            opacity: 0;
            transform: translateY(-10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .animate-fadeIn {
          animation: fadeIn 0.5s ease-out forwards;
        }

        .animate-slideDown {
          animation: slideDown 0.3s ease-out;
        }
      `})]})}function Ox({order:e,onPackingComplete:r,onStatusUpdate:t}){var v;const[n,s]=ge.useState([]),[o,l]=ge.useState({});ge.useEffect(()=>{const N=e.items.map(b=>({itemId:b._id||b.productId||b.name,name:b.name,quantity:b.quantity,unit:b.unit,packed:!1,pickedQuantity:0}));s(N)},[e.items]);const c=N=>{s(b=>b.map(y=>y.itemId===N?{...y,packed:!y.packed,pickedQuantity:y.packed?0:y.quantity}:y))},d=(N,b)=>{s(y=>y.map(_=>_.itemId===N?{..._,pickedQuantity:Math.max(0,Math.min(b,_.quantity))}:_))},f=(N,b)=>{l(y=>({...y,[N]:b}))},u=()=>{s(N=>N.map(b=>({...b,packed:!0,pickedQuantity:b.quantity})))},g=async()=>{!n.every(b=>b.packed)&&!window.confirm("Not all items are marked as packed. Are you sure you want to mark this order as ready?")||(r&&r(n),t&&await t("ready_for_pickup","All items packed and ready for pickup"))},p=n.filter(N=>N.packed).length,m=n.length,j=m>0?p/m*100:0;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-gradient-to-br from-[#FFB300] to-[#FFA726] rounded-xl p-6 text-white shadow-lg",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-2xl font-bold",children:"Packing Checklist"}),a.jsxs("p",{className:"text-gray-900 mt-1",children:[p," of ",m," items packed"]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"text-4xl font-bold",children:[Math.round(j),"%"]}),a.jsx("div",{className:"text-sm text-gray-900",children:"Complete"})]})]}),a.jsx("div",{className:"w-full bg-gray-900/20 rounded-full h-4 overflow-hidden shadow-inner",children:a.jsx("div",{className:"bg-gradient-to-r from-[#00897B] to-[#26A69A] h-full rounded-full transition-all duration-500 ease-out shadow-lg",style:{width:`${j}%`}})}),a.jsxs("div",{className:"mt-4 flex gap-3",children:[a.jsx("button",{onClick:u,className:"flex-1 bg-white text-gray-900 px-4 py-2 rounded-lg font-semibold shadow-md hover:shadow-lg transition-all transform hover:-translate-y-0.5",children:"âœ“ Mark All Packed"}),a.jsx("button",{onClick:g,disabled:p===0,className:"flex-1 bg-[#00897B] text-white px-4 py-2 rounded-lg font-semibold shadow-md hover:shadow-lg hover:bg-[#00695C] transition-all transform hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none",children:"ðŸ“¦ Ready for Pickup"})]})]}),((v=e.deliveryAddress)==null?void 0:v.instructions)&&a.jsx("div",{className:"bg-yellow-50 border-l-4 border-[#FFB300] rounded-lg p-4 shadow-sm",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("svg",{className:"w-5 h-5 text-[#FFB300] mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"Special Instructions"}),a.jsx("p",{className:"text-gray-700 text-sm",children:e.deliveryAddress.instructions})]})]})}),a.jsx("div",{className:"space-y-3",children:n.map((N,b)=>{const y=e.items[b];return a.jsx("div",{className:`
                bg-white rounded-xl p-5 shadow-md border-2 transition-all duration-300
                ${N.packed?"border-[#00897B] bg-green-50/50":"border-gray-200 hover:border-[#FFB300]"}
              `,children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"flex-shrink-0 pt-1",children:a.jsx("button",{onClick:()=>c(N.itemId),className:`
                      w-8 h-8 rounded-lg border-2 flex items-center justify-center
                      transition-all duration-200 transform hover:scale-110
                      ${N.packed?"bg-[#00897B] border-[#00897B] shadow-lg":"bg-white border-gray-300 hover:border-[#FFB300]"}
                    `,children:N.packed&&a.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-start justify-between gap-4 mb-3",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:`text-lg font-semibold ${N.packed?"text-[#00897B] line-through":"text-gray-900"}`,children:N.name}),a.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-1",children:[a.jsxs("span",{className:"text-sm text-gray-600",children:["Ordered: ",a.jsxs("span",{className:"font-semibold",children:[N.quantity," ",N.unit]})]}),y.price&&a.jsxs("span",{className:"text-sm text-gray-600",children:["Price: ",a.jsxs("span",{className:"font-semibold",children:["Â£",y.price.toFixed(2)]})]})]})]}),y.image&&a.jsx("img",{src:y.image,alt:N.name,className:"w-20 h-20 object-cover rounded-lg shadow-md"})]}),a.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Picked Quantity:"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>d(N.itemId,N.pickedQuantity-1),disabled:N.pickedQuantity<=0,className:"w-8 h-8 rounded-lg bg-gray-200 hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed font-semibold transition-colors",children:"-"}),a.jsx("input",{type:"number",value:N.pickedQuantity,onChange:_=>d(N.itemId,parseInt(_.target.value)||0),className:"w-20 text-center px-2 py-1 border-2 border-gray-300 rounded-lg font-semibold focus:border-[#FFB300] focus:ring-2 focus:ring-[#FFB300]/20",min:"0",max:N.quantity}),a.jsx("button",{onClick:()=>d(N.itemId,N.pickedQuantity+1),disabled:N.pickedQuantity>=N.quantity,className:"w-8 h-8 rounded-lg bg-gray-200 hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed font-semibold transition-colors",children:"+"}),a.jsxs("span",{className:"text-sm text-gray-600",children:["/ ",N.quantity," ",N.unit]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes (optional)"}),a.jsx("input",{type:"text",value:o[N.itemId]||"",onChange:_=>f(N.itemId,_.target.value),placeholder:"E.g., substitution, quality issue...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-[#FFB300] focus:border-transparent"})]}),N.pickedQuantity>0&&N.pickedQuantity<N.quantity&&a.jsx("div",{className:"mt-2 p-2 bg-orange-50 border-l-4 border-orange-400 rounded",children:a.jsxs("p",{className:"text-xs text-orange-700",children:["âš ï¸ Short by ",N.quantity-N.pickedQuantity," ",N.unit]})})]})]})},N.itemId)})}),a.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-6 shadow-lg border border-gray-200",children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Packing Summary"}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{className:"text-center p-3 bg-white rounded-lg shadow-sm",children:[a.jsx("div",{className:"text-2xl font-bold text-gray-900",children:m}),a.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Total Items"})]}),a.jsxs("div",{className:"text-center p-3 bg-white rounded-lg shadow-sm",children:[a.jsx("div",{className:"text-2xl font-bold text-[#00897B]",children:p}),a.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Packed"})]}),a.jsxs("div",{className:"text-center p-3 bg-white rounded-lg shadow-sm",children:[a.jsx("div",{className:"text-2xl font-bold text-orange-600",children:m-p}),a.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Remaining"})]})]})]}),a.jsx("div",{className:"sticky bottom-0 bg-white border-t-2 border-gray-200 p-4 -mx-6 -mb-6 rounded-b-xl shadow-lg",children:a.jsx("button",{onClick:g,disabled:p===0,className:`
            w-full py-4 rounded-xl font-bold text-lg text-white shadow-lg
            transition-all duration-200 transform hover:-translate-y-1 hover:shadow-xl
            ${p===m?"bg-gradient-to-r from-[#00897B] to-[#26A69A]":"bg-gradient-to-r from-gray-500 to-gray-600"}
            disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none
          `,children:p===m?a.jsx(a.Fragment,{children:"âœ“ Mark Order as Ready for Pickup"}):a.jsxs(a.Fragment,{children:["Pack ",m-p," More Items"]})})})]})}function Ix({order:e,onPickerAssigned:r}){var N,b,y,_;const[t,n]=ge.useState([]),[s,o]=ge.useState(null),[l,c]=ge.useState(!0),[d,f]=ge.useState(!1);ge.useEffect(()=>{u()},[]);const u=async()=>{try{c(!0);const T=[{id:"picker-1",name:"John Smith",status:"available",activeOrders:0,rating:4.8,completedOrders:156,avatar:null},{id:"picker-2",name:"Sarah Johnson",status:"available",activeOrders:1,rating:4.9,completedOrders:203,avatar:null},{id:"picker-3",name:"Michael Brown",status:"busy",activeOrders:3,rating:4.7,completedOrders:189,avatar:null},{id:"picker-4",name:"Emily Davis",status:"available",activeOrders:0,rating:5,completedOrders:98,avatar:null}];setTimeout(()=>{n(T),c(!1)},500)}catch(T){console.error("Error fetching pickers:",T),c(!1)}},g=async()=>{if(!s){alert("Please select a picker");return}f(!0);try{await new Promise(T=>setTimeout(T,1e3)),r&&await r(s.id),alert(`Order assigned to ${s.name}`)}catch(T){console.error("Error assigning picker:",T),alert("Failed to assign picker. Please try again.")}finally{f(!1)}},p=T=>{switch(T){case"available":return"bg-green-100 text-green-700 border-green-200";case"busy":return"bg-orange-100 text-orange-700 border-orange-200";case"offline":return"bg-gray-100 text-gray-700 border-gray-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}},m=T=>{switch(T){case"available":return"bg-green-500";case"busy":return"bg-orange-500";case"offline":return"bg-gray-400";default:return"bg-gray-400"}};if(l)return a.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#FFB300] mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading available pickers..."})]});const j=t.filter(T=>T.status==="available"),v=t.filter(T=>T.status==="busy");return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-gradient-to-br from-[#FFB300] to-[#FFA726] rounded-xl p-6 text-white shadow-lg",children:[a.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Assign Order Picker"}),a.jsxs("p",{className:"text-gray-900",children:["Select a picker to handle this order â€¢ ",j.length," available"]})]}),a.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-md border border-gray-200",children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Order Details"}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Order Number"}),a.jsx("p",{className:"font-semibold text-gray-900",children:e.orderNumber})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Total Items"}),a.jsx("p",{className:"font-semibold text-gray-900",children:((N=e.items)==null?void 0:N.length)||0})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Order Value"}),a.jsxs("p",{className:"font-semibold text-[#00897B]",children:["Â£",(y=(b=e.pricing)==null?void 0:b.total)==null?void 0:y.toFixed(2)]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Customer"}),a.jsx("p",{className:"font-semibold text-gray-900",children:((_=e.deliveryAddress)==null?void 0:_.fullName)||"N/A"})]})]})]}),j.length>0&&a.jsxs("div",{children:[a.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[a.jsx("span",{className:"w-3 h-3 bg-green-500 rounded-full animate-pulse"}),"Available Pickers (",j.length,")"]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:j.map(T=>a.jsx("div",{onClick:()=>o(T),className:`
                  bg-white rounded-xl p-5 shadow-md cursor-pointer transition-all duration-200
                  border-2 ${(s==null?void 0:s.id)===T.id?"border-[#FFB300] shadow-lg scale-105":"border-gray-200 hover:border-[#FFB300] hover:shadow-lg"}
                `,children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsxs("div",{className:"flex-shrink-0",children:[T.avatar?a.jsx("img",{src:T.avatar,alt:T.name,className:"w-16 h-16 rounded-full object-cover shadow-md"}):a.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-[#FFB300] to-[#FFA726] flex items-center justify-center text-white text-2xl font-bold shadow-md",children:T.name.charAt(0)}),a.jsx("div",{className:`w-4 h-4 rounded-full ${m(T.status)} border-2 border-white shadow-sm -mt-3 ml-12`})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[a.jsx("h5",{className:"font-bold text-gray-900 text-lg",children:T.name}),(s==null?void 0:s.id)===T.id&&a.jsx("svg",{className:"w-6 h-6 text-[#FFB300] flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[a.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded-lg",children:[a.jsx("div",{className:"text-sm font-bold text-gray-900",children:T.rating}),a.jsx("div",{className:"text-xs text-gray-500",children:"Rating"})]}),a.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded-lg",children:[a.jsx("div",{className:"text-sm font-bold text-gray-900",children:T.completedOrders}),a.jsx("div",{className:"text-xs text-gray-500",children:"Orders"})]}),a.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded-lg",children:[a.jsx("div",{className:"text-sm font-bold text-gray-900",children:T.activeOrders}),a.jsx("div",{className:"text-xs text-gray-500",children:"Active"})]})]}),a.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold border ${p(T.status)}`,children:[a.jsx("span",{className:`w-2 h-2 rounded-full ${m(T.status)} mr-2`}),T.status.charAt(0).toUpperCase()+T.status.slice(1)]})]})]})},T.id))})]}),v.length>0&&a.jsxs("div",{children:[a.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[a.jsx("span",{className:"w-3 h-3 bg-orange-500 rounded-full"}),"Busy Pickers (",v.length,")"]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:v.map(T=>a.jsx("div",{className:"bg-white rounded-xl p-5 shadow-md border-2 border-gray-200 opacity-60",children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"flex-shrink-0",children:T.avatar?a.jsx("img",{src:T.avatar,alt:T.name,className:"w-16 h-16 rounded-full object-cover shadow-md grayscale"}):a.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-400 flex items-center justify-center text-white text-2xl font-bold shadow-md",children:T.name.charAt(0)})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h5",{className:"font-bold text-gray-700 text-lg mb-1",children:T.name}),a.jsxs("p",{className:"text-sm text-gray-500 mb-2",children:["Currently handling ",T.activeOrders," orders"]}),a.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold border ${p(T.status)}`,children:[a.jsx("span",{className:`w-2 h-2 rounded-full ${m(T.status)} mr-2`}),"Busy"]})]})]})},T.id))})]}),t.length===0&&a.jsxs("div",{className:"bg-gray-50 rounded-xl p-12 text-center",children:[a.jsx("svg",{className:"w-16 h-16 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Pickers Available"}),a.jsx("p",{className:"text-gray-600",children:"All pickers are currently busy. Please check back in a few minutes."})]}),s&&a.jsx("div",{className:"sticky bottom-0 bg-white border-t-2 border-gray-200 p-4 -mx-6 -mb-6 rounded-b-xl shadow-lg",children:a.jsx("button",{onClick:g,disabled:d,className:"w-full py-4 bg-gradient-to-r from-[#00897B] to-[#26A69A] text-white rounded-xl font-bold text-lg shadow-lg hover:shadow-xl transition-all duration-200 transform hover:-translate-y-1 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center justify-center gap-2",children:d?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Assigning..."]}):a.jsxs(a.Fragment,{children:["âœ“ Assign to ",s.name]})})})]})}function Dx({order:e,onStatusUpdate:r,isUpdating:t}){const[n,s]=ge.useState(!1),[o,l]=ge.useState(null),[c,d]=ge.useState(""),f=()=>({pending:[{status:"confirmed",label:"Accept Order",icon:"âœ“",color:"green",description:"Confirm and start preparing this order"},{status:"cancelled",label:"Reject Order",icon:"âœ•",color:"red",description:"Cancel this order (requires reason)",requiresNote:!0}],confirmed:[{status:"preparing",label:"Start Preparing",icon:"ðŸ‘¨â€ðŸ³",color:"orange",description:"Begin preparing the order"},{status:"cancelled",label:"Cancel Order",icon:"âœ•",color:"red",description:"Cancel this order",requiresNote:!0}],preparing:[{status:"ready",label:"Mark as Ready",icon:"âœ“",color:"green",description:"Order is ready for pickup"}],ready:[{status:"out-for-delivery",label:"Out for Delivery",icon:"ðŸšš",color:"blue",description:"Rider has picked up the order"}],"out-for-delivery":[{status:"delivered",label:"Mark as Delivered",icon:"âœ“",color:"green",description:"Order has been delivered to customer"}],delivered:[{status:"completed",label:"Complete Order",icon:"âœ“",color:"gray",description:"Finalize and archive this order"}],assigned_picker:[{status:"picking",label:"Start Picking",icon:"ðŸ“¦",color:"purple",description:"Picker starts collecting items"}],picking:[{status:"picked",label:"Items Picked",icon:"âœ“",color:"purple",description:"All items have been picked"}],picked:[{status:"packing",label:"Start Packing",icon:"ðŸ“¦",color:"indigo",description:"Begin packing the items"}],packing:[{status:"ready_for_pickup",label:"Ready for Pickup",icon:"âœ“",color:"teal",description:"Order is packed and ready"}]})[e.status]||[],u=v=>{l(v),s(!0)},g=async()=>{if(!o)return;const v=o.requiresNote?c:"";if(o.requiresNote&&!v.trim()){alert("Please provide a reason for cancellation");return}try{await r(o.status,v),s(!1),l(null),d("")}catch(N){console.error("Error updating status:",N),alert("Failed to update order status. Please try again.")}},p=()=>{s(!1),l(null),d("")},m=f();if(m.length===0)return null;const j={green:{bg:"bg-gradient-to-r from-green-600 to-green-700",hover:"hover:from-green-700 hover:to-green-800",border:"border-green-600",text:"text-green-700"},red:{bg:"bg-gradient-to-r from-red-600 to-red-700",hover:"hover:from-red-700 hover:to-red-800",border:"border-red-600",text:"text-red-700"},orange:{bg:"bg-gradient-to-r from-orange-600 to-orange-700",hover:"hover:from-orange-700 hover:to-orange-800",border:"border-orange-600",text:"text-orange-700"},blue:{bg:"bg-gradient-to-r from-blue-600 to-blue-700",hover:"hover:from-blue-700 hover:to-blue-800",border:"border-blue-600",text:"text-blue-700"},purple:{bg:"bg-gradient-to-r from-purple-600 to-purple-700",hover:"hover:from-purple-700 hover:to-purple-800",border:"border-purple-600",text:"text-purple-700"},indigo:{bg:"bg-gradient-to-r from-indigo-600 to-indigo-700",hover:"hover:from-indigo-700 hover:to-indigo-800",border:"border-indigo-600",text:"text-indigo-700"},teal:{bg:"bg-gradient-to-r from-[#00897B] to-[#00695C]",hover:"hover:from-[#00695C] hover:to-[#004D40]",border:"border-[#00897B]",text:"text-[#00897B]"},gray:{bg:"bg-gradient-to-r from-gray-600 to-gray-700",hover:"hover:from-gray-700 hover:to-gray-800",border:"border-gray-600",text:"text-gray-700"}};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg border-2 border-[#FFB300]",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[a.jsx("svg",{className:"w-5 h-5 text-[#FFB300]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"Quick Actions"]}),a.jsx("div",{className:"flex flex-wrap gap-3",children:m.map(v=>{const N=j[v.color]||j.gray;return a.jsxs("button",{onClick:()=>u(v),disabled:t,className:`
                  flex items-center gap-2 px-6 py-3 rounded-lg font-semibold text-white
                  ${N.bg} ${N.hover}
                  shadow-md hover:shadow-lg
                  transition-all duration-200 transform hover:-translate-y-0.5
                  disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none
                `,children:[a.jsx("span",{className:"text-xl",children:v.icon}),a.jsx("span",{children:v.label}),t&&a.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})]},v.status)})})]}),n&&o&&a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[60] p-4 animate-fadeIn",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-slideUp",children:[a.jsx("div",{className:`w-16 h-16 rounded-full mx-auto mb-4 flex items-center justify-center ${o.color==="red"?"bg-red-100":"bg-green-100"}`,children:a.jsx("span",{className:"text-3xl",children:o.icon})}),a.jsx("h3",{className:"text-xl font-bold text-gray-900 text-center mb-2",children:o.label}),a.jsx("p",{className:"text-gray-600 text-center mb-4",children:o.description}),o.requiresNote&&a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for cancellation *"}),a.jsx("textarea",{value:c,onChange:v=>d(v.target.value),placeholder:"Please provide a reason...",rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#FFB300] focus:border-transparent resize-none",required:!0})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-4",children:[a.jsx("div",{className:"text-sm text-gray-600",children:"Order Number"}),a.jsx("div",{className:"font-semibold text-gray-900",children:e.orderNumber})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:p,className:"flex-1 px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium rounded-lg transition-colors",children:"Cancel"}),a.jsx("button",{onClick:g,disabled:o.requiresNote&&!c.trim(),className:`
                  flex-1 px-4 py-2 text-white font-medium rounded-lg transition-all
                  ${j[o.color].bg} ${j[o.color].hover}
                  shadow-md hover:shadow-lg
                  disabled:opacity-50 disabled:cursor-not-allowed
                `,children:"Confirm"})]})]})})]})}function Rx({order:e}){var j;const[r,t]=ge.useState(!1),[n,s]=ge.useState(0),o=[{status:"pending",label:"Order Placed",icon:"ðŸ“‹",description:"Customer placed the order"},{status:"confirmed",label:"Order Confirmed",icon:"âœ“",description:"Vendor accepted the order"},{status:"assigned_picker",label:"Picker Assigned",icon:"ðŸ‘¤",description:"Order assigned to picker"},{status:"picking",label:"Picking Items",icon:"ðŸ›’",description:"Picker is collecting items"},{status:"picked",label:"Items Picked",icon:"âœ“",description:"All items collected"},{status:"packing",label:"Packing Order",icon:"ðŸ“¦",description:"Items being packed"},{status:"ready_for_pickup",label:"Ready for Pickup",icon:"âœ“",description:"Order ready for rider"},{status:"out-for-delivery",label:"Out for Delivery",icon:"ðŸšš",description:"Rider on the way"},{status:"delivered",label:"Delivered",icon:"âœ“",description:"Order delivered to customer"},{status:"completed",label:"Completed",icon:"âœ“",description:"Order completed"}],l={label:"Order Cancelled",icon:"âœ•",description:"Order was cancelled"},d=e.status==="cancelled"?-1:o.findIndex(v=>v.status===e.status),f=e.status==="cancelled",u=v=>f?"cancelled":v<d?"completed":v===d?"current":"upcoming",g=v=>{switch(v){case"completed":return{bg:"bg-[#00897B]",text:"text-[#00897B]",border:"border-[#00897B]",line:"bg-[#00897B]"};case"current":return{bg:"bg-[#FFB300]",text:"text-[#FFB300]",border:"border-[#FFB300]",line:"bg-gray-300"};case"cancelled":return{bg:"bg-red-500",text:"text-red-500",border:"border-red-500",line:"bg-gray-300"};default:return{bg:"bg-gray-300",text:"text-gray-400",border:"border-gray-300",line:"bg-gray-300"}}},p=e.statusHistory||[{status:"pending",timestamp:e.createdAt,note:"Order placed by customer",user:"System"},...e.status!=="pending"?[{status:e.status,timestamp:e.updatedAt,note:"Current status",user:"Vendor"}]:[]],m=r?p:p.slice(0,3);return ge.useEffect(()=>{const v=(d+1)/o.length*100;let N=0;const b=v/50,y=setInterval(()=>{N+=b,N>=v?(s(v),clearInterval(y)):s(N)},20);return()=>clearInterval(y)},[d,o.length]),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-gradient-to-br from-[#FFB300] to-[#FFA726] rounded-xl p-6 text-white shadow-lg animate-slideDown",children:[a.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Order Timeline"}),a.jsxs("p",{className:"text-gray-900",children:["Track the progress of order ",e.orderNumber]})]}),!f&&a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-gray-200 animate-fadeIn",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Overall Progress"}),a.jsxs("span",{className:"text-2xl font-bold bg-gradient-to-r from-[#00897B] to-[#00695C] bg-clip-text text-transparent",children:[Math.round(n),"%"]})]}),a.jsxs("div",{className:"relative w-full h-6 bg-gray-200 rounded-full overflow-hidden shadow-inner",children:[a.jsx("div",{className:"absolute top-0 left-0 h-full bg-gradient-to-r from-[#00897B] via-[#00695C] to-[#00897B] rounded-full transition-all duration-1000 ease-out shadow-lg animate-shimmer",style:{width:`${n}%`},children:a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-30 animate-pulse"})}),o.map((v,N)=>{const b=(N+1)/o.length*100;return a.jsx("div",{className:"absolute top-1/2 transform -translate-y-1/2 w-2 h-2 bg-white rounded-full shadow-md",style:{left:`${b}%`,marginLeft:"-4px"}},N)})]}),a.jsxs("div",{className:"flex justify-between mt-2 text-xs text-gray-500",children:[a.jsx("span",{children:"Started"}),a.jsx("span",{className:"font-semibold text-[#FFB300]",children:((j=o[d])==null?void 0:j.label)||"Unknown"}),a.jsx("span",{children:"Completed"})]})]}),a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-gray-200",children:[a.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Progress Stages"}),a.jsx("div",{className:"relative",children:f?a.jsxs("div",{className:"relative flex items-start gap-4",children:[a.jsx("div",{className:"relative z-10 flex-shrink-0",children:a.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center border-4 border-white shadow-lg bg-red-500",children:a.jsx("span",{className:"text-white text-xl",children:l.icon})})}),a.jsxs("div",{className:"flex-1 pt-1",children:[a.jsx("h5",{className:"font-bold text-lg text-red-500 mb-1",children:l.label}),a.jsx("p",{className:"text-sm text-gray-600",children:l.description}),e.cancellationReason&&a.jsx("div",{className:"mt-2 p-3 bg-red-50 border-l-4 border-red-500 rounded",children:a.jsxs("p",{className:"text-sm text-gray-700",children:[a.jsx("span",{className:"font-semibold",children:"Reason:"})," ",e.cancellationReason]})})]})]}):o.map((v,N)=>{const b=u(N),y=g(b),_=N===o.length-1;return a.jsxs("div",{className:"relative flex items-start gap-4 pb-8 animate-slideIn",style:{animationDelay:`${N*100}ms`},children:[!_&&a.jsx("div",{className:"absolute left-5 top-12 w-0.5 h-full",children:a.jsx("div",{className:`w-full transition-all duration-500 ${y.line}`,style:{height:b==="completed"?"100%":b==="current"?"50%":"0%"}})}),a.jsxs("div",{className:"relative z-10 flex-shrink-0",children:[a.jsx("div",{className:`
                        w-10 h-10 rounded-full flex items-center justify-center
                        border-4 border-white shadow-lg transform transition-all duration-500
                        ${y.bg}
                        ${b==="current"?"animate-pulseGlow scale-110 ring-4 ring-[#FFB300] ring-opacity-50":""}
                        ${b==="completed"?"animate-bounceIn":""}
                        ${b==="upcoming"?"scale-90 opacity-50":""}
                      `,children:a.jsx("span",{className:"text-white text-xl",children:v.icon})}),b==="completed"&&a.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-[#00897B] rounded-full flex items-center justify-center animate-checkmark",children:a.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),b==="current"&&a.jsx("div",{className:"absolute inset-0 rounded-full bg-[#FFB300] animate-ping opacity-20"})]}),a.jsxs("div",{className:"flex-1 pt-1",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("h5",{className:`font-bold text-lg ${y.text}`,children:v.label}),b==="completed"&&p.find(T=>T.status===v.status)&&a.jsx("span",{className:"text-sm text-gray-500",children:new Date(p.find(T=>T.status===v.status).timestamp).toLocaleString("en-GB",{dateStyle:"short",timeStyle:"short"})}),b==="current"&&a.jsx("span",{className:"px-3 py-1 bg-[#FFB300] text-gray-900 text-xs font-semibold rounded-full",children:"Current"})]}),a.jsx("p",{className:"text-sm text-gray-600",children:v.description}),b==="current"&&a.jsx("div",{className:"mt-2 p-3 bg-yellow-50 border-l-4 border-[#FFB300] rounded",children:a.jsxs("p",{className:"text-sm text-gray-700",children:[a.jsx("span",{className:"font-semibold",children:"In Progress:"})," This stage is currently active"]})})]})]},v.status)})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-gray-200",children:[a.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[a.jsx("svg",{className:"w-5 h-5 text-[#00897B]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Status History"]}),a.jsx("div",{className:"space-y-3",children:m.map((v,N)=>a.jsxs("div",{className:"flex items-start gap-4 p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[a.jsx("div",{className:"flex-shrink-0 w-2 h-2 mt-2 rounded-full bg-[#00897B]"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[a.jsx("h5",{className:"font-semibold text-gray-900 capitalize",children:v.status.replace(/_/g," ").replace(/-/g," ")}),a.jsx("span",{className:"text-sm text-gray-500 whitespace-nowrap",children:new Date(v.timestamp).toLocaleString("en-GB",{dateStyle:"short",timeStyle:"short"})})]}),v.note&&a.jsx("p",{className:"text-sm text-gray-600",children:v.note}),v.user&&a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["By ",v.user]})]})]},N))}),p.length>3&&a.jsx("button",{onClick:()=>t(!r),className:"mt-4 w-full py-2 text-[#00897B] font-medium hover:bg-gray-50 rounded-lg transition-colors",children:r?"â–² Show Less":`â–¼ Show ${p.length-3} More`})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-5 shadow-md border border-blue-200",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-500 flex items-center justify-center",children:a.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),a.jsx("h5",{className:"font-semibold text-gray-900",children:"Total Time"})]}),a.jsxs("p",{className:"text-2xl font-bold text-blue-700",children:[Math.round((new Date-new Date(e.createdAt))/1e3/60)," mins"]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Since order placed"})]}),a.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-5 shadow-md border border-green-200",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-green-500 flex items-center justify-center",children:a.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),a.jsx("h5",{className:"font-semibold text-gray-900",children:"Progress"})]}),a.jsxs("p",{className:"text-2xl font-bold text-green-700",children:[Math.round((d+1)/o.length*100),"%"]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Order completion"})]}),a.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-5 shadow-md border border-purple-200",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-purple-500 flex items-center justify-center",children:a.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),a.jsx("h5",{className:"font-semibold text-gray-900",children:"Updates"})]}),a.jsx("p",{className:"text-2xl font-bold text-purple-700",children:p.length}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Status changes"})]})]}),a.jsx("style",{jsx:!0,children:`
        @keyframes slideDown {
          from {
            opacity: 0;
            transform: translateY(-20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        @keyframes fadeIn {
          from {
            opacity: 0;
          }
          to {
            opacity: 1;
          }
        }

        @keyframes slideIn {
          from {
            opacity: 0;
            transform: translateX(-20px);
          }
          to {
            opacity: 1;
            transform: translateX(0);
          }
        }

        @keyframes pulseGlow {
          0%, 100% {
            box-shadow: 0 0 20px rgba(255, 179, 0, 0.5);
          }
          50% {
            box-shadow: 0 0 40px rgba(255, 179, 0, 0.8);
          }
        }

        @keyframes bounceIn {
          0% {
            transform: scale(0.5);
            opacity: 0;
          }
          50% {
            transform: scale(1.1);
          }
          100% {
            transform: scale(1);
            opacity: 1;
          }
        }

        @keyframes checkmark {
          0% {
            transform: scale(0) rotate(-45deg);
            opacity: 0;
          }
          50% {
            transform: scale(1.2) rotate(0deg);
          }
          100% {
            transform: scale(1) rotate(0deg);
            opacity: 1;
          }
        }

        @keyframes shimmer {
          0% {
            background-position: -200% center;
          }
          100% {
            background-position: 200% center;
          }
        }

        .animate-slideDown {
          animation: slideDown 0.5s ease-out;
        }

        .animate-fadeIn {
          animation: fadeIn 0.6s ease-out;
        }

        .animate-slideIn {
          animation: slideIn 0.5s ease-out forwards;
          opacity: 0;
        }

        .animate-pulseGlow {
          animation: pulseGlow 2s ease-in-out infinite;
        }

        .animate-bounceIn {
          animation: bounceIn 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .animate-checkmark {
          animation: checkmark 0.4s ease-out;
        }

        .animate-shimmer {
          background-size: 200% 100%;
          animation: shimmer 3s linear infinite;
        }
      `})]})}function Bx({order:e,onRatingSubmitted:r}){var m,j,v;const[t,n]=ge.useState(((m=e==null?void 0:e.riderRating)==null?void 0:m.rating)||0),[s,o]=ge.useState(0),[l,c]=ge.useState(((j=e==null?void 0:e.riderRating)==null?void 0:j.feedback)||""),[d,f]=ge.useState(!1),u=!!(e!=null&&e.riderRating),g=async N=>{var b,y;if(N.preventDefault(),t===0){alert("Please select a rating");return}try{f(!0);const _=await xr.rateRider(e._id,{rating:t,feedback:l.trim()});_.success&&(alert("Thank you for rating the delivery agent!"),r&&r(_.data))}catch(_){console.error("Rating submission error:",_),alert(((y=(b=_.response)==null?void 0:b.data)==null?void 0:y.message)||"Failed to submit rating")}finally{f(!1)}},p=()=>a.jsx("div",{className:"flex items-center space-x-2",children:[1,2,3,4,5].map(N=>a.jsx("button",{type:"button",disabled:u||d,onMouseEnter:()=>!u&&o(N),onMouseLeave:()=>!u&&o(0),onClick:()=>!u&&n(N),className:`text-4xl transition-all transform ${u?"cursor-default":"cursor-pointer hover:scale-110"} ${N<=(s||t)?"animate-starPulse":""}`,children:N<=(s||t)?a.jsx("span",{className:"text-afri-yellow drop-shadow-lg",children:"â­"}):a.jsx("span",{className:"text-gray-300",children:"â˜†"})},N))});return e!=null&&e.rider?a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 space-y-6 animate-fadeIn",children:[a.jsxs("div",{className:"flex items-center space-x-4 pb-4 border-b",children:[a.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-afri-green to-afri-green-dark flex items-center justify-center text-white text-2xl font-bold shadow-lg",children:((v=e.rider.name)==null?void 0:v.charAt(0).toUpperCase())||"R"}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-afri-gray-900",children:u?"Your Rating":"Rate Delivery Agent"}),a.jsx("p",{className:"text-afri-gray-600",children:e.rider.name}),e.rider.phone&&a.jsx("p",{className:"text-sm text-afri-gray-500",children:e.rider.phone})]}),u&&a.jsx("div",{className:"ml-auto",children:a.jsxs("div",{className:"bg-green-100 text-green-800 px-4 py-2 rounded-lg font-semibold flex items-center",children:[a.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Rated"]})})]}),a.jsxs("form",{onSubmit:g,className:"space-y-6",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-3",children:"How was your delivery experience?"}),p(),a.jsx("div",{className:"mt-2",children:t>0&&a.jsxs("p",{className:"text-sm text-afri-gray-600 animate-slideDown",children:[t===5&&"ðŸŽ‰ Excellent!",t===4&&"ðŸ˜Š Great!",t===3&&"ðŸ‘ Good",t===2&&"ðŸ˜ Could be better",t===1&&"ðŸ˜ž Poor"]})})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:["Additional Feedback ",!u&&a.jsx("span",{className:"text-afri-gray-500 font-normal",children:"(Optional)"})]}),a.jsx("textarea",{value:l,onChange:N=>c(N.target.value),disabled:u||d,rows:4,placeholder:u?"No feedback provided":"Share your thoughts about the delivery service...",className:`w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent resize-none ${u?"bg-gray-50 cursor-default":""}`})]}),!u&&a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{type:"submit",disabled:d||t===0,className:"px-8 py-3 bg-gradient-to-r from-afri-green to-afri-green-dark text-white rounded-lg font-semibold shadow-lg hover:shadow-xl transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center",children:d?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Submitting..."]}):a.jsxs(a.Fragment,{children:[a.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})}),"Submit Rating"]})})}),u&&a.jsx("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-lg p-4 text-center",children:a.jsx("p",{className:"text-sm text-afri-gray-700",children:"Thank you for your feedback! Your rating helps us improve our delivery service."})})]}),a.jsx("style",{jsx:!0,children:`
        @keyframes fadeIn {
          from {
            opacity: 0;
            transform: translateY(10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        @keyframes slideDown {
          from {
            opacity: 0;
            transform: translateY(-10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        @keyframes starPulse {
          0%,
          100% {
            transform: scale(1);
          }
          50% {
            transform: scale(1.1);
          }
        }

        .animate-fadeIn {
          animation: fadeIn 0.5s ease-out;
        }

        .animate-slideDown {
          animation: slideDown 0.3s ease-out;
        }

        .animate-starPulse {
          animation: starPulse 0.3s ease-out;
        }
      `})]}):a.jsx("div",{className:"bg-gray-50 rounded-xl p-6 text-center",children:a.jsx("p",{className:"text-afri-gray-600",children:"No delivery agent assigned to this order"})})}const Mx={pending:"bg-gradient-to-r from-yellow-400 to-yellow-500 text-gray-900",confirmed:"bg-gradient-to-r from-blue-500 to-blue-600 text-white",assigned_picker:"bg-gradient-to-r from-purple-500 to-purple-600 text-white",picking:"bg-gradient-to-r from-purple-600 to-purple-700 text-white",picked:"bg-gradient-to-r from-purple-700 to-purple-800 text-white",packing:"bg-gradient-to-r from-indigo-500 to-indigo-600 text-white",ready_for_pickup:"bg-gradient-to-r from-teal-500 to-teal-600 text-white",preparing:"bg-gradient-to-r from-orange-500 to-orange-600 text-white",ready:"bg-gradient-to-r from-green-600 to-green-700 text-white","out-for-delivery":"bg-gradient-to-r from-blue-600 to-blue-700 text-white",delivered:"bg-gradient-to-r from-green-700 to-green-800 text-white",completed:"bg-gradient-to-r from-gray-700 to-gray-800 text-white",cancelled:"bg-gradient-to-r from-red-500 to-red-600 text-white"},Ux={pending:"Pending",confirmed:"Confirmed",assigned_picker:"Picker Assigned",picking:"Picking Items",picked:"Items Picked",packing:"Packing",ready_for_pickup:"Ready for Pickup",preparing:"Preparing",ready:"Ready","out-for-delivery":"Out for Delivery",delivered:"Delivered",completed:"Completed",cancelled:"Cancelled"};function Hx({order:e,onClose:r,onStatusUpdate:t,onRefresh:n}){var v,N,b,y,_,T,O,B,L,E,P,D,k,C,z,G,de,J,Z,oe,ne,me;const[s,o]=ge.useState("details"),[l,c]=ge.useState([]),[d,f]=ge.useState(!1);ge.useEffect(()=>{if(e.status==="packing"||e.status==="picking"){const be=e.items.map(A=>({itemId:A._id||A.productId,packed:!1}));c(be)}},[e]);const u=async(be,A="")=>{f(!0);try{await t(e._id,be,A),n&&await n()}catch(I){console.error("Error updating status:",I)}finally{f(!1)}},g=be=>{c(be),be.every(I=>I.packed)&&u("ready_for_pickup","All items packed and ready")},p=async be=>{try{await u("assigned_picker",`Picker ${be} assigned`)}catch(A){console.error("Error assigning picker:",A)}},m=e.items.reduce((be,A)=>be+A.quantity,0),j=Math.ceil(m*2);return a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fadeIn",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-6xl w-full max-h-[95vh] overflow-hidden flex flex-col animate-slideUp",children:[a.jsx("div",{className:"bg-gradient-to-r from-[#FFB300] to-[#FFA726] text-gray-900 p-6",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-3xl font-bold",children:e.orderNumber}),a.jsxs("p",{className:"text-gray-800 mt-1 text-sm",children:["Placed on ",new Date(e.createdAt).toLocaleString("en-GB",{dateStyle:"medium",timeStyle:"short"})]}),a.jsxs("div",{className:"mt-2 flex items-center gap-3",children:[a.jsx("span",{className:`px-4 py-1.5 inline-flex text-sm font-semibold rounded-full shadow-lg ${Mx[e.status]}`,children:Ux[e.status]}),a.jsxs("span",{className:"text-sm text-gray-800",children:[m," items â€¢ Est. ",j," mins"]})]})]}),a.jsx("button",{onClick:r,className:"text-gray-900 hover:text-gray-700 transition-all hover:rotate-90 duration-300",children:a.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})]})}),a.jsx("div",{className:"border-b border-gray-200 bg-gray-50",children:a.jsx("div",{className:"flex overflow-x-auto",children:[{id:"details",label:"Order Details",icon:"ðŸ“‹"},{id:"timeline",label:"Timeline",icon:"ðŸ“"},{id:"packing",label:"Packing",icon:"ðŸ“¦",show:["packing","picking","assigned_picker"].includes(e.status)},{id:"picker",label:"Picker",icon:"ðŸ‘¤",show:["pending","confirmed"].includes(e.status)},{id:"rating",label:"Rate Rider",icon:"â­",show:["delivered","completed"].includes(e.status)}].map(be=>be.show===!1||be.show&&!be.show?null:a.jsxs("button",{onClick:()=>o(be.id),className:`px-6 py-4 text-sm font-medium transition-all duration-200 border-b-2 whitespace-nowrap ${s===be.id?"border-[#FFB300] text-[#FFB300] bg-white":"border-transparent text-gray-600 hover:text-[#FFB300] hover:bg-gray-100"}`,children:[a.jsx("span",{className:"mr-2",children:be.icon}),be.label]},be.id))})}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[s==="details"&&a.jsxs("div",{className:"space-y-6",children:[a.jsx(Dx,{order:e,onStatusUpdate:u,isUpdating:d}),a.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-6 shadow-sm border border-gray-200",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[a.jsx("svg",{className:"w-5 h-5 text-[#00897B]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Customer Information"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Name"}),a.jsx("p",{className:"font-semibold text-gray-900",children:((v=e.deliveryAddress)==null?void 0:v.fullName)||((N=e.customer)==null?void 0:N.name)||"N/A"})]}),a.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Phone"}),a.jsx("p",{className:"font-semibold text-gray-900",children:((b=e.deliveryAddress)==null?void 0:b.phone)||((y=e.customer)==null?void 0:y.phone)||"N/A"})]}),a.jsxs("div",{className:"col-span-1 md:col-span-2 bg-white rounded-lg p-4 shadow-sm",children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Delivery Address"}),a.jsxs("p",{className:"font-semibold text-gray-900",children:[(_=e.deliveryAddress)==null?void 0:_.street,", ",(T=e.deliveryAddress)==null?void 0:T.city,", ",(O=e.deliveryAddress)==null?void 0:O.state," ",(B=e.deliveryAddress)==null?void 0:B.postalCode]}),((L=e.deliveryAddress)==null?void 0:L.instructions)&&a.jsx("div",{className:"mt-2 p-3 bg-yellow-50 border-l-4 border-[#FFB300] rounded",children:a.jsxs("p",{className:"text-sm text-gray-700",children:[a.jsx("span",{className:"font-semibold",children:"Delivery Note:"})," ",e.deliveryAddress.instructions]})})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden",children:[a.jsx("div",{className:"bg-gradient-to-r from-[#00897B] to-[#26A69A] text-white px-6 py-4",children:a.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),"Order Items (",((E=e.items)==null?void 0:E.length)||0,")"]})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Product"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Price"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Quantity"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Subtotal"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(P=e.items)==null?void 0:P.map((be,A)=>{var I,R;return a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[be.image&&a.jsx("img",{src:be.image,alt:be.name,className:"w-12 h-12 object-cover rounded-lg shadow-sm"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:be.name}),be.notes&&a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Note: ",be.notes]})]})]})}),a.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:["Â£",(I=be.price)==null?void 0:I.toFixed(2)]}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:a.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full bg-gray-100 font-medium",children:[be.quantity," ",be.unit]})}),a.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900 text-right font-semibold",children:["Â£",(R=be.subtotal)==null?void 0:R.toFixed(2)]})]},A)})})]})})]}),a.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-6 shadow-lg border border-gray-200",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Subtotal"}),a.jsxs("span",{className:"text-gray-900 font-medium",children:["Â£",(k=(D=e.pricing)==null?void 0:D.subtotal)==null?void 0:k.toFixed(2)]})]}),((C=e.pricing)==null?void 0:C.deliveryFee)>0&&a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Delivery Fee"}),a.jsxs("span",{className:"text-gray-900 font-medium",children:["Â£",e.pricing.deliveryFee.toFixed(2)]})]}),((z=e.pricing)==null?void 0:z.tax)>0&&a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Tax (VAT)"}),a.jsxs("span",{className:"text-gray-900 font-medium",children:["Â£",e.pricing.tax.toFixed(2)]})]}),((G=e.pricing)==null?void 0:G.discount)>0&&a.jsxs("div",{className:"flex justify-between text-sm text-[#00897B]",children:[a.jsx("span",{children:"Discount"}),a.jsxs("span",{className:"font-medium",children:["-Â£",e.pricing.discount.toFixed(2)]})]}),a.jsxs("div",{className:"border-t-2 border-gray-300 pt-3 flex justify-between items-center",children:[a.jsx("span",{className:"font-bold text-lg text-gray-900",children:"Total"}),a.jsxs("span",{className:"font-bold text-2xl text-[#00897B]",children:["Â£",(J=(de=e.pricing)==null?void 0:de.total)==null?void 0:J.toFixed(2)]})]})]}),a.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-300 flex flex-wrap items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm text-gray-500",children:"Payment Method:"}),a.jsx("span",{className:"font-semibold text-gray-900 capitalize px-3 py-1 bg-white rounded-lg shadow-sm",children:((Z=e.payment)==null?void 0:Z.method)||"N/A"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm text-gray-500",children:"Status:"}),a.jsx("span",{className:`font-semibold px-3 py-1 rounded-lg shadow-sm ${((oe=e.payment)==null?void 0:oe.status)==="paid"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:((me=(ne=e.payment)==null?void 0:ne.status)==null?void 0:me.toUpperCase())||"PENDING"})]})]})]})]}),s==="timeline"&&a.jsx(Rx,{order:e}),s==="packing"&&a.jsx(Ox,{order:e,onPackingComplete:g,onStatusUpdate:u}),s==="picker"&&a.jsx(Ix,{order:e,onPickerAssigned:p}),s==="rating"&&a.jsx(Bx,{order:e,onRatingSubmitted:n})]}),a.jsxs("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200 flex justify-between items-center",children:[a.jsxs("div",{className:"text-sm text-gray-600",children:["Last updated: ",new Date(e.updatedAt||e.createdAt).toLocaleString("en-GB",{dateStyle:"short",timeStyle:"short"})]}),a.jsx("button",{onClick:r,className:"px-6 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium rounded-lg transition-all duration-200 shadow-sm hover:shadow-md",children:"Close"})]})]})})}const Wx={pending:"bg-gradient-to-r from-yellow-400 to-yellow-500 text-gray-900",confirmed:"bg-gradient-to-r from-blue-500 to-blue-600 text-white",assigned_picker:"bg-gradient-to-r from-purple-500 to-purple-600 text-white",picking:"bg-gradient-to-r from-purple-600 to-purple-700 text-white",picked:"bg-gradient-to-r from-purple-700 to-purple-800 text-white",packing:"bg-gradient-to-r from-indigo-500 to-indigo-600 text-white",ready_for_pickup:"bg-gradient-to-r from-teal-500 to-teal-600 text-white",preparing:"bg-gradient-to-r from-orange-500 to-orange-600 text-white",ready:"bg-gradient-to-r from-green-600 to-green-700 text-white","out-for-delivery":"bg-gradient-to-r from-blue-600 to-blue-700 text-white",delivered:"bg-gradient-to-r from-green-700 to-green-800 text-white",completed:"bg-gradient-to-r from-gray-700 to-gray-800 text-white",cancelled:"bg-gradient-to-r from-red-500 to-red-600 text-white"},ih={pending:"Pending",confirmed:"Confirmed",assigned_picker:"Picker Assigned",picking:"Picking Items",picked:"Items Picked",packing:"Packing",ready_for_pickup:"Ready for Pickup",preparing:"Preparing",ready:"Ready","out-for-delivery":"Out for Delivery",delivered:"Delivered",completed:"Completed",cancelled:"Cancelled"};function zx(){const[e,r]=ge.useState([]),[t,n]=ge.useState(!0),[s,o]=ge.useState(null),[l,c]=ge.useState(!1),[d,f]=ge.useState({status:"",search:"",page:1,limit:20}),[u,g]=ge.useState({total:0,pages:0,currentPage:1});ge.useEffect(()=>{p()},[d]);const p=async()=>{try{n(!0);const b=await xr.getOrders(d);b.success&&(r(b.data.orders),g(b.data.pagination))}catch(b){console.error("Error fetching orders:",b)}finally{n(!1)}},m=b=>{f({...d,status:b===d.status?"":b,page:1})},j=b=>{f({...d,search:b.target.value,page:1})},v=async b=>{try{const y=await xr.getOrder(b);y.success&&(o(y.data.order),c(!0))}catch(y){console.error("Error fetching order details:",y)}},N=async(b,y,_="")=>{var T,O;try{if((await xr.updateOrderStatus(b,{status:y,note:_})).success&&(p(),s&&s._id===b)){const L=await xr.getOrder(b);L.success&&o(L.data.order)}}catch(B){console.error("Error updating order status:",B),alert(((O=(T=B.response)==null?void 0:T.data)==null?void 0:O.message)||"Failed to update order status")}};return a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h1",{className:"text-3xl font-bold text-afri-gray-900",children:"Orders"}),a.jsx("p",{className:"text-afri-gray-600 mt-1",children:"Manage and track all your orders"})]}),a.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:a.jsxs("div",{className:"flex flex-wrap gap-4",children:[a.jsx("div",{className:"flex-1 min-w-[250px]",children:a.jsx("input",{type:"text",placeholder:"Search by order number...",value:d.search,onChange:j,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent"})}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[["pending","confirmed","preparing","ready","out-for-delivery","delivered"].map(b=>a.jsx("button",{onClick:()=>m(b),className:`px-4 py-2 rounded-lg font-medium transition ${d.status===b?"bg-afri-green text-white":"bg-afri-gray-50 text-afri-gray-700 hover:bg-afri-gray-100"}`,children:ih[b]},b)),d.status&&a.jsx("button",{onClick:()=>f({...d,status:""}),className:"px-4 py-2 rounded-lg font-medium bg-red-100 text-red-700 hover:bg-red-200",children:"Clear Filter"})]})]})}),t?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-afri-green"})}):e.length===0?a.jsxs("div",{className:"bg-white rounded-lg shadow p-12 text-center",children:[a.jsx("svg",{className:"w-16 h-16 text-afri-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),a.jsx("h3",{className:"text-lg font-medium text-afri-gray-900 mb-1",children:"No orders found"}),a.jsx("p",{className:"text-afri-gray-500",children:d.status||d.search?"Try adjusting your filters":"Orders will appear here"})]}):a.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-afri-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Order Number"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Customer"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Items"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Total"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Date"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(b=>{var y,_,T,O,B;return a.jsxs("tr",{className:"hover:bg-afri-gray-50 transition",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("div",{className:"text-sm font-medium text-afri-gray-900",children:b.orderNumber})}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[a.jsx("div",{className:"text-sm text-afri-gray-900",children:((y=b.customer)==null?void 0:y.name)||"N/A"}),a.jsx("div",{className:"text-sm text-afri-gray-500",children:((_=b.customer)==null?void 0:_.phone)||""})]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"text-sm text-afri-gray-900",children:[((T=b.items)==null?void 0:T.length)||0," items"]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"text-sm font-medium text-afri-gray-900",children:["Â£",((B=(O=b.pricing)==null?void 0:O.total)==null?void 0:B.toFixed(2))||"0.00"]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${Wx[b.status]}`,children:ih[b.status]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-afri-gray-500",children:new Date(b.createdAt).toLocaleDateString()}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:a.jsx("button",{onClick:()=>v(b._id),className:"text-afri-green hover:text-afri-green-dark font-medium",children:"View Details"})})]},b._id)})})]})}),u.pages>1&&a.jsx("div",{className:"mt-6 flex justify-center",children:a.jsx("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[...Array(u.pages)].map((b,y)=>a.jsx("button",{onClick:()=>f({...d,page:y+1}),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${u.currentPage===y+1?"z-10 bg-afri-green text-white border-afri-green":"bg-white border-gray-300 text-afri-gray-700 hover:bg-afri-gray-50"}`,children:y+1},y))})}),l&&s&&a.jsx(Hx,{order:s,onClose:()=>{c(!1),o(null)},onStatusUpdate:N,onRefresh:p})]})}const qx="modulepreload",Vx=function(e){return"/afrimercato-frontend/"+e},oh={},I0=function(r,t,n){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));s=Promise.allSettled(t.map(d=>{if(d=Vx(d),d in oh)return;oh[d]=!0;const f=d.endsWith(".css"),u=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${u}`))return;const g=document.createElement("link");if(g.rel=f?"stylesheet":qx,f||(g.as="script"),g.crossOrigin="",g.href=d,c&&g.setAttribute("nonce",c),document.head.appendChild(g),f)return new Promise((p,m)=>{g.addEventListener("load",p),g.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${d}`)))})}))}function o(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return s.then(l=>{for(const c of l||[])c.status==="rejected"&&o(c.reason);return r().catch(o)})};var sa=Uint8Array,Da=Uint16Array,Q0=Int32Array,pc=new sa([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),gc=new sa([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),D0=new sa([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),wf=function(e,r){for(var t=new Da(31),n=0;n<31;++n)t[n]=r+=1<<e[n-1];for(var s=new Q0(t[30]),n=1;n<30;++n)for(var o=t[n];o<t[n+1];++o)s[o]=o-t[n]<<5|n;return{b:t,r:s}},Nf=wf(pc,2),jf=Nf.b,R0=Nf.r;jf[28]=258,R0[258]=28;var Sf=wf(gc,0),Gx=Sf.b,lh=Sf.r,B0=new Da(32768);for(var or=0;or<32768;++or){var ds=(or&43690)>>1|(or&21845)<<1;ds=(ds&52428)>>2|(ds&13107)<<2,ds=(ds&61680)>>4|(ds&3855)<<4,B0[or]=((ds&65280)>>8|(ds&255)<<8)>>1}var Cn=function(e,r,t){for(var n=e.length,s=0,o=new Da(r);s<n;++s)e[s]&&++o[e[s]-1];var l=new Da(r);for(s=1;s<r;++s)l[s]=l[s-1]+o[s-1]<<1;var c;if(t){c=new Da(1<<r);var d=15-r;for(s=0;s<n;++s)if(e[s])for(var f=s<<4|e[s],u=r-e[s],g=l[e[s]-1]++<<u,p=g|(1<<u)-1;g<=p;++g)c[B0[g]>>d]=f}else for(c=new Da(n),s=0;s<n;++s)e[s]&&(c[s]=B0[l[e[s]-1]++]>>15-e[s]);return c},ys=new sa(288);for(var or=0;or<144;++or)ys[or]=8;for(var or=144;or<256;++or)ys[or]=9;for(var or=256;or<280;++or)ys[or]=7;for(var or=280;or<288;++or)ys[or]=8;var Fo=new sa(32);for(var or=0;or<32;++or)Fo[or]=5;var $x=Cn(ys,9,0),Yx=Cn(ys,9,1),Kx=Cn(Fo,5,0),Xx=Cn(Fo,5,1),x0=function(e){for(var r=e[0],t=1;t<e.length;++t)e[t]>r&&(r=e[t]);return r},sn=function(e,r,t){var n=r/8|0;return(e[n]|e[n+1]<<8)>>(r&7)&t},p0=function(e,r){var t=r/8|0;return(e[t]|e[t+1]<<8|e[t+2]<<16)>>(r&7)},ed=function(e){return(e+7)/8|0},_f=function(e,r,t){return(t==null||t>e.length)&&(t=e.length),new sa(e.subarray(r,t))},Jx=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],dn=function(e,r,t){var n=new Error(r||Jx[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,dn),!t)throw n;return n},Zx=function(e,r,t,n){var s=e.length,o=0;if(!s||r.f&&!r.l)return t||new sa(0);var l=!t,c=l||r.i!=2,d=r.i;l&&(t=new sa(s*3));var f=function(Ce){var De=t.length;if(Ce>De){var $e=new sa(Math.max(De*2,Ce));$e.set(t),t=$e}},u=r.f||0,g=r.p||0,p=r.b||0,m=r.l,j=r.d,v=r.m,N=r.n,b=s*8;do{if(!m){u=sn(e,g,1);var y=sn(e,g+1,3);if(g+=3,y)if(y==1)m=Yx,j=Xx,v=9,N=5;else if(y==2){var B=sn(e,g,31)+257,L=sn(e,g+10,15)+4,E=B+sn(e,g+5,31)+1;g+=14;for(var P=new sa(E),D=new sa(19),k=0;k<L;++k)D[D0[k]]=sn(e,g+k*3,7);g+=L*3;for(var C=x0(D),z=(1<<C)-1,G=Cn(D,C,1),k=0;k<E;){var de=G[sn(e,g,z)];g+=de&15;var _=de>>4;if(_<16)P[k++]=_;else{var J=0,Z=0;for(_==16?(Z=3+sn(e,g,3),g+=2,J=P[k-1]):_==17?(Z=3+sn(e,g,7),g+=3):_==18&&(Z=11+sn(e,g,127),g+=7);Z--;)P[k++]=J}}var oe=P.subarray(0,B),ne=P.subarray(B);v=x0(oe),N=x0(ne),m=Cn(oe,v,1),j=Cn(ne,N,1)}else dn(1);else{var _=ed(g)+4,T=e[_-4]|e[_-3]<<8,O=_+T;if(O>s){d&&dn(0);break}c&&f(p+T),t.set(e.subarray(_,O),p),r.b=p+=T,r.p=g=O*8,r.f=u;continue}if(g>b){d&&dn(0);break}}c&&f(p+131072);for(var me=(1<<v)-1,be=(1<<N)-1,A=g;;A=g){var J=m[p0(e,g)&me],I=J>>4;if(g+=J&15,g>b){d&&dn(0);break}if(J||dn(2),I<256)t[p++]=I;else if(I==256){A=g,m=null;break}else{var R=I-254;if(I>264){var k=I-257,M=pc[k];R=sn(e,g,(1<<M)-1)+jf[k],g+=M}var K=j[p0(e,g)&be],he=K>>4;K||dn(3),g+=K&15;var ne=Gx[he];if(he>3){var M=gc[he];ne+=p0(e,g)&(1<<M)-1,g+=M}if(g>b){d&&dn(0);break}c&&f(p+131072);var fe=p+R;if(p<ne){var ee=o-ne,ve=Math.min(ne,fe);for(ee+p<0&&dn(3);p<ve;++p)t[p]=n[ee+p]}for(;p<fe;++p)t[p]=t[p-ne]}}r.l=m,r.p=A,r.b=p,r.f=u,m&&(u=1,r.m=v,r.d=j,r.n=N)}while(!u);return p!=t.length&&l?_f(t,0,p):t.subarray(0,p)},zn=function(e,r,t){t<<=r&7;var n=r/8|0;e[n]|=t,e[n+1]|=t>>8},go=function(e,r,t){t<<=r&7;var n=r/8|0;e[n]|=t,e[n+1]|=t>>8,e[n+2]|=t>>16},g0=function(e,r){for(var t=[],n=0;n<e.length;++n)e[n]&&t.push({s:n,f:e[n]});var s=t.length,o=t.slice();if(!s)return{t:kf,l:0};if(s==1){var l=new sa(t[0].s+1);return l[t[0].s]=1,{t:l,l:1}}t.sort(function(O,B){return O.f-B.f}),t.push({s:-1,f:25001});var c=t[0],d=t[1],f=0,u=1,g=2;for(t[0]={s:-1,f:c.f+d.f,l:c,r:d};u!=s-1;)c=t[t[f].f<t[g].f?f++:g++],d=t[f!=u&&t[f].f<t[g].f?f++:g++],t[u++]={s:-1,f:c.f+d.f,l:c,r:d};for(var p=o[0].s,n=1;n<s;++n)o[n].s>p&&(p=o[n].s);var m=new Da(p+1),j=M0(t[u-1],m,0);if(j>r){var n=0,v=0,N=j-r,b=1<<N;for(o.sort(function(B,L){return m[L.s]-m[B.s]||B.f-L.f});n<s;++n){var y=o[n].s;if(m[y]>r)v+=b-(1<<j-m[y]),m[y]=r;else break}for(v>>=N;v>0;){var _=o[n].s;m[_]<r?v-=1<<r-m[_]++-1:++n}for(;n>=0&&v;--n){var T=o[n].s;m[T]==r&&(--m[T],++v)}j=r}return{t:new sa(m),l:j}},M0=function(e,r,t){return e.s==-1?Math.max(M0(e.l,r,t+1),M0(e.r,r,t+1)):r[e.s]=t},ch=function(e){for(var r=e.length;r&&!e[--r];);for(var t=new Da(++r),n=0,s=e[0],o=1,l=function(d){t[n++]=d},c=1;c<=r;++c)if(e[c]==s&&c!=r)++o;else{if(!s&&o>2){for(;o>138;o-=138)l(32754);o>2&&(l(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(l(s),--o;o>6;o-=6)l(8304);o>2&&(l(o-3<<5|8208),o=0)}for(;o--;)l(s);o=1,s=e[c]}return{c:t.subarray(0,n),n:r}},vo=function(e,r){for(var t=0,n=0;n<r.length;++n)t+=e[n]*r[n];return t},Af=function(e,r,t){var n=t.length,s=ed(r+2);e[s]=n&255,e[s+1]=n>>8,e[s+2]=e[s]^255,e[s+3]=e[s+1]^255;for(var o=0;o<n;++o)e[s+o+4]=t[o];return(s+4+n)*8},dh=function(e,r,t,n,s,o,l,c,d,f,u){zn(r,u++,t),++s[256];for(var g=g0(s,15),p=g.t,m=g.l,j=g0(o,15),v=j.t,N=j.l,b=ch(p),y=b.c,_=b.n,T=ch(v),O=T.c,B=T.n,L=new Da(19),E=0;E<y.length;++E)++L[y[E]&31];for(var E=0;E<O.length;++E)++L[O[E]&31];for(var P=g0(L,7),D=P.t,k=P.l,C=19;C>4&&!D[D0[C-1]];--C);var z=f+5<<3,G=vo(s,ys)+vo(o,Fo)+l,de=vo(s,p)+vo(o,v)+l+14+3*C+vo(L,D)+2*L[16]+3*L[17]+7*L[18];if(d>=0&&z<=G&&z<=de)return Af(r,u,e.subarray(d,d+f));var J,Z,oe,ne;if(zn(r,u,1+(de<G)),u+=2,de<G){J=Cn(p,m,0),Z=p,oe=Cn(v,N,0),ne=v;var me=Cn(D,k,0);zn(r,u,_-257),zn(r,u+5,B-1),zn(r,u+10,C-4),u+=14;for(var E=0;E<C;++E)zn(r,u+3*E,D[D0[E]]);u+=3*C;for(var be=[y,O],A=0;A<2;++A)for(var I=be[A],E=0;E<I.length;++E){var R=I[E]&31;zn(r,u,me[R]),u+=D[R],R>15&&(zn(r,u,I[E]>>5&127),u+=I[E]>>12)}}else J=$x,Z=ys,oe=Kx,ne=Fo;for(var E=0;E<c;++E){var M=n[E];if(M>255){var R=M>>18&31;go(r,u,J[R+257]),u+=Z[R+257],R>7&&(zn(r,u,M>>23&31),u+=pc[R]);var K=M&31;go(r,u,oe[K]),u+=ne[K],K>3&&(go(r,u,M>>5&8191),u+=gc[K])}else go(r,u,J[M]),u+=Z[M]}return go(r,u,J[256]),u+Z[256]},Qx=new Q0([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),kf=new sa(0),ep=function(e,r,t,n,s,o){var l=o.z||e.length,c=new sa(n+l+5*(1+Math.ceil(l/7e3))+s),d=c.subarray(n,c.length-s),f=o.l,u=(o.r||0)&7;if(r){u&&(d[0]=o.r>>3);for(var g=Qx[r-1],p=g>>13,m=g&8191,j=(1<<t)-1,v=o.p||new Da(32768),N=o.h||new Da(j+1),b=Math.ceil(t/3),y=2*b,_=function(Ke){return(e[Ke]^e[Ke+1]<<b^e[Ke+2]<<y)&j},T=new Q0(25e3),O=new Da(288),B=new Da(32),L=0,E=0,P=o.i||0,D=0,k=o.w||0,C=0;P+2<l;++P){var z=_(P),G=P&32767,de=N[z];if(v[G]=de,N[z]=G,k<=P){var J=l-P;if((L>7e3||D>24576)&&(J>423||!f)){u=dh(e,d,0,T,O,B,E,D,C,P-C,u),D=L=E=0,C=P;for(var Z=0;Z<286;++Z)O[Z]=0;for(var Z=0;Z<30;++Z)B[Z]=0}var oe=2,ne=0,me=m,be=G-de&32767;if(J>2&&z==_(P-be))for(var A=Math.min(p,J)-1,I=Math.min(32767,P),R=Math.min(258,J);be<=I&&--me&&G!=de;){if(e[P+oe]==e[P+oe-be]){for(var M=0;M<R&&e[P+M]==e[P+M-be];++M);if(M>oe){if(oe=M,ne=be,M>A)break;for(var K=Math.min(be,M-2),he=0,Z=0;Z<K;++Z){var fe=P-be+Z&32767,ee=v[fe],ve=fe-ee&32767;ve>he&&(he=ve,de=fe)}}}G=de,de=v[G],be+=G-de&32767}if(ne){T[D++]=268435456|R0[oe]<<18|lh[ne];var Ce=R0[oe]&31,De=lh[ne]&31;E+=pc[Ce]+gc[De],++O[257+Ce],++B[De],k=P+oe,++L}else T[D++]=e[P],++O[e[P]]}}for(P=Math.max(P,k);P<l;++P)T[D++]=e[P],++O[e[P]];u=dh(e,d,f,T,O,B,E,D,C,P-C,u),f||(o.r=u&7|d[u/8|0]<<3,u-=7,o.h=N,o.p=v,o.i=P,o.w=k)}else{for(var P=o.w||0;P<l+f;P+=65535){var $e=P+65535;$e>=l&&(d[u/8|0]=f,$e=l),u=Af(d,u+1,e.subarray(P,$e))}o.i=l}return _f(c,0,n+ed(u)+s)},Tf=function(){var e=1,r=0;return{p:function(t){for(var n=e,s=r,o=t.length|0,l=0;l!=o;){for(var c=Math.min(l+2655,o);l<c;++l)s+=n+=t[l];n=(n&65535)+15*(n>>16),s=(s&65535)+15*(s>>16)}e=n,r=s},d:function(){return e%=65521,r%=65521,(e&255)<<24|(e&65280)<<8|(r&255)<<8|r>>8}}},tp=function(e,r,t,n,s){if(!s&&(s={l:1},r.dictionary)){var o=r.dictionary.subarray(-32768),l=new sa(o.length+e.length);l.set(o),l.set(e,o.length),e=l,s.w=o.length}return ep(e,r.level==null?6:r.level,r.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+r.mem,t,n,s)},Cf=function(e,r,t){for(;t;++r)e[r]=t,t>>>=8},rp=function(e,r){var t=r.level,n=t==0?0:t<6?1:t==9?3:2;if(e[0]=120,e[1]=n<<6|(r.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,r.dictionary){var s=Tf();s.p(r.dictionary),Cf(e,2,s.d())}},ap=function(e,r){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&dn(6,"invalid zlib data"),(e[1]>>5&1)==1&&dn(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function U0(e,r){r||(r={});var t=Tf();t.p(e);var n=tp(e,r,r.dictionary?6:2,4);return rp(n,r),Cf(n,n.length-4,t.d()),n}function np(e,r){return Zx(e.subarray(ap(e),-4),{i:2},r,r)}var sp=typeof TextDecoder<"u"&&new TextDecoder,ip=0;try{sp.decode(kf,{stream:!0}),ip=1}catch{}var yt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function v0(){yt.console&&typeof yt.console.log=="function"&&yt.console.log.apply(yt.console,arguments)}var tr={log:v0,warn:function(e){yt.console&&(typeof yt.console.warn=="function"?yt.console.warn.apply(yt.console,arguments):v0.call(null,arguments))},error:function(e){yt.console&&(typeof yt.console.error=="function"?yt.console.error.apply(yt.console,arguments):v0(e))}};function y0(e,r,t){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){Is(n.response,r,t)},n.onerror=function(){tr.error("could not download file")},n.send()}function hh(e){var r=new XMLHttpRequest;r.open("HEAD",e,!1);try{r.send()}catch{}return r.status>=200&&r.status<=299}function Ml(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(r)}}var wo,H0,Is=yt.saveAs||((typeof window>"u"?"undefined":rr(window))!=="object"||window!==yt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,r,t){var n=yt.URL||yt.webkitURL,s=document.createElement("a");r=r||e.name||"download",s.download=r,s.rel="noopener",typeof e=="string"?(s.href=e,s.origin!==location.origin?hh(s.href)?y0(e,r,t):Ml(s,s.target="_blank"):Ml(s)):(s.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(s.href)},4e4),setTimeout(function(){Ml(s)},0))}:"msSaveOrOpenBlob"in navigator?function(e,r,t){if(r=r||e.name||"download",typeof e=="string")if(hh(e))y0(e,r,t);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){Ml(n)})}else navigator.msSaveOrOpenBlob(function(s,o){return o===void 0?o={autoBom:!1}:rr(o)!=="object"&&(tr.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}(e,t),r)}:function(e,r,t,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return y0(e,r,t);var s=e.type==="application/octet-stream",o=/constructor/i.test(yt.HTMLElement)||yt.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||s&&o)&&(typeof FileReader>"u"?"undefined":rr(FileReader))==="object"){var c=new FileReader;c.onloadend=function(){var u=c.result;u=l?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=u:location=u,n=null},c.readAsDataURL(e)}else{var d=yt.URL||yt.webkitURL,f=d.createObjectURL(e);n?n.location=f:location.href=f,n=null,setTimeout(function(){d.revokeObjectURL(f)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function Ef(e){var r;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(c){return[parseInt(c[1]),parseInt(c[2]),parseInt(c[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(c){return[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(c){return[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)]}}],n=0;n<t.length;n++){var s=t[n].re,o=t[n].process,l=s.exec(e);l&&(r=o(l),this.r=r[0],this.g=r[1],this.b=r[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var c=this.r.toString(16),d=this.g.toString(16),f=this.b.toString(16);return c.length==1&&(c="0"+c),d.length==1&&(d="0"+d),f.length==1&&(f="0"+f),"#"+c+d+f}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function b0(e,r){var t=e[0],n=e[1],s=e[2],o=e[3];t=ta(t,n,s,o,r[0],7,-680876936),o=ta(o,t,n,s,r[1],12,-389564586),s=ta(s,o,t,n,r[2],17,606105819),n=ta(n,s,o,t,r[3],22,-1044525330),t=ta(t,n,s,o,r[4],7,-176418897),o=ta(o,t,n,s,r[5],12,1200080426),s=ta(s,o,t,n,r[6],17,-1473231341),n=ta(n,s,o,t,r[7],22,-45705983),t=ta(t,n,s,o,r[8],7,1770035416),o=ta(o,t,n,s,r[9],12,-1958414417),s=ta(s,o,t,n,r[10],17,-42063),n=ta(n,s,o,t,r[11],22,-1990404162),t=ta(t,n,s,o,r[12],7,1804603682),o=ta(o,t,n,s,r[13],12,-40341101),s=ta(s,o,t,n,r[14],17,-1502002290),t=ra(t,n=ta(n,s,o,t,r[15],22,1236535329),s,o,r[1],5,-165796510),o=ra(o,t,n,s,r[6],9,-1069501632),s=ra(s,o,t,n,r[11],14,643717713),n=ra(n,s,o,t,r[0],20,-373897302),t=ra(t,n,s,o,r[5],5,-701558691),o=ra(o,t,n,s,r[10],9,38016083),s=ra(s,o,t,n,r[15],14,-660478335),n=ra(n,s,o,t,r[4],20,-405537848),t=ra(t,n,s,o,r[9],5,568446438),o=ra(o,t,n,s,r[14],9,-1019803690),s=ra(s,o,t,n,r[3],14,-187363961),n=ra(n,s,o,t,r[8],20,1163531501),t=ra(t,n,s,o,r[13],5,-1444681467),o=ra(o,t,n,s,r[2],9,-51403784),s=ra(s,o,t,n,r[7],14,1735328473),t=aa(t,n=ra(n,s,o,t,r[12],20,-1926607734),s,o,r[5],4,-378558),o=aa(o,t,n,s,r[8],11,-2022574463),s=aa(s,o,t,n,r[11],16,1839030562),n=aa(n,s,o,t,r[14],23,-35309556),t=aa(t,n,s,o,r[1],4,-1530992060),o=aa(o,t,n,s,r[4],11,1272893353),s=aa(s,o,t,n,r[7],16,-155497632),n=aa(n,s,o,t,r[10],23,-1094730640),t=aa(t,n,s,o,r[13],4,681279174),o=aa(o,t,n,s,r[0],11,-358537222),s=aa(s,o,t,n,r[3],16,-722521979),n=aa(n,s,o,t,r[6],23,76029189),t=aa(t,n,s,o,r[9],4,-640364487),o=aa(o,t,n,s,r[12],11,-421815835),s=aa(s,o,t,n,r[15],16,530742520),t=na(t,n=aa(n,s,o,t,r[2],23,-995338651),s,o,r[0],6,-198630844),o=na(o,t,n,s,r[7],10,1126891415),s=na(s,o,t,n,r[14],15,-1416354905),n=na(n,s,o,t,r[5],21,-57434055),t=na(t,n,s,o,r[12],6,1700485571),o=na(o,t,n,s,r[3],10,-1894986606),s=na(s,o,t,n,r[10],15,-1051523),n=na(n,s,o,t,r[1],21,-2054922799),t=na(t,n,s,o,r[8],6,1873313359),o=na(o,t,n,s,r[15],10,-30611744),s=na(s,o,t,n,r[6],15,-1560198380),n=na(n,s,o,t,r[13],21,1309151649),t=na(t,n,s,o,r[4],6,-145523070),o=na(o,t,n,s,r[11],10,-1120210379),s=na(s,o,t,n,r[2],15,718787259),n=na(n,s,o,t,r[9],21,-343485551),e[0]=xs(t,e[0]),e[1]=xs(n,e[1]),e[2]=xs(s,e[2]),e[3]=xs(o,e[3])}function vc(e,r,t,n,s,o){return r=xs(xs(r,e),xs(n,o)),xs(r<<s|r>>>32-s,t)}function ta(e,r,t,n,s,o,l){return vc(r&t|~r&n,e,r,s,o,l)}function ra(e,r,t,n,s,o,l){return vc(r&n|t&~n,e,r,s,o,l)}function aa(e,r,t,n,s,o,l){return vc(r^t^n,e,r,s,o,l)}function na(e,r,t,n,s,o,l){return vc(t^(r|~n),e,r,s,o,l)}function Lf(e){var r,t=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=e.length;r+=64)b0(n,op(e.substring(r-64,r)));e=e.substring(r-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<e.length;r++)s[r>>2]|=e.charCodeAt(r)<<(r%4<<3);if(s[r>>2]|=128<<(r%4<<3),r>55)for(b0(n,s),r=0;r<16;r++)s[r]=0;return s[14]=8*t,b0(n,s),n}function op(e){var r,t=[];for(r=0;r<64;r+=4)t[r>>2]=e.charCodeAt(r)+(e.charCodeAt(r+1)<<8)+(e.charCodeAt(r+2)<<16)+(e.charCodeAt(r+3)<<24);return t}wo=yt.atob.bind(yt),H0=yt.btoa.bind(yt);var fh="0123456789abcdef".split("");function lp(e){for(var r="",t=0;t<4;t++)r+=fh[e>>8*t+4&15]+fh[e>>8*t&15];return r}function cp(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function W0(e){return Lf(e).map(cp).join("")}var dp=function(e){for(var r=0;r<e.length;r++)e[r]=lp(e[r]);return e.join("")}(Lf("hello"))!="5d41402abc4b2a76b9719d911017c592";function xs(e,r){if(dp){var t=(65535&e)+(65535&r);return(e>>16)+(r>>16)+(t>>16)<<16|65535&t}return e+r&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function z0(e,r){var t,n,s,o;if(e!==t){for(var l=(s=e,o=1+(256/e.length>>0),new Array(o+1).join(s)),c=[],d=0;d<256;d++)c[d]=d;var f=0;for(d=0;d<256;d++){var u=c[d];f=(f+u+l.charCodeAt(d))%256,c[d]=c[f],c[f]=u}t=e,n=c}else c=n;var g=r.length,p=0,m=0,j="";for(d=0;d<g;d++)m=(m+(u=c[p=(p+1)%256]))%256,c[p]=c[m],c[m]=u,l=c[(c[p]+c[m])%256],j+=String.fromCharCode(r.charCodeAt(d)^l);return j}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var uh={print:4,modify:8,copy:16,"annot-forms":32};function ki(e,r,t,n){this.v=1,this.r=2;var s=192;e.forEach(function(c){if(uh.perm!==void 0)throw new Error("Invalid permission: "+c);s+=uh[c]}),this.padding="(Â¿N^NuÂŠAd\0NVÃ¿Ãº\b..\0Â¶Ãh>Â€/\fÂ©Ã¾dSiz";var o=(r+this.padding).substr(0,32),l=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(o,l),this.P=-(1+(255^s)),this.encryptionKey=W0(o+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=z0(this.encryptionKey,this.padding)}function Ti(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var r="",t=e.length,n=0;n<t;n++){var s=e.charCodeAt(n);s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?r+="#"+("0"+s.toString(16)).slice(-2):r+=e[n]}return r}function mh(e){if(rr(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var r={};this.subscribe=function(t,n,s){if(s=s||!1,typeof t!="string"||typeof n!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");r.hasOwnProperty(t)||(r[t]={});var o=Math.random().toString(35);return r[t][o]=[n,!!s],o},this.unsubscribe=function(t){for(var n in r)if(r[n][t])return delete r[n][t],Object.keys(r[n]).length===0&&delete r[n],!0;return!1},this.publish=function(t){if(r.hasOwnProperty(t)){var n=Array.prototype.slice.call(arguments,1),s=[];for(var o in r[t]){var l=r[t][o];try{l[0].apply(e,n)}catch(c){yt.console&&tr.error("jsPDF PubSub Error",c.message,c)}l[1]&&s.push(o)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return r}}function Po(e){if(!(this instanceof Po))return new Po(e);var r="opacity,stroke-opacity".split(",");for(var t in e)e.hasOwnProperty(t)&&r.indexOf(t)>=0&&(this[t]=e[t]);this.id="",this.objectNumber=-1}function Ff(e,r){this.gState=e,this.matrix=r,this.id="",this.objectNumber=-1}function ms(e,r,t,n,s){if(!(this instanceof ms))return new ms(e,r,t,n,s);this.type=e==="axial"?2:3,this.coords=r,this.colors=t,Ff.call(this,n,s)}function Rs(e,r,t,n,s){if(!(this instanceof Rs))return new Rs(e,r,t,n,s);this.boundingBox=e,this.xStep=r,this.yStep=t,this.stream="",this.cloneIndex=0,Ff.call(this,n,s)}function pt(e){var r,t=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],s=arguments[2],o=arguments[3],l=[],c=1,d=16,f="S",u=null;rr(e=e||{})==="object"&&(t=e.orientation,n=e.unit||n,s=e.format||s,o=e.compress||e.compressPdf||o,(u=e.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),c=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(r=e.precision),e.floatPrecision!==void 0&&(d=e.floatPrecision),f=e.defaultPathOperation||"S"),l=e.filters||(o===!0?["FlateEncode"]:l),n=n||"mm",t=(""+(t||"P")).toLowerCase();var g=e.putOnlyUsedFonts||!1,p={},m={internal:{},__private__:{}};m.__private__.PubSub=mh;var j="1.3",v=m.__private__.getPdfVersion=function(){return j};m.__private__.setPdfVersion=function(w){j=w};var N={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};m.__private__.getPageFormats=function(){return N};var b=m.__private__.getPageFormat=function(w){return N[w]};s=s||"a4";var y={COMPAT:"compat",ADVANCED:"advanced"},_=y.COMPAT;function T(){this.saveGraphicsState(),le(new mt(st,0,0,-st,0,Zn()*st).toString()+" cm"),this.setFontSize(this.getFontSize()/st),f="n",_=y.ADVANCED}function O(){this.restoreGraphicsState(),f="S",_=y.COMPAT}var B=m.__private__.combineFontStyleAndFontWeight=function(w,H){if(w=="bold"&&H=="normal"||w=="bold"&&H==400||w=="normal"&&H=="italic"||w=="bold"&&H=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return H&&(w=H==400||H==="normal"?w==="italic"?"italic":"normal":H!=700&&H!=="bold"||w!=="normal"?(H==700?"bold":H)+""+w:"bold"),w};m.advancedAPI=function(w){var H=_===y.COMPAT;return H&&T.call(this),typeof w!="function"||(w(this),H&&O.call(this)),this},m.compatAPI=function(w){var H=_===y.ADVANCED;return H&&O.call(this),typeof w!="function"||(w(this),H&&T.call(this)),this},m.isAdvancedAPI=function(){return _===y.ADVANCED};var L,E=function(w){if(_!==y.ADVANCED)throw new Error(w+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},P=m.roundToPrecision=m.__private__.roundToPrecision=function(w,H){var ce=r||H;if(isNaN(w)||isNaN(ce))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return w.toFixed(ce).replace(/0+$/,"")};L=m.hpf=m.__private__.hpf=typeof d=="number"?function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.hpf");return P(w,d)}:d==="smart"?function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.hpf");return P(w,w>-1&&w<1?16:5)}:function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.hpf");return P(w,16)};var D=m.f2=m.__private__.f2=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.f2");return P(w,2)},k=m.__private__.f3=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.f3");return P(w,3)},C=m.scale=m.__private__.scale=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.scale");return _===y.COMPAT?w*st:_===y.ADVANCED?w:void 0},z=function(w){return _===y.COMPAT?Zn()-w:_===y.ADVANCED?w:void 0},G=function(w){return C(z(w))};m.__private__.setPrecision=m.setPrecision=function(w){typeof parseInt(w,10)=="number"&&(r=parseInt(w,10))};var de,J="00000000000000000000000000000000",Z=m.__private__.getFileId=function(){return J},oe=m.__private__.setFileId=function(w){return J=w!==void 0&&/^[a-fA-F0-9]{32}$/.test(w)?w.toUpperCase():J.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(Qr=new ki(u.userPermissions,u.userPassword,u.ownerPassword,J)),J};m.setFileId=function(w){return oe(w),this},m.getFileId=function(){return Z()};var ne=m.__private__.convertDateToPDFDate=function(w){var H=w.getTimezoneOffset(),ce=H<0?"+":"-",ue=Math.floor(Math.abs(H/60)),Ne=Math.abs(H%60),Pe=[ce,R(ue),"'",R(Ne),"'"].join("");return["D:",w.getFullYear(),R(w.getMonth()+1),R(w.getDate()),R(w.getHours()),R(w.getMinutes()),R(w.getSeconds()),Pe].join("")},me=m.__private__.convertPDFDateToDate=function(w){var H=parseInt(w.substr(2,4),10),ce=parseInt(w.substr(6,2),10)-1,ue=parseInt(w.substr(8,2),10),Ne=parseInt(w.substr(10,2),10),Pe=parseInt(w.substr(12,2),10),Ve=parseInt(w.substr(14,2),10);return new Date(H,ce,ue,Ne,Pe,Ve,0)},be=m.__private__.setCreationDate=function(w){var H;if(w===void 0&&(w=new Date),w instanceof Date)H=ne(w);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(w))throw new Error("Invalid argument passed to jsPDF.setCreationDate");H=w}return de=H},A=m.__private__.getCreationDate=function(w){var H=de;return w==="jsDate"&&(H=me(de)),H};m.setCreationDate=function(w){return be(w),this},m.getCreationDate=function(w){return A(w)};var I,R=m.__private__.padd2=function(w){return("0"+parseInt(w)).slice(-2)},M=m.__private__.padd2Hex=function(w){return("00"+(w=w.toString())).substr(w.length)},K=0,he=[],fe=[],ee=0,ve=[],Ce=[],De=!1,$e=fe,Ke=function(){K=0,ee=0,fe=[],he=[],ve=[],Q=dr(),te=dr()};m.__private__.setCustomOutputDestination=function(w){De=!0,$e=w};var Ee=function(w){De||($e=w)};m.__private__.resetCustomOutputDestination=function(){De=!1,$e=fe};var le=m.__private__.out=function(w){return w=w.toString(),ee+=w.length+1,$e.push(w),$e},He=m.__private__.write=function(w){return le(arguments.length===1?w.toString():Array.prototype.join.call(arguments," "))},et=m.__private__.getArrayBuffer=function(w){for(var H=w.length,ce=new ArrayBuffer(H),ue=new Uint8Array(ce);H--;)ue[H]=w.charCodeAt(H);return ce},qe=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];m.__private__.getStandardFonts=function(){return qe};var Xe=e.fontSize||16;m.__private__.setFontSize=m.setFontSize=function(w){return Xe=_===y.ADVANCED?w/st:w,this};var tt,at=m.__private__.getFontSize=m.getFontSize=function(){return _===y.COMPAT?Xe:Xe*st},ht=e.R2L||!1;m.__private__.setR2L=m.setR2L=function(w){return ht=w,this},m.__private__.getR2L=m.getR2L=function(){return ht};var ft,wt=m.__private__.setZoomMode=function(w){var H=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(w))tt=w;else if(isNaN(w)){if(H.indexOf(w)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+w+'" is not recognized.');tt=w}else tt=parseInt(w,10)};m.__private__.getZoomMode=function(){return tt};var kt,Lt=m.__private__.setPageMode=function(w){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(w)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+w+'" is not recognized.');ft=w};m.__private__.getPageMode=function(){return ft};var Ft=m.__private__.setLayoutMode=function(w){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(w)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+w+'" is not recognized.');kt=w};m.__private__.getLayoutMode=function(){return kt},m.__private__.setDisplayMode=m.setDisplayMode=function(w,H,ce){return wt(w),Ft(H),Lt(ce),this};var vt={title:"",subject:"",author:"",keywords:"",creator:""};m.__private__.getDocumentProperty=function(w){if(Object.keys(vt).indexOf(w)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return vt[w]},m.__private__.getDocumentProperties=function(){return vt},m.__private__.setDocumentProperties=m.setProperties=m.setDocumentProperties=function(w){for(var H in vt)vt.hasOwnProperty(H)&&w[H]&&(vt[H]=w[H]);return this},m.__private__.setDocumentProperty=function(w,H){if(Object.keys(vt).indexOf(w)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return vt[w]=H};var Ct,st,Fr,Ot,ma,Wt={},ar={},Ba=[],Dt={},vn={},ir={},_a={},Ja=null,Qt=0,Nt=[],Bt=new mh(m),Fn=e.hotfixes||[],Pr={},Ma={},Ua=[],mt=function w(H,ce,ue,Ne,Pe,Ve){if(!(this instanceof w))return new w(H,ce,ue,Ne,Pe,Ve);isNaN(H)&&(H=1),isNaN(ce)&&(ce=0),isNaN(ue)&&(ue=0),isNaN(Ne)&&(Ne=1),isNaN(Pe)&&(Pe=0),isNaN(Ve)&&(Ve=0),this._matrix=[H,ce,ue,Ne,Pe,Ve]};Object.defineProperty(mt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(w){this._matrix[0]=w}}),Object.defineProperty(mt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(w){this._matrix[1]=w}}),Object.defineProperty(mt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(w){this._matrix[2]=w}}),Object.defineProperty(mt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(w){this._matrix[3]=w}}),Object.defineProperty(mt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(w){this._matrix[4]=w}}),Object.defineProperty(mt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(w){this._matrix[5]=w}}),Object.defineProperty(mt.prototype,"a",{get:function(){return this._matrix[0]},set:function(w){this._matrix[0]=w}}),Object.defineProperty(mt.prototype,"b",{get:function(){return this._matrix[1]},set:function(w){this._matrix[1]=w}}),Object.defineProperty(mt.prototype,"c",{get:function(){return this._matrix[2]},set:function(w){this._matrix[2]=w}}),Object.defineProperty(mt.prototype,"d",{get:function(){return this._matrix[3]},set:function(w){this._matrix[3]=w}}),Object.defineProperty(mt.prototype,"e",{get:function(){return this._matrix[4]},set:function(w){this._matrix[4]=w}}),Object.defineProperty(mt.prototype,"f",{get:function(){return this._matrix[5]},set:function(w){this._matrix[5]=w}}),Object.defineProperty(mt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(mt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(mt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(mt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),mt.prototype.join=function(w){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(L).join(w)},mt.prototype.multiply=function(w){var H=w.sx*this.sx+w.shy*this.shx,ce=w.sx*this.shy+w.shy*this.sy,ue=w.shx*this.sx+w.sy*this.shx,Ne=w.shx*this.shy+w.sy*this.sy,Pe=w.tx*this.sx+w.ty*this.shx+this.tx,Ve=w.tx*this.shy+w.ty*this.sy+this.ty;return new mt(H,ce,ue,Ne,Pe,Ve)},mt.prototype.decompose=function(){var w=this.sx,H=this.shy,ce=this.shx,ue=this.sy,Ne=this.tx,Pe=this.ty,Ve=Math.sqrt(w*w+H*H),lt=(w/=Ve)*ce+(H/=Ve)*ue;ce-=w*lt,ue-=H*lt;var ut=Math.sqrt(ce*ce+ue*ue);return lt/=ut,w*(ue/=ut)<H*(ce/=ut)&&(w=-w,H=-H,lt=-lt,Ve=-Ve),{scale:new mt(Ve,0,0,ut,0,0),translate:new mt(1,0,0,1,Ne,Pe),rotate:new mt(w,H,-H,w,0,0),skew:new mt(1,0,lt,1,0,0)}},mt.prototype.toString=function(w){return this.join(" ")},mt.prototype.inversed=function(){var w=this.sx,H=this.shy,ce=this.shx,ue=this.sy,Ne=this.tx,Pe=this.ty,Ve=1/(w*ue-H*ce),lt=ue*Ve,ut=-H*Ve,At=-ce*Ve,St=w*Ve;return new mt(lt,ut,At,St,-lt*Ne-At*Pe,-ut*Ne-St*Pe)},mt.prototype.applyToPoint=function(w){var H=w.x*this.sx+w.y*this.shx+this.tx,ce=w.x*this.shy+w.y*this.sy+this.ty;return new ni(H,ce)},mt.prototype.applyToRectangle=function(w){var H=this.applyToPoint(w),ce=this.applyToPoint(new ni(w.x+w.w,w.y+w.h));return new Xi(H.x,H.y,ce.x-H.x,ce.y-H.y)},mt.prototype.clone=function(){var w=this.sx,H=this.shy,ce=this.shx,ue=this.sy,Ne=this.tx,Pe=this.ty;return new mt(w,H,ce,ue,Ne,Pe)},m.Matrix=mt;var Aa=m.matrixMult=function(w,H){return H.multiply(w)},xa=new mt(1,0,0,1,0,0);m.unitMatrix=m.identityMatrix=xa;var Zr=function(w,H){if(!vn[w]){var ce=(H instanceof ms?"Sh":"P")+(Object.keys(Dt).length+1).toString(10);H.id=ce,vn[w]=ce,Dt[ce]=H,Bt.publish("addPattern",H)}};m.ShadingPattern=ms,m.TilingPattern=Rs,m.addShadingPattern=function(w,H){return E("addShadingPattern()"),Zr(w,H),this},m.beginTilingPattern=function(w){E("beginTilingPattern()"),ll(w.boundingBox[0],w.boundingBox[1],w.boundingBox[2]-w.boundingBox[0],w.boundingBox[3]-w.boundingBox[1],w.matrix)},m.endTilingPattern=function(w,H){E("endTilingPattern()"),H.stream=Ce[I].join(`
`),Zr(w,H),Bt.publish("endTilingPattern",H),Ua.pop().restore()};var gr=m.__private__.newObject=function(){var w=dr();return q(w,!0),w},dr=m.__private__.newObjectDeferred=function(){return K++,he[K]=function(){return ee},K},q=function(w,H){return H=typeof H=="boolean"&&H,he[w]=ee,H&&le(w+" 0 obj"),w},se=m.__private__.newAdditionalObject=function(){var w={objId:dr(),content:""};return ve.push(w),w},Q=dr(),te=dr(),ae=m.__private__.decodeColorString=function(w){var H=w.split(" ");if(H.length!==2||H[1]!=="g"&&H[1]!=="G")H.length===5&&(H[4]==="k"||H[4]==="K")&&(H=[(1-H[0])*(1-H[3]),(1-H[1])*(1-H[3]),(1-H[2])*(1-H[3]),"r"]);else{var ce=parseFloat(H[0]);H=[ce,ce,ce,"r"]}for(var ue="#",Ne=0;Ne<3;Ne++)ue+=("0"+Math.floor(255*parseFloat(H[Ne])).toString(16)).slice(-2);return ue},ie=m.__private__.encodeColorString=function(w){var H;typeof w=="string"&&(w={ch1:w});var ce=w.ch1,ue=w.ch2,Ne=w.ch3,Pe=w.ch4,Ve=w.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ce=="string"&&ce.charAt(0)!=="#"){var lt=new Ef(ce);if(lt.ok)ce=lt.toHex();else if(!/^\d*\.?\d*$/.test(ce))throw new Error('Invalid color "'+ce+'" passed to jsPDF.encodeColorString.')}if(typeof ce=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ce)&&(ce="#"+ce[1]+ce[1]+ce[2]+ce[2]+ce[3]+ce[3]),typeof ce=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ce)){var ut=parseInt(ce.substr(1),16);ce=ut>>16&255,ue=ut>>8&255,Ne=255&ut}if(ue===void 0||Pe===void 0&&ce===ue&&ue===Ne)if(typeof ce=="string")H=ce+" "+Ve[0];else switch(w.precision){case 2:H=D(ce/255)+" "+Ve[0];break;case 3:default:H=k(ce/255)+" "+Ve[0]}else if(Pe===void 0||rr(Pe)==="object"){if(Pe&&!isNaN(Pe.a)&&Pe.a===0)return H=["1.","1.","1.",Ve[1]].join(" ");if(typeof ce=="string")H=[ce,ue,Ne,Ve[1]].join(" ");else switch(w.precision){case 2:H=[D(ce/255),D(ue/255),D(Ne/255),Ve[1]].join(" ");break;default:case 3:H=[k(ce/255),k(ue/255),k(Ne/255),Ve[1]].join(" ")}}else if(typeof ce=="string")H=[ce,ue,Ne,Pe,Ve[2]].join(" ");else switch(w.precision){case 2:H=[D(ce),D(ue),D(Ne),D(Pe),Ve[2]].join(" ");break;case 3:default:H=[k(ce),k(ue),k(Ne),k(Pe),Ve[2]].join(" ")}return H},Se=m.__private__.getFilters=function(){return l},Le=m.__private__.putStream=function(w){var H=(w=w||{}).data||"",ce=w.filters||Se(),ue=w.alreadyAppliedFilters||[],Ne=w.addLength1||!1,Pe=H.length,Ve=w.objectId,lt=function(ea){return ea};if(u!==null&&Ve===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(lt=Qr.encryptor(Ve,0));var ut={};ce===!0&&(ce=["FlateEncode"]);var At=w.additionalKeyValues||[],St=(ut=pt.API.processDataByFilters!==void 0?pt.API.processDataByFilters(H,ce):{data:H,reverseChain:[]}).reverseChain+(Array.isArray(ue)?ue.join(" "):ue.toString());if(ut.data.length!==0&&(At.push({key:"Length",value:ut.data.length}),Ne===!0&&At.push({key:"Length1",value:Pe})),St.length!=0)if(St.split("/").length-1==1)At.push({key:"Filter",value:St});else{At.push({key:"Filter",value:"["+St+"]"});for(var It=0;It<At.length;It+=1)if(At[It].key==="DecodeParms"){for(var cr=[],hr=0;hr<ut.reverseChain.split("/").length-1;hr+=1)cr.push("null");cr.push(At[It].value),At[It].value="["+cr.join(" ")+"]"}}le("<<");for(var _r=0;_r<At.length;_r++)le("/"+At[_r].key+" "+At[_r].value);le(">>"),ut.data.length!==0&&(le("stream"),le(lt(ut.data)),le("endstream"))},je=m.__private__.putPage=function(w){var H=w.number,ce=w.data,ue=w.objId,Ne=w.contentsObjId;q(ue,!0),le("<</Type /Page"),le("/Parent "+w.rootDictionaryObjId+" 0 R"),le("/Resources "+w.resourceDictionaryObjId+" 0 R"),le("/MediaBox ["+parseFloat(L(w.mediaBox.bottomLeftX))+" "+parseFloat(L(w.mediaBox.bottomLeftY))+" "+L(w.mediaBox.topRightX)+" "+L(w.mediaBox.topRightY)+"]"),w.cropBox!==null&&le("/CropBox ["+L(w.cropBox.bottomLeftX)+" "+L(w.cropBox.bottomLeftY)+" "+L(w.cropBox.topRightX)+" "+L(w.cropBox.topRightY)+"]"),w.bleedBox!==null&&le("/BleedBox ["+L(w.bleedBox.bottomLeftX)+" "+L(w.bleedBox.bottomLeftY)+" "+L(w.bleedBox.topRightX)+" "+L(w.bleedBox.topRightY)+"]"),w.trimBox!==null&&le("/TrimBox ["+L(w.trimBox.bottomLeftX)+" "+L(w.trimBox.bottomLeftY)+" "+L(w.trimBox.topRightX)+" "+L(w.trimBox.topRightY)+"]"),w.artBox!==null&&le("/ArtBox ["+L(w.artBox.bottomLeftX)+" "+L(w.artBox.bottomLeftY)+" "+L(w.artBox.topRightX)+" "+L(w.artBox.topRightY)+"]"),typeof w.userUnit=="number"&&w.userUnit!==1&&le("/UserUnit "+w.userUnit),Bt.publish("putPage",{objId:ue,pageContext:Nt[H],pageNumber:H,page:ce}),le("/Contents "+Ne+" 0 R"),le(">>"),le("endobj");var Pe=ce.join(`
`);return _===y.ADVANCED&&(Pe+=`
Q`),q(Ne,!0),Le({data:Pe,filters:Se(),objectId:Ne}),le("endobj"),ue},ke=m.__private__.putPages=function(){var w,H,ce=[];for(w=1;w<=Qt;w++)Nt[w].objId=dr(),Nt[w].contentsObjId=dr();for(w=1;w<=Qt;w++)ce.push(je({number:w,data:Ce[w],objId:Nt[w].objId,contentsObjId:Nt[w].contentsObjId,mediaBox:Nt[w].mediaBox,cropBox:Nt[w].cropBox,bleedBox:Nt[w].bleedBox,trimBox:Nt[w].trimBox,artBox:Nt[w].artBox,userUnit:Nt[w].userUnit,rootDictionaryObjId:Q,resourceDictionaryObjId:te}));q(Q,!0),le("<</Type /Pages");var ue="/Kids [";for(H=0;H<Qt;H++)ue+=ce[H]+" 0 R ";le(ue+"]"),le("/Count "+Qt),le(">>"),le("endobj"),Bt.publish("postPutPages")},Te=function(w){Bt.publish("putFont",{font:w,out:le,newObject:gr,putStream:Le}),w.isAlreadyPutted!==!0&&(w.objectNumber=gr(),le("<<"),le("/Type /Font"),le("/BaseFont /"+Ti(w.postScriptName)),le("/Subtype /Type1"),typeof w.encoding=="string"&&le("/Encoding /"+w.encoding),le("/FirstChar 32"),le("/LastChar 255"),le(">>"),le("endobj"))},Ge=function(){for(var w in Wt)Wt.hasOwnProperty(w)&&(g===!1||g===!0&&p.hasOwnProperty(w))&&Te(Wt[w])},Je=function(w){w.objectNumber=gr();var H=[];H.push({key:"Type",value:"/XObject"}),H.push({key:"Subtype",value:"/Form"}),H.push({key:"BBox",value:"["+[L(w.x),L(w.y),L(w.x+w.width),L(w.y+w.height)].join(" ")+"]"}),H.push({key:"Matrix",value:"["+w.matrix.toString()+"]"});var ce=w.pages[1].join(`
`);Le({data:ce,additionalKeyValues:H,objectId:w.objectNumber}),le("endobj")},ot=function(){for(var w in Pr)Pr.hasOwnProperty(w)&&Je(Pr[w])},Ye=function(w,H){var ce,ue=[],Ne=1/(H-1);for(ce=0;ce<1;ce+=Ne)ue.push(ce);if(ue.push(1),w[0].offset!=0){var Pe={offset:0,color:w[0].color};w.unshift(Pe)}if(w[w.length-1].offset!=1){var Ve={offset:1,color:w[w.length-1].color};w.push(Ve)}for(var lt="",ut=0,At=0;At<ue.length;At++){for(ce=ue[At];ce>w[ut+1].offset;)ut++;var St=w[ut].offset,It=(ce-St)/(w[ut+1].offset-St),cr=w[ut].color,hr=w[ut+1].color;lt+=M(Math.round((1-It)*cr[0]+It*hr[0]).toString(16))+M(Math.round((1-It)*cr[1]+It*hr[1]).toString(16))+M(Math.round((1-It)*cr[2]+It*hr[2]).toString(16))}return lt.trim()},it=function(w,H){H||(H=21);var ce=gr(),ue=Ye(w.colors,H),Ne=[];Ne.push({key:"FunctionType",value:"0"}),Ne.push({key:"Domain",value:"[0.0 1.0]"}),Ne.push({key:"Size",value:"["+H+"]"}),Ne.push({key:"BitsPerSample",value:"8"}),Ne.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ne.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Le({data:ue,additionalKeyValues:Ne,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ce}),le("endobj"),w.objectNumber=gr(),le("<< /ShadingType "+w.type),le("/ColorSpace /DeviceRGB");var Pe="/Coords ["+L(parseFloat(w.coords[0]))+" "+L(parseFloat(w.coords[1]))+" ";w.type===2?Pe+=L(parseFloat(w.coords[2]))+" "+L(parseFloat(w.coords[3])):Pe+=L(parseFloat(w.coords[2]))+" "+L(parseFloat(w.coords[3]))+" "+L(parseFloat(w.coords[4]))+" "+L(parseFloat(w.coords[5])),le(Pe+="]"),w.matrix&&le("/Matrix ["+w.matrix.toString()+"]"),le("/Function "+ce+" 0 R"),le("/Extend [true true]"),le(">>"),le("endobj")},bt=function(w,H){var ce=dr(),ue=gr();H.push({resourcesOid:ce,objectOid:ue}),w.objectNumber=ue;var Ne=[];Ne.push({key:"Type",value:"/Pattern"}),Ne.push({key:"PatternType",value:"1"}),Ne.push({key:"PaintType",value:"1"}),Ne.push({key:"TilingType",value:"1"}),Ne.push({key:"BBox",value:"["+w.boundingBox.map(L).join(" ")+"]"}),Ne.push({key:"XStep",value:L(w.xStep)}),Ne.push({key:"YStep",value:L(w.yStep)}),Ne.push({key:"Resources",value:ce+" 0 R"}),w.matrix&&Ne.push({key:"Matrix",value:"["+w.matrix.toString()+"]"}),Le({data:w.stream,additionalKeyValues:Ne,objectId:w.objectNumber}),le("endobj")},zt=function(w){var H;for(H in Dt)Dt.hasOwnProperty(H)&&(Dt[H]instanceof ms?it(Dt[H]):Dt[H]instanceof Rs&&bt(Dt[H],w))},Xt=function(w){for(var H in w.objectNumber=gr(),le("<<"),w)switch(H){case"opacity":le("/ca "+D(w[H]));break;case"stroke-opacity":le("/CA "+D(w[H]))}le(">>"),le("endobj")},Sr=function(){var w;for(w in ir)ir.hasOwnProperty(w)&&Xt(ir[w])},Za=function(){for(var w in le("/XObject <<"),Pr)Pr.hasOwnProperty(w)&&Pr[w].objectNumber>=0&&le("/"+w+" "+Pr[w].objectNumber+" 0 R");Bt.publish("putXobjectDict"),le(">>")},Pn=function(){Qr.oid=gr(),le("<<"),le("/Filter /Standard"),le("/V "+Qr.v),le("/R "+Qr.r),le("/U <"+Qr.toHexString(Qr.U)+">"),le("/O <"+Qr.toHexString(Qr.O)+">"),le("/P "+Qr.P),le(">>"),le("endobj")},yn=function(){for(var w in le("/Font <<"),Wt)Wt.hasOwnProperty(w)&&(g===!1||g===!0&&p.hasOwnProperty(w))&&le("/"+w+" "+Wt[w].objectNumber+" 0 R");le(">>")},Qa=function(){if(Object.keys(Dt).length>0){for(var w in le("/Shading <<"),Dt)Dt.hasOwnProperty(w)&&Dt[w]instanceof ms&&Dt[w].objectNumber>=0&&le("/"+w+" "+Dt[w].objectNumber+" 0 R");Bt.publish("putShadingPatternDict"),le(">>")}},bn=function(w){if(Object.keys(Dt).length>0){for(var H in le("/Pattern <<"),Dt)Dt.hasOwnProperty(H)&&Dt[H]instanceof m.TilingPattern&&Dt[H].objectNumber>=0&&Dt[H].objectNumber<w&&le("/"+H+" "+Dt[H].objectNumber+" 0 R");Bt.publish("putTilingPatternDict"),le(">>")}},ka=function(){if(Object.keys(ir).length>0){var w;for(w in le("/ExtGState <<"),ir)ir.hasOwnProperty(w)&&ir[w].objectNumber>=0&&le("/"+w+" "+ir[w].objectNumber+" 0 R");Bt.publish("putGStateDict"),le(">>")}},vr=function(w){q(w.resourcesOid,!0),le("<<"),le("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),yn(),Qa(),bn(w.objectOid),ka(),Za(),le(">>"),le("endobj")},$o=function(){var w=[];Ge(),Sr(),ot(),zt(w),Bt.publish("putResources"),w.forEach(vr),vr({resourcesOid:te,objectOid:Number.MAX_SAFE_INTEGER}),Bt.publish("postPutResources")},Yo=function(){Bt.publish("putAdditionalObjects");for(var w=0;w<ve.length;w++){var H=ve[w];q(H.objId,!0),le(H.content),le("endobj")}Bt.publish("postPutAdditionalObjects")},Ko=function(w){ar[w.fontName]=ar[w.fontName]||{},ar[w.fontName][w.fontStyle]=w.id},Hi=function(w,H,ce,ue,Ne){var Pe={id:"F"+(Object.keys(Wt).length+1).toString(10),postScriptName:w,fontName:H,fontStyle:ce,encoding:ue,isStandardFont:Ne||!1,metadata:{}};return Bt.publish("addFont",{font:Pe,instance:this}),Wt[Pe.id]=Pe,Ko(Pe),Pe.id},kc=function(w){for(var H=0,ce=qe.length;H<ce;H++){var ue=Hi.call(this,w[H][0],w[H][1],w[H][2],qe[H][3],!0);g===!1&&(p[ue]=!0);var Ne=w[H][0].split("-");Ko({id:ue,fontName:Ne[0],fontStyle:Ne[1]||""})}Bt.publish("addFonts",{fonts:Wt,dictionary:ar})},en=function(w){return w.foo=function(){try{return w.apply(this,arguments)}catch(ue){var H=ue.stack||"";~H.indexOf(" at ")&&(H=H.split(" at ")[1]);var ce="Error in function "+H.split(`
`)[0].split("<")[0]+": "+ue.message;if(!yt.console)throw new Error(ce);yt.console.error(ce,ue),yt.alert&&alert(ce)}},w.foo.bar=w,w.foo},Zs=function(w,H){var ce,ue,Ne,Pe,Ve,lt,ut,At,St;if(Ne=(H=H||{}).sourceEncoding||"Unicode",Ve=H.outputEncoding,(H.autoencode||Ve)&&Wt[Ct].metadata&&Wt[Ct].metadata[Ne]&&Wt[Ct].metadata[Ne].encoding&&(Pe=Wt[Ct].metadata[Ne].encoding,!Ve&&Wt[Ct].encoding&&(Ve=Wt[Ct].encoding),!Ve&&Pe.codePages&&(Ve=Pe.codePages[0]),typeof Ve=="string"&&(Ve=Pe[Ve]),Ve)){for(ut=!1,lt=[],ce=0,ue=w.length;ce<ue;ce++)(At=Ve[w.charCodeAt(ce)])?lt.push(String.fromCharCode(At)):lt.push(w[ce]),lt[ce].charCodeAt(0)>>8&&(ut=!0);w=lt.join("")}for(ce=w.length;ut===void 0&&ce!==0;)w.charCodeAt(ce-1)>>8&&(ut=!0),ce--;if(!ut)return w;for(lt=H.noBOM?[]:[254,255],ce=0,ue=w.length;ce<ue;ce++){if((St=(At=w.charCodeAt(ce))>>8)>>8)throw new Error("Character at position "+ce+" of string '"+w+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");lt.push(St),lt.push(At-(St<<8))}return String.fromCharCode.apply(void 0,lt)},pa=m.__private__.pdfEscape=m.pdfEscape=function(w,H){return Zs(w,H).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Wi=m.__private__.beginPage=function(w){Ce[++Qt]=[],Nt[Qt]={objId:0,contentsObjId:0,userUnit:Number(c),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(w[0]),topRightY:Number(w[1])}},Jo(Qt),Ee(Ce[I])},Xo=function(w,H){var ce,ue,Ne;switch(t=H||t,typeof w=="string"&&(ce=b(w.toLowerCase()),Array.isArray(ce)&&(ue=ce[0],Ne=ce[1])),Array.isArray(w)&&(ue=w[0]*st,Ne=w[1]*st),isNaN(ue)&&(ue=s[0],Ne=s[1]),(ue>14400||Ne>14400)&&(tr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),ue=Math.min(14400,ue),Ne=Math.min(14400,Ne)),s=[ue,Ne],t.substr(0,1)){case"l":Ne>ue&&(s=[Ne,ue]);break;case"p":ue>Ne&&(s=[Ne,ue])}Wi(s),al(Gi),le(tn),Yi!==0&&le(Yi+" J"),Ki!==0&&le(Ki+" j"),Bt.publish("addPage",{pageNumber:Qt})},Tc=function(w){w>0&&w<=Qt&&(Ce.splice(w,1),Nt.splice(w,1),Qt--,I>Qt&&(I=Qt),this.setPage(I))},Jo=function(w){w>0&&w<=Qt&&(I=w)},Cc=m.__private__.getNumberOfPages=m.getNumberOfPages=function(){return Ce.length-1},Zo=function(w,H,ce){var ue,Ne=void 0;return ce=ce||{},w=w!==void 0?w:Wt[Ct].fontName,H=H!==void 0?H:Wt[Ct].fontStyle,ue=w.toLowerCase(),ar[ue]!==void 0&&ar[ue][H]!==void 0?Ne=ar[ue][H]:ar[w]!==void 0&&ar[w][H]!==void 0?Ne=ar[w][H]:ce.disableWarning===!1&&tr.warn("Unable to look up font label for font '"+w+"', '"+H+"'. Refer to getFontList() for available fonts."),Ne||ce.noFallback||(Ne=ar.times[H])==null&&(Ne=ar.times.normal),Ne},Ec=m.__private__.putInfo=function(){var w=gr(),H=function(ue){return ue};for(var ce in u!==null&&(H=Qr.encryptor(w,0)),le("<<"),le("/Producer ("+pa(H("jsPDF "+pt.version))+")"),vt)vt.hasOwnProperty(ce)&&vt[ce]&&le("/"+ce.substr(0,1).toUpperCase()+ce.substr(1)+" ("+pa(H(vt[ce]))+")");le("/CreationDate ("+pa(H(de))+")"),le(">>"),le("endobj")},zi=m.__private__.putCatalog=function(w){var H=(w=w||{}).rootDictionaryObjId||Q;switch(gr(),le("<<"),le("/Type /Catalog"),le("/Pages "+H+" 0 R"),tt||(tt="fullwidth"),tt){case"fullwidth":le("/OpenAction [3 0 R /FitH null]");break;case"fullheight":le("/OpenAction [3 0 R /FitV null]");break;case"fullpage":le("/OpenAction [3 0 R /Fit]");break;case"original":le("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ce=""+tt;ce.substr(ce.length-1)==="%"&&(tt=parseInt(tt)/100),typeof tt=="number"&&le("/OpenAction [3 0 R /XYZ null null "+D(tt)+"]")}switch(kt||(kt="continuous"),kt){case"continuous":le("/PageLayout /OneColumn");break;case"single":le("/PageLayout /SinglePage");break;case"two":case"twoleft":le("/PageLayout /TwoColumnLeft");break;case"tworight":le("/PageLayout /TwoColumnRight")}ft&&le("/PageMode /"+ft),Bt.publish("putCatalog"),le(">>"),le("endobj")},Lc=m.__private__.putTrailer=function(){le("trailer"),le("<<"),le("/Size "+(K+1)),le("/Root "+K+" 0 R"),le("/Info "+(K-1)+" 0 R"),u!==null&&le("/Encrypt "+Qr.oid+" 0 R"),le("/ID [ <"+J+"> <"+J+"> ]"),le(">>")},Fc=m.__private__.putHeader=function(){le("%PDF-"+j),le("%ÂºÃŸÂ¬Ã ")},Pc=m.__private__.putXRef=function(){var w="0000000000";le("xref"),le("0 "+(K+1)),le("0000000000 65535 f ");for(var H=1;H<=K;H++)typeof he[H]=="function"?le((w+he[H]()).slice(-10)+" 00000 n "):he[H]!==void 0?le((w+he[H]).slice(-10)+" 00000 n "):le("0000000000 00000 n ")},On=m.__private__.buildDocument=function(){Ke(),Ee(fe),Bt.publish("buildDocument"),Fc(),ke(),Yo(),$o(),u!==null&&Pn(),Ec(),zi();var w=ee;return Pc(),Lc(),le("startxref"),le(""+w),le("%%EOF"),Ee(Ce[I]),fe.join(`
`)},Qs=m.__private__.getBlob=function(w){return new Blob([et(w)],{type:"application/pdf"})},ei=m.output=m.__private__.output=en(function(w,H){switch(typeof(H=H||{})=="string"?H={filename:H}:H.filename=H.filename||"generated.pdf",w){case void 0:return On();case"save":m.save(H.filename);break;case"arraybuffer":return et(On());case"blob":return Qs(On());case"bloburi":case"bloburl":if(yt.URL!==void 0&&typeof yt.URL.createObjectURL=="function")return yt.URL&&yt.URL.createObjectURL(Qs(On()))||void 0;tr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ce="",ue=On();try{ce=H0(ue)}catch{ce=H0(unescape(encodeURIComponent(ue)))}return"data:application/pdf;filename="+H.filename+";base64,"+ce;case"pdfobjectnewwindow":if(Object.prototype.toString.call(yt)==="[object Window]"){var Ne="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Pe=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';H.pdfObjectUrl&&(Ne=H.pdfObjectUrl,Pe="");var Ve='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ne+'"'+Pe+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(H)+");<\/script></body></html>",lt=yt.open();return lt!==null&&lt.document.write(Ve),lt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(yt)==="[object Window]"){var ut='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(H.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+H.filename+'" width="500px" height="400px" /></body></html>',At=yt.open();if(At!==null){At.document.write(ut);var St=this;At.document.documentElement.querySelector("#pdfViewer").onload=function(){At.document.title=H.filename,At.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(St.output("bloburl"))}}return At}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(yt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var It='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",H)+'"></iframe></body></html>',cr=yt.open();if(cr!==null&&(cr.document.write(It),cr.document.title=H.filename),cr||typeof safari>"u")return cr;break;case"datauri":case"dataurl":return yt.document.location.href=this.output("datauristring",H);default:return null}}),Qo=function(w){return Array.isArray(Fn)===!0&&Fn.indexOf(w)>-1};switch(n){case"pt":st=1;break;case"mm":st=72/25.4;break;case"cm":st=72/2.54;break;case"in":st=72;break;case"px":st=Qo("px_scaling")==1?.75:96/72;break;case"pc":case"em":st=12;break;case"ex":st=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);st=n}var Qr=null;be(),oe();var Oc=function(w){return u!==null?Qr.encryptor(w,0):function(H){return H}},el=m.__private__.getPageInfo=m.getPageInfo=function(w){if(isNaN(w)||w%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Nt[w].objId,pageNumber:w,pageContext:Nt[w]}},jt=m.__private__.getPageInfoByObjId=function(w){if(isNaN(w)||w%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var H in Nt)if(Nt[H].objId===w)break;return el(H)},Ic=m.__private__.getCurrentPageInfo=m.getCurrentPageInfo=function(){return{objId:Nt[I].objId,pageNumber:I,pageContext:Nt[I]}};m.addPage=function(){return Xo.apply(this,arguments),this},m.setPage=function(){return Jo.apply(this,arguments),Ee.call(this,Ce[I]),this},m.insertPage=function(w){return this.addPage(),this.movePage(I,w),this},m.movePage=function(w,H){var ce,ue;if(w>H){ce=Ce[w],ue=Nt[w];for(var Ne=w;Ne>H;Ne--)Ce[Ne]=Ce[Ne-1],Nt[Ne]=Nt[Ne-1];Ce[H]=ce,Nt[H]=ue,this.setPage(H)}else if(w<H){ce=Ce[w],ue=Nt[w];for(var Pe=w;Pe<H;Pe++)Ce[Pe]=Ce[Pe+1],Nt[Pe]=Nt[Pe+1];Ce[H]=ce,Nt[H]=ue,this.setPage(H)}return this},m.deletePage=function(){return Tc.apply(this,arguments),this},m.__private__.text=m.text=function(w,H,ce,ue,Ne){var Pe,Ve,lt,ut,At,St,It,cr,hr,_r=(ue=ue||{}).scope||this;if(typeof w=="number"&&typeof H=="number"&&(typeof ce=="string"||Array.isArray(ce))){var ea=ce;ce=H,H=w,w=ea}if(arguments[3]instanceof mt?(E("The transform parameter of text() with a Matrix value"),hr=Ne):(lt=arguments[4],ut=arguments[5],rr(It=arguments[3])==="object"&&It!==null||(typeof lt=="string"&&(ut=lt,lt=null),typeof It=="string"&&(ut=It,It=null),typeof It=="number"&&(lt=It,It=null),ue={flags:It,angle:lt,align:ut})),isNaN(H)||isNaN(ce)||w==null)throw new Error("Invalid arguments passed to jsPDF.text");if(w.length===0)return _r;var Br="",rn=!1,Ta=typeof ue.lineHeightFactor=="number"?ue.lineHeightFactor:As,jn=_r.internal.scaleFactor;function cl(nr){return nr=nr.split("	").join(Array(ue.TabLen||9).join(" ")),pa(nr,It)}function eo(nr){for(var sr,br=nr.concat(),Or=[],Mn=br.length;Mn--;)typeof(sr=br.shift())=="string"?Or.push(sr):Array.isArray(nr)&&(sr.length===1||sr[1]===void 0&&sr[2]===void 0)?Or.push(sr[0]):Or.push([sr[0],sr[1],sr[2]]);return Or}function to(nr,sr){var br;if(typeof nr=="string")br=sr(nr)[0];else if(Array.isArray(nr)){for(var Or,Mn,co=nr.concat(),xi=[],ml=co.length;ml--;)typeof(Or=co.shift())=="string"?xi.push(sr(Or)[0]):Array.isArray(Or)&&typeof Or[0]=="string"&&(Mn=sr(Or[0],Or[1],Or[2]),xi.push([Mn[0],Mn[1],Mn[2]]));br=xi}return br}var ii=!1,ro=!0;if(typeof w=="string")ii=!0;else if(Array.isArray(w)){var ao=w.concat();Ve=[];for(var oi,qr=ao.length;qr--;)(typeof(oi=ao.shift())!="string"||Array.isArray(oi)&&typeof oi[0]!="string")&&(ro=!1);ii=ro}if(ii===!1)throw new Error('Type of text must be string or Array. "'+w+'" is not recognized.');typeof w=="string"&&(w=w.match(/[\r?\n]/)?w.split(/\r\n|\r|\n/g):[w]);var li=Xe/_r.internal.scaleFactor,ci=li*(Ta-1);switch(ue.baseline){case"bottom":ce-=ci;break;case"top":ce+=li-ci;break;case"hanging":ce+=li-2*ci;break;case"middle":ce+=li/2-ci}if((St=ue.maxWidth||0)>0&&(typeof w=="string"?w=_r.splitTextToSize(w,St):Object.prototype.toString.call(w)==="[object Array]"&&(w=w.reduce(function(nr,sr){return nr.concat(_r.splitTextToSize(sr,St))},[]))),Pe={text:w,x:H,y:ce,options:ue,mutex:{pdfEscape:pa,activeFontKey:Ct,fonts:Wt,activeFontSize:Xe}},Bt.publish("preProcessText",Pe),w=Pe.text,lt=(ue=Pe.options).angle,!(hr instanceof mt)&&lt&&typeof lt=="number"){lt*=Math.PI/180,ue.rotationDirection===0&&(lt=-lt),_===y.ADVANCED&&(lt=-lt);var di=Math.cos(lt),no=Math.sin(lt);hr=new mt(di,no,-no,di,0,0)}else lt&&lt instanceof mt&&(hr=lt);_!==y.ADVANCED||hr||(hr=xa),(At=ue.charSpace||ai)!==void 0&&(Br+=L(C(At))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(cr=ue.horizontalScale)!==void 0&&(Br+=L(100*cr)+` Tz
`),ue.lang;var ga=-1,Vc=ue.renderingMode!==void 0?ue.renderingMode:ue.stroke,so=_r.internal.getCurrentPageInfo().pageContext;switch(Vc){case 0:case!1:case"fill":ga=0;break;case 1:case!0:case"stroke":ga=1;break;case 2:case"fillThenStroke":ga=2;break;case 3:case"invisible":ga=3;break;case 4:case"fillAndAddForClipping":ga=4;break;case 5:case"strokeAndAddPathForClipping":ga=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":ga=6;break;case 7:case"addToPathForClipping":ga=7}var dl=so.usedRenderingMode!==void 0?so.usedRenderingMode:-1;ga!==-1?Br+=ga+` Tr
`:dl!==-1&&(Br+=`0 Tr
`),ga!==-1&&(so.usedRenderingMode=ga),ut=ue.align||"left";var Ha,hi=Xe*Ta,hl=_r.internal.pageSize.getWidth(),fl=Wt[Ct];At=ue.charSpace||ai,St=ue.maxWidth||0,It=Object.assign({autoencode:!0,noBOM:!0},ue.flags);var Qn=[],Cs=function(nr){return _r.getStringUnitWidth(nr,{font:fl,charSpace:At,fontSize:Xe,doKerning:!1})*Xe/jn};if(Object.prototype.toString.call(w)==="[object Array]"){var va;Ve=eo(w),ut!=="left"&&(Ha=Ve.map(Cs));var la,es=0;if(ut==="right"){H-=Ha[0],w=[],qr=Ve.length;for(var Dn=0;Dn<qr;Dn++)Dn===0?(la=Nn(H),va=In(ce)):(la=C(es-Ha[Dn]),va=-hi),w.push([Ve[Dn],la,va]),es=Ha[Dn]}else if(ut==="center"){H-=Ha[0]/2,w=[],qr=Ve.length;for(var Rn=0;Rn<qr;Rn++)Rn===0?(la=Nn(H),va=In(ce)):(la=C((es-Ha[Rn])/2),va=-hi),w.push([Ve[Rn],la,va]),es=Ha[Rn]}else if(ut==="left"){w=[],qr=Ve.length;for(var fi=0;fi<qr;fi++)w.push(Ve[fi])}else if(ut==="justify"&&fl.encoding==="Identity-H"){w=[],qr=Ve.length,St=St!==0?St:hl;for(var Bn=0,yr=0;yr<qr;yr++)if(va=yr===0?In(ce):-hi,la=yr===0?Nn(H):Bn,yr<qr-1){var io=C((St-Ha[yr])/(Ve[yr].split(" ").length-1)),ca=Ve[yr].split(" ");w.push([ca[0]+" ",la,va]),Bn=0;for(var Wa=1;Wa<ca.length;Wa++){var ui=(Cs(ca[Wa-1]+" "+ca[Wa])-Cs(ca[Wa]))*jn+io;Wa==ca.length-1?w.push([ca[Wa],ui,0]):w.push([ca[Wa]+" ",ui,0]),Bn-=ui}}else w.push([Ve[yr],la,va]);w.push(["",Bn,0])}else{if(ut!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(w=[],qr=Ve.length,St=St!==0?St:hl,yr=0;yr<qr;yr++)va=yr===0?In(ce):-hi,la=yr===0?Nn(H):0,yr<qr-1?Qn.push(L(C((St-Ha[yr])/(Ve[yr].split(" ").length-1)))):Qn.push(0),w.push([Ve[yr],la,va])}}var ul=typeof ue.R2L=="boolean"?ue.R2L:ht;ul===!0&&(w=to(w,function(nr,sr,br){return[nr.split("").reverse().join(""),sr,br]})),Pe={text:w,x:H,y:ce,options:ue,mutex:{pdfEscape:pa,activeFontKey:Ct,fonts:Wt,activeFontSize:Xe}},Bt.publish("postProcessText",Pe),w=Pe.text,rn=Pe.mutex.isHex||!1;var oo=Wt[Ct].encoding;oo!=="WinAnsiEncoding"&&oo!=="StandardEncoding"||(w=to(w,function(nr,sr,br){return[cl(nr),sr,br]})),Ve=eo(w),w=[];for(var Es,Ls,ts,Fs=0,mi=1,Ps=Array.isArray(Ve[0])?mi:Fs,rs="",lo=function(nr,sr,br){var Or="";return br instanceof mt?(br=typeof ue.angle=="number"?Aa(br,new mt(1,0,0,1,nr,sr)):Aa(new mt(1,0,0,1,nr,sr),br),_===y.ADVANCED&&(br=Aa(new mt(1,0,0,-1,0,0),br)),Or=br.join(" ")+` Tm
`):Or=L(nr)+" "+L(sr)+` Td
`,Or},za=0;za<Ve.length;za++){switch(rs="",Ps){case mi:ts=(rn?"<":"(")+Ve[za][0]+(rn?">":")"),Es=parseFloat(Ve[za][1]),Ls=parseFloat(Ve[za][2]);break;case Fs:ts=(rn?"<":"(")+Ve[za]+(rn?">":")"),Es=Nn(H),Ls=In(ce)}Qn!==void 0&&Qn[za]!==void 0&&(rs=Qn[za]+` Tw
`),za===0?w.push(rs+lo(Es,Ls,hr)+ts):Ps===Fs?w.push(rs+ts):Ps===mi&&w.push(rs+lo(Es,Ls,hr)+ts)}w=Ps===Fs?w.join(` Tj
T* `):w.join(` Tj
`),w+=` Tj
`;var qa=`BT
/`;return qa+=Ct+" "+Xe+` Tf
`,qa+=L(Xe*Ta)+` TL
`,qa+=ks+`
`,qa+=Br,qa+=w,le(qa+="ET"),p[Ct]=!0,_r};var Dc=m.__private__.clip=m.clip=function(w){return le(w==="evenodd"?"W*":"W"),this};m.clipEvenOdd=function(){return Dc("evenodd")},m.__private__.discardPath=m.discardPath=function(){return le("n"),this};var wn=m.__private__.isValidStyle=function(w){var H=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(w)!==-1&&(H=!0),H};m.__private__.setDefaultPathOperation=m.setDefaultPathOperation=function(w){return wn(w)&&(f=w),this};var tl=m.__private__.getStyle=m.getStyle=function(w){var H=f;switch(w){case"D":case"S":H="S";break;case"F":H="f";break;case"FD":case"DF":H="B";break;case"f":case"f*":case"B":case"B*":H=w}return H},rl=m.close=function(){return le("h"),this};m.stroke=function(){return le("S"),this},m.fill=function(w){return ti("f",w),this},m.fillEvenOdd=function(w){return ti("f*",w),this},m.fillStroke=function(w){return ti("B",w),this},m.fillStrokeEvenOdd=function(w){return ti("B*",w),this};var ti=function(w,H){rr(H)==="object"?Bc(H,w):le(w)},qi=function(w){w===null||_===y.ADVANCED&&w===void 0||(w=tl(w),le(w))};function Rc(w,H,ce,ue,Ne){var Pe=new Rs(H||this.boundingBox,ce||this.xStep,ue||this.yStep,this.gState,Ne||this.matrix);Pe.stream=this.stream;var Ve=w+"$$"+this.cloneIndex+++"$$";return Zr(Ve,Pe),Pe}var Bc=function(w,H){var ce=vn[w.key],ue=Dt[ce];if(ue instanceof ms)le("q"),le(Mc(H)),ue.gState&&m.setGState(ue.gState),le(w.matrix.toString()+" cm"),le("/"+ce+" sh"),le("Q");else if(ue instanceof Rs){var Ne=new mt(1,0,0,-1,0,Zn());w.matrix&&(Ne=Ne.multiply(w.matrix||xa),ce=Rc.call(ue,w.key,w.boundingBox,w.xStep,w.yStep,Ne).id),le("q"),le("/Pattern cs"),le("/"+ce+" scn"),ue.gState&&m.setGState(ue.gState),le(H),le("Q")}},Mc=function(w){switch(w){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Vi=m.moveTo=function(w,H){return le(L(C(w))+" "+L(G(H))+" m"),this},_s=m.lineTo=function(w,H){return le(L(C(w))+" "+L(G(H))+" l"),this},Xn=m.curveTo=function(w,H,ce,ue,Ne,Pe){return le([L(C(w)),L(G(H)),L(C(ce)),L(G(ue)),L(C(Ne)),L(G(Pe)),"c"].join(" ")),this};m.__private__.line=m.line=function(w,H,ce,ue,Ne){if(isNaN(w)||isNaN(H)||isNaN(ce)||isNaN(ue)||!wn(Ne))throw new Error("Invalid arguments passed to jsPDF.line");return _===y.COMPAT?this.lines([[ce-w,ue-H]],w,H,[1,1],Ne||"S"):this.lines([[ce-w,ue-H]],w,H,[1,1]).stroke()},m.__private__.lines=m.lines=function(w,H,ce,ue,Ne,Pe){var Ve,lt,ut,At,St,It,cr,hr,_r,ea,Br,rn;if(typeof w=="number"&&(rn=ce,ce=H,H=w,w=rn),ue=ue||[1,1],Pe=Pe||!1,isNaN(H)||isNaN(ce)||!Array.isArray(w)||!Array.isArray(ue)||!wn(Ne)||typeof Pe!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Vi(H,ce),Ve=ue[0],lt=ue[1],At=w.length,ea=H,Br=ce,ut=0;ut<At;ut++)(St=w[ut]).length===2?(ea=St[0]*Ve+ea,Br=St[1]*lt+Br,_s(ea,Br)):(It=St[0]*Ve+ea,cr=St[1]*lt+Br,hr=St[2]*Ve+ea,_r=St[3]*lt+Br,ea=St[4]*Ve+ea,Br=St[5]*lt+Br,Xn(It,cr,hr,_r,ea,Br));return Pe&&rl(),qi(Ne),this},m.path=function(w){for(var H=0;H<w.length;H++){var ce=w[H],ue=ce.c;switch(ce.op){case"m":Vi(ue[0],ue[1]);break;case"l":_s(ue[0],ue[1]);break;case"c":Xn.apply(this,ue);break;case"h":rl()}}return this},m.__private__.rect=m.rect=function(w,H,ce,ue,Ne){if(isNaN(w)||isNaN(H)||isNaN(ce)||isNaN(ue)||!wn(Ne))throw new Error("Invalid arguments passed to jsPDF.rect");return _===y.COMPAT&&(ue=-ue),le([L(C(w)),L(G(H)),L(C(ce)),L(C(ue)),"re"].join(" ")),qi(Ne),this},m.__private__.triangle=m.triangle=function(w,H,ce,ue,Ne,Pe,Ve){if(isNaN(w)||isNaN(H)||isNaN(ce)||isNaN(ue)||isNaN(Ne)||isNaN(Pe)||!wn(Ve))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ce-w,ue-H],[Ne-ce,Pe-ue],[w-Ne,H-Pe]],w,H,[1,1],Ve,!0),this},m.__private__.roundedRect=m.roundedRect=function(w,H,ce,ue,Ne,Pe,Ve){if(isNaN(w)||isNaN(H)||isNaN(ce)||isNaN(ue)||isNaN(Ne)||isNaN(Pe)||!wn(Ve))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var lt=4/3*(Math.SQRT2-1);return Ne=Math.min(Ne,.5*ce),Pe=Math.min(Pe,.5*ue),this.lines([[ce-2*Ne,0],[Ne*lt,0,Ne,Pe-Pe*lt,Ne,Pe],[0,ue-2*Pe],[0,Pe*lt,-Ne*lt,Pe,-Ne,Pe],[2*Ne-ce,0],[-Ne*lt,0,-Ne,-Pe*lt,-Ne,-Pe],[0,2*Pe-ue],[0,-Pe*lt,Ne*lt,-Pe,Ne,-Pe]],w+Ne,H,[1,1],Ve,!0),this},m.__private__.ellipse=m.ellipse=function(w,H,ce,ue,Ne){if(isNaN(w)||isNaN(H)||isNaN(ce)||isNaN(ue)||!wn(Ne))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Pe=4/3*(Math.SQRT2-1)*ce,Ve=4/3*(Math.SQRT2-1)*ue;return Vi(w+ce,H),Xn(w+ce,H-Ve,w+Pe,H-ue,w,H-ue),Xn(w-Pe,H-ue,w-ce,H-Ve,w-ce,H),Xn(w-ce,H+Ve,w-Pe,H+ue,w,H+ue),Xn(w+Pe,H+ue,w+ce,H+Ve,w+ce,H),qi(Ne),this},m.__private__.circle=m.circle=function(w,H,ce,ue){if(isNaN(w)||isNaN(H)||isNaN(ce)||!wn(ue))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(w,H,ce,ce,ue)},m.setFont=function(w,H,ce){return ce&&(H=B(H,ce)),Ct=Zo(w,H,{disableWarning:!1}),this};var Uc=m.__private__.getFont=m.getFont=function(){return Wt[Zo.apply(m,arguments)]};m.__private__.getFontList=m.getFontList=function(){var w,H,ce={};for(w in ar)if(ar.hasOwnProperty(w))for(H in ce[w]=[],ar[w])ar[w].hasOwnProperty(H)&&ce[w].push(H);return ce},m.addFont=function(w,H,ce,ue,Ne){var Pe=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Pe.indexOf(arguments[3])!==-1?Ne=arguments[3]:arguments[3]&&Pe.indexOf(arguments[3])==-1&&(ce=B(ce,ue)),Ne=Ne||"Identity-H",Hi.call(this,w,H,ce,Ne)};var As,Gi=e.lineWidth||.200025,ri=m.__private__.getLineWidth=m.getLineWidth=function(){return Gi},al=m.__private__.setLineWidth=m.setLineWidth=function(w){return Gi=w,le(L(C(w))+" w"),this};m.__private__.setLineDash=pt.API.setLineDash=pt.API.setLineDashPattern=function(w,H){if(w=w||[],H=H||0,isNaN(H)||!Array.isArray(w))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return w=w.map(function(ce){return L(C(ce))}).join(" "),H=L(C(H)),le("["+w+"] "+H+" d"),this};var nl=m.__private__.getLineHeight=m.getLineHeight=function(){return Xe*As};m.__private__.getLineHeight=m.getLineHeight=function(){return Xe*As};var sl=m.__private__.setLineHeightFactor=m.setLineHeightFactor=function(w){return typeof(w=w||1.15)=="number"&&(As=w),this},il=m.__private__.getLineHeightFactor=m.getLineHeightFactor=function(){return As};sl(e.lineHeight);var Nn=m.__private__.getHorizontalCoordinate=function(w){return C(w)},In=m.__private__.getVerticalCoordinate=function(w){return _===y.ADVANCED?w:Nt[I].mediaBox.topRightY-Nt[I].mediaBox.bottomLeftY-C(w)},Hc=m.__private__.getHorizontalCoordinateString=m.getHorizontalCoordinateString=function(w){return L(Nn(w))},Jn=m.__private__.getVerticalCoordinateString=m.getVerticalCoordinateString=function(w){return L(In(w))},tn=e.strokeColor||"0 G";m.__private__.getStrokeColor=m.getDrawColor=function(){return ae(tn)},m.__private__.setStrokeColor=m.setDrawColor=function(w,H,ce,ue){return tn=ie({ch1:w,ch2:H,ch3:ce,ch4:ue,pdfColorType:"draw",precision:2}),le(tn),this};var $i=e.fillColor||"0 g";m.__private__.getFillColor=m.getFillColor=function(){return ae($i)},m.__private__.setFillColor=m.setFillColor=function(w,H,ce,ue){return $i=ie({ch1:w,ch2:H,ch3:ce,ch4:ue,pdfColorType:"fill",precision:2}),le($i),this};var ks=e.textColor||"0 g",Wc=m.__private__.getTextColor=m.getTextColor=function(){return ae(ks)};m.__private__.setTextColor=m.setTextColor=function(w,H,ce,ue){return ks=ie({ch1:w,ch2:H,ch3:ce,ch4:ue,pdfColorType:"text",precision:3}),this};var ai=e.charSpace,zc=m.__private__.getCharSpace=m.getCharSpace=function(){return parseFloat(ai||0)};m.__private__.setCharSpace=m.setCharSpace=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return ai=w,this};var Yi=0;m.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},m.__private__.setLineCap=m.setLineCap=function(w){var H=m.CapJoinStyles[w];if(H===void 0)throw new Error("Line cap style of '"+w+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Yi=H,le(H+" J"),this};var Ki=0;m.__private__.setLineJoin=m.setLineJoin=function(w){var H=m.CapJoinStyles[w];if(H===void 0)throw new Error("Line join style of '"+w+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ki=H,le(H+" j"),this},m.__private__.setLineMiterLimit=m.__private__.setMiterLimit=m.setLineMiterLimit=m.setMiterLimit=function(w){if(w=w||0,isNaN(w))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return le(L(C(w))+" M"),this},m.GState=Po,m.setGState=function(w){(w=typeof w=="string"?ir[_a[w]]:ol(null,w)).equals(Ja)||(le("/"+w.id+" gs"),Ja=w)};var ol=function(w,H){if(!w||!_a[w]){var ce=!1;for(var ue in ir)if(ir.hasOwnProperty(ue)&&ir[ue].equals(H)){ce=!0;break}if(ce)H=ir[ue];else{var Ne="GS"+(Object.keys(ir).length+1).toString(10);ir[Ne]=H,H.id=Ne}return w&&(_a[w]=H.id),Bt.publish("addGState",H),H}};m.addGState=function(w,H){return ol(w,H),this},m.saveGraphicsState=function(){return le("q"),Ba.push({key:Ct,size:Xe,color:ks}),this},m.restoreGraphicsState=function(){le("Q");var w=Ba.pop();return Ct=w.key,Xe=w.size,ks=w.color,Ja=null,this},m.setCurrentTransformationMatrix=function(w){return le(w.toString()+" cm"),this},m.comment=function(w){return le("#"+w),this};var ni=function(w,H){var ce=w||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ce},set:function(Pe){isNaN(Pe)||(ce=parseFloat(Pe))}});var ue=H||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return ue},set:function(Pe){isNaN(Pe)||(ue=parseFloat(Pe))}});var Ne="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ne},set:function(Pe){Ne=Pe.toString()}}),this},Xi=function(w,H,ce,ue){ni.call(this,w,H),this.type="rect";var Ne=ce||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ne},set:function(Ve){isNaN(Ve)||(Ne=parseFloat(Ve))}});var Pe=ue||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Pe},set:function(Ve){isNaN(Ve)||(Pe=parseFloat(Ve))}}),this},Ji=function(){this.page=Qt,this.currentPage=I,this.pages=Ce.slice(0),this.pagesContext=Nt.slice(0),this.x=Fr,this.y=Ot,this.matrix=ma,this.width=Ts(I),this.height=Zn(I),this.outputDestination=$e,this.id="",this.objectNumber=-1};Ji.prototype.restore=function(){Qt=this.page,I=this.currentPage,Nt=this.pagesContext,Ce=this.pages,Fr=this.x,Ot=this.y,ma=this.matrix,Zi(I,this.width),Qi(I,this.height),$e=this.outputDestination};var ll=function(w,H,ce,ue,Ne){Ua.push(new Ji),Qt=I=0,Ce=[],Fr=w,Ot=H,ma=Ne,Wi([ce,ue])},qc=function(w){if(Ma[w])Ua.pop().restore();else{var H=new Ji,ce="Xo"+(Object.keys(Pr).length+1).toString(10);H.id=ce,Ma[w]=ce,Pr[ce]=H,Bt.publish("addFormObject",H),Ua.pop().restore()}};for(var si in m.beginFormObject=function(w,H,ce,ue,Ne){return ll(w,H,ce,ue,Ne),this},m.endFormObject=function(w){return qc(w),this},m.doFormObject=function(w,H){var ce=Pr[Ma[w]];return le("q"),le(H.toString()+" cm"),le("/"+ce.id+" Do"),le("Q"),this},m.getFormObject=function(w){var H=Pr[Ma[w]];return{x:H.x,y:H.y,width:H.width,height:H.height,matrix:H.matrix}},m.save=function(w,H){return w=w||"generated.pdf",(H=H||{}).returnPromise=H.returnPromise||!1,H.returnPromise===!1?(Is(Qs(On()),w),typeof Is.unload=="function"&&yt.setTimeout&&setTimeout(Is.unload,911),this):new Promise(function(ce,ue){try{var Ne=Is(Qs(On()),w);typeof Is.unload=="function"&&yt.setTimeout&&setTimeout(Is.unload,911),ce(Ne)}catch(Pe){ue(Pe.message)}})},pt.API)pt.API.hasOwnProperty(si)&&(si==="events"&&pt.API.events.length?function(w,H){var ce,ue,Ne;for(Ne=H.length-1;Ne!==-1;Ne--)ce=H[Ne][0],ue=H[Ne][1],w.subscribe.apply(w,[ce].concat(typeof ue=="function"?[ue]:ue))}(Bt,pt.API.events):m[si]=pt.API[si]);var Ts=m.getPageWidth=function(w){return(Nt[w=w||I].mediaBox.topRightX-Nt[w].mediaBox.bottomLeftX)/st},Zi=m.setPageWidth=function(w,H){Nt[w].mediaBox.topRightX=H*st+Nt[w].mediaBox.bottomLeftX},Zn=m.getPageHeight=function(w){return(Nt[w=w||I].mediaBox.topRightY-Nt[w].mediaBox.bottomLeftY)/st},Qi=m.setPageHeight=function(w,H){Nt[w].mediaBox.topRightY=H*st+Nt[w].mediaBox.bottomLeftY};return m.internal={pdfEscape:pa,getStyle:tl,getFont:Uc,getFontSize:at,getCharSpace:zc,getTextColor:Wc,getLineHeight:nl,getLineHeightFactor:il,getLineWidth:ri,write:He,getHorizontalCoordinate:Nn,getVerticalCoordinate:In,getCoordinateString:Hc,getVerticalCoordinateString:Jn,collections:{},newObject:gr,newAdditionalObject:se,newObjectDeferred:dr,newObjectDeferredBegin:q,getFilters:Se,putStream:Le,events:Bt,scaleFactor:st,pageSize:{getWidth:function(){return Ts(I)},setWidth:function(w){Zi(I,w)},getHeight:function(){return Zn(I)},setHeight:function(w){Qi(I,w)}},encryptionOptions:u,encryption:Qr,getEncryptor:Oc,output:ei,getNumberOfPages:Cc,pages:Ce,out:le,f2:D,f3:k,getPageInfo:el,getPageInfoByObjId:jt,getCurrentPageInfo:Ic,getPDFVersion:v,Point:ni,Rectangle:Xi,Matrix:mt,hasHotfix:Qo},Object.defineProperty(m.internal.pageSize,"width",{get:function(){return Ts(I)},set:function(w){Zi(I,w)},enumerable:!0,configurable:!0}),Object.defineProperty(m.internal.pageSize,"height",{get:function(){return Zn(I)},set:function(w){Qi(I,w)},enumerable:!0,configurable:!0}),kc.call(m,qe),Ct="F1",Xo(s,t),Bt.publish("initialized"),m}ki.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},ki.prototype.toHexString=function(e){return e.split("").map(function(r){return("0"+(255&r.charCodeAt(0)).toString(16)).slice(-2)}).join("")},ki.prototype.hexToBytes=function(e){for(var r=[],t=0;t<e.length;t+=2)r.push(String.fromCharCode(parseInt(e.substr(t,2),16)));return r.join("")},ki.prototype.processOwnerPassword=function(e,r){return z0(W0(r).substr(0,5),e)},ki.prototype.encryptor=function(e,r){var t=W0(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&r,r>>8&255)).substr(0,10);return function(n){return z0(t,n)}},Po.prototype.equals=function(e){var r,t="id,objectNumber,equals";if(!e||rr(e)!==rr(this))return!1;var n=0;for(r in this)if(!(t.indexOf(r)>=0)){if(this.hasOwnProperty(r)&&!e.hasOwnProperty(r)||this[r]!==e[r])return!1;n++}for(r in e)e.hasOwnProperty(r)&&t.indexOf(r)<0&&n--;return n===0},pt.API={events:[]},pt.version="2.5.2";var ur=pt.API,td=1,Gs=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},bi=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},_t=function(e){return e.toFixed(2)},hs=function(e){return e.toFixed(5)};ur.__acroform__={};var Sa=function(e,r){e.prototype=Object.create(r.prototype),e.prototype.constructor=e},xh=function(e){return e*td},_n=function(e){var r=new Of,t=dt.internal.getHeight(e)||0,n=dt.internal.getWidth(e)||0;return r.BBox=[0,0,Number(_t(n)),Number(_t(t))],r},hp=ur.__acroform__.setBit=function(e,r){if(e=e||0,r=r||0,isNaN(e)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<r},fp=ur.__acroform__.clearBit=function(e,r){if(e=e||0,r=r||0,isNaN(e)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<r)},up=ur.__acroform__.getBit=function(e,r){if(isNaN(e)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<r?1:0},wr=ur.__acroform__.getBitForPdf=function(e,r){if(isNaN(e)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return up(e,r-1)},Nr=ur.__acroform__.setBitForPdf=function(e,r){if(isNaN(e)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return hp(e,r-1)},jr=ur.__acroform__.clearBitForPdf=function(e,r){if(isNaN(e)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return fp(e,r-1)},mp=ur.__acroform__.calculateCoordinates=function(e,r){var t=r.internal.getHorizontalCoordinate,n=r.internal.getVerticalCoordinate,s=e[0],o=e[1],l=e[2],c=e[3],d={};return d.lowerLeft_X=t(s)||0,d.lowerLeft_Y=n(o+c)||0,d.upperRight_X=t(s+l)||0,d.upperRight_Y=n(o)||0,[Number(_t(d.lowerLeft_X)),Number(_t(d.lowerLeft_Y)),Number(_t(d.upperRight_X)),Number(_t(d.upperRight_Y))]},xp=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var r=[],t=e._V||e.DV,n=q0(e,t),s=e.scope.internal.getFont(e.fontName,e.fontStyle).id;r.push("/Tx BMC"),r.push("q"),r.push("BT"),r.push(e.scope.__private__.encodeColorString(e.color)),r.push("/"+s+" "+_t(n.fontSize)+" Tf"),r.push("1 0 0 1 0 0 Tm"),r.push(n.text),r.push("ET"),r.push("Q"),r.push("EMC");var o=_n(e);return o.scope=e.scope,o.stream=r.join(`
`),o}},q0=function(e,r){var t=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},s=(r=(r=r.substr(0,1)=="("?r.substr(1):r).substr(r.length-1)==")"?r.substr(0,r.length-1):r).split(" ");s=e.multiline?s.map(function(k){return k.split(`
`)}):s.map(function(k){return[k]});var o=t,l=dt.internal.getHeight(e)||0;l=l<0?-l:l;var c=dt.internal.getWidth(e)||0;c=c<0?-c:c;var d=function(k,C,z){if(k+1<s.length){var G=C+" "+s[k+1][0];return Ul(G,e,z).width<=c-4}return!1};o++;e:for(;o>0;){r="",o--;var f,u,g=Ul("3",e,o).height,p=e.multiline?l-o:(l-g)/2,m=p+=2,j=0,v=0,N=0;if(o<=0){r=`(...) Tj
`,r+="% Width of Text: "+Ul(r,e,o=12).width+", FieldWidth:"+c+`
`;break}for(var b="",y=0,_=0;_<s.length;_++)if(s.hasOwnProperty(_)){var T=!1;if(s[_].length!==1&&N!==s[_].length-1){if((g+2)*(y+2)+2>l)continue e;b+=s[_][N],T=!0,v=_,_--}else{b=(b+=s[_][N]+" ").substr(b.length-1)==" "?b.substr(0,b.length-1):b;var O=parseInt(_),B=d(O,b,o),L=_>=s.length-1;if(B&&!L){b+=" ",N=0;continue}if(B||L){if(L)v=O;else if(e.multiline&&(g+2)*(y+2)+2>l)continue e}else{if(!e.multiline||(g+2)*(y+2)+2>l)continue e;v=O}}for(var E="",P=j;P<=v;P++){var D=s[P];if(e.multiline){if(P===v){E+=D[N]+" ",N=(N+1)%D.length;continue}if(P===j){E+=D[D.length-1]+" ";continue}}E+=D[0]+" "}switch(E=E.substr(E.length-1)==" "?E.substr(0,E.length-1):E,u=Ul(E,e,o).width,e.textAlign){case"right":f=c-u-2;break;case"center":f=(c-u)/2;break;case"left":default:f=2}r+=_t(f)+" "+_t(m)+` Td
`,r+="("+Gs(E)+`) Tj
`,r+=-_t(f)+` 0 Td
`,m=-(o+2),u=0,j=T?v:v+1,y++,b=""}break}return n.text=r,n.fontSize=o,n},Ul=function(e,r,t){var n=r.scope.internal.getFont(r.fontName,r.fontStyle),s=r.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:r.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:s}},pp={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},gp=function(e,r){var t={type:"reference",object:e};r.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===t.type&&n.object===t.object})===void 0&&r.internal.getPageInfo(e.page).pageContext.annotations.push(t)},vp=function(e,r){for(var t in e)if(e.hasOwnProperty(t)){var n=t,s=e[t];r.internal.newObjectDeferredBegin(s.objId,!0),rr(s)==="object"&&typeof s.putStream=="function"&&s.putStream(),delete e[n]}},yp=function(e,r){if(r.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(pn.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(pp)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");td=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new If,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in n)if(n.hasOwnProperty(s)){var o=n[s];o.objId=void 0,o.hasAnnotation&&gp(o,t)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(t){(function(n,s){var o=!n;for(var l in n||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(l)){var c=n[l],d=[],f=c.Rect;if(c.Rect&&(c.Rect=mp(c.Rect,s)),s.internal.newObjectDeferredBegin(c.objId,!0),c.DA=dt.createDefaultAppearanceStream(c),rr(c)==="object"&&typeof c.getKeyValueListForStream=="function"&&(d=c.getKeyValueListForStream()),c.Rect=f,c.hasAppearanceStream&&!c.appearanceStreamContent){var u=xp(c);d.push({key:"AP",value:"<</N "+u+">>"}),s.internal.acroformPlugin.xForms.push(u)}if(c.appearanceStreamContent){var g="";for(var p in c.appearanceStreamContent)if(c.appearanceStreamContent.hasOwnProperty(p)){var m=c.appearanceStreamContent[p];if(g+="/"+p+" ",g+="<<",Object.keys(m).length>=1||Array.isArray(m)){for(var l in m)if(m.hasOwnProperty(l)){var j=m[l];typeof j=="function"&&(j=j.call(s,c)),g+="/"+l+" "+j+" ",s.internal.acroformPlugin.xForms.indexOf(j)>=0||s.internal.acroformPlugin.xForms.push(j)}}else typeof(j=m)=="function"&&(j=j.call(s,c)),g+="/"+l+" "+j,s.internal.acroformPlugin.xForms.indexOf(j)>=0||s.internal.acroformPlugin.xForms.push(j);g+=">>"}d.push({key:"AP",value:`<<
`+g+">>"})}s.internal.putStream({additionalKeyValues:d,objectId:c.objId}),s.internal.out("endobj")}o&&vp(s.internal.acroformPlugin.xForms,s)})(t,e)}),e.internal.acroformPlugin.isInitialized=!0}},Pf=ur.__acroform__.arrayToPdfArray=function(e,r,t){var n=function(l){return l};if(Array.isArray(e)){for(var s="[",o=0;o<e.length;o++)switch(o!==0&&(s+=" "),rr(e[o])){case"boolean":case"number":case"object":s+=e[o].toString();break;case"string":e[o].substr(0,1)!=="/"?(r!==void 0&&t&&(n=t.internal.getEncryptor(r)),s+="("+Gs(n(e[o].toString()))+")"):s+=e[o].toString()}return s+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},w0=function(e,r,t){var n=function(s){return s};return r!==void 0&&t&&(n=t.internal.getEncryptor(r)),(e=e||"").toString(),e="("+Gs(n(e))+")"},Tn=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Tn.prototype.toString=function(){return this.objId+" 0 R"},Tn.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Tn.prototype.getKeyValueListForStream=function(){var e=[],r=Object.getOwnPropertyNames(this).filter(function(o){return o!="content"&&o!="appearanceStreamContent"&&o!="scope"&&o!="objId"&&o.substring(0,1)!="_"});for(var t in r)if(Object.getOwnPropertyDescriptor(this,r[t]).configurable===!1){var n=r[t],s=this[n];s&&(Array.isArray(s)?e.push({key:n,value:Pf(s,this.objId,this.scope)}):s instanceof Tn?(s.scope=this.scope,e.push({key:n,value:s.objId+" 0 R"})):typeof s!="function"&&e.push({key:n,value:s}))}return e};var Of=function(){Tn.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,r=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){e=t.trim()},get:function(){return e||null}})};Sa(Of,Tn);var If=function(){Tn.call(this);var e,r=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return r.length>0?r:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return r}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var t=function(n){return n};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+Gs(t(e))+")"}},set:function(t){e=t}})};Sa(If,Tn);var pn=function e(){Tn.call(this);var r=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return r},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute F supplied.');r=b}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!wr(r,3)},set:function(b){b?this.F=Nr(r,3):this.F=jr(r,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute Ff supplied.');t=b}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(b){n=b!==void 0?b:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(b){n[0]=b}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(b){n[1]=b}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(b){n[2]=b}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(b){n[3]=b}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(b){switch(b){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=b;break;default:throw new Error('Invalid value "'+b+'" for attribute FT supplied.')}}});var o=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!o||o.length<1){if(this instanceof ec)return;o="FieldObject"+e.FieldNum++}var b=function(y){return y};return this.scope&&(b=this.scope.internal.getEncryptor(this.objId)),"("+Gs(b(o))+")"},set:function(b){o=b.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return o},set:function(b){o=b}});var l="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return l},set:function(b){l=b}});var c="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return c},set:function(b){c=b}});var d=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return d},set:function(b){d=b}});var f=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return f===void 0?50/td:f},set:function(b){f=b}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(b){u=b}});var g="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!g||this instanceof ec||this instanceof vs))return w0(g,this.objId,this.scope)},set:function(b){b=b.toString(),g=b}});var p=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof Rr?p:w0(p,this.objId,this.scope)},set:function(b){b=b.toString(),p=this instanceof Rr?b:b.substr(0,1)==="("?bi(b.substr(1,b.length-2)):bi(b)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Rr?bi(p.substr(1,p.length-1)):p},set:function(b){b=b.toString(),p=this instanceof Rr?"/"+b:b}});var m=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(m)return m},set:function(b){this.V=b}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof Rr?m:w0(m,this.objId,this.scope)},set:function(b){b=b.toString(),m=this instanceof Rr?b:b.substr(0,1)==="("?bi(b.substr(1,b.length-2)):bi(b)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Rr?bi(m.substr(1,m.length-1)):m},set:function(b){b=b.toString(),m=this instanceof Rr?"/"+b:b}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var j,v=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return v},set:function(b){b=!!b,v=b}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(j)return j},set:function(b){j=b}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,1)},set:function(b){b?this.Ff=Nr(this.Ff,1):this.Ff=jr(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,2)},set:function(b){b?this.Ff=Nr(this.Ff,2):this.Ff=jr(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,3)},set:function(b){b?this.Ff=Nr(this.Ff,3):this.Ff=jr(this.Ff,3)}});var N=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(N!==null)return N},set:function(b){if([0,1,2].indexOf(b)===-1)throw new Error('Invalid value "'+b+'" for attribute Q supplied.');N=b}}),Object.defineProperty(this,"textAlign",{get:function(){var b;switch(N){case 0:default:b="left";break;case 1:b="center";break;case 2:b="right"}return b},configurable:!0,enumerable:!0,set:function(b){switch(b){case"right":case 2:N=2;break;case"center":case 1:N=1;break;case"left":case 0:default:N=0}}})};Sa(pn,Tn);var Bs=function(){pn.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){e=t}});var r=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Pf(r,this.objId,this.scope)},set:function(t){var n,s;s=[],typeof(n=t)=="string"&&(s=function(o,l,c){c||(c=1);for(var d,f=[];d=l.exec(o);)f.push(d[c]);return f}(n,/\((.*?)\)/g)),r=s}}),this.getOptions=function(){return r},this.setOptions=function(t){r=t,this.sort&&r.sort()},this.addOption=function(t){t=(t=t||"").toString(),r.push(t),this.sort&&r.sort()},this.removeOption=function(t,n){for(n=n||!1,t=(t=t||"").toString();r.indexOf(t)!==-1&&(r.splice(r.indexOf(t),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,18)},set:function(t){t?this.Ff=Nr(this.Ff,18):this.Ff=jr(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=Nr(this.Ff,19):this.Ff=jr(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,20)},set:function(t){t?(this.Ff=Nr(this.Ff,20),r.sort()):this.Ff=jr(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,22)},set:function(t){t?this.Ff=Nr(this.Ff,22):this.Ff=jr(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,23)},set:function(t){t?this.Ff=Nr(this.Ff,23):this.Ff=jr(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,27)},set:function(t){t?this.Ff=Nr(this.Ff,27):this.Ff=jr(this.Ff,27)}}),this.hasAppearanceStream=!1};Sa(Bs,pn);var Ms=function(){Bs.call(this),this.fontName="helvetica",this.combo=!1};Sa(Ms,Bs);var Us=function(){Ms.call(this),this.combo=!0};Sa(Us,Ms);var No=function(){Us.call(this),this.edit=!0};Sa(No,Us);var Rr=function(){pn.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,15)},set:function(t){t?this.Ff=Nr(this.Ff,15):this.Ff=jr(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,16)},set:function(t){t?this.Ff=Nr(this.Ff,16):this.Ff=jr(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,17)},set:function(t){t?this.Ff=Nr(this.Ff,17):this.Ff=jr(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,26)},set:function(t){t?this.Ff=Nr(this.Ff,26):this.Ff=jr(this.Ff,26)}});var e,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(o){return o};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(r).length!==0){var n,s=[];for(n in s.push("<<"),r)s.push("/"+n+" ("+Gs(t(r[n]))+")");return s.push(">>"),s.join(`
`)}},set:function(t){rr(t)==="object"&&(r=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(t){typeof t=="string"&&(r.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(t){e="/"+t}})};Sa(Rr,pn);var jo=function(){Rr.call(this),this.pushButton=!0};Sa(jo,Rr);var Hs=function(){Rr.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r!==void 0?r:[]}})};Sa(Hs,Rr);var ec=function(){var e,r;pn.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(s){e=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return r},set:function(s){r=s}});var t,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(c){return c};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var o,l=[];for(o in l.push("<<"),n)l.push("/"+o+" ("+Gs(s(n[o]))+")");return l.push(">>"),l.join(`
`)},set:function(s){rr(s)==="object"&&(n=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(s){typeof s=="string"&&(n.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(s){t=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(s){t="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=dt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Sa(ec,pn),Hs.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var r in this.Kids)if(this.Kids.hasOwnProperty(r)){var t=this.Kids[r];t.appearanceStreamContent=e.createAppearanceStream(t.optionName),t.caption=e.getCA()}},Hs.prototype.createOption=function(e){var r=new ec;return r.Parent=this,r.optionName=e,this.Kids.push(r),bp.call(this.scope,r),r};var So=function(){Rr.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=dt.CheckBox.createAppearanceStream()};Sa(So,Rr);var vs=function(){pn.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,13)},set:function(r){r?this.Ff=Nr(this.Ff,13):this.Ff=jr(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,21)},set:function(r){r?this.Ff=Nr(this.Ff,21):this.Ff=jr(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,23)},set:function(r){r?this.Ff=Nr(this.Ff,23):this.Ff=jr(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,24)},set:function(r){r?this.Ff=Nr(this.Ff,24):this.Ff=jr(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,25)},set:function(r){r?this.Ff=Nr(this.Ff,25):this.Ff=jr(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,26)},set:function(r){r?this.Ff=Nr(this.Ff,26):this.Ff=jr(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){Number.isInteger(r)&&(e=r)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Sa(vs,pn);var _o=function(){vs.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,14)},set:function(e){e?this.Ff=Nr(this.Ff,14):this.Ff=jr(this.Ff,14)}}),this.password=!0};Sa(_o,vs);var dt={CheckBox:{createAppearanceStream:function(){return{N:{On:dt.CheckBox.YesNormal},D:{On:dt.CheckBox.YesPushDown,Off:dt.CheckBox.OffPushDown}}},YesPushDown:function(e){var r=_n(e);r.scope=e.scope;var t=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,s=e.scope.__private__.encodeColorString(e.color),o=q0(e,e.caption);return t.push("0.749023 g"),t.push("0 0 "+_t(dt.internal.getWidth(e))+" "+_t(dt.internal.getHeight(e))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+n+" "+_t(o.fontSize)+" Tf "+s),t.push("BT"),t.push(o.text),t.push("ET"),t.push("Q"),t.push("EMC"),r.stream=t.join(`
`),r},YesNormal:function(e){var r=_n(e);r.scope=e.scope;var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),s=[],o=dt.internal.getHeight(e),l=dt.internal.getWidth(e),c=q0(e,e.caption);return s.push("1 g"),s.push("0 0 "+_t(l)+" "+_t(o)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+_t(l-1)+" "+_t(o-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+t+" "+_t(c.fontSize)+" Tf "+n),s.push(c.text),s.push("ET"),s.push("Q"),r.stream=s.join(`
`),r},OffPushDown:function(e){var r=_n(e);r.scope=e.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+_t(dt.internal.getWidth(e))+" "+_t(dt.internal.getHeight(e))+" re"),t.push("f"),r.stream=t.join(`
`),r}},RadioButton:{Circle:{createAppearanceStream:function(e){var r={D:{Off:dt.RadioButton.Circle.OffPushDown},N:{}};return r.N[e]=dt.RadioButton.Circle.YesNormal,r.D[e]=dt.RadioButton.Circle.YesPushDown,r},getCA:function(){return"l"},YesNormal:function(e){var r=_n(e);r.scope=e.scope;var t=[],n=dt.internal.getWidth(e)<=dt.internal.getHeight(e)?dt.internal.getWidth(e)/4:dt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=dt.internal.Bezier_C,o=Number((n*s).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+hs(dt.internal.getWidth(e)/2)+" "+hs(dt.internal.getHeight(e)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),t.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),t.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),t.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),t.push("f"),t.push("Q"),r.stream=t.join(`
`),r},YesPushDown:function(e){var r=_n(e);r.scope=e.scope;var t=[],n=dt.internal.getWidth(e)<=dt.internal.getHeight(e)?dt.internal.getWidth(e)/4:dt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),o=Number((s*dt.internal.Bezier_C).toFixed(5)),l=Number((n*dt.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+hs(dt.internal.getWidth(e)/2)+" "+hs(dt.internal.getHeight(e)/2)+" cm"),t.push(s+" 0 m"),t.push(s+" "+o+" "+o+" "+s+" 0 "+s+" c"),t.push("-"+o+" "+s+" -"+s+" "+o+" -"+s+" 0 c"),t.push("-"+s+" -"+o+" -"+o+" -"+s+" 0 -"+s+" c"),t.push(o+" -"+s+" "+s+" -"+o+" "+s+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+hs(dt.internal.getWidth(e)/2)+" "+hs(dt.internal.getHeight(e)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+l+" "+l+" "+n+" 0 "+n+" c"),t.push("-"+l+" "+n+" -"+n+" "+l+" -"+n+" 0 c"),t.push("-"+n+" -"+l+" -"+l+" -"+n+" 0 -"+n+" c"),t.push(l+" -"+n+" "+n+" -"+l+" "+n+" 0 c"),t.push("f"),t.push("Q"),r.stream=t.join(`
`),r},OffPushDown:function(e){var r=_n(e);r.scope=e.scope;var t=[],n=dt.internal.getWidth(e)<=dt.internal.getHeight(e)?dt.internal.getWidth(e)/4:dt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),o=Number((s*dt.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+hs(dt.internal.getWidth(e)/2)+" "+hs(dt.internal.getHeight(e)/2)+" cm"),t.push(s+" 0 m"),t.push(s+" "+o+" "+o+" "+s+" 0 "+s+" c"),t.push("-"+o+" "+s+" -"+s+" "+o+" -"+s+" 0 c"),t.push("-"+s+" -"+o+" -"+o+" -"+s+" 0 -"+s+" c"),t.push(o+" -"+s+" "+s+" -"+o+" "+s+" 0 c"),t.push("f"),t.push("Q"),r.stream=t.join(`
`),r}},Cross:{createAppearanceStream:function(e){var r={D:{Off:dt.RadioButton.Cross.OffPushDown},N:{}};return r.N[e]=dt.RadioButton.Cross.YesNormal,r.D[e]=dt.RadioButton.Cross.YesPushDown,r},getCA:function(){return"8"},YesNormal:function(e){var r=_n(e);r.scope=e.scope;var t=[],n=dt.internal.calculateCross(e);return t.push("q"),t.push("1 1 "+_t(dt.internal.getWidth(e)-2)+" "+_t(dt.internal.getHeight(e)-2)+" re"),t.push("W"),t.push("n"),t.push(_t(n.x1.x)+" "+_t(n.x1.y)+" m"),t.push(_t(n.x2.x)+" "+_t(n.x2.y)+" l"),t.push(_t(n.x4.x)+" "+_t(n.x4.y)+" m"),t.push(_t(n.x3.x)+" "+_t(n.x3.y)+" l"),t.push("s"),t.push("Q"),r.stream=t.join(`
`),r},YesPushDown:function(e){var r=_n(e);r.scope=e.scope;var t=dt.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+_t(dt.internal.getWidth(e))+" "+_t(dt.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+_t(dt.internal.getWidth(e)-2)+" "+_t(dt.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(_t(t.x1.x)+" "+_t(t.x1.y)+" m"),n.push(_t(t.x2.x)+" "+_t(t.x2.y)+" l"),n.push(_t(t.x4.x)+" "+_t(t.x4.y)+" m"),n.push(_t(t.x3.x)+" "+_t(t.x3.y)+" l"),n.push("s"),n.push("Q"),r.stream=n.join(`
`),r},OffPushDown:function(e){var r=_n(e);r.scope=e.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+_t(dt.internal.getWidth(e))+" "+_t(dt.internal.getHeight(e))+" re"),t.push("f"),r.stream=t.join(`
`),r}}},createDefaultAppearanceStream:function(e){var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,t=e.scope.__private__.encodeColorString(e.color);return"/"+r+" "+e.fontSize+" Tf "+t}};dt.internal={Bezier_C:.551915024494,calculateCross:function(e){var r=dt.internal.getWidth(e),t=dt.internal.getHeight(e),n=Math.min(r,t);return{x1:{x:(r-n)/2,y:(t-n)/2+n},x2:{x:(r-n)/2+n,y:(t-n)/2},x3:{x:(r-n)/2,y:(t-n)/2},x4:{x:(r-n)/2+n,y:(t-n)/2+n}}}},dt.internal.getWidth=function(e){var r=0;return rr(e)==="object"&&(r=xh(e.Rect[2])),r},dt.internal.getHeight=function(e){var r=0;return rr(e)==="object"&&(r=xh(e.Rect[3])),r};var bp=ur.addField=function(e){if(yp(this,e),!(e instanceof pn))throw new Error("Invalid argument passed to jsPDF.addField.");var r;return(r=e).scope.internal.acroformPlugin.printedOut&&(r.scope.internal.acroformPlugin.printedOut=!1,r.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),r.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(r),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};ur.AcroFormChoiceField=Bs,ur.AcroFormListBox=Ms,ur.AcroFormComboBox=Us,ur.AcroFormEditBox=No,ur.AcroFormButton=Rr,ur.AcroFormPushButton=jo,ur.AcroFormRadioButton=Hs,ur.AcroFormCheckBox=So,ur.AcroFormTextField=vs,ur.AcroFormPasswordField=_o,ur.AcroFormAppearance=dt,ur.AcroForm={ChoiceField:Bs,ListBox:Ms,ComboBox:Us,EditBox:No,Button:Rr,PushButton:jo,RadioButton:Hs,CheckBox:So,TextField:vs,PasswordField:_o,Appearance:dt},pt.AcroForm={ChoiceField:Bs,ListBox:Ms,ComboBox:Us,EditBox:No,Button:Rr,PushButton:jo,RadioButton:Hs,CheckBox:So,TextField:vs,PasswordField:_o,Appearance:dt};var wp=pt.AcroForm;function Df(e){return e.reduce(function(r,t,n){return r[t]=n,r},{})}(function(e){e.__addimage__={};var r="UNKNOWN",t={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=e.__addimage__.getImageFileTypeByImageData=function(k,C){var z,G,de,J,Z,oe=r;if((C=C||r)==="RGBA"||k.data!==void 0&&k.data instanceof Uint8ClampedArray&&"height"in k&&"width"in k)return"RGBA";if(B(k))for(Z in t)for(de=t[Z],z=0;z<de.length;z+=1){for(J=!0,G=0;G<de[z].length;G+=1)if(de[z][G]!==void 0&&de[z][G]!==k[G]){J=!1;break}if(J===!0){oe=Z;break}}else for(Z in t)for(de=t[Z],z=0;z<de.length;z+=1){for(J=!0,G=0;G<de[z].length;G+=1)if(de[z][G]!==void 0&&de[z][G]!==k.charCodeAt(G)){J=!1;break}if(J===!0){oe=Z;break}}return oe===r&&C!==r&&(oe=C),oe},s=function k(C){for(var z=this.internal.write,G=this.internal.putStream,de=(0,this.internal.getFilters)();de.indexOf("FlateEncode")!==-1;)de.splice(de.indexOf("FlateEncode"),1);C.objectId=this.internal.newObject();var J=[];if(J.push({key:"Type",value:"/XObject"}),J.push({key:"Subtype",value:"/Image"}),J.push({key:"Width",value:C.width}),J.push({key:"Height",value:C.height}),C.colorSpace===N.INDEXED?J.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(C.palette.length/3-1)+" "+("sMask"in C&&C.sMask!==void 0?C.objectId+2:C.objectId+1)+" 0 R]"}):(J.push({key:"ColorSpace",value:"/"+C.colorSpace}),C.colorSpace===N.DEVICE_CMYK&&J.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),J.push({key:"BitsPerComponent",value:C.bitsPerComponent}),"decodeParameters"in C&&C.decodeParameters!==void 0&&J.push({key:"DecodeParms",value:"<<"+C.decodeParameters+">>"}),"transparency"in C&&Array.isArray(C.transparency)){for(var Z="",oe=0,ne=C.transparency.length;oe<ne;oe++)Z+=C.transparency[oe]+" "+C.transparency[oe]+" ";J.push({key:"Mask",value:"["+Z+"]"})}C.sMask!==void 0&&J.push({key:"SMask",value:C.objectId+1+" 0 R"});var me=C.filter!==void 0?["/"+C.filter]:void 0;if(G({data:C.data,additionalKeyValues:J,alreadyAppliedFilters:me,objectId:C.objectId}),z("endobj"),"sMask"in C&&C.sMask!==void 0){var be="/Predictor "+C.predictor+" /Colors 1 /BitsPerComponent "+C.bitsPerComponent+" /Columns "+C.width,A={width:C.width,height:C.height,colorSpace:"DeviceGray",bitsPerComponent:C.bitsPerComponent,decodeParameters:be,data:C.sMask};"filter"in C&&(A.filter=C.filter),k.call(this,A)}if(C.colorSpace===N.INDEXED){var I=this.internal.newObject();G({data:E(new Uint8Array(C.palette)),objectId:I}),z("endobj")}},o=function(){var k=this.internal.collections.addImage_images;for(var C in k)s.call(this,k[C])},l=function(){var k,C=this.internal.collections.addImage_images,z=this.internal.write;for(var G in C)z("/I"+(k=C[G]).index,k.objectId,"0","R")},c=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},d=function(){var k=this.internal.collections.addImage_images;return c.call(this),k},f=function(){return Object.keys(this.internal.collections.addImage_images).length},u=function(k){return typeof e["process"+k.toUpperCase()]=="function"},g=function(k){return rr(k)==="object"&&k.nodeType===1},p=function(k,C){if(k.nodeName==="IMG"&&k.hasAttribute("src")){var z=""+k.getAttribute("src");if(z.indexOf("data:image/")===0)return wo(unescape(z).split("base64,").pop());var G=e.loadFile(z,!0);if(G!==void 0)return G}if(k.nodeName==="CANVAS"){if(k.width===0||k.height===0)throw new Error("Given canvas must have data. Canvas width: "+k.width+", height: "+k.height);var de;switch(C){case"PNG":de="image/png";break;case"WEBP":de="image/webp";break;case"JPEG":case"JPG":default:de="image/jpeg"}return wo(k.toDataURL(de,1).split("base64,").pop())}},m=function(k){var C=this.internal.collections.addImage_images;if(C){for(var z in C)if(k===C[z].alias)return C[z]}},j=function(k,C,z){return k||C||(k=-96,C=-96),k<0&&(k=-1*z.width*72/k/this.internal.scaleFactor),C<0&&(C=-1*z.height*72/C/this.internal.scaleFactor),k===0&&(k=C*z.width/z.height),C===0&&(C=k*z.height/z.width),[k,C]},v=function(k,C,z,G,de,J){var Z=j.call(this,z,G,de),oe=this.internal.getCoordinateString,ne=this.internal.getVerticalCoordinateString,me=d.call(this);if(z=Z[0],G=Z[1],me[de.index]=de,J){J*=Math.PI/180;var be=Math.cos(J),A=Math.sin(J),I=function(M){return M.toFixed(4)},R=[I(be),I(A),I(-1*A),I(be),0,0,"cm"]}this.internal.write("q"),J?(this.internal.write([1,"0","0",1,oe(k),ne(C+G),"cm"].join(" ")),this.internal.write(R.join(" ")),this.internal.write([oe(z),"0","0",oe(G),"0","0","cm"].join(" "))):this.internal.write([oe(z),"0","0",oe(G),oe(k),ne(C+G),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+de.index+" Do"),this.internal.write("Q")},N=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var b=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},y=e.__addimage__.sHashCode=function(k){var C,z,G=0;if(typeof k=="string")for(z=k.length,C=0;C<z;C++)G=(G<<5)-G+k.charCodeAt(C),G|=0;else if(B(k))for(z=k.byteLength/2,C=0;C<z;C++)G=(G<<5)-G+k[C],G|=0;return G},_=e.__addimage__.validateStringAsBase64=function(k){(k=k||"").toString().trim();var C=!0;return k.length===0&&(C=!1),k.length%4!=0&&(C=!1),/^[A-Za-z0-9+/]+$/.test(k.substr(0,k.length-2))===!1&&(C=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(k.substr(-2))===!1&&(C=!1),C},T=e.__addimage__.extractImageFromDataUrl=function(k){var C=(k=k||"").split("base64,"),z=null;if(C.length===2){var G=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(C[0]);Array.isArray(G)&&(z={mimeType:G[1],charset:G[2],data:C[1]})}return z},O=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(k){return O()&&k instanceof ArrayBuffer};var B=e.__addimage__.isArrayBufferView=function(k){return O()&&typeof Uint32Array<"u"&&(k instanceof Int8Array||k instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&k instanceof Uint8ClampedArray||k instanceof Int16Array||k instanceof Uint16Array||k instanceof Int32Array||k instanceof Uint32Array||k instanceof Float32Array||k instanceof Float64Array)},L=e.__addimage__.binaryStringToUint8Array=function(k){for(var C=k.length,z=new Uint8Array(C),G=0;G<C;G++)z[G]=k.charCodeAt(G);return z},E=e.__addimage__.arrayBufferToBinaryString=function(k){for(var C="",z=B(k)?k:new Uint8Array(k),G=0;G<z.length;G+=8192)C+=String.fromCharCode.apply(null,z.subarray(G,G+8192));return C};e.addImage=function(){var k,C,z,G,de,J,Z,oe,ne;if(typeof arguments[1]=="number"?(C=r,z=arguments[1],G=arguments[2],de=arguments[3],J=arguments[4],Z=arguments[5],oe=arguments[6],ne=arguments[7]):(C=arguments[1],z=arguments[2],G=arguments[3],de=arguments[4],J=arguments[5],Z=arguments[6],oe=arguments[7],ne=arguments[8]),rr(k=arguments[0])==="object"&&!g(k)&&"imageData"in k){var me=k;k=me.imageData,C=me.format||C||r,z=me.x||z||0,G=me.y||G||0,de=me.w||me.width||de,J=me.h||me.height||J,Z=me.alias||Z,oe=me.compression||oe,ne=me.rotation||me.angle||ne}var be=this.internal.getFilters();if(oe===void 0&&be.indexOf("FlateEncode")!==-1&&(oe="SLOW"),isNaN(z)||isNaN(G))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var A=P.call(this,k,C,Z,oe);return v.call(this,z,G,de,J,A,ne),this};var P=function(k,C,z,G){var de,J,Z;if(typeof k=="string"&&n(k)===r){k=unescape(k);var oe=D(k,!1);(oe!==""||(oe=e.loadFile(k,!0))!==void 0)&&(k=oe)}if(g(k)&&(k=p(k,C)),C=n(k,C),!u(C))throw new Error("addImage does not support files of type '"+C+"', please ensure that a plugin for '"+C+"' support is added.");if(((Z=z)==null||Z.length===0)&&(z=function(ne){return typeof ne=="string"||B(ne)?y(ne):B(ne.data)?y(ne.data):null}(k)),(de=m.call(this,z))||(O()&&(k instanceof Uint8Array||C==="RGBA"||(J=k,k=L(k))),de=this["process"+C.toUpperCase()](k,f.call(this),z,function(ne){return ne&&typeof ne=="string"&&(ne=ne.toUpperCase()),ne in e.image_compression?ne:b.NONE}(G),J)),!de)throw new Error("An unknown error occurred whilst processing the image.");return de},D=e.__addimage__.convertBase64ToBinaryString=function(k,C){var z;C=typeof C!="boolean"||C;var G,de="";if(typeof k=="string"){G=(z=T(k))!==null?z.data:k;try{de=wo(G)}catch(J){if(C)throw _(G)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+J.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return de};e.getImageProperties=function(k){var C,z,G="";if(g(k)&&(k=p(k)),typeof k=="string"&&n(k)===r&&((G=D(k,!1))===""&&(G=e.loadFile(k)||""),k=G),z=n(k),!u(z))throw new Error("addImage does not support files of type '"+z+"', please ensure that a plugin for '"+z+"' support is added.");if(!O()||k instanceof Uint8Array||(k=L(k)),!(C=this["process"+z.toUpperCase()](k)))throw new Error("An unknown error occurred whilst processing the image");return C.fileType=z,C}})(pt.API),function(e){var r=function(t){if(t!==void 0&&t!="")return!0};pt.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(t){for(var n,s,o,l=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString,d=this.internal.getPageInfoByObjId(t.objId),f=t.pageContext.annotations,u=!1,g=0;g<f.length&&!u;g++)switch((n=f[g]).type){case"link":(r(n.options.url)||r(n.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var p=0;p<f.length;p++){n=f[p];var m=this.internal.pdfEscape,j=this.internal.getEncryptor(t.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var v=this.internal.newAdditionalObject(),N=this.internal.newAdditionalObject(),b=this.internal.getEncryptor(v.objId),y=n.title||"Note";o="<</Type /Annot /Subtype /Text "+(s="/Rect ["+l(n.bounds.x)+" "+c(n.bounds.y+n.bounds.h)+" "+l(n.bounds.x+n.bounds.w)+" "+c(n.bounds.y)+"] ")+"/Contents ("+m(b(n.contents))+")",o+=" /Popup "+N.objId+" 0 R",o+=" /P "+d.objId+" 0 R",o+=" /T ("+m(b(y))+") >>",v.content=o;var _=v.objId+" 0 R";o="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+l(n.bounds.x+30)+" "+c(n.bounds.y+n.bounds.h)+" "+l(n.bounds.x+n.bounds.w+30)+" "+c(n.bounds.y)+"] ")+" /Parent "+_,n.open&&(o+=" /Open true"),o+=" >>",N.content=o,this.internal.write(v.objId,"0 R",N.objId,"0 R");break;case"freetext":s="/Rect ["+l(n.bounds.x)+" "+c(n.bounds.y)+" "+l(n.bounds.x+n.bounds.w)+" "+c(n.bounds.y+n.bounds.h)+"] ";var T=n.color||"#000000";o="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+m(j(n.contents))+")",o+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+T+")",o+=" /Border [0 0 0]",o+=" >>",this.internal.write(o);break;case"link":if(n.options.name){var O=this.annotations._nameMap[n.options.name];n.options.pageNumber=O.page,n.options.top=O.y}else n.options.top||(n.options.top=0);if(s="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",o="",n.options.url)o="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+m(j(n.options.url))+") >>";else if(n.options.pageNumber)switch(o="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":o+=" /Fit]";break;case"FitH":o+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,o+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var B=c(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),o+=" /XYZ "+n.options.left+" "+B+" "+n.options.zoom+"]"}o!=""&&(o+=" >>",this.internal.write(o))}}this.internal.write("]")}}]),e.createAnnotation=function(t){var n=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":n.pageContext.annotations.push(t)}},e.link=function(t,n,s,o,l){var c=this.internal.getCurrentPageInfo(),d=this.internal.getCoordinateString,f=this.internal.getVerticalCoordinateString;c.pageContext.annotations.push({finalBounds:{x:d(t),y:f(n),w:d(t+s),h:f(n+o)},options:l,type:"link"})},e.textWithLink=function(t,n,s,o){var l,c,d=this.getTextWidth(t),f=this.internal.getLineHeight()/this.internal.scaleFactor;if(o.maxWidth!==void 0){c=o.maxWidth;var u=this.splitTextToSize(t,c).length;l=Math.ceil(f*u)}else c=d,l=f;return this.text(t,n,s,o),s+=.2*f,o.align==="center"&&(n-=d/2),o.align==="right"&&(n-=d),this.link(n,s-f,c,l,o),d},e.getTextWidth=function(t){var n=this.internal.getFontSize();return this.getStringUnitWidth(t)*n/this.internal.scaleFactor}}(pt.API),function(e){var r={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];e.__arabicParser__={};var o=e.__arabicParser__.isInArabicSubstitutionA=function(v){return r[v.charCodeAt(0)]!==void 0},l=e.__arabicParser__.isArabicLetter=function(v){return typeof v=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(v)},c=e.__arabicParser__.isArabicEndLetter=function(v){return l(v)&&o(v)&&r[v.charCodeAt(0)].length<=2},d=e.__arabicParser__.isArabicAlfLetter=function(v){return l(v)&&s.indexOf(v.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(v){return l(v)&&o(v)&&r[v.charCodeAt(0)].length>=1};var f=e.__arabicParser__.arabicLetterHasFinalForm=function(v){return l(v)&&o(v)&&r[v.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(v){return l(v)&&o(v)&&r[v.charCodeAt(0)].length>=3};var u=e.__arabicParser__.arabicLetterHasMedialForm=function(v){return l(v)&&o(v)&&r[v.charCodeAt(0)].length==4},g=e.__arabicParser__.resolveLigatures=function(v){var N=0,b=t,y="",_=0;for(N=0;N<v.length;N+=1)b[v.charCodeAt(N)]!==void 0?(_++,typeof(b=b[v.charCodeAt(N)])=="number"&&(y+=String.fromCharCode(b),b=t,_=0),N===v.length-1&&(b=t,y+=v.charAt(N-(_-1)),N-=_-1,_=0)):(b=t,y+=v.charAt(N-_),N-=_,_=0);return y};e.__arabicParser__.isArabicDiacritic=function(v){return v!==void 0&&n[v.charCodeAt(0)]!==void 0};var p=e.__arabicParser__.getCorrectForm=function(v,N,b){return l(v)?o(v)===!1?-1:!f(v)||!l(N)&&!l(b)||!l(b)&&c(N)||c(v)&&!l(N)||c(v)&&d(N)||c(v)&&c(N)?0:u(v)&&l(N)&&!c(N)&&l(b)&&f(b)?3:c(v)||!l(b)?1:2:-1},m=function(v){var N=0,b=0,y=0,_="",T="",O="",B=(v=v||"").split("\\s+"),L=[];for(N=0;N<B.length;N+=1){for(L.push(""),b=0;b<B[N].length;b+=1)_=B[N][b],T=B[N][b-1],O=B[N][b+1],l(_)?(y=p(_,T,O),L[N]+=y!==-1?String.fromCharCode(r[_.charCodeAt(0)][y]):_):L[N]+=_;L[N]=g(L[N])}return L.join(" ")},j=e.__arabicParser__.processArabic=e.processArabic=function(){var v,N=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,b=[];if(Array.isArray(N)){var y=0;for(b=[],y=0;y<N.length;y+=1)Array.isArray(N[y])?b.push([m(N[y][0]),N[y][1],N[y][2]]):b.push([m(N[y])]);v=b}else v=m(N);return typeof arguments[0]=="string"?v:(arguments[0].text=v,arguments[0])};e.events.push(["preProcessText",j])}(pt.API),pt.API.autoPrint=function(e){var r;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){r=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+r+" 0 R")})}return this},function(e){var r=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(c){t=c}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(c){n=isNaN(c)||Number.isInteger(c)===!1||c<0?150:c,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(c){s=isNaN(c)||Number.isInteger(c)===!1||c<0?300:c,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var o=[];Object.defineProperty(this,"childNodes",{get:function(){return o},set:function(c){o=c}});var l={};Object.defineProperty(this,"style",{get:function(){return l},set:function(c){l=c}}),Object.defineProperty(this,"parentNode",{})};r.prototype.getContext=function(t,n){var s;if((t=t||"2d")!=="2d")return null;for(s in n)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=n[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},r.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new r,this.canvas.pdf=this}])}(pt.API),function(e){var r={left:0,top:0,bottom:0,right:0},t=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},r),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new o,this.internal.__cell__.pages=1},o=function(){var d=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return d},set:function(v){d=v}});var f=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return f},set:function(v){f=v}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(v){u=v}});var g=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return g},set:function(v){g=v}});var p=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return p},set:function(v){p=v}});var m=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return m},set:function(v){m=v}});var j=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return j},set:function(v){j=v}}),this};o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},o.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(d){return n.call(this),this.internal.__cell__.headerFunction=typeof d=="function"?d:void 0,this},e.getTextDimensions=function(d,f){n.call(this);var u=(f=f||{}).fontSize||this.getFontSize(),g=f.font||this.getFont(),p=f.scaleFactor||this.internal.scaleFactor,m=0,j=0,v=0,N=this;if(!Array.isArray(d)&&typeof d!="string"){if(typeof d!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");d=String(d)}var b=f.maxWidth;b>0?typeof d=="string"?d=this.splitTextToSize(d,b):Object.prototype.toString.call(d)==="[object Array]"&&(d=d.reduce(function(_,T){return _.concat(N.splitTextToSize(T,b))},[])):d=Array.isArray(d)?d:[d];for(var y=0;y<d.length;y++)m<(v=this.getStringUnitWidth(d[y],{font:g})*u)&&(m=v);return m!==0&&(j=d.length),{w:m/=p,h:Math.max((j*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/p,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var d=this.internal.__cell__.margins||r;return this.internal.__cell__.lastCell=new o(d.left,d.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var l=e.cell=function(){var d;d=arguments[0]instanceof o?arguments[0]:new o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var f=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,g=this.internal.__cell__.margins||r,p=this.internal.__cell__.tableHeaderRow,m=this.internal.__cell__.printHeaders;return f.lineNumber!==void 0&&(f.lineNumber===d.lineNumber?(d.x=(f.x||0)+(f.width||0),d.y=f.y||0):f.y+f.height+d.height+g.bottom>this.getPageHeight()?(this.cellAddPage(),d.y=g.top,m&&p&&(this.printHeaderRow(d.lineNumber,!0),d.y+=p[0].height)):d.y=f.y+f.height||d.y),d.text[0]!==void 0&&(this.rect(d.x,d.y,d.width,d.height,t===!0?"FD":void 0),d.align==="right"?this.text(d.text,d.x+d.width-u,d.y+u,{align:"right",baseline:"top"}):d.align==="center"?this.text(d.text,d.x+d.width/2,d.y+u,{align:"center",baseline:"top",maxWidth:d.width-u-u}):this.text(d.text,d.x+u,d.y+u,{align:"left",baseline:"top",maxWidth:d.width-u-u})),this.internal.__cell__.lastCell=d,this};e.table=function(d,f,u,g,p){if(n.call(this),!u)throw new Error("No data for PDF table.");var m,j,v,N,b=[],y=[],_=[],T={},O={},B=[],L=[],E=(p=p||{}).autoSize||!1,P=p.printHeaders!==!1,D=p.css&&p.css["font-size"]!==void 0?16*p.css["font-size"]:p.fontSize||12,k=p.margins||Object.assign({width:this.getPageWidth()},r),C=typeof p.padding=="number"?p.padding:3,z=p.headerBackgroundColor||"#c8c8c8",G=p.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=P,this.internal.__cell__.margins=k,this.internal.__cell__.table_font_size=D,this.internal.__cell__.padding=C,this.internal.__cell__.headerBackgroundColor=z,this.internal.__cell__.headerTextColor=G,this.setFontSize(D),g==null)y=b=Object.keys(u[0]),_=b.map(function(){return"left"});else if(Array.isArray(g)&&rr(g[0])==="object")for(b=g.map(function(me){return me.name}),y=g.map(function(me){return me.prompt||me.name||""}),_=g.map(function(me){return me.align||"left"}),m=0;m<g.length;m+=1)O[g[m].name]=g[m].width*(19.049976/25.4);else Array.isArray(g)&&typeof g[0]=="string"&&(y=b=g,_=b.map(function(){return"left"}));if(E||Array.isArray(g)&&typeof g[0]=="string")for(m=0;m<b.length;m+=1){for(T[N=b[m]]=u.map(function(me){return me[N]}),this.setFont(void 0,"bold"),B.push(this.getTextDimensions(y[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),j=T[N],this.setFont(void 0,"normal"),v=0;v<j.length;v+=1)B.push(this.getTextDimensions(j[v],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);O[N]=Math.max.apply(null,B)+C+C,B=[]}if(P){var de={};for(m=0;m<b.length;m+=1)de[b[m]]={},de[b[m]].text=y[m],de[b[m]].align=_[m];var J=c.call(this,de,O);L=b.map(function(me){return new o(d,f,O[me],J,de[me].text,void 0,de[me].align)}),this.setTableHeaderRow(L),this.printHeaderRow(1,!1)}var Z=g.reduce(function(me,be){return me[be.name]=be.align,me},{});for(m=0;m<u.length;m+=1){"rowStart"in p&&p.rowStart instanceof Function&&p.rowStart({row:m,data:u[m]},this);var oe=c.call(this,u[m],O);for(v=0;v<b.length;v+=1){var ne=u[m][b[v]];"cellStart"in p&&p.cellStart instanceof Function&&p.cellStart({row:m,col:v,data:ne},this),l.call(this,new o(d,f,O[b[v]],oe,ne,m+2,Z[b[v]]))}}return this.internal.__cell__.table_x=d,this.internal.__cell__.table_y=f,this};var c=function(d,f){var u=this.internal.__cell__.padding,g=this.internal.__cell__.table_font_size,p=this.internal.scaleFactor;return Object.keys(d).map(function(m){var j=d[m];return this.splitTextToSize(j.hasOwnProperty("text")?j.text:j,f[m]-u-u)},this).map(function(m){return this.getLineHeightFactor()*m.length*g/p+u+u},this).reduce(function(m,j){return Math.max(m,j)},0)};e.setTableHeaderRow=function(d){n.call(this),this.internal.__cell__.tableHeaderRow=d},e.printHeaderRow=function(d,f){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var g=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new o(g[0],g[1],g[2],g[3],void 0,-1)}this.setFont(void 0,"bold");for(var p=[],m=0;m<this.internal.__cell__.tableHeaderRow.length;m+=1){u=this.internal.__cell__.tableHeaderRow[m].clone(),f&&(u.y=this.internal.__cell__.margins.top||0,p.push(u)),u.lineNumber=d;var j=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),l.call(this,u),this.setTextColor(j)}p.length>0&&this.setTableHeaderRow(p),this.setFont(void 0,"normal"),t=!1}}(pt.API);var Rf={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Bf=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],V0=Df(Bf),Mf=[100,200,300,400,500,600,700,800,900],Np=Df(Mf);function G0(e){var r=e.family.replace(/"|'/g,"").toLowerCase(),t=function(o){return Rf[o=o||"normal"]?o:"normal"}(e.style),n=function(o){if(!o)return 400;if(typeof o=="number")return o>=100&&o<=900&&o%100==0?o:400;if(/^\d00$/.test(o))return parseInt(o);switch(o){case"bold":return 700;case"normal":default:return 400}}(e.weight),s=function(o){return typeof V0[o=o||"normal"]=="number"?o:"normal"}(e.stretch);return{family:r,style:t,weight:n,stretch:s,src:e.src||[],ref:e.ref||{name:r,style:[s,t,n].join(" ")}}}function ph(e,r,t,n){var s;for(s=t;s>=0&&s<r.length;s+=n)if(e[r[s]])return e[r[s]];for(s=t;s>=0&&s<r.length;s-=n)if(e[r[s]])return e[r[s]]}var jp={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},gh={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function vh(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function Sp(e,r,t){for(var n=(t=t||{}).defaultFontFamily||"times",s=Object.assign({},jp,t.genericFontFamilies||{}),o=null,l=null,c=0;c<r.length;++c)if(s[(o=G0(r[c])).family]&&(o.family=s[o.family]),e.hasOwnProperty(o.family)){l=e[o.family];break}if(!(l=l||e[n]))throw new Error("Could not find a font-family for the rule '"+vh(o)+"' and default family '"+n+"'.");if(l=function(d,f){if(f[d])return f[d];var u=V0[d],g=u<=V0.normal?-1:1,p=ph(f,Bf,u,g);if(!p)throw new Error("Could not find a matching font-stretch value for "+d);return p}(o.stretch,l),l=function(d,f){if(f[d])return f[d];for(var u=Rf[d],g=0;g<u.length;++g)if(f[u[g]])return f[u[g]];throw new Error("Could not find a matching font-style for "+d)}(o.style,l),!(l=function(d,f){if(f[d])return f[d];if(d===400&&f[500])return f[500];if(d===500&&f[400])return f[400];var u=Np[d],g=ph(f,Mf,u,d<400?-1:1);if(!g)throw new Error("Could not find a matching font-weight for value "+d);return g}(o.weight,l)))throw new Error("Failed to resolve a font for the rule '"+vh(o)+"'.");return l}function yh(e){return e.trimLeft()}function _p(e,r){for(var t=0;t<e.length;){if(e.charAt(t)===r)return[e.substring(0,t),e.substring(t+1)];t+=1}return null}function Ap(e){var r=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return r===null?null:[r[0],e.substring(r[0].length)]}var Hl,bh,wh,N0=["times"];(function(e){var r,t,n,s,o,l,c,d,f,u=function(A){return A=A||{},this.isStrokeTransparent=A.isStrokeTransparent||!1,this.strokeOpacity=A.strokeOpacity||1,this.strokeStyle=A.strokeStyle||"#000000",this.fillStyle=A.fillStyle||"#000000",this.isFillTransparent=A.isFillTransparent||!1,this.fillOpacity=A.fillOpacity||1,this.font=A.font||"10px sans-serif",this.textBaseline=A.textBaseline||"alphabetic",this.textAlign=A.textAlign||"left",this.lineWidth=A.lineWidth||1,this.lineJoin=A.lineJoin||"miter",this.lineCap=A.lineCap||"butt",this.path=A.path||[],this.transform=A.transform!==void 0?A.transform.clone():new d,this.globalCompositeOperation=A.globalCompositeOperation||"normal",this.globalAlpha=A.globalAlpha||1,this.clip_path=A.clip_path||[],this.currentPoint=A.currentPoint||new l,this.miterLimit=A.miterLimit||10,this.lastPoint=A.lastPoint||new l,this.lineDashOffset=A.lineDashOffset||0,this.lineDash=A.lineDash||[],this.margin=A.margin||[0,0,0,0],this.prevPageLastElemOffset=A.prevPageLastElemOffset||0,this.ignoreClearRect=typeof A.ignoreClearRect!="boolean"||A.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new g(this),r=this.internal.f2,t=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,o=this.internal.getVerticalCoordinate,l=this.internal.Point,c=this.internal.Rectangle,d=this.internal.Matrix,f=new u}]);var g=function(A){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var I=A;Object.defineProperty(this,"pdf",{get:function(){return I}});var R=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return R},set:function(Ee){R=!!Ee}});var M=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return M},set:function(Ee){M=!!Ee}});var K=0;Object.defineProperty(this,"posX",{get:function(){return K},set:function(Ee){isNaN(Ee)||(K=Ee)}});var he=0;Object.defineProperty(this,"posY",{get:function(){return he},set:function(Ee){isNaN(Ee)||(he=Ee)}}),Object.defineProperty(this,"margin",{get:function(){return f.margin},set:function(Ee){var le;typeof Ee=="number"?le=[Ee,Ee,Ee,Ee]:((le=new Array(4))[0]=Ee[0],le[1]=Ee.length>=2?Ee[1]:le[0],le[2]=Ee.length>=3?Ee[2]:le[0],le[3]=Ee.length>=4?Ee[3]:le[1]),f.margin=le}});var fe=!1;Object.defineProperty(this,"autoPaging",{get:function(){return fe},set:function(Ee){fe=Ee}});var ee=0;Object.defineProperty(this,"lastBreak",{get:function(){return ee},set:function(Ee){ee=Ee}});var ve=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ve},set:function(Ee){ve=Ee}}),Object.defineProperty(this,"ctx",{get:function(){return f},set:function(Ee){Ee instanceof u&&(f=Ee)}}),Object.defineProperty(this,"path",{get:function(){return f.path},set:function(Ee){f.path=Ee}});var Ce=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ce},set:function(Ee){Ce=Ee}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Ee){var le;le=p(Ee),this.ctx.fillStyle=le.style,this.ctx.isFillTransparent=le.a===0,this.ctx.fillOpacity=le.a,this.pdf.setFillColor(le.r,le.g,le.b,{a:le.a}),this.pdf.setTextColor(le.r,le.g,le.b,{a:le.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Ee){var le=p(Ee);this.ctx.strokeStyle=le.style,this.ctx.isStrokeTransparent=le.a===0,this.ctx.strokeOpacity=le.a,le.a===0?this.pdf.setDrawColor(255,255,255):(le.a,this.pdf.setDrawColor(le.r,le.g,le.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Ee){["butt","round","square"].indexOf(Ee)!==-1&&(this.ctx.lineCap=Ee,this.pdf.setLineCap(Ee))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Ee){isNaN(Ee)||(this.ctx.lineWidth=Ee,this.pdf.setLineWidth(Ee))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Ee){["bevel","round","miter"].indexOf(Ee)!==-1&&(this.ctx.lineJoin=Ee,this.pdf.setLineJoin(Ee))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Ee){isNaN(Ee)||(this.ctx.miterLimit=Ee,this.pdf.setMiterLimit(Ee))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Ee){this.ctx.textBaseline=Ee}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Ee){["right","end","center","left","start"].indexOf(Ee)!==-1&&(this.ctx.textAlign=Ee)}});var De=null;function $e(Ee,le){if(De===null){var He=function(et){var qe=[];return Object.keys(et).forEach(function(Xe){et[Xe].forEach(function(tt){var at=null;switch(tt){case"bold":at={family:Xe,weight:"bold"};break;case"italic":at={family:Xe,style:"italic"};break;case"bolditalic":at={family:Xe,weight:"bold",style:"italic"};break;case"":case"normal":at={family:Xe}}at!==null&&(at.ref={name:Xe,style:tt},qe.push(at))})}),qe}(Ee.getFontList());De=function(et){for(var qe={},Xe=0;Xe<et.length;++Xe){var tt=G0(et[Xe]),at=tt.family,ht=tt.stretch,ft=tt.style,wt=tt.weight;qe[at]=qe[at]||{},qe[at][ht]=qe[at][ht]||{},qe[at][ht][ft]=qe[at][ht][ft]||{},qe[at][ht][ft][wt]=tt}return qe}(He.concat(le))}return De}var Ke=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ke},set:function(Ee){De=null,Ke=Ee}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Ee){var le;if(this.ctx.font=Ee,(le=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Ee))!==null){var He=le[1],et=(le[2],le[3]),qe=le[4],Xe=(le[5],le[6]),tt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(qe)[2];qe=Math.floor(tt==="px"?parseFloat(qe)*this.pdf.internal.scaleFactor:tt==="em"?parseFloat(qe)*this.pdf.getFontSize():parseFloat(qe)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(qe);var at=function(vt){var Ct,st,Fr=[],Ot=vt.trim();if(Ot==="")return N0;if(Ot in gh)return[gh[Ot]];for(;Ot!=="";){switch(st=null,Ct=(Ot=yh(Ot)).charAt(0)){case'"':case"'":st=_p(Ot.substring(1),Ct);break;default:st=Ap(Ot)}if(st===null||(Fr.push(st[0]),(Ot=yh(st[1]))!==""&&Ot.charAt(0)!==","))return N0;Ot=Ot.replace(/^,/,"")}return Fr}(Xe);if(this.fontFaces){var ht=Sp($e(this.pdf,this.fontFaces),at.map(function(vt){return{family:vt,stretch:"normal",weight:et,style:He}}));this.pdf.setFont(ht.ref.name,ht.ref.style)}else{var ft="";(et==="bold"||parseInt(et,10)>=700||He==="bold")&&(ft="bold"),He==="italic"&&(ft+="italic"),ft.length===0&&(ft="normal");for(var wt="",kt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Lt=0;Lt<at.length;Lt++){if(this.pdf.internal.getFont(at[Lt],ft,{noFallback:!0,disableWarning:!0})!==void 0){wt=at[Lt];break}if(ft==="bolditalic"&&this.pdf.internal.getFont(at[Lt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)wt=at[Lt],ft="bold";else if(this.pdf.internal.getFont(at[Lt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){wt=at[Lt],ft="normal";break}}if(wt===""){for(var Ft=0;Ft<at.length;Ft++)if(kt[at[Ft]]){wt=kt[at[Ft]];break}}wt=wt===""?"Times":wt,this.pdf.setFont(wt,ft)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Ee){this.ctx.globalCompositeOperation=Ee}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Ee){this.ctx.globalAlpha=Ee}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Ee){this.ctx.lineDashOffset=Ee,be.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Ee){this.ctx.lineDash=Ee,be.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Ee){this.ctx.ignoreClearRect=!!Ee}})};g.prototype.setLineDash=function(A){this.lineDash=A},g.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},g.prototype.fill=function(){T.call(this,"fill",!1)},g.prototype.stroke=function(){T.call(this,"stroke",!1)},g.prototype.beginPath=function(){this.path=[{type:"begin"}]},g.prototype.moveTo=function(A,I){if(isNaN(A)||isNaN(I))throw tr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var R=this.ctx.transform.applyToPoint(new l(A,I));this.path.push({type:"mt",x:R.x,y:R.y}),this.ctx.lastPoint=new l(A,I)},g.prototype.closePath=function(){var A=new l(0,0),I=0;for(I=this.path.length-1;I!==-1;I--)if(this.path[I].type==="begin"&&rr(this.path[I+1])==="object"&&typeof this.path[I+1].x=="number"){A=new l(this.path[I+1].x,this.path[I+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new l(A.x,A.y)},g.prototype.lineTo=function(A,I){if(isNaN(A)||isNaN(I))throw tr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var R=this.ctx.transform.applyToPoint(new l(A,I));this.path.push({type:"lt",x:R.x,y:R.y}),this.ctx.lastPoint=new l(R.x,R.y)},g.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),T.call(this,null,!0)},g.prototype.quadraticCurveTo=function(A,I,R,M){if(isNaN(R)||isNaN(M)||isNaN(A)||isNaN(I))throw tr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var K=this.ctx.transform.applyToPoint(new l(R,M)),he=this.ctx.transform.applyToPoint(new l(A,I));this.path.push({type:"qct",x1:he.x,y1:he.y,x:K.x,y:K.y}),this.ctx.lastPoint=new l(K.x,K.y)},g.prototype.bezierCurveTo=function(A,I,R,M,K,he){if(isNaN(K)||isNaN(he)||isNaN(A)||isNaN(I)||isNaN(R)||isNaN(M))throw tr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var fe=this.ctx.transform.applyToPoint(new l(K,he)),ee=this.ctx.transform.applyToPoint(new l(A,I)),ve=this.ctx.transform.applyToPoint(new l(R,M));this.path.push({type:"bct",x1:ee.x,y1:ee.y,x2:ve.x,y2:ve.y,x:fe.x,y:fe.y}),this.ctx.lastPoint=new l(fe.x,fe.y)},g.prototype.arc=function(A,I,R,M,K,he){if(isNaN(A)||isNaN(I)||isNaN(R)||isNaN(M)||isNaN(K))throw tr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(he=!!he,!this.ctx.transform.isIdentity){var fe=this.ctx.transform.applyToPoint(new l(A,I));A=fe.x,I=fe.y;var ee=this.ctx.transform.applyToPoint(new l(0,R)),ve=this.ctx.transform.applyToPoint(new l(0,0));R=Math.sqrt(Math.pow(ee.x-ve.x,2)+Math.pow(ee.y-ve.y,2))}Math.abs(K-M)>=2*Math.PI&&(M=0,K=2*Math.PI),this.path.push({type:"arc",x:A,y:I,radius:R,startAngle:M,endAngle:K,counterclockwise:he})},g.prototype.arcTo=function(A,I,R,M,K){throw new Error("arcTo not implemented.")},g.prototype.rect=function(A,I,R,M){if(isNaN(A)||isNaN(I)||isNaN(R)||isNaN(M))throw tr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(A,I),this.lineTo(A+R,I),this.lineTo(A+R,I+M),this.lineTo(A,I+M),this.lineTo(A,I),this.lineTo(A+R,I),this.lineTo(A,I)},g.prototype.fillRect=function(A,I,R,M){if(isNaN(A)||isNaN(I)||isNaN(R)||isNaN(M))throw tr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!m.call(this)){var K={};this.lineCap!=="butt"&&(K.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(K.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(A,I,R,M),this.fill(),K.hasOwnProperty("lineCap")&&(this.lineCap=K.lineCap),K.hasOwnProperty("lineJoin")&&(this.lineJoin=K.lineJoin)}},g.prototype.strokeRect=function(A,I,R,M){if(isNaN(A)||isNaN(I)||isNaN(R)||isNaN(M))throw tr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");j.call(this)||(this.beginPath(),this.rect(A,I,R,M),this.stroke())},g.prototype.clearRect=function(A,I,R,M){if(isNaN(A)||isNaN(I)||isNaN(R)||isNaN(M))throw tr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(A,I,R,M))},g.prototype.save=function(A){A=typeof A!="boolean"||A;for(var I=this.pdf.internal.getCurrentPageInfo().pageNumber,R=0;R<this.pdf.internal.getNumberOfPages();R++)this.pdf.setPage(R+1),this.pdf.internal.out("q");if(this.pdf.setPage(I),A){this.ctx.fontSize=this.pdf.internal.getFontSize();var M=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=M}},g.prototype.restore=function(A){A=typeof A!="boolean"||A;for(var I=this.pdf.internal.getCurrentPageInfo().pageNumber,R=0;R<this.pdf.internal.getNumberOfPages();R++)this.pdf.setPage(R+1),this.pdf.internal.out("Q");this.pdf.setPage(I),A&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},g.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var p=function(A){var I,R,M,K;if(A.isCanvasGradient===!0&&(A=A.getColor()),!A)return{r:0,g:0,b:0,a:0,style:A};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(A))I=0,R=0,M=0,K=0;else{var he=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(A);if(he!==null)I=parseInt(he[1]),R=parseInt(he[2]),M=parseInt(he[3]),K=1;else if((he=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(A))!==null)I=parseInt(he[1]),R=parseInt(he[2]),M=parseInt(he[3]),K=parseFloat(he[4]);else{if(K=1,typeof A=="string"&&A.charAt(0)!=="#"){var fe=new Ef(A);A=fe.ok?fe.toHex():"#000000"}A.length===4?(I=A.substring(1,2),I+=I,R=A.substring(2,3),R+=R,M=A.substring(3,4),M+=M):(I=A.substring(1,3),R=A.substring(3,5),M=A.substring(5,7)),I=parseInt(I,16),R=parseInt(R,16),M=parseInt(M,16)}}return{r:I,g:R,b:M,a:K,style:A}},m=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},j=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};g.prototype.fillText=function(A,I,R,M){if(isNaN(I)||isNaN(R)||typeof A!="string")throw tr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(M=isNaN(M)?void 0:M,!m.call(this)){var K=oe(this.ctx.transform.rotation),he=this.ctx.transform.scaleX;C.call(this,{text:A,x:I,y:R,scale:he,angle:K,align:this.textAlign,maxWidth:M})}},g.prototype.strokeText=function(A,I,R,M){if(isNaN(I)||isNaN(R)||typeof A!="string")throw tr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!j.call(this)){M=isNaN(M)?void 0:M;var K=oe(this.ctx.transform.rotation),he=this.ctx.transform.scaleX;C.call(this,{text:A,x:I,y:R,scale:he,renderingMode:"stroke",angle:K,align:this.textAlign,maxWidth:M})}},g.prototype.measureText=function(A){if(typeof A!="string")throw tr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var I=this.pdf,R=this.pdf.internal.scaleFactor,M=I.internal.getFontSize(),K=I.getStringUnitWidth(A)*M/I.internal.scaleFactor,he=function(fe){var ee=(fe=fe||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ee}}),this};return new he({width:K*=Math.round(96*R/72*1e4)/1e4})},g.prototype.scale=function(A,I){if(isNaN(A)||isNaN(I))throw tr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var R=new d(A,0,0,I,0,0);this.ctx.transform=this.ctx.transform.multiply(R)},g.prototype.rotate=function(A){if(isNaN(A))throw tr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var I=new d(Math.cos(A),Math.sin(A),-Math.sin(A),Math.cos(A),0,0);this.ctx.transform=this.ctx.transform.multiply(I)},g.prototype.translate=function(A,I){if(isNaN(A)||isNaN(I))throw tr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var R=new d(1,0,0,1,A,I);this.ctx.transform=this.ctx.transform.multiply(R)},g.prototype.transform=function(A,I,R,M,K,he){if(isNaN(A)||isNaN(I)||isNaN(R)||isNaN(M)||isNaN(K)||isNaN(he))throw tr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var fe=new d(A,I,R,M,K,he);this.ctx.transform=this.ctx.transform.multiply(fe)},g.prototype.setTransform=function(A,I,R,M,K,he){A=isNaN(A)?1:A,I=isNaN(I)?0:I,R=isNaN(R)?0:R,M=isNaN(M)?1:M,K=isNaN(K)?0:K,he=isNaN(he)?0:he,this.ctx.transform=new d(A,I,R,M,K,he)};var v=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};g.prototype.drawImage=function(A,I,R,M,K,he,fe,ee,ve){var Ce=this.pdf.getImageProperties(A),De=1,$e=1,Ke=1,Ee=1;M!==void 0&&ee!==void 0&&(Ke=ee/M,Ee=ve/K,De=Ce.width/M*ee/M,$e=Ce.height/K*ve/K),he===void 0&&(he=I,fe=R,I=0,R=0),M!==void 0&&ee===void 0&&(ee=M,ve=K),M===void 0&&ee===void 0&&(ee=Ce.width,ve=Ce.height);for(var le,He=this.ctx.transform.decompose(),et=oe(He.rotate.shx),qe=new d,Xe=(qe=(qe=(qe=qe.multiply(He.translate)).multiply(He.skew)).multiply(He.scale)).applyToRectangle(new c(he-I*Ke,fe-R*Ee,M*De,K*$e)),tt=N.call(this,Xe),at=[],ht=0;ht<tt.length;ht+=1)at.indexOf(tt[ht])===-1&&at.push(tt[ht]);if(_(at),this.autoPaging)for(var ft=at[0],wt=at[at.length-1],kt=ft;kt<wt+1;kt++){this.pdf.setPage(kt);var Lt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ft=kt===1?this.posY+this.margin[0]:this.margin[0],vt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ct=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],st=kt===1?0:vt+(kt-2)*Ct;if(this.ctx.clip_path.length!==0){var Fr=this.path;le=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(le,this.posX+this.margin[3],-st+Ft+this.ctx.prevPageLastElemOffset),O.call(this,"fill",!0),this.path=Fr}var Ot=JSON.parse(JSON.stringify(Xe));Ot=y([Ot],this.posX+this.margin[3],-st+Ft+this.ctx.prevPageLastElemOffset)[0];var ma=(kt>ft||kt<wt)&&v.call(this);ma&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Lt,Ct,null).clip().discardPath()),this.pdf.addImage(A,"JPEG",Ot.x,Ot.y,Ot.w,Ot.h,null,null,et),ma&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(A,"JPEG",Xe.x,Xe.y,Xe.w,Xe.h,null,null,et)};var N=function(A,I,R){var M=[];I=I||this.pdf.internal.pageSize.width,R=R||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var K=this.posY+this.ctx.prevPageLastElemOffset;switch(A.type){default:case"mt":case"lt":M.push(Math.floor((A.y+K)/R)+1);break;case"arc":M.push(Math.floor((A.y+K-A.radius)/R)+1),M.push(Math.floor((A.y+K+A.radius)/R)+1);break;case"qct":var he=ne(this.ctx.lastPoint.x,this.ctx.lastPoint.y,A.x1,A.y1,A.x,A.y);M.push(Math.floor((he.y+K)/R)+1),M.push(Math.floor((he.y+he.h+K)/R)+1);break;case"bct":var fe=me(this.ctx.lastPoint.x,this.ctx.lastPoint.y,A.x1,A.y1,A.x2,A.y2,A.x,A.y);M.push(Math.floor((fe.y+K)/R)+1),M.push(Math.floor((fe.y+fe.h+K)/R)+1);break;case"rect":M.push(Math.floor((A.y+K)/R)+1),M.push(Math.floor((A.y+A.h+K)/R)+1)}for(var ee=0;ee<M.length;ee+=1)for(;this.pdf.internal.getNumberOfPages()<M[ee];)b.call(this);return M},b=function(){var A=this.fillStyle,I=this.strokeStyle,R=this.font,M=this.lineCap,K=this.lineWidth,he=this.lineJoin;this.pdf.addPage(),this.fillStyle=A,this.strokeStyle=I,this.font=R,this.lineCap=M,this.lineWidth=K,this.lineJoin=he},y=function(A,I,R){for(var M=0;M<A.length;M++)switch(A[M].type){case"bct":A[M].x2+=I,A[M].y2+=R;case"qct":A[M].x1+=I,A[M].y1+=R;case"mt":case"lt":case"arc":default:A[M].x+=I,A[M].y+=R}return A},_=function(A){return A.sort(function(I,R){return I-R})},T=function(A,I){for(var R,M,K=this.fillStyle,he=this.strokeStyle,fe=this.lineCap,ee=this.lineWidth,ve=Math.abs(ee*this.ctx.transform.scaleX),Ce=this.lineJoin,De=JSON.parse(JSON.stringify(this.path)),$e=JSON.parse(JSON.stringify(this.path)),Ke=[],Ee=0;Ee<$e.length;Ee++)if($e[Ee].x!==void 0)for(var le=N.call(this,$e[Ee]),He=0;He<le.length;He+=1)Ke.indexOf(le[He])===-1&&Ke.push(le[He]);for(var et=0;et<Ke.length;et++)for(;this.pdf.internal.getNumberOfPages()<Ke[et];)b.call(this);if(_(Ke),this.autoPaging)for(var qe=Ke[0],Xe=Ke[Ke.length-1],tt=qe;tt<Xe+1;tt++){this.pdf.setPage(tt),this.fillStyle=K,this.strokeStyle=he,this.lineCap=fe,this.lineWidth=ve,this.lineJoin=Ce;var at=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ht=tt===1?this.posY+this.margin[0]:this.margin[0],ft=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],wt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],kt=tt===1?0:ft+(tt-2)*wt;if(this.ctx.clip_path.length!==0){var Lt=this.path;R=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(R,this.posX+this.margin[3],-kt+ht+this.ctx.prevPageLastElemOffset),O.call(this,A,!0),this.path=Lt}if(M=JSON.parse(JSON.stringify(De)),this.path=y(M,this.posX+this.margin[3],-kt+ht+this.ctx.prevPageLastElemOffset),I===!1||tt===0){var Ft=(tt>qe||tt<Xe)&&v.call(this);Ft&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],at,wt,null).clip().discardPath()),O.call(this,A,I),Ft&&this.pdf.restoreGraphicsState()}this.lineWidth=ee}else this.lineWidth=ve,O.call(this,A,I),this.lineWidth=ee;this.path=De},O=function(A,I){if((A!=="stroke"||I||!j.call(this))&&(A==="stroke"||I||!m.call(this))){for(var R,M,K=[],he=this.path,fe=0;fe<he.length;fe++){var ee=he[fe];switch(ee.type){case"begin":K.push({begin:!0});break;case"close":K.push({close:!0});break;case"mt":K.push({start:ee,deltas:[],abs:[]});break;case"lt":var ve=K.length;if(he[fe-1]&&!isNaN(he[fe-1].x)&&(R=[ee.x-he[fe-1].x,ee.y-he[fe-1].y],ve>0)){for(;ve>=0;ve--)if(K[ve-1].close!==!0&&K[ve-1].begin!==!0){K[ve-1].deltas.push(R),K[ve-1].abs.push(ee);break}}break;case"bct":R=[ee.x1-he[fe-1].x,ee.y1-he[fe-1].y,ee.x2-he[fe-1].x,ee.y2-he[fe-1].y,ee.x-he[fe-1].x,ee.y-he[fe-1].y],K[K.length-1].deltas.push(R);break;case"qct":var Ce=he[fe-1].x+2/3*(ee.x1-he[fe-1].x),De=he[fe-1].y+2/3*(ee.y1-he[fe-1].y),$e=ee.x+2/3*(ee.x1-ee.x),Ke=ee.y+2/3*(ee.y1-ee.y),Ee=ee.x,le=ee.y;R=[Ce-he[fe-1].x,De-he[fe-1].y,$e-he[fe-1].x,Ke-he[fe-1].y,Ee-he[fe-1].x,le-he[fe-1].y],K[K.length-1].deltas.push(R);break;case"arc":K.push({deltas:[],abs:[],arc:!0}),Array.isArray(K[K.length-1].abs)&&K[K.length-1].abs.push(ee)}}M=I?null:A==="stroke"?"stroke":"fill";for(var He=!1,et=0;et<K.length;et++)if(K[et].arc)for(var qe=K[et].abs,Xe=0;Xe<qe.length;Xe++){var tt=qe[Xe];tt.type==="arc"?E.call(this,tt.x,tt.y,tt.radius,tt.startAngle,tt.endAngle,tt.counterclockwise,void 0,I,!He):z.call(this,tt.x,tt.y),He=!0}else if(K[et].close===!0)this.pdf.internal.out("h"),He=!1;else if(K[et].begin!==!0){var at=K[et].start.x,ht=K[et].start.y;G.call(this,K[et].deltas,at,ht),He=!0}M&&P.call(this,M),I&&D.call(this)}},B=function(A){var I=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,R=I*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return A-R;case"top":return A+I-R;case"hanging":return A+I-2*R;case"middle":return A+I/2-R;case"ideographic":return A;case"alphabetic":default:return A}},L=function(A){return A+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};g.prototype.createLinearGradient=function(){var A=function(){};return A.colorStops=[],A.addColorStop=function(I,R){this.colorStops.push([I,R])},A.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},A.isCanvasGradient=!0,A},g.prototype.createPattern=function(){return this.createLinearGradient()},g.prototype.createRadialGradient=function(){return this.createLinearGradient()};var E=function(A,I,R,M,K,he,fe,ee,ve){for(var Ce=J.call(this,R,M,K,he),De=0;De<Ce.length;De++){var $e=Ce[De];De===0&&(ve?k.call(this,$e.x1+A,$e.y1+I):z.call(this,$e.x1+A,$e.y1+I)),de.call(this,A,I,$e.x2,$e.y2,$e.x3,$e.y3,$e.x4,$e.y4)}ee?D.call(this):P.call(this,fe)},P=function(A){switch(A){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},D=function(){this.pdf.clip(),this.pdf.discardPath()},k=function(A,I){this.pdf.internal.out(t(A)+" "+n(I)+" m")},C=function(A){var I;switch(A.align){case"right":case"end":I="right";break;case"center":I="center";break;case"left":case"start":default:I="left"}var R=this.pdf.getTextDimensions(A.text),M=B.call(this,A.y),K=L.call(this,M)-R.h,he=this.ctx.transform.applyToPoint(new l(A.x,M)),fe=this.ctx.transform.decompose(),ee=new d;ee=(ee=(ee=ee.multiply(fe.translate)).multiply(fe.skew)).multiply(fe.scale);for(var ve,Ce,De,$e=this.ctx.transform.applyToRectangle(new c(A.x,M,R.w,R.h)),Ke=ee.applyToRectangle(new c(A.x,K,R.w,R.h)),Ee=N.call(this,Ke),le=[],He=0;He<Ee.length;He+=1)le.indexOf(Ee[He])===-1&&le.push(Ee[He]);if(_(le),this.autoPaging)for(var et=le[0],qe=le[le.length-1],Xe=et;Xe<qe+1;Xe++){this.pdf.setPage(Xe);var tt=Xe===1?this.posY+this.margin[0]:this.margin[0],at=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ht=this.pdf.internal.pageSize.height-this.margin[2],ft=ht-this.margin[0],wt=this.pdf.internal.pageSize.width-this.margin[1],kt=wt-this.margin[3],Lt=Xe===1?0:at+(Xe-2)*ft;if(this.ctx.clip_path.length!==0){var Ft=this.path;ve=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(ve,this.posX+this.margin[3],-1*Lt+tt),O.call(this,"fill",!0),this.path=Ft}var vt=y([JSON.parse(JSON.stringify(Ke))],this.posX+this.margin[3],-Lt+tt+this.ctx.prevPageLastElemOffset)[0];A.scale>=.01&&(Ce=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ce*A.scale),De=this.lineWidth,this.lineWidth=De*A.scale);var Ct=this.autoPaging!=="text";if(Ct||vt.y+vt.h<=ht){if(Ct||vt.y>=tt&&vt.x<=wt){var st=Ct?A.text:this.pdf.splitTextToSize(A.text,A.maxWidth||wt-vt.x)[0],Fr=y([JSON.parse(JSON.stringify($e))],this.posX+this.margin[3],-Lt+tt+this.ctx.prevPageLastElemOffset)[0],Ot=Ct&&(Xe>et||Xe<qe)&&v.call(this);Ot&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],kt,ft,null).clip().discardPath()),this.pdf.text(st,Fr.x,Fr.y,{angle:A.angle,align:I,renderingMode:A.renderingMode}),Ot&&this.pdf.restoreGraphicsState()}}else vt.y<ht&&(this.ctx.prevPageLastElemOffset+=ht-vt.y);A.scale>=.01&&(this.pdf.setFontSize(Ce),this.lineWidth=De)}else A.scale>=.01&&(Ce=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ce*A.scale),De=this.lineWidth,this.lineWidth=De*A.scale),this.pdf.text(A.text,he.x+this.posX,he.y+this.posY,{angle:A.angle,align:I,renderingMode:A.renderingMode,maxWidth:A.maxWidth}),A.scale>=.01&&(this.pdf.setFontSize(Ce),this.lineWidth=De)},z=function(A,I,R,M){R=R||0,M=M||0,this.pdf.internal.out(t(A+R)+" "+n(I+M)+" l")},G=function(A,I,R){return this.pdf.lines(A,I,R,null,null)},de=function(A,I,R,M,K,he,fe,ee){this.pdf.internal.out([r(s(R+A)),r(o(M+I)),r(s(K+A)),r(o(he+I)),r(s(fe+A)),r(o(ee+I)),"c"].join(" "))},J=function(A,I,R,M){for(var K=2*Math.PI,he=Math.PI/2;I>R;)I-=K;var fe=Math.abs(R-I);fe<K&&M&&(fe=K-fe);for(var ee=[],ve=M?-1:1,Ce=I;fe>1e-5;){var De=Ce+ve*Math.min(fe,he);ee.push(Z.call(this,A,Ce,De)),fe-=Math.abs(De-Ce),Ce=De}return ee},Z=function(A,I,R){var M=(R-I)/2,K=A*Math.cos(M),he=A*Math.sin(M),fe=K,ee=-he,ve=fe*fe+ee*ee,Ce=ve+fe*K+ee*he,De=4/3*(Math.sqrt(2*ve*Ce)-Ce)/(fe*he-ee*K),$e=fe-De*ee,Ke=ee+De*fe,Ee=$e,le=-Ke,He=M+I,et=Math.cos(He),qe=Math.sin(He);return{x1:A*Math.cos(I),y1:A*Math.sin(I),x2:$e*et-Ke*qe,y2:$e*qe+Ke*et,x3:Ee*et-le*qe,y3:Ee*qe+le*et,x4:A*Math.cos(R),y4:A*Math.sin(R)}},oe=function(A){return 180*A/Math.PI},ne=function(A,I,R,M,K,he){var fe=A+.5*(R-A),ee=I+.5*(M-I),ve=K+.5*(R-K),Ce=he+.5*(M-he),De=Math.min(A,K,fe,ve),$e=Math.max(A,K,fe,ve),Ke=Math.min(I,he,ee,Ce),Ee=Math.max(I,he,ee,Ce);return new c(De,Ke,$e-De,Ee-Ke)},me=function(A,I,R,M,K,he,fe,ee){var ve,Ce,De,$e,Ke,Ee,le,He,et,qe,Xe,tt,at,ht,ft=R-A,wt=M-I,kt=K-R,Lt=he-M,Ft=fe-K,vt=ee-he;for(Ce=0;Ce<41;Ce++)et=(le=(De=A+(ve=Ce/40)*ft)+ve*((Ke=R+ve*kt)-De))+ve*(Ke+ve*(K+ve*Ft-Ke)-le),qe=(He=($e=I+ve*wt)+ve*((Ee=M+ve*Lt)-$e))+ve*(Ee+ve*(he+ve*vt-Ee)-He),Ce==0?(Xe=et,tt=qe,at=et,ht=qe):(Xe=Math.min(Xe,et),tt=Math.min(tt,qe),at=Math.max(at,et),ht=Math.max(ht,qe));return new c(Math.round(Xe),Math.round(tt),Math.round(at-Xe),Math.round(ht-tt))},be=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var A,I,R=(A=this.ctx.lineDash,I=this.ctx.lineDashOffset,JSON.stringify({lineDash:A,lineDashOffset:I}));this.prevLineDash!==R&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=R)}}})(pt.API),function(e){var r=function(o){var l,c,d,f,u,g,p,m,j,v;for(c=[],d=0,f=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;f>d;d+=4)(u=(o.charCodeAt(d)<<24)+(o.charCodeAt(d+1)<<16)+(o.charCodeAt(d+2)<<8)+o.charCodeAt(d+3))!==0?(g=(u=((u=((u=((u=(u-(v=u%85))/85)-(j=u%85))/85)-(m=u%85))/85)-(p=u%85))/85)%85,c.push(g+33,p+33,m+33,j+33,v+33)):c.push(122);return function(N,b){for(var y=b;y>0;y--)N.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},t=function(o){var l,c,d,f,u,g=String,p="length",m=255,j="charCodeAt",v="slice",N="replace";for(o[v](-2),o=o[v](0,-2)[N](/\s/g,"")[N]("z","!!!!!"),d=[],f=0,u=(o+=l="uuuuu"[v](o[p]%5||5))[p];u>f;f+=5)c=52200625*(o[j](f)-33)+614125*(o[j](f+1)-33)+7225*(o[j](f+2)-33)+85*(o[j](f+3)-33)+(o[j](f+4)-33),d.push(m&c>>24,m&c>>16,m&c>>8,m&c);return function(b,y){for(var _=y;_>0;_--)b.pop()}(d,l[p]),g.fromCharCode.apply(g,d)},n=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",d=0;d<o.length;d+=2)c+=String.fromCharCode("0x"+(o[d]+o[d+1]));return c},s=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return o=(l=U0(l)).reduce(function(d,f){return d+String.fromCharCode(f)},"")};e.processDataByFilters=function(o,l){var c=0,d=o||"",f=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":d=t(d),f.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":d=r(d),f.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":d=n(d),f.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":d=d.split("").map(function(u){return("0"+u.charCodeAt().toString(16)).slice(-2)}).join("")+">",f.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":d=s(d),f.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:d,reverseChain:f.reverse().join(" ")}}}(pt.API),function(e){e.loadFile=function(r,t,n){return function(s,o,l){o=o!==!1,l=typeof l=="function"?l:function(){};var c=void 0;try{c=function(d,f,u){var g=new XMLHttpRequest,p=0,m=function(j){var v=j.length,N=[],b=String.fromCharCode;for(p=0;p<v;p+=1)N.push(b(255&j.charCodeAt(p)));return N.join("")};if(g.open("GET",d,!f),g.overrideMimeType("text/plain; charset=x-user-defined"),f===!1&&(g.onload=function(){g.status===200?u(m(this.responseText)):u(void 0)}),g.send(null),f&&g.status===200)return m(g.responseText)}(s,o,l)}catch{}return c}(r,t,n)},e.loadImageFile=e.loadFile}(pt.API),function(e){function r(){return(yt.html2canvas?Promise.resolve(yt.html2canvas):I0(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function t(){return(yt.DOMPurify?Promise.resolve(yt.DOMPurify):I0(()=>import("./purify.es-C_uT9hQ1.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=rr(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},s=function(l,c){var d=document.createElement(l);for(var f in c.className&&(d.className=c.className),c.innerHTML&&c.dompurify&&(d.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)d.style[f]=c.style[f];return d},o=function l(c){var d=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),f=l.convert(Promise.resolve(),d);return f=(f=f.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(d){switch(n(d)){case"string":return"string";case"element":return d.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l)){case"string":return this.then(t).then(function(d){return this.set({src:s("div",{innerHTML:l,dompurify:d})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=function d(f,u){for(var g=f.nodeType===3?document.createTextNode(f.nodeValue):f.cloneNode(!1),p=f.firstChild;p;p=p.nextSibling)u!==!0&&p.nodeType===1&&p.nodeName==="SCRIPT"||g.appendChild(d(p,u));return f.nodeType===1&&(f.nodeName==="CANVAS"?(g.width=f.width,g.height=f.height,g.getContext("2d").drawImage(f,0,0)):f.nodeName!=="TEXTAREA"&&f.nodeName!=="SELECT"||(g.value=f.value),g.addEventListener("load",function(){g.scrollTop=f.scrollTop,g.scrollLeft=f.scrollLeft},!0)),g}(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(r).then(function(c){var d=Object.assign({},this.opt.html2canvas);return delete d.onrendered,c(this.prop.container,d)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(r).then(function(c){var d=this.opt.jsPDF,f=this.opt.fontFaces,u=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,g=Object.assign({async:!0,allowTaint:!0,scale:u,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete g.onrendered,d.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,d.context2d.posX=this.opt.x,d.context2d.posY=this.opt.y,d.context2d.margin=this.opt.margin,d.context2d.fontFaces=f,f)for(var p=0;p<f.length;++p){var m=f[p],j=m.src.find(function(v){return v.format==="truetype"});j&&d.addFont(j.url,m.ref.name,m.ref.style)}return g.windowHeight=g.windowHeight||0,g.windowHeight=g.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):g.windowHeight,d.context2d.save(!0),c(this.prop.container,g)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,d){return(d=d||"pdf").toLowerCase()==="img"||d.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(d){if(d in o.template.prop)return function(){this.prop[d]=l[d]};switch(d){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[d]=l[d]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var d=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(d):d})},o.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(d,f){return Math.floor(d*f/72*96)}return this.then(function(){(l=l||pt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,d,f){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),d!=null&&(this.progress.n=d),f!=null&&(this.progress.stack=f),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,d,f){return this.setProgress(l?this.progress.val+l:null,c||null,d?this.progress.n+d:null,f?this.progress.stack.concat(f):null)},o.prototype.then=function(l,c){var d=this;return this.thenCore(l,c,function(f,u){return d.updateProgress(null,null,1,[f]),Promise.prototype.then.call(this,function(g){return d.updateProgress(null,f),g}).then(f,u).then(function(g){return d.updateProgress(1),g})})},o.prototype.thenCore=function(l,c,d){d=d||Promise.prototype.then,l&&(l=l.bind(this)),c&&(c=c.bind(this));var f=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:o.convert(Object.assign({},this),Promise.prototype),u=d.call(f,l,c);return o.convert(u,this.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(d){c=c.thenCore(d)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,pt.getPageSize=function(l,c,d){if(rr(l)==="object"){var f=l;l=f.orientation,c=f.unit||c,d=f.format||d}c=c||"mm",d=d||"a4",l=(""+(l||"P")).toLowerCase();var u,g=(""+d).toLowerCase(),p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":u=1;break;case"mm":u=72/25.4;break;case"cm":u=72/2.54;break;case"in":u=72;break;case"px":u=.75;break;case"pc":case"em":u=12;break;case"ex":u=6;break;default:throw"Invalid unit: "+c}var m,j=0,v=0;if(p.hasOwnProperty(g))j=p[g][1]/u,v=p[g][0]/u;else try{j=d[1],v=d[0]}catch{throw new Error("Invalid format: "+d)}if(l==="p"||l==="portrait")l="p",v>j&&(m=v,v=j,j=m);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",j>v&&(m=v,v=j,j=m)}return{width:v,height:j,unit:c,k:u,orientation:l}},e.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(G0):null;var d=new o(c);return c.worker?d:d.from(l).doCallback()}}(pt.API),pt.API.addJS=function(e){return wh=e,this.internal.events.subscribe("postPutResources",function(){Hl=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Hl+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),bh=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+wh+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Hl!==void 0&&bh!==void 0&&this.internal.out("/Names <</JavaScript "+Hl+" 0 R>>")}),this},function(e){var r;e.events.push(["postPutResources",function(){var t=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=t.outline.render().split(/\r\n/),o=0;o<s.length;o++){var l=s[o],c=n.exec(l);if(c!=null){var d=c[1];t.internal.newObjectDeferredBegin(d,!1)}t.internal.write(l)}if(this.outline.createNamedDestinations){var f=this.internal.pages.length,u=[];for(o=0;o<f;o++){var g=t.internal.newObject();u.push(g);var p=t.internal.getPageInfo(o+1);t.internal.write("<< /D["+p.objId+" 0 R /XYZ null null null]>> endobj")}var m=t.internal.newObject();for(t.internal.write("<< /Names [ "),o=0;o<u.length;o++)t.internal.write("(page_"+(o+1)+")"+u[o]+" 0 R");t.internal.write(" ] >>","endobj"),r=t.internal.newObject(),t.internal.write("<< /Dests "+m+" 0 R"),t.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+r+" 0 R"))}]),e.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(n,s,o){var l={title:s,options:o,children:[]};return n==null&&(n=this.root),n.children.push(l),l},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(n){n.id=t.internal.newObjectDeferred();for(var s=0;s<n.children.length;s++)this.genIds_r(n.children[s])},t.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},t.outline.renderItems=function(n){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,o=0;o<n.children.length;o++){var l=n.children[o];this.objStart(l),this.line("/Title "+this.makeString(l.title)),this.line("/Parent "+this.makeRef(n)),o>0&&this.line("/Prev "+this.makeRef(n.children[o-1])),o<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[o+1])),l.children.length>0&&(this.line("/First "+this.makeRef(l.children[0])),this.line("/Last "+this.makeRef(l.children[l.children.length-1])));var c=this.count=this.count_r({count:0},l);if(c>0&&this.line("/Count "+c),l.options&&l.options.pageNumber){var d=t.internal.getPageInfo(l.options.pageNumber);this.line("/Dest ["+d.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var f=0;f<n.children.length;f++)this.renderItems(n.children[f])},t.outline.line=function(n){this.ctx.val+=n+`\r
`},t.outline.makeRef=function(n){return n.id+" 0 R"},t.outline.makeString=function(n){return"("+t.internal.pdfEscape(n)+")"},t.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(n,s){for(var o=0;o<s.children.length;o++)n.count++,this.count_r(n,s.children[o]);return n.count}}])}(pt.API),function(e){var r=[192,193,194,195,196,197,198,199];e.processJPEG=function(t,n,s,o,l,c){var d,f=this.decode.DCT_DECODE,u=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=l||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,(d=function(g){for(var p,m=256*g.charCodeAt(4)+g.charCodeAt(5),j=g.length,v={width:0,height:0,numcomponents:1},N=4;N<j;N+=2){if(N+=m,r.indexOf(g.charCodeAt(N+1))!==-1){p=256*g.charCodeAt(N+5)+g.charCodeAt(N+6),v={width:256*g.charCodeAt(N+7)+g.charCodeAt(N+8),height:p,numcomponents:g.charCodeAt(N+9)};break}m=256*g.charCodeAt(N+2)+g.charCodeAt(N+3)}return v}(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t)).numcomponents){case 1:c=this.color_spaces.DEVICE_GRAY;break;case 4:c=this.color_spaces.DEVICE_CMYK;break;case 3:c=this.color_spaces.DEVICE_RGB}u={data:t,width:d.width,height:d.height,colorSpace:c,bitsPerComponent:8,filter:f,index:n,alias:s}}return u}}(pt.API);var wi,Wl,Nh,jh,Sh,kp=function(){var e,r,t;function n(o){var l,c,d,f,u,g,p,m,j,v,N,b,y,_;for(this.data=o,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},g=null;;){switch(l=this.readUInt32(),j=(function(){var T,O;for(O=[],T=0;T<4;++T)O.push(String.fromCharCode(this.data[this.pos++]));return O}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(l);break;case"fcTL":g&&this.animation.frames.push(g),this.pos+=4,g={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},u=this.readUInt16(),f=this.readUInt16()||100,g.delay=1e3*u/f,g.disposeOp=this.data[this.pos++],g.blendOp=this.data[this.pos++],g.data=[];break;case"IDAT":case"fdAT":for(j==="fdAT"&&(this.pos+=4,l-=4),o=(g!=null?g.data:void 0)||this.imgData,b=0;0<=l?b<l:b>l;0<=l?++b:--b)o.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(d=this.palette.length/3,this.transparency.indexed=this.read(l),this.transparency.indexed.length>d)throw new Error("More transparent colors than palette size");if((v=d-this.transparency.indexed.length)>0)for(y=0;0<=v?y<v:y>v;0<=v?++y:--y)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(l)[0];break;case 2:this.transparency.rgb=this.read(l)}break;case"tEXt":p=(N=this.read(l)).indexOf(0),m=String.fromCharCode.apply(String,N.slice(0,p)),this.text[m]=String.fromCharCode.apply(String,N.slice(p+1));break;case"IEND":return g&&this.animation.frames.push(g),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(_=this.colorType)===4||_===6,c=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*c,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=l}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(o){var l,c;for(c=[],l=0;0<=o?l<o:l>o;0<=o?++l:--l)c.push(this.data[this.pos++]);return c},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(o){var l=this.pixelBitlength/8,c=new Uint8Array(this.width*this.height*l),d=0,f=this;if(o==null&&(o=this.imgData),o.length===0)return new Uint8Array(0);function u(g,p,m,j){var v,N,b,y,_,T,O,B,L,E,P,D,k,C,z,G,de,J,Z,oe,ne,me=Math.ceil((f.width-g)/m),be=Math.ceil((f.height-p)/j),A=f.width==me&&f.height==be;for(C=l*me,D=A?c:new Uint8Array(C*be),T=o.length,k=0,N=0;k<be&&d<T;){switch(o[d++]){case 0:for(y=de=0;de<C;y=de+=1)D[N++]=o[d++];break;case 1:for(y=J=0;J<C;y=J+=1)v=o[d++],_=y<l?0:D[N-l],D[N++]=(v+_)%256;break;case 2:for(y=Z=0;Z<C;y=Z+=1)v=o[d++],b=(y-y%l)/l,z=k&&D[(k-1)*C+b*l+y%l],D[N++]=(z+v)%256;break;case 3:for(y=oe=0;oe<C;y=oe+=1)v=o[d++],b=(y-y%l)/l,_=y<l?0:D[N-l],z=k&&D[(k-1)*C+b*l+y%l],D[N++]=(v+Math.floor((_+z)/2))%256;break;case 4:for(y=ne=0;ne<C;y=ne+=1)v=o[d++],b=(y-y%l)/l,_=y<l?0:D[N-l],k===0?z=G=0:(z=D[(k-1)*C+b*l+y%l],G=b&&D[(k-1)*C+(b-1)*l+y%l]),O=_+z-G,B=Math.abs(O-_),E=Math.abs(O-z),P=Math.abs(O-G),L=B<=E&&B<=P?_:E<=P?z:G,D[N++]=(v+L)%256;break;default:throw new Error("Invalid filter algorithm: "+o[d-1])}if(!A){var I=((p+k*j)*f.width+g)*l,R=k*C;for(y=0;y<me;y+=1){for(var M=0;M<l;M+=1)c[I++]=D[R++];I+=(m-1)*l}}k++}}return o=np(o),f.interlaceMethod==1?(u(0,0,8,8),u(4,0,8,8),u(0,4,4,8),u(2,0,4,4),u(0,2,2,4),u(1,0,2,2),u(0,1,1,2)):u(0,0,1,1),c},n.prototype.decodePalette=function(){var o,l,c,d,f,u,g,p,m;for(c=this.palette,u=this.transparency.indexed||[],f=new Uint8Array((u.length||0)+c.length),d=0,o=0,l=g=0,p=c.length;g<p;l=g+=3)f[d++]=c[l],f[d++]=c[l+1],f[d++]=c[l+2],f[d++]=(m=u[o++])!=null?m:255;return f},n.prototype.copyToImageData=function(o,l){var c,d,f,u,g,p,m,j,v,N,b;if(d=this.colors,v=null,c=this.hasAlphaChannel,this.palette.length&&(v=(b=this._decodedPalette)!=null?b:this._decodedPalette=this.decodePalette(),d=4,c=!0),j=(f=o.data||o).length,g=v||l,u=p=0,d===1)for(;u<j;)m=v?4*l[u/4]:p,N=g[m++],f[u++]=N,f[u++]=N,f[u++]=N,f[u++]=c?g[m++]:255,p=m;else for(;u<j;)m=v?4*l[u/4]:p,f[u++]=g[m++],f[u++]=g[m++],f[u++]=g[m++],f[u++]=c?g[m++]:255,p=m},n.prototype.decode=function(){var o;return o=new Uint8Array(this.width*this.height*4),this.copyToImageData(o,this.decodePixels()),o};var s=function(){if(Object.prototype.toString.call(yt)==="[object Window]"){try{r=yt.document.createElement("canvas"),t=r.getContext("2d")}catch{return!1}return!0}return!1};return s(),e=function(o){var l;if(s()===!0)return t.width=o.width,t.height=o.height,t.clearRect(0,0,o.width,o.height),t.putImageData(o,0,0),(l=new Image).src=r.toDataURL(),l;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(o){var l,c,d,f,u,g,p,m;if(this.animation){for(m=[],c=u=0,g=(p=this.animation.frames).length;u<g;c=++u)l=p[c],d=o.createImageData(l.width,l.height),f=this.decodePixels(new Uint8Array(l.data)),this.copyToImageData(d,f),l.imageData=d,m.push(l.image=e(d));return m}},n.prototype.renderFrame=function(o,l){var c,d,f;return c=(d=this.animation.frames)[l],f=d[l-1],l===0&&o.clearRect(0,0,this.width,this.height),(f!=null?f.disposeOp:void 0)===1?o.clearRect(f.xOffset,f.yOffset,f.width,f.height):(f!=null?f.disposeOp:void 0)===2&&o.putImageData(f.imageData,f.xOffset,f.yOffset),c.blendOp===0&&o.clearRect(c.xOffset,c.yOffset,c.width,c.height),o.drawImage(c.image,c.xOffset,c.yOffset)},n.prototype.animate=function(o){var l,c,d,f,u,g,p=this;return c=0,g=this.animation,f=g.numFrames,d=g.frames,u=g.numPlays,(l=function(){var m,j;if(m=c++%f,j=d[m],p.renderFrame(o,m),f>1&&c/f<u)return p.animation._timeout=setTimeout(l,j.delay)})()},n.prototype.stopAnimation=function(){var o;return clearTimeout((o=this.animation)!=null?o._timeout:void 0)},n.prototype.render=function(o){var l,c;return o._png&&o._png.stopAnimation(),o._png=this,o.width=this.width,o.height=this.height,l=o.getContext("2d"),this.animation?(this.decodeFrames(l),this.animate(l)):(c=l.createImageData(this.width,this.height),this.copyToImageData(c,this.decodePixels()),l.putImageData(c,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function Tp(e){var r=0;if(e[r++]!==71||e[r++]!==73||e[r++]!==70||e[r++]!==56||(e[r++]+1&253)!=56||e[r++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=e[r++]|e[r++]<<8,n=e[r++]|e[r++]<<8,s=e[r++],o=s>>7,l=1<<(7&s)+1;e[r++],e[r++];var c=null,d=null;o&&(c=r,d=l,r+=3*l);var f=!0,u=[],g=0,p=null,m=0,j=null;for(this.width=t,this.height=n;f&&r<e.length;)switch(e[r++]){case 33:switch(e[r++]){case 255:if(e[r]!==11||e[r+1]==78&&e[r+2]==69&&e[r+3]==84&&e[r+4]==83&&e[r+5]==67&&e[r+6]==65&&e[r+7]==80&&e[r+8]==69&&e[r+9]==50&&e[r+10]==46&&e[r+11]==48&&e[r+12]==3&&e[r+13]==1&&e[r+16]==0)r+=14,j=e[r++]|e[r++]<<8,r++;else for(r+=12;;){if(!((k=e[r++])>=0))throw Error("Invalid block size");if(k===0)break;r+=k}break;case 249:if(e[r++]!==4||e[r+4]!==0)throw new Error("Invalid graphics extension block.");var v=e[r++];g=e[r++]|e[r++]<<8,p=e[r++],!(1&v)&&(p=null),m=v>>2&7,r++;break;case 254:for(;;){if(!((k=e[r++])>=0))throw Error("Invalid block size");if(k===0)break;r+=k}break;default:throw new Error("Unknown graphic control label: 0x"+e[r-1].toString(16))}break;case 44:var N=e[r++]|e[r++]<<8,b=e[r++]|e[r++]<<8,y=e[r++]|e[r++]<<8,_=e[r++]|e[r++]<<8,T=e[r++],O=T>>6&1,B=1<<(7&T)+1,L=c,E=d,P=!1;T>>7&&(P=!0,L=r,E=B,r+=3*B);var D=r;for(r++;;){var k;if(!((k=e[r++])>=0))throw Error("Invalid block size");if(k===0)break;r+=k}u.push({x:N,y:b,width:y,height:_,has_local_palette:P,palette_offset:L,palette_size:E,data_offset:D,data_length:r-D,transparent_index:p,interlaced:!!O,delay:g,disposal:m});break;case 59:f=!1;break;default:throw new Error("Unknown gif block: 0x"+e[r-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return j},this.frameInfo=function(C){if(C<0||C>=u.length)throw new Error("Frame index out of range.");return u[C]},this.decodeAndBlitFrameBGRA=function(C,z){var G=this.frameInfo(C),de=G.width*G.height,J=new Uint8Array(de);_h(e,G.data_offset,J,de);var Z=G.palette_offset,oe=G.transparent_index;oe===null&&(oe=256);var ne=G.width,me=t-ne,be=ne,A=4*(G.y*t+G.x),I=4*((G.y+G.height)*t+G.x),R=A,M=4*me;G.interlaced===!0&&(M+=4*t*7);for(var K=8,he=0,fe=J.length;he<fe;++he){var ee=J[he];if(be===0&&(be=ne,(R+=M)>=I&&(M=4*me+4*t*(K-1),R=A+(ne+me)*(K<<1),K>>=1)),ee===oe)R+=4;else{var ve=e[Z+3*ee],Ce=e[Z+3*ee+1],De=e[Z+3*ee+2];z[R++]=De,z[R++]=Ce,z[R++]=ve,z[R++]=255}--be}},this.decodeAndBlitFrameRGBA=function(C,z){var G=this.frameInfo(C),de=G.width*G.height,J=new Uint8Array(de);_h(e,G.data_offset,J,de);var Z=G.palette_offset,oe=G.transparent_index;oe===null&&(oe=256);var ne=G.width,me=t-ne,be=ne,A=4*(G.y*t+G.x),I=4*((G.y+G.height)*t+G.x),R=A,M=4*me;G.interlaced===!0&&(M+=4*t*7);for(var K=8,he=0,fe=J.length;he<fe;++he){var ee=J[he];if(be===0&&(be=ne,(R+=M)>=I&&(M=4*me+4*t*(K-1),R=A+(ne+me)*(K<<1),K>>=1)),ee===oe)R+=4;else{var ve=e[Z+3*ee],Ce=e[Z+3*ee+1],De=e[Z+3*ee+2];z[R++]=ve,z[R++]=Ce,z[R++]=De,z[R++]=255}--be}}}function _h(e,r,t,n){for(var s=e[r++],o=1<<s,l=o+1,c=l+1,d=s+1,f=(1<<d)-1,u=0,g=0,p=0,m=e[r++],j=new Int32Array(4096),v=null;;){for(;u<16&&m!==0;)g|=e[r++]<<u,u+=8,m===1?m=e[r++]:--m;if(u<d)break;var N=g&f;if(g>>=d,u-=d,N!==o){if(N===l)break;for(var b=N<c?N:v,y=0,_=b;_>o;)_=j[_]>>8,++y;var T=_;if(p+y+(b!==N?1:0)>n)return void tr.log("Warning, gif stream longer than expected.");t[p++]=T;var O=p+=y;for(b!==N&&(t[p++]=T),_=b;y--;)_=j[_],t[--O]=255&_,_>>=8;v!==null&&c<4096&&(j[c++]=v<<8|T,c>=f+1&&d<12&&(++d,f=f<<1|1)),v=N}else c=l+1,f=(1<<(d=s+1))-1,v=null}return p!==n&&tr.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function j0(e){var r,t,n,s,o,l=Math.floor,c=new Array(64),d=new Array(64),f=new Array(64),u=new Array(64),g=new Array(65535),p=new Array(65535),m=new Array(64),j=new Array(64),v=[],N=0,b=7,y=new Array(64),_=new Array(64),T=new Array(64),O=new Array(256),B=new Array(2048),L=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],E=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],P=[0,1,2,3,4,5,6,7,8,9,10,11],D=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],k=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],C=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],z=[0,1,2,3,4,5,6,7,8,9,10,11],G=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],de=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function J(A,I){for(var R=0,M=0,K=new Array,he=1;he<=16;he++){for(var fe=1;fe<=A[he];fe++)K[I[M]]=[],K[I[M]][0]=R,K[I[M]][1]=he,M++,R++;R*=2}return K}function Z(A){for(var I=A[0],R=A[1]-1;R>=0;)I&1<<R&&(N|=1<<b),R--,--b<0&&(N==255?(oe(255),oe(0)):oe(N),b=7,N=0)}function oe(A){v.push(A)}function ne(A){oe(A>>8&255),oe(255&A)}function me(A,I,R,M,K){for(var he,fe=K[0],ee=K[240],ve=function(qe,Xe){var tt,at,ht,ft,wt,kt,Lt,Ft,vt,Ct,st=0;for(vt=0;vt<8;++vt){tt=qe[st],at=qe[st+1],ht=qe[st+2],ft=qe[st+3],wt=qe[st+4],kt=qe[st+5],Lt=qe[st+6];var Fr=tt+(Ft=qe[st+7]),Ot=tt-Ft,ma=at+Lt,Wt=at-Lt,ar=ht+kt,Ba=ht-kt,Dt=ft+wt,vn=ft-wt,ir=Fr+Dt,_a=Fr-Dt,Ja=ma+ar,Qt=ma-ar;qe[st]=ir+Ja,qe[st+4]=ir-Ja;var Nt=.707106781*(Qt+_a);qe[st+2]=_a+Nt,qe[st+6]=_a-Nt;var Bt=.382683433*((ir=vn+Ba)-(Qt=Wt+Ot)),Fn=.5411961*ir+Bt,Pr=1.306562965*Qt+Bt,Ma=.707106781*(Ja=Ba+Wt),Ua=Ot+Ma,mt=Ot-Ma;qe[st+5]=mt+Fn,qe[st+3]=mt-Fn,qe[st+1]=Ua+Pr,qe[st+7]=Ua-Pr,st+=8}for(st=0,vt=0;vt<8;++vt){tt=qe[st],at=qe[st+8],ht=qe[st+16],ft=qe[st+24],wt=qe[st+32],kt=qe[st+40],Lt=qe[st+48];var Aa=tt+(Ft=qe[st+56]),xa=tt-Ft,Zr=at+Lt,gr=at-Lt,dr=ht+kt,q=ht-kt,se=ft+wt,Q=ft-wt,te=Aa+se,ae=Aa-se,ie=Zr+dr,Se=Zr-dr;qe[st]=te+ie,qe[st+32]=te-ie;var Le=.707106781*(Se+ae);qe[st+16]=ae+Le,qe[st+48]=ae-Le;var je=.382683433*((te=Q+q)-(Se=gr+xa)),ke=.5411961*te+je,Te=1.306562965*Se+je,Ge=.707106781*(ie=q+gr),Je=xa+Ge,ot=xa-Ge;qe[st+40]=ot+ke,qe[st+24]=ot-ke,qe[st+8]=Je+Te,qe[st+56]=Je-Te,st++}for(vt=0;vt<64;++vt)Ct=qe[vt]*Xe[vt],m[vt]=Ct>0?Ct+.5|0:Ct-.5|0;return m}(A,I),Ce=0;Ce<64;++Ce)j[L[Ce]]=ve[Ce];var De=j[0]-R;R=j[0],De==0?Z(M[0]):(Z(M[p[he=32767+De]]),Z(g[he]));for(var $e=63;$e>0&&j[$e]==0;)$e--;if($e==0)return Z(fe),R;for(var Ke,Ee=1;Ee<=$e;){for(var le=Ee;j[Ee]==0&&Ee<=$e;)++Ee;var He=Ee-le;if(He>=16){Ke=He>>4;for(var et=1;et<=Ke;++et)Z(ee);He&=15}he=32767+j[Ee],Z(K[(He<<4)+p[he]]),Z(g[he]),Ee++}return $e!=63&&Z(fe),R}function be(A){A=Math.min(Math.max(A,1),100),o!=A&&(function(I){for(var R=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],M=0;M<64;M++){var K=l((R[M]*I+50)/100);K=Math.min(Math.max(K,1),255),c[L[M]]=K}for(var he=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],fe=0;fe<64;fe++){var ee=l((he[fe]*I+50)/100);ee=Math.min(Math.max(ee,1),255),d[L[fe]]=ee}for(var ve=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ce=0,De=0;De<8;De++)for(var $e=0;$e<8;$e++)f[Ce]=1/(c[L[Ce]]*ve[De]*ve[$e]*8),u[Ce]=1/(d[L[Ce]]*ve[De]*ve[$e]*8),Ce++}(A<50?Math.floor(5e3/A):Math.floor(200-2*A)),o=A)}this.encode=function(A,I){I&&be(I),v=new Array,N=0,b=7,ne(65496),ne(65504),ne(16),oe(74),oe(70),oe(73),oe(70),oe(0),oe(1),oe(1),oe(0),ne(1),ne(1),oe(0),oe(0),function(){ne(65499),ne(132),oe(0);for(var at=0;at<64;at++)oe(c[at]);oe(1);for(var ht=0;ht<64;ht++)oe(d[ht])}(),function(at,ht){ne(65472),ne(17),oe(8),ne(ht),ne(at),oe(3),oe(1),oe(17),oe(0),oe(2),oe(17),oe(1),oe(3),oe(17),oe(1)}(A.width,A.height),function(){ne(65476),ne(418),oe(0);for(var at=0;at<16;at++)oe(E[at+1]);for(var ht=0;ht<=11;ht++)oe(P[ht]);oe(16);for(var ft=0;ft<16;ft++)oe(D[ft+1]);for(var wt=0;wt<=161;wt++)oe(k[wt]);oe(1);for(var kt=0;kt<16;kt++)oe(C[kt+1]);for(var Lt=0;Lt<=11;Lt++)oe(z[Lt]);oe(17);for(var Ft=0;Ft<16;Ft++)oe(G[Ft+1]);for(var vt=0;vt<=161;vt++)oe(de[vt])}(),ne(65498),ne(12),oe(3),oe(1),oe(0),oe(2),oe(17),oe(3),oe(17),oe(0),oe(63),oe(0);var R=0,M=0,K=0;N=0,b=7,this.encode.displayName="_encode_";for(var he,fe,ee,ve,Ce,De,$e,Ke,Ee,le=A.data,He=A.width,et=A.height,qe=4*He,Xe=0;Xe<et;){for(he=0;he<qe;){for(Ce=qe*Xe+he,$e=-1,Ke=0,Ee=0;Ee<64;Ee++)De=Ce+(Ke=Ee>>3)*qe+($e=4*(7&Ee)),Xe+Ke>=et&&(De-=qe*(Xe+1+Ke-et)),he+$e>=qe&&(De-=he+$e-qe+4),fe=le[De++],ee=le[De++],ve=le[De++],y[Ee]=(B[fe]+B[ee+256>>0]+B[ve+512>>0]>>16)-128,_[Ee]=(B[fe+768>>0]+B[ee+1024>>0]+B[ve+1280>>0]>>16)-128,T[Ee]=(B[fe+1280>>0]+B[ee+1536>>0]+B[ve+1792>>0]>>16)-128;R=me(y,f,R,r,n),M=me(_,u,M,t,s),K=me(T,u,K,t,s),he+=32}Xe+=8}if(b>=0){var tt=[];tt[1]=b+1,tt[0]=(1<<b+1)-1,Z(tt)}return ne(65497),new Uint8Array(v)},e=e||50,function(){for(var A=String.fromCharCode,I=0;I<256;I++)O[I]=A(I)}(),r=J(E,P),t=J(C,z),n=J(D,k),s=J(G,de),function(){for(var A=1,I=2,R=1;R<=15;R++){for(var M=A;M<I;M++)p[32767+M]=R,g[32767+M]=[],g[32767+M][1]=R,g[32767+M][0]=M;for(var K=-(I-1);K<=-A;K++)p[32767+K]=R,g[32767+K]=[],g[32767+K][1]=R,g[32767+K][0]=I-1+K;A<<=1,I<<=1}}(),function(){for(var A=0;A<256;A++)B[A]=19595*A,B[A+256>>0]=38470*A,B[A+512>>0]=7471*A+32768,B[A+768>>0]=-11059*A,B[A+1024>>0]=-21709*A,B[A+1280>>0]=32768*A+8421375,B[A+1536>>0]=-27439*A,B[A+1792>>0]=-5329*A}(),be(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function on(e,r){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!r,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Ah(e){function r(E){if(!E)throw Error("assert :P")}function t(E,P,D){for(var k=0;4>k;k++)if(E[P+k]!=D.charCodeAt(k))return!0;return!1}function n(E,P,D,k,C){for(var z=0;z<C;z++)E[P+z]=D[k+z]}function s(E,P,D,k){for(var C=0;C<k;C++)E[P+C]=D}function o(E){return new Int32Array(E)}function l(E,P){for(var D=[],k=0;k<E;k++)D.push(new P);return D}function c(E,P){var D=[];return function k(C,z,G){for(var de=G[z],J=0;J<de&&(C.push(G.length>z+1?[]:new P),!(G.length<z+1));J++)k(C[J],z+1,G)}(D,0,E),D}var d=function(){var E=this;function P(h,x){for(var S=1<<x-1>>>0;h&S;)S>>>=1;return S?(h&S-1)+S:h}function D(h,x,S,F,U){r(!(F%S));do h[x+(F-=S)]=U;while(0<F)}function k(h,x,S,F,U){if(r(2328>=U),512>=U)var W=o(512);else if((W=o(U))==null)return 0;return function(V,Y,X,re,xe,_e){var Ae,we,Ue=Y,Fe=1<<X,pe=o(16),ye=o(16);for(r(xe!=0),r(re!=null),r(V!=null),r(0<X),we=0;we<xe;++we){if(15<re[we])return 0;++pe[re[we]]}if(pe[0]==xe)return 0;for(ye[1]=0,Ae=1;15>Ae;++Ae){if(pe[Ae]>1<<Ae)return 0;ye[Ae+1]=ye[Ae]+pe[Ae]}for(we=0;we<xe;++we)Ae=re[we],0<re[we]&&(_e[ye[Ae]++]=we);if(ye[15]==1)return(re=new C).g=0,re.value=_e[0],D(V,Ue,1,Fe,re),Fe;var Be,ze=-1,Me=Fe-1,ct=0,rt=1,xt=1,nt=1<<X;for(we=0,Ae=1,xe=2;Ae<=X;++Ae,xe<<=1){if(rt+=xt<<=1,0>(xt-=pe[Ae]))return 0;for(;0<pe[Ae];--pe[Ae])(re=new C).g=Ae,re.value=_e[we++],D(V,Ue+ct,xe,nt,re),ct=P(ct,Ae)}for(Ae=X+1,xe=2;15>=Ae;++Ae,xe<<=1){if(rt+=xt<<=1,0>(xt-=pe[Ae]))return 0;for(;0<pe[Ae];--pe[Ae]){if(re=new C,(ct&Me)!=ze){for(Ue+=nt,Be=1<<(ze=Ae)-X;15>ze&&!(0>=(Be-=pe[ze]));)++ze,Be<<=1;Fe+=nt=1<<(Be=ze-X),V[Y+(ze=ct&Me)].g=Be+X,V[Y+ze].value=Ue-Y-ze}re.g=Ae-X,re.value=_e[we++],D(V,Ue+(ct>>X),xe,nt,re),ct=P(ct,Ae)}}return rt!=2*ye[15]-1?0:Fe}(h,x,S,F,U,W)}function C(){this.value=this.g=0}function z(){this.value=this.g=0}function G(){this.G=l(5,C),this.H=o(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=l(qr,z)}function de(h,x,S,F){r(h!=null),r(x!=null),r(2147483648>F),h.Ca=254,h.I=0,h.b=-8,h.Ka=0,h.oa=x,h.pa=S,h.Jd=x,h.Yc=S+F,h.Zc=4<=F?S+F-4+1:S,he(h)}function J(h,x){for(var S=0;0<x--;)S|=ee(h,128)<<x;return S}function Z(h,x){var S=J(h,x);return fe(h)?-S:S}function oe(h,x,S,F){var U,W=0;for(r(h!=null),r(x!=null),r(4294967288>F),h.Sb=F,h.Ra=0,h.u=0,h.h=0,4<F&&(F=4),U=0;U<F;++U)W+=x[S+U]<<8*U;h.Ra=W,h.bb=F,h.oa=x,h.pa=S}function ne(h){for(;8<=h.u&&h.bb<h.Sb;)h.Ra>>>=8,h.Ra+=h.oa[h.pa+h.bb]<<di-8>>>0,++h.bb,h.u-=8;R(h)&&(h.h=1,h.u=0)}function me(h,x){if(r(0<=x),!h.h&&x<=ci){var S=I(h)&li[x];return h.u+=x,ne(h),S}return h.h=1,h.u=0}function be(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function A(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function I(h){return h.Ra>>>(h.u&di-1)>>>0}function R(h){return r(h.bb<=h.Sb),h.h||h.bb==h.Sb&&h.u>di}function M(h,x){h.u=x,h.h=R(h)}function K(h){h.u>=no&&(r(h.u>=no),ne(h))}function he(h){r(h!=null&&h.oa!=null),h.pa<h.Zc?(h.I=(h.oa[h.pa++]|h.I<<8)>>>0,h.b+=8):(r(h!=null&&h.oa!=null),h.pa<h.Yc?(h.b+=8,h.I=h.oa[h.pa++]|h.I<<8):h.Ka?h.b=0:(h.I<<=8,h.b+=8,h.Ka=1))}function fe(h){return J(h,1)}function ee(h,x){var S=h.Ca;0>h.b&&he(h);var F=h.b,U=S*x>>>8,W=(h.I>>>F>U)+0;for(W?(S-=U,h.I-=U+1<<F>>>0):S=U+1,F=S,U=0;256<=F;)U+=8,F>>=8;return F=7^U+ga[F],h.b-=F,h.Ca=(S<<F)-1,W}function ve(h,x,S){h[x+0]=S>>24&255,h[x+1]=S>>16&255,h[x+2]=S>>8&255,h[x+3]=S>>0&255}function Ce(h,x){return h[x+0]<<0|h[x+1]<<8}function De(h,x){return Ce(h,x)|h[x+2]<<16}function $e(h,x){return Ce(h,x)|Ce(h,x+2)<<16}function Ke(h,x){var S=1<<x;return r(h!=null),r(0<x),h.X=o(S),h.X==null?0:(h.Mb=32-x,h.Xa=x,1)}function Ee(h,x){r(h!=null),r(x!=null),r(h.Xa==x.Xa),n(x.X,0,h.X,0,1<<x.Xa)}function le(){this.X=[],this.Xa=this.Mb=0}function He(h,x,S,F){r(S!=null),r(F!=null);var U=S[0],W=F[0];return U==0&&(U=(h*W+x/2)/x),W==0&&(W=(x*U+h/2)/h),0>=U||0>=W?0:(S[0]=U,F[0]=W,1)}function et(h,x){return h+(1<<x)-1>>>x}function qe(h,x){return((4278255360&h)+(4278255360&x)>>>0&4278255360)+((16711935&h)+(16711935&x)>>>0&16711935)>>>0}function Xe(h,x){E[x]=function(S,F,U,W,V,Y,X){var re;for(re=0;re<V;++re){var xe=E[h](Y[X+re-1],U,W+re);Y[X+re]=qe(S[F+re],xe)}}}function tt(){this.ud=this.hd=this.jd=0}function at(h,x){return((4278124286&(h^x))>>>1)+(h&x)>>>0}function ht(h){return 0<=h&&256>h?h:0>h?0:255<h?255:void 0}function ft(h,x){return ht(h+(h-x+.5>>1))}function wt(h,x,S){return Math.abs(x-S)-Math.abs(h-S)}function kt(h,x,S,F,U,W,V){for(F=W[V-1],S=0;S<U;++S)W[V+S]=F=qe(h[x+S],F)}function Lt(h,x,S,F,U){var W;for(W=0;W<S;++W){var V=h[x+W],Y=V>>8&255,X=16711935&(X=(X=16711935&V)+((Y<<16)+Y));F[U+W]=(4278255360&V)+X>>>0}}function Ft(h,x){x.jd=h>>0&255,x.hd=h>>8&255,x.ud=h>>16&255}function vt(h,x,S,F,U,W){var V;for(V=0;V<F;++V){var Y=x[S+V],X=Y>>>8,re=Y,xe=255&(xe=(xe=Y>>>16)+((h.jd<<24>>24)*(X<<24>>24)>>>5));re=255&(re=(re=re+((h.hd<<24>>24)*(X<<24>>24)>>>5))+((h.ud<<24>>24)*(xe<<24>>24)>>>5)),U[W+V]=(4278255360&Y)+(xe<<16)+re}}function Ct(h,x,S,F,U){E[x]=function(W,V,Y,X,re,xe,_e,Ae,we){for(X=_e;X<Ae;++X)for(_e=0;_e<we;++_e)re[xe++]=U(Y[F(W[V++])])},E[h]=function(W,V,Y,X,re,xe,_e){var Ae=8>>W.b,we=W.Ea,Ue=W.K[0],Fe=W.w;if(8>Ae)for(W=(1<<W.b)-1,Fe=(1<<Ae)-1;V<Y;++V){var pe,ye=0;for(pe=0;pe<we;++pe)pe&W||(ye=F(X[re++])),xe[_e++]=U(Ue[ye&Fe]),ye>>=Ae}else E["VP8LMapColor"+S](X,re,Ue,Fe,xe,_e,V,Y,we)}}function st(h,x,S,F,U){for(S=x+S;x<S;){var W=h[x++];F[U++]=W>>16&255,F[U++]=W>>8&255,F[U++]=W>>0&255}}function Fr(h,x,S,F,U){for(S=x+S;x<S;){var W=h[x++];F[U++]=W>>16&255,F[U++]=W>>8&255,F[U++]=W>>0&255,F[U++]=W>>24&255}}function Ot(h,x,S,F,U){for(S=x+S;x<S;){var W=(V=h[x++])>>16&240|V>>12&15,V=V>>0&240|V>>28&15;F[U++]=W,F[U++]=V}}function ma(h,x,S,F,U){for(S=x+S;x<S;){var W=(V=h[x++])>>16&248|V>>13&7,V=V>>5&224|V>>3&31;F[U++]=W,F[U++]=V}}function Wt(h,x,S,F,U){for(S=x+S;x<S;){var W=h[x++];F[U++]=W>>0&255,F[U++]=W>>8&255,F[U++]=W>>16&255}}function ar(h,x,S,F,U,W){if(W==0)for(S=x+S;x<S;)ve(F,((W=h[x++])[0]>>24|W[1]>>8&65280|W[2]<<8&16711680|W[3]<<24)>>>0),U+=32;else n(F,U,h,x,S)}function Ba(h,x){E[x][0]=E[h+"0"],E[x][1]=E[h+"1"],E[x][2]=E[h+"2"],E[x][3]=E[h+"3"],E[x][4]=E[h+"4"],E[x][5]=E[h+"5"],E[x][6]=E[h+"6"],E[x][7]=E[h+"7"],E[x][8]=E[h+"8"],E[x][9]=E[h+"9"],E[x][10]=E[h+"10"],E[x][11]=E[h+"11"],E[x][12]=E[h+"12"],E[x][13]=E[h+"13"],E[x][14]=E[h+"0"],E[x][15]=E[h+"0"]}function Dt(h){return h==Yc||h==Kc||h==bl||h==Xc}function vn(){this.eb=[],this.size=this.A=this.fb=0}function ir(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function _a(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new vn,this.f.kb=new ir,this.sd=null}function Ja(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Qt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Nt(h){return alert("todo:WebPSamplerProcessPlane"),h.T}function Bt(h,x){var S=h.T,F=x.ba.f.RGBA,U=F.eb,W=F.fb+h.ka*F.A,V=Ga[x.ba.S],Y=h.y,X=h.O,re=h.f,xe=h.N,_e=h.ea,Ae=h.W,we=x.cc,Ue=x.dc,Fe=x.Mc,pe=x.Nc,ye=h.ka,Be=h.ka+h.T,ze=h.U,Me=ze+1>>1;for(ye==0?V(Y,X,null,null,re,xe,_e,Ae,re,xe,_e,Ae,U,W,null,null,ze):(V(x.ec,x.fc,Y,X,we,Ue,Fe,pe,re,xe,_e,Ae,U,W-F.A,U,W,ze),++S);ye+2<Be;ye+=2)we=re,Ue=xe,Fe=_e,pe=Ae,xe+=h.Rc,Ae+=h.Rc,W+=2*F.A,V(Y,(X+=2*h.fa)-h.fa,Y,X,we,Ue,Fe,pe,re,xe,_e,Ae,U,W-F.A,U,W,ze);return X+=h.fa,h.j+Be<h.o?(n(x.ec,x.fc,Y,X,ze),n(x.cc,x.dc,re,xe,Me),n(x.Mc,x.Nc,_e,Ae,Me),S--):1&Be||V(Y,X,null,null,re,xe,_e,Ae,re,xe,_e,Ae,U,W+F.A,null,null,ze),S}function Fn(h,x,S){var F=h.F,U=[h.J];if(F!=null){var W=h.U,V=x.ba.S,Y=V==yl||V==bl;x=x.ba.f.RGBA;var X=[0],re=h.ka;X[0]=h.T,h.Kb&&(re==0?--X[0]:(--re,U[0]-=h.width),h.j+h.ka+h.T==h.o&&(X[0]=h.o-h.j-re));var xe=x.eb;re=x.fb+re*x.A,h=sr(F,U[0],h.width,W,X,xe,re+(Y?0:3),x.A),r(S==X),h&&Dt(V)&&qa(xe,re,Y,W,X,x.A)}return 0}function Pr(h){var x=h.ma,S=x.ba.S,F=11>S,U=S==gl||S==vl||S==yl||S==$c||S==12||Dt(S);if(x.memory=null,x.Ib=null,x.Jb=null,x.Nd=null,!ro(x.Oa,h,U?11:12))return 0;if(U&&Dt(S)&&Ve(),h.da)alert("todo:use_scaling");else{if(F){if(x.Ib=Nt,h.Kb){if(S=h.U+1>>1,x.memory=o(h.U+2*S),x.memory==null)return 0;x.ec=x.memory,x.fc=0,x.cc=x.ec,x.dc=x.fc+h.U,x.Mc=x.cc,x.Nc=x.dc+S,x.Ib=Bt,Ve()}}else alert("todo:EmitYUV");U&&(x.Jb=Fn,F&&Ne())}if(F&&!Fd){for(h=0;256>h;++h)U1[h]=89858*(h-128)+Nl>>wl,z1[h]=-22014*(h-128)+Nl,W1[h]=-45773*(h-128),H1[h]=113618*(h-128)+Nl>>wl;for(h=fo;h<Qc;++h)x=76283*(h-16)+Nl>>wl,q1[h-fo]=Ta(x,255),V1[h-fo]=Ta(x+8>>4,15);Fd=1}return 1}function Ma(h){var x=h.ma,S=h.U,F=h.T;return r(!(1&h.ka)),0>=S||0>=F?0:(S=x.Ib(h,x),x.Jb!=null&&x.Jb(h,x,S),x.Dc+=S,1)}function Ua(h){h.ma.memory=null}function mt(h,x,S,F){return me(h,8)!=47?0:(x[0]=me(h,14)+1,S[0]=me(h,14)+1,F[0]=me(h,1),me(h,3)!=0?0:!h.h)}function Aa(h,x){if(4>h)return h+1;var S=h-2>>1;return(2+(1&h)<<S)+me(x,S)+1}function xa(h,x){return 120<x?x-120:1<=(S=((S=A1[x-1])>>4)*h+(8-(15&S)))?S:1;var S}function Zr(h,x,S){var F=I(S),U=h[x+=255&F].g-8;return 0<U&&(M(S,S.u+8),F=I(S),x+=h[x].value,x+=F&(1<<U)-1),M(S,S.u+h[x].g),h[x].value}function gr(h,x,S){return S.g+=h.g,S.value+=h.value<<x>>>0,r(8>=S.g),h.g}function dr(h,x,S){var F=h.xc;return r((x=F==0?0:h.vc[h.md*(S>>F)+(x>>F)])<h.Wb),h.Ya[x]}function q(h,x,S,F){var U=h.ab,W=h.c*x,V=h.C;x=V+x;var Y=S,X=F;for(F=h.Ta,S=h.Ua;0<U--;){var re=h.gc[U],xe=V,_e=x,Ae=Y,we=X,Ue=(X=F,Y=S,re.Ea);switch(r(xe<_e),r(_e<=re.nc),re.hc){case 2:dl(Ae,we,(_e-xe)*Ue,X,Y);break;case 0:var Fe=xe,pe=_e,ye=X,Be=Y,ze=(nt=re).Ea;Fe==0&&(Vc(Ae,we,null,null,1,ye,Be),kt(Ae,we+1,0,0,ze-1,ye,Be+1),we+=ze,Be+=ze,++Fe);for(var Me=1<<nt.b,ct=Me-1,rt=et(ze,nt.b),xt=nt.K,nt=nt.w+(Fe>>nt.b)*rt;Fe<pe;){var Ut=xt,qt=nt,Rt=1;for(so(Ae,we,ye,Be-ze,1,ye,Be);Rt<ze;){var Pt=(Rt&~ct)+Me;Pt>ze&&(Pt=ze),(0,Qn[Ut[qt++]>>8&15])(Ae,we+ +Rt,ye,Be+Rt-ze,Pt-Rt,ye,Be+Rt),Rt=Pt}we+=ze,Be+=ze,++Fe&ct||(nt+=rt)}_e!=re.nc&&n(X,Y-Ue,X,Y+(_e-xe-1)*Ue,Ue);break;case 1:for(Ue=Ae,pe=we,ze=(Ae=re.Ea)-(Be=Ae&~(ye=(we=1<<re.b)-1)),Fe=et(Ae,re.b),Me=re.K,re=re.w+(xe>>re.b)*Fe;xe<_e;){for(ct=Me,rt=re,xt=new tt,nt=pe+Be,Ut=pe+Ae;pe<nt;)Ft(ct[rt++],xt),Cs(xt,Ue,pe,we,X,Y),pe+=we,Y+=we;pe<Ut&&(Ft(ct[rt++],xt),Cs(xt,Ue,pe,ze,X,Y),pe+=ze,Y+=ze),++xe&ye||(re+=Fe)}break;case 3:if(Ae==X&&we==Y&&0<re.b){for(pe=X,Ae=Ue=Y+(_e-xe)*Ue-(Be=(_e-xe)*et(re.Ea,re.b)),we=X,ye=Y,Fe=[],Be=(ze=Be)-1;0<=Be;--Be)Fe[Be]=we[ye+Be];for(Be=ze-1;0<=Be;--Be)pe[Ae+Be]=Fe[Be];Ha(re,xe,_e,X,Ue,X,Y)}else Ha(re,xe,_e,Ae,we,X,Y)}Y=F,X=S}X!=S&&n(F,S,Y,X,W)}function se(h,x){var S=h.V,F=h.Ba+h.c*h.C,U=x-h.C;if(r(x<=h.l.o),r(16>=U),0<U){var W=h.l,V=h.Ta,Y=h.Ua,X=W.width;if(q(h,U,S,F),U=Y=[Y],r((S=h.C)<(F=x)),r(W.v<W.va),F>W.o&&(F=W.o),S<W.j){var re=W.j-S;S=W.j,U[0]+=re*X}if(S>=F?S=0:(U[0]+=4*W.v,W.ka=S-W.j,W.U=W.va-W.v,W.T=F-S,S=1),S){if(Y=Y[0],11>(S=h.ca).S){var xe=S.f.RGBA,_e=(F=S.S,U=W.U,W=W.T,re=xe.eb,xe.A),Ae=W;for(xe=xe.fb+h.Ma*xe.A;0<Ae--;){var we=V,Ue=Y,Fe=U,pe=re,ye=xe;switch(F){case pl:va(we,Ue,Fe,pe,ye);break;case gl:la(we,Ue,Fe,pe,ye);break;case Yc:la(we,Ue,Fe,pe,ye),qa(pe,ye,0,Fe,1,0);break;case jd:Rn(we,Ue,Fe,pe,ye);break;case vl:ar(we,Ue,Fe,pe,ye,1);break;case Kc:ar(we,Ue,Fe,pe,ye,1),qa(pe,ye,0,Fe,1,0);break;case yl:ar(we,Ue,Fe,pe,ye,0);break;case bl:ar(we,Ue,Fe,pe,ye,0),qa(pe,ye,1,Fe,1,0);break;case $c:es(we,Ue,Fe,pe,ye);break;case Xc:es(we,Ue,Fe,pe,ye),nr(pe,ye,Fe,1,0);break;case Sd:Dn(we,Ue,Fe,pe,ye);break;default:r(0)}Y+=X,xe+=_e}h.Ma+=W}else alert("todo:EmitRescaledRowsYUVA");r(h.Ma<=S.height)}}h.C=x,r(h.C<=h.i)}function Q(h){var x;if(0<h.ua)return 0;for(x=0;x<h.Wb;++x){var S=h.Ya[x].G,F=h.Ya[x].H;if(0<S[1][F[1]+0].g||0<S[2][F[2]+0].g||0<S[3][F[3]+0].g)return 0}return 1}function te(h,x,S,F,U,W){if(h.Z!=0){var V=h.qd,Y=h.rd;for(r(ns[h.Z]!=null);x<S;++x)ns[h.Z](V,Y,F,U,F,U,W),V=F,Y=U,U+=W;h.qd=V,h.rd=Y}}function ae(h,x){var S=h.l.ma,F=S.Z==0||S.Z==1?h.l.j:h.C;if(F=h.C<F?F:h.C,r(x<=h.l.o),x>F){var U=h.l.width,W=S.ca,V=S.tb+U*F,Y=h.V,X=h.Ba+h.c*F,re=h.gc;r(h.ab==1),r(re[0].hc==3),hl(re[0],F,x,Y,X,W,V),te(S,F,x,W,V,U)}h.C=h.Ma=x}function ie(h,x,S,F,U,W,V){var Y=h.$/F,X=h.$%F,re=h.m,xe=h.s,_e=S+h.$,Ae=_e;U=S+F*U;var we=S+F*W,Ue=280+xe.ua,Fe=h.Pb?Y:16777216,pe=0<xe.ua?xe.Wa:null,ye=xe.wc,Be=_e<we?dr(xe,X,Y):null;r(h.C<W),r(we<=U);var ze=!1;e:for(;;){for(;ze||_e<we;){var Me=0;if(Y>=Fe){var ct=_e-S;r((Fe=h).Pb),Fe.wd=Fe.m,Fe.xd=ct,0<Fe.s.ua&&Ee(Fe.s.Wa,Fe.s.vb),Fe=Y+T1}if(X&ye||(Be=dr(xe,X,Y)),r(Be!=null),Be.Qb&&(x[_e]=Be.qb,ze=!0),!ze)if(K(re),Be.jc){Me=re,ct=x;var rt=_e,xt=Be.pd[I(Me)&qr-1];r(Be.jc),256>xt.g?(M(Me,Me.u+xt.g),ct[rt]=xt.value,Me=0):(M(Me,Me.u+xt.g-256),r(256<=xt.value),Me=xt.value),Me==0&&(ze=!0)}else Me=Zr(Be.G[0],Be.H[0],re);if(re.h)break;if(ze||256>Me){if(!ze)if(Be.nd)x[_e]=(Be.qb|Me<<8)>>>0;else{if(K(re),ze=Zr(Be.G[1],Be.H[1],re),K(re),ct=Zr(Be.G[2],Be.H[2],re),rt=Zr(Be.G[3],Be.H[3],re),re.h)break;x[_e]=(rt<<24|ze<<16|Me<<8|ct)>>>0}if(ze=!1,++_e,++X>=F&&(X=0,++Y,V!=null&&Y<=W&&!(Y%16)&&V(h,Y),pe!=null))for(;Ae<_e;)Me=x[Ae++],pe.X[(506832829*Me&4294967295)>>>pe.Mb]=Me}else if(280>Me){if(Me=Aa(Me-256,re),ct=Zr(Be.G[4],Be.H[4],re),K(re),ct=xa(F,ct=Aa(ct,re)),re.h)break;if(_e-S<ct||U-_e<Me)break e;for(rt=0;rt<Me;++rt)x[_e+rt]=x[_e+rt-ct];for(_e+=Me,X+=Me;X>=F;)X-=F,++Y,V!=null&&Y<=W&&!(Y%16)&&V(h,Y);if(r(_e<=U),X&ye&&(Be=dr(xe,X,Y)),pe!=null)for(;Ae<_e;)Me=x[Ae++],pe.X[(506832829*Me&4294967295)>>>pe.Mb]=Me}else{if(!(Me<Ue))break e;for(ze=Me-280,r(pe!=null);Ae<_e;)Me=x[Ae++],pe.X[(506832829*Me&4294967295)>>>pe.Mb]=Me;Me=_e,r(!(ze>>>(ct=pe).Xa)),x[Me]=ct.X[ze],ze=!0}ze||r(re.h==R(re))}if(h.Pb&&re.h&&_e<U)r(h.m.h),h.a=5,h.m=h.wd,h.$=h.xd,0<h.s.ua&&Ee(h.s.vb,h.s.Wa);else{if(re.h)break e;V!=null&&V(h,Y>W?W:Y),h.a=0,h.$=_e-S}return 1}return h.a=3,0}function Se(h){r(h!=null),h.vc=null,h.yc=null,h.Ya=null;var x=h.Wa;x!=null&&(x.X=null),h.vb=null,r(h!=null)}function Le(){var h=new qc;return h==null?null:(h.a=0,h.xb=kd,Ba("Predictor","VP8LPredictors"),Ba("Predictor","VP8LPredictors_C"),Ba("PredictorAdd","VP8LPredictorsAdd"),Ba("PredictorAdd","VP8LPredictorsAdd_C"),dl=Lt,Cs=vt,va=st,la=Fr,es=Ot,Dn=ma,Rn=Wt,E.VP8LMapColor32b=hi,E.VP8LMapColor8b=fl,h)}function je(h,x,S,F,U){var W=1,V=[h],Y=[x],X=F.m,re=F.s,xe=null,_e=0;e:for(;;){if(S)for(;W&&me(X,1);){var Ae=V,we=Y,Ue=F,Fe=1,pe=Ue.m,ye=Ue.gc[Ue.ab],Be=me(pe,2);if(Ue.Oc&1<<Be)W=0;else{switch(Ue.Oc|=1<<Be,ye.hc=Be,ye.Ea=Ae[0],ye.nc=we[0],ye.K=[null],++Ue.ab,r(4>=Ue.ab),Be){case 0:case 1:ye.b=me(pe,3)+2,Fe=je(et(ye.Ea,ye.b),et(ye.nc,ye.b),0,Ue,ye.K),ye.K=ye.K[0];break;case 3:var ze,Me=me(pe,8)+1,ct=16<Me?0:4<Me?1:2<Me?2:3;if(Ae[0]=et(ye.Ea,ct),ye.b=ct,ze=Fe=je(Me,1,0,Ue,ye.K)){var rt,xt=Me,nt=ye,Ut=1<<(8>>nt.b),qt=o(Ut);if(qt==null)ze=0;else{var Rt=nt.K[0],Pt=nt.w;for(qt[0]=nt.K[0][0],rt=1;rt<1*xt;++rt)qt[rt]=qe(Rt[Pt+rt],qt[rt-1]);for(;rt<4*Ut;++rt)qt[rt]=0;nt.K[0]=null,nt.K[0]=qt,ze=1}}Fe=ze;break;case 2:break;default:r(0)}W=Fe}}if(V=V[0],Y=Y[0],W&&me(X,1)&&!(W=1<=(_e=me(X,4))&&11>=_e)){F.a=3;break e}var er;if(er=W)t:{var Jt,Tt,Ar,ya=F,kr=V,ba=Y,Vt=_e,Ea=S,La=ya.m,Mr=ya.s,Vr=[null],da=1,$a=0,Sn=k1[Vt];r:for(;;){if(Ea&&me(La,1)){var Ur=me(La,3)+2,Hn=et(kr,Ur),Os=et(ba,Ur),pi=Hn*Os;if(!je(Hn,Os,0,ya,Vr))break r;for(Vr=Vr[0],Mr.xc=Ur,Jt=0;Jt<pi;++Jt){var ss=Vr[Jt]>>8&65535;Vr[Jt]=ss,ss>=da&&(da=ss+1)}}if(La.h)break r;for(Tt=0;5>Tt;++Tt){var fr=_d[Tt];!Tt&&0<Vt&&(fr+=1<<Vt),$a<fr&&($a=fr)}var e0=l(da*Sn,C),Id=da,Dd=l(Id,G);if(Dd==null)var Sl=null;else r(65536>=Id),Sl=Dd;var uo=o($a);if(Sl==null||uo==null||e0==null){ya.a=1;break r}var _l=e0;for(Jt=Ar=0;Jt<da;++Jt){var nn=Sl[Jt],gi=nn.G,vi=nn.H,Rd=0,Al=1,Bd=0;for(Tt=0;5>Tt;++Tt){fr=_d[Tt],gi[Tt]=_l,vi[Tt]=Ar,!Tt&&0<Vt&&(fr+=1<<Vt);n:{var kl,t0=fr,Tl=ya,mo=uo,Y1=_l,K1=Ar,r0=0,is=Tl.m,X1=me(is,1);if(s(mo,0,0,t0),X1){var J1=me(is,1)+1,Z1=me(is,1),Md=me(is,Z1==0?1:8);mo[Md]=1,J1==2&&(mo[Md=me(is,8)]=1);var Cl=1}else{var Ud=o(19),Hd=me(is,4)+4;if(19<Hd){Tl.a=3;var El=0;break n}for(kl=0;kl<Hd;++kl)Ud[_1[kl]]=me(is,3);var a0=void 0,xo=void 0,Wd=Tl,Q1=Ud,Ll=t0,zd=mo,n0=0,os=Wd.m,qd=8,Vd=l(128,C);a:for(;k(Vd,0,7,Q1,19);){if(me(os,1)){var em=2+2*me(os,3);if((a0=2+me(os,em))>Ll)break a}else a0=Ll;for(xo=0;xo<Ll&&a0--;){K(os);var Gd=Vd[0+(127&I(os))];M(os,os.u+Gd.g);var yi=Gd.value;if(16>yi)zd[xo++]=yi,yi!=0&&(qd=yi);else{var tm=yi==16,$d=yi-16,rm=j1[$d],Yd=me(os,N1[$d])+rm;if(xo+Yd>Ll)break a;for(var am=tm?qd:0;0<Yd--;)zd[xo++]=am}}n0=1;break a}n0||(Wd.a=3),Cl=n0}(Cl=Cl&&!is.h)&&(r0=k(Y1,K1,8,mo,t0)),Cl&&r0!=0?El=r0:(Tl.a=3,El=0)}if(El==0)break r;if(Al&&S1[Tt]==1&&(Al=_l[Ar].g==0),Rd+=_l[Ar].g,Ar+=El,3>=Tt){var po,s0=uo[0];for(po=1;po<fr;++po)uo[po]>s0&&(s0=uo[po]);Bd+=s0}}if(nn.nd=Al,nn.Qb=0,Al&&(nn.qb=(gi[3][vi[3]+0].value<<24|gi[1][vi[1]+0].value<<16|gi[2][vi[2]+0].value)>>>0,Rd==0&&256>gi[0][vi[0]+0].value&&(nn.Qb=1,nn.qb+=gi[0][vi[0]+0].value<<8)),nn.jc=!nn.Qb&&6>Bd,nn.jc){var Fl,Wn=nn;for(Fl=0;Fl<qr;++Fl){var ls=Fl,cs=Wn.pd[ls],Pl=Wn.G[0][Wn.H[0]+ls];256<=Pl.value?(cs.g=Pl.g+256,cs.value=Pl.value):(cs.g=0,cs.value=0,ls>>=gr(Pl,8,cs),ls>>=gr(Wn.G[1][Wn.H[1]+ls],16,cs),ls>>=gr(Wn.G[2][Wn.H[2]+ls],0,cs),gr(Wn.G[3][Wn.H[3]+ls],24,cs))}}}Mr.vc=Vr,Mr.Wb=da,Mr.Ya=Sl,Mr.yc=e0,er=1;break t}er=0}if(!(W=er)){F.a=3;break e}if(0<_e){if(re.ua=1<<_e,!Ke(re.Wa,_e)){F.a=1,W=0;break e}}else re.ua=0;var i0=F,Kd=V,nm=Y,o0=i0.s,l0=o0.xc;if(i0.c=Kd,i0.i=nm,o0.md=et(Kd,l0),o0.wc=l0==0?-1:(1<<l0)-1,S){F.xb=I1;break e}if((xe=o(V*Y))==null){F.a=1,W=0;break e}W=(W=ie(F,xe,0,V,Y,Y,null))&&!X.h;break e}return W?(U!=null?U[0]=xe:(r(xe==null),r(S)),F.$=0,S||Se(re)):Se(re),W}function ke(h,x){var S=h.c*h.i,F=S+x+16*x;return r(h.c<=x),h.V=o(F),h.V==null?(h.Ta=null,h.Ua=0,h.a=1,0):(h.Ta=h.V,h.Ua=h.Ba+S+x,1)}function Te(h,x){var S=h.C,F=x-S,U=h.V,W=h.Ba+h.c*S;for(r(x<=h.l.o);0<F;){var V=16<F?16:F,Y=h.l.ma,X=h.l.width,re=X*V,xe=Y.ca,_e=Y.tb+X*S,Ae=h.Ta,we=h.Ua;q(h,V,U,W),br(Ae,we,xe,_e,re),te(Y,S,S+V,xe,_e,X),F-=V,U+=V*h.c,S+=V}r(S==x),h.C=h.Ma=x}function Ge(){this.ub=this.yd=this.td=this.Rb=0}function Je(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function ot(){this.Fb=this.Bb=this.Cb=0,this.Zb=o(4),this.Lb=o(4)}function Ye(){this.Yb=function(){var h=[];return function x(S,F,U){for(var W=U[F],V=0;V<W&&(S.push(U.length>F+1?[]:0),!(U.length<F+1));V++)x(S[V],F+1,U)}(h,0,[3,11]),h}()}function it(){this.jb=o(3),this.Wc=c([4,8],Ye),this.Xc=c([4,17],Ye)}function bt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new o(4),this.od=new o(4)}function zt(){this.ld=this.La=this.dd=this.tc=0}function Xt(){this.Na=this.la=0}function Sr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Za(){this.ad=o(384),this.Za=0,this.Ob=o(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Pn(){this.uc=this.M=this.Nb=0,this.wa=Array(new zt),this.Y=0,this.ya=Array(new Za),this.aa=0,this.l=new bn}function yn(){this.y=o(16),this.f=o(8),this.ea=o(8)}function Qa(){this.cb=this.a=0,this.sc="",this.m=new be,this.Od=new Ge,this.Kc=new Je,this.ed=new bt,this.Qa=new ot,this.Ic=this.$c=this.Aa=0,this.D=new Pn,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=l(8,be),this.ia=0,this.pb=l(4,Sr),this.Pa=new it,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new yn),this.Hd=0,this.rb=Array(new Xt),this.sb=0,this.wa=Array(new zt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Za),this.L=this.aa=0,this.gd=c([4,2],zt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function bn(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function ka(){var h=new Qa;return h!=null&&(h.a=0,h.sc="OK",h.cb=0,h.Xb=0,ho||(ho=Ko)),h}function vr(h,x,S){return h.a==0&&(h.a=x,h.sc=S,h.cb=0),0}function $o(h,x,S){return 3<=S&&h[x+0]==157&&h[x+1]==1&&h[x+2]==42}function Yo(h,x){if(h==null)return 0;if(h.a=0,h.sc="OK",x==null)return vr(h,2,"null VP8Io passed to VP8GetHeaders()");var S=x.data,F=x.w,U=x.ha;if(4>U)return vr(h,7,"Truncated header.");var W=S[F+0]|S[F+1]<<8|S[F+2]<<16,V=h.Od;if(V.Rb=!(1&W),V.td=W>>1&7,V.yd=W>>4&1,V.ub=W>>5,3<V.td)return vr(h,3,"Incorrect keyframe parameters.");if(!V.yd)return vr(h,4,"Frame not displayable.");F+=3,U-=3;var Y=h.Kc;if(V.Rb){if(7>U)return vr(h,7,"cannot parse picture header");if(!$o(S,F,U))return vr(h,3,"Bad code word");Y.c=16383&(S[F+4]<<8|S[F+3]),Y.Td=S[F+4]>>6,Y.i=16383&(S[F+6]<<8|S[F+5]),Y.Ud=S[F+6]>>6,F+=7,U-=7,h.za=Y.c+15>>4,h.Ub=Y.i+15>>4,x.width=Y.c,x.height=Y.i,x.Da=0,x.j=0,x.v=0,x.va=x.width,x.o=x.height,x.da=0,x.ib=x.width,x.hb=x.height,x.U=x.width,x.T=x.height,s((W=h.Pa).jb,0,255,W.jb.length),r((W=h.Qa)!=null),W.Cb=0,W.Bb=0,W.Fb=1,s(W.Zb,0,0,W.Zb.length),s(W.Lb,0,0,W.Lb)}if(V.ub>U)return vr(h,7,"bad partition length");de(W=h.m,S,F,V.ub),F+=V.ub,U-=V.ub,V.Rb&&(Y.Ld=fe(W),Y.Kd=fe(W)),Y=h.Qa;var X,re=h.Pa;if(r(W!=null),r(Y!=null),Y.Cb=fe(W),Y.Cb){if(Y.Bb=fe(W),fe(W)){for(Y.Fb=fe(W),X=0;4>X;++X)Y.Zb[X]=fe(W)?Z(W,7):0;for(X=0;4>X;++X)Y.Lb[X]=fe(W)?Z(W,6):0}if(Y.Bb)for(X=0;3>X;++X)re.jb[X]=fe(W)?J(W,8):255}else Y.Bb=0;if(W.Ka)return vr(h,3,"cannot parse segment header");if((Y=h.ed).zd=fe(W),Y.Tb=J(W,6),Y.wb=J(W,3),Y.Pc=fe(W),Y.Pc&&fe(W)){for(re=0;4>re;++re)fe(W)&&(Y.vd[re]=Z(W,6));for(re=0;4>re;++re)fe(W)&&(Y.od[re]=Z(W,6))}if(h.L=Y.Tb==0?0:Y.zd?1:2,W.Ka)return vr(h,3,"cannot parse filter header");var xe=U;if(U=X=F,F=X+xe,Y=xe,h.Xb=(1<<J(h.m,2))-1,xe<3*(re=h.Xb))S=7;else{for(X+=3*re,Y-=3*re,xe=0;xe<re;++xe){var _e=S[U+0]|S[U+1]<<8|S[U+2]<<16;_e>Y&&(_e=Y),de(h.Jc[+xe],S,X,_e),X+=_e,Y-=_e,U+=3}de(h.Jc[+re],S,X,Y),S=X<F?0:5}if(S!=0)return vr(h,S,"cannot parse partitions");for(S=J(X=h.m,7),U=fe(X)?Z(X,4):0,F=fe(X)?Z(X,4):0,Y=fe(X)?Z(X,4):0,re=fe(X)?Z(X,4):0,X=fe(X)?Z(X,4):0,xe=h.Qa,_e=0;4>_e;++_e){if(xe.Cb){var Ae=xe.Zb[_e];xe.Fb||(Ae+=S)}else{if(0<_e){h.pb[_e]=h.pb[0];continue}Ae=S}var we=h.pb[_e];we.Sc[0]=Jc[Ta(Ae+U,127)],we.Sc[1]=Zc[Ta(Ae+0,127)],we.Eb[0]=2*Jc[Ta(Ae+F,127)],we.Eb[1]=101581*Zc[Ta(Ae+Y,127)]>>16,8>we.Eb[1]&&(we.Eb[1]=8),we.Qc[0]=Jc[Ta(Ae+re,117)],we.Qc[1]=Zc[Ta(Ae+X,127)],we.lc=Ae+X}if(!V.Rb)return vr(h,4,"Not a key frame.");for(fe(W),V=h.Pa,S=0;4>S;++S){for(U=0;8>U;++U)for(F=0;3>F;++F)for(Y=0;11>Y;++Y)re=ee(W,P1[S][U][F][Y])?J(W,8):L1[S][U][F][Y],V.Wc[S][U].Yb[F][Y]=re;for(U=0;17>U;++U)V.Xc[S][U]=V.Wc[S][O1[U]]}return h.kc=fe(W),h.kc&&(h.Bd=J(W,8)),h.cb=1}function Ko(h,x,S,F,U,W,V){var Y=x[U].Yb[S];for(S=0;16>U;++U){if(!ee(h,Y[S+0]))return U;for(;!ee(h,Y[S+1]);)if(Y=x[++U].Yb[0],S=0,U==16)return 16;var X=x[U+1].Yb;if(ee(h,Y[S+2])){var re=h,xe=0;if(ee(re,(Ae=Y)[(_e=S)+3]))if(ee(re,Ae[_e+6])){for(Y=0,_e=2*(xe=ee(re,Ae[_e+8]))+(Ae=ee(re,Ae[_e+9+xe])),xe=0,Ae=C1[_e];Ae[Y];++Y)xe+=xe+ee(re,Ae[Y]);xe+=3+(8<<_e)}else ee(re,Ae[_e+7])?(xe=7+2*ee(re,165),xe+=ee(re,145)):xe=5+ee(re,159);else xe=ee(re,Ae[_e+4])?3+ee(re,Ae[_e+5]):2;Y=X[2]}else xe=1,Y=X[1];X=V+E1[U],0>(re=h).b&&he(re);var _e,Ae=re.b,we=(_e=re.Ca>>1)-(re.I>>Ae)>>31;--re.b,re.Ca+=we,re.Ca|=1,re.I-=(_e+1&we)<<Ae,W[X]=((xe^we)-we)*F[(0<U)+0]}return 16}function Hi(h){var x=h.rb[h.sb-1];x.la=0,x.Na=0,s(h.zc,0,0,h.zc.length),h.ja=0}function kc(h,x){if(h==null)return 0;if(x==null)return vr(h,2,"NULL VP8Io parameter in VP8Decode().");if(!h.cb&&!Yo(h,x))return 0;if(r(h.cb),x.ac==null||x.ac(x)){x.ob&&(h.L=0);var S=jl[h.L];if(h.L==2?(h.yb=0,h.zb=0):(h.yb=x.v-S>>4,h.zb=x.j-S>>4,0>h.yb&&(h.yb=0),0>h.zb&&(h.zb=0)),h.Va=x.o+15+S>>4,h.Hb=x.va+15+S>>4,h.Hb>h.za&&(h.Hb=h.za),h.Va>h.Ub&&(h.Va=h.Ub),0<h.L){var F=h.ed;for(S=0;4>S;++S){var U;if(h.Qa.Cb){var W=h.Qa.Lb[S];h.Qa.Fb||(W+=F.Tb)}else W=F.Tb;for(U=0;1>=U;++U){var V=h.gd[S][U],Y=W;if(F.Pc&&(Y+=F.vd[0],U&&(Y+=F.od[0])),0<(Y=0>Y?0:63<Y?63:Y)){var X=Y;0<F.wb&&(X=4<F.wb?X>>2:X>>1)>9-F.wb&&(X=9-F.wb),1>X&&(X=1),V.dd=X,V.tc=2*Y+X,V.ld=40<=Y?2:15<=Y?1:0}else V.tc=0;V.La=U}}}S=0}else vr(h,6,"Frame setup failed"),S=h.a;if(S=S==0){if(S){h.$c=0,0<h.Aa||(h.Ic=$1);e:{S=h.Ic,F=4*(X=h.za);var re=32*X,xe=X+1,_e=0<h.L?X*(0<h.Aa?2:1):0,Ae=(h.Aa==2?2:1)*X;if((V=F+832+(U=3*(16*S+jl[h.L])/2*re)+(W=h.Fa!=null&&0<h.Fa.length?h.Kc.c*h.Kc.i:0))!=V)S=0;else{if(V>h.Vb){if(h.Vb=0,h.Ec=o(V),h.Fc=0,h.Ec==null){S=vr(h,1,"no memory during frame initialization.");break e}h.Vb=V}V=h.Ec,Y=h.Fc,h.Ac=V,h.Bc=Y,Y+=F,h.Gd=l(re,yn),h.Hd=0,h.rb=l(xe+1,Xt),h.sb=1,h.wa=_e?l(_e,zt):null,h.Y=0,h.D.Nb=0,h.D.wa=h.wa,h.D.Y=h.Y,0<h.Aa&&(h.D.Y+=X),r(!0),h.oc=V,h.pc=Y,Y+=832,h.ya=l(Ae,Za),h.aa=0,h.D.ya=h.ya,h.D.aa=h.aa,h.Aa==2&&(h.D.aa+=X),h.R=16*X,h.B=8*X,X=(re=jl[h.L])*h.R,re=re/2*h.B,h.sa=V,h.ta=Y+X,h.qa=h.sa,h.ra=h.ta+16*S*h.R+re,h.Ha=h.qa,h.Ia=h.ra+8*S*h.B+re,h.$c=0,Y+=U,h.mb=W?V:null,h.nb=W?Y:null,r(Y+W<=h.Fc+h.Vb),Hi(h),s(h.Ac,h.Bc,0,F),S=1}}if(S){if(x.ka=0,x.y=h.sa,x.O=h.ta,x.f=h.qa,x.N=h.ra,x.ea=h.Ha,x.Vd=h.Ia,x.fa=h.R,x.Rc=h.B,x.F=null,x.J=0,!ml){for(S=-255;255>=S;++S)Or[255+S]=0>S?-S:S;for(S=-1020;1020>=S;++S)Mn[1020+S]=-128>S?-128:127<S?127:S;for(S=-112;112>=S;++S)co[112+S]=-16>S?-16:15<S?15:S;for(S=-255;510>=S;++S)xi[255+S]=0>S?0:255<S?255:S;ml=1}fi=Ec,Bn=Tc,io=Jo,ca=Cc,Wa=Zo,yr=Xo,ui=$i,ul=ks,oo=zc,Es=Yi,Ls=Wc,ts=ai,Fs=Ki,mi=ol,Ps=il,rs=Nn,lo=In,za=Hc,an[0]=wn,an[1]=Lc,an[2]=Ic,an[3]=Dc,an[4]=tl,an[5]=ti,an[6]=rl,an[7]=qi,an[8]=Bc,an[9]=Rc,as[0]=Qo,as[1]=Pc,as[2]=On,as[3]=Qs,as[4]=Qr,as[5]=Oc,as[6]=el,Un[0]=Xn,Un[1]=Fc,Un[2]=Mc,Un[3]=Vi,Un[4]=As,Un[5]=Uc,Un[6]=Gi,S=1}else S=0}S&&(S=function(we,Ue){for(we.M=0;we.M<we.Va;++we.M){var Fe,pe=we.Jc[we.M&we.Xb],ye=we.m,Be=we;for(Fe=0;Fe<Be.za;++Fe){var ze=ye,Me=Be,ct=Me.Ac,rt=Me.Bc+4*Fe,xt=Me.zc,nt=Me.ya[Me.aa+Fe];if(Me.Qa.Bb?nt.$b=ee(ze,Me.Pa.jb[0])?2+ee(ze,Me.Pa.jb[2]):ee(ze,Me.Pa.jb[1]):nt.$b=0,Me.kc&&(nt.Ad=ee(ze,Me.Bd)),nt.Za=!ee(ze,145)+0,nt.Za){var Ut=nt.Ob,qt=0;for(Me=0;4>Me;++Me){var Rt,Pt=xt[0+Me];for(Rt=0;4>Rt;++Rt){Pt=F1[ct[rt+Rt]][Pt];for(var er=Ad[ee(ze,Pt[0])];0<er;)er=Ad[2*er+ee(ze,Pt[er])];Pt=-er,ct[rt+Rt]=Pt}n(Ut,qt,ct,rt,4),qt+=4,xt[0+Me]=Pt}}else Pt=ee(ze,156)?ee(ze,128)?1:3:ee(ze,163)?2:0,nt.Ob[0]=Pt,s(ct,rt,Pt,4),s(xt,0,Pt,4);nt.Dd=ee(ze,142)?ee(ze,114)?ee(ze,183)?1:3:2:0}if(Be.m.Ka)return vr(we,7,"Premature end-of-partition0 encountered.");for(;we.ja<we.za;++we.ja){if(Be=pe,ze=(ye=we).rb[ye.sb-1],ct=ye.rb[ye.sb+ye.ja],Fe=ye.ya[ye.aa+ye.ja],rt=ye.kc?Fe.Ad:0)ze.la=ct.la=0,Fe.Za||(ze.Na=ct.Na=0),Fe.Hc=0,Fe.Gc=0,Fe.ia=0;else{var Jt,Tt;if(ze=ct,ct=Be,rt=ye.Pa.Xc,xt=ye.ya[ye.aa+ye.ja],nt=ye.pb[xt.$b],Me=xt.ad,Ut=0,qt=ye.rb[ye.sb-1],Pt=Rt=0,s(Me,Ut,0,384),xt.Za)var Ar=0,ya=rt[3];else{er=o(16);var kr=ze.Na+qt.Na;if(kr=ho(ct,rt[1],kr,nt.Eb,0,er,0),ze.Na=qt.Na=(0<kr)+0,1<kr)fi(er,0,Me,Ut);else{var ba=er[0]+3>>3;for(er=0;256>er;er+=16)Me[Ut+er]=ba}Ar=1,ya=rt[0]}var Vt=15&ze.la,Ea=15&qt.la;for(er=0;4>er;++er){var La=1&Ea;for(ba=Tt=0;4>ba;++ba)Vt=Vt>>1|(La=(kr=ho(ct,ya,kr=La+(1&Vt),nt.Sc,Ar,Me,Ut))>Ar)<<7,Tt=Tt<<2|(3<kr?3:1<kr?2:Me[Ut+0]!=0),Ut+=16;Vt>>=4,Ea=Ea>>1|La<<7,Rt=(Rt<<8|Tt)>>>0}for(ya=Vt,Ar=Ea>>4,Jt=0;4>Jt;Jt+=2){for(Tt=0,Vt=ze.la>>4+Jt,Ea=qt.la>>4+Jt,er=0;2>er;++er){for(La=1&Ea,ba=0;2>ba;++ba)kr=La+(1&Vt),Vt=Vt>>1|(La=0<(kr=ho(ct,rt[2],kr,nt.Qc,0,Me,Ut)))<<3,Tt=Tt<<2|(3<kr?3:1<kr?2:Me[Ut+0]!=0),Ut+=16;Vt>>=2,Ea=Ea>>1|La<<5}Pt|=Tt<<4*Jt,ya|=Vt<<4<<Jt,Ar|=(240&Ea)<<Jt}ze.la=ya,qt.la=Ar,xt.Hc=Rt,xt.Gc=Pt,xt.ia=43690&Pt?0:nt.ia,rt=!(Rt|Pt)}if(0<ye.L&&(ye.wa[ye.Y+ye.ja]=ye.gd[Fe.$b][Fe.Za],ye.wa[ye.Y+ye.ja].La|=!rt),Be.Ka)return vr(we,7,"Premature end-of-file encountered.")}if(Hi(we),ye=Ue,Be=1,Fe=(pe=we).D,ze=0<pe.L&&pe.M>=pe.zb&&pe.M<=pe.Va,pe.Aa==0)e:{if(Fe.M=pe.M,Fe.uc=ze,to(pe,Fe),Be=1,Fe=(Tt=pe.D).Nb,ze=(Pt=jl[pe.L])*pe.R,ct=Pt/2*pe.B,er=16*Fe*pe.R,ba=8*Fe*pe.B,rt=pe.sa,xt=pe.ta-ze+er,nt=pe.qa,Me=pe.ra-ct+ba,Ut=pe.Ha,qt=pe.Ia-ct+ba,Ea=(Vt=Tt.M)==0,Rt=Vt>=pe.Va-1,pe.Aa==2&&to(pe,Tt),Tt.uc)for(La=(kr=pe).D.M,r(kr.D.uc),Tt=kr.yb;Tt<kr.Hb;++Tt){Ar=Tt,ya=La;var Mr=(Vr=(fr=kr).D).Nb;Jt=fr.R;var Vr=Vr.wa[Vr.Y+Ar],da=fr.sa,$a=fr.ta+16*Mr*Jt+16*Ar,Sn=Vr.dd,Ur=Vr.tc;if(Ur!=0)if(r(3<=Ur),fr.L==1)0<Ar&&rs(da,$a,Jt,Ur+4),Vr.La&&za(da,$a,Jt,Ur),0<ya&&Ps(da,$a,Jt,Ur+4),Vr.La&&lo(da,$a,Jt,Ur);else{var Hn=fr.B,Os=fr.qa,pi=fr.ra+8*Mr*Hn+8*Ar,ss=fr.Ha,fr=fr.Ia+8*Mr*Hn+8*Ar;Mr=Vr.ld,0<Ar&&(ul(da,$a,Jt,Ur+4,Sn,Mr),Es(Os,pi,ss,fr,Hn,Ur+4,Sn,Mr)),Vr.La&&(ts(da,$a,Jt,Ur,Sn,Mr),mi(Os,pi,ss,fr,Hn,Ur,Sn,Mr)),0<ya&&(ui(da,$a,Jt,Ur+4,Sn,Mr),oo(Os,pi,ss,fr,Hn,Ur+4,Sn,Mr)),Vr.La&&(Ls(da,$a,Jt,Ur,Sn,Mr),Fs(Os,pi,ss,fr,Hn,Ur,Sn,Mr))}}if(pe.ia&&alert("todo:DitherRow"),ye.put!=null){if(Tt=16*Vt,Vt=16*(Vt+1),Ea?(ye.y=pe.sa,ye.O=pe.ta+er,ye.f=pe.qa,ye.N=pe.ra+ba,ye.ea=pe.Ha,ye.W=pe.Ia+ba):(Tt-=Pt,ye.y=rt,ye.O=xt,ye.f=nt,ye.N=Me,ye.ea=Ut,ye.W=qt),Rt||(Vt-=Pt),Vt>ye.o&&(Vt=ye.o),ye.F=null,ye.J=null,pe.Fa!=null&&0<pe.Fa.length&&Tt<Vt&&(ye.J=Qi(pe,ye,Tt,Vt-Tt),ye.F=pe.mb,ye.F==null&&ye.F.length==0)){Be=vr(pe,3,"Could not decode alpha data.");break e}Tt<ye.j&&(Pt=ye.j-Tt,Tt=ye.j,r(!(1&Pt)),ye.O+=pe.R*Pt,ye.N+=pe.B*(Pt>>1),ye.W+=pe.B*(Pt>>1),ye.F!=null&&(ye.J+=ye.width*Pt)),Tt<Vt&&(ye.O+=ye.v,ye.N+=ye.v>>1,ye.W+=ye.v>>1,ye.F!=null&&(ye.J+=ye.v),ye.ka=Tt-ye.j,ye.U=ye.va-ye.v,ye.T=Vt-Tt,Be=ye.put(ye))}Fe+1!=pe.Ic||Rt||(n(pe.sa,pe.ta-ze,rt,xt+16*pe.R,ze),n(pe.qa,pe.ra-ct,nt,Me+8*pe.B,ct),n(pe.Ha,pe.Ia-ct,Ut,qt+8*pe.B,ct))}if(!Be)return vr(we,6,"Output aborted.")}return 1}(h,x)),x.bc!=null&&x.bc(x),S&=1}return S?(h.cb=0,S):0}function en(h,x,S,F,U){U=h[x+S+32*F]+(U>>3),h[x+S+32*F]=-256&U?0>U?0:255:U}function Zs(h,x,S,F,U,W){en(h,x,0,S,F+U),en(h,x,1,S,F+W),en(h,x,2,S,F-W),en(h,x,3,S,F-U)}function pa(h){return(20091*h>>16)+h}function Wi(h,x,S,F){var U,W=0,V=o(16);for(U=0;4>U;++U){var Y=h[x+0]+h[x+8],X=h[x+0]-h[x+8],re=(35468*h[x+4]>>16)-pa(h[x+12]),xe=pa(h[x+4])+(35468*h[x+12]>>16);V[W+0]=Y+xe,V[W+1]=X+re,V[W+2]=X-re,V[W+3]=Y-xe,W+=4,x++}for(U=W=0;4>U;++U)Y=(h=V[W+0]+4)+V[W+8],X=h-V[W+8],re=(35468*V[W+4]>>16)-pa(V[W+12]),en(S,F,0,0,Y+(xe=pa(V[W+4])+(35468*V[W+12]>>16))),en(S,F,1,0,X+re),en(S,F,2,0,X-re),en(S,F,3,0,Y-xe),W++,F+=32}function Xo(h,x,S,F){var U=h[x+0]+4,W=35468*h[x+4]>>16,V=pa(h[x+4]),Y=35468*h[x+1]>>16;Zs(S,F,0,U+V,h=pa(h[x+1]),Y),Zs(S,F,1,U+W,h,Y),Zs(S,F,2,U-W,h,Y),Zs(S,F,3,U-V,h,Y)}function Tc(h,x,S,F,U){Wi(h,x,S,F),U&&Wi(h,x+16,S,F+4)}function Jo(h,x,S,F){Bn(h,x+0,S,F,1),Bn(h,x+32,S,F+128,1)}function Cc(h,x,S,F){var U;for(h=h[x+0]+4,U=0;4>U;++U)for(x=0;4>x;++x)en(S,F,x,U,h)}function Zo(h,x,S,F){h[x+0]&&ca(h,x+0,S,F),h[x+16]&&ca(h,x+16,S,F+4),h[x+32]&&ca(h,x+32,S,F+128),h[x+48]&&ca(h,x+48,S,F+128+4)}function Ec(h,x,S,F){var U,W=o(16);for(U=0;4>U;++U){var V=h[x+0+U]+h[x+12+U],Y=h[x+4+U]+h[x+8+U],X=h[x+4+U]-h[x+8+U],re=h[x+0+U]-h[x+12+U];W[0+U]=V+Y,W[8+U]=V-Y,W[4+U]=re+X,W[12+U]=re-X}for(U=0;4>U;++U)V=(h=W[0+4*U]+3)+W[3+4*U],Y=W[1+4*U]+W[2+4*U],X=W[1+4*U]-W[2+4*U],re=h-W[3+4*U],S[F+0]=V+Y>>3,S[F+16]=re+X>>3,S[F+32]=V-Y>>3,S[F+48]=re-X>>3,F+=64}function zi(h,x,S){var F,U=x-32,W=Ca,V=255-h[U-1];for(F=0;F<S;++F){var Y,X=W,re=V+h[x-1];for(Y=0;Y<S;++Y)h[x+Y]=X[re+h[U+Y]];x+=32}}function Lc(h,x){zi(h,x,4)}function Fc(h,x){zi(h,x,8)}function Pc(h,x){zi(h,x,16)}function On(h,x){var S;for(S=0;16>S;++S)n(h,x+32*S,h,x-32,16)}function Qs(h,x){var S;for(S=16;0<S;--S)s(h,x,h[x-1],16),x+=32}function ei(h,x,S){var F;for(F=0;16>F;++F)s(x,S+32*F,h,16)}function Qo(h,x){var S,F=16;for(S=0;16>S;++S)F+=h[x-1+32*S]+h[x+S-32];ei(F>>5,h,x)}function Qr(h,x){var S,F=8;for(S=0;16>S;++S)F+=h[x-1+32*S];ei(F>>4,h,x)}function Oc(h,x){var S,F=8;for(S=0;16>S;++S)F+=h[x+S-32];ei(F>>4,h,x)}function el(h,x){ei(128,h,x)}function jt(h,x,S){return h+2*x+S+2>>2}function Ic(h,x){var S,F=x-32;for(F=new Uint8Array([jt(h[F-1],h[F+0],h[F+1]),jt(h[F+0],h[F+1],h[F+2]),jt(h[F+1],h[F+2],h[F+3]),jt(h[F+2],h[F+3],h[F+4])]),S=0;4>S;++S)n(h,x+32*S,F,0,F.length)}function Dc(h,x){var S=h[x-1],F=h[x-1+32],U=h[x-1+64],W=h[x-1+96];ve(h,x+0,16843009*jt(h[x-1-32],S,F)),ve(h,x+32,16843009*jt(S,F,U)),ve(h,x+64,16843009*jt(F,U,W)),ve(h,x+96,16843009*jt(U,W,W))}function wn(h,x){var S,F=4;for(S=0;4>S;++S)F+=h[x+S-32]+h[x-1+32*S];for(F>>=3,S=0;4>S;++S)s(h,x+32*S,F,4)}function tl(h,x){var S=h[x-1+0],F=h[x-1+32],U=h[x-1+64],W=h[x-1-32],V=h[x+0-32],Y=h[x+1-32],X=h[x+2-32],re=h[x+3-32];h[x+0+96]=jt(F,U,h[x-1+96]),h[x+1+96]=h[x+0+64]=jt(S,F,U),h[x+2+96]=h[x+1+64]=h[x+0+32]=jt(W,S,F),h[x+3+96]=h[x+2+64]=h[x+1+32]=h[x+0+0]=jt(V,W,S),h[x+3+64]=h[x+2+32]=h[x+1+0]=jt(Y,V,W),h[x+3+32]=h[x+2+0]=jt(X,Y,V),h[x+3+0]=jt(re,X,Y)}function rl(h,x){var S=h[x+1-32],F=h[x+2-32],U=h[x+3-32],W=h[x+4-32],V=h[x+5-32],Y=h[x+6-32],X=h[x+7-32];h[x+0+0]=jt(h[x+0-32],S,F),h[x+1+0]=h[x+0+32]=jt(S,F,U),h[x+2+0]=h[x+1+32]=h[x+0+64]=jt(F,U,W),h[x+3+0]=h[x+2+32]=h[x+1+64]=h[x+0+96]=jt(U,W,V),h[x+3+32]=h[x+2+64]=h[x+1+96]=jt(W,V,Y),h[x+3+64]=h[x+2+96]=jt(V,Y,X),h[x+3+96]=jt(Y,X,X)}function ti(h,x){var S=h[x-1+0],F=h[x-1+32],U=h[x-1+64],W=h[x-1-32],V=h[x+0-32],Y=h[x+1-32],X=h[x+2-32],re=h[x+3-32];h[x+0+0]=h[x+1+64]=W+V+1>>1,h[x+1+0]=h[x+2+64]=V+Y+1>>1,h[x+2+0]=h[x+3+64]=Y+X+1>>1,h[x+3+0]=X+re+1>>1,h[x+0+96]=jt(U,F,S),h[x+0+64]=jt(F,S,W),h[x+0+32]=h[x+1+96]=jt(S,W,V),h[x+1+32]=h[x+2+96]=jt(W,V,Y),h[x+2+32]=h[x+3+96]=jt(V,Y,X),h[x+3+32]=jt(Y,X,re)}function qi(h,x){var S=h[x+0-32],F=h[x+1-32],U=h[x+2-32],W=h[x+3-32],V=h[x+4-32],Y=h[x+5-32],X=h[x+6-32],re=h[x+7-32];h[x+0+0]=S+F+1>>1,h[x+1+0]=h[x+0+64]=F+U+1>>1,h[x+2+0]=h[x+1+64]=U+W+1>>1,h[x+3+0]=h[x+2+64]=W+V+1>>1,h[x+0+32]=jt(S,F,U),h[x+1+32]=h[x+0+96]=jt(F,U,W),h[x+2+32]=h[x+1+96]=jt(U,W,V),h[x+3+32]=h[x+2+96]=jt(W,V,Y),h[x+3+64]=jt(V,Y,X),h[x+3+96]=jt(Y,X,re)}function Rc(h,x){var S=h[x-1+0],F=h[x-1+32],U=h[x-1+64],W=h[x-1+96];h[x+0+0]=S+F+1>>1,h[x+2+0]=h[x+0+32]=F+U+1>>1,h[x+2+32]=h[x+0+64]=U+W+1>>1,h[x+1+0]=jt(S,F,U),h[x+3+0]=h[x+1+32]=jt(F,U,W),h[x+3+32]=h[x+1+64]=jt(U,W,W),h[x+3+64]=h[x+2+64]=h[x+0+96]=h[x+1+96]=h[x+2+96]=h[x+3+96]=W}function Bc(h,x){var S=h[x-1+0],F=h[x-1+32],U=h[x-1+64],W=h[x-1+96],V=h[x-1-32],Y=h[x+0-32],X=h[x+1-32],re=h[x+2-32];h[x+0+0]=h[x+2+32]=S+V+1>>1,h[x+0+32]=h[x+2+64]=F+S+1>>1,h[x+0+64]=h[x+2+96]=U+F+1>>1,h[x+0+96]=W+U+1>>1,h[x+3+0]=jt(Y,X,re),h[x+2+0]=jt(V,Y,X),h[x+1+0]=h[x+3+32]=jt(S,V,Y),h[x+1+32]=h[x+3+64]=jt(F,S,V),h[x+1+64]=h[x+3+96]=jt(U,F,S),h[x+1+96]=jt(W,U,F)}function Mc(h,x){var S;for(S=0;8>S;++S)n(h,x+32*S,h,x-32,8)}function Vi(h,x){var S;for(S=0;8>S;++S)s(h,x,h[x-1],8),x+=32}function _s(h,x,S){var F;for(F=0;8>F;++F)s(x,S+32*F,h,8)}function Xn(h,x){var S,F=8;for(S=0;8>S;++S)F+=h[x+S-32]+h[x-1+32*S];_s(F>>4,h,x)}function Uc(h,x){var S,F=4;for(S=0;8>S;++S)F+=h[x+S-32];_s(F>>3,h,x)}function As(h,x){var S,F=4;for(S=0;8>S;++S)F+=h[x-1+32*S];_s(F>>3,h,x)}function Gi(h,x){_s(128,h,x)}function ri(h,x,S){var F=h[x-S],U=h[x+0],W=3*(U-F)+Gc[1020+h[x-2*S]-h[x+S]],V=xl[112+(W+4>>3)];h[x-S]=Ca[255+F+xl[112+(W+3>>3)]],h[x+0]=Ca[255+U-V]}function al(h,x,S,F){var U=h[x+0],W=h[x+S];return Va[255+h[x-2*S]-h[x-S]]>F||Va[255+W-U]>F}function nl(h,x,S,F){return 4*Va[255+h[x-S]-h[x+0]]+Va[255+h[x-2*S]-h[x+S]]<=F}function sl(h,x,S,F,U){var W=h[x-3*S],V=h[x-2*S],Y=h[x-S],X=h[x+0],re=h[x+S],xe=h[x+2*S],_e=h[x+3*S];return 4*Va[255+Y-X]+Va[255+V-re]>F?0:Va[255+h[x-4*S]-W]<=U&&Va[255+W-V]<=U&&Va[255+V-Y]<=U&&Va[255+_e-xe]<=U&&Va[255+xe-re]<=U&&Va[255+re-X]<=U}function il(h,x,S,F){var U=2*F+1;for(F=0;16>F;++F)nl(h,x+F,S,U)&&ri(h,x+F,S)}function Nn(h,x,S,F){var U=2*F+1;for(F=0;16>F;++F)nl(h,x+F*S,1,U)&&ri(h,x+F*S,1)}function In(h,x,S,F){var U;for(U=3;0<U;--U)il(h,x+=4*S,S,F)}function Hc(h,x,S,F){var U;for(U=3;0<U;--U)Nn(h,x+=4,S,F)}function Jn(h,x,S,F,U,W,V,Y){for(W=2*W+1;0<U--;){if(sl(h,x,S,W,V))if(al(h,x,S,Y))ri(h,x,S);else{var X=h,re=x,xe=S,_e=X[re-2*xe],Ae=X[re-xe],we=X[re+0],Ue=X[re+xe],Fe=X[re+2*xe],pe=27*(Be=Gc[1020+3*(we-Ae)+Gc[1020+_e-Ue]])+63>>7,ye=18*Be+63>>7,Be=9*Be+63>>7;X[re-3*xe]=Ca[255+X[re-3*xe]+Be],X[re-2*xe]=Ca[255+_e+ye],X[re-xe]=Ca[255+Ae+pe],X[re+0]=Ca[255+we-pe],X[re+xe]=Ca[255+Ue-ye],X[re+2*xe]=Ca[255+Fe-Be]}x+=F}}function tn(h,x,S,F,U,W,V,Y){for(W=2*W+1;0<U--;){if(sl(h,x,S,W,V))if(al(h,x,S,Y))ri(h,x,S);else{var X=h,re=x,xe=S,_e=X[re-xe],Ae=X[re+0],we=X[re+xe],Ue=xl[112+((Fe=3*(Ae-_e))+4>>3)],Fe=xl[112+(Fe+3>>3)],pe=Ue+1>>1;X[re-2*xe]=Ca[255+X[re-2*xe]+pe],X[re-xe]=Ca[255+_e+Fe],X[re+0]=Ca[255+Ae-Ue],X[re+xe]=Ca[255+we-pe]}x+=F}}function $i(h,x,S,F,U,W){Jn(h,x,S,1,16,F,U,W)}function ks(h,x,S,F,U,W){Jn(h,x,1,S,16,F,U,W)}function Wc(h,x,S,F,U,W){var V;for(V=3;0<V;--V)tn(h,x+=4*S,S,1,16,F,U,W)}function ai(h,x,S,F,U,W){var V;for(V=3;0<V;--V)tn(h,x+=4,1,S,16,F,U,W)}function zc(h,x,S,F,U,W,V,Y){Jn(h,x,U,1,8,W,V,Y),Jn(S,F,U,1,8,W,V,Y)}function Yi(h,x,S,F,U,W,V,Y){Jn(h,x,1,U,8,W,V,Y),Jn(S,F,1,U,8,W,V,Y)}function Ki(h,x,S,F,U,W,V,Y){tn(h,x+4*U,U,1,8,W,V,Y),tn(S,F+4*U,U,1,8,W,V,Y)}function ol(h,x,S,F,U,W,V,Y){tn(h,x+4,1,U,8,W,V,Y),tn(S,F+4,1,U,8,W,V,Y)}function ni(){this.ba=new _a,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Qt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Xi(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Ji(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function ll(){this.ua=0,this.Wa=new le,this.vb=new le,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new G,this.yc=new C}function qc(){this.xb=this.a=0,this.l=new bn,this.ca=new _a,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new A,this.Pb=0,this.wd=new A,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new ll,this.ab=0,this.gc=l(4,Ji),this.Oc=0}function si(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new bn,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Ts(h,x,S,F,U,W,V){for(h=h==null?0:h[x+0],x=0;x<V;++x)U[W+x]=h+S[F+x]&255,h=U[W+x]}function Zi(h,x,S,F,U,W,V){var Y;if(h==null)Ts(null,null,S,F,U,W,V);else for(Y=0;Y<V;++Y)U[W+Y]=h[x+Y]+S[F+Y]&255}function Zn(h,x,S,F,U,W,V){if(h==null)Ts(null,null,S,F,U,W,V);else{var Y,X=h[x+0],re=X,xe=X;for(Y=0;Y<V;++Y)re=xe+(X=h[x+Y])-re,xe=S[F+Y]+(-256&re?0>re?0:255:re)&255,re=X,U[W+Y]=xe}}function Qi(h,x,S,F){var U=x.width,W=x.o;if(r(h!=null&&x!=null),0>S||0>=F||S+F>W)return null;if(!h.Cc){if(h.ga==null){var V;if(h.ga=new si,(V=h.ga==null)||(V=x.width*x.o,r(h.Gb.length==0),h.Gb=o(V),h.Uc=0,h.Gb==null?V=0:(h.mb=h.Gb,h.nb=h.Uc,h.rc=null,V=1),V=!V),!V){V=h.ga;var Y=h.Fa,X=h.P,re=h.qc,xe=h.mb,_e=h.nb,Ae=X+1,we=re-1,Ue=V.l;if(r(Y!=null&&xe!=null&&x!=null),ns[0]=null,ns[1]=Ts,ns[2]=Zi,ns[3]=Zn,V.ca=xe,V.tb=_e,V.c=x.width,V.i=x.height,r(0<V.c&&0<V.i),1>=re)x=0;else if(V.$a=Y[X+0]>>0&3,V.Z=Y[X+0]>>2&3,V.Lc=Y[X+0]>>4&3,X=Y[X+0]>>6&3,0>V.$a||1<V.$a||4<=V.Z||1<V.Lc||X)x=0;else if(Ue.put=Ma,Ue.ac=Pr,Ue.bc=Ua,Ue.ma=V,Ue.width=x.width,Ue.height=x.height,Ue.Da=x.Da,Ue.v=x.v,Ue.va=x.va,Ue.j=x.j,Ue.o=x.o,V.$a)e:{r(V.$a==1),x=Le();t:for(;;){if(x==null){x=0;break e}if(r(V!=null),V.mc=x,x.c=V.c,x.i=V.i,x.l=V.l,x.l.ma=V,x.l.width=V.c,x.l.height=V.i,x.a=0,oe(x.m,Y,Ae,we),!je(V.c,V.i,1,x,null)||(x.ab==1&&x.gc[0].hc==3&&Q(x.s)?(V.ic=1,Y=x.c*x.i,x.Ta=null,x.Ua=0,x.V=o(Y),x.Ba=0,x.V==null?(x.a=1,x=0):x=1):(V.ic=0,x=ke(x,V.c)),!x))break t;x=1;break e}V.mc=null,x=0}else x=we>=V.c*V.i;V=!x}if(V)return null;h.ga.Lc!=1?h.Ga=0:F=W-S}r(h.ga!=null),r(S+F<=W);e:{if(x=(Y=h.ga).c,W=Y.l.o,Y.$a==0){if(Ae=h.rc,we=h.Vc,Ue=h.Fa,X=h.P+1+S*x,re=h.mb,xe=h.nb+S*x,r(X<=h.P+h.qc),Y.Z!=0)for(r(ns[Y.Z]!=null),V=0;V<F;++V)ns[Y.Z](Ae,we,Ue,X,re,xe,x),Ae=re,we=xe,xe+=x,X+=x;else for(V=0;V<F;++V)n(re,xe,Ue,X,x),Ae=re,we=xe,xe+=x,X+=x;h.rc=Ae,h.Vc=we}else{if(r(Y.mc!=null),x=S+F,r((V=Y.mc)!=null),r(x<=V.i),V.C>=x)x=1;else if(Y.ic||Ne(),Y.ic){Y=V.V,Ae=V.Ba,we=V.c;var Fe=V.i,pe=(Ue=1,X=V.$/we,re=V.$%we,xe=V.m,_e=V.s,V.$),ye=we*Fe,Be=we*x,ze=_e.wc,Me=pe<Be?dr(_e,re,X):null;r(pe<=ye),r(x<=Fe),r(Q(_e));t:for(;;){for(;!xe.h&&pe<Be;){if(re&ze||(Me=dr(_e,re,X)),r(Me!=null),K(xe),256>(Fe=Zr(Me.G[0],Me.H[0],xe)))Y[Ae+pe]=Fe,++pe,++re>=we&&(re=0,++X<=x&&!(X%16)&&ae(V,X));else{if(!(280>Fe)){Ue=0;break t}Fe=Aa(Fe-256,xe);var ct,rt=Zr(Me.G[4],Me.H[4],xe);if(K(xe),!(pe>=(rt=xa(we,rt=Aa(rt,xe)))&&ye-pe>=Fe)){Ue=0;break t}for(ct=0;ct<Fe;++ct)Y[Ae+pe+ct]=Y[Ae+pe+ct-rt];for(pe+=Fe,re+=Fe;re>=we;)re-=we,++X<=x&&!(X%16)&&ae(V,X);pe<Be&&re&ze&&(Me=dr(_e,re,X))}r(xe.h==R(xe))}ae(V,X>x?x:X);break t}!Ue||xe.h&&pe<ye?(Ue=0,V.a=xe.h?5:3):V.$=pe,x=Ue}else x=ie(V,V.V,V.Ba,V.c,V.i,x,Te);if(!x){F=0;break e}}S+F>=W&&(h.Cc=1),F=1}if(!F)return null;if(h.Cc&&((F=h.ga)!=null&&(F.mc=null),h.ga=null,0<h.Ga))return alert("todo:WebPDequantizeLevels"),null}return h.nb+S*U}function w(h,x,S,F,U,W){for(;0<U--;){var V,Y=h,X=x+(S?1:0),re=h,xe=x+(S?0:3);for(V=0;V<F;++V){var _e=re[xe+4*V];_e!=255&&(_e*=32897,Y[X+4*V+0]=Y[X+4*V+0]*_e>>23,Y[X+4*V+1]=Y[X+4*V+1]*_e>>23,Y[X+4*V+2]=Y[X+4*V+2]*_e>>23)}x+=W}}function H(h,x,S,F,U){for(;0<F--;){var W;for(W=0;W<S;++W){var V=h[x+2*W+0],Y=15&(re=h[x+2*W+1]),X=4369*Y,re=(240&re|re>>4)*X>>16;h[x+2*W+0]=(240&V|V>>4)*X>>16&240|(15&V|V<<4)*X>>16>>4&15,h[x+2*W+1]=240&re|Y}x+=U}}function ce(h,x,S,F,U,W,V,Y){var X,re,xe=255;for(re=0;re<U;++re){for(X=0;X<F;++X){var _e=h[x+X];W[V+4*X]=_e,xe&=_e}x+=S,V+=Y}return xe!=255}function ue(h,x,S,F,U){var W;for(W=0;W<U;++W)S[F+W]=h[x+W]>>8}function Ne(){qa=w,nr=H,sr=ce,br=ue}function Pe(h,x,S){E[h]=function(F,U,W,V,Y,X,re,xe,_e,Ae,we,Ue,Fe,pe,ye,Be,ze){var Me,ct=ze-1>>1,rt=Y[X+0]|re[xe+0]<<16,xt=_e[Ae+0]|we[Ue+0]<<16;r(F!=null);var nt=3*rt+xt+131074>>2;for(x(F[U+0],255&nt,nt>>16,Fe,pe),W!=null&&(nt=3*xt+rt+131074>>2,x(W[V+0],255&nt,nt>>16,ye,Be)),Me=1;Me<=ct;++Me){var Ut=Y[X+Me]|re[xe+Me]<<16,qt=_e[Ae+Me]|we[Ue+Me]<<16,Rt=rt+Ut+xt+qt+524296,Pt=Rt+2*(Ut+xt)>>3;nt=Pt+rt>>1,rt=(Rt=Rt+2*(rt+qt)>>3)+Ut>>1,x(F[U+2*Me-1],255&nt,nt>>16,Fe,pe+(2*Me-1)*S),x(F[U+2*Me-0],255&rt,rt>>16,Fe,pe+(2*Me-0)*S),W!=null&&(nt=Rt+xt>>1,rt=Pt+qt>>1,x(W[V+2*Me-1],255&nt,nt>>16,ye,Be+(2*Me-1)*S),x(W[V+2*Me+0],255&rt,rt>>16,ye,Be+(2*Me+0)*S)),rt=Ut,xt=qt}1&ze||(nt=3*rt+xt+131074>>2,x(F[U+ze-1],255&nt,nt>>16,Fe,pe+(ze-1)*S),W!=null&&(nt=3*xt+rt+131074>>2,x(W[V+ze-1],255&nt,nt>>16,ye,Be+(ze-1)*S)))}}function Ve(){Ga[pl]=D1,Ga[gl]=Td,Ga[jd]=R1,Ga[vl]=Cd,Ga[yl]=Ed,Ga[$c]=Ld,Ga[Sd]=B1,Ga[Yc]=Td,Ga[Kc]=Cd,Ga[bl]=Ed,Ga[Xc]=Ld}function lt(h){return h&-16384?0>h?0:255:h>>M1}function ut(h,x){return lt((19077*h>>8)+(26149*x>>8)-14234)}function At(h,x,S){return lt((19077*h>>8)-(6419*x>>8)-(13320*S>>8)+8708)}function St(h,x){return lt((19077*h>>8)+(33050*x>>8)-17685)}function It(h,x,S,F,U){F[U+0]=ut(h,S),F[U+1]=At(h,x,S),F[U+2]=St(h,x)}function cr(h,x,S,F,U){F[U+0]=St(h,x),F[U+1]=At(h,x,S),F[U+2]=ut(h,S)}function hr(h,x,S,F,U){var W=At(h,x,S);x=W<<3&224|St(h,x)>>3,F[U+0]=248&ut(h,S)|W>>5,F[U+1]=x}function _r(h,x,S,F,U){var W=240&St(h,x)|15;F[U+0]=240&ut(h,S)|At(h,x,S)>>4,F[U+1]=W}function ea(h,x,S,F,U){F[U+0]=255,It(h,x,S,F,U+1)}function Br(h,x,S,F,U){cr(h,x,S,F,U),F[U+3]=255}function rn(h,x,S,F,U){It(h,x,S,F,U),F[U+3]=255}function Ta(h,x){return 0>h?0:h>x?x:h}function jn(h,x,S){E[h]=function(F,U,W,V,Y,X,re,xe,_e){for(var Ae=xe+(-2&_e)*S;xe!=Ae;)x(F[U+0],W[V+0],Y[X+0],re,xe),x(F[U+1],W[V+0],Y[X+0],re,xe+S),U+=2,++V,++X,xe+=2*S;1&_e&&x(F[U+0],W[V+0],Y[X+0],re,xe)}}function cl(h,x,S){return S==0?h==0?x==0?6:5:x==0?4:0:S}function eo(h,x,S,F,U){switch(h>>>30){case 3:Bn(x,S,F,U,0);break;case 2:yr(x,S,F,U);break;case 1:ca(x,S,F,U)}}function to(h,x){var S,F,U=x.M,W=x.Nb,V=h.oc,Y=h.pc+40,X=h.oc,re=h.pc+584,xe=h.oc,_e=h.pc+600;for(S=0;16>S;++S)V[Y+32*S-1]=129;for(S=0;8>S;++S)X[re+32*S-1]=129,xe[_e+32*S-1]=129;for(0<U?V[Y-1-32]=X[re-1-32]=xe[_e-1-32]=129:(s(V,Y-32-1,127,21),s(X,re-32-1,127,9),s(xe,_e-32-1,127,9)),F=0;F<h.za;++F){var Ae=x.ya[x.aa+F];if(0<F){for(S=-1;16>S;++S)n(V,Y+32*S-4,V,Y+32*S+12,4);for(S=-1;8>S;++S)n(X,re+32*S-4,X,re+32*S+4,4),n(xe,_e+32*S-4,xe,_e+32*S+4,4)}var we=h.Gd,Ue=h.Hd+F,Fe=Ae.ad,pe=Ae.Hc;if(0<U&&(n(V,Y-32,we[Ue].y,0,16),n(X,re-32,we[Ue].f,0,8),n(xe,_e-32,we[Ue].ea,0,8)),Ae.Za){var ye=V,Be=Y-32+16;for(0<U&&(F>=h.za-1?s(ye,Be,we[Ue].y[15],4):n(ye,Be,we[Ue+1].y,0,4)),S=0;4>S;S++)ye[Be+128+S]=ye[Be+256+S]=ye[Be+384+S]=ye[Be+0+S];for(S=0;16>S;++S,pe<<=2)ye=V,Be=Y+Pd[S],an[Ae.Ob[S]](ye,Be),eo(pe,Fe,16*+S,ye,Be)}else if(ye=cl(F,U,Ae.Ob[0]),as[ye](V,Y),pe!=0)for(S=0;16>S;++S,pe<<=2)eo(pe,Fe,16*+S,V,Y+Pd[S]);for(S=Ae.Gc,ye=cl(F,U,Ae.Dd),Un[ye](X,re),Un[ye](xe,_e),pe=Fe,ye=X,Be=re,255&(Ae=S>>0)&&(170&Ae?io(pe,256,ye,Be):Wa(pe,256,ye,Be)),Ae=xe,pe=_e,255&(S>>=8)&&(170&S?io(Fe,320,Ae,pe):Wa(Fe,320,Ae,pe)),U<h.Ub-1&&(n(we[Ue].y,0,V,Y+480,16),n(we[Ue].f,0,X,re+224,8),n(we[Ue].ea,0,xe,_e+224,8)),S=8*W*h.B,we=h.sa,Ue=h.ta+16*F+16*W*h.R,Fe=h.qa,Ae=h.ra+8*F+S,pe=h.Ha,ye=h.Ia+8*F+S,S=0;16>S;++S)n(we,Ue+S*h.R,V,Y+32*S,16);for(S=0;8>S;++S)n(Fe,Ae+S*h.B,X,re+32*S,8),n(pe,ye+S*h.B,xe,_e+32*S,8)}}function ii(h,x,S,F,U,W,V,Y,X){var re=[0],xe=[0],_e=0,Ae=X!=null?X.kd:0,we=X??new Xi;if(h==null||12>S)return 7;we.data=h,we.w=x,we.ha=S,x=[x],S=[S],we.gb=[we.gb];e:{var Ue=x,Fe=S,pe=we.gb;if(r(h!=null),r(Fe!=null),r(pe!=null),pe[0]=0,12<=Fe[0]&&!t(h,Ue[0],"RIFF")){if(t(h,Ue[0]+8,"WEBP")){pe=3;break e}var ye=$e(h,Ue[0]+4);if(12>ye||4294967286<ye){pe=3;break e}if(Ae&&ye>Fe[0]-8){pe=7;break e}pe[0]=ye,Ue[0]+=12,Fe[0]-=12}pe=0}if(pe!=0)return pe;for(ye=0<we.gb[0],S=S[0];;){e:{var Be=h;Fe=x,pe=S;var ze=re,Me=xe,ct=Ue=[0];if((nt=_e=[_e])[0]=0,8>pe[0])pe=7;else{if(!t(Be,Fe[0],"VP8X")){if($e(Be,Fe[0]+4)!=10){pe=3;break e}if(18>pe[0]){pe=7;break e}var rt=$e(Be,Fe[0]+8),xt=1+De(Be,Fe[0]+12);if(2147483648<=xt*(Be=1+De(Be,Fe[0]+15))){pe=3;break e}ct!=null&&(ct[0]=rt),ze!=null&&(ze[0]=xt),Me!=null&&(Me[0]=Be),Fe[0]+=18,pe[0]-=18,nt[0]=1}pe=0}}if(_e=_e[0],Ue=Ue[0],pe!=0)return pe;if(Fe=!!(2&Ue),!ye&&_e)return 3;if(W!=null&&(W[0]=!!(16&Ue)),V!=null&&(V[0]=Fe),Y!=null&&(Y[0]=0),V=re[0],Ue=xe[0],_e&&Fe&&X==null){pe=0;break}if(4>S){pe=7;break}if(ye&&_e||!ye&&!_e&&!t(h,x[0],"ALPH")){S=[S],we.na=[we.na],we.P=[we.P],we.Sa=[we.Sa];e:{rt=h,pe=x,ye=S;var nt=we.gb;ze=we.na,Me=we.P,ct=we.Sa,xt=22,r(rt!=null),r(ye!=null),Be=pe[0];var Ut=ye[0];for(r(ze!=null),r(ct!=null),ze[0]=null,Me[0]=null,ct[0]=0;;){if(pe[0]=Be,ye[0]=Ut,8>Ut){pe=7;break e}var qt=$e(rt,Be+4);if(4294967286<qt){pe=3;break e}var Rt=8+qt+1&-2;if(xt+=Rt,0<nt&&xt>nt){pe=3;break e}if(!t(rt,Be,"VP8 ")||!t(rt,Be,"VP8L")){pe=0;break e}if(Ut[0]<Rt){pe=7;break e}t(rt,Be,"ALPH")||(ze[0]=rt,Me[0]=Be+8,ct[0]=qt),Be+=Rt,Ut-=Rt}}if(S=S[0],we.na=we.na[0],we.P=we.P[0],we.Sa=we.Sa[0],pe!=0)break}S=[S],we.Ja=[we.Ja],we.xa=[we.xa];e:if(nt=h,pe=x,ye=S,ze=we.gb[0],Me=we.Ja,ct=we.xa,rt=pe[0],Be=!t(nt,rt,"VP8 "),xt=!t(nt,rt,"VP8L"),r(nt!=null),r(ye!=null),r(Me!=null),r(ct!=null),8>ye[0])pe=7;else{if(Be||xt){if(nt=$e(nt,rt+4),12<=ze&&nt>ze-12){pe=3;break e}if(Ae&&nt>ye[0]-8){pe=7;break e}Me[0]=nt,pe[0]+=8,ye[0]-=8,ct[0]=xt}else ct[0]=5<=ye[0]&&nt[rt+0]==47&&!(nt[rt+4]>>5),Me[0]=ye[0];pe=0}if(S=S[0],we.Ja=we.Ja[0],we.xa=we.xa[0],x=x[0],pe!=0)break;if(4294967286<we.Ja)return 3;if(Y==null||Fe||(Y[0]=we.xa?2:1),V=[V],Ue=[Ue],we.xa){if(5>S){pe=7;break}Y=V,Ae=Ue,Fe=W,h==null||5>S?h=0:5<=S&&h[x+0]==47&&!(h[x+4]>>5)?(ye=[0],nt=[0],ze=[0],oe(Me=new A,h,x,S),mt(Me,ye,nt,ze)?(Y!=null&&(Y[0]=ye[0]),Ae!=null&&(Ae[0]=nt[0]),Fe!=null&&(Fe[0]=ze[0]),h=1):h=0):h=0}else{if(10>S){pe=7;break}Y=Ue,h==null||10>S||!$o(h,x+3,S-3)?h=0:(Ae=h[x+0]|h[x+1]<<8|h[x+2]<<16,Fe=16383&(h[x+7]<<8|h[x+6]),h=16383&(h[x+9]<<8|h[x+8]),1&Ae||3<(Ae>>1&7)||!(Ae>>4&1)||Ae>>5>=we.Ja||!Fe||!h?h=0:(V&&(V[0]=Fe),Y&&(Y[0]=h),h=1))}if(!h||(V=V[0],Ue=Ue[0],_e&&(re[0]!=V||xe[0]!=Ue)))return 3;X!=null&&(X[0]=we,X.offset=x-X.w,r(4294967286>x-X.w),r(X.offset==X.ha-S));break}return pe==0||pe==7&&_e&&X==null?(W!=null&&(W[0]|=we.na!=null&&0<we.na.length),F!=null&&(F[0]=V),U!=null&&(U[0]=Ue),0):pe}function ro(h,x,S){var F=x.width,U=x.height,W=0,V=0,Y=F,X=U;if(x.Da=h!=null&&0<h.Da,x.Da&&(Y=h.cd,X=h.bd,W=h.v,V=h.j,11>S||(W&=-2,V&=-2),0>W||0>V||0>=Y||0>=X||W+Y>F||V+X>U))return 0;if(x.v=W,x.j=V,x.va=W+Y,x.o=V+X,x.U=Y,x.T=X,x.da=h!=null&&0<h.da,x.da){if(!He(Y,X,S=[h.ib],W=[h.hb]))return 0;x.ib=S[0],x.hb=W[0]}return x.ob=h!=null&&h.ob,x.Kb=h==null||!h.Sd,x.da&&(x.ob=x.ib<3*F/4&&x.hb<3*U/4,x.Kb=0),1}function ao(h){if(h==null)return 2;if(11>h.S){var x=h.f.RGBA;x.fb+=(h.height-1)*x.A,x.A=-x.A}else x=h.f.kb,h=h.height,x.O+=(h-1)*x.fa,x.fa=-x.fa,x.N+=(h-1>>1)*x.Ab,x.Ab=-x.Ab,x.W+=(h-1>>1)*x.Db,x.Db=-x.Db,x.F!=null&&(x.J+=(h-1)*x.lb,x.lb=-x.lb);return 0}function oi(h,x,S,F){if(F==null||0>=h||0>=x)return 2;if(S!=null){if(S.Da){var U=S.cd,W=S.bd,V=-2&S.v,Y=-2&S.j;if(0>V||0>Y||0>=U||0>=W||V+U>h||Y+W>x)return 2;h=U,x=W}if(S.da){if(!He(h,x,U=[S.ib],W=[S.hb]))return 2;h=U[0],x=W[0]}}F.width=h,F.height=x;e:{var X=F.width,re=F.height;if(h=F.S,0>=X||0>=re||!(h>=pl&&13>h))h=2;else{if(0>=F.Rd&&F.sd==null){V=W=U=x=0;var xe=(Y=X*Od[h])*re;if(11>h||(W=(re+1)/2*(x=(X+1)/2),h==12&&(V=(U=X)*re)),(re=o(xe+2*W+V))==null){h=1;break e}F.sd=re,11>h?((X=F.f.RGBA).eb=re,X.fb=0,X.A=Y,X.size=xe):((X=F.f.kb).y=re,X.O=0,X.fa=Y,X.Fd=xe,X.f=re,X.N=0+xe,X.Ab=x,X.Cd=W,X.ea=re,X.W=0+xe+W,X.Db=x,X.Ed=W,h==12&&(X.F=re,X.J=0+xe+2*W),X.Tc=V,X.lb=U)}if(x=1,U=F.S,W=F.width,V=F.height,U>=pl&&13>U)if(11>U)h=F.f.RGBA,x&=(Y=Math.abs(h.A))*(V-1)+W<=h.size,x&=Y>=W*Od[U],x&=h.eb!=null;else{h=F.f.kb,Y=(W+1)/2,xe=(V+1)/2,X=Math.abs(h.fa),re=Math.abs(h.Ab);var _e=Math.abs(h.Db),Ae=Math.abs(h.lb),we=Ae*(V-1)+W;x&=X*(V-1)+W<=h.Fd,x&=re*(xe-1)+Y<=h.Cd,x=(x&=_e*(xe-1)+Y<=h.Ed)&X>=W&re>=Y&_e>=Y,x&=h.y!=null,x&=h.f!=null,x&=h.ea!=null,U==12&&(x&=Ae>=W,x&=we<=h.Tc,x&=h.F!=null)}else x=0;h=x?0:2}}return h!=0||S!=null&&S.fd&&(h=ao(F)),h}var qr=64,li=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ci=24,di=32,no=8,ga=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Xe("Predictor0","PredictorAdd0"),E.Predictor0=function(){return 4278190080},E.Predictor1=function(h){return h},E.Predictor2=function(h,x,S){return x[S+0]},E.Predictor3=function(h,x,S){return x[S+1]},E.Predictor4=function(h,x,S){return x[S-1]},E.Predictor5=function(h,x,S){return at(at(h,x[S+1]),x[S+0])},E.Predictor6=function(h,x,S){return at(h,x[S-1])},E.Predictor7=function(h,x,S){return at(h,x[S+0])},E.Predictor8=function(h,x,S){return at(x[S-1],x[S+0])},E.Predictor9=function(h,x,S){return at(x[S+0],x[S+1])},E.Predictor10=function(h,x,S){return at(at(h,x[S-1]),at(x[S+0],x[S+1]))},E.Predictor11=function(h,x,S){var F=x[S+0];return 0>=wt(F>>24&255,h>>24&255,(x=x[S-1])>>24&255)+wt(F>>16&255,h>>16&255,x>>16&255)+wt(F>>8&255,h>>8&255,x>>8&255)+wt(255&F,255&h,255&x)?F:h},E.Predictor12=function(h,x,S){var F=x[S+0];return(ht((h>>24&255)+(F>>24&255)-((x=x[S-1])>>24&255))<<24|ht((h>>16&255)+(F>>16&255)-(x>>16&255))<<16|ht((h>>8&255)+(F>>8&255)-(x>>8&255))<<8|ht((255&h)+(255&F)-(255&x)))>>>0},E.Predictor13=function(h,x,S){var F=x[S-1];return(ft((h=at(h,x[S+0]))>>24&255,F>>24&255)<<24|ft(h>>16&255,F>>16&255)<<16|ft(h>>8&255,F>>8&255)<<8|ft(h>>0&255,F>>0&255))>>>0};var Vc=E.PredictorAdd0;E.PredictorAdd1=kt,Xe("Predictor2","PredictorAdd2"),Xe("Predictor3","PredictorAdd3"),Xe("Predictor4","PredictorAdd4"),Xe("Predictor5","PredictorAdd5"),Xe("Predictor6","PredictorAdd6"),Xe("Predictor7","PredictorAdd7"),Xe("Predictor8","PredictorAdd8"),Xe("Predictor9","PredictorAdd9"),Xe("Predictor10","PredictorAdd10"),Xe("Predictor11","PredictorAdd11"),Xe("Predictor12","PredictorAdd12"),Xe("Predictor13","PredictorAdd13");var so=E.PredictorAdd2;Ct("ColorIndexInverseTransform","MapARGB","32b",function(h){return h>>8&255},function(h){return h}),Ct("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(h){return h},function(h){return h>>8&255});var dl,Ha=E.ColorIndexInverseTransform,hi=E.MapARGB,hl=E.VP8LColorIndexInverseTransformAlpha,fl=E.MapAlpha,Qn=E.VP8LPredictorsAdd=[];Qn.length=16,(E.VP8LPredictors=[]).length=16,(E.VP8LPredictorsAdd_C=[]).length=16,(E.VP8LPredictors_C=[]).length=16;var Cs,va,la,es,Dn,Rn,fi,Bn,yr,io,ca,Wa,ui,ul,oo,Es,Ls,ts,Fs,mi,Ps,rs,lo,za,qa,nr,sr,br,Or=o(511),Mn=o(2041),co=o(225),xi=o(767),ml=0,Gc=Mn,xl=co,Ca=xi,Va=Or,pl=0,gl=1,jd=2,vl=3,yl=4,$c=5,Sd=6,Yc=7,Kc=8,bl=9,Xc=10,N1=[2,3,7],j1=[3,3,11],_d=[280,256,256,256,40],S1=[0,1,1,1,0],_1=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],A1=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],k1=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],T1=8,Jc=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Zc=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],ho=null,C1=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],E1=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Ad=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],L1=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],F1=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],P1=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],O1=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],as=[],an=[],Un=[],I1=1,kd=2,ns=[],Ga=[];Pe("UpsampleRgbLinePair",It,3),Pe("UpsampleBgrLinePair",cr,3),Pe("UpsampleRgbaLinePair",rn,4),Pe("UpsampleBgraLinePair",Br,4),Pe("UpsampleArgbLinePair",ea,4),Pe("UpsampleRgba4444LinePair",_r,2),Pe("UpsampleRgb565LinePair",hr,2);var D1=E.UpsampleRgbLinePair,R1=E.UpsampleBgrLinePair,Td=E.UpsampleRgbaLinePair,Cd=E.UpsampleBgraLinePair,Ed=E.UpsampleArgbLinePair,Ld=E.UpsampleRgba4444LinePair,B1=E.UpsampleRgb565LinePair,wl=16,Nl=1<<wl-1,fo=-227,Qc=482,M1=6,Fd=0,U1=o(256),H1=o(256),W1=o(256),z1=o(256),q1=o(Qc-fo),V1=o(Qc-fo);jn("YuvToRgbRow",It,3),jn("YuvToBgrRow",cr,3),jn("YuvToRgbaRow",rn,4),jn("YuvToBgraRow",Br,4),jn("YuvToArgbRow",ea,4),jn("YuvToRgba4444Row",_r,2),jn("YuvToRgb565Row",hr,2);var Pd=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],jl=[0,2,8],G1=[8,7,6,4,4,2,2,2,1,1,1,1],$1=1;this.WebPDecodeRGBA=function(h,x,S,F,U){var W=gl,V=new ni,Y=new _a;V.ba=Y,Y.S=W,Y.width=[Y.width],Y.height=[Y.height];var X=Y.width,re=Y.height,xe=new Ja;if(xe==null||h==null)var _e=2;else r(xe!=null),_e=ii(h,x,S,xe.width,xe.height,xe.Pd,xe.Qd,xe.format,null);if(_e!=0?X=0:(X!=null&&(X[0]=xe.width[0]),re!=null&&(re[0]=xe.height[0]),X=1),X){Y.width=Y.width[0],Y.height=Y.height[0],F!=null&&(F[0]=Y.width),U!=null&&(U[0]=Y.height);e:{if(F=new bn,(U=new Xi).data=h,U.w=x,U.ha=S,U.kd=1,x=[0],r(U!=null),((h=ii(U.data,U.w,U.ha,null,null,null,x,null,U))==0||h==7)&&x[0]&&(h=4),(x=h)==0){if(r(V!=null),F.data=U.data,F.w=U.w+U.offset,F.ha=U.ha-U.offset,F.put=Ma,F.ac=Pr,F.bc=Ua,F.ma=V,U.xa){if((h=Le())==null){V=1;break e}if(function(Ae,we){var Ue=[0],Fe=[0],pe=[0];t:for(;;){if(Ae==null)return 0;if(we==null)return Ae.a=2,0;if(Ae.l=we,Ae.a=0,oe(Ae.m,we.data,we.w,we.ha),!mt(Ae.m,Ue,Fe,pe)){Ae.a=3;break t}if(Ae.xb=kd,we.width=Ue[0],we.height=Fe[0],!je(Ue[0],Fe[0],1,Ae,null))break t;return 1}return r(Ae.a!=0),0}(h,F)){if(F=(x=oi(F.width,F.height,V.Oa,V.ba))==0){t:{F=h;r:for(;;){if(F==null){F=0;break t}if(r(F.s.yc!=null),r(F.s.Ya!=null),r(0<F.s.Wb),r((S=F.l)!=null),r((U=S.ma)!=null),F.xb!=0){if(F.ca=U.ba,F.tb=U.tb,r(F.ca!=null),!ro(U.Oa,S,vl)){F.a=2;break r}if(!ke(F,S.width)||S.da)break r;if((S.da||Dt(F.ca.S))&&Ne(),11>F.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),F.ca.f.kb.F!=null&&Ne()),F.Pb&&0<F.s.ua&&F.s.vb.X==null&&!Ke(F.s.vb,F.s.Wa.Xa)){F.a=1;break r}F.xb=0}if(!ie(F,F.V,F.Ba,F.c,F.i,S.o,se))break r;U.Dc=F.Ma,F=1;break t}r(F.a!=0),F=0}F=!F}F&&(x=h.a)}else x=h.a}else{if((h=new ka)==null){V=1;break e}if(h.Fa=U.na,h.P=U.P,h.qc=U.Sa,Yo(h,F)){if((x=oi(F.width,F.height,V.Oa,V.ba))==0){if(h.Aa=0,S=V.Oa,r((U=h)!=null),S!=null){if(0<(X=0>(X=S.Md)?0:100<X?255:255*X/100)){for(re=xe=0;4>re;++re)12>(_e=U.pb[re]).lc&&(_e.ia=X*G1[0>_e.lc?0:_e.lc]>>3),xe|=_e.ia;xe&&(alert("todo:VP8InitRandom"),U.ia=1)}U.Ga=S.Id,100<U.Ga?U.Ga=100:0>U.Ga&&(U.Ga=0)}kc(h,F)||(x=h.a)}}else x=h.a}x==0&&V.Oa!=null&&V.Oa.fd&&(x=ao(V.ba))}V=x}W=V!=0?null:11>W?Y.f.RGBA.eb:Y.f.kb.y}else W=null;return W};var Od=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function f(E,P){for(var D="",k=0;k<4;k++)D+=String.fromCharCode(E[P++]);return D}function u(E,P){return(E[P+0]<<0|E[P+1]<<8|E[P+2]<<16)>>>0}function g(E,P){return(E[P+0]<<0|E[P+1]<<8|E[P+2]<<16|E[P+3]<<24)>>>0}new d;var p=[0],m=[0],j=[],v=new d,N=e,b=function(E,P){var D={},k=0,C=!1,z=0,G=0;if(D.frames=[],!function(I,R,M,K){for(var he=0;he<K;he++)if(I[R+he]!=M.charCodeAt(he))return!0;return!1}(E,P,"RIFF",4)){var de,J;for(g(E,P+=4),P+=8;P<E.length;){var Z=f(E,P),oe=g(E,P+=4);P+=4;var ne=oe+(1&oe);switch(Z){case"VP8 ":case"VP8L":D.frames[k]===void 0&&(D.frames[k]={}),(A=D.frames[k]).src_off=C?G:P-8,A.src_size=z+oe+8,k++,C&&(C=!1,z=0,G=0);break;case"VP8X":(A=D.header={}).feature_flags=E[P];var me=P+4;A.canvas_width=1+u(E,me),me+=3,A.canvas_height=1+u(E,me),me+=3;break;case"ALPH":C=!0,z=ne+8,G=P-8;break;case"ANIM":(A=D.header).bgcolor=g(E,P),me=P+4,A.loop_count=(de=E)[(J=me)+0]<<0|de[J+1]<<8,me+=2;break;case"ANMF":var be,A;(A=D.frames[k]={}).offset_x=2*u(E,P),P+=3,A.offset_y=2*u(E,P),P+=3,A.width=1+u(E,P),P+=3,A.height=1+u(E,P),P+=3,A.duration=u(E,P),P+=3,be=E[P++],A.dispose=1&be,A.blend=be>>1&1}Z!="ANMF"&&(P+=ne)}return D}}(N,0);b.response=N,b.rgbaoutput=!0,b.dataurl=!1;var y=b.header?b.header:null,_=b.frames?b.frames:null;if(y){y.loop_counter=y.loop_count,p=[y.canvas_height],m=[y.canvas_width];for(var T=0;T<_.length&&_[T].blend!=0;T++);}var O=_[0],B=v.WebPDecodeRGBA(N,O.src_off,O.src_size,m,p);O.rgba=B,O.imgwidth=m[0],O.imgheight=p[0];for(var L=0;L<m[0]*p[0]*4;L++)j[L]=B[L];return this.width=m,this.height=p,this.data=j,this}(function(e){var r=function(){return typeof U0=="function"},t=function(p,m,j,v){var N=4,b=l;switch(v){case e.image_compression.FAST:N=1,b=o;break;case e.image_compression.MEDIUM:N=6,b=c;break;case e.image_compression.SLOW:N=9,b=d}p=n(p,m,j,b);var y=U0(p,{level:N});return e.__addimage__.arrayBufferToBinaryString(y)},n=function(p,m,j,v){for(var N,b,y,_=p.length/m,T=new Uint8Array(p.length+_),O=u(),B=0;B<_;B+=1){if(y=B*m,N=p.subarray(y,y+m),v)T.set(v(N,j,b),y+B);else{for(var L,E=O.length,P=[];L<E;L+=1)P[L]=O[L](N,j,b);var D=g(P.concat());T.set(P[D],y+B)}b=N}return T},s=function(p){var m=Array.apply([],p);return m.unshift(0),m},o=function(p,m){var j,v=[],N=p.length;v[0]=1;for(var b=0;b<N;b+=1)j=p[b-m]||0,v[b+1]=p[b]-j+256&255;return v},l=function(p,m,j){var v,N=[],b=p.length;N[0]=2;for(var y=0;y<b;y+=1)v=j&&j[y]||0,N[y+1]=p[y]-v+256&255;return N},c=function(p,m,j){var v,N,b=[],y=p.length;b[0]=3;for(var _=0;_<y;_+=1)v=p[_-m]||0,N=j&&j[_]||0,b[_+1]=p[_]+256-(v+N>>>1)&255;return b},d=function(p,m,j){var v,N,b,y,_=[],T=p.length;_[0]=4;for(var O=0;O<T;O+=1)v=p[O-m]||0,N=j&&j[O]||0,b=j&&j[O-m]||0,y=f(v,N,b),_[O+1]=p[O]-y+256&255;return _},f=function(p,m,j){if(p===m&&m===j)return p;var v=Math.abs(m-j),N=Math.abs(p-j),b=Math.abs(p+m-j-j);return v<=N&&v<=b?p:N<=b?m:j},u=function(){return[s,o,l,c,d]},g=function(p){var m=p.map(function(j){return j.reduce(function(v,N){return v+Math.abs(N)},0)});return m.indexOf(Math.min.apply(null,m))};e.processPNG=function(p,m,j,v){var N,b,y,_,T,O,B,L,E,P,D,k,C,z,G,de=this.decode.FLATE_DECODE,J="";if(this.__addimage__.isArrayBuffer(p)&&(p=new Uint8Array(p)),this.__addimage__.isArrayBufferView(p)){if(p=(y=new kp(p)).imgData,b=y.bits,N=y.colorSpace,T=y.colors,[4,6].indexOf(y.colorType)!==-1){if(y.bits===8){E=(L=y.pixelBitlength==32?new Uint32Array(y.decodePixels().buffer):y.pixelBitlength==16?new Uint16Array(y.decodePixels().buffer):new Uint8Array(y.decodePixels().buffer)).length,D=new Uint8Array(E*y.colors),P=new Uint8Array(E);var Z,oe=y.pixelBitlength-y.bits;for(z=0,G=0;z<E;z++){for(C=L[z],Z=0;Z<oe;)D[G++]=C>>>Z&255,Z+=y.bits;P[z]=C>>>Z&255}}if(y.bits===16){E=(L=new Uint32Array(y.decodePixels().buffer)).length,D=new Uint8Array(E*(32/y.pixelBitlength)*y.colors),P=new Uint8Array(E*(32/y.pixelBitlength)),k=y.colors>1,z=0,G=0;for(var ne=0;z<E;)C=L[z++],D[G++]=C>>>0&255,k&&(D[G++]=C>>>16&255,C=L[z++],D[G++]=C>>>0&255),P[ne++]=C>>>16&255;b=8}v!==e.image_compression.NONE&&r()?(p=t(D,y.width*y.colors,y.colors,v),B=t(P,y.width,1,v)):(p=D,B=P,de=void 0)}if(y.colorType===3&&(N=this.color_spaces.INDEXED,O=y.palette,y.transparency.indexed)){var me=y.transparency.indexed,be=0;for(z=0,E=me.length;z<E;++z)be+=me[z];if((be/=255)===E-1&&me.indexOf(0)!==-1)_=[me.indexOf(0)];else if(be!==E){for(L=y.decodePixels(),P=new Uint8Array(L.length),z=0,E=L.length;z<E;z++)P[z]=me[L[z]];B=t(P,y.width,1)}}var A=function(I){var R;switch(I){case e.image_compression.FAST:R=11;break;case e.image_compression.MEDIUM:R=13;break;case e.image_compression.SLOW:R=14;break;default:R=12}return R}(v);return de===this.decode.FLATE_DECODE&&(J="/Predictor "+A+" "),J+="/Colors "+T+" /BitsPerComponent "+b+" /Columns "+y.width,(this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),(B&&this.__addimage__.isArrayBuffer(B)||this.__addimage__.isArrayBufferView(B))&&(B=this.__addimage__.arrayBufferToBinaryString(B)),{alias:j,data:p,index:m,filter:de,decodeParameters:J,transparency:_,palette:O,sMask:B,predictor:A,width:y.width,height:y.height,bitsPerComponent:b,colorSpace:N}}}})(pt.API),function(e){e.processGIF89A=function(r,t,n,s){var o=new Tp(r),l=o.width,c=o.height,d=[];o.decodeAndBlitFrameRGBA(0,d);var f={data:d,width:l,height:c},u=new j0(100).encode(f,100);return e.processJPEG.call(this,u,t,n,s)},e.processGIF87A=e.processGIF89A}(pt.API),on.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var r=0;r<e;r++){var t=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0);this.palette[r]={red:s,green:n,blue:t,quad:o}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},on.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,r=this.width*this.height*4;this.data=new Uint8Array(r),this[e]()}catch(t){tr.log("bit decode error:"+t)}},on.prototype.bit1=function(){var e,r=Math.ceil(this.width/8),t=r%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,s=0;s<r;s++)for(var o=this.datav.getUint8(this.pos++,!0),l=n*this.width*4+8*s*4,c=0;c<8&&8*s+c<this.width;c++){var d=this.palette[o>>7-c&1];this.data[l+4*c]=d.blue,this.data[l+4*c+1]=d.green,this.data[l+4*c+2]=d.red,this.data[l+4*c+3]=255}t!==0&&(this.pos+=4-t)}},on.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),r=e%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,s=0;s<e;s++){var o=this.datav.getUint8(this.pos++,!0),l=n*this.width*4+2*s*4,c=o>>4,d=15&o,f=this.palette[c];if(this.data[l]=f.blue,this.data[l+1]=f.green,this.data[l+2]=f.red,this.data[l+3]=255,2*s+1>=this.width)break;f=this.palette[d],this.data[l+4]=f.blue,this.data[l+4+1]=f.green,this.data[l+4+2]=f.red,this.data[l+4+3]=255}r!==0&&(this.pos+=4-r)}},on.prototype.bit8=function(){for(var e=this.width%4,r=this.height-1;r>=0;r--){for(var t=this.bottom_up?r:this.height-1-r,n=0;n<this.width;n++){var s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*n;if(s<this.palette.length){var l=this.palette[s];this.data[o]=l.red,this.data[o+1]=l.green,this.data[o+2]=l.blue,this.data[o+3]=255}else this.data[o]=255,this.data[o+1]=255,this.data[o+2]=255,this.data[o+3]=255}e!==0&&(this.pos+=4-e)}},on.prototype.bit15=function(){for(var e=this.width%3,r=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&r)/r*255|0,c=(o>>5&r)/r*255|0,d=(o>>10&r)/r*255|0,f=o>>15?255:0,u=n*this.width*4+4*s;this.data[u]=d,this.data[u+1]=c,this.data[u+2]=l,this.data[u+3]=f}this.pos+=e}},on.prototype.bit16=function(){for(var e=this.width%3,r=parseInt("11111",2),t=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,o=0;o<this.width;o++){var l=this.datav.getUint16(this.pos,!0);this.pos+=2;var c=(l&r)/r*255|0,d=(l>>5&t)/t*255|0,f=(l>>11)/r*255|0,u=s*this.width*4+4*o;this.data[u]=f,this.data[u+1]=d,this.data[u+2]=c,this.data[u+3]=255}this.pos+=e}},on.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=r*this.width*4+4*t;this.data[l]=o,this.data[l+1]=s,this.data[l+2]=n,this.data[l+3]=255}this.pos+=this.width%4}},on.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var r=this.bottom_up?e:this.height-1-e,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),c=r*this.width*4+4*t;this.data[c]=o,this.data[c+1]=s,this.data[c+2]=n,this.data[c+3]=l}},on.prototype.getData=function(){return this.data},function(e){e.processBMP=function(r,t,n,s){var o=new on(r,!1),l=o.width,c=o.height,d={data:o.getData(),width:l,height:c},f=new j0(100).encode(d,100);return e.processJPEG.call(this,f,t,n,s)}}(pt.API),Ah.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(r,t,n,s){var o=new Ah(r),l=o.width,c=o.height,d={data:o.getData(),width:l,height:c},f=new j0(100).encode(d,100);return e.processJPEG.call(this,f,t,n,s)}}(pt.API),pt.API.processRGBA=function(e,r,t){for(var n=e.data,s=n.length,o=new Uint8Array(s/4*3),l=new Uint8Array(s/4),c=0,d=0,f=0;f<s;f+=4){var u=n[f],g=n[f+1],p=n[f+2],m=n[f+3];o[c++]=u,o[c++]=g,o[c++]=p,l[d++]=m}var j=this.__addimage__.arrayBufferToBinaryString(o);return{alpha:this.__addimage__.arrayBufferToBinaryString(l),data:j,index:r,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},pt.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},wi=pt.API,Wl=wi.getCharWidthsArray=function(e,r){var t,n,s=(r=r||{}).font||this.internal.getFont(),o=r.fontSize||this.internal.getFontSize(),l=r.charSpace||this.internal.getCharSpace(),c=r.widths?r.widths:s.metadata.Unicode.widths,d=c.fof?c.fof:1,f=r.kerning?r.kerning:s.metadata.Unicode.kerning,u=f.fof?f.fof:1,g=r.doKerning!==!1,p=0,m=e.length,j=0,v=c[0]||d,N=[];for(t=0;t<m;t++)n=e.charCodeAt(t),typeof s.metadata.widthOfString=="function"?N.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(n))+l*(1e3/o)||0)/1e3):(p=g&&rr(f[n])==="object"&&!isNaN(parseInt(f[n][j],10))?f[n][j]/u:0,N.push((c[n]||v)/d+p)),j=n;return N},Nh=wi.getStringUnitWidth=function(e,r){var t=(r=r||{}).fontSize||this.internal.getFontSize(),n=r.font||this.internal.getFont(),s=r.charSpace||this.internal.getCharSpace();return wi.processArabic&&(e=wi.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,t,s)/t:Wl.apply(this,arguments).reduce(function(o,l){return o+l},0)},jh=function(e,r,t,n){for(var s=[],o=0,l=e.length,c=0;o!==l&&c+r[o]<t;)c+=r[o],o++;s.push(e.slice(0,o));var d=o;for(c=0;o!==l;)c+r[o]>n&&(s.push(e.slice(d,o)),c=0,d=o),c+=r[o],o++;return d!==o&&s.push(e.slice(d,o)),s},Sh=function(e,r,t){t||(t={});var n,s,o,l,c,d,f,u=[],g=[u],p=t.textIndent||0,m=0,j=0,v=e.split(" "),N=Wl.apply(this,[" ",t])[0];if(d=t.lineIndent===-1?v[0].length+2:t.lineIndent||0){var b=Array(d).join(" "),y=[];v.map(function(T){(T=T.split(/\s*\n/)).length>1?y=y.concat(T.map(function(O,B){return(B&&O.length?`
`:"")+O})):y.push(T[0])}),v=y,d=Nh.apply(this,[b,t])}for(o=0,l=v.length;o<l;o++){var _=0;if(n=v[o],d&&n[0]==`
`&&(n=n.substr(1),_=1),p+m+(j=(s=Wl.apply(this,[n,t])).reduce(function(T,O){return T+O},0))>r||_){if(j>r){for(c=jh.apply(this,[n,s,r-(p+m),r]),u.push(c.shift()),u=[c.pop()];c.length;)g.push([c.shift()]);j=s.slice(n.length-(u[0]?u[0].length:0)).reduce(function(T,O){return T+O},0)}else u=[n];g.push(u),p=j+d,m=N}else u.push(n),p+=m+j,m=N}return f=d?function(T,O){return(O?b:"")+T.join(" ")}:function(T){return T.join(" ")},g.map(f)},wi.splitTextToSize=function(e,r,t){var n,s=(t=t||{}).fontSize||this.internal.getFontSize(),o=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var g=this.internal.getFont(u.fontName,u.fontStyle);return g.metadata.Unicode?{widths:g.metadata.Unicode.widths||{0:1},kerning:g.metadata.Unicode.kerning||{}}:{font:g.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var l=1*this.internal.scaleFactor*r/s;o.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/s:0,o.lineIndent=t.lineIndent;var c,d,f=[];for(c=0,d=n.length;c<d;c++)f=f.concat(Sh.apply(this,[n[c],l,o]));return f},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var r="klmnopqrstuvwxyz",t={},n={},s=0;s<r.length;s++)t[r[s]]="0123456789abcdef"[s],n["0123456789abcdef"[s]]=r[s];var o=function(g){return"0x"+parseInt(g,10).toString(16)},l=e.__fontmetrics__.compress=function(g){var p,m,j,v,N=["{"];for(var b in g){if(p=g[b],isNaN(parseInt(b,10))?m="'"+b+"'":(b=parseInt(b,10),m=(m=o(b).slice(2)).slice(0,-1)+n[m.slice(-1)]),typeof p=="number")p<0?(j=o(p).slice(3),v="-"):(j=o(p).slice(2),v=""),j=v+j.slice(0,-1)+n[j.slice(-1)];else{if(rr(p)!=="object")throw new Error("Don't know what to do with value type "+rr(p)+".");j=l(p)}N.push(m+j)}return N.push("}"),N.join("")},c=e.__fontmetrics__.uncompress=function(g){if(typeof g!="string")throw new Error("Invalid argument passed to uncompress.");for(var p,m,j,v,N={},b=1,y=N,_=[],T="",O="",B=g.length-1,L=1;L<B;L+=1)(v=g[L])=="'"?p?(j=p.join(""),p=void 0):p=[]:p?p.push(v):v=="{"?(_.push([y,j]),y={},j=void 0):v=="}"?((m=_.pop())[0][m[1]]=y,j=void 0,y=m[0]):v=="-"?b=-1:j===void 0?t.hasOwnProperty(v)?(T+=t[v],j=parseInt(T,16)*b,b=1,T=""):T+=v:t.hasOwnProperty(v)?(O+=t[v],y[j]=parseInt(O,16)*b,b=1,j=void 0,O=""):O+=v;return N},d={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},f={Unicode:{Courier:d,"Courier-Bold":d,"Courier-BoldOblique":d,"Courier-Oblique":d,Helvetica:d,"Helvetica-Bold":d,"Helvetica-BoldOblique":d,"Helvetica-Oblique":d,"Times-Roman":d,"Times-Bold":d,"Times-BoldItalic":d,"Times-Italic":d}},u={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(g){var p=g.font,m=u.Unicode[p.postScriptName];m&&(p.metadata.Unicode={},p.metadata.Unicode.widths=m.widths,p.metadata.Unicode.kerning=m.kerning);var j=f.Unicode[p.postScriptName];j&&(p.metadata.Unicode.encoding=j,p.encoding=j.codePages[0])}])}(pt.API),function(e){var r=function(t){for(var n=t.length,s=new Uint8Array(n),o=0;o<n;o++)s[o]=t.charCodeAt(o);return s};e.API.events.push(["addFont",function(t){var n=void 0,s=t.font,o=t.instance;if(!s.isStandardFont){if(o===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(n=o.existsFileInVFS(s.postScriptName)===!1?o.loadFile(s.postScriptName):o.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(l,c){c=/^\x00\x01\x00\x00/.test(c)?r(c):r(wo(c)),l.metadata=e.API.TTFFont.open(c),l.metadata.Unicode=l.metadata.Unicode||{encoding:{},kerning:{},widths:[]},l.metadata.glyIdsUsed=[0]})(s,n)}}])}(pt),function(e){function r(){return(yt.canvg?Promise.resolve(yt.canvg):I0(()=>import("./index.es-CYUj7cQv.js"),__vite__mapDeps([0,1,2]))).catch(function(t){return Promise.reject(new Error("Could not load canvg: "+t))}).then(function(t){return t.default?t.default:t})}pt.API.addSvgAsImage=function(t,n,s,o,l,c,d,f){if(isNaN(n)||isNaN(s))throw tr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(o)||isNaN(l))throw tr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=o,u.height=l;var g=u.getContext("2d");g.fillStyle="#fff",g.fillRect(0,0,u.width,u.height);var p={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},m=this;return r().then(function(j){return j.fromString(g,t,p)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(j){return j.render(p)}).then(function(){m.addImage(u.toDataURL("image/jpeg",1),n,s,o,l,d,f)})}}(),pt.API.putTotalPages=function(e){var r,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(r=new RegExp(e,"g"),t=this.internal.getNumberOfPages()):(r=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var s=0;s<this.internal.pages[n].length;s++)this.internal.pages[n][s]=this.internal.pages[n][s].replace(r,t);return this},pt.API.viewerPreferences=function(e,r){var t;e=e||{},r=r||!1;var n,s,o,l={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},c=Object.keys(l),d=[],f=0,u=0,g=0;function p(j,v){var N,b=!1;for(N=0;N<j.length;N+=1)j[N]===v&&(b=!0);return b}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(l)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,e==="reset"||r===!0){var m=c.length;for(g=0;g<m;g+=1)t[c[g]].value=t[c[g]].defaultValue,t[c[g]].explicitSet=!1}if(rr(e)==="object"){for(s in e)if(o=e[s],p(c,s)&&o!==void 0){if(t[s].type==="boolean"&&typeof o=="boolean")t[s].value=o;else if(t[s].type==="name"&&p(t[s].valueSet,o))t[s].value=o;else if(t[s].type==="integer"&&Number.isInteger(o))t[s].value=o;else if(t[s].type==="array"){for(f=0;f<o.length;f+=1)if(n=!0,o[f].length===1&&typeof o[f][0]=="number")d.push(String(o[f]-1));else if(o[f].length>1){for(u=0;u<o[f].length;u+=1)typeof o[f][u]!="number"&&(n=!1);n===!0&&d.push([o[f][0]-1,o[f][1]-1].join(" "))}t[s].value="["+d.join(" ")+"]"}else t[s].value=t[s].defaultValue;t[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var j,v=[];for(j in t)t[j].explicitSet===!0&&(t[j].type==="name"?v.push("/"+j+" /"+t[j].value):v.push("/"+j+" "+t[j].value));v.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+v.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},function(e){var r=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),o=unescape(encodeURIComponent(n)),l=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),c=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),d=unescape(encodeURIComponent("</x:xmpmeta>")),f=o.length+l.length+c.length+s.length+d.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+f+" >>"),this.internal.write("stream"),this.internal.write(s+o+l+c+d),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",r)),this}}(pt.API),function(e){var r=e.API,t=r.pdfEscape16=function(o,l){for(var c,d=l.metadata.Unicode.widths,f=["","0","00","000","0000"],u=[""],g=0,p=o.length;g<p;++g){if(c=l.metadata.characterToGlyph(o.charCodeAt(g)),l.metadata.glyIdsUsed.push(c),l.metadata.toUnicode[c]=o.charCodeAt(g),d.indexOf(c)==-1&&(d.push(c),d.push([parseInt(l.metadata.widthOfGlyph(c),10)])),c=="0")return u.join("");c=c.toString(16),u.push(f[4-c.length],c)}return u.join("")},n=function(o){var l,c,d,f,u,g,p;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,d=[],g=0,p=(c=Object.keys(o).sort(function(m,j){return m-j})).length;g<p;g++)l=c[g],d.length>=100&&(u+=`
`+d.length+` beginbfchar
`+d.join(`
`)+`
endbfchar`,d=[]),o[l]!==void 0&&o[l]!==null&&typeof o[l].toString=="function"&&(f=("0000"+o[l].toString(16)).slice(-4),l=("0000"+(+l).toString(16)).slice(-4),d.push("<"+l+"><"+f+">"));return d.length&&(u+=`
`+d.length+` beginbfchar
`+d.join(`
`)+`
endbfchar
`),u+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};r.events.push(["putFont",function(o){(function(l){var c=l.font,d=l.out,f=l.newObject,u=l.putStream;if(c.metadata instanceof e.API.TTFFont&&c.encoding==="Identity-H"){for(var g=c.metadata.Unicode.widths,p=c.metadata.subset.encode(c.metadata.glyIdsUsed,1),m="",j=0;j<p.length;j++)m+=String.fromCharCode(p[j]);var v=f();u({data:m,addLength1:!0,objectId:v}),d("endobj");var N=f();u({data:n(c.metadata.toUnicode),addLength1:!0,objectId:N}),d("endobj");var b=f();d("<<"),d("/Type /FontDescriptor"),d("/FontName /"+Ti(c.fontName)),d("/FontFile2 "+v+" 0 R"),d("/FontBBox "+e.API.PDFObject.convert(c.metadata.bbox)),d("/Flags "+c.metadata.flags),d("/StemV "+c.metadata.stemV),d("/ItalicAngle "+c.metadata.italicAngle),d("/Ascent "+c.metadata.ascender),d("/Descent "+c.metadata.decender),d("/CapHeight "+c.metadata.capHeight),d(">>"),d("endobj");var y=f();d("<<"),d("/Type /Font"),d("/BaseFont /"+Ti(c.fontName)),d("/FontDescriptor "+b+" 0 R"),d("/W "+e.API.PDFObject.convert(g)),d("/CIDToGIDMap /Identity"),d("/DW 1000"),d("/Subtype /CIDFontType2"),d("/CIDSystemInfo"),d("<<"),d("/Supplement 0"),d("/Registry (Adobe)"),d("/Ordering ("+c.encoding+")"),d(">>"),d(">>"),d("endobj"),c.objectNumber=f(),d("<<"),d("/Type /Font"),d("/Subtype /Type0"),d("/ToUnicode "+N+" 0 R"),d("/BaseFont /"+Ti(c.fontName)),d("/Encoding /"+c.encoding),d("/DescendantFonts ["+y+" 0 R]"),d(">>"),d("endobj"),c.isAlreadyPutted=!0}})(o)}]),r.events.push(["putFont",function(o){(function(l){var c=l.font,d=l.out,f=l.newObject,u=l.putStream;if(c.metadata instanceof e.API.TTFFont&&c.encoding==="WinAnsiEncoding"){for(var g=c.metadata.rawData,p="",m=0;m<g.length;m++)p+=String.fromCharCode(g[m]);var j=f();u({data:p,addLength1:!0,objectId:j}),d("endobj");var v=f();u({data:n(c.metadata.toUnicode),addLength1:!0,objectId:v}),d("endobj");var N=f();d("<<"),d("/Descent "+c.metadata.decender),d("/CapHeight "+c.metadata.capHeight),d("/StemV "+c.metadata.stemV),d("/Type /FontDescriptor"),d("/FontFile2 "+j+" 0 R"),d("/Flags 96"),d("/FontBBox "+e.API.PDFObject.convert(c.metadata.bbox)),d("/FontName /"+Ti(c.fontName)),d("/ItalicAngle "+c.metadata.italicAngle),d("/Ascent "+c.metadata.ascender),d(">>"),d("endobj"),c.objectNumber=f();for(var b=0;b<c.metadata.hmtx.widths.length;b++)c.metadata.hmtx.widths[b]=parseInt(c.metadata.hmtx.widths[b]*(1e3/c.metadata.head.unitsPerEm));d("<</Subtype/TrueType/Type/Font/ToUnicode "+v+" 0 R/BaseFont/"+Ti(c.fontName)+"/FontDescriptor "+N+" 0 R/Encoding/"+c.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(c.metadata.hmtx.widths)+">>"),d("endobj"),c.isAlreadyPutted=!0}})(o)}]);var s=function(o){var l,c=o.text||"",d=o.x,f=o.y,u=o.options||{},g=o.mutex||{},p=g.pdfEscape,m=g.activeFontKey,j=g.fonts,v=m,N="",b=0,y="",_=j[v].encoding;if(j[v].encoding!=="Identity-H")return{text:c,x:d,y:f,options:u,mutex:g};for(y=c,v=m,Array.isArray(c)&&(y=c[0]),b=0;b<y.length;b+=1)j[v].metadata.hasOwnProperty("cmap")&&(l=j[v].metadata.cmap.unicode.codeMap[y[b].charCodeAt(0)]),l||y[b].charCodeAt(0)<256&&j[v].metadata.hasOwnProperty("Unicode")?N+=y[b]:N+="";var T="";return parseInt(v.slice(1))<14||_==="WinAnsiEncoding"?T=p(N,v).split("").map(function(O){return O.charCodeAt(0).toString(16)}).join(""):_==="Identity-H"&&(T=t(N,j[v])),g.isHex=!0,{text:T,x:d,y:f,options:u,mutex:g}};r.events.push(["postProcessText",function(o){var l=o.text||"",c=[],d={text:l,x:o.x,y:o.y,options:o.options,mutex:o.mutex};if(Array.isArray(l)){var f=0;for(f=0;f<l.length;f+=1)Array.isArray(l[f])&&l[f].length===3?c.push([s(Object.assign({},d,{text:l[f][0]})).text,l[f][1],l[f][2]]):c.push(s(Object.assign({},d,{text:l[f]})).text);o.text=c}else o.text=s(Object.assign({},d,{text:l})).text}])}(pt),function(e){var r=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(t){return r.call(this),this.internal.vFS[t]!==void 0},e.addFileToVFS=function(t,n){return r.call(this),this.internal.vFS[t]=n,this},e.getFileFromVFS=function(t){return r.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}}(pt.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var s,o,l,c,d,f,u,g=r,p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],m=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],j={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},v={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},N=["(",")","(","<",">","<","[","]","[","{","}","{","Â«","Â»","Â«","â€¹","â€º","â€¹","â…","â†","â…","â½","â¾","â½","â‚","â‚Ž","â‚","â‰¤","â‰¥","â‰¤","âŒ©","âŒª","âŒ©","ï¹™","ï¹š","ï¹™","ï¹›","ï¹œ","ï¹›","ï¹","ï¹ž","ï¹","ï¹¤","ï¹¥","ï¹¤"],b=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),y=!1,_=0;this.__bidiEngine__={};var T=function(k){var C=k.charCodeAt(),z=C>>8,G=v[z];return G!==void 0?g[256*G+(255&C)]:z===252||z===253?"AL":b.test(z)?"L":z===8?"R":"N"},O=function(k){for(var C,z=0;z<k.length;z++){if((C=T(k.charAt(z)))==="L")return!1;if(C==="R")return!0}return!1},B=function(k,C,z,G){var de,J,Z,oe,ne=C[G];switch(ne){case"L":case"R":y=!1;break;case"N":case"AN":break;case"EN":y&&(ne="AN");break;case"AL":y=!0,ne="R";break;case"WS":ne="N";break;case"CS":G<1||G+1>=C.length||(de=z[G-1])!=="EN"&&de!=="AN"||(J=C[G+1])!=="EN"&&J!=="AN"?ne="N":y&&(J="AN"),ne=J===de?J:"N";break;case"ES":ne=(de=G>0?z[G-1]:"B")==="EN"&&G+1<C.length&&C[G+1]==="EN"?"EN":"N";break;case"ET":if(G>0&&z[G-1]==="EN"){ne="EN";break}if(y){ne="N";break}for(Z=G+1,oe=C.length;Z<oe&&C[Z]==="ET";)Z++;ne=Z<oe&&C[Z]==="EN"?"EN":"N";break;case"NSM":if(l&&!c){for(oe=C.length,Z=G+1;Z<oe&&C[Z]==="NSM";)Z++;if(Z<oe){var me=k[G],be=me>=1425&&me<=2303||me===64286;if(de=C[Z],be&&(de==="R"||de==="AL")){ne="R";break}}}ne=G<1||(de=C[G-1])==="B"?"N":z[G-1];break;case"B":y=!1,s=!0,ne=_;break;case"S":o=!0,ne="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":y=!1;break;case"BN":ne="N"}return ne},L=function(k,C,z){var G=k.split("");return z&&E(G,z,{hiLevel:_}),G.reverse(),C&&C.reverse(),G.join("")},E=function(k,C,z){var G,de,J,Z,oe,ne=-1,me=k.length,be=0,A=[],I=_?m:p,R=[];for(y=!1,s=!1,o=!1,de=0;de<me;de++)R[de]=T(k[de]);for(J=0;J<me;J++){if(oe=be,A[J]=B(k,R,A,J),G=240&(be=I[oe][j[A[J]]]),be&=15,C[J]=Z=I[be][5],G>0)if(G===16){for(de=ne;de<J;de++)C[de]=1;ne=-1}else ne=-1;if(I[be][6])ne===-1&&(ne=J);else if(ne>-1){for(de=ne;de<J;de++)C[de]=Z;ne=-1}R[J]==="B"&&(C[J]=0),z.hiLevel|=Z}o&&function(M,K,he){for(var fe=0;fe<he;fe++)if(M[fe]==="S"){K[fe]=_;for(var ee=fe-1;ee>=0&&M[ee]==="WS";ee--)K[ee]=_}}(R,C,me)},P=function(k,C,z,G,de){if(!(de.hiLevel<k)){if(k===1&&_===1&&!s)return C.reverse(),void(z&&z.reverse());for(var J,Z,oe,ne,me=C.length,be=0;be<me;){if(G[be]>=k){for(oe=be+1;oe<me&&G[oe]>=k;)oe++;for(ne=be,Z=oe-1;ne<Z;ne++,Z--)J=C[ne],C[ne]=C[Z],C[Z]=J,z&&(J=z[ne],z[ne]=z[Z],z[Z]=J);be=oe}be++}}},D=function(k,C,z){var G=k.split(""),de={hiLevel:_};return z||(z=[]),E(G,z,de),function(J,Z,oe){if(oe.hiLevel!==0&&u)for(var ne,me=0;me<J.length;me++)Z[me]===1&&(ne=N.indexOf(J[me]))>=0&&(J[me]=N[ne+1])}(G,z,de),P(2,G,C,z,de),P(1,G,C,z,de),G.join("")};return this.__bidiEngine__.doBidiReorder=function(k,C,z){if(function(de,J){if(J)for(var Z=0;Z<de.length;Z++)J[Z]=Z;c===void 0&&(c=O(de)),f===void 0&&(f=O(de))}(k,C),l||!d||f)if(l&&d&&c^f)_=c?1:0,k=L(k,C,z);else if(!l&&d&&f)_=c?1:0,k=D(k,C,z),k=L(k,C);else if(!l||c||d||f){if(l&&!d&&c^f)k=L(k,C),c?(_=0,k=D(k,C,z)):(_=1,k=D(k,C,z),k=L(k,C));else if(l&&c&&!d&&f)_=1,k=D(k,C,z),k=L(k,C);else if(!l&&!d&&c^f){var G=u;c?(_=1,k=D(k,C,z),_=0,u=!1,k=D(k,C,z),u=G):(_=0,k=D(k,C,z),k=L(k,C),_=1,u=!1,k=D(k,C,z),u=G,k=L(k,C))}}else _=0,k=D(k,C,z);else _=c?1:0,k=D(k,C,z);return k},this.__bidiEngine__.setOptions=function(k){k&&(l=k.isInputVisual,d=k.isOutputVisual,c=k.isInputRtl,f=k.isOutputRtl,u=k.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var r=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var s=n.text,o=(n.x,n.y,n.options||{}),l=(n.mutex,o.lang,[]);if(o.isInputVisual=typeof o.isInputVisual!="boolean"||o.isInputVisual,t.setOptions(o),Object.prototype.toString.call(s)==="[object Array]"){var c=0;for(l=[],c=0;c<s.length;c+=1)Object.prototype.toString.call(s[c])==="[object Array]"?l.push([t.doBidiReorder(s[c][0]),s[c][1],s[c][2]]):l.push([t.doBidiReorder(s[c])]);n.text=l}else n.text=t.doBidiReorder(s);t.setOptions({isInputVisual:!0})}])}(pt),pt.API.TTFFont=function(){function e(r){var t;if(this.rawData=r,t=this.contents=new bs(r),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new zp(this),this.registerTTF()}return e.open=function(r){return new e(r)},e.prototype.parse=function(){return this.directory=new Cp(this.contents),this.head=new Lp(this),this.name=new Dp(this),this.cmap=new Uf(this),this.toUnicode={},this.hhea=new Fp(this),this.maxp=new Rp(this),this.hmtx=new Bp(this),this.post=new Op(this),this.os2=new Pp(this),this.loca=new Wp(this),this.glyf=new Mp(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var r,t,n,s,o;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var l,c,d,f;for(f=[],l=0,c=(d=this.bbox).length;l<c;l++)r=d[l],f.push(Math.round(r*this.scaleFactor));return f}).call(this),this.stemV=0,this.post.exists?(n=255&(s=this.post.italic_angle),32768&(t=s>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(o=this.familyClass)===1||o===2||o===3||o===4||o===5||o===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(r){var t;return((t=this.cmap.unicode)!=null?t.codeMap[r]:void 0)||0},e.prototype.widthOfGlyph=function(r){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(r).advance*t},e.prototype.widthOfString=function(r,t,n){var s,o,l,c;for(l=0,o=0,c=(r=""+r).length;0<=c?o<c:o>c;o=0<=c?++o:--o)s=r.charCodeAt(o),l+=this.widthOfGlyph(this.characterToGlyph(s))+n*(1e3/t)||0;return l*(t/1e3)},e.prototype.lineHeight=function(r,t){var n;return t==null&&(t=!1),n=t?this.lineGap:0,(this.ascender+n-this.decender)/1e3*r},e}();var gn,bs=function(){function e(r){this.data=r??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(r){return this.data[this.pos++]=r},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(r){return this.writeByte(r>>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},e.prototype.readInt32=function(){var r;return(r=this.readUInt32())>=2147483648?r-4294967296:r},e.prototype.writeInt32=function(r){return r<0&&(r+=4294967296),this.writeUInt32(r)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(r){return this.writeByte(r>>8&255),this.writeByte(255&r)},e.prototype.readInt16=function(){var r;return(r=this.readUInt16())>=32768?r-65536:r},e.prototype.writeInt16=function(r){return r<0&&(r+=65536),this.writeUInt16(r)},e.prototype.readString=function(r){var t,n;for(n=[],t=0;0<=r?t<r:t>r;t=0<=r?++t:--t)n[t]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(r){var t,n,s;for(s=[],t=0,n=r.length;0<=n?t<n:t>n;t=0<=n?++t:--t)s.push(this.writeByte(r.charCodeAt(t)));return s},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(r){return this.writeInt16(r)},e.prototype.readLongLong=function(){var r,t,n,s,o,l,c,d;return r=this.readByte(),t=this.readByte(),n=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),d=this.readByte(),128&r?-1*(72057594037927940*(255^r)+281474976710656*(255^t)+1099511627776*(255^n)+4294967296*(255^s)+16777216*(255^o)+65536*(255^l)+256*(255^c)+(255^d)+1):72057594037927940*r+281474976710656*t+1099511627776*n+4294967296*s+16777216*o+65536*l+256*c+d},e.prototype.writeLongLong=function(r){var t,n;return t=Math.floor(r/4294967296),n=4294967295&r,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(r){return this.writeInt32(r)},e.prototype.read=function(r){var t,n;for(t=[],n=0;0<=r?n<r:n>r;n=0<=r?++n:--n)t.push(this.readByte());return t},e.prototype.write=function(r){var t,n,s,o;for(o=[],n=0,s=r.length;n<s;n++)t=r[n],o.push(this.writeByte(t));return o},e}(),Cp=function(){var e;function r(t){var n,s,o;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},s=0,o=this.tableCount;0<=o?s<o:s>o;s=0<=o?++s:--s)n={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[n.tag]=n}return r.prototype.encode=function(t){var n,s,o,l,c,d,f,u,g,p,m,j,v;for(v in m=Object.keys(t).length,d=Math.log(2),g=16*Math.floor(Math.log(m)/d),l=Math.floor(g/d),u=16*m-g,(s=new bs).writeInt(this.scalarType),s.writeShort(m),s.writeShort(g),s.writeShort(l),s.writeShort(u),o=16*m,f=s.pos+o,c=null,j=[],t)for(p=t[v],s.writeString(v),s.writeInt(e(p)),s.writeInt(f),s.writeInt(p.length),j=j.concat(p),v==="head"&&(c=f),f+=p.length;f%4;)j.push(0),f++;return s.write(j),n=2981146554-e(s.data),s.pos=c+8,s.writeUInt32(n),s.data},e=function(t){var n,s,o,l;for(t=Hf.call(t);t.length%4;)t.push(0);for(o=new bs(t),s=0,n=0,l=t.length;n<l;n=n+=4)s+=o.readUInt32();return 4294967295&s},r}(),Ep={}.hasOwnProperty,Ln=function(e,r){for(var t in r)Ep.call(r,t)&&(e[t]=r[t]);function n(){this.constructor=e}return n.prototype=r.prototype,e.prototype=new n,e.__super__=r.prototype,e};gn=function(){function e(r){var t;this.file=r,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var Lp=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return Ln(r,gn),r.prototype.tag="head",r.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},r.prototype.encode=function(t){var n;return(n=new bs).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(t),n.writeShort(this.glyphDataFormat),n.data},r}(),kh=function(){function e(r,t){var n,s,o,l,c,d,f,u,g,p,m,j,v,N,b,y,_;switch(this.platformID=r.readUInt16(),this.encodingID=r.readShort(),this.offset=t+r.readInt(),g=r.pos,r.pos=this.offset,this.format=r.readUInt16(),this.length=r.readUInt16(),this.language=r.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(d=0;d<256;++d)this.codeMap[d]=r.readByte();break;case 4:for(m=r.readUInt16(),p=m/2,r.pos+=6,o=function(){var T,O;for(O=[],d=T=0;0<=p?T<p:T>p;d=0<=p?++T:--T)O.push(r.readUInt16());return O}(),r.pos+=2,v=function(){var T,O;for(O=[],d=T=0;0<=p?T<p:T>p;d=0<=p?++T:--T)O.push(r.readUInt16());return O}(),f=function(){var T,O;for(O=[],d=T=0;0<=p?T<p:T>p;d=0<=p?++T:--T)O.push(r.readUInt16());return O}(),u=function(){var T,O;for(O=[],d=T=0;0<=p?T<p:T>p;d=0<=p?++T:--T)O.push(r.readUInt16());return O}(),s=(this.length-r.pos+this.offset)/2,c=function(){var T,O;for(O=[],d=T=0;0<=s?T<s:T>s;d=0<=s?++T:--T)O.push(r.readUInt16());return O}(),d=b=0,_=o.length;b<_;d=++b)for(N=o[d],n=y=j=v[d];j<=N?y<=N:y>=N;n=j<=N?++y:--y)u[d]===0?l=n+f[d]:(l=c[u[d]/2+(n-j)-(p-d)]||0)!==0&&(l+=f[d]),this.codeMap[n]=65535&l}r.pos=g}return e.encode=function(r,t){var n,s,o,l,c,d,f,u,g,p,m,j,v,N,b,y,_,T,O,B,L,E,P,D,k,C,z,G,de,J,Z,oe,ne,me,be,A,I,R,M,K,he,fe,ee,ve,Ce,De;switch(G=new bs,l=Object.keys(r).sort(function($e,Ke){return $e-Ke}),t){case"macroman":for(v=0,N=function(){var $e=[];for(j=0;j<256;++j)$e.push(0);return $e}(),y={0:0},o={},de=0,ne=l.length;de<ne;de++)y[ee=r[s=l[de]]]==null&&(y[ee]=++v),o[s]={old:r[s],new:y[r[s]]},N[s]=y[r[s]];return G.writeUInt16(1),G.writeUInt16(0),G.writeUInt32(12),G.writeUInt16(0),G.writeUInt16(262),G.writeUInt16(0),G.write(N),{charMap:o,subtable:G.data,maxGlyphID:v+1};case"unicode":for(C=[],g=[],_=0,y={},n={},b=f=null,J=0,me=l.length;J<me;J++)y[O=r[s=l[J]]]==null&&(y[O]=++_),n[s]={old:O,new:y[O]},c=y[O]-s,b!=null&&c===f||(b&&g.push(b),C.push(s),f=c),b=s;for(b&&g.push(b),g.push(65535),C.push(65535),D=2*(P=C.length),E=2*Math.pow(Math.log(P)/Math.LN2,2),p=Math.log(E/2)/Math.LN2,L=2*P-E,d=[],B=[],m=[],j=Z=0,be=C.length;Z<be;j=++Z){if(k=C[j],u=g[j],k===65535){d.push(0),B.push(0);break}if(k-(z=n[k].new)>=32768)for(d.push(0),B.push(2*(m.length+P-j)),s=oe=k;k<=u?oe<=u:oe>=u;s=k<=u?++oe:--oe)m.push(n[s].new);else d.push(z-k),B.push(0)}for(G.writeUInt16(3),G.writeUInt16(1),G.writeUInt32(12),G.writeUInt16(4),G.writeUInt16(16+8*P+2*m.length),G.writeUInt16(0),G.writeUInt16(D),G.writeUInt16(E),G.writeUInt16(p),G.writeUInt16(L),he=0,A=g.length;he<A;he++)s=g[he],G.writeUInt16(s);for(G.writeUInt16(0),fe=0,I=C.length;fe<I;fe++)s=C[fe],G.writeUInt16(s);for(ve=0,R=d.length;ve<R;ve++)c=d[ve],G.writeUInt16(c);for(Ce=0,M=B.length;Ce<M;Ce++)T=B[Ce],G.writeUInt16(T);for(De=0,K=m.length;De<K;De++)v=m[De],G.writeUInt16(v);return{charMap:n,subtable:G.data,maxGlyphID:_+1}}},e}(),Uf=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return Ln(r,gn),r.prototype.tag="cmap",r.prototype.parse=function(t){var n,s,o;for(t.pos=this.offset,this.version=t.readUInt16(),o=t.readUInt16(),this.tables=[],this.unicode=null,s=0;0<=o?s<o:s>o;s=0<=o?++s:--s)n=new kh(t,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},r.encode=function(t,n){var s,o;return n==null&&(n="macroman"),s=kh.encode(t,n),(o=new bs).writeUInt16(0),o.writeUInt16(1),s.table=o.data.concat(s.subtable),s},r}(),Fp=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return Ln(r,gn),r.prototype.tag="hhea",r.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},r}(),Pp=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return Ln(r,gn),r.prototype.tag="OS/2",r.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var n,s;for(s=[],n=0;n<10;++n)s.push(t.readByte());return s}(),this.charRange=function(){var n,s;for(s=[],n=0;n<4;++n)s.push(t.readInt());return s}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var n,s;for(s=[],n=0;n<2;n=++n)s.push(t.readInt());return s}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},r}(),Op=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return Ln(r,gn),r.prototype.tag="post",r.prototype.parse=function(t){var n,s,o;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:break;case 131072:var l;for(s=t.readUInt16(),this.glyphNameIndex=[],l=0;0<=s?l<s:l>s;l=0<=s?++l:--l)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],o=[];t.pos<this.offset+this.length;)n=t.readByte(),o.push(this.names.push(t.readString(n)));return o;case 151552:return s=t.readUInt16(),this.offsets=t.read(s);case 196608:break;case 262144:return this.map=(function(){var c,d,f;for(f=[],l=c=0,d=this.file.maxp.numGlyphs;0<=d?c<d:c>d;l=0<=d?++c:--c)f.push(t.readUInt32());return f}).call(this)}},r}(),Ip=function(e,r){this.raw=e,this.length=e.length,this.platformID=r.platformID,this.encodingID=r.encodingID,this.languageID=r.languageID},Dp=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return Ln(r,gn),r.prototype.tag="name",r.prototype.parse=function(t){var n,s,o,l,c,d,f,u,g,p,m;for(t.pos=this.offset,t.readShort(),n=t.readShort(),d=t.readShort(),s=[],l=0;0<=n?l<n:l>n;l=0<=n?++l:--l)s.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+d+t.readShort()});for(f={},l=g=0,p=s.length;g<p;l=++g)o=s[l],t.pos=o.offset,u=t.readString(o.length),c=new Ip(u,o),f[m=o.nameID]==null&&(f[m]=[]),f[o.nameID].push(c);this.strings=f,this.copyright=f[0],this.fontFamily=f[1],this.fontSubfamily=f[2],this.uniqueSubfamily=f[3],this.fontName=f[4],this.version=f[5];try{this.postscriptName=f[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=f[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=f[7],this.manufacturer=f[8],this.designer=f[9],this.description=f[10],this.vendorUrl=f[11],this.designerUrl=f[12],this.license=f[13],this.licenseUrl=f[14],this.preferredFamily=f[15],this.preferredSubfamily=f[17],this.compatibleFull=f[18],this.sampleText=f[19]},r}(),Rp=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return Ln(r,gn),r.prototype.tag="maxp",r.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},r}(),Bp=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return Ln(r,gn),r.prototype.tag="hmtx",r.prototype.parse=function(t){var n,s,o,l,c,d,f;for(t.pos=this.offset,this.metrics=[],n=0,d=this.file.hhea.numberOfMetrics;0<=d?n<d:n>d;n=0<=d?++n:--n)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(o=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,g;for(g=[],n=u=0;0<=o?u<o:u>o;n=0<=o?++u:--u)g.push(t.readInt16());return g}(),this.widths=(function(){var u,g,p,m;for(m=[],u=0,g=(p=this.metrics).length;u<g;u++)l=p[u],m.push(l.advance);return m}).call(this),s=this.widths[this.widths.length-1],f=[],n=c=0;0<=o?c<o:c>o;n=0<=o?++c:--c)f.push(this.widths.push(s));return f},r.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},r}(),Hf=[].slice,Mp=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return Ln(r,gn),r.prototype.tag="glyf",r.prototype.parse=function(){return this.cache={}},r.prototype.glyphFor=function(t){var n,s,o,l,c,d,f,u,g,p;return t in this.cache?this.cache[t]:(l=this.file.loca,n=this.file.contents,s=l.indexOf(t),(o=l.lengthOf(t))===0?this.cache[t]=null:(n.pos=this.offset+s,c=(d=new bs(n.read(o))).readShort(),u=d.readShort(),p=d.readShort(),f=d.readShort(),g=d.readShort(),this.cache[t]=c===-1?new Hp(d,u,p,f,g):new Up(d,c,u,p,f,g),this.cache[t]))},r.prototype.encode=function(t,n,s){var o,l,c,d,f;for(c=[],l=[],d=0,f=n.length;d<f;d++)o=t[n[d]],l.push(c.length),o&&(c=c.concat(o.encode(s)));return l.push(c.length),{table:c,offsets:l}},r}(),Up=function(){function e(r,t,n,s,o,l){this.raw=r,this.numberOfContours=t,this.xMin=n,this.yMin=s,this.xMax=o,this.yMax=l,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),Hp=function(){function e(r,t,n,s,o){var l,c;for(this.raw=r,this.xMin=t,this.yMin=n,this.xMax=s,this.yMax=o,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],l=this.raw;c=l.readShort(),this.glyphOffsets.push(l.pos),this.glyphIDs.push(l.readUInt16()),32&c;)l.pos+=1&c?4:2,128&c?l.pos+=8:64&c?l.pos+=4:8&c&&(l.pos+=2)}return e.prototype.encode=function(){var r,t,n;for(t=new bs(Hf.call(this.raw.data)),r=0,n=this.glyphIDs.length;r<n;++r)t.pos=this.glyphOffsets[r];return t.data},e}(),Wp=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return Ln(r,gn),r.prototype.tag="loca",r.prototype.parse=function(t){var n,s;return t.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var o,l;for(l=[],s=0,o=this.length;s<o;s+=2)l.push(2*t.readUInt16());return l}).call(this):(function(){var o,l;for(l=[],s=0,o=this.length;s<o;s+=4)l.push(t.readUInt32());return l}).call(this)},r.prototype.indexOf=function(t){return this.offsets[t]},r.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},r.prototype.encode=function(t,n){for(var s=new Uint32Array(this.offsets.length),o=0,l=0,c=0;c<s.length;++c)if(s[c]=o,l<n.length&&n[l]==c){++l,s[c]=o;var d=this.offsets[c],f=this.offsets[c+1]-d;f>0&&(o+=f)}for(var u=new Array(4*s.length),g=0;g<s.length;++g)u[4*g+3]=255&s[g],u[4*g+2]=(65280&s[g])>>8,u[4*g+1]=(16711680&s[g])>>16,u[4*g]=(4278190080&s[g])>>24;return u},r}(),zp=function(){function e(r){this.font=r,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var r,t,n,s,o;for(t in s=this.font.cmap.tables[0].codeMap,r={},o=this.subset)n=o[t],r[t]=s[n];return r},e.prototype.glyphsFor=function(r){var t,n,s,o,l,c,d;for(s={},l=0,c=r.length;l<c;l++)s[o=r[l]]=this.font.glyf.glyphFor(o);for(o in t=[],s)(n=s[o])!=null&&n.compound&&t.push.apply(t,n.glyphIDs);if(t.length>0)for(o in d=this.glyphsFor(t))n=d[o],s[o]=n;return s},e.prototype.encode=function(r,t){var n,s,o,l,c,d,f,u,g,p,m,j,v,N,b;for(s in n=Uf.encode(this.generateCmap(),"unicode"),l=this.glyphsFor(r),m={0:0},b=n.charMap)m[(d=b[s]).old]=d.new;for(j in p=n.maxGlyphID,l)j in m||(m[j]=p++);return u=function(y){var _,T;for(_ in T={},y)T[y[_]]=_;return T}(m),g=Object.keys(u).sort(function(y,_){return y-_}),v=function(){var y,_,T;for(T=[],y=0,_=g.length;y<_;y++)c=g[y],T.push(u[c]);return T}(),o=this.font.glyf.encode(l,v,m),f=this.font.loca.encode(o.offsets,v),N={cmap:this.font.cmap.raw(),glyf:o.table,loca:f,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(N["OS/2"]=this.font.os2.raw()),this.font.directory.encode(N)},e}();pt.API.PDFObject=function(){var e;function r(){}return e=function(t,n){return(Array(n+1).join("0")+t).slice(-n)},r.convert=function(t){var n,s,o,l;if(Array.isArray(t))return"["+function(){var c,d,f;for(f=[],c=0,d=t.length;c<d;c++)n=t[c],f.push(r.convert(n));return f}().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t!=null&&t.isString)return"("+t+")";if(t instanceof Date)return"(D:"+e(t.getUTCFullYear(),4)+e(t.getUTCMonth(),2)+e(t.getUTCDate(),2)+e(t.getUTCHours(),2)+e(t.getUTCMinutes(),2)+e(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(s in o=["<<"],t)l=t[s],o.push("/"+s+" "+r.convert(l));return o.push(">>"),o.join(`
`)}return""+t},r}();const qp=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:wp,AcroFormAppearance:dt,AcroFormButton:Rr,AcroFormCheckBox:So,AcroFormChoiceField:Bs,AcroFormComboBox:Us,AcroFormEditBox:No,AcroFormListBox:Ms,AcroFormPasswordField:_o,AcroFormPushButton:jo,AcroFormRadioButton:Hs,AcroFormTextField:vs,GState:Po,ShadingPattern:ms,TilingPattern:Rs,default:pt,jsPDF:pt},Symbol.toStringTag,{value:"Module"}));var Vp={exports:{}};const Gp=im(qp);/*!
 * 
 *               jsPDF AutoTable plugin v3.8.4
 *
 *               Copyright (c) 2024 Simon Bengtsson, https://github.com/simonbengtsson/jsPDF-AutoTable
 *               Licensed under the MIT License.
 *               http://opensource.org/licenses/mit-license
 *
 */(function(e,r){(function(n,s){e.exports=s(function(){try{return Gp}catch{}}())})(typeof globalThis<"u"?globalThis:typeof c0<"u"?c0:typeof window<"u"?window:typeof self<"u"?self:c0,function(t){return function(){var n={172:function(c,d){var f=this&&this.__extends||function(){var p=function(m,j){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,N){v.__proto__=N}||function(v,N){for(var b in N)Object.prototype.hasOwnProperty.call(N,b)&&(v[b]=N[b])},p(m,j)};return function(m,j){if(typeof j!="function"&&j!==null)throw new TypeError("Class extends value "+String(j)+" is not a constructor or null");p(m,j);function v(){this.constructor=m}m.prototype=j===null?Object.create(j):(v.prototype=j.prototype,new v)}}();Object.defineProperty(d,"__esModule",{value:!0}),d.CellHookData=d.HookData=void 0;var u=function(){function p(m,j,v){this.table=j,this.pageNumber=j.pageNumber,this.pageCount=this.pageNumber,this.settings=j.settings,this.cursor=v,this.doc=m.getDocument()}return p}();d.HookData=u;var g=function(p){f(m,p);function m(j,v,N,b,y,_){var T=p.call(this,j,v,_)||this;return T.cell=N,T.row=b,T.column=y,T.section=b.section,T}return m}(u);d.CellHookData=g},340:function(c,d,f){Object.defineProperty(d,"__esModule",{value:!0});var u=f(4),g=f(136),p=f(744),m=f(776),j=f(664),v=f(972);function N(b){b.API.autoTable=function(){for(var y=[],_=0;_<arguments.length;_++)y[_]=arguments[_];var T;y.length===1?T=y[0]:(console.error("Use of deprecated autoTable initiation"),T=y[2]||{},T.columns=y[0],T.body=y[1]);var O=(0,m.parseInput)(this,T),B=(0,v.createTable)(this,O);return(0,j.drawTable)(this,B),this},b.API.lastAutoTable=!1,b.API.previousAutoTable=!1,b.API.autoTable.previous=!1,b.API.autoTableText=function(y,_,T,O){(0,g.default)(y,_,T,O,this)},b.API.autoTableSetDefaults=function(y){return p.DocHandler.setDefaults(y,this),this},b.autoTableSetDefaults=function(y,_){p.DocHandler.setDefaults(y,_)},b.API.autoTableHtmlToJson=function(y,_){var T;if(_===void 0&&(_=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var O=new p.DocHandler(this),B=(0,u.parseHtml)(O,y,window,_,!1),L=B.head,E=B.body,P=((T=L[0])===null||T===void 0?void 0:T.map(function(D){return D.content}))||[];return{columns:P,rows:E,data:E}},b.API.autoTableEndPosY=function(){console.error("Use of deprecated function: autoTableEndPosY. Use doc.lastAutoTable.finalY instead.");var y=this.lastAutoTable;return y&&y.finalY?y.finalY:0},b.API.autoTableAddPageContent=function(y){return console.error("Use of deprecated function: autoTableAddPageContent. Use jsPDF.autoTableSetDefaults({didDrawPage: () => {}}) instead."),b.API.autoTable.globalDefaults||(b.API.autoTable.globalDefaults={}),b.API.autoTable.globalDefaults.addPageContent=y,this},b.API.autoTableAddPage=function(){return console.error("Use of deprecated function: autoTableAddPage. Use doc.addPage()"),this.addPage(),this}}d.default=N},136:function(c,d){Object.defineProperty(d,"__esModule",{value:!0});function f(u,g,p,m,j){m=m||{};var v=1.15,N=j.internal.scaleFactor,b=j.internal.getFontSize()/N,y=j.getLineHeightFactor?j.getLineHeightFactor():v,_=b*y,T=/\r\n|\r|\n/g,O="",B=1;if((m.valign==="middle"||m.valign==="bottom"||m.halign==="center"||m.halign==="right")&&(O=typeof u=="string"?u.split(T):u,B=O.length||1),p+=b*(2-v),m.valign==="middle"?p-=B/2*_:m.valign==="bottom"&&(p-=B*_),m.halign==="center"||m.halign==="right"){var L=b;if(m.halign==="center"&&(L*=.5),O&&B>=1){for(var E=0;E<O.length;E++)j.text(O[E],g-j.getStringUnitWidth(O[E])*L,p),p+=_;return j}g-=j.getStringUnitWidth(u)*L}return m.halign==="justify"?j.text(u,g,p,{maxWidth:m.maxWidth||100,align:"justify"}):j.text(u,g,p),j}d.default=f},420:function(c,d){Object.defineProperty(d,"__esModule",{value:!0}),d.getPageAvailableWidth=d.parseSpacing=d.getFillStyle=d.addTableBorder=d.getStringWidth=void 0;function f(j,v,N){N.applyStyles(v,!0);var b=Array.isArray(j)?j:[j],y=b.map(function(_){return N.getTextWidth(_)}).reduce(function(_,T){return Math.max(_,T)},0);return y}d.getStringWidth=f;function u(j,v,N,b){var y=v.settings.tableLineWidth,_=v.settings.tableLineColor;j.applyStyles({lineWidth:y,lineColor:_});var T=g(y,!1);T&&j.rect(N.x,N.y,v.getWidth(j.pageSize().width),b.y-N.y,T)}d.addTableBorder=u;function g(j,v){var N=j>0,b=v||v===0;return N&&b?"DF":N?"S":b?"F":null}d.getFillStyle=g;function p(j,v){var N,b,y,_;if(j=j||v,Array.isArray(j)){if(j.length>=4)return{top:j[0],right:j[1],bottom:j[2],left:j[3]};if(j.length===3)return{top:j[0],right:j[1],bottom:j[2],left:j[1]};if(j.length===2)return{top:j[0],right:j[1],bottom:j[0],left:j[1]};j.length===1?j=j[0]:j=v}return typeof j=="object"?(typeof j.vertical=="number"&&(j.top=j.vertical,j.bottom=j.vertical),typeof j.horizontal=="number"&&(j.right=j.horizontal,j.left=j.horizontal),{left:(N=j.left)!==null&&N!==void 0?N:v,top:(b=j.top)!==null&&b!==void 0?b:v,right:(y=j.right)!==null&&y!==void 0?y:v,bottom:(_=j.bottom)!==null&&_!==void 0?_:v}):(typeof j!="number"&&(j=v),{top:j,right:j,bottom:j,left:j})}d.parseSpacing=p;function m(j,v){var N=p(v.settings.margin,0);return j.pageSize().width-(N.left+N.right)}d.getPageAvailableWidth=m},796:function(c,d){var f=this&&this.__extends||function(){var m=function(j,v){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(N,b){N.__proto__=b}||function(N,b){for(var y in b)Object.prototype.hasOwnProperty.call(b,y)&&(N[y]=b[y])},m(j,v)};return function(j,v){if(typeof v!="function"&&v!==null)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");m(j,v);function N(){this.constructor=j}j.prototype=v===null?Object.create(v):(N.prototype=v.prototype,new N)}}();Object.defineProperty(d,"__esModule",{value:!0}),d.getTheme=d.defaultStyles=d.HtmlRowInput=void 0;var u=function(m){f(j,m);function j(v){var N=m.call(this)||this;return N._element=v,N}return j}(Array);d.HtmlRowInput=u;function g(m){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/m,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}d.defaultStyles=g;function p(m){var j={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return j[m]}d.getTheme=p},903:function(c,d,f){Object.defineProperty(d,"__esModule",{value:!0}),d.parseCss=void 0;var u=f(420);function g(N,b,y,_,T){var O={},B=1.3333333333333333,L=m(b,function(ne){return T.getComputedStyle(ne).backgroundColor});L!=null&&(O.fillColor=L);var E=m(b,function(ne){return T.getComputedStyle(ne).color});E!=null&&(O.textColor=E);var P=v(_,y);P&&(O.cellPadding=P);var D="borderTopColor",k=B*y,C=_.borderTopWidth;if(_.borderBottomWidth===C&&_.borderRightWidth===C&&_.borderLeftWidth===C){var z=(parseFloat(C)||0)/k;z&&(O.lineWidth=z)}else O.lineWidth={top:(parseFloat(_.borderTopWidth)||0)/k,right:(parseFloat(_.borderRightWidth)||0)/k,bottom:(parseFloat(_.borderBottomWidth)||0)/k,left:(parseFloat(_.borderLeftWidth)||0)/k},O.lineWidth.top||(O.lineWidth.right?D="borderRightColor":O.lineWidth.bottom?D="borderBottomColor":O.lineWidth.left&&(D="borderLeftColor"));var G=m(b,function(ne){return T.getComputedStyle(ne)[D]});G!=null&&(O.lineColor=G);var de=["left","right","center","justify"];de.indexOf(_.textAlign)!==-1&&(O.halign=_.textAlign),de=["middle","bottom","top"],de.indexOf(_.verticalAlign)!==-1&&(O.valign=_.verticalAlign);var J=parseInt(_.fontSize||"");isNaN(J)||(O.fontSize=J/B);var Z=p(_);Z&&(O.fontStyle=Z);var oe=(_.fontFamily||"").toLowerCase();return N.indexOf(oe)!==-1&&(O.font=oe),O}d.parseCss=g;function p(N){var b="";return(N.fontWeight==="bold"||N.fontWeight==="bolder"||parseInt(N.fontWeight)>=700)&&(b="bold"),(N.fontStyle==="italic"||N.fontStyle==="oblique")&&(b+="italic"),b}function m(N,b){var y=j(N,b);if(!y)return null;var _=y.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!_||!Array.isArray(_))return null;var T=[parseInt(_[1]),parseInt(_[2]),parseInt(_[3])],O=parseInt(_[4]);return O===0||isNaN(T[0])||isNaN(T[1])||isNaN(T[2])?null:T}function j(N,b){var y=b(N);return y==="rgba(0, 0, 0, 0)"||y==="transparent"||y==="initial"||y==="inherit"?N.parentElement==null?null:j(N.parentElement,b):y}function v(N,b){var y=[N.paddingTop,N.paddingRight,N.paddingBottom,N.paddingLeft],_=96/(72/b),T=(parseInt(N.lineHeight)-parseInt(N.fontSize))/b/2,O=y.map(function(L){return parseInt(L||"0")/_}),B=(0,u.parseSpacing)(O,0);return T>B.top&&(B.top=T),T>B.bottom&&(B.bottom=T),B}},744:function(c,d){Object.defineProperty(d,"__esModule",{value:!0}),d.DocHandler=void 0;var f={},u=function(){function g(p){this.jsPDFDocument=p,this.userStyles={textColor:p.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:p.internal.getFontSize(),fontStyle:p.internal.getFont().fontStyle,font:p.internal.getFont().fontName,lineWidth:p.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:p.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return g.setDefaults=function(p,m){m===void 0&&(m=null),m?m.__autoTableDocumentDefaults=p:f=p},g.unifyColor=function(p){return Array.isArray(p)?p:typeof p=="number"?[p,p,p]:typeof p=="string"?[p]:null},g.prototype.applyStyles=function(p,m){var j,v,N;m===void 0&&(m=!1),p.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(p.fontStyle);var b=this.jsPDFDocument.internal.getFont(),y=b.fontStyle,_=b.fontName;if(p.font&&(_=p.font),p.fontStyle){y=p.fontStyle;var T=this.getFontList()[_];T&&T.indexOf(y)===-1&&(this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(T[0]),y=T[0])}if(this.jsPDFDocument.setFont(_,y),p.fontSize&&this.jsPDFDocument.setFontSize(p.fontSize),!m){var O=g.unifyColor(p.fillColor);O&&(j=this.jsPDFDocument).setFillColor.apply(j,O),O=g.unifyColor(p.textColor),O&&(v=this.jsPDFDocument).setTextColor.apply(v,O),O=g.unifyColor(p.lineColor),O&&(N=this.jsPDFDocument).setDrawColor.apply(N,O),typeof p.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(p.lineWidth)}},g.prototype.splitTextToSize=function(p,m,j){return this.jsPDFDocument.splitTextToSize(p,m,j)},g.prototype.rect=function(p,m,j,v,N){return this.jsPDFDocument.rect(p,m,j,v,N)},g.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},g.prototype.getTextWidth=function(p){return this.jsPDFDocument.getTextWidth(p)},g.prototype.getDocument=function(){return this.jsPDFDocument},g.prototype.setPage=function(p){this.jsPDFDocument.setPage(p)},g.prototype.addPage=function(){return this.jsPDFDocument.addPage()},g.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},g.prototype.getGlobalOptions=function(){return f||{}},g.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},g.prototype.pageSize=function(){var p=this.jsPDFDocument.internal.pageSize;return p.width==null&&(p={width:p.getWidth(),height:p.getHeight()}),p},g.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},g.prototype.getLineHeightFactor=function(){var p=this.jsPDFDocument;return p.getLineHeightFactor?p.getLineHeightFactor():1.15},g.prototype.getLineHeight=function(p){return p/this.scaleFactor()*this.getLineHeightFactor()},g.prototype.pageNumber=function(){var p=this.jsPDFDocument.internal.getCurrentPageInfo();return p?p.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},g}();d.DocHandler=u},4:function(c,d,f){Object.defineProperty(d,"__esModule",{value:!0}),d.parseHtml=void 0;var u=f(903),g=f(796);function p(v,N,b,y,_){var T,O;y===void 0&&(y=!1),_===void 0&&(_=!1);var B;typeof N=="string"?B=b.document.querySelector(N):B=N;var L=Object.keys(v.getFontList()),E=v.scaleFactor(),P=[],D=[],k=[];if(!B)return console.error("Html table could not be found with input: ",N),{head:P,body:D,foot:k};for(var C=0;C<B.rows.length;C++){var z=B.rows[C],G=(O=(T=z==null?void 0:z.parentElement)===null||T===void 0?void 0:T.tagName)===null||O===void 0?void 0:O.toLowerCase(),de=m(L,E,b,z,y,_);de&&(G==="thead"?P.push(de):G==="tfoot"?k.push(de):D.push(de))}return{head:P,body:D,foot:k}}d.parseHtml=p;function m(v,N,b,y,_,T){for(var O=new g.HtmlRowInput(y),B=0;B<y.cells.length;B++){var L=y.cells[B],E=b.getComputedStyle(L);if(_||E.display!=="none"){var P=void 0;T&&(P=(0,u.parseCss)(v,L,N,E,b)),O.push({rowSpan:L.rowSpan,colSpan:L.colSpan,styles:P,_element:L,content:j(L)})}}var D=b.getComputedStyle(y);if(O.length>0&&(_||D.display!=="none"))return O}function j(v){var N=v.cloneNode(!0);return N.innerHTML=N.innerHTML.replace(/\n/g,"").replace(/ +/g," "),N.innerHTML=N.innerHTML.split(/<br.*?>/).map(function(b){return b.trim()}).join(`
`),N.innerText||N.textContent||""}},776:function(c,d,f){Object.defineProperty(d,"__esModule",{value:!0}),d.parseInput=void 0;var u=f(4),g=f(356),p=f(420),m=f(744),j=f(792);function v(B,L){var E=new m.DocHandler(B),P=E.getDocumentOptions(),D=E.getGlobalOptions();(0,j.default)(E,D,P,L);var k=(0,g.assign)({},D,P,L),C;typeof window<"u"&&(C=window);var z=N(D,P,L),G=b(D,P,L),de=y(E,k),J=T(E,k,C);return{id:L.tableId,content:J,hooks:G,styles:z,settings:de}}d.parseInput=v;function N(B,L,E){for(var P={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},D=function(G){if(G==="columnStyles"){var de=B[G],J=L[G],Z=E[G];P.columnStyles=(0,g.assign)({},de,J,Z)}else{var oe=[B,L,E],ne=oe.map(function(me){return me[G]||{}});P[G]=(0,g.assign)({},ne[0],ne[1],ne[2])}},k=0,C=Object.keys(P);k<C.length;k++){var z=C[k];D(z)}return P}function b(B,L,E){for(var P=[B,L,E],D={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},k=0,C=P;k<C.length;k++){var z=C[k];z.didParseCell&&D.didParseCell.push(z.didParseCell),z.willDrawCell&&D.willDrawCell.push(z.willDrawCell),z.didDrawCell&&D.didDrawCell.push(z.didDrawCell),z.willDrawPage&&D.willDrawPage.push(z.willDrawPage),z.didDrawPage&&D.didDrawPage.push(z.didDrawPage)}return D}function y(B,L){var E,P,D,k,C,z,G,de,J,Z,oe,ne,me=(0,p.parseSpacing)(L.margin,40/B.scaleFactor()),be=(E=_(B,L.startY))!==null&&E!==void 0?E:me.top,A;L.showFoot===!0?A="everyPage":L.showFoot===!1?A="never":A=(P=L.showFoot)!==null&&P!==void 0?P:"everyPage";var I;L.showHead===!0?I="everyPage":L.showHead===!1?I="never":I=(D=L.showHead)!==null&&D!==void 0?D:"everyPage";var R=(k=L.useCss)!==null&&k!==void 0?k:!1,M=L.theme||(R?"plain":"striped"),K=!!L.horizontalPageBreak,he=(C=L.horizontalPageBreakRepeat)!==null&&C!==void 0?C:null;return{includeHiddenHtml:(z=L.includeHiddenHtml)!==null&&z!==void 0?z:!1,useCss:R,theme:M,startY:be,margin:me,pageBreak:(G=L.pageBreak)!==null&&G!==void 0?G:"auto",rowPageBreak:(de=L.rowPageBreak)!==null&&de!==void 0?de:"auto",tableWidth:(J=L.tableWidth)!==null&&J!==void 0?J:"auto",showHead:I,showFoot:A,tableLineWidth:(Z=L.tableLineWidth)!==null&&Z!==void 0?Z:0,tableLineColor:(oe=L.tableLineColor)!==null&&oe!==void 0?oe:200,horizontalPageBreak:K,horizontalPageBreakRepeat:he,horizontalPageBreakBehaviour:(ne=L.horizontalPageBreakBehaviour)!==null&&ne!==void 0?ne:"afterAllRows"}}function _(B,L){var E=B.getLastAutoTable(),P=B.scaleFactor(),D=B.pageNumber(),k=!1;if(E&&E.startPageNumber){var C=E.startPageNumber+E.pageNumber-1;k=C===D}return typeof L=="number"?L:(L==null||L===!1)&&k&&(E==null?void 0:E.finalY)!=null?E.finalY+20/P:null}function T(B,L,E){var P=L.head||[],D=L.body||[],k=L.foot||[];if(L.html){var C=L.includeHiddenHtml;if(E){var z=(0,u.parseHtml)(B,L.html,E,C,L.useCss)||{};P=z.head||P,D=z.body||P,k=z.foot||P}else console.error("Cannot parse html in non browser environment")}var G=L.columns||O(P,D,k);return{columns:G,head:P,body:D,foot:k}}function O(B,L,E){var P=B[0]||L[0]||E[0]||[],D=[];return Object.keys(P).filter(function(k){return k!=="_element"}).forEach(function(k){var C=1,z;Array.isArray(P)?z=P[parseInt(k)]:z=P[k],typeof z=="object"&&!Array.isArray(z)&&(C=(z==null?void 0:z.colSpan)||1);for(var G=0;G<C;G++){var de=void 0;Array.isArray(P)?de=D.length:de=k+(G>0?"_".concat(G):"");var J={dataKey:de};D.push(J)}}),D}},792:function(c,d){Object.defineProperty(d,"__esModule",{value:!0});function f(g,p,m,j){for(var v=function(_){_&&typeof _!="object"&&console.error("The options parameter should be of type object, is: "+typeof _),typeof _.extendWidth<"u"&&(_.tableWidth=_.extendWidth?"auto":"wrap",console.error("Use of deprecated option: extendWidth, use tableWidth instead.")),typeof _.margins<"u"&&(typeof _.margin>"u"&&(_.margin=_.margins),console.error("Use of deprecated option: margins, use margin instead.")),_.startY&&typeof _.startY!="number"&&(console.error("Invalid value for startY option",_.startY),delete _.startY),!_.didDrawPage&&(_.afterPageContent||_.beforePageContent||_.afterPageAdd)&&(console.error("The afterPageContent, beforePageContent and afterPageAdd hooks are deprecated. Use didDrawPage instead"),_.didDrawPage=function(k){g.applyStyles(g.userStyles),_.beforePageContent&&_.beforePageContent(k),g.applyStyles(g.userStyles),_.afterPageContent&&_.afterPageContent(k),g.applyStyles(g.userStyles),_.afterPageAdd&&k.pageNumber>1&&k.afterPageAdd(k),g.applyStyles(g.userStyles)}),["createdHeaderCell","drawHeaderRow","drawRow","drawHeaderCell"].forEach(function(k){_[k]&&console.error('The "'.concat(k,'" hook has changed in version 3.0, check the changelog for how to migrate.'))}),[["showFoot","showFooter"],["showHead","showHeader"],["didDrawPage","addPageContent"],["didParseCell","createdCell"],["headStyles","headerStyles"]].forEach(function(k){var C=k[0],z=k[1];_[z]&&(console.error("Use of deprecated option ".concat(z,". Use ").concat(C," instead")),_[C]=_[z])}),[["padding","cellPadding"],["lineHeight","rowHeight"],"fontSize","overflow"].forEach(function(k){var C=typeof k=="string"?k:k[0],z=typeof k=="string"?k:k[1];typeof _[C]<"u"&&(typeof _.styles[z]>"u"&&(_.styles[z]=_[C]),console.error("Use of deprecated option: "+C+", use the style "+z+" instead."))});for(var T=0,O=["styles","bodyStyles","headStyles","footStyles"];T<O.length;T++){var B=O[T];u(_[B]||{})}for(var L=_.columnStyles||{},E=0,P=Object.keys(L);E<P.length;E++){var D=P[E];u(L[D]||{})}},N=0,b=[p,m,j];N<b.length;N++){var y=b[N];v(y)}}d.default=f;function u(g){g.rowHeight?(console.error("Use of deprecated style rowHeight. It is renamed to minCellHeight."),g.minCellHeight||(g.minCellHeight=g.rowHeight)):g.columnWidth&&(console.error("Use of deprecated style columnWidth. It is renamed to cellWidth."),g.cellWidth||(g.cellWidth=g.columnWidth))}},260:function(c,d,f){Object.defineProperty(d,"__esModule",{value:!0}),d.Column=d.Cell=d.Row=d.Table=void 0;var u=f(796),g=f(172),p=f(420),m=function(){function b(y,_){this.pageNumber=1,this.pageCount=1,this.id=y.id,this.settings=y.settings,this.styles=y.styles,this.hooks=y.hooks,this.columns=_.columns,this.head=_.head,this.body=_.body,this.foot=_.foot}return b.prototype.getHeadHeight=function(y){return this.head.reduce(function(_,T){return _+T.getMaxCellHeight(y)},0)},b.prototype.getFootHeight=function(y){return this.foot.reduce(function(_,T){return _+T.getMaxCellHeight(y)},0)},b.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},b.prototype.callCellHooks=function(y,_,T,O,B,L){for(var E=0,P=_;E<P.length;E++){var D=P[E],k=new g.CellHookData(y,this,T,O,B,L),C=D(k)===!1;if(T.text=Array.isArray(T.text)?T.text:[T.text],C)return!1}return!0},b.prototype.callEndPageHooks=function(y,_){y.applyStyles(y.userStyles);for(var T=0,O=this.hooks.didDrawPage;T<O.length;T++){var B=O[T];B(new g.HookData(y,this,_))}},b.prototype.callWillDrawPageHooks=function(y,_){for(var T=0,O=this.hooks.willDrawPage;T<O.length;T++){var B=O[T];B(new g.HookData(y,this,_))}},b.prototype.getWidth=function(y){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var _=this.columns.reduce(function(O,B){return O+B.wrappedWidth},0);return _}else{var T=this.settings.margin;return y-T.left-T.right}},b}();d.Table=m;var j=function(){function b(y,_,T,O,B){B===void 0&&(B=!1),this.height=0,this.raw=y,y instanceof u.HtmlRowInput&&(this.raw=y._element,this.element=y._element),this.index=_,this.section=T,this.cells=O,this.spansMultiplePages=B}return b.prototype.getMaxCellHeight=function(y){var _=this;return y.reduce(function(T,O){var B;return Math.max(T,((B=_.cells[O.index])===null||B===void 0?void 0:B.height)||0)},0)},b.prototype.hasRowSpan=function(y){var _=this;return y.filter(function(T){var O=_.cells[T.index];return O?O.rowSpan>1:!1}).length>0},b.prototype.canEntireRowFit=function(y,_){return this.getMaxCellHeight(_)<=y},b.prototype.getMinimumRowHeight=function(y,_){var T=this;return y.reduce(function(O,B){var L=T.cells[B.index];if(!L)return 0;var E=_.getLineHeight(L.styles.fontSize),P=L.padding("vertical"),D=P+E;return D>O?D:O},0)},b}();d.Row=j;var v=function(){function b(y,_,T){var O,B;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=_,this.section=T,this.raw=y;var L=y;y!=null&&typeof y=="object"&&!Array.isArray(y)?(this.rowSpan=y.rowSpan||1,this.colSpan=y.colSpan||1,L=(B=(O=y.content)!==null&&O!==void 0?O:y.title)!==null&&B!==void 0?B:y,y._element&&(this.raw=y._element)):(this.rowSpan=1,this.colSpan=1);var E=L!=null?""+L:"",P=/\r\n|\r|\n/g;this.text=E.split(P)}return b.prototype.getTextPos=function(){var y;if(this.styles.valign==="top")y=this.y+this.padding("top");else if(this.styles.valign==="bottom")y=this.y+this.height-this.padding("bottom");else{var _=this.height-this.padding("vertical");y=this.y+_/2+this.padding("top")}var T;if(this.styles.halign==="right")T=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var O=this.width-this.padding("horizontal");T=this.x+O/2+this.padding("left")}else T=this.x+this.padding("left");return{x:T,y}},b.prototype.getContentHeight=function(y,_){_===void 0&&(_=1.15);var T=Array.isArray(this.text)?this.text.length:1,O=this.styles.fontSize/y*_,B=T*O+this.padding("vertical");return Math.max(B,this.styles.minCellHeight)},b.prototype.padding=function(y){var _=(0,p.parseSpacing)(this.styles.cellPadding,0);return y==="vertical"?_.top+_.bottom:y==="horizontal"?_.left+_.right:_[y]},b}();d.Cell=v;var N=function(){function b(y,_,T){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=y,this.raw=_,this.index=T}return b.prototype.getMaxCustomCellWidth=function(y){for(var _=0,T=0,O=y.allRows();T<O.length;T++){var B=O[T],L=B.cells[this.index];L&&typeof L.styles.cellWidth=="number"&&(_=Math.max(_,L.styles.cellWidth))}return _},b}();d.Column=N},356:function(c,d){Object.defineProperty(d,"__esModule",{value:!0}),d.assign=void 0;function f(u,g,p,m,j){if(u==null)throw new TypeError("Cannot convert undefined or null to object");for(var v=Object(u),N=1;N<arguments.length;N++){var b=arguments[N];if(b!=null)for(var y in b)Object.prototype.hasOwnProperty.call(b,y)&&(v[y]=b[y])}return v}d.assign=f},972:function(c,d,f){Object.defineProperty(d,"__esModule",{value:!0}),d.createTable=void 0;var u=f(744),g=f(260),p=f(324),m=f(796),j=f(356);function v(B,L){var E=new u.DocHandler(B),P=N(L,E.scaleFactor()),D=new g.Table(L,P);return(0,p.calculateWidths)(E,D),E.applyStyles(E.userStyles),D}d.createTable=v;function N(B,L){var E=B.content,P=T(E.columns);if(E.head.length===0){var D=y(P,"head");D&&E.head.push(D)}if(E.foot.length===0){var D=y(P,"foot");D&&E.foot.push(D)}var k=B.settings.theme,C=B.styles;return{columns:P,head:b("head",E.head,P,C,k,L),body:b("body",E.body,P,C,k,L),foot:b("foot",E.foot,P,C,k,L)}}function b(B,L,E,P,D,k){var C={},z=L.map(function(G,de){for(var J=0,Z={},oe=0,ne=0,me=0,be=E;me<be.length;me++){var A=be[me];if(C[A.index]==null||C[A.index].left===0)if(ne===0){var I=void 0;Array.isArray(G)?I=G[A.index-oe-J]:I=G[A.dataKey];var R={};typeof I=="object"&&!Array.isArray(I)&&(R=(I==null?void 0:I.styles)||{});var M=O(B,A,de,D,P,k,R),K=new g.Cell(I,M,B);Z[A.dataKey]=K,Z[A.index]=K,ne=K.colSpan-1,C[A.index]={left:K.rowSpan-1,times:ne}}else ne--,oe++;else C[A.index].left--,ne=C[A.index].times,J++}return new g.Row(G,de,B,Z)});return z}function y(B,L){var E={};return B.forEach(function(P){if(P.raw!=null){var D=_(L,P.raw);D!=null&&(E[P.dataKey]=D)}}),Object.keys(E).length>0?E:null}function _(B,L){if(B==="head"){if(typeof L=="object")return L.header||L.title||null;if(typeof L=="string"||typeof L=="number")return L}else if(B==="foot"&&typeof L=="object")return L.footer;return null}function T(B){return B.map(function(L,E){var P,D,k;return typeof L=="object"?k=(D=(P=L.dataKey)!==null&&P!==void 0?P:L.key)!==null&&D!==void 0?D:E:k=E,new g.Column(k,L,E)})}function O(B,L,E,P,D,k,C){var z=(0,m.getTheme)(P),G;B==="head"?G=D.headStyles:B==="body"?G=D.bodyStyles:B==="foot"&&(G=D.footStyles);var de=(0,j.assign)({},z.table,z[B],D.styles,G),J=D.columnStyles[L.dataKey]||D.columnStyles[L.index]||{},Z=B==="body"?J:{},oe=B==="body"&&E%2===0?(0,j.assign)({},z.alternateRow,D.alternateRowStyles):{},ne=(0,m.defaultStyles)(k),me=(0,j.assign)({},ne,de,oe,Z);return(0,j.assign)(me,C)}},664:function(c,d,f){Object.defineProperty(d,"__esModule",{value:!0}),d.addPage=d.drawTable=void 0;var u=f(420),g=f(260),p=f(744),m=f(356),j=f(136),v=f(224);function N(J,Z){var oe=Z.settings,ne=oe.startY,me=oe.margin,be={x:me.left,y:ne},A=Z.getHeadHeight(Z.columns)+Z.getFootHeight(Z.columns),I=ne+me.bottom+A;if(oe.pageBreak==="avoid"){var R=Z.body,M=R.reduce(function(fe,ee){return fe+ee.height},0);I+=M}var K=new p.DocHandler(J);(oe.pageBreak==="always"||oe.startY!=null&&I>K.pageSize().height)&&(de(K),be.y=me.top),Z.callWillDrawPageHooks(K,be);var he=(0,m.assign)({},be);Z.startPageNumber=K.pageNumber(),oe.horizontalPageBreak?b(K,Z,he,be):(K.applyStyles(K.userStyles),(oe.showHead==="firstPage"||oe.showHead==="everyPage")&&Z.head.forEach(function(fe){return D(K,Z,fe,be,Z.columns)}),K.applyStyles(K.userStyles),Z.body.forEach(function(fe,ee){var ve=ee===Z.body.length-1;P(K,Z,fe,ve,he,be,Z.columns)}),K.applyStyles(K.userStyles),(oe.showFoot==="lastPage"||oe.showFoot==="everyPage")&&Z.foot.forEach(function(fe){return D(K,Z,fe,be,Z.columns)})),(0,u.addTableBorder)(K,Z,he,be),Z.callEndPageHooks(K,be),Z.finalY=be.y,J.lastAutoTable=Z,J.previousAutoTable=Z,J.autoTable&&(J.autoTable.previous=Z),K.applyStyles(K.userStyles)}d.drawTable=N;function b(J,Z,oe,ne){var me=(0,v.calculateAllColumnsCanFitInPage)(J,Z),be=Z.settings;if(be.horizontalPageBreakBehaviour==="afterAllRows")me.forEach(function(M,K){J.applyStyles(J.userStyles),K>0?G(J,Z,oe,ne,M.columns,!0):y(J,Z,ne,M.columns),_(J,Z,oe,ne,M.columns),O(J,Z,ne,M.columns)});else for(var A=-1,I=me[0],R=function(){var M=A;if(I){J.applyStyles(J.userStyles);var K=I.columns;A>=0?G(J,Z,oe,ne,K,!0):y(J,Z,ne,K),M=T(J,Z,A+1,ne,K),O(J,Z,ne,K)}var he=M-A;me.slice(1).forEach(function(fe){J.applyStyles(J.userStyles),G(J,Z,oe,ne,fe.columns,!0),T(J,Z,A+1,ne,fe.columns,he),O(J,Z,ne,fe.columns)}),A=M};A<Z.body.length-1;)R()}function y(J,Z,oe,ne){var me=Z.settings;J.applyStyles(J.userStyles),(me.showHead==="firstPage"||me.showHead==="everyPage")&&Z.head.forEach(function(be){return D(J,Z,be,oe,ne)})}function _(J,Z,oe,ne,me){J.applyStyles(J.userStyles),Z.body.forEach(function(be,A){var I=A===Z.body.length-1;P(J,Z,be,I,oe,ne,me)})}function T(J,Z,oe,ne,me,be){J.applyStyles(J.userStyles),be=be??Z.body.length;var A=Math.min(oe+be,Z.body.length),I=-1;return Z.body.slice(oe,A).forEach(function(R,M){var K=oe+M===Z.body.length-1,he=z(J,Z,K,ne);R.canEntireRowFit(he,me)&&(D(J,Z,R,ne,me),I=oe+M)}),I}function O(J,Z,oe,ne){var me=Z.settings;J.applyStyles(J.userStyles),(me.showFoot==="lastPage"||me.showFoot==="everyPage")&&Z.foot.forEach(function(be){return D(J,Z,be,oe,ne)})}function B(J,Z,oe){var ne=oe.getLineHeight(J.styles.fontSize),me=J.padding("vertical"),be=Math.floor((Z-me)/ne);return Math.max(0,be)}function L(J,Z,oe,ne){var me={};J.spansMultiplePages=!0,J.height=0;for(var be=0,A=0,I=oe.columns;A<I.length;A++){var R=I[A],M=J.cells[R.index];if(M){Array.isArray(M.text)||(M.text=[M.text]);var K=new g.Cell(M.raw,M.styles,M.section);K=(0,m.assign)(K,M),K.text=[];var he=B(M,Z,ne);M.text.length>he&&(K.text=M.text.splice(he,M.text.length));var fe=ne.scaleFactor(),ee=ne.getLineHeightFactor();M.contentHeight=M.getContentHeight(fe,ee),M.contentHeight>=Z&&(M.contentHeight=Z,K.styles.minCellHeight-=Z),M.contentHeight>J.height&&(J.height=M.contentHeight),K.contentHeight=K.getContentHeight(fe,ee),K.contentHeight>be&&(be=K.contentHeight),me[R.index]=K}}var ve=new g.Row(J.raw,-1,J.section,me,!0);ve.height=be;for(var Ce=0,De=oe.columns;Ce<De.length;Ce++){var R=De[Ce],K=ve.cells[R.index];K&&(K.height=ve.height);var M=J.cells[R.index];M&&(M.height=J.height)}return ve}function E(J,Z,oe,ne){var me=J.pageSize().height,be=ne.settings.margin,A=be.top+be.bottom,I=me-A;Z.section==="body"&&(I-=ne.getHeadHeight(ne.columns)+ne.getFootHeight(ne.columns));var R=Z.getMinimumRowHeight(ne.columns,J),M=R<oe;if(R>I)return console.error("Will not be able to print row ".concat(Z.index," correctly since it's minimum height is larger than page height")),!0;if(!M)return!1;var K=Z.hasRowSpan(ne.columns),he=Z.getMaxCellHeight(ne.columns)>I;return he?(K&&console.error("The content of row ".concat(Z.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(K||ne.settings.rowPageBreak==="avoid")}function P(J,Z,oe,ne,me,be,A){var I=z(J,Z,ne,be);if(oe.canEntireRowFit(I,A))D(J,Z,oe,be,A);else if(E(J,oe,I,Z)){var R=L(oe,I,Z,J);D(J,Z,oe,be,A),G(J,Z,me,be,A),P(J,Z,R,ne,me,be,A)}else G(J,Z,me,be,A),P(J,Z,oe,ne,me,be,A)}function D(J,Z,oe,ne,me){ne.x=Z.settings.margin.left;for(var be=0,A=me;be<A.length;be++){var I=A[be],R=oe.cells[I.index];if(!R){ne.x+=I.width;continue}J.applyStyles(R.styles),R.x=ne.x,R.y=ne.y;var M=Z.callCellHooks(J,Z.hooks.willDrawCell,R,oe,I,ne);if(M===!1){ne.x+=I.width;continue}k(J,R,ne);var K=R.getTextPos();(0,j.default)(R.text,K.x,K.y,{halign:R.styles.halign,valign:R.styles.valign,maxWidth:Math.ceil(R.width-R.padding("left")-R.padding("right"))},J.getDocument()),Z.callCellHooks(J,Z.hooks.didDrawCell,R,oe,I,ne),ne.x+=I.width}ne.y+=oe.height}function k(J,Z,oe){var ne=Z.styles;if(J.getDocument().setFillColor(J.getDocument().getFillColor()),typeof ne.lineWidth=="number"){var me=(0,u.getFillStyle)(ne.lineWidth,ne.fillColor);me&&J.rect(Z.x,oe.y,Z.width,Z.height,me)}else typeof ne.lineWidth=="object"&&(ne.fillColor&&J.rect(Z.x,oe.y,Z.width,Z.height,"F"),C(J,Z,oe,ne.lineWidth))}function C(J,Z,oe,ne){var me,be,A,I;ne.top&&(me=oe.x,be=oe.y,A=oe.x+Z.width,I=oe.y,ne.right&&(A+=.5*ne.right),ne.left&&(me-=.5*ne.left),R(ne.top,me,be,A,I)),ne.bottom&&(me=oe.x,be=oe.y+Z.height,A=oe.x+Z.width,I=oe.y+Z.height,ne.right&&(A+=.5*ne.right),ne.left&&(me-=.5*ne.left),R(ne.bottom,me,be,A,I)),ne.left&&(me=oe.x,be=oe.y,A=oe.x,I=oe.y+Z.height,ne.top&&(be-=.5*ne.top),ne.bottom&&(I+=.5*ne.bottom),R(ne.left,me,be,A,I)),ne.right&&(me=oe.x+Z.width,be=oe.y,A=oe.x+Z.width,I=oe.y+Z.height,ne.top&&(be-=.5*ne.top),ne.bottom&&(I+=.5*ne.bottom),R(ne.right,me,be,A,I));function R(M,K,he,fe,ee){J.getDocument().setLineWidth(M),J.getDocument().line(K,he,fe,ee,"S")}}function z(J,Z,oe,ne){var me=Z.settings.margin.bottom,be=Z.settings.showFoot;return(be==="everyPage"||be==="lastPage"&&oe)&&(me+=Z.getFootHeight(Z.columns)),J.pageSize().height-ne.y-me}function G(J,Z,oe,ne,me,be){me===void 0&&(me=[]),be===void 0&&(be=!1),J.applyStyles(J.userStyles),Z.settings.showFoot==="everyPage"&&!be&&Z.foot.forEach(function(I){return D(J,Z,I,ne,me)}),Z.callEndPageHooks(J,ne);var A=Z.settings.margin;(0,u.addTableBorder)(J,Z,oe,ne),de(J),Z.pageNumber++,Z.pageCount++,ne.x=A.left,ne.y=A.top,oe.y=A.top,Z.callWillDrawPageHooks(J,ne),Z.settings.showHead==="everyPage"&&(Z.head.forEach(function(I){return D(J,Z,I,ne,me)}),J.applyStyles(J.userStyles))}d.addPage=G;function de(J){var Z=J.pageNumber();J.setPage(Z+1);var oe=J.pageNumber();return oe===Z?(J.addPage(),!0):!1}},224:function(c,d,f){Object.defineProperty(d,"__esModule",{value:!0}),d.calculateAllColumnsCanFitInPage=void 0;var u=f(420);function g(m,j,v){var N;v===void 0&&(v={});var b=(0,u.getPageAvailableWidth)(m,j),y=new Map,_=[],T=[],O=[];j.settings.horizontalPageBreakRepeat,Array.isArray(j.settings.horizontalPageBreakRepeat)?O=j.settings.horizontalPageBreakRepeat:(typeof j.settings.horizontalPageBreakRepeat=="string"||typeof j.settings.horizontalPageBreakRepeat=="number")&&(O=[j.settings.horizontalPageBreakRepeat]),O.forEach(function(P){var D=j.columns.find(function(k){return k.dataKey===P||k.index===P});D&&!y.has(D.index)&&(y.set(D.index,!0),_.push(D.index),T.push(j.columns[D.index]),b-=D.wrappedWidth)});for(var B=!0,L=(N=v==null?void 0:v.start)!==null&&N!==void 0?N:0;L<j.columns.length;){if(y.has(L)){L++;continue}var E=j.columns[L].wrappedWidth;if(B||b>=E)B=!1,_.push(L),T.push(j.columns[L]),b-=E;else break;L++}return{colIndexes:_,columns:T,lastIndex:L-1}}function p(m,j){for(var v=[],N=0;N<j.columns.length;N++){var b=g(m,j,{start:N});b.columns.length&&(v.push(b),N=b.lastIndex)}return v}d.calculateAllColumnsCanFitInPage=p},324:function(c,d,f){Object.defineProperty(d,"__esModule",{value:!0}),d.ellipsize=d.resizeColumns=d.calculateWidths=void 0;var u=f(420);function g(_,T){p(_,T);var O=[],B=0;T.columns.forEach(function(E){var P=E.getMaxCustomCellWidth(T);P?E.width=P:(E.width=E.wrappedWidth,O.push(E)),B+=E.width});var L=T.getWidth(_.pageSize().width)-B;L&&(L=m(O,L,function(E){return Math.max(E.minReadableWidth,E.minWidth)})),L&&(L=m(O,L,function(E){return E.minWidth})),L=Math.abs(L),!T.settings.horizontalPageBreak&&L>.1/_.scaleFactor()&&(L=L<1?L:Math.round(L),console.warn("Of the table content, ".concat(L," units width could not fit page"))),v(T),N(T,_),j(T)}d.calculateWidths=g;function p(_,T){var O=_.scaleFactor(),B=T.settings.horizontalPageBreak,L=(0,u.getPageAvailableWidth)(_,T);T.allRows().forEach(function(E){for(var P=0,D=T.columns;P<D.length;P++){var k=D[P],C=E.cells[k.index];if(C){var z=T.hooks.didParseCell;T.callCellHooks(_,z,C,E,k,null);var G=C.padding("horizontal");C.contentWidth=(0,u.getStringWidth)(C.text,C.styles,_)+G;var de=(0,u.getStringWidth)(C.text.join(" ").split(/[^\S\u00A0]+/),C.styles,_);if(C.minReadableWidth=de+C.padding("horizontal"),typeof C.styles.cellWidth=="number")C.minWidth=C.styles.cellWidth,C.wrappedWidth=C.styles.cellWidth;else if(C.styles.cellWidth==="wrap"||B===!0)C.contentWidth>L?(C.minWidth=L,C.wrappedWidth=L):(C.minWidth=C.contentWidth,C.wrappedWidth=C.contentWidth);else{var J=10/O;C.minWidth=C.styles.minCellWidth||J,C.wrappedWidth=C.contentWidth,C.minWidth>C.wrappedWidth&&(C.wrappedWidth=C.minWidth)}}}}),T.allRows().forEach(function(E){for(var P=0,D=T.columns;P<D.length;P++){var k=D[P],C=E.cells[k.index];if(C&&C.colSpan===1)k.wrappedWidth=Math.max(k.wrappedWidth,C.wrappedWidth),k.minWidth=Math.max(k.minWidth,C.minWidth),k.minReadableWidth=Math.max(k.minReadableWidth,C.minReadableWidth);else{var z=T.styles.columnStyles[k.dataKey]||T.styles.columnStyles[k.index]||{},G=z.cellWidth||z.minCellWidth;G&&typeof G=="number"&&(k.minWidth=G,k.wrappedWidth=G)}C&&(C.colSpan>1&&!k.minWidth&&(k.minWidth=C.minWidth),C.colSpan>1&&!k.wrappedWidth&&(k.wrappedWidth=C.minWidth))}})}function m(_,T,O){for(var B=T,L=_.reduce(function(J,Z){return J+Z.wrappedWidth},0),E=0;E<_.length;E++){var P=_[E],D=P.wrappedWidth/L,k=B*D,C=P.width+k,z=O(P),G=C<z?z:C;T-=G-P.width,P.width=G}if(T=Math.round(T*1e10)/1e10,T){var de=_.filter(function(J){return T<0?J.width>O(J):!0});de.length&&(T=m(de,T,O))}return T}d.resizeColumns=m;function j(_){for(var T={},O=1,B=_.allRows(),L=0;L<B.length;L++)for(var E=B[L],P=0,D=_.columns;P<D.length;P++){var k=D[P],C=T[k.index];if(O>1)O--,delete E.cells[k.index];else if(C)C.cell.height+=E.height,O=C.cell.colSpan,delete E.cells[k.index],C.left--,C.left<=1&&delete T[k.index];else{var z=E.cells[k.index];if(!z)continue;if(z.height=E.height,z.rowSpan>1){var G=B.length-L,de=z.rowSpan>G?G:z.rowSpan;T[k.index]={cell:z,left:de,row:E}}}}}function v(_){for(var T=_.allRows(),O=0;O<T.length;O++)for(var B=T[O],L=null,E=0,P=0,D=0;D<_.columns.length;D++){var k=_.columns[D];if(P-=1,P>1&&_.columns[D+1])E+=k.width,delete B.cells[k.index];else if(L){var C=L;delete B.cells[k.index],L=null,C.width=k.width+E}else{var C=B.cells[k.index];if(!C)continue;if(P=C.colSpan,E=0,C.colSpan>1){L=C,E+=k.width;continue}C.width=k.width+E}}}function N(_,T){for(var O={count:0,height:0},B=0,L=_.allRows();B<L.length;B++){for(var E=L[B],P=0,D=_.columns;P<D.length;P++){var k=D[P],C=E.cells[k.index];if(C){T.applyStyles(C.styles,!0);var z=C.width-C.padding("horizontal");if(C.styles.overflow==="linebreak")C.text=T.splitTextToSize(C.text,z+1/T.scaleFactor(),{fontSize:C.styles.fontSize});else if(C.styles.overflow==="ellipsize")C.text=b(C.text,z,C.styles,T,"...");else if(C.styles.overflow==="hidden")C.text=b(C.text,z,C.styles,T,"");else if(typeof C.styles.overflow=="function"){var G=C.styles.overflow(C.text,z);typeof G=="string"?C.text=[G]:C.text=G}C.contentHeight=C.getContentHeight(T.scaleFactor(),T.getLineHeightFactor());var de=C.contentHeight/C.rowSpan;C.rowSpan>1&&O.count*O.height<de*C.rowSpan?O={height:de,count:C.rowSpan}:O&&O.count>0&&O.height>de&&(de=O.height),de>E.height&&(E.height=de)}}O.count--}}function b(_,T,O,B,L){return _.map(function(E){return y(E,T,O,B,L)})}d.ellipsize=b;function y(_,T,O,B,L){var E=1e4*B.scaleFactor();if(T=Math.ceil(T*E)/E,T>=(0,u.getStringWidth)(_,O,B))return _;for(;T<(0,u.getStringWidth)(_+L,O,B)&&!(_.length<=1);)_=_.substring(0,_.length-1);return _.trim()+L}},964:function(c){if(typeof t>"u"){var d=new Error("Cannot find module 'undefined'");throw d.code="MODULE_NOT_FOUND",d}c.exports=t}},s={};function o(c){var d=s[c];if(d!==void 0)return d.exports;var f=s[c]={exports:{}};return n[c].call(f.exports,f,f.exports,o),f.exports}var l={};return function(){var c=l;Object.defineProperty(c,"__esModule",{value:!0}),c.Cell=c.Column=c.Row=c.Table=c.CellHookData=c.__drawTable=c.__createTable=c.applyPlugin=void 0;var d=o(340),f=o(776),u=o(664),g=o(972),p=o(260);Object.defineProperty(c,"Table",{enumerable:!0,get:function(){return p.Table}});var m=o(172);Object.defineProperty(c,"CellHookData",{enumerable:!0,get:function(){return m.CellHookData}});var j=o(260);Object.defineProperty(c,"Cell",{enumerable:!0,get:function(){return j.Cell}}),Object.defineProperty(c,"Column",{enumerable:!0,get:function(){return j.Column}}),Object.defineProperty(c,"Row",{enumerable:!0,get:function(){return j.Row}});function v(T){(0,d.default)(T)}c.applyPlugin=v;function N(T,O){var B=(0,f.parseInput)(T,O),L=(0,g.createTable)(T,B);(0,u.drawTable)(T,L)}function b(T,O){var B=(0,f.parseInput)(T,O);return(0,g.createTable)(T,B)}c.__createTable=b;function y(T,O){(0,u.drawTable)(T,O)}c.__drawTable=y;try{var _=o(964);_.jsPDF&&(_=_.jsPDF),v(_)}catch{}c.default=N}(),l}()})})(Vp);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var tc={};tc.version="0.18.5";var Wf=1252,$p=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],zf=function(e){$p.indexOf(e)!=-1&&(Wf=e)};function Yp(){zf(1252)}var Oo=function(e){zf(e)};function Kp(){Oo(1200),Yp()}var zl=function(r){return String.fromCharCode(r)},Th=function(r){return String.fromCharCode(r)},rc,ps="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Io(e){for(var r="",t=0,n=0,s=0,o=0,l=0,c=0,d=0,f=0;f<e.length;)t=e.charCodeAt(f++),o=t>>2,n=e.charCodeAt(f++),l=(t&3)<<4|n>>4,s=e.charCodeAt(f++),c=(n&15)<<2|s>>6,d=s&63,isNaN(n)?c=d=64:isNaN(s)&&(d=64),r+=ps.charAt(o)+ps.charAt(l)+ps.charAt(c)+ps.charAt(d);return r}function $n(e){var r="",t=0,n=0,s=0,o=0,l=0,c=0,d=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)o=ps.indexOf(e.charAt(f++)),l=ps.indexOf(e.charAt(f++)),t=o<<2|l>>4,r+=String.fromCharCode(t),c=ps.indexOf(e.charAt(f++)),n=(l&15)<<4|c>>2,c!==64&&(r+=String.fromCharCode(n)),d=ps.indexOf(e.charAt(f++)),s=(c&3)<<6|d,d!==64&&(r+=String.fromCharCode(s));return r}var Ht=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Kn=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function zs(e){return Ht?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Ch(e){return Ht?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var fn=function(r){return Ht?Kn(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function yc(e){if(typeof ArrayBuffer>"u")return fn(e);for(var r=new ArrayBuffer(e.length),t=new Uint8Array(r),n=0;n!=e.length;++n)t[n]=e.charCodeAt(n)&255;return r}function Ho(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function Xp(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Yr=Ht?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:Kn(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),s=0;for(r=0,t=0;r<e.length;t+=s,++r)if(s=e[r].length,e[r]instanceof Uint8Array)n.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";n.set(new Uint8Array(e[r]),t)}return n}return[].concat.apply([],e.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function Jp(e){for(var r=[],t=0,n=e.length+250,s=zs(e.length+255),o=0;o<e.length;++o){var l=e.charCodeAt(o);if(l<128)s[t++]=l;else if(l<2048)s[t++]=192|l>>6&31,s[t++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var c=e.charCodeAt(++o)&1023;s[t++]=240|l>>8&7,s[t++]=128|l>>2&63,s[t++]=128|c>>6&15|(l&3)<<4,s[t++]=128|c&63}else s[t++]=224|l>>12&15,s[t++]=128|l>>6&63,s[t++]=128|l&63;t>n&&(r.push(s.slice(0,t)),t=0,s=zs(65535),n=65530)}return r.push(s.slice(0,t)),Yr(r)}var Ao=/\u0000/g,ql=/[\u0001-\u0006]/g;function Li(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function un(e,r){var t=""+e;return t.length>=r?t:mr("0",r-t.length)+t}function rd(e,r){var t=""+e;return t.length>=r?t:mr(" ",r-t.length)+t}function ac(e,r){var t=""+e;return t.length>=r?t:t+mr(" ",r-t.length)}function Zp(e,r){var t=""+Math.round(e);return t.length>=r?t:mr("0",r-t.length)+t}function Qp(e,r){var t=""+e;return t.length>=r?t:mr("0",r-t.length)+t}var Eh=Math.pow(2,32);function Ni(e,r){if(e>Eh||e<-Eh)return Zp(e,r);var t=Math.round(e);return Qp(t,r)}function nc(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var Lh=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],S0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function eg(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "',e}var pr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "'},Fh={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},tg={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function sc(e,r,t){for(var n=e<0?-1:1,s=e*n,o=0,l=1,c=0,d=1,f=0,u=0,g=Math.floor(s);f<r&&(g=Math.floor(s),c=g*l+o,u=g*f+d,!(s-g<5e-8));)s=1/(s-g),o=l,l=c,d=f,f=u;if(u>r&&(f>r?(u=d,c=o):(u=f,c=l)),!t)return[0,n*c,u];var p=Math.floor(n*c/u);return[p,n*c-p*u,u]}function Vl(e,r,t){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),o=0,l=[],c={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),r&&r.date1904&&(n+=1462),c.u>.9999&&(c.u=0,++s==86400&&(c.T=s=0,++n,++c.D)),n===60)l=t?[1317,10,29]:[1900,2,29],o=3;else if(n===0)l=t?[1317,8,29]:[1900,1,0],o=6;else{n>60&&--n;var d=new Date(1900,0,1);d.setDate(d.getDate()+n-1),l=[d.getFullYear(),d.getMonth()+1,d.getDate()],o=d.getDay(),n<60&&(o=(o+6)%7),t&&(o=lg(d,l))}return c.y=l[0],c.m=l[1],c.d=l[2],c.S=s%60,s=Math.floor(s/60),c.M=s%60,s=Math.floor(s/60),c.H=s,c.q=o,c}var qf=new Date(1899,11,31,0,0,0),rg=qf.getTime(),ag=new Date(1900,2,1,0,0,0);function Vf(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=ag&&(t+=24*60*60*1e3),(t-(rg+(e.getTimezoneOffset()-qf.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function ad(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function ng(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function sg(e){var r=e<0?12:11,t=ad(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function ig(e){var r=ad(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function og(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=sg(e):r===10?t=e.toFixed(10).substr(0,12):t=ig(e),ad(ng(t.toUpperCase()))}function $0(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):og(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ws(14,Vf(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function lg(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function cg(e,r,t,n){var s="",o=0,l=0,c=t.y,d,f=0;switch(e){case 98:c=t.y+543;case 121:switch(r.length){case 1:case 2:d=c%100,f=2;break;default:d=c%1e4,f=4;break}break;case 109:switch(r.length){case 1:case 2:d=t.m,f=r.length;break;case 3:return S0[t.m-1][1];case 5:return S0[t.m-1][0];default:return S0[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:d=t.d,f=r.length;break;case 3:return Lh[t.q][0];default:return Lh[t.q][1]}break;case 104:switch(r.length){case 1:case 2:d=1+(t.H+11)%12,f=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:d=t.H,f=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:d=t.M,f=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?un(t.S,r.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,o=Math.round(l*(t.S+t.u)),o>=60*l&&(o=0),r==="s"?o===0?"0":""+o/l:(s=un(o,2+n),r==="ss"?s.substr(0,2):"."+s.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":d=t.D*24+t.H;break;case"[m]":case"[mm]":d=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":d=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}f=r.length===3?1:2;break;case 101:d=c,f=1;break}var u=f>0?un(d,f):"";return u}function gs(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,n=e.substr(0,t);t!=e.length;t+=r)n+=(n.length>0?",":"")+e.substr(t,r);return n}var Gf=/%/g;function dg(e,r,t){var n=r.replace(Gf,""),s=r.length-n.length;return qn(e,n,t*Math.pow(10,2*s))+mr("%",s)}function hg(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return qn(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function $f(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+$f(e,-r);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%s;if(o<0&&(o+=s),t=(r/Math.pow(10,o)).toPrecision(n+1+(s+o)%s),t.indexOf("e")===-1){var l=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+o):t+="E+"+(l-o);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,s)+"."+t.substr(2+s),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,d,f,u){return d+f+u.substr(0,(s+o)%s)+"."+u.substr(o)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Yf=/# (\?+)( ?)\/( ?)(\d+)/;function fg(e,r,t){var n=parseInt(e[4],10),s=Math.round(r*n),o=Math.floor(s/n),l=s-o*n,c=n;return t+(o===0?"":""+o)+" "+(l===0?mr(" ",e[1].length+1+e[4].length):rd(l,e[1].length)+e[2]+"/"+e[3]+un(c,e[4].length))}function ug(e,r,t){return t+(r===0?"":""+r)+mr(" ",e[1].length+2+e[4].length)}var Kf=/^#*0*\.([0#]+)/,Xf=/\).*[0#]/,Jf=/\(###\) ###\\?-####/;function ha(e){for(var r="",t,n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function Ph(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function Oh(e,r){var t=e-Math.floor(e),n=Math.pow(10,r);return r<(""+Math.round(t*n)).length?0:Math.round(t*n)}function mg(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function xg(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ya(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Xf)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Ya("n",n,t):"("+Ya("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return hg(e,r,t);if(r.indexOf("%")!==-1)return dg(e,r,t);if(r.indexOf("E")!==-1)return $f(r,t);if(r.charCodeAt(0)===36)return"$"+Ya(e,r.substr(r.charAt(1)==" "?2:1),t);var s,o,l,c,d=Math.abs(t),f=t<0?"-":"";if(r.match(/^00+$/))return f+Ni(d,r.length);if(r.match(/^[#?]+$/))return s=Ni(t,0),s==="0"&&(s=""),s.length>r.length?s:ha(r.substr(0,r.length-s.length))+s;if(o=r.match(Yf))return fg(o,d,f);if(r.match(/^#+0+$/))return f+Ni(d,r.length-r.indexOf("0"));if(o=r.match(Kf))return s=Ph(t,o[1].length).replace(/^([^\.]+)$/,"$1."+ha(o[1])).replace(/\.$/,"."+ha(o[1])).replace(/\.(\d*)$/,function(j,v){return"."+v+mr("0",ha(o[1]).length-v.length)}),r.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return f+Ph(d,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return f+gs(Ni(d,0));if(o=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Ya(e,r,-t):gs(""+(Math.floor(t)+mg(t,o[1].length)))+"."+un(Oh(t,o[1].length),o[1].length);if(o=r.match(/^#,#*,#0/))return Ya(e,r.replace(/^#,#*,/,""),t);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Li(Ya(e,r.replace(/[\\-]/g,""),t)),l=0,Li(Li(r.replace(/\\/g,"")).replace(/[0#]/g,function(j){return l<s.length?s.charAt(l++):j==="0"?"0":""}));if(r.match(Jf))return s=Ya(e,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),c=sc(d,Math.pow(10,l)-1,!1),s=""+f,u=qn("n",o[1],c[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+o[2]+"/"+o[3],u=ac(c[2],l),u.length<o[4].length&&(u=ha(o[4].substr(o[4].length-u.length))+u),s+=u,s;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),c=sc(d,Math.pow(10,l)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?rd(c[1],l)+o[2]+"/"+o[3]+ac(c[2],l):mr(" ",2*l+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return s=Ni(t,0),r.length<=s.length?s:ha(r.substr(0,r.length-s.length))+s;if(o=r.match(/^([#0?]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=s.indexOf(".");var g=r.indexOf(".")-l,p=r.length-s.length-g;return ha(r.substr(0,g)+s+r.substr(r.length-p))}if(o=r.match(/^00,000\.([#0]*0)$/))return l=Oh(t,o[1].length),t<0?"-"+Ya(e,r,-t):gs(xg(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(j){return"00,"+(j.length<3?un(0,3-j.length):"")+j})+"."+un(l,o[1].length);switch(r){case"###,##0.00":return Ya(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var m=gs(Ni(d,0));return m!=="0"?f+m:"";case"###,###.00":return Ya(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Ya(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function pg(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return qn(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function gg(e,r,t){var n=r.replace(Gf,""),s=r.length-n.length;return qn(e,n,t*Math.pow(10,2*s))+mr("%",s)}function Zf(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Zf(e,-r);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%s;if(o<0&&(o+=s),t=(r/Math.pow(10,o)).toPrecision(n+1+(s+o)%s),!t.match(/[Ee]/)){var l=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+o):t+="E+"+(l-o),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,d,f,u){return d+f+u.substr(0,(s+o)%s)+"."+u.substr(o)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function An(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Xf)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?An("n",n,t):"("+An("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return pg(e,r,t);if(r.indexOf("%")!==-1)return gg(e,r,t);if(r.indexOf("E")!==-1)return Zf(r,t);if(r.charCodeAt(0)===36)return"$"+An(e,r.substr(r.charAt(1)==" "?2:1),t);var s,o,l,c,d=Math.abs(t),f=t<0?"-":"";if(r.match(/^00+$/))return f+un(d,r.length);if(r.match(/^[#?]+$/))return s=""+t,t===0&&(s=""),s.length>r.length?s:ha(r.substr(0,r.length-s.length))+s;if(o=r.match(Yf))return ug(o,d,f);if(r.match(/^#+0+$/))return f+un(d,r.length-r.indexOf("0"));if(o=r.match(Kf))return s=(""+t).replace(/^([^\.]+)$/,"$1."+ha(o[1])).replace(/\.$/,"."+ha(o[1])),s=s.replace(/\.(\d*)$/,function(j,v){return"."+v+mr("0",ha(o[1]).length-v.length)}),r.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return f+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return f+gs(""+d);if(o=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+An(e,r,-t):gs(""+t)+"."+mr("0",o[1].length);if(o=r.match(/^#,#*,#0/))return An(e,r.replace(/^#,#*,/,""),t);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Li(An(e,r.replace(/[\\-]/g,""),t)),l=0,Li(Li(r.replace(/\\/g,"")).replace(/[0#]/g,function(j){return l<s.length?s.charAt(l++):j==="0"?"0":""}));if(r.match(Jf))return s=An(e,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),c=sc(d,Math.pow(10,l)-1,!1),s=""+f,u=qn("n",o[1],c[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+o[2]+"/"+o[3],u=ac(c[2],l),u.length<o[4].length&&(u=ha(o[4].substr(o[4].length-u.length))+u),s+=u,s;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),c=sc(d,Math.pow(10,l)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?rd(c[1],l)+o[2]+"/"+o[3]+ac(c[2],l):mr(" ",2*l+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return s=""+t,r.length<=s.length?s:ha(r.substr(0,r.length-s.length))+s;if(o=r.match(/^([#0]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=s.indexOf(".");var g=r.indexOf(".")-l,p=r.length-s.length-g;return ha(r.substr(0,g)+s+r.substr(r.length-p))}if(o=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+An(e,r,-t):gs(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(j){return"00,"+(j.length<3?un(0,3-j.length):"")+j})+"."+un(0,o[1].length);switch(r){case"###,###":case"##,###":case"#,###":var m=gs(""+d);return m!=="0"?f+m:"";default:if(r.match(/\.[0#?]*$/))return An(e,r.slice(0,r.lastIndexOf(".")),t)+ha(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function qn(e,r,t){return(t|0)===t?An(e,r,t):Ya(e,r,t)}function vg(e){for(var r=[],t=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=e.substr(s,n-s),s=n+1}if(r[r.length]=e.substr(s),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var Qf=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function eu(e){for(var r=0,t="",n="";r<e.length;)switch(t=e.charAt(r)){case"G":nc(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"ä¸Š":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="ä¸Šåˆ/ä¸‹åˆ")return!0;++r;break;case"[":for(n=t;e.charAt(r++)!=="]"&&r<e.length;)n+=e.charAt(r);if(n.match(Qf))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function yg(e,r,t,n){for(var s=[],o="",l=0,c="",d="t",f,u,g,p="H";l<e.length;)switch(c=e.charAt(l)){case"G":if(!nc(e,l))throw new Error("unrecognized character "+c+" in "+e);s[s.length]={t:"G",v:"General"},l+=7;break;case'"':for(o="";(g=e.charCodeAt(++l))!==34&&l<e.length;)o+=String.fromCharCode(g);s[s.length]={t:"t",v:o},++l;break;case"\\":var m=e.charAt(++l),j=m==="("||m===")"?m:"t";s[s.length]={t:j,v:m},++l;break;case"_":s[s.length]={t:"t",v:" "},l+=2;break;case"@":s[s.length]={t:"T",v:r},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(f==null&&(f=Vl(r,t,e.charAt(l+1)==="2"),f==null))return"";s[s.length]={t:"X",v:e.substr(l,2)},d=c,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||f==null&&(f=Vl(r,t),f==null))return"";for(o=c;++l<e.length&&e.charAt(l).toLowerCase()===c;)o+=c;c==="m"&&d.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=p),s[s.length]={t:c,v:o},d=c;break;case"A":case"a":case"ä¸Š":var v={t:c,v:c};if(f==null&&(f=Vl(r,t)),e.substr(l,3).toUpperCase()==="A/P"?(f!=null&&(v.v=f.H>=12?"P":"A"),v.t="T",p="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(f!=null&&(v.v=f.H>=12?"PM":"AM"),v.t="T",l+=5,p="h"):e.substr(l,5).toUpperCase()==="ä¸Šåˆ/ä¸‹åˆ"?(f!=null&&(v.v=f.H>=12?"ä¸‹åˆ":"ä¸Šåˆ"),v.t="T",l+=5,p="h"):(v.t="t",++l),f==null&&v.t==="T")return"";s[s.length]=v,d=c;break;case"[":for(o=c;e.charAt(l++)!=="]"&&l<e.length;)o+=e.charAt(l);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(Qf)){if(f==null&&(f=Vl(r,t),f==null))return"";s[s.length]={t:"Z",v:o.toLowerCase()},d=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",eu(e)||(s[s.length]={t:"t",v:o}));break;case".":if(f!=null){for(o=c;++l<e.length&&(c=e.charAt(l))==="0";)o+=c;s[s.length]={t:"s",v:o};break}case"0":case"#":for(o=c;++l<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(l))>-1;)o+=c;s[s.length]={t:"n",v:o};break;case"?":for(o=c;e.charAt(++l)===c;)o+=c;s[s.length]={t:c,v:o},d=c;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":s[s.length]={t:n===1?"t":c,v:c},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=c;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)o+=e.charAt(l);s[s.length]={t:"D",v:o};break;case" ":s[s.length]={t:c,v:c},++l;break;case"$":s[s.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=â‚¬acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);s[s.length]={t:"t",v:c},++l;break}var N=0,b=0,y;for(l=s.length-1,d="t";l>=0;--l)switch(s[l].t){case"h":case"H":s[l].t=p,d="h",N<1&&(N=1);break;case"s":(y=s[l].v.match(/\.0+$/))&&(b=Math.max(b,y[0].length-1)),N<3&&(N=3);case"d":case"y":case"M":case"e":d=s[l].t;break;case"m":d==="s"&&(s[l].t="M",N<2&&(N=2));break;case"X":break;case"Z":N<1&&s[l].v.match(/[Hh]/)&&(N=1),N<2&&s[l].v.match(/[Mm]/)&&(N=2),N<3&&s[l].v.match(/[Ss]/)&&(N=3)}switch(N){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var _="",T;for(l=0;l<s.length;++l)switch(s[l].t){case"t":case"T":case" ":case"D":break;case"X":s[l].v="",s[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[l].v=cg(s[l].t.charCodeAt(0),s[l].v,f,b),s[l].t="t";break;case"n":case"?":for(T=l+1;s[T]!=null&&((c=s[T].t)==="?"||c==="D"||(c===" "||c==="t")&&s[T+1]!=null&&(s[T+1].t==="?"||s[T+1].t==="t"&&s[T+1].v==="/")||s[l].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(s[T].v==="/"||s[T].v===" "&&s[T+1]!=null&&s[T+1].t=="?"));)s[l].v+=s[T].v,s[T]={v:"",t:";"},++T;_+=s[l].v,l=T-1;break;case"G":s[l].t="t",s[l].v=$0(r,t);break}var O="",B,L;if(_.length>0){_.charCodeAt(0)==40?(B=r<0&&_.charCodeAt(0)===45?-r:r,L=qn("n",_,B)):(B=r<0&&n>1?-r:r,L=qn("n",_,B),B<0&&s[0]&&s[0].t=="t"&&(L=L.substr(1),s[0].v="-"+s[0].v)),T=L.length-1;var E=s.length;for(l=0;l<s.length;++l)if(s[l]!=null&&s[l].t!="t"&&s[l].v.indexOf(".")>-1){E=l;break}var P=s.length;if(E===s.length&&L.indexOf("E")===-1){for(l=s.length-1;l>=0;--l)s[l]==null||"n?".indexOf(s[l].t)===-1||(T>=s[l].v.length-1?(T-=s[l].v.length,s[l].v=L.substr(T+1,s[l].v.length)):T<0?s[l].v="":(s[l].v=L.substr(0,T+1),T=-1),s[l].t="t",P=l);T>=0&&P<s.length&&(s[P].v=L.substr(0,T+1)+s[P].v)}else if(E!==s.length&&L.indexOf("E")===-1){for(T=L.indexOf(".")-1,l=E;l>=0;--l)if(!(s[l]==null||"n?".indexOf(s[l].t)===-1)){for(u=s[l].v.indexOf(".")>-1&&l===E?s[l].v.indexOf(".")-1:s[l].v.length-1,O=s[l].v.substr(u+1);u>=0;--u)T>=0&&(s[l].v.charAt(u)==="0"||s[l].v.charAt(u)==="#")&&(O=L.charAt(T--)+O);s[l].v=O,s[l].t="t",P=l}for(T>=0&&P<s.length&&(s[P].v=L.substr(0,T+1)+s[P].v),T=L.indexOf(".")+1,l=E;l<s.length;++l)if(!(s[l]==null||"n?(".indexOf(s[l].t)===-1&&l!==E)){for(u=s[l].v.indexOf(".")>-1&&l===E?s[l].v.indexOf(".")+1:0,O=s[l].v.substr(0,u);u<s[l].v.length;++u)T<L.length&&(O+=L.charAt(T++));s[l].v=O,s[l].t="t",P=l}}}for(l=0;l<s.length;++l)s[l]!=null&&"n?".indexOf(s[l].t)>-1&&(B=n>1&&r<0&&l>0&&s[l-1].v==="-"?-r:r,s[l].v=qn(s[l].t,s[l].v,B),s[l].t="t");var D="";for(l=0;l!==s.length;++l)s[l]!=null&&(D+=s[l].v);return D}var Ih=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Dh(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function bg(e,r){var t=vg(e),n=t.length,s=t[n-1].indexOf("@");if(n<4&&s>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||s>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=s>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=s>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=s>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var o=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,o];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var l=t[0].match(Ih),c=t[1].match(Ih);return Dh(r,l)?[n,t[0]]:Dh(r,c)?[n,t[1]]:[n,t[l!=null&&c!=null?2:1]]}return[n,o]}function ws(e,r,t){t==null&&(t={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?n=t.dateNF:n=e;break;case"number":e==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:pr)[e],n==null&&(n=t.table&&t.table[Fh[e]]||pr[Fh[e]]),n==null&&(n=tg[e]||"General");break}if(nc(n,0))return $0(r,t);r instanceof Date&&(r=Vf(r,t.date1904));var s=bg(n,r);if(nc(s[1]))return $0(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return yg(s[1],r,t,s[0])}function tu(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(pr[t]==null){r<0&&(r=t);continue}if(pr[t]==e){r=t;break}}r<0&&(r=391)}return pr[r]=e,r}function bc(e){for(var r=0;r!=392;++r)e[r]!==void 0&&tu(e[r],r)}function wc(){pr=eg()}var ru=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function wg(e){var r=typeof e=="number"?pr[e]:e;return r=r.replace(ru,"(\\d+)"),new RegExp("^"+r+"$")}function Ng(e,r,t){var n=-1,s=-1,o=-1,l=-1,c=-1,d=-1;(r.match(ru)||[]).forEach(function(g,p){var m=parseInt(t[p+1],10);switch(g.toLowerCase().charAt(0)){case"y":n=m;break;case"d":o=m;break;case"h":l=m;break;case"s":d=m;break;case"m":l>=0?c=m:s=m;break}}),d>=0&&c==-1&&s>=0&&(c=s,s=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var u=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return l==-1&&c==-1&&d==-1?f:n==-1&&s==-1&&o==-1?u:f+"T"+u}var jg=function(){var e={};e.version="1.2.0";function r(){for(var L=0,E=new Array(256),P=0;P!=256;++P)L=P,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,E[P]=L;return typeof Int32Array<"u"?new Int32Array(E):E}var t=r();function n(L){var E=0,P=0,D=0,k=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(D=0;D!=256;++D)k[D]=L[D];for(D=0;D!=256;++D)for(P=L[D],E=256+D;E<4096;E+=256)P=k[E]=P>>>8^L[P&255];var C=[];for(D=1;D!=16;++D)C[D-1]=typeof Int32Array<"u"?k.subarray(D*256,D*256+256):k.slice(D*256,D*256+256);return C}var s=n(t),o=s[0],l=s[1],c=s[2],d=s[3],f=s[4],u=s[5],g=s[6],p=s[7],m=s[8],j=s[9],v=s[10],N=s[11],b=s[12],y=s[13],_=s[14];function T(L,E){for(var P=E^-1,D=0,k=L.length;D<k;)P=P>>>8^t[(P^L.charCodeAt(D++))&255];return~P}function O(L,E){for(var P=E^-1,D=L.length-15,k=0;k<D;)P=_[L[k++]^P&255]^y[L[k++]^P>>8&255]^b[L[k++]^P>>16&255]^N[L[k++]^P>>>24]^v[L[k++]]^j[L[k++]]^m[L[k++]]^p[L[k++]]^g[L[k++]]^u[L[k++]]^f[L[k++]]^d[L[k++]]^c[L[k++]]^l[L[k++]]^o[L[k++]]^t[L[k++]];for(D+=15;k<D;)P=P>>>8^t[(P^L[k++])&255];return~P}function B(L,E){for(var P=E^-1,D=0,k=L.length,C=0,z=0;D<k;)C=L.charCodeAt(D++),C<128?P=P>>>8^t[(P^C)&255]:C<2048?(P=P>>>8^t[(P^(192|C>>6&31))&255],P=P>>>8^t[(P^(128|C&63))&255]):C>=55296&&C<57344?(C=(C&1023)+64,z=L.charCodeAt(D++)&1023,P=P>>>8^t[(P^(240|C>>8&7))&255],P=P>>>8^t[(P^(128|C>>2&63))&255],P=P>>>8^t[(P^(128|z>>6&15|(C&3)<<4))&255],P=P>>>8^t[(P^(128|z&63))&255]):(P=P>>>8^t[(P^(224|C>>12&15))&255],P=P>>>8^t[(P^(128|C>>6&63))&255],P=P>>>8^t[(P^(128|C&63))&255]);return~P}return e.table=t,e.bstr=T,e.buf=O,e.str=B,e}(),Zt=function(){var r={};r.version="1.2.1";function t(q,se){for(var Q=q.split("/"),te=se.split("/"),ae=0,ie=0,Se=Math.min(Q.length,te.length);ae<Se;++ae){if(ie=Q[ae].length-te[ae].length)return ie;if(Q[ae]!=te[ae])return Q[ae]<te[ae]?-1:1}return Q.length-te.length}function n(q){if(q.charAt(q.length-1)=="/")return q.slice(0,-1).indexOf("/")===-1?q:n(q.slice(0,-1));var se=q.lastIndexOf("/");return se===-1?q:q.slice(0,se+1)}function s(q){if(q.charAt(q.length-1)=="/")return s(q.slice(0,-1));var se=q.lastIndexOf("/");return se===-1?q:q.slice(se+1)}function o(q,se){typeof se=="string"&&(se=new Date(se));var Q=se.getHours();Q=Q<<6|se.getMinutes(),Q=Q<<5|se.getSeconds()>>>1,q.write_shift(2,Q);var te=se.getFullYear()-1980;te=te<<4|se.getMonth()+1,te=te<<5|se.getDate(),q.write_shift(2,te)}function l(q){var se=q.read_shift(2)&65535,Q=q.read_shift(2)&65535,te=new Date,ae=Q&31;Q>>>=5;var ie=Q&15;Q>>>=4,te.setMilliseconds(0),te.setFullYear(Q+1980),te.setMonth(ie-1),te.setDate(ae);var Se=se&31;se>>>=5;var Le=se&63;return se>>>=6,te.setHours(se),te.setMinutes(Le),te.setSeconds(Se<<1),te}function c(q){Pa(q,0);for(var se={},Q=0;q.l<=q.length-4;){var te=q.read_shift(2),ae=q.read_shift(2),ie=q.l+ae,Se={};switch(te){case 21589:Q=q.read_shift(1),Q&1&&(Se.mtime=q.read_shift(4)),ae>5&&(Q&2&&(Se.atime=q.read_shift(4)),Q&4&&(Se.ctime=q.read_shift(4))),Se.mtime&&(Se.mt=new Date(Se.mtime*1e3));break}q.l=ie,se[te]=Se}return se}var d;function f(){return d||(d={})}function u(q,se){if(q[0]==80&&q[1]==75)return ir(q,se);if((q[0]|32)==109&&(q[1]|32)==105)return Ua(q,se);if(q.length<512)throw new Error("CFB file size "+q.length+" < 512");var Q=3,te=512,ae=0,ie=0,Se=0,Le=0,je=0,ke=[],Te=q.slice(0,512);Pa(Te,0);var Ge=g(Te);switch(Q=Ge[0],Q){case 3:te=512;break;case 4:te=4096;break;case 0:if(Ge[1]==0)return ir(q,se);default:throw new Error("Major Version: Expected 3 or 4 saw "+Q)}te!==512&&(Te=q.slice(0,te),Pa(Te,28));var Je=q.slice(0,te);p(Te,Q);var ot=Te.read_shift(4,"i");if(Q===3&&ot!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ot);Te.l+=4,Se=Te.read_shift(4,"i"),Te.l+=4,Te.chk("00100000","Mini Stream Cutoff Size: "),Le=Te.read_shift(4,"i"),ae=Te.read_shift(4,"i"),je=Te.read_shift(4,"i"),ie=Te.read_shift(4,"i");for(var Ye=-1,it=0;it<109&&(Ye=Te.read_shift(4,"i"),!(Ye<0));++it)ke[it]=Ye;var bt=m(q,te);N(je,ie,bt,te,ke);var zt=y(bt,Se,ke,te);zt[Se].name="!Directory",ae>0&&Le!==z&&(zt[Le].name="!MiniFAT"),zt[ke[0]].name="!FAT",zt.fat_addrs=ke,zt.ssz=te;var Xt={},Sr=[],Za=[],Pn=[];_(Se,zt,bt,Sr,ae,Xt,Za,Le),j(Za,Pn,Sr),Sr.shift();var yn={FileIndex:Za,FullPaths:Pn};return se&&se.raw&&(yn.raw={header:Je,sectors:bt}),yn}function g(q){if(q[q.l]==80&&q[q.l+1]==75)return[0,0];q.chk(G,"Header Signature: "),q.l+=16;var se=q.read_shift(2,"u");return[q.read_shift(2,"u"),se]}function p(q,se){var Q=9;switch(q.l+=2,Q=q.read_shift(2)){case 9:if(se!=3)throw new Error("Sector Shift: Expected 9 saw "+Q);break;case 12:if(se!=4)throw new Error("Sector Shift: Expected 12 saw "+Q);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Q)}q.chk("0600","Mini Sector Shift: "),q.chk("000000000000","Reserved: ")}function m(q,se){for(var Q=Math.ceil(q.length/se)-1,te=[],ae=1;ae<Q;++ae)te[ae-1]=q.slice(ae*se,(ae+1)*se);return te[Q-1]=q.slice(Q*se),te}function j(q,se,Q){for(var te=0,ae=0,ie=0,Se=0,Le=0,je=Q.length,ke=[],Te=[];te<je;++te)ke[te]=Te[te]=te,se[te]=Q[te];for(;Le<Te.length;++Le)te=Te[Le],ae=q[te].L,ie=q[te].R,Se=q[te].C,ke[te]===te&&(ae!==-1&&ke[ae]!==ae&&(ke[te]=ke[ae]),ie!==-1&&ke[ie]!==ie&&(ke[te]=ke[ie])),Se!==-1&&(ke[Se]=te),ae!==-1&&te!=ke[te]&&(ke[ae]=ke[te],Te.lastIndexOf(ae)<Le&&Te.push(ae)),ie!==-1&&te!=ke[te]&&(ke[ie]=ke[te],Te.lastIndexOf(ie)<Le&&Te.push(ie));for(te=1;te<je;++te)ke[te]===te&&(ie!==-1&&ke[ie]!==ie?ke[te]=ke[ie]:ae!==-1&&ke[ae]!==ae&&(ke[te]=ke[ae]));for(te=1;te<je;++te)if(q[te].type!==0){if(Le=te,Le!=ke[Le])do Le=ke[Le],se[te]=se[Le]+"/"+se[te];while(Le!==0&&ke[Le]!==-1&&Le!=ke[Le]);ke[te]=-1}for(se[0]+="/",te=1;te<je;++te)q[te].type!==2&&(se[te]+="/")}function v(q,se,Q){for(var te=q.start,ae=q.size,ie=[],Se=te;Q&&ae>0&&Se>=0;)ie.push(se.slice(Se*C,Se*C+C)),ae-=C,Se=Ds(Q,Se*4);return ie.length===0?Oe(0):Yr(ie).slice(0,q.size)}function N(q,se,Q,te,ae){var ie=z;if(q===z){if(se!==0)throw new Error("DIFAT chain shorter than expected")}else if(q!==-1){var Se=Q[q],Le=(te>>>2)-1;if(!Se)return;for(var je=0;je<Le&&(ie=Ds(Se,je*4))!==z;++je)ae.push(ie);N(Ds(Se,te-4),se-1,Q,te,ae)}}function b(q,se,Q,te,ae){var ie=[],Se=[];ae||(ae=[]);var Le=te-1,je=0,ke=0;for(je=se;je>=0;){ae[je]=!0,ie[ie.length]=je,Se.push(q[je]);var Te=Q[Math.floor(je*4/te)];if(ke=je*4&Le,te<4+ke)throw new Error("FAT boundary crossed: "+je+" 4 "+te);if(!q[Te])break;je=Ds(q[Te],ke)}return{nodes:ie,data:qh([Se])}}function y(q,se,Q,te){var ae=q.length,ie=[],Se=[],Le=[],je=[],ke=te-1,Te=0,Ge=0,Je=0,ot=0;for(Te=0;Te<ae;++Te)if(Le=[],Je=Te+se,Je>=ae&&(Je-=ae),!Se[Je]){je=[];var Ye=[];for(Ge=Je;Ge>=0;){Ye[Ge]=!0,Se[Ge]=!0,Le[Le.length]=Ge,je.push(q[Ge]);var it=Q[Math.floor(Ge*4/te)];if(ot=Ge*4&ke,te<4+ot)throw new Error("FAT boundary crossed: "+Ge+" 4 "+te);if(!q[it]||(Ge=Ds(q[it],ot),Ye[Ge]))break}ie[Je]={nodes:Le,data:qh([je])}}return ie}function _(q,se,Q,te,ae,ie,Se,Le){for(var je=0,ke=te.length?2:0,Te=se[q].data,Ge=0,Je=0,ot;Ge<Te.length;Ge+=128){var Ye=Te.slice(Ge,Ge+128);Pa(Ye,64),Je=Ye.read_shift(2),ot=ld(Ye,0,Je-ke),te.push(ot);var it={name:ot,type:Ye.read_shift(1),color:Ye.read_shift(1),L:Ye.read_shift(4,"i"),R:Ye.read_shift(4,"i"),C:Ye.read_shift(4,"i"),clsid:Ye.read_shift(16),state:Ye.read_shift(4,"i"),start:0,size:0},bt=Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2);bt!==0&&(it.ct=T(Ye,Ye.l-8));var zt=Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2);zt!==0&&(it.mt=T(Ye,Ye.l-8)),it.start=Ye.read_shift(4,"i"),it.size=Ye.read_shift(4,"i"),it.size<0&&it.start<0&&(it.size=it.type=0,it.start=z,it.name=""),it.type===5?(je=it.start,ae>0&&je!==z&&(se[je].name="!StreamData")):it.size>=4096?(it.storage="fat",se[it.start]===void 0&&(se[it.start]=b(Q,it.start,se.fat_addrs,se.ssz)),se[it.start].name=it.name,it.content=se[it.start].data.slice(0,it.size)):(it.storage="minifat",it.size<0?it.size=0:je!==z&&it.start!==z&&se[je]&&(it.content=v(it,se[je].data,(se[Le]||{}).data))),it.content&&Pa(it.content,0),ie[ot]=it,Se.push(it)}}function T(q,se){return new Date((Ia(q,se+4)/1e7*Math.pow(2,32)+Ia(q,se)/1e7-11644473600)*1e3)}function O(q,se){return f(),u(d.readFileSync(q),se)}function B(q,se){var Q=se&&se.type;switch(Q||Ht&&Buffer.isBuffer(q)&&(Q="buffer"),Q||"base64"){case"file":return O(q,se);case"base64":return u(fn($n(q)),se);case"binary":return u(fn(q),se)}return u(q,se)}function L(q,se){var Q=se||{},te=Q.root||"Root Entry";if(q.FullPaths||(q.FullPaths=[]),q.FileIndex||(q.FileIndex=[]),q.FullPaths.length!==q.FileIndex.length)throw new Error("inconsistent CFB structure");q.FullPaths.length===0&&(q.FullPaths[0]=te+"/",q.FileIndex[0]={name:te,type:5}),Q.CLSID&&(q.FileIndex[0].clsid=Q.CLSID),E(q)}function E(q){var se="Sh33tJ5";if(!Zt.find(q,"/"+se)){var Q=Oe(4);Q[0]=55,Q[1]=Q[3]=50,Q[2]=54,q.FileIndex.push({name:se,type:2,content:Q,size:4,L:69,R:69,C:69}),q.FullPaths.push(q.FullPaths[0]+se),P(q)}}function P(q,se){L(q);for(var Q=!1,te=!1,ae=q.FullPaths.length-1;ae>=0;--ae){var ie=q.FileIndex[ae];switch(ie.type){case 0:te?Q=!0:(q.FileIndex.pop(),q.FullPaths.pop());break;case 1:case 2:case 5:te=!0,isNaN(ie.R*ie.L*ie.C)&&(Q=!0),ie.R>-1&&ie.L>-1&&ie.R==ie.L&&(Q=!0);break;default:Q=!0;break}}if(!(!Q&&!se)){var Se=new Date(1987,1,19),Le=0,je=Object.create?Object.create(null):{},ke=[];for(ae=0;ae<q.FullPaths.length;++ae)je[q.FullPaths[ae]]=!0,q.FileIndex[ae].type!==0&&ke.push([q.FullPaths[ae],q.FileIndex[ae]]);for(ae=0;ae<ke.length;++ae){var Te=n(ke[ae][0]);te=je[Te],te||(ke.push([Te,{name:s(Te).replace("/",""),type:1,clsid:J,ct:Se,mt:Se,content:null}]),je[Te]=!0)}for(ke.sort(function(ot,Ye){return t(ot[0],Ye[0])}),q.FullPaths=[],q.FileIndex=[],ae=0;ae<ke.length;++ae)q.FullPaths[ae]=ke[ae][0],q.FileIndex[ae]=ke[ae][1];for(ae=0;ae<ke.length;++ae){var Ge=q.FileIndex[ae],Je=q.FullPaths[ae];if(Ge.name=s(Je).replace("/",""),Ge.L=Ge.R=Ge.C=-(Ge.color=1),Ge.size=Ge.content?Ge.content.length:0,Ge.start=0,Ge.clsid=Ge.clsid||J,ae===0)Ge.C=ke.length>1?1:-1,Ge.size=0,Ge.type=5;else if(Je.slice(-1)=="/"){for(Le=ae+1;Le<ke.length&&n(q.FullPaths[Le])!=Je;++Le);for(Ge.C=Le>=ke.length?-1:Le,Le=ae+1;Le<ke.length&&n(q.FullPaths[Le])!=n(Je);++Le);Ge.R=Le>=ke.length?-1:Le,Ge.type=1}else n(q.FullPaths[ae+1]||"")==n(Je)&&(Ge.R=ae+1),Ge.type=2}}}function D(q,se){var Q=se||{};if(Q.fileType=="mad")return mt(q,Q);switch(P(q),Q.fileType){case"zip":return Ja(q,Q)}var te=function(ot){for(var Ye=0,it=0,bt=0;bt<ot.FileIndex.length;++bt){var zt=ot.FileIndex[bt];if(zt.content){var Xt=zt.content.length;Xt>0&&(Xt<4096?Ye+=Xt+63>>6:it+=Xt+511>>9)}}for(var Sr=ot.FullPaths.length+3>>2,Za=Ye+7>>3,Pn=Ye+127>>7,yn=Za+it+Sr+Pn,Qa=yn+127>>7,bn=Qa<=109?0:Math.ceil((Qa-109)/127);yn+Qa+bn+127>>7>Qa;)bn=++Qa<=109?0:Math.ceil((Qa-109)/127);var ka=[1,bn,Qa,Pn,Sr,it,Ye,0];return ot.FileIndex[0].size=Ye<<6,ka[7]=(ot.FileIndex[0].start=ka[0]+ka[1]+ka[2]+ka[3]+ka[4]+ka[5])+(ka[6]+7>>3),ka}(q),ae=Oe(te[7]<<9),ie=0,Se=0;{for(ie=0;ie<8;++ie)ae.write_shift(1,de[ie]);for(ie=0;ie<8;++ie)ae.write_shift(2,0);for(ae.write_shift(2,62),ae.write_shift(2,3),ae.write_shift(2,65534),ae.write_shift(2,9),ae.write_shift(2,6),ie=0;ie<3;++ie)ae.write_shift(2,0);for(ae.write_shift(4,0),ae.write_shift(4,te[2]),ae.write_shift(4,te[0]+te[1]+te[2]+te[3]-1),ae.write_shift(4,0),ae.write_shift(4,4096),ae.write_shift(4,te[3]?te[0]+te[1]+te[2]-1:z),ae.write_shift(4,te[3]),ae.write_shift(-4,te[1]?te[0]-1:z),ae.write_shift(4,te[1]),ie=0;ie<109;++ie)ae.write_shift(-4,ie<te[2]?te[1]+ie:-1)}if(te[1])for(Se=0;Se<te[1];++Se){for(;ie<236+Se*127;++ie)ae.write_shift(-4,ie<te[2]?te[1]+ie:-1);ae.write_shift(-4,Se===te[1]-1?z:Se+1)}var Le=function(ot){for(Se+=ot;ie<Se-1;++ie)ae.write_shift(-4,ie+1);ot&&(++ie,ae.write_shift(-4,z))};for(Se=ie=0,Se+=te[1];ie<Se;++ie)ae.write_shift(-4,Z.DIFSECT);for(Se+=te[2];ie<Se;++ie)ae.write_shift(-4,Z.FATSECT);Le(te[3]),Le(te[4]);for(var je=0,ke=0,Te=q.FileIndex[0];je<q.FileIndex.length;++je)Te=q.FileIndex[je],Te.content&&(ke=Te.content.length,!(ke<4096)&&(Te.start=Se,Le(ke+511>>9)));for(Le(te[6]+7>>3);ae.l&511;)ae.write_shift(-4,Z.ENDOFCHAIN);for(Se=ie=0,je=0;je<q.FileIndex.length;++je)Te=q.FileIndex[je],Te.content&&(ke=Te.content.length,!(!ke||ke>=4096)&&(Te.start=Se,Le(ke+63>>6)));for(;ae.l&511;)ae.write_shift(-4,Z.ENDOFCHAIN);for(ie=0;ie<te[4]<<2;++ie){var Ge=q.FullPaths[ie];if(!Ge||Ge.length===0){for(je=0;je<17;++je)ae.write_shift(4,0);for(je=0;je<3;++je)ae.write_shift(4,-1);for(je=0;je<12;++je)ae.write_shift(4,0);continue}Te=q.FileIndex[ie],ie===0&&(Te.start=Te.size?Te.start-1:z);var Je=ie===0&&Q.root||Te.name;if(ke=2*(Je.length+1),ae.write_shift(64,Je,"utf16le"),ae.write_shift(2,ke),ae.write_shift(1,Te.type),ae.write_shift(1,Te.color),ae.write_shift(-4,Te.L),ae.write_shift(-4,Te.R),ae.write_shift(-4,Te.C),Te.clsid)ae.write_shift(16,Te.clsid,"hex");else for(je=0;je<4;++je)ae.write_shift(4,0);ae.write_shift(4,Te.state||0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,Te.start),ae.write_shift(4,Te.size),ae.write_shift(4,0)}for(ie=1;ie<q.FileIndex.length;++ie)if(Te=q.FileIndex[ie],Te.size>=4096)if(ae.l=Te.start+1<<9,Ht&&Buffer.isBuffer(Te.content))Te.content.copy(ae,ae.l,0,Te.size),ae.l+=Te.size+511&-512;else{for(je=0;je<Te.size;++je)ae.write_shift(1,Te.content[je]);for(;je&511;++je)ae.write_shift(1,0)}for(ie=1;ie<q.FileIndex.length;++ie)if(Te=q.FileIndex[ie],Te.size>0&&Te.size<4096)if(Ht&&Buffer.isBuffer(Te.content))Te.content.copy(ae,ae.l,0,Te.size),ae.l+=Te.size+63&-64;else{for(je=0;je<Te.size;++je)ae.write_shift(1,Te.content[je]);for(;je&63;++je)ae.write_shift(1,0)}if(Ht)ae.l=ae.length;else for(;ae.l<ae.length;)ae.write_shift(1,0);return ae}function k(q,se){var Q=q.FullPaths.map(function(je){return je.toUpperCase()}),te=Q.map(function(je){var ke=je.split("/");return ke[ke.length-(je.slice(-1)=="/"?2:1)]}),ae=!1;se.charCodeAt(0)===47?(ae=!0,se=Q[0].slice(0,-1)+se):ae=se.indexOf("/")!==-1;var ie=se.toUpperCase(),Se=ae===!0?Q.indexOf(ie):te.indexOf(ie);if(Se!==-1)return q.FileIndex[Se];var Le=!ie.match(ql);for(ie=ie.replace(Ao,""),Le&&(ie=ie.replace(ql,"!")),Se=0;Se<Q.length;++Se)if((Le?Q[Se].replace(ql,"!"):Q[Se]).replace(Ao,"")==ie||(Le?te[Se].replace(ql,"!"):te[Se]).replace(Ao,"")==ie)return q.FileIndex[Se];return null}var C=64,z=-2,G="d0cf11e0a1b11ae1",de=[208,207,17,224,161,177,26,225],J="00000000000000000000000000000000",Z={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:z,FREESECT:-1,HEADER_SIGNATURE:G,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:J,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function oe(q,se,Q){f();var te=D(q,Q);d.writeFileSync(se,te)}function ne(q){for(var se=new Array(q.length),Q=0;Q<q.length;++Q)se[Q]=String.fromCharCode(q[Q]);return se.join("")}function me(q,se){var Q=D(q,se);switch(se&&se.type||"buffer"){case"file":return f(),d.writeFileSync(se.filename,Q),Q;case"binary":return typeof Q=="string"?Q:ne(Q);case"base64":return Io(typeof Q=="string"?Q:ne(Q));case"buffer":if(Ht)return Buffer.isBuffer(Q)?Q:Kn(Q);case"array":return typeof Q=="string"?fn(Q):Q}return Q}var be;function A(q){try{var se=q.InflateRaw,Q=new se;if(Q._processChunk(new Uint8Array([3,0]),Q._finishFlushFlag),Q.bytesRead)be=q;else throw new Error("zlib does not expose bytesRead")}catch(te){console.error("cannot use native zlib: "+(te.message||te))}}function I(q,se){if(!be)return Dt(q,se);var Q=be.InflateRaw,te=new Q,ae=te._processChunk(q.slice(q.l),te._finishFlushFlag);return q.l+=te.bytesRead,ae}function R(q){return be?be.deflateRawSync(q):Ct(q)}var M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],he=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function fe(q){var se=(q<<1|q<<11)&139536|(q<<5|q<<15)&558144;return(se>>16|se>>8|se)&255}for(var ee=typeof Uint8Array<"u",ve=ee?new Uint8Array(256):[],Ce=0;Ce<256;++Ce)ve[Ce]=fe(Ce);function De(q,se){var Q=ve[q&255];return se<=8?Q>>>8-se:(Q=Q<<8|ve[q>>8&255],se<=16?Q>>>16-se:(Q=Q<<8|ve[q>>16&255],Q>>>24-se))}function $e(q,se){var Q=se&7,te=se>>>3;return(q[te]|(Q<=6?0:q[te+1]<<8))>>>Q&3}function Ke(q,se){var Q=se&7,te=se>>>3;return(q[te]|(Q<=5?0:q[te+1]<<8))>>>Q&7}function Ee(q,se){var Q=se&7,te=se>>>3;return(q[te]|(Q<=4?0:q[te+1]<<8))>>>Q&15}function le(q,se){var Q=se&7,te=se>>>3;return(q[te]|(Q<=3?0:q[te+1]<<8))>>>Q&31}function He(q,se){var Q=se&7,te=se>>>3;return(q[te]|(Q<=1?0:q[te+1]<<8))>>>Q&127}function et(q,se,Q){var te=se&7,ae=se>>>3,ie=(1<<Q)-1,Se=q[ae]>>>te;return Q<8-te||(Se|=q[ae+1]<<8-te,Q<16-te)||(Se|=q[ae+2]<<16-te,Q<24-te)||(Se|=q[ae+3]<<24-te),Se&ie}function qe(q,se,Q){var te=se&7,ae=se>>>3;return te<=5?q[ae]|=(Q&7)<<te:(q[ae]|=Q<<te&255,q[ae+1]=(Q&7)>>8-te),se+3}function Xe(q,se,Q){var te=se&7,ae=se>>>3;return Q=(Q&1)<<te,q[ae]|=Q,se+1}function tt(q,se,Q){var te=se&7,ae=se>>>3;return Q<<=te,q[ae]|=Q&255,Q>>>=8,q[ae+1]=Q,se+8}function at(q,se,Q){var te=se&7,ae=se>>>3;return Q<<=te,q[ae]|=Q&255,Q>>>=8,q[ae+1]=Q&255,q[ae+2]=Q>>>8,se+16}function ht(q,se){var Q=q.length,te=2*Q>se?2*Q:se+5,ae=0;if(Q>=se)return q;if(Ht){var ie=Ch(te);if(q.copy)q.copy(ie);else for(;ae<q.length;++ae)ie[ae]=q[ae];return ie}else if(ee){var Se=new Uint8Array(te);if(Se.set)Se.set(q);else for(;ae<Q;++ae)Se[ae]=q[ae];return Se}return q.length=te,q}function ft(q){for(var se=new Array(q),Q=0;Q<q;++Q)se[Q]=0;return se}function wt(q,se,Q){var te=1,ae=0,ie=0,Se=0,Le=0,je=q.length,ke=ee?new Uint16Array(32):ft(32);for(ie=0;ie<32;++ie)ke[ie]=0;for(ie=je;ie<Q;++ie)q[ie]=0;je=q.length;var Te=ee?new Uint16Array(je):ft(je);for(ie=0;ie<je;++ie)ke[ae=q[ie]]++,te<ae&&(te=ae),Te[ie]=0;for(ke[0]=0,ie=1;ie<=te;++ie)ke[ie+16]=Le=Le+ke[ie-1]<<1;for(ie=0;ie<je;++ie)Le=q[ie],Le!=0&&(Te[ie]=ke[Le+16]++);var Ge=0;for(ie=0;ie<je;++ie)if(Ge=q[ie],Ge!=0)for(Le=De(Te[ie],te)>>te-Ge,Se=(1<<te+4-Ge)-1;Se>=0;--Se)se[Le|Se<<Ge]=Ge&15|ie<<4;return te}var kt=ee?new Uint16Array(512):ft(512),Lt=ee?new Uint16Array(32):ft(32);if(!ee){for(var Ft=0;Ft<512;++Ft)kt[Ft]=0;for(Ft=0;Ft<32;++Ft)Lt[Ft]=0}(function(){for(var q=[],se=0;se<32;se++)q.push(5);wt(q,Lt,32);var Q=[];for(se=0;se<=143;se++)Q.push(8);for(;se<=255;se++)Q.push(9);for(;se<=279;se++)Q.push(7);for(;se<=287;se++)Q.push(8);wt(Q,kt,288)})();var vt=function(){for(var se=ee?new Uint8Array(32768):[],Q=0,te=0;Q<he.length-1;++Q)for(;te<he[Q+1];++te)se[te]=Q;for(;te<32768;++te)se[te]=29;var ae=ee?new Uint8Array(259):[];for(Q=0,te=0;Q<K.length-1;++Q)for(;te<K[Q+1];++te)ae[te]=Q;function ie(Le,je){for(var ke=0;ke<Le.length;){var Te=Math.min(65535,Le.length-ke),Ge=ke+Te==Le.length;for(je.write_shift(1,+Ge),je.write_shift(2,Te),je.write_shift(2,~Te&65535);Te-- >0;)je[je.l++]=Le[ke++]}return je.l}function Se(Le,je){for(var ke=0,Te=0,Ge=ee?new Uint16Array(32768):[];Te<Le.length;){var Je=Math.min(65535,Le.length-Te);if(Je<10){for(ke=qe(je,ke,+(Te+Je==Le.length)),ke&7&&(ke+=8-(ke&7)),je.l=ke/8|0,je.write_shift(2,Je),je.write_shift(2,~Je&65535);Je-- >0;)je[je.l++]=Le[Te++];ke=je.l*8;continue}ke=qe(je,ke,+(Te+Je==Le.length)+2);for(var ot=0;Je-- >0;){var Ye=Le[Te];ot=(ot<<5^Ye)&32767;var it=-1,bt=0;if((it=Ge[ot])&&(it|=Te&-32768,it>Te&&(it-=32768),it<Te))for(;Le[it+bt]==Le[Te+bt]&&bt<250;)++bt;if(bt>2){Ye=ae[bt],Ye<=22?ke=tt(je,ke,ve[Ye+1]>>1)-1:(tt(je,ke,3),ke+=5,tt(je,ke,ve[Ye-23]>>5),ke+=3);var zt=Ye<8?0:Ye-4>>2;zt>0&&(at(je,ke,bt-K[Ye]),ke+=zt),Ye=se[Te-it],ke=tt(je,ke,ve[Ye]>>3),ke-=3;var Xt=Ye<4?0:Ye-2>>1;Xt>0&&(at(je,ke,Te-it-he[Ye]),ke+=Xt);for(var Sr=0;Sr<bt;++Sr)Ge[ot]=Te&32767,ot=(ot<<5^Le[Te])&32767,++Te;Je-=bt-1}else Ye<=143?Ye=Ye+48:ke=Xe(je,ke,1),ke=tt(je,ke,ve[Ye]),Ge[ot]=Te&32767,++Te}ke=tt(je,ke,0)-1}return je.l=(ke+7)/8|0,je.l}return function(je,ke){return je.length<8?ie(je,ke):Se(je,ke)}}();function Ct(q){var se=Oe(50+Math.floor(q.length*1.1)),Q=vt(q,se);return se.slice(0,Q)}var st=ee?new Uint16Array(32768):ft(32768),Fr=ee?new Uint16Array(32768):ft(32768),Ot=ee?new Uint16Array(128):ft(128),ma=1,Wt=1;function ar(q,se){var Q=le(q,se)+257;se+=5;var te=le(q,se)+1;se+=5;var ae=Ee(q,se)+4;se+=4;for(var ie=0,Se=ee?new Uint8Array(19):ft(19),Le=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],je=1,ke=ee?new Uint8Array(8):ft(8),Te=ee?new Uint8Array(8):ft(8),Ge=Se.length,Je=0;Je<ae;++Je)Se[M[Je]]=ie=Ke(q,se),je<ie&&(je=ie),ke[ie]++,se+=3;var ot=0;for(ke[0]=0,Je=1;Je<=je;++Je)Te[Je]=ot=ot+ke[Je-1]<<1;for(Je=0;Je<Ge;++Je)(ot=Se[Je])!=0&&(Le[Je]=Te[ot]++);var Ye=0;for(Je=0;Je<Ge;++Je)if(Ye=Se[Je],Ye!=0){ot=ve[Le[Je]]>>8-Ye;for(var it=(1<<7-Ye)-1;it>=0;--it)Ot[ot|it<<Ye]=Ye&7|Je<<3}var bt=[];for(je=1;bt.length<Q+te;)switch(ot=Ot[He(q,se)],se+=ot&7,ot>>>=3){case 16:for(ie=3+$e(q,se),se+=2,ot=bt[bt.length-1];ie-- >0;)bt.push(ot);break;case 17:for(ie=3+Ke(q,se),se+=3;ie-- >0;)bt.push(0);break;case 18:for(ie=11+He(q,se),se+=7;ie-- >0;)bt.push(0);break;default:bt.push(ot),je<ot&&(je=ot);break}var zt=bt.slice(0,Q),Xt=bt.slice(Q);for(Je=Q;Je<286;++Je)zt[Je]=0;for(Je=te;Je<30;++Je)Xt[Je]=0;return ma=wt(zt,st,286),Wt=wt(Xt,Fr,30),se}function Ba(q,se){if(q[0]==3&&!(q[1]&3))return[zs(se),2];for(var Q=0,te=0,ae=Ch(se||1<<18),ie=0,Se=ae.length>>>0,Le=0,je=0;!(te&1);){if(te=Ke(q,Q),Q+=3,te>>>1)te>>1==1?(Le=9,je=5):(Q=ar(q,Q),Le=ma,je=Wt);else{Q&7&&(Q+=8-(Q&7));var ke=q[Q>>>3]|q[(Q>>>3)+1]<<8;if(Q+=32,ke>0)for(!se&&Se<ie+ke&&(ae=ht(ae,ie+ke),Se=ae.length);ke-- >0;)ae[ie++]=q[Q>>>3],Q+=8;continue}for(;;){!se&&Se<ie+32767&&(ae=ht(ae,ie+32767),Se=ae.length);var Te=et(q,Q,Le),Ge=te>>>1==1?kt[Te]:st[Te];if(Q+=Ge&15,Ge>>>=4,!(Ge>>>8&255))ae[ie++]=Ge;else{if(Ge==256)break;Ge-=257;var Je=Ge<8?0:Ge-4>>2;Je>5&&(Je=0);var ot=ie+K[Ge];Je>0&&(ot+=et(q,Q,Je),Q+=Je),Te=et(q,Q,je),Ge=te>>>1==1?Lt[Te]:Fr[Te],Q+=Ge&15,Ge>>>=4;var Ye=Ge<4?0:Ge-2>>1,it=he[Ge];for(Ye>0&&(it+=et(q,Q,Ye),Q+=Ye),!se&&Se<ot&&(ae=ht(ae,ot+100),Se=ae.length);ie<ot;)ae[ie]=ae[ie-it],++ie}}}return se?[ae,Q+7>>>3]:[ae.slice(0,ie),Q+7>>>3]}function Dt(q,se){var Q=q.slice(q.l||0),te=Ba(Q,se);return q.l+=te[1],te[0]}function vn(q,se){if(q)typeof console<"u"&&console.error(se);else throw new Error(se)}function ir(q,se){var Q=q;Pa(Q,0);var te=[],ae=[],ie={FileIndex:te,FullPaths:ae};L(ie,{root:se.root});for(var Se=Q.length-4;(Q[Se]!=80||Q[Se+1]!=75||Q[Se+2]!=5||Q[Se+3]!=6)&&Se>=0;)--Se;Q.l=Se+4,Q.l+=4;var Le=Q.read_shift(2);Q.l+=6;var je=Q.read_shift(4);for(Q.l=je,Se=0;Se<Le;++Se){Q.l+=20;var ke=Q.read_shift(4),Te=Q.read_shift(4),Ge=Q.read_shift(2),Je=Q.read_shift(2),ot=Q.read_shift(2);Q.l+=8;var Ye=Q.read_shift(4),it=c(Q.slice(Q.l+Ge,Q.l+Ge+Je));Q.l+=Ge+Je+ot;var bt=Q.l;Q.l=Ye+4,_a(Q,ke,Te,ie,it),Q.l=bt}return ie}function _a(q,se,Q,te,ae){q.l+=2;var ie=q.read_shift(2),Se=q.read_shift(2),Le=l(q);if(ie&8257)throw new Error("Unsupported ZIP encryption");for(var je=q.read_shift(4),ke=q.read_shift(4),Te=q.read_shift(4),Ge=q.read_shift(2),Je=q.read_shift(2),ot="",Ye=0;Ye<Ge;++Ye)ot+=String.fromCharCode(q[q.l++]);if(Je){var it=c(q.slice(q.l,q.l+Je));(it[21589]||{}).mt&&(Le=it[21589].mt),((ae||{})[21589]||{}).mt&&(Le=ae[21589].mt)}q.l+=Je;var bt=q.slice(q.l,q.l+ke);switch(Se){case 8:bt=I(q,Te);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Se)}var zt=!1;ie&8&&(je=q.read_shift(4),je==134695760&&(je=q.read_shift(4),zt=!0),ke=q.read_shift(4),Te=q.read_shift(4)),ke!=se&&vn(zt,"Bad compressed size: "+se+" != "+ke),Te!=Q&&vn(zt,"Bad uncompressed size: "+Q+" != "+Te),xa(te,ot,bt,{unsafe:!0,mt:Le})}function Ja(q,se){var Q=se||{},te=[],ae=[],ie=Oe(1),Se=Q.compression?8:0,Le=0,je=0,ke=0,Te=0,Ge=0,Je=q.FullPaths[0],ot=Je,Ye=q.FileIndex[0],it=[],bt=0;for(je=1;je<q.FullPaths.length;++je)if(ot=q.FullPaths[je].slice(Je.length),Ye=q.FileIndex[je],!(!Ye.size||!Ye.content||ot=="Sh33tJ5")){var zt=Te,Xt=Oe(ot.length);for(ke=0;ke<ot.length;++ke)Xt.write_shift(1,ot.charCodeAt(ke)&127);Xt=Xt.slice(0,Xt.l),it[Ge]=jg.buf(Ye.content,0);var Sr=Ye.content;Se==8&&(Sr=R(Sr)),ie=Oe(30),ie.write_shift(4,67324752),ie.write_shift(2,20),ie.write_shift(2,Le),ie.write_shift(2,Se),Ye.mt?o(ie,Ye.mt):ie.write_shift(4,0),ie.write_shift(-4,it[Ge]),ie.write_shift(4,Sr.length),ie.write_shift(4,Ye.content.length),ie.write_shift(2,Xt.length),ie.write_shift(2,0),Te+=ie.length,te.push(ie),Te+=Xt.length,te.push(Xt),Te+=Sr.length,te.push(Sr),ie=Oe(46),ie.write_shift(4,33639248),ie.write_shift(2,0),ie.write_shift(2,20),ie.write_shift(2,Le),ie.write_shift(2,Se),ie.write_shift(4,0),ie.write_shift(-4,it[Ge]),ie.write_shift(4,Sr.length),ie.write_shift(4,Ye.content.length),ie.write_shift(2,Xt.length),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(4,0),ie.write_shift(4,zt),bt+=ie.l,ae.push(ie),bt+=Xt.length,ae.push(Xt),++Ge}return ie=Oe(22),ie.write_shift(4,101010256),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(2,Ge),ie.write_shift(2,Ge),ie.write_shift(4,bt),ie.write_shift(4,Te),ie.write_shift(2,0),Yr([Yr(te),Yr(ae),ie])}var Qt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Nt(q,se){if(q.ctype)return q.ctype;var Q=q.name||"",te=Q.match(/\.([^\.]+)$/);return te&&Qt[te[1]]||se&&(te=(Q=se).match(/[\.\\]([^\.\\])+$/),te&&Qt[te[1]])?Qt[te[1]]:"application/octet-stream"}function Bt(q){for(var se=Io(q),Q=[],te=0;te<se.length;te+=76)Q.push(se.slice(te,te+76));return Q.join(`\r
`)+`\r
`}function Fn(q){var se=q.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ke){var Te=ke.charCodeAt(0).toString(16).toUpperCase();return"="+(Te.length==1?"0"+Te:Te)});se=se.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),se.charAt(0)==`
`&&(se="=0D"+se.slice(1)),se=se.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Q=[],te=se.split(`\r
`),ae=0;ae<te.length;++ae){var ie=te[ae];if(ie.length==0){Q.push("");continue}for(var Se=0;Se<ie.length;){var Le=76,je=ie.slice(Se,Se+Le);je.charAt(Le-1)=="="?Le--:je.charAt(Le-2)=="="?Le-=2:je.charAt(Le-3)=="="&&(Le-=3),je=ie.slice(Se,Se+Le),Se+=Le,Se<ie.length&&(je+="="),Q.push(je)}}return Q.join(`\r
`)}function Pr(q){for(var se=[],Q=0;Q<q.length;++Q){for(var te=q[Q];Q<=q.length&&te.charAt(te.length-1)=="=";)te=te.slice(0,te.length-1)+q[++Q];se.push(te)}for(var ae=0;ae<se.length;++ae)se[ae]=se[ae].replace(/[=][0-9A-Fa-f]{2}/g,function(ie){return String.fromCharCode(parseInt(ie.slice(1),16))});return fn(se.join(`\r
`))}function Ma(q,se,Q){for(var te="",ae="",ie="",Se,Le=0;Le<10;++Le){var je=se[Le];if(!je||je.match(/^\s*$/))break;var ke=je.match(/^(.*?):\s*([^\s].*)$/);if(ke)switch(ke[1].toLowerCase()){case"content-location":te=ke[2].trim();break;case"content-type":ie=ke[2].trim();break;case"content-transfer-encoding":ae=ke[2].trim();break}}switch(++Le,ae.toLowerCase()){case"base64":Se=fn($n(se.slice(Le).join("")));break;case"quoted-printable":Se=Pr(se.slice(Le));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ae)}var Te=xa(q,te.slice(Q.length),Se,{unsafe:!0});ie&&(Te.ctype=ie)}function Ua(q,se){if(ne(q.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Q=se&&se.root||"",te=(Ht&&Buffer.isBuffer(q)?q.toString("binary"):ne(q)).split(`\r
`),ae=0,ie="";for(ae=0;ae<te.length;++ae)if(ie=te[ae],!!/^Content-Location:/i.test(ie)&&(ie=ie.slice(ie.indexOf("file")),Q||(Q=ie.slice(0,ie.lastIndexOf("/")+1)),ie.slice(0,Q.length)!=Q))for(;Q.length>0&&(Q=Q.slice(0,Q.length-1),Q=Q.slice(0,Q.lastIndexOf("/")+1),ie.slice(0,Q.length)!=Q););var Se=(te[1]||"").match(/boundary="(.*?)"/);if(!Se)throw new Error("MAD cannot find boundary");var Le="--"+(Se[1]||""),je=[],ke=[],Te={FileIndex:je,FullPaths:ke};L(Te);var Ge,Je=0;for(ae=0;ae<te.length;++ae){var ot=te[ae];ot!==Le&&ot!==Le+"--"||(Je++&&Ma(Te,te.slice(Ge,ae),Q),Ge=ae)}return Te}function mt(q,se){var Q=se||{},te=Q.boundary||"SheetJS";te="------="+te;for(var ae=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+te.slice(2)+'"',"","",""],ie=q.FullPaths[0],Se=ie,Le=q.FileIndex[0],je=1;je<q.FullPaths.length;++je)if(Se=q.FullPaths[je].slice(ie.length),Le=q.FileIndex[je],!(!Le.size||!Le.content||Se=="Sh33tJ5")){Se=Se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(bt){return"_x"+bt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(bt){return"_u"+bt.charCodeAt(0).toString(16)+"_"});for(var ke=Le.content,Te=Ht&&Buffer.isBuffer(ke)?ke.toString("binary"):ne(ke),Ge=0,Je=Math.min(1024,Te.length),ot=0,Ye=0;Ye<=Je;++Ye)(ot=Te.charCodeAt(Ye))>=32&&ot<128&&++Ge;var it=Ge>=Je*4/5;ae.push(te),ae.push("Content-Location: "+(Q.root||"file:///C:/SheetJS/")+Se),ae.push("Content-Transfer-Encoding: "+(it?"quoted-printable":"base64")),ae.push("Content-Type: "+Nt(Le,Se)),ae.push(""),ae.push(it?Fn(Te):Bt(Te))}return ae.push(te+`--\r
`),ae.join(`\r
`)}function Aa(q){var se={};return L(se,q),se}function xa(q,se,Q,te){var ae=te&&te.unsafe;ae||L(q);var ie=!ae&&Zt.find(q,se);if(!ie){var Se=q.FullPaths[0];se.slice(0,Se.length)==Se?Se=se:(Se.slice(-1)!="/"&&(Se+="/"),Se=(Se+se).replace("//","/")),ie={name:s(se),type:2},q.FileIndex.push(ie),q.FullPaths.push(Se),ae||Zt.utils.cfb_gc(q)}return ie.content=Q,ie.size=Q?Q.length:0,te&&(te.CLSID&&(ie.clsid=te.CLSID),te.mt&&(ie.mt=te.mt),te.ct&&(ie.ct=te.ct)),ie}function Zr(q,se){L(q);var Q=Zt.find(q,se);if(Q){for(var te=0;te<q.FileIndex.length;++te)if(q.FileIndex[te]==Q)return q.FileIndex.splice(te,1),q.FullPaths.splice(te,1),!0}return!1}function gr(q,se,Q){L(q);var te=Zt.find(q,se);if(te){for(var ae=0;ae<q.FileIndex.length;++ae)if(q.FileIndex[ae]==te)return q.FileIndex[ae].name=s(Q),q.FullPaths[ae]=Q,!0}return!1}function dr(q){P(q,!0)}return r.find=k,r.read=B,r.parse=u,r.write=me,r.writeFile=oe,r.utils={cfb_new:Aa,cfb_add:xa,cfb_del:Zr,cfb_mov:gr,cfb_gc:dr,ReadShift:To,CheckField:bu,prep_blob:Pa,bconcat:Yr,use_zlib:A,_deflateRaw:Ct,_inflateRaw:Dt,consts:Z},r}();function Sg(e){return typeof e=="string"?yc(e):Array.isArray(e)?Xp(e):e}function Wo(e,r,t){if(typeof Deno<"u"){if(t&&typeof r=="string")switch(t){case"utf8":r=new TextEncoder(t).encode(r);break;case"binary":r=yc(r);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(e,r)}var n=t=="utf8"?Ro(r):r;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([Sg(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=o,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(e);return c.open("w"),c.encoding="binary",Array.isArray(r)&&(r=Ho(r)),c.write(r),c.close(),r}catch(d){if(!d.message||!d.message.match(/onstruct/))throw d}throw new Error("cannot save file "+e)}function Jr(e){for(var r=Object.keys(e),t=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(e,r[n])&&t.push(r[n]);return t}function Rh(e,r){for(var t=[],n=Jr(e),s=0;s!==n.length;++s)t[e[n[s]][r]]==null&&(t[e[n[s]][r]]=n[s]);return t}function nd(e){for(var r=[],t=Jr(e),n=0;n!==t.length;++n)r[e[t[n]]]=t[n];return r}function Nc(e){for(var r=[],t=Jr(e),n=0;n!==t.length;++n)r[e[t[n]]]=parseInt(t[n],10);return r}function _g(e){for(var r=[],t=Jr(e),n=0;n!==t.length;++n)r[e[t[n]]]==null&&(r[e[t[n]]]=[]),r[e[t[n]]].push(t[n]);return r}var ic=new Date(1899,11,30,0,0,0);function Na(e,r){var t=e.getTime(),n=ic.getTime()+(e.getTimezoneOffset()-ic.getTimezoneOffset())*6e4;return(t-n)/(24*60*60*1e3)}var au=new Date,Ag=ic.getTime()+(au.getTimezoneOffset()-ic.getTimezoneOffset())*6e4,Bh=au.getTimezoneOffset();function nu(e){var r=new Date;return r.setTime(e*24*60*60*1e3+Ag),r.getTimezoneOffset()!==Bh&&r.setTime(r.getTime()+(r.getTimezoneOffset()-Bh)*6e4),r}var Mh=new Date("2017-02-19T19:06:09.000Z"),su=isNaN(Mh.getFullYear())?new Date("2/19/17"):Mh,kg=su.getFullYear()==2017;function ua(e,r){var t=new Date(e);if(kg)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(su.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return e.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function jc(e,r){if(Ht&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var t={"â‚¬":"Â€","â€š":"Â‚",Æ’:"Âƒ","â€ž":"Â„","â€¦":"Â…","â€ ":"Â†","â€¡":"Â‡","Ë†":"Âˆ","â€°":"Â‰",Å :"ÂŠ","â€¹":"Â‹",Å’:"ÂŒ",Å½:"ÂŽ","â€˜":"Â‘","â€™":"Â’","â€œ":"Â“","â€":"Â”","â€¢":"Â•","â€“":"Â–","â€”":"Â—","Ëœ":"Â˜","â„¢":"Â™",Å¡:"Âš","â€º":"Â›",Å“:"Âœ",Å¾:"Âž",Å¸:"ÂŸ"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[â‚¬â€šÆ’â€žâ€¦â€ â€¡Ë†â€°Å â€¹Å’Å½â€˜â€™â€œâ€â€¢â€“â€”Ëœâ„¢Å¡â€ºÅ“Å¾Å¸]/g,function(o){return t[o]||o})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function ja(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=ja(e[t]));return r}function mr(e,r){for(var t="";t.length<r;)t+=e;return t}function Vn(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,o){return t=-t,o}),!isNaN(r=Number(n)))?r/t:r}var Tg=["january","february","march","april","may","june","july","august","september","october","november","december"];function Do(e){var r=new Date(e),t=new Date(NaN),n=r.getYear(),s=r.getMonth(),o=r.getDate();if(isNaN(o))return t;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&Tg.indexOf(l)==-1)return t}else if(l.match(/[a-z]/))return t;return n<0||n>8099?t:(s>0||o>1)&&n!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}function Et(e,r,t){if(e.FullPaths){if(typeof t=="string"){var n;return Ht?n=Kn(t):n=Jp(t),Zt.utils.cfb_add(e,r,n)}Zt.utils.cfb_add(e,r,t)}else e.file(r,t)}function sd(){return Zt.utils.cfb_new()}var Lr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Cg={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},id=nd(Cg),od=/[&<>'"]/g,Eg=/[\u0000-\u0008\u000b-\u001f]/g;function Yt(e){var r=e+"";return r.replace(od,function(t){return id[t]}).replace(Eg,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Uh(e){return Yt(e).replace(/ /g,"_x0020_")}var iu=/[\u0000-\u001f]/g;function Lg(e){var r=e+"";return r.replace(od,function(t){return id[t]}).replace(/\n/g,"<br/>").replace(iu,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function Fg(e){var r=e+"";return r.replace(od,function(t){return id[t]}).replace(iu,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function Pg(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Og(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function _0(e){for(var r="",t=0,n=0,s=0,o=0,l=0,c=0;t<e.length;){if(n=e.charCodeAt(t++),n<128){r+=String.fromCharCode(n);continue}if(s=e.charCodeAt(t++),n>191&&n<224){l=(n&31)<<6,l|=s&63,r+=String.fromCharCode(l);continue}if(o=e.charCodeAt(t++),n<240){r+=String.fromCharCode((n&15)<<12|(s&63)<<6|o&63);continue}l=e.charCodeAt(t++),c=((n&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536,r+=String.fromCharCode(55296+(c>>>10&1023)),r+=String.fromCharCode(56320+(c&1023))}return r}function Hh(e){var r=zs(2*e.length),t,n,s=1,o=0,l=0,c;for(n=0;n<e.length;n+=s)s=1,(c=e.charCodeAt(n))<128?t=c:c<224?(t=(c&31)*64+(e.charCodeAt(n+1)&63),s=2):c<240?(t=(c&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,t=(c&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),t-=65536,l=55296+(t>>>10&1023),t=56320+(t&1023)),l!==0&&(r[o++]=l&255,r[o++]=l>>>8,l=0),r[o++]=t%256,r[o++]=t>>>8;return r.slice(0,o).toString("ucs2")}function Wh(e){return Kn(e,"binary").toString("utf8")}var Gl="foo bar bazÃ¢Â˜ÂƒÃ°ÂŸÂÂ£",ko=Ht&&(Wh(Gl)==_0(Gl)&&Wh||Hh(Gl)==_0(Gl)&&Hh)||_0,Ro=Ht?function(e){return Kn(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,n=0,s=0;t<e.length;)switch(n=e.charCodeAt(t++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(t++)-56320+(n<<10),r.push(String.fromCharCode(240+(s>>18&7))),r.push(String.fromCharCode(144+(s>>12&63))),r.push(String.fromCharCode(128+(s>>6&63))),r.push(String.fromCharCode(128+(s&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},Ig=function(){var e=[["nbsp"," "],["middot","Â·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),ou=/(^\s|\s$|\n)/;function Kr(e,r){return"<"+e+(r.match(ou)?' xml:space="preserve"':"")+">"+r+"</"+e+">"}function Bo(e){return Jr(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function Ze(e,r,t){return"<"+e+(t!=null?Bo(t):"")+(r!=null?(r.match(ou)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function Y0(e,r){try{return e.toISOString().replace(/\.\d*/,"")}catch(t){if(r)throw t}return""}function Dg(e,r){switch(typeof e){case"string":var t=Ze("vt:lpwstr",Yt(e));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return Ze((e|0)==e?"vt:i4":"vt:r8",Yt(String(e)));case"boolean":return Ze("vt:bool",e?"true":"false")}if(e instanceof Date)return Ze("vt:filetime",Y0(e));throw new Error("Unable to serialize "+e)}var Hr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ri=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Oa={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Rg(e,r){for(var t=1-2*(e[r+7]>>>7),n=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),s=e[r+6]&15,o=5;o>=0;--o)s=s*256+e[r+o];return n==2047?s==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),t*Math.pow(2,n-52)*s)}function Bg(e,r,t){var n=(r<0||1/r==-1/0?1:0)<<7,s=0,o=0,l=n?-r:r;isFinite(l)?l==0?s=o=0:(s=Math.floor(Math.log(l)/Math.LN2),o=l*Math.pow(2,52-s),s<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?s=-1022:(o-=Math.pow(2,52),s+=1023)):(s=2047,o=isNaN(r)?26985:0);for(var c=0;c<=5;++c,o/=256)e[t+c]=o&255;e[t+6]=(s&15)<<4|o&15,e[t+7]=s>>4|n}var zh=function(e){for(var r=[],t=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,o=e[0][n].length;s<o;s+=t)r.push.apply(r,e[0][n].slice(s,s+t));return r},qh=Ht?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:Kn(r)})):zh(e)}:zh,Vh=function(e,r,t){for(var n=[],s=r;s<t;s+=2)n.push(String.fromCharCode(bo(e,s)));return n.join("").replace(Ao,"")},ld=Ht?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(Ao,""):Vh(e,r,t)}:Vh,Gh=function(e,r,t){for(var n=[],s=r;s<r+t;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},lu=Ht?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):Gh(e,r,t)}:Gh,$h=function(e,r,t){for(var n=[],s=r;s<t;s++)n.push(String.fromCharCode(Ci(e,s)));return n.join("")},zo=Ht?function(r,t,n){return Buffer.isBuffer(r)?r.toString("utf8",t,n):$h(r,t,n)}:$h,cu=function(e,r){var t=Ia(e,r);return t>0?zo(e,r+4,r+4+t-1):""},du=cu,hu=function(e,r){var t=Ia(e,r);return t>0?zo(e,r+4,r+4+t-1):""},fu=hu,uu=function(e,r){var t=2*Ia(e,r);return t>0?zo(e,r+4,r+4+t-1):""},mu=uu,xu=function(r,t){var n=Ia(r,t);return n>0?ld(r,t+4,t+4+n):""},pu=xu,gu=function(e,r){var t=Ia(e,r);return t>0?zo(e,r+4,r+4+t):""},vu=gu,yu=function(e,r){return Rg(e,r)},oc=yu,cd=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};Ht&&(du=function(r,t){if(!Buffer.isBuffer(r))return cu(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},fu=function(r,t){if(!Buffer.isBuffer(r))return hu(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},mu=function(r,t){if(!Buffer.isBuffer(r))return uu(r,t);var n=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n-1)},pu=function(r,t){if(!Buffer.isBuffer(r))return xu(r,t);var n=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n)},vu=function(r,t){if(!Buffer.isBuffer(r))return gu(r,t);var n=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+n)},oc=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):yu(r,t)},cd=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var Ci=function(e,r){return e[r]},bo=function(e,r){return e[r+1]*256+e[r]},Mg=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},Ia=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},Ds=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},Ug=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function To(e,r){var t="",n,s,o=[],l,c,d,f;switch(r){case"dbcs":if(f=this.l,Ht&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(d=0;d<e;++d)t+=String.fromCharCode(bo(this,f)),f+=2;e*=2;break;case"utf8":t=zo(this,this.l,this.l+e);break;case"utf16le":e*=2,t=ld(this,this.l,this.l+e);break;case"wstr":return To.call(this,e,"dbcs");case"lpstr-ansi":t=du(this,this.l),e=4+Ia(this,this.l);break;case"lpstr-cp":t=fu(this,this.l),e=4+Ia(this,this.l);break;case"lpwstr":t=mu(this,this.l),e=4+2*Ia(this,this.l);break;case"lpp4":e=4+Ia(this,this.l),t=pu(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Ia(this,this.l),t=vu(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(l=Ci(this,this.l+e++))!==0;)o.push(zl(l));t=o.join("");break;case"_wstr":for(e=0,t="";(l=bo(this,this.l+e))!==0;)o.push(zl(l)),e+=2;e+=2,t=o.join("");break;case"dbcs-cont":for(t="",f=this.l,d=0;d<e;++d){if(this.lens&&this.lens.indexOf(f)!==-1)return l=Ci(this,f),this.l=f+1,c=To.call(this,e-d,l?"dbcs-cont":"sbcs-cont"),o.join("")+c;o.push(zl(bo(this,f))),f+=2}t=o.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",f=this.l,d=0;d!=e;++d){if(this.lens&&this.lens.indexOf(f)!==-1)return l=Ci(this,f),this.l=f+1,c=To.call(this,e-d,l?"dbcs-cont":"sbcs-cont"),o.join("")+c;o.push(zl(Ci(this,f))),f+=1}t=o.join("");break;default:switch(e){case 1:return n=Ci(this,this.l),this.l++,n;case 2:return n=(r==="i"?Mg:bo)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||!(this[this.l+3]&128)?(n=(e>0?Ds:Ug)(this,this.l),this.l+=4,n):(s=Ia(this,this.l),this.l+=4,s);case 8:case-8:if(r==="f")return e==8?s=oc(this,this.l):s=oc([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:t=lu(this,this.l,e);break}}return this.l+=e,t}var Hg=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},Wg=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},zg=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function qg(e,r,t){var n=0,s=0;if(t==="dbcs"){for(s=0;s!=r.length;++s)zg(this,r.charCodeAt(s),this.l+2*s);n=2*r.length}else if(t==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=r.length;++s)this[this.l+s]=r.charCodeAt(s)&255;n=r.length}else if(t==="hex"){for(;s<e;++s)this[this.l++]=parseInt(r.slice(2*s,2*s+2),16)||0;return this}else if(t==="utf16le"){var o=Math.min(this.l+e,this.length);for(s=0;s<Math.min(r.length,e);++s){var l=r.charCodeAt(s);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,Hg(this,r,this.l);break;case 8:if(n=8,t==="f"){Bg(this,r,this.l);break}case 16:break;case-4:n=4,Wg(this,r,this.l);break}return this.l+=n,this}function bu(e,r){var t=lu(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function Pa(e,r){e.l=r,e.read_shift=To,e.chk=bu,e.write_shift=qg}function En(e,r){e.l+=r}function Oe(e){var r=zs(e);return Pa(r,0),r}function wa(){var e=[],r=Ht?256:2048,t=function(f){var u=Oe(f);return Pa(u,0),u},n=t(r),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},o=function(f){return n&&f<n.length-n.l?n:(s(),n=t(Math.max(f+1,r)))},l=function(){return s(),Yr(e)},c=function(f){s(),n=f,n.l==null&&(n.l=n.length),o(r)};return{next:o,push:c,end:l,_bufs:e}}function We(e,r,t,n){var s=+r,o;if(!isNaN(s)){n||(n=R4[s].p||(t||[]).length||0),o=1+(s>=128?1:0)+1,n>=128&&++o,n>=16384&&++o,n>=2097152&&++o;var l=e.next(o);s<=127?l.write_shift(1,s):(l.write_shift(1,(s&127)+128),l.write_shift(1,s>>7));for(var c=0;c!=4;++c)if(n>=128)l.write_shift(1,(n&127)+128),n>>=7;else{l.write_shift(1,n);break}n>0&&cd(t)&&e.push(t)}}function Co(e,r,t){var n=ja(e);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Yh(e,r,t){var n=ja(e);return n.s=Co(n.s,r.s,t),n.e=Co(n.e,r.s,t),n}function Eo(e,r){if(e.cRel&&e.c<0)for(e=ja(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=ja(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=Kt(e);return!e.cRel&&e.cRel!=null&&(t=$g(t)),!e.rRel&&e.rRel!=null&&(t=Vg(t)),t}function A0(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+ia(e.s.c)+":"+(e.e.cRel?"":"$")+ia(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Xr(e.s.r)+":"+(e.e.rRel?"":"$")+Xr(e.e.r):Eo(e.s,r.biff)+":"+Eo(e.e,r.biff)}function dd(e){return parseInt(Gg(e),10)-1}function Xr(e){return""+(e+1)}function Vg(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Gg(e){return e.replace(/\$(\d+)$/,"$1")}function hd(e){for(var r=Yg(e),t=0,n=0;n!==r.length;++n)t=26*t+r.charCodeAt(n)-64;return t-1}function ia(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function $g(e){return e.replace(/^([A-Z])/,"$$$1")}function Yg(e){return e.replace(/^\$([A-Z])/,"$1")}function Kg(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Wr(e){for(var r=0,t=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?r=10*r+(s-48):s>=65&&s<=90&&(t=26*t+(s-64))}return{c:t-1,r:r-1}}function Kt(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function Ra(e){var r=e.indexOf(":");return r==-1?{s:Wr(e),e:Wr(e)}:{s:Wr(e.slice(0,r)),e:Wr(e.slice(r+1))}}function Er(e,r){return typeof r>"u"||typeof r=="number"?Er(e.s,e.e):(typeof e!="string"&&(e=Kt(e)),typeof r!="string"&&(r=Kt(r)),e==r?e:e+":"+r)}function lr(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,s=0,o=e.length;for(t=0;n<o&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)t=26*t+s;for(r.s.c=--t,t=0;n<o&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)t=10*t+s;if(r.s.r=--t,n===o||s!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,t=0;n!=o&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)t=26*t+s;for(r.e.c=--t,t=0;n!=o&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)t=10*t+s;return r.e.r=--t,r}function Kh(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=ws(e.z,t?Na(r):r)}catch{}try{return e.w=ws((e.XF||{}).numFmtId||(t?14:0),t?Na(r):r)}catch{return""+r}}function Yn(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?qo[e.v]||e.v:r==null?Kh(e,e.v):Kh(e,r))}function $s(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",n={};return n[t]=e,{SheetNames:[t],Sheets:n}}function wu(e,r,t){var n=t||{},s=e?Array.isArray(e):n.dense,o=e||(s?[]:{}),l=0,c=0;if(o&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var d=typeof n.origin=="string"?Wr(n.origin):n.origin;l=d.r,c=d.c}o["!ref"]||(o["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var u=lr(o["!ref"]);f.s.c=u.s.c,f.s.r=u.s.r,f.e.c=Math.max(f.e.c,u.e.c),f.e.r=Math.max(f.e.r,u.e.r),l==-1&&(f.e.r=l=u.e.r+1)}for(var g=0;g!=r.length;++g)if(r[g]){if(!Array.isArray(r[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=r[g].length;++p)if(!(typeof r[g][p]>"u")){var m={v:r[g][p]},j=l+g,v=c+p;if(f.s.r>j&&(f.s.r=j),f.s.c>v&&(f.s.c=v),f.e.r<j&&(f.e.r=j),f.e.c<v&&(f.e.c=v),r[g][p]&&typeof r[g][p]=="object"&&!Array.isArray(r[g][p])&&!(r[g][p]instanceof Date))m=r[g][p];else if(Array.isArray(m.v)&&(m.f=r[g][p][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||pr[14],n.cellDates?(m.t="d",m.w=ws(m.z,Na(m.v))):(m.t="n",m.v=Na(m.v),m.w=ws(m.z,m.v))):m.t="s";if(s)o[j]||(o[j]=[]),o[j][v]&&o[j][v].z&&(m.z=o[j][v].z),o[j][v]=m;else{var N=Kt({c:v,r:j});o[N]&&o[N].z&&(m.z=o[N].z),o[N]=m}}}return f.s.c<1e7&&(o["!ref"]=Er(f)),o}function Bi(e,r){return wu(null,e,r)}function Xg(e){return e.read_shift(4,"i")}function mn(e,r){return r||(r=Oe(4)),r.write_shift(4,e),r}function oa(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function zr(e,r){var t=!1;return r==null&&(t=!0,r=Oe(4+2*e.length)),r.write_shift(4,e.length),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}function Jg(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Zg(e,r){return r||(r=Oe(4)),r.write_shift(2,0),r.write_shift(2,0),r}function fd(e,r){var t=e.l,n=e.read_shift(1),s=oa(e),o=[],l={t:s,h:s};if(n&1){for(var c=e.read_shift(4),d=0;d!=c;++d)o.push(Jg(e));l.r=o}else l.r=[{ich:0,ifnt:0}];return e.l=t+r,l}function Qg(e,r){var t=!1;return r==null&&(t=!0,r=Oe(15+4*e.t.length)),r.write_shift(1,0),zr(e.t,r),t?r.slice(0,r.l):r}var e2=fd;function t2(e,r){var t=!1;return r==null&&(t=!0,r=Oe(23+4*e.t.length)),r.write_shift(1,1),zr(e.t,r),r.write_shift(4,1),Zg({},r),t?r.slice(0,r.l):r}function Xa(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function Ys(e,r){return r==null&&(r=Oe(8)),r.write_shift(-4,e.c),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}function Ks(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}function Xs(e,r){return r==null&&(r=Oe(4)),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}var r2=oa,Nu=zr;function ud(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}function lc(e,r){var t=!1;return r==null&&(t=!0,r=Oe(127)),r.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}var a2=oa,K0=ud,md=lc;function ju(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,n=r[0]&2;e.l+=4;var s=n===0?oc([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):Ds(r,0)>>2;return t?s/100:s}function Su(e,r){r==null&&(r=Oe(4));var t=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,t=1),n)r.write_shift(-4,((t?s:e)<<2)+(t+2));else throw new Error("unsupported RkNumber "+e)}function _u(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}function n2(e,r){return r||(r=Oe(16)),r.write_shift(4,e.s.r),r.write_shift(4,e.e.r),r.write_shift(4,e.s.c),r.write_shift(4,e.e.c),r}var Js=_u,Mi=n2;function Ui(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function qs(e,r){return(r||Oe(8)).write_shift(8,e,"f")}function s2(e){var r={},t=e.read_shift(1),n=t>>>1,s=e.read_shift(1),o=e.read_shift(2,"i"),l=e.read_shift(1),c=e.read_shift(1),d=e.read_shift(1);switch(e.l++,n){case 0:r.auto=1;break;case 1:r.index=s;var f=m2[s];f&&(r.rgb=of(f));break;case 2:r.rgb=of([l,c,d]);break;case 3:r.theme=s;break}return o!=0&&(r.tint=o>0?o/32767:o/32768),r}function cc(e,r){if(r||(r=Oe(8)),!e||e.auto)return r.write_shift(4,0),r.write_shift(4,0),r;e.index!=null?(r.write_shift(1,2),r.write_shift(1,e.index)):e.theme!=null?(r.write_shift(1,6),r.write_shift(1,e.theme)):(r.write_shift(1,5),r.write_shift(1,0));var t=e.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),r.write_shift(2,t),!e.rgb||e.theme!=null)r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),r.write_shift(1,parseInt(n.slice(0,2),16)),r.write_shift(1,parseInt(n.slice(2,4),16)),r.write_shift(1,parseInt(n.slice(4,6),16)),r.write_shift(1,255)}return r}function i2(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function o2(e,r){r||(r=Oe(2));var t=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return r.write_shift(1,t),r.write_shift(1,0),r}var Au=2,Fa=3,$l=11,dc=19,Yl=64,l2=65,c2=71,d2=4108,h2=4126,$r=80,Xh={1:{n:"CodePage",t:Au},2:{n:"Category",t:$r},3:{n:"PresentationFormat",t:$r},4:{n:"ByteCount",t:Fa},5:{n:"LineCount",t:Fa},6:{n:"ParagraphCount",t:Fa},7:{n:"SlideCount",t:Fa},8:{n:"NoteCount",t:Fa},9:{n:"HiddenCount",t:Fa},10:{n:"MultimediaClipCount",t:Fa},11:{n:"ScaleCrop",t:$l},12:{n:"HeadingPairs",t:d2},13:{n:"TitlesOfParts",t:h2},14:{n:"Manager",t:$r},15:{n:"Company",t:$r},16:{n:"LinksUpToDate",t:$l},17:{n:"CharacterCount",t:Fa},19:{n:"SharedDoc",t:$l},22:{n:"HyperlinksChanged",t:$l},23:{n:"AppVersion",t:Fa,p:"version"},24:{n:"DigSig",t:l2},26:{n:"ContentType",t:$r},27:{n:"ContentStatus",t:$r},28:{n:"Language",t:$r},29:{n:"Version",t:$r},255:{},2147483648:{n:"Locale",t:dc},2147483651:{n:"Behavior",t:dc},1919054434:{}},Jh={1:{n:"CodePage",t:Au},2:{n:"Title",t:$r},3:{n:"Subject",t:$r},4:{n:"Author",t:$r},5:{n:"Keywords",t:$r},6:{n:"Comments",t:$r},7:{n:"Template",t:$r},8:{n:"LastAuthor",t:$r},9:{n:"RevNumber",t:$r},10:{n:"EditTime",t:Yl},11:{n:"LastPrinted",t:Yl},12:{n:"CreatedDate",t:Yl},13:{n:"ModifiedDate",t:Yl},14:{n:"PageCount",t:Fa},15:{n:"WordCount",t:Fa},16:{n:"CharCount",t:Fa},17:{n:"Thumbnail",t:c2},18:{n:"Application",t:$r},19:{n:"DocSecurity",t:Fa},255:{},2147483648:{n:"Locale",t:dc},2147483651:{n:"Behavior",t:dc},1919054434:{}};function f2(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var u2=f2([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),m2=ja(u2),qo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},x2={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Kl={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function ku(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Tu(e,r){var t=_g(x2),n=[],s;n[n.length]=Lr,n[n.length]=Ze("Types",null,{xmlns:Hr.CT,"xmlns:xsd":Hr.xsd,"xmlns:xsi":Hr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(d){return Ze("Default",null,{Extension:d[0],ContentType:d[1]})}));var o=function(d){e[d]&&e[d].length>0&&(s=e[d][0],n[n.length]=Ze("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Kl[d][r.bookType]||Kl[d].xlsx}))},l=function(d){(e[d]||[]).forEach(function(f){n[n.length]=Ze("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:Kl[d][r.bookType]||Kl[d].xlsx})})},c=function(d){(e[d]||[]).forEach(function(f){n[n.length]=Ze("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:t[d][0]})})};return o("workbooks"),l("sheets"),l("charts"),c("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),l("metadata"),c("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Mt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Cu(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function Fi(e){var r=[Lr,Ze("Relationships",null,{xmlns:Hr.RELS})];return Jr(e["!id"]).forEach(function(t){r[r.length]=Ze("Relationship",null,e["!id"][t])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function $t(e,r,t,n,s,o){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),r<0)for(r=e["!idx"];e["!id"]["rId"+r];++r);if(e["!idx"]=r+1,s.Id="rId"+r,s.Type=n,s.Target=t,[Mt.HLINK,Mt.XPATH,Mt.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+r);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,r}function p2(e){var r=[Lr];r.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),r.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<e.length;++t)r.push('  <manifest:file-entry manifest:full-path="'+e[t][0]+'" manifest:media-type="'+e[t][1]+`"/>
`);return r.push("</manifest:manifest>"),r.join("")}function Zh(e,r,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+r+`"/>
`,`  </rdf:Description>
`].join("")}function g2(e,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+`"/>
`,`  </rdf:Description>
`].join("")}function v2(e){var r=[Lr];r.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=e.length;++t)r.push(Zh(e[t][0],e[t][1])),r.push(g2("",e[t][0]));return r.push(Zh("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}function Eu(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+tc.version+"</meta:generator></office:meta></office:document-meta>"}var Ws=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function k0(e,r,t,n,s){s[e]!=null||r==null||r===""||(s[e]=r,r=Yt(r),n[n.length]=t?Ze(e,r,t):Kr(e,r))}function Lu(e,r){var t=r||{},n=[Lr,Ze("cp:coreProperties",null,{"xmlns:cp":Hr.CORE_PROPS,"xmlns:dc":Hr.dc,"xmlns:dcterms":Hr.dcterms,"xmlns:dcmitype":Hr.dcmitype,"xmlns:xsi":Hr.xsi})],s={};if(!e&&!t.Props)return n.join("");e&&(e.CreatedDate!=null&&k0("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Y0(e.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&k0("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Y0(e.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var o=0;o!=Ws.length;++o){var l=Ws[o],c=t.Props&&t.Props[l[1]]!=null?t.Props[l[1]]:e?e[l[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&k0(l[0],c,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Pi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Fu=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Pu(e){var r=[],t=Ze;return e||(e={}),e.Application="SheetJS",r[r.length]=Lr,r[r.length]=Ze("Properties",null,{xmlns:Hr.EXT_PROPS,"xmlns:vt":Hr.vt}),Pi.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=Yt(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(r[r.length]=t(n[0],s))}}),r[r.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=t("TitlesOfParts",t("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Yt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}function Ou(e){var r=[Lr,Ze("Properties",null,{xmlns:Hr.CUST_PROPS,"xmlns:vt":Hr.vt})];if(!e)return r.join("");var t=1;return Jr(e).forEach(function(s){++t,r[r.length]=Ze("property",Dg(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Yt(s)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var Qh={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function y2(e,r){var t=[];return Jr(Qh).map(function(n){for(var s=0;s<Ws.length;++s)if(Ws[s][1]==n)return Ws[s];for(s=0;s<Pi.length;++s)if(Pi[s][1]==n)return Pi[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=r&&r.Props&&r.Props[n[1]]!=null?r.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),t.push(Kr(Qh[n[1]]||n[1],s))}}),Ze("DocumentProperties",t.join(""),{xmlns:Oa.o})}function b2(e,r){var t=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&Jr(e).forEach(function(o){if(Object.prototype.hasOwnProperty.call(e,o)){for(var l=0;l<Ws.length;++l)if(o==Ws[l][1])return;for(l=0;l<Pi.length;++l)if(o==Pi[l][1])return;for(l=0;l<t.length;++l)if(o==t[l])return;var c=e[o],d="string";typeof c=="number"?(d="float",c=String(c)):c===!0||c===!1?(d="boolean",c=c?"1":"0"):c=String(c),s.push(Ze(Uh(o),c,{"dt:dt":d}))}}),r&&Jr(r).forEach(function(o){if(Object.prototype.hasOwnProperty.call(r,o)&&!(e&&Object.prototype.hasOwnProperty.call(e,o))){var l=r[o],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l instanceof Date?(c="dateTime.tz",l=l.toISOString()):l=String(l),s.push(Ze(Uh(o),l,{"dt:dt":c}))}}),"<"+n+' xmlns="'+Oa.o+'">'+s.join("")+"</"+n+">"}function w2(e){var r=typeof e=="string"?new Date(Date.parse(e)):e,t=r.getTime()/1e3+11644473600,n=t%Math.pow(2,32),s=(t-n)/Math.pow(2,32);n*=1e7,s*=1e7;var o=n/Math.pow(2,32)|0;o>0&&(n=n%Math.pow(2,32),s+=o);var l=Oe(8);return l.write_shift(4,n),l.write_shift(4,s),l}function ef(e,r){var t=Oe(4),n=Oe(4);switch(t.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,r);break;case 5:n=Oe(8),n.write_shift(8,r,"f");break;case 11:n.write_shift(4,r?1:0);break;case 64:n=w2(r);break;case 31:case 80:for(n=Oe(4+2*(r.length+1)+(r.length%2?0:2)),n.write_shift(4,r.length+1),n.write_shift(0,r,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}return Yr([t,n])}var Iu=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function N2(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function tf(e,r,t){var n=Oe(8),s=[],o=[],l=8,c=0,d=Oe(8),f=Oe(8);if(d.write_shift(4,2),d.write_shift(4,1200),f.write_shift(4,1),o.push(d),s.push(f),l+=8+d.length,!r){f=Oe(8),f.write_shift(4,0),s.unshift(f);var u=[Oe(4)];for(u[0].write_shift(4,e.length),c=0;c<e.length;++c){var g=e[c][0];for(d=Oe(8+2*(g.length+1)+(g.length%2?0:2)),d.write_shift(4,c+2),d.write_shift(4,g.length+1),d.write_shift(0,g,"dbcs");d.l!=d.length;)d.write_shift(1,0);u.push(d)}d=Yr(u),o.unshift(d),l+=8+d.length}for(c=0;c<e.length;++c)if(!(r&&!r[e[c][0]])&&!(Iu.indexOf(e[c][0])>-1||Fu.indexOf(e[c][0])>-1)&&e[c][1]!=null){var p=e[c][1],m=0;if(r){m=+r[e[c][0]];var j=t[m];if(j.p=="version"&&typeof p=="string"){var v=p.split(".");p=(+v[0]<<16)+(+v[1]||0)}d=ef(j.t,p)}else{var N=N2(p);N==-1&&(N=31,p=String(p)),d=ef(N,p)}o.push(d),f=Oe(8),f.write_shift(4,r?m:2+c),s.push(f),l+=8+d.length}var b=8*(o.length+1);for(c=0;c<o.length;++c)s[c].write_shift(4,b),b+=o[c].length;return n.write_shift(4,l),n.write_shift(4,o.length),Yr([n].concat(s).concat(o))}function rf(e,r,t,n,s,o){var l=Oe(s?68:48),c=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,Zt.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,s?2:1),l.write_shift(16,r,"hex"),l.write_shift(4,s?68:48);var d=tf(e,t,n);if(c.push(d),s){var f=tf(s,null,null);l.write_shift(16,o,"hex"),l.write_shift(4,68+d.length),c.push(f)}return Yr(c)}function j2(e,r){r||(r=Oe(e));for(var t=0;t<e;++t)r.write_shift(1,0);return r}function S2(e,r){return e.read_shift(r)===1}function fa(e,r){return r||(r=Oe(2)),r.write_shift(2,+!!e),r}function Du(e){return e.read_shift(2,"u")}function Ka(e,r){return r||(r=Oe(2)),r.write_shift(2,e),r}function Ru(e,r,t){return t||(t=Oe(2)),t.write_shift(1,r=="e"?+e:+!!e),t.write_shift(1,r=="e"?1:0),t}function Bu(e,r,t){var n=e.read_shift(t&&t.biff>=12?2:1),s="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var o=e.read_shift(1);o&&(s="dbcs-cont")}else t.biff==12&&(s="wstr");t.biff>=2&&t.biff<=5&&(s="cpstr");var l=n?e.read_shift(n,s):"";return l}function _2(e){var r=e.t||"",t=Oe(3);t.write_shift(2,r.length),t.write_shift(1,1);var n=Oe(2*r.length);n.write_shift(2*r.length,r,"utf16le");var s=[t,n];return Yr(s)}function A2(e,r,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(r,"sbcs-cont"):n=e.read_shift(r,"dbcs-cont"),n}function k2(e,r,t){var n=e.read_shift(t&&t.biff==2?1:2);return n===0?(e.l++,""):A2(e,n,t)}function T2(e,r,t){if(t.biff>5)return k2(e,r,t);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Mu(e,r,t){return t||(t=Oe(3+2*e.length)),t.write_shift(2,e.length),t.write_shift(1,1),t.write_shift(31,e,"utf16le"),t}function af(e,r){r||(r=Oe(6+e.length*2)),r.write_shift(4,1+e.length);for(var t=0;t<e.length;++t)r.write_shift(2,e.charCodeAt(t));return r.write_shift(2,0),r}function C2(e){var r=Oe(512),t=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),o=s>-1?31:23;switch(n.charAt(0)){case"#":o=28;break;case".":o&=-3;break}r.write_shift(4,2),r.write_shift(4,o);var l=[8,6815827,6619237,4849780,83];for(t=0;t<l.length;++t)r.write_shift(4,l[t]);if(o==28)n=n.slice(1),af(n,r);else if(o&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<l.length;++t)r.write_shift(1,parseInt(l[t],16));var c=s>-1?n.slice(0,s):n;for(r.write_shift(4,2*(c.length+1)),t=0;t<c.length;++t)r.write_shift(2,c.charCodeAt(t));r.write_shift(2,0),o&8&&af(s>-1?n.slice(s+1):"",r)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<l.length;++t)r.write_shift(1,parseInt(l[t],16));for(var d=0;n.slice(d*3,d*3+3)=="../"||n.slice(d*3,d*3+3)=="..\\";)++d;for(r.write_shift(2,d),r.write_shift(4,n.length-3*d+1),t=0;t<n.length-3*d;++t)r.write_shift(1,n.charCodeAt(t+3*d)&255);for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),t=0;t<6;++t)r.write_shift(4,0)}return r.slice(0,r.l)}function Vs(e,r,t,n){return n||(n=Oe(6)),n.write_shift(2,e),n.write_shift(2,r),n.write_shift(2,t||0),n}function E2(e,r,t){var n=t.biff>8?4:2,s=e.read_shift(n),o=e.read_shift(n,"i"),l=e.read_shift(n,"i");return[s,o,l]}function L2(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r},e:{c:s,r:t}}}function Uu(e,r){return r||(r=Oe(8)),r.write_shift(2,e.s.r),r.write_shift(2,e.e.r),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c),r}function xd(e,r,t){var n=1536,s=16;switch(t.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var o=Oe(s);return o.write_shift(2,n),o.write_shift(2,r),s>4&&o.write_shift(2,29282),s>6&&o.write_shift(2,1997),s>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function F2(e,r){var t=!r||r.biff==8,n=Oe(t?112:54);for(n.write_shift(r.biff==8?2:1,7),t&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(t?0:536870912));n.l<n.length;)n.write_shift(1,t?0:32);return n}function P2(e,r){var t=!r||r.biff>=8?2:1,n=Oe(8+t*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),r.biff>=8&&n.write_shift(1,1),n.write_shift(t*e.name.length,e.name,r.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function O2(e,r){var t=Oe(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=_2(e[s]);var o=Yr([t].concat(n));return o.parts=[t.length].concat(n.map(function(l){return l.length})),o}function I2(){var e=Oe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function D2(e){var r=Oe(18),t=1718;return e&&e.RTL&&(t|=64),r.write_shift(2,t),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}function R2(e,r){var t=e.name||"Arial",n=r&&r.biff==5,s=n?15+t.length:16+2*t.length,o=Oe(s);return o.write_shift(2,e.sz*20),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,t.length),n||o.write_shift(1,1),o.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le"),o}function B2(e,r,t,n){var s=Oe(10);return Vs(e,r,n,s),s.write_shift(4,t),s}function M2(e,r,t,n,s){var o=!s||s.biff==8,l=Oe(8+ +o+(1+o)*t.length);return Vs(e,r,n,l),l.write_shift(2,t.length),o&&l.write_shift(1,1),l.write_shift((1+o)*t.length,t,o?"utf16le":"sbcs"),l}function U2(e,r,t,n){var s=t&&t.biff==5;n||(n=Oe(s?3+r.length:5+2*r.length)),n.write_shift(2,e),n.write_shift(s?1:2,r.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*r.length,r,s?"sbcs":"utf16le");var o=n.length>n.l?n.slice(0,n.l):n;return o.l==null&&(o.l=o.length),o}function H2(e,r){var t=r.biff==8||!r.biff?4:2,n=Oe(2*t+6);return n.write_shift(t,e.s.r),n.write_shift(t,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function nf(e,r,t,n){var s=t&&t.biff==5;n||(n=Oe(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,r<<4));var o=0;return e.numFmtId>0&&s&&(o|=1024),n.write_shift(4,o),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function W2(e){var r=Oe(8);return r.write_shift(4,0),r.write_shift(2,0),r.write_shift(2,0),r}function z2(e,r,t,n,s,o){var l=Oe(8);return Vs(e,r,n,l),Ru(t,o,l),l}function q2(e,r,t,n){var s=Oe(14);return Vs(e,r,n,s),qs(t,s),s}function V2(e,r,t){if(t.biff<8)return G2(e,r,t);for(var n=[],s=e.l+r,o=e.read_shift(t.biff>8?4:2);o--!==0;)n.push(E2(e,t.biff>8?12:6,t));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function G2(e,r,t){e[e.l+1]==3&&e[e.l]++;var n=Bu(e,r,t);return n.charCodeAt(0)==3?n.slice(1):n}function $2(e){var r=Oe(2+e.length*8);r.write_shift(2,e.length);for(var t=0;t<e.length;++t)Uu(e[t],r);return r}function Y2(e){var r=Oe(24),t=Wr(e[0]);r.write_shift(2,t.r),r.write_shift(2,t.r),r.write_shift(2,t.c),r.write_shift(2,t.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)r.write_shift(1,parseInt(n[s],16));return Yr([r,C2(e[1])])}function K2(e){var r=e[1].Tooltip,t=Oe(10+2*(r.length+1));t.write_shift(2,2048);var n=Wr(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var s=0;s<r.length;++s)t.write_shift(2,r.charCodeAt(s));return t.write_shift(2,0),t}function X2(e){return e||(e=Oe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function J2(e,r,t){if(!t.cellStyles)return En(e,r);var n=t&&t.biff>=12?4:2,s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(n),d=e.read_shift(2);n==2&&(e.l+=2);var f={s,e:o,w:l,ixfe:c,flags:d};return(t.biff>=5||!t.biff)&&(f.level=d>>8&7),f}function Z2(e,r){var t=Oe(12);t.write_shift(2,r),t.write_shift(2,r),t.write_shift(2,e.width*256),t.write_shift(2,0);var n=0;return e.hidden&&(n|=1),t.write_shift(1,n),n=e.level||0,t.write_shift(1,n),t.write_shift(2,0),t}function Q2(e){for(var r=Oe(2*e),t=0;t<e;++t)r.write_shift(2,t+1);return r}function ev(e,r,t){var n=Oe(15);return Go(n,e,r),n.write_shift(8,t,"f"),n}function tv(e,r,t){var n=Oe(9);return Go(n,e,r),n.write_shift(2,t),n}var rv=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=nd({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(c,d){var f=[],u=zs(1);switch(d.type){case"base64":u=fn($n(c));break;case"binary":u=fn(c);break;case"buffer":case"array":u=c;break}Pa(u,0);var g=u.read_shift(1),p=!!(g&136),m=!1,j=!1;switch(g){case 2:break;case 3:break;case 48:m=!0,p=!0;break;case 49:m=!0,p=!0;break;case 131:break;case 139:break;case 140:j=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var v=0,N=521;g==2&&(v=u.read_shift(2)),u.l+=3,g!=2&&(v=u.read_shift(4)),v>1048576&&(v=1e6),g!=2&&(N=u.read_shift(2));var b=u.read_shift(2),y=d.codepage||1252;g!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(y=e[u[u.l]]),u.l+=1,u.l+=2),j&&(u.l+=36);for(var _=[],T={},O=Math.min(u.length,g==2?521:N-10-(m?264:0)),B=j?32:11;u.l<O&&u[u.l]!=13;)switch(T={},T.name=rc.utils.decode(y,u.slice(u.l,u.l+B)).replace(/[\u0000\r\n].*$/g,""),u.l+=B,T.type=String.fromCharCode(u.read_shift(1)),g!=2&&!j&&(T.offset=u.read_shift(4)),T.len=u.read_shift(1),g==2&&(T.offset=u.read_shift(2)),T.dec=u.read_shift(1),T.name.length&&_.push(T),g!=2&&(u.l+=j?13:14),T.type){case"B":(!m||T.len!=8)&&d.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+T.type)}if(u[u.l]!==13&&(u.l=N-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=N;var L=0,E=0;for(f[0]=[],E=0;E!=_.length;++E)f[0][E]=_[E].name;for(;v-- >0;){if(u[u.l]===42){u.l+=b;continue}for(++u.l,f[++L]=[],E=0,E=0;E!=_.length;++E){var P=u.slice(u.l,u.l+_[E].len);u.l+=_[E].len,Pa(P,0);var D=rc.utils.decode(y,P);switch(_[E].type){case"C":D.trim().length&&(f[L][E]=D.replace(/\s+$/,""));break;case"D":D.length===8?f[L][E]=new Date(+D.slice(0,4),+D.slice(4,6)-1,+D.slice(6,8)):f[L][E]=D;break;case"F":f[L][E]=parseFloat(D.trim());break;case"+":case"I":f[L][E]=j?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(D.trim().toUpperCase()){case"Y":case"T":f[L][E]=!0;break;case"N":case"F":f[L][E]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+D+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));f[L][E]="##MEMO##"+(j?parseInt(D.trim(),10):P.read_shift(4));break;case"N":D=D.replace(/\u0000/g,"").trim(),D&&D!="."&&(f[L][E]=+D||0);break;case"@":f[L][E]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":f[L][E]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":f[L][E]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[L][E]=-P.read_shift(-8,"f");break;case"B":if(m&&_[E].len==8){f[L][E]=P.read_shift(8,"f");break}case"G":case"P":P.l+=_[E].len;break;case"0":if(_[E].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[E].type)}}}if(g!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return d&&d.sheetRows&&(f=f.slice(0,d.sheetRows)),d.DBF=_,f}function n(c,d){var f=d||{};f.dateNF||(f.dateNF="yyyymmdd");var u=Bi(t(c,f),f);return u["!cols"]=f.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete f.DBF,u}function s(c,d){try{return $s(n(c,d),d)}catch(f){if(d&&d.WTF)throw f}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function l(c,d){var f=d||{};if(+f.codepage>=0&&Oo(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var u=wa(),g=xc(c,{header:1,raw:!0,cellDates:!0}),p=g[0],m=g.slice(1),j=c["!cols"]||[],v=0,N=0,b=0,y=1;for(v=0;v<p.length;++v){if(((j[v]||{}).DBF||{}).name){p[v]=j[v].DBF.name,++b;continue}if(p[v]!=null){if(++b,typeof p[v]=="number"&&(p[v]=p[v].toString(10)),typeof p[v]!="string")throw new Error("DBF Invalid column name "+p[v]+" |"+typeof p[v]+"|");if(p.indexOf(p[v])!==v){for(N=0;N<1024;++N)if(p.indexOf(p[v]+"_"+N)==-1){p[v]+="_"+N;break}}}}var _=lr(c["!ref"]),T=[],O=[],B=[];for(v=0;v<=_.e.c-_.s.c;++v){var L="",E="",P=0,D=[];for(N=0;N<m.length;++N)m[N][v]!=null&&D.push(m[N][v]);if(D.length==0||p[v]==null){T[v]="?";continue}for(N=0;N<D.length;++N){switch(typeof D[N]){case"number":E="B";break;case"string":E="C";break;case"boolean":E="L";break;case"object":E=D[N]instanceof Date?"D":"C";break;default:E="C"}P=Math.max(P,String(D[N]).length),L=L&&L!=E?"C":E}P>250&&(P=250),E=((j[v]||{}).DBF||{}).type,E=="C"&&j[v].DBF.len>P&&(P=j[v].DBF.len),L=="B"&&E=="N"&&(L="N",B[v]=j[v].DBF.dec,P=j[v].DBF.len),O[v]=L=="C"||E=="N"?P:o[L]||0,y+=O[v],T[v]=L}var k=u.next(32);for(k.write_shift(4,318902576),k.write_shift(4,m.length),k.write_shift(2,296+32*b),k.write_shift(2,y),v=0;v<4;++v)k.write_shift(4,0);for(k.write_shift(4,0|(+r[Wf]||3)<<8),v=0,N=0;v<p.length;++v)if(p[v]!=null){var C=u.next(32),z=(p[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);C.write_shift(1,z,"sbcs"),C.write_shift(1,T[v]=="?"?"C":T[v],"sbcs"),C.write_shift(4,N),C.write_shift(1,O[v]||o[T[v]]||0),C.write_shift(1,B[v]||0),C.write_shift(1,2),C.write_shift(4,0),C.write_shift(1,0),C.write_shift(4,0),C.write_shift(4,0),N+=O[v]||o[T[v]]||0}var G=u.next(264);for(G.write_shift(4,13),v=0;v<65;++v)G.write_shift(4,0);for(v=0;v<m.length;++v){var de=u.next(y);for(de.write_shift(1,0),N=0;N<p.length;++N)if(p[N]!=null)switch(T[N]){case"L":de.write_shift(1,m[v][N]==null?63:m[v][N]?84:70);break;case"B":de.write_shift(8,m[v][N]||0,"f");break;case"N":var J="0";for(typeof m[v][N]=="number"&&(J=m[v][N].toFixed(B[N]||0)),b=0;b<O[N]-J.length;++b)de.write_shift(1,32);de.write_shift(1,J,"sbcs");break;case"D":m[v][N]?(de.write_shift(4,("0000"+m[v][N].getFullYear()).slice(-4),"sbcs"),de.write_shift(2,("00"+(m[v][N].getMonth()+1)).slice(-2),"sbcs"),de.write_shift(2,("00"+m[v][N].getDate()).slice(-2),"sbcs")):de.write_shift(8,"00000000","sbcs");break;case"C":var Z=String(m[v][N]!=null?m[v][N]:"").slice(0,O[N]);for(de.write_shift(1,Z,"sbcs"),b=0;b<O[N]-Z.length;++b)de.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:n,from_sheet:l}}(),av=function(){var e={AA:"Ã€",BA:"Ã",CA:"Ã‚",DA:195,HA:"Ã„",JA:197,AE:"Ãˆ",BE:"Ã‰",CE:"ÃŠ",HE:"Ã‹",AI:"ÃŒ",BI:"Ã",CI:"ÃŽ",HI:"Ã",AO:"Ã’",BO:"Ã“",CO:"Ã”",DO:213,HO:"Ã–",AU:"Ã™",BU:"Ãš",CU:"Ã›",HU:"Ãœ",Aa:"Ã ",Ba:"Ã¡",Ca:"Ã¢",Da:227,Ha:"Ã¤",Ja:229,Ae:"Ã¨",Be:"Ã©",Ce:"Ãª",He:"Ã«",Ai:"Ã¬",Bi:"Ã­",Ci:"Ã®",Hi:"Ã¯",Ao:"Ã²",Bo:"Ã³",Co:"Ã´",Do:245,Ho:"Ã¶",Au:"Ã¹",Bu:"Ãº",Cu:"Ã»",Hu:"Ã¼",KC:"Ã‡",Kc:"Ã§",q:"Ã¦",z:"Å“",a:"Ã†",j:"Å’",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+Jr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(p,m){var j=e[m];return typeof j=="number"?Th(j):j},n=function(p,m,j){var v=m.charCodeAt(0)-32<<4|j.charCodeAt(0)-48;return v==59?p:Th(v)};e["|"]=254;function s(p,m){switch(m.type){case"base64":return o($n(p),m);case"binary":return o(p,m);case"buffer":return o(Ht&&Buffer.isBuffer(p)?p.toString("binary"):Ho(p),m);case"array":return o(jc(p),m)}throw new Error("Unrecognized type "+m.type)}function o(p,m){var j=p.split(/[\n\r]+/),v=-1,N=-1,b=0,y=0,_=[],T=[],O=null,B={},L=[],E=[],P=[],D=0,k;for(+m.codepage>=0&&Oo(+m.codepage);b!==j.length;++b){D=0;var C=j[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,t),z=C.replace(/;;/g,"\0").split(";").map(function(M){return M.replace(/\u0000/g,";")}),G=z[0],de;if(C.length>0)switch(G){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":z[1].charAt(0)=="P"&&T.push(C.slice(3).replace(/;;/g,";"));break;case"C":var J=!1,Z=!1,oe=!1,ne=!1,me=-1,be=-1;for(y=1;y<z.length;++y)switch(z[y].charAt(0)){case"A":break;case"X":N=parseInt(z[y].slice(1))-1,Z=!0;break;case"Y":for(v=parseInt(z[y].slice(1))-1,Z||(N=0),k=_.length;k<=v;++k)_[k]=[];break;case"K":de=z[y].slice(1),de.charAt(0)==='"'?de=de.slice(1,de.length-1):de==="TRUE"?de=!0:de==="FALSE"?de=!1:isNaN(Vn(de))?isNaN(Do(de).getDate())||(de=ua(de)):(de=Vn(de),O!==null&&eu(O)&&(de=nu(de))),J=!0;break;case"E":ne=!0;var A=t5(z[y].slice(1),{r:v,c:N});_[v][N]=[_[v][N],A];break;case"S":oe=!0,_[v][N]=[_[v][N],"S5S"];break;case"G":break;case"R":me=parseInt(z[y].slice(1))-1;break;case"C":be=parseInt(z[y].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+C)}if(J&&(_[v][N]&&_[v][N].length==2?_[v][N][0]=de:_[v][N]=de,O=null),oe){if(ne)throw new Error("SYLK shared formula cannot have own formula");var I=me>-1&&_[me][be];if(!I||!I[1])throw new Error("SYLK shared formula cannot find base");_[v][N][1]=r5(I[1],{r:v-me,c:N-be})}break;case"F":var R=0;for(y=1;y<z.length;++y)switch(z[y].charAt(0)){case"X":N=parseInt(z[y].slice(1))-1,++R;break;case"Y":for(v=parseInt(z[y].slice(1))-1,k=_.length;k<=v;++k)_[k]=[];break;case"M":D=parseInt(z[y].slice(1))/20;break;case"F":break;case"G":break;case"P":O=T[parseInt(z[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=z[y].slice(1).split(" "),k=parseInt(P[0],10);k<=parseInt(P[1],10);++k)D=parseInt(P[2],10),E[k-1]=D===0?{hidden:!0}:{wch:D},pd(E[k-1]);break;case"C":N=parseInt(z[y].slice(1))-1,E[N]||(E[N]={});break;case"R":v=parseInt(z[y].slice(1))-1,L[v]||(L[v]={}),D>0?(L[v].hpt=D,L[v].hpx=Vu(D)):D===0&&(L[v].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+C)}R<1&&(O=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+C)}}return L.length>0&&(B["!rows"]=L),E.length>0&&(B["!cols"]=E),m&&m.sheetRows&&(_=_.slice(0,m.sheetRows)),[_,B]}function l(p,m){var j=s(p,m),v=j[0],N=j[1],b=Bi(v,m);return Jr(N).forEach(function(y){b[y]=N[y]}),b}function c(p,m){return $s(l(p,m),m)}function d(p,m,j,v){var N="C;Y"+(j+1)+";X"+(v+1)+";K";switch(p.t){case"n":N+=p.v||0,p.f&&!p.F&&(N+=";E"+vd(p.f,{r:j,c:v}));break;case"b":N+=p.v?"TRUE":"FALSE";break;case"e":N+=p.w||p.v;break;case"d":N+='"'+(p.w||p.v)+'"';break;case"s":N+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return N}function f(p,m){m.forEach(function(j,v){var N="F;W"+(v+1)+" "+(v+1)+" ";j.hidden?N+="0":(typeof j.width=="number"&&!j.wpx&&(j.wpx=hc(j.width)),typeof j.wpx=="number"&&!j.wch&&(j.wch=fc(j.wpx)),typeof j.wch=="number"&&(N+=Math.round(j.wch))),N.charAt(N.length-1)!=" "&&p.push(N)})}function u(p,m){m.forEach(function(j,v){var N="F;";j.hidden?N+="M0;":j.hpt?N+="M"+20*j.hpt+";":j.hpx&&(N+="M"+20*uc(j.hpx)+";"),N.length>2&&p.push(N+"R"+(v+1))})}function g(p,m){var j=["ID;PWXL;N;E"],v=[],N=lr(p["!ref"]),b,y=Array.isArray(p),_=`\r
`;j.push("P;PGeneral"),j.push("F;P0;DG0G8;M255"),p["!cols"]&&f(j,p["!cols"]),p["!rows"]&&u(j,p["!rows"]),j.push("B;Y"+(N.e.r-N.s.r+1)+";X"+(N.e.c-N.s.c+1)+";D"+[N.s.c,N.s.r,N.e.c,N.e.r].join(" "));for(var T=N.s.r;T<=N.e.r;++T)for(var O=N.s.c;O<=N.e.c;++O){var B=Kt({r:T,c:O});b=y?(p[T]||[])[O]:p[B],!(!b||b.v==null&&(!b.f||b.F))&&v.push(d(b,p,T,O))}return j.join(_)+_+v.join(_)+_+"E"+_}return{to_workbook:c,to_sheet:l,from_sheet:g}}(),nv=function(){function e(o,l){switch(l.type){case"base64":return r($n(o),l);case"binary":return r(o,l);case"buffer":return r(Ht&&Buffer.isBuffer(o)?o.toString("binary"):Ho(o),l);case"array":return r(jc(o),l)}throw new Error("Unrecognized type "+l.type)}function r(o,l){for(var c=o.split(`
`),d=-1,f=-1,u=0,g=[];u!==c.length;++u){if(c[u].trim()==="BOT"){g[++d]=[],f=0;continue}if(!(d<0)){var p=c[u].trim().split(","),m=p[0],j=p[1];++u;for(var v=c[u]||"";(v.match(/["]/g)||[]).length&1&&u<c.length-1;)v+=`
`+c[++u];switch(v=v.trim(),+m){case-1:if(v==="BOT"){g[++d]=[],f=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?g[d][f]=!0:v==="FALSE"?g[d][f]=!1:isNaN(Vn(j))?isNaN(Do(j).getDate())?g[d][f]=j:g[d][f]=ua(j):g[d][f]=Vn(j),++f;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),g[d][f++]=v!==""?v:null;break}if(v==="EOD")break}}return l&&l.sheetRows&&(g=g.slice(0,l.sheetRows)),g}function t(o,l){return Bi(e(o,l),l)}function n(o,l){return $s(t(o,l),l)}var s=function(){var o=function(d,f,u,g,p){d.push(f),d.push(u+","+g),d.push('"'+p.replace(/"/g,'""')+'"')},l=function(d,f,u,g){d.push(f+","+u),d.push(f==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(d){var f=[],u=lr(d["!ref"]),g,p=Array.isArray(d);o(f,"TABLE",0,1,"sheetjs"),o(f,"VECTORS",0,u.e.r-u.s.r+1,""),o(f,"TUPLES",0,u.e.c-u.s.c+1,""),o(f,"DATA",0,0,"");for(var m=u.s.r;m<=u.e.r;++m){l(f,-1,0,"BOT");for(var j=u.s.c;j<=u.e.c;++j){var v=Kt({r:m,c:j});if(g=p?(d[m]||[])[j]:d[v],!g){l(f,1,0,"");continue}switch(g.t){case"n":var N=g.w;!N&&g.v!=null&&(N=g.v),N==null?g.f&&!g.F?l(f,1,0,"="+g.f):l(f,1,0,""):l(f,0,N,"V");break;case"b":l(f,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":l(f,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=ws(g.z||pr[14],Na(ua(g.v)))),l(f,0,g.w,"V");break;default:l(f,1,0,"")}}}l(f,-1,0,"EOD");var b=`\r
`,y=f.join(b);return y}}();return{to_workbook:n,to_sheet:t,from_sheet:s}}(),Hu=function(){function e(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(g,p){for(var m=g.split(`
`),j=-1,v=-1,N=0,b=[];N!==m.length;++N){var y=m[N].trim().split(":");if(y[0]==="cell"){var _=Wr(y[1]);if(b.length<=_.r)for(j=b.length;j<=_.r;++j)b[j]||(b[j]=[]);switch(j=_.r,v=_.c,y[2]){case"t":b[j][v]=e(y[3]);break;case"v":b[j][v]=+y[3];break;case"vtf":var T=y[y.length-1];case"vtc":switch(y[3]){case"nl":b[j][v]=!!+y[4];break;default:b[j][v]=+y[4];break}y[2]=="vtf"&&(b[j][v]=[b[j][v],T])}}}return p&&p.sheetRows&&(b=b.slice(0,p.sheetRows)),b}function n(g,p){return Bi(t(g,p),p)}function s(g,p){return $s(n(g,p),p)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function f(g){if(!g||!g["!ref"])return"";for(var p=[],m=[],j,v="",N=Ra(g["!ref"]),b=Array.isArray(g),y=N.s.r;y<=N.e.r;++y)for(var _=N.s.c;_<=N.e.c;++_)if(v=Kt({r:y,c:_}),j=b?(g[y]||[])[_]:g[v],!(!j||j.v==null||j.t==="z")){switch(m=["cell",v,"t"],j.t){case"s":case"str":m.push(r(j.v));break;case"n":j.f?(m[2]="vtf",m[3]="n",m[4]=j.v,m[5]=r(j.f)):(m[2]="v",m[3]=j.v);break;case"b":m[2]="vt"+(j.f?"f":"c"),m[3]="nl",m[4]=j.v?"1":"0",m[5]=r(j.f||(j.v?"TRUE":"FALSE"));break;case"d":var T=Na(ua(j.v));m[2]="vtc",m[3]="nd",m[4]=""+T,m[5]=j.w||ws(j.z||pr[14],T);break;case"e":continue}p.push(m.join(":"))}return p.push("sheet:c:"+(N.e.c-N.s.c+1)+":r:"+(N.e.r-N.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function u(g){return[o,l,c,l,f(g),d].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:u}}(),sv=function(){function e(u,g,p,m,j){j.raw?g[p][m]=u:u===""||(u==="TRUE"?g[p][m]=!0:u==="FALSE"?g[p][m]=!1:isNaN(Vn(u))?isNaN(Do(u).getDate())?g[p][m]=u:g[p][m]=ua(u):g[p][m]=Vn(u))}function r(u,g){var p=g||{},m=[];if(!u||u.length===0)return m;for(var j=u.split(/[\r\n]/),v=j.length-1;v>=0&&j[v].length===0;)--v;for(var N=10,b=0,y=0;y<=v;++y)b=j[y].indexOf(" "),b==-1?b=j[y].length:b++,N=Math.max(N,b);for(y=0;y<=v;++y){m[y]=[];var _=0;for(e(j[y].slice(0,N).trim(),m,y,_,p),_=1;_<=(j[y].length-N)/10+1;++_)e(j[y].slice(N+(_-1)*10,N+_*10).trim(),m,y,_,p)}return p.sheetRows&&(m=m.slice(0,p.sheetRows)),m}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(u){for(var g={},p=!1,m=0,j=0;m<u.length;++m)(j=u.charCodeAt(m))==34?p=!p:!p&&j in t&&(g[j]=(g[j]||0)+1);j=[];for(m in g)Object.prototype.hasOwnProperty.call(g,m)&&j.push([g[m],m]);if(!j.length){g=n;for(m in g)Object.prototype.hasOwnProperty.call(g,m)&&j.push([g[m],m])}return j.sort(function(v,N){return v[0]-N[0]||n[v[1]]-n[N[1]]}),t[j.pop()[1]]||44}function o(u,g){var p=g||{},m="",j=p.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(m=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(m=u.charAt(4),u=u.slice(6)):m=s(u.slice(0,1024)):p&&p.FS?m=p.FS:m=s(u.slice(0,1024));var N=0,b=0,y=0,_=0,T=0,O=m.charCodeAt(0),B=!1,L=0,E=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var P=p.dateNF!=null?wg(p.dateNF):null;function D(){var k=u.slice(_,T),C={};if(k.charAt(0)=='"'&&k.charAt(k.length-1)=='"'&&(k=k.slice(1,-1).replace(/""/g,'"')),k.length===0)C.t="z";else if(p.raw)C.t="s",C.v=k;else if(k.trim().length===0)C.t="s",C.v=k;else if(k.charCodeAt(0)==61)k.charCodeAt(1)==34&&k.charCodeAt(k.length-1)==34?(C.t="s",C.v=k.slice(2,-1).replace(/""/g,'"')):a5(k)?(C.t="n",C.f=k.slice(1)):(C.t="s",C.v=k);else if(k=="TRUE")C.t="b",C.v=!0;else if(k=="FALSE")C.t="b",C.v=!1;else if(!isNaN(y=Vn(k)))C.t="n",p.cellText!==!1&&(C.w=k),C.v=y;else if(!isNaN(Do(k).getDate())||P&&k.match(P)){C.z=p.dateNF||pr[14];var z=0;P&&k.match(P)&&(k=Ng(k,p.dateNF,k.match(P)||[]),z=1),p.cellDates?(C.t="d",C.v=ua(k,z)):(C.t="n",C.v=Na(ua(k,z))),p.cellText!==!1&&(C.w=ws(C.z,C.v instanceof Date?Na(C.v):C.v)),p.cellNF||delete C.z}else C.t="s",C.v=k;if(C.t=="z"||(p.dense?(j[N]||(j[N]=[]),j[N][b]=C):j[Kt({c:b,r:N})]=C),_=T+1,E=u.charCodeAt(_),v.e.c<b&&(v.e.c=b),v.e.r<N&&(v.e.r=N),L==O)++b;else if(b=0,++N,p.sheetRows&&p.sheetRows<=N)return!0}e:for(;T<u.length;++T)switch(L=u.charCodeAt(T)){case 34:E===34&&(B=!B);break;case O:case 10:case 13:if(!B&&D())break e;break}return T-_>0&&D(),j["!ref"]=Er(v),j}function l(u,g){return!(g&&g.PRN)||g.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?o(u,g):Bi(r(u,g),g)}function c(u,g){var p="",m=g.type=="string"?[0,0,0,0]:gw(u,g);switch(g.type){case"base64":p=$n(u);break;case"binary":p=u;break;case"buffer":g.codepage==65001?p=u.toString("utf8"):g.codepage&&typeof rc<"u"||(p=Ht&&Buffer.isBuffer(u)?u.toString("binary"):Ho(u));break;case"array":p=jc(u);break;case"string":p=u;break;default:throw new Error("Unrecognized type "+g.type)}return m[0]==239&&m[1]==187&&m[2]==191?p=ko(p.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?p=ko(p):g.type=="binary"&&typeof rc<"u",p.slice(0,19)=="socialcalc:version:"?Hu.to_sheet(g.type=="string"?p:ko(p),g):l(p,g)}function d(u,g){return $s(c(u,g),g)}function f(u){for(var g=[],p=lr(u["!ref"]),m,j=Array.isArray(u),v=p.s.r;v<=p.e.r;++v){for(var N=[],b=p.s.c;b<=p.e.c;++b){var y=Kt({r:v,c:b});if(m=j?(u[v]||[])[b]:u[y],!m||m.v==null){N.push("          ");continue}for(var _=(m.w||(Yn(m),m.w)||"").slice(0,10);_.length<10;)_+=" ";N.push(_+(b===0?" ":""))}g.push(N.join(""))}return g.join(`
`)}return{to_workbook:d,to_sheet:c,from_sheet:f}}(),sf=function(){function e(A,I,R){if(A){Pa(A,A.l||0);for(var M=R.Enum||me;A.l<A.length;){var K=A.read_shift(2),he=M[K]||M[65535],fe=A.read_shift(2),ee=A.l+fe,ve=he.f&&he.f(A,fe,R);if(A.l=ee,I(ve,he,K))return}}}function r(A,I){switch(I.type){case"base64":return t(fn($n(A)),I);case"binary":return t(fn(A),I);case"buffer":case"array":return t(A,I)}throw"Unsupported type "+I.type}function t(A,I){if(!A)return A;var R=I||{},M=R.dense?[]:{},K="Sheet1",he="",fe=0,ee={},ve=[],Ce=[],De={s:{r:0,c:0},e:{r:0,c:0}},$e=R.sheetRows||0;if(A[2]==0&&(A[3]==8||A[3]==9)&&A.length>=16&&A[14]==5&&A[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(A[2]==2)R.Enum=me,e(A,function(He,et,qe){switch(qe){case 0:R.vers=He,He>=4096&&(R.qpro=!0);break;case 6:De=He;break;case 204:He&&(he=He);break;case 222:he=He;break;case 15:case 51:R.qpro||(He[1].v=He[1].v.slice(1));case 13:case 14:case 16:qe==14&&(He[2]&112)==112&&(He[2]&15)>1&&(He[2]&15)<15&&(He[1].z=R.dateNF||pr[14],R.cellDates&&(He[1].t="d",He[1].v=nu(He[1].v))),R.qpro&&He[3]>fe&&(M["!ref"]=Er(De),ee[K]=M,ve.push(K),M=R.dense?[]:{},De={s:{r:0,c:0},e:{r:0,c:0}},fe=He[3],K=he||"Sheet"+(fe+1),he="");var Xe=R.dense?(M[He[0].r]||[])[He[0].c]:M[Kt(He[0])];if(Xe){Xe.t=He[1].t,Xe.v=He[1].v,He[1].z!=null&&(Xe.z=He[1].z),He[1].f!=null&&(Xe.f=He[1].f);break}R.dense?(M[He[0].r]||(M[He[0].r]=[]),M[He[0].r][He[0].c]=He[1]):M[Kt(He[0])]=He[1];break}},R);else if(A[2]==26||A[2]==14)R.Enum=be,A[2]==14&&(R.qpro=!0,A.l=0),e(A,function(He,et,qe){switch(qe){case 204:K=He;break;case 22:He[1].v=He[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(He[3]>fe&&(M["!ref"]=Er(De),ee[K]=M,ve.push(K),M=R.dense?[]:{},De={s:{r:0,c:0},e:{r:0,c:0}},fe=He[3],K="Sheet"+(fe+1)),$e>0&&He[0].r>=$e)break;R.dense?(M[He[0].r]||(M[He[0].r]=[]),M[He[0].r][He[0].c]=He[1]):M[Kt(He[0])]=He[1],De.e.c<He[0].c&&(De.e.c=He[0].c),De.e.r<He[0].r&&(De.e.r=He[0].r);break;case 27:He[14e3]&&(Ce[He[14e3][0]]=He[14e3][1]);break;case 1537:Ce[He[0]]=He[1],He[0]==fe&&(K=He[1]);break}},R);else throw new Error("Unrecognized LOTUS BOF "+A[2]);if(M["!ref"]=Er(De),ee[he||K]=M,ve.push(he||K),!Ce.length)return{SheetNames:ve,Sheets:ee};for(var Ke={},Ee=[],le=0;le<Ce.length;++le)ee[ve[le]]?(Ee.push(Ce[le]||ve[le]),Ke[Ce[le]]=ee[Ce[le]]||ee[ve[le]]):(Ee.push(Ce[le]),Ke[Ce[le]]={"!ref":"A1"});return{SheetNames:Ee,Sheets:Ke}}function n(A,I){var R=I||{};if(+R.codepage>=0&&Oo(+R.codepage),R.type=="string")throw new Error("Cannot write WK1 to JS string");var M=wa(),K=lr(A["!ref"]),he=Array.isArray(A),fe=[];Qe(M,0,o(1030)),Qe(M,6,d(K));for(var ee=Math.min(K.e.r,8191),ve=K.s.r;ve<=ee;++ve)for(var Ce=Xr(ve),De=K.s.c;De<=K.e.c;++De){ve===K.s.r&&(fe[De]=ia(De));var $e=fe[De]+Ce,Ke=he?(A[ve]||[])[De]:A[$e];if(!(!Ke||Ke.t=="z"))if(Ke.t=="n")(Ke.v|0)==Ke.v&&Ke.v>=-32768&&Ke.v<=32767?Qe(M,13,m(ve,De,Ke.v)):Qe(M,14,v(ve,De,Ke.v));else{var Ee=Yn(Ke);Qe(M,15,g(ve,De,Ee.slice(0,239)))}}return Qe(M,1),M.end()}function s(A,I){var R=I||{};if(+R.codepage>=0&&Oo(+R.codepage),R.type=="string")throw new Error("Cannot write WK3 to JS string");var M=wa();Qe(M,0,l(A));for(var K=0,he=0;K<A.SheetNames.length;++K)(A.Sheets[A.SheetNames[K]]||{})["!ref"]&&Qe(M,27,ne(A.SheetNames[K],he++));var fe=0;for(K=0;K<A.SheetNames.length;++K){var ee=A.Sheets[A.SheetNames[K]];if(!(!ee||!ee["!ref"])){for(var ve=lr(ee["!ref"]),Ce=Array.isArray(ee),De=[],$e=Math.min(ve.e.r,8191),Ke=ve.s.r;Ke<=$e;++Ke)for(var Ee=Xr(Ke),le=ve.s.c;le<=ve.e.c;++le){Ke===ve.s.r&&(De[le]=ia(le));var He=De[le]+Ee,et=Ce?(ee[Ke]||[])[le]:ee[He];if(!(!et||et.t=="z"))if(et.t=="n")Qe(M,23,D(Ke,le,fe,et.v));else{var qe=Yn(et);Qe(M,22,L(Ke,le,fe,qe.slice(0,239)))}}++fe}}return Qe(M,1),M.end()}function o(A){var I=Oe(2);return I.write_shift(2,A),I}function l(A){var I=Oe(26);I.write_shift(2,4096),I.write_shift(2,4),I.write_shift(4,0);for(var R=0,M=0,K=0,he=0;he<A.SheetNames.length;++he){var fe=A.SheetNames[he],ee=A.Sheets[fe];if(!(!ee||!ee["!ref"])){++K;var ve=Ra(ee["!ref"]);R<ve.e.r&&(R=ve.e.r),M<ve.e.c&&(M=ve.e.c)}}return R>8191&&(R=8191),I.write_shift(2,R),I.write_shift(1,K),I.write_shift(1,M),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(1,1),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(4,0),I}function c(A,I,R){var M={s:{c:0,r:0},e:{c:0,r:0}};return I==8&&R.qpro?(M.s.c=A.read_shift(1),A.l++,M.s.r=A.read_shift(2),M.e.c=A.read_shift(1),A.l++,M.e.r=A.read_shift(2),M):(M.s.c=A.read_shift(2),M.s.r=A.read_shift(2),I==12&&R.qpro&&(A.l+=2),M.e.c=A.read_shift(2),M.e.r=A.read_shift(2),I==12&&R.qpro&&(A.l+=2),M.s.c==65535&&(M.s.c=M.e.c=M.s.r=M.e.r=0),M)}function d(A){var I=Oe(8);return I.write_shift(2,A.s.c),I.write_shift(2,A.s.r),I.write_shift(2,A.e.c),I.write_shift(2,A.e.r),I}function f(A,I,R){var M=[{c:0,r:0},{t:"n",v:0},0,0];return R.qpro&&R.vers!=20768?(M[0].c=A.read_shift(1),M[3]=A.read_shift(1),M[0].r=A.read_shift(2),A.l+=2):(M[2]=A.read_shift(1),M[0].c=A.read_shift(2),M[0].r=A.read_shift(2)),M}function u(A,I,R){var M=A.l+I,K=f(A,I,R);if(K[1].t="s",R.vers==20768){A.l++;var he=A.read_shift(1);return K[1].v=A.read_shift(he,"utf8"),K}return R.qpro&&A.l++,K[1].v=A.read_shift(M-A.l,"cstr"),K}function g(A,I,R){var M=Oe(7+R.length);M.write_shift(1,255),M.write_shift(2,I),M.write_shift(2,A),M.write_shift(1,39);for(var K=0;K<M.length;++K){var he=R.charCodeAt(K);M.write_shift(1,he>=128?95:he)}return M.write_shift(1,0),M}function p(A,I,R){var M=f(A,I,R);return M[1].v=A.read_shift(2,"i"),M}function m(A,I,R){var M=Oe(7);return M.write_shift(1,255),M.write_shift(2,I),M.write_shift(2,A),M.write_shift(2,R,"i"),M}function j(A,I,R){var M=f(A,I,R);return M[1].v=A.read_shift(8,"f"),M}function v(A,I,R){var M=Oe(13);return M.write_shift(1,255),M.write_shift(2,I),M.write_shift(2,A),M.write_shift(8,R,"f"),M}function N(A,I,R){var M=A.l+I,K=f(A,I,R);if(K[1].v=A.read_shift(8,"f"),R.qpro)A.l=M;else{var he=A.read_shift(2);T(A.slice(A.l,A.l+he),K),A.l+=he}return K}function b(A,I,R){var M=I&32768;return I&=-32769,I=(M?A:0)+(I>=8192?I-16384:I),(M?"":"$")+(R?ia(I):Xr(I))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function T(A,I){Pa(A,0);for(var R=[],M=0,K="",he="",fe="",ee="";A.l<A.length;){var ve=A[A.l++];switch(ve){case 0:R.push(A.read_shift(8,"f"));break;case 1:he=b(I[0].c,A.read_shift(2),!0),K=b(I[0].r,A.read_shift(2),!1),R.push(he+K);break;case 2:{var Ce=b(I[0].c,A.read_shift(2),!0),De=b(I[0].r,A.read_shift(2),!1);he=b(I[0].c,A.read_shift(2),!0),K=b(I[0].r,A.read_shift(2),!1),R.push(Ce+De+":"+he+K)}break;case 3:if(A.l<A.length){console.error("WK1 premature formula end");return}break;case 4:R.push("("+R.pop()+")");break;case 5:R.push(A.read_shift(2));break;case 6:{for(var $e="";ve=A[A.l++];)$e+=String.fromCharCode(ve);R.push('"'+$e.replace(/"/g,'""')+'"')}break;case 8:R.push("-"+R.pop());break;case 23:R.push("+"+R.pop());break;case 22:R.push("NOT("+R.pop()+")");break;case 20:case 21:ee=R.pop(),fe=R.pop(),R.push(["AND","OR"][ve-20]+"("+fe+","+ee+")");break;default:if(ve<32&&_[ve])ee=R.pop(),fe=R.pop(),R.push(fe+_[ve]+ee);else if(y[ve]){if(M=y[ve][1],M==69&&(M=A[A.l++]),M>R.length){console.error("WK1 bad formula parse 0x"+ve.toString(16)+":|"+R.join("|")+"|");return}var Ke=R.slice(-M);R.length-=M,R.push(y[ve][0]+"("+Ke.join(",")+")")}else return ve<=7?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=24?console.error("WK1 unsupported op "+ve.toString(16)):ve<=30?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=115?console.error("WK1 unsupported function opcode "+ve.toString(16)):console.error("WK1 unrecognized opcode "+ve.toString(16))}}R.length==1?I[1].f=""+R[0]:console.error("WK1 bad formula parse |"+R.join("|")+"|")}function O(A){var I=[{c:0,r:0},{t:"n",v:0},0];return I[0].r=A.read_shift(2),I[3]=A[A.l++],I[0].c=A[A.l++],I}function B(A,I){var R=O(A);return R[1].t="s",R[1].v=A.read_shift(I-4,"cstr"),R}function L(A,I,R,M){var K=Oe(6+M.length);K.write_shift(2,A),K.write_shift(1,R),K.write_shift(1,I),K.write_shift(1,39);for(var he=0;he<M.length;++he){var fe=M.charCodeAt(he);K.write_shift(1,fe>=128?95:fe)}return K.write_shift(1,0),K}function E(A,I){var R=O(A);R[1].v=A.read_shift(2);var M=R[1].v>>1;if(R[1].v&1)switch(M&7){case 0:M=(M>>3)*5e3;break;case 1:M=(M>>3)*500;break;case 2:M=(M>>3)/20;break;case 3:M=(M>>3)/200;break;case 4:M=(M>>3)/2e3;break;case 5:M=(M>>3)/2e4;break;case 6:M=(M>>3)/16;break;case 7:M=(M>>3)/64;break}return R[1].v=M,R}function P(A,I){var R=O(A),M=A.read_shift(4),K=A.read_shift(4),he=A.read_shift(2);if(he==65535)return M===0&&K===3221225472?(R[1].t="e",R[1].v=15):M===0&&K===3489660928?(R[1].t="e",R[1].v=42):R[1].v=0,R;var fe=he&32768;return he=(he&32767)-16446,R[1].v=(1-fe*2)*(K*Math.pow(2,he+32)+M*Math.pow(2,he)),R}function D(A,I,R,M){var K=Oe(14);if(K.write_shift(2,A),K.write_shift(1,R),K.write_shift(1,I),M==0)return K.write_shift(4,0),K.write_shift(4,0),K.write_shift(2,65535),K;var he=0,fe=0,ee=0,ve=0;return M<0&&(he=1,M=-M),fe=Math.log2(M)|0,M/=Math.pow(2,fe-31),ve=M>>>0,ve&2147483648||(M/=2,++fe,ve=M>>>0),M-=ve,ve|=2147483648,ve>>>=0,M*=Math.pow(2,32),ee=M>>>0,K.write_shift(4,ee),K.write_shift(4,ve),fe+=16383+(he?32768:0),K.write_shift(2,fe),K}function k(A,I){var R=P(A);return A.l+=I-14,R}function C(A,I){var R=O(A),M=A.read_shift(4);return R[1].v=M>>6,R}function z(A,I){var R=O(A),M=A.read_shift(8,"f");return R[1].v=M,R}function G(A,I){var R=z(A);return A.l+=I-10,R}function de(A,I){return A[A.l+I-1]==0?A.read_shift(I,"cstr"):""}function J(A,I){var R=A[A.l++];R>I-1&&(R=I-1);for(var M="";M.length<R;)M+=String.fromCharCode(A[A.l++]);return M}function Z(A,I,R){if(!(!R.qpro||I<21)){var M=A.read_shift(1);A.l+=17,A.l+=1,A.l+=2;var K=A.read_shift(I-21,"cstr");return[M,K]}}function oe(A,I){for(var R={},M=A.l+I;A.l<M;){var K=A.read_shift(2);if(K==14e3){for(R[K]=[0,""],R[K][0]=A.read_shift(2);A[A.l];)R[K][1]+=String.fromCharCode(A[A.l]),A.l++;A.l++}}return R}function ne(A,I){var R=Oe(5+A.length);R.write_shift(2,14e3),R.write_shift(2,I);for(var M=0;M<A.length;++M){var K=A.charCodeAt(M);R[R.l++]=K>127?95:K}return R[R.l++]=0,R}var me={0:{n:"BOF",f:Du},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:j},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:N},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:de},222:{n:"SHEETNAMELP",f:J},65535:{n:""}},be={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:B},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:E},25:{n:"FORMULA19",f:k},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:oe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:C},38:{n:"??"},39:{n:"NUMBER27",f:z},40:{n:"FORMULA28",f:G},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:de},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Z},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:r}}(),iv=/^\s|\s$|[\t\n\r]/;function Wu(e,r){if(!r.bookSST)return"";var t=[Lr];t[t.length]=Ze("sst",null,{xmlns:Ri[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],o="<si>";s.r?o+=s.r:(o+="<t",s.t||(s.t=""),s.t.match(iv)&&(o+=' xml:space="preserve"'),o+=">"+Yt(s.t)+"</t>"),o+="</si>",t[t.length]=o}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function ov(e){return[e.read_shift(4),e.read_shift(4)]}function lv(e,r){return r||(r=Oe(8)),r.write_shift(4,e.Count),r.write_shift(4,e.Unique),r}var cv=Qg;function dv(e){var r=wa();We(r,159,lv(e));for(var t=0;t<e.length;++t)We(r,19,cv(e[t]));return We(r,160),r.end()}function hv(e){for(var r=[],t=e.split(""),n=0;n<t.length;++n)r[n]=t[n].charCodeAt(0);return r}function zu(e){var r=0,t,n=hv(e),s=n.length+1,o,l,c,d,f;for(t=zs(s),t[0]=n.length,o=1;o!=s;++o)t[o]=n[o-1];for(o=s-1;o>=0;--o)l=t[o],c=r&16384?1:0,d=r<<1&32767,f=c|d,r=f^l;return r^52811}var fv=function(){function e(s,o){switch(o.type){case"base64":return r($n(s),o);case"binary":return r(s,o);case"buffer":return r(Ht&&Buffer.isBuffer(s)?s.toString("binary"):Ho(s),o);case"array":return r(jc(s),o)}throw new Error("Unrecognized type "+o.type)}function r(s,o){var l=o||{},c=l.dense?[]:{},d=s.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(u,g){Array.isArray(c)&&(c[g]=[]);for(var p=/\\\w+\b/g,m=0,j,v=-1;j=p.exec(u);){switch(j[0]){case"\\cell":var N=u.slice(m,p.lastIndex-j[0].length);if(N[0]==" "&&(N=N.slice(1)),++v,N.length){var b={v:N,t:"s"};Array.isArray(c)?c[g][v]=b:c[Kt({r:g,c:v})]=b}break}m=p.lastIndex}v>f.e.c&&(f.e.c=v)}),c["!ref"]=Er(f),c}function t(s,o){return $s(e(s,o),o)}function n(s){for(var o=["{\\rtf1\\ansi"],l=lr(s["!ref"]),c,d=Array.isArray(s),f=l.s.r;f<=l.e.r;++f){o.push("\\trowd\\trautofit1");for(var u=l.s.c;u<=l.e.c;++u)o.push("\\cellx"+(u+1));for(o.push("\\pard\\intbl"),u=l.s.c;u<=l.e.c;++u){var g=Kt({r:f,c:u});c=d?(s[f]||[])[u]:s[g],!(!c||c.v==null&&(!c.f||c.F))&&(o.push(" "+(c.w||(Yn(c),c.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:n}}();function of(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}var uv=6,Gn=uv;function hc(e){return Math.floor((e+Math.round(128/Gn)/256)*Gn)}function fc(e){return Math.floor((e-5)/Gn*100+.5)/100}function X0(e){return Math.round((e*Gn+5)/Gn*256)/256}function pd(e){e.width?(e.wpx=hc(e.width),e.wch=fc(e.wpx),e.MDW=Gn):e.wpx?(e.wch=fc(e.wpx),e.width=X0(e.wch),e.MDW=Gn):typeof e.wch=="number"&&(e.width=X0(e.wch),e.wpx=hc(e.width),e.MDW=Gn),e.customWidth&&delete e.customWidth}var mv=96,qu=mv;function uc(e){return e*96/qu}function Vu(e){return e*qu/96}function xv(e){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var n=t[0];n<=t[1];++n)e[n]!=null&&(r[r.length]=Ze("numFmt",null,{numFmtId:n,formatCode:Yt(e[n])}))}),r.length===1?"":(r[r.length]="</numFmts>",r[0]=Ze("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function pv(e){var r=[];return r[r.length]=Ze("cellXfs",null),e.forEach(function(t){r[r.length]=Ze("xf",null,t)}),r[r.length]="</cellXfs>",r.length===2?"":(r[0]=Ze("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function Gu(e,r){var t=[Lr,Ze("styleSheet",null,{xmlns:Ri[0],"xmlns:vt":Hr.vt})],n;return e.SSF&&(n=xv(e.SSF))!=null&&(t[t.length]=n),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=pv(r.cellXfs))&&(t[t.length]=n),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function gv(e,r){var t=e.read_shift(2),n=oa(e);return[t,n]}function vv(e,r,t){t||(t=Oe(6+4*r.length)),t.write_shift(2,e),zr(r,t);var n=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),n}function yv(e,r,t){var n={};n.sz=e.read_shift(2)/20;var s=i2(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var o=e.read_shift(2);switch(o===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(n.underline=l);var c=e.read_shift(1);c>0&&(n.family=c);var d=e.read_shift(1);switch(d>0&&(n.charset=d),e.l++,n.color=s2(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=oa(e),n}function bv(e,r){r||(r=Oe(25+4*32)),r.write_shift(2,e.sz*20),o2(e,r),r.write_shift(2,e.bold?700:400);var t=0;e.vertAlign=="superscript"?t=1:e.vertAlign=="subscript"&&(t=2),r.write_shift(2,t),r.write_shift(1,e.underline||0),r.write_shift(1,e.family||0),r.write_shift(1,e.charset||0),r.write_shift(1,0),cc(e.color,r);var n=0;return n=2,r.write_shift(1,n),zr(e.name,r),r.length>r.l?r.slice(0,r.l):r}var wv=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],T0,Nv=En;function lf(e,r){r||(r=Oe(4*3+8*7+16*1)),T0||(T0=nd(wv));var t=T0[e.patternType];t==null&&(t=40),r.write_shift(4,t);var n=0;if(t!=40)for(cc({auto:1},r),cc({auto:1},r);n<12;++n)r.write_shift(4,0);else{for(;n<4;++n)r.write_shift(4,0);for(;n<12;++n)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function jv(e,r){var t=e.l+r,n=e.read_shift(2),s=e.read_shift(2);return e.l=t,{ixfe:n,numFmtId:s}}function $u(e,r,t){t||(t=Oe(16)),t.write_shift(2,r||0),t.write_shift(2,e.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var n=0;return t.write_shift(1,n),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function yo(e,r){return r||(r=Oe(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var Sv=En;function _v(e,r){return r||(r=Oe(51)),r.write_shift(1,0),yo(null,r),yo(null,r),yo(null,r),yo(null,r),yo(null,r),r.length>r.l?r.slice(0,r.l):r}function Av(e,r){return r||(r=Oe(12+4*10)),r.write_shift(4,e.xfId),r.write_shift(2,1),r.write_shift(1,0),r.write_shift(1,0),lc(e.name||"",r),r.length>r.l?r.slice(0,r.l):r}function kv(e,r,t){var n=Oe(2052);return n.write_shift(4,e),lc(r,n),lc(t,n),n.length>n.l?n.slice(0,n.l):n}function Tv(e,r){if(r){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)r[s]!=null&&++t}),t!=0&&(We(e,615,mn(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)r[s]!=null&&We(e,44,vv(s,r[s]))}),We(e,616))}}function Cv(e){var r=1;We(e,611,mn(r)),We(e,43,bv({sz:12,color:{theme:1},name:"Calibri",family:2})),We(e,612)}function Ev(e){var r=2;We(e,603,mn(r)),We(e,45,lf({patternType:"none"})),We(e,45,lf({patternType:"gray125"})),We(e,604)}function Lv(e){var r=1;We(e,613,mn(r)),We(e,46,_v()),We(e,614)}function Fv(e){var r=1;We(e,626,mn(r)),We(e,47,$u({numFmtId:0},65535)),We(e,627)}function Pv(e,r){We(e,617,mn(r.length)),r.forEach(function(t){We(e,47,$u(t,0))}),We(e,618)}function Ov(e){var r=1;We(e,619,mn(r)),We(e,48,Av({xfId:0,name:"Normal"})),We(e,620)}function Iv(e){var r=0;We(e,505,mn(r)),We(e,506)}function Dv(e){var r=0;We(e,508,kv(r,"TableStyleMedium9","PivotStyleMedium4")),We(e,509)}function Rv(e,r){var t=wa();return We(t,278),Tv(t,e.SSF),Cv(t),Ev(t),Lv(t),Fv(t),Pv(t,r.cellXfs),Ov(t),Iv(t),Dv(t),We(t,279),t.end()}function Yu(e,r){if(r&&r.themeXLSX)return r.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var t=[Lr];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',t[t.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',t[t.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',t[t.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜Žé«”"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',t[t.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',t[t.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',t[t.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜Žé«”"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function Bv(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:oa(e)}}function Mv(e){var r=Oe(12+2*e.name.length);return r.write_shift(4,e.flags),r.write_shift(4,e.version),zr(e.name,r),r.slice(0,r.l)}function Uv(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function Hv(e){var r=Oe(4+8*e.length);r.write_shift(4,e.length);for(var t=0;t<e.length;++t)r.write_shift(4,e[t][0]),r.write_shift(4,e[t][1]);return r}function Wv(e,r){var t=Oe(8+2*r.length);return t.write_shift(4,e),zr(r,t),t.slice(0,t.l)}function zv(e){return e.l+=4,e.read_shift(4)!=0}function qv(e,r){var t=Oe(8);return t.write_shift(4,e),t.write_shift(4,1),t}function Vv(){var e=wa();return We(e,332),We(e,334,mn(1)),We(e,335,Mv({name:"XLDAPR",version:12e4,flags:3496657072})),We(e,336),We(e,339,Wv(1,"XLDAPR")),We(e,52),We(e,35,mn(514)),We(e,4096,mn(0)),We(e,4097,Ka(1)),We(e,36),We(e,53),We(e,340),We(e,337,qv(1)),We(e,51,Hv([[1,0]])),We(e,338),We(e,333),e.end()}function Ku(){var e=[Lr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Gv(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=Kt(t);var n=e.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}var Ei=1024;function Xu(e,r){for(var t=[21600,21600],n=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),s=[Ze("xml",null,{"xmlns:v":Oa.v,"xmlns:o":Oa.o,"xmlns:x":Oa.x,"xmlns:mv":Oa.mv}).replace(/\/>/,">"),Ze("o:shapelayout",Ze("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ze("v:shapetype",[Ze("v:stroke",null,{joinstyle:"miter"}),Ze("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:n})];Ei<e*1e3;)Ei+=1e3;return r.forEach(function(o){var l=Wr(o[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var d=c.type=="gradient"?Ze("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,f=Ze("v:fill",d,c),u={on:"t",obscured:"t"};++Ei,s=s.concat(["<v:shape"+Bo({id:"_x0000_s"+Ei,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(o[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",f,Ze("v:shadow",null,u),Ze("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Kr("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),Kr("x:AutoFill","False"),Kr("x:Row",String(l.r)),Kr("x:Column",String(l.c)),o[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function Ju(e){var r=[Lr,Ze("comments",null,{xmlns:Ri[0]})],t=[];return r.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var o=Yt(s.a);t.indexOf(o)==-1&&(t.push(o),r.push("<author>"+o+"</author>")),s.T&&s.ID&&t.indexOf("tc="+s.ID)==-1&&(t.push("tc="+s.ID),r.push("<author>tc="+s.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),e.forEach(function(n){var s=0,o=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=t.indexOf("tc="+n[1][0].ID):n[1].forEach(function(d){d.a&&(s=t.indexOf(Yt(d.a))),o.push(d.t||"")}),r.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),o.length<=1)r.push(Kr("t",Yt(o[0]||"")));else{for(var l=`Comment:
    `+o[0]+`
`,c=1;c<o.length;++c)l+=`Reply:
    `+o[c]+`
`;r.push(Kr("t",Yt(l)))}r.push("</text></comment>")}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function $v(e,r,t){var n=[Lr,Ze("ThreadedComments",null,{xmlns:Hr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var o="";(s[1]||[]).forEach(function(l,c){if(!l.T){delete l.ID;return}l.a&&r.indexOf(l.a)==-1&&r.push(l.a);var d={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};c==0?o=d.id:d.parentId=o,l.ID=d.id,l.a&&(d.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(l.a)).slice(-12)+"}"),n.push(Ze("threadedComment",Kr("text",l.t||""),d))})}),n.push("</ThreadedComments>"),n.join("")}function Yv(e){var r=[Lr,Ze("personList",null,{xmlns:Hr.TCMNT,"xmlns:x":Ri[0]}).replace(/[\/]>/,">")];return e.forEach(function(t,n){r.push(Ze("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:t,providerId:"None"}))}),r.push("</personList>"),r.join("")}function Kv(e){var r={};r.iauthor=e.read_shift(4);var t=Js(e);return r.rfx=t.s,r.ref=Kt(t.s),e.l+=16,r}function Xv(e,r){return r==null&&(r=Oe(36)),r.write_shift(4,e[1].iauthor),Mi(e[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}var Jv=oa;function Zv(e){return zr(e.slice(0,54))}function Qv(e){var r=wa(),t=[];return We(r,628),We(r,630),e.forEach(function(n){n[1].forEach(function(s){t.indexOf(s.a)>-1||(t.push(s.a.slice(0,54)),We(r,632,Zv(s.a)))})}),We(r,631),We(r,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=t.indexOf(s.a);var o={s:Wr(n[0]),e:Wr(n[0])};We(r,635,Xv([o,s])),s.t&&s.t.length>0&&We(r,637,t2(s)),We(r,636),delete s.iauthor})}),We(r,634),We(r,629),r.end()}function e5(e,r){r.FullPaths.forEach(function(t,n){if(n!=0){var s=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Zt.utils.cfb_add(e,s,r.FileIndex[n].content)}})}var Zu=["xlsb","xlsm","xlam","biff8","xla"],t5=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(n,s,o,l){var c=!1,d=!1;o.length==0?d=!0:o.charAt(0)=="["&&(d=!0,o=o.slice(1,-1)),l.length==0?c=!0:l.charAt(0)=="["&&(c=!0,l=l.slice(1,-1));var f=o.length>0?parseInt(o,10)|0:0,u=l.length>0?parseInt(l,10)|0:0;return c?u+=r.c:--u,d?f+=r.r:--f,s+(c?"":"$")+ia(u)+(d?"":"$")+Xr(f)}return function(s,o){return r=o,s.replace(e,t)}}(),gd=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,vd=function(){return function(r,t){return r.replace(gd,function(n,s,o,l,c,d){var f=hd(l)-(o?0:t.c),u=dd(d)-(c?0:t.r),g=u==0?"":c?u+1:"["+u+"]",p=f==0?"":o?f+1:"["+f+"]";return s+"R"+g+"C"+p})}}();function r5(e,r){return e.replace(gd,function(t,n,s,o,l,c){return n+(s=="$"?s+o:ia(hd(o)+r.c))+(l=="$"?l+c:Xr(dd(c)+r.r))})}function a5(e){return e.length!=1}function Cr(e){e.l+=1}function Ns(e,r){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function Qu(e,r,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return e1(e);t.biff==12&&(n=4)}var s=e.read_shift(n),o=e.read_shift(n),l=Ns(e),c=Ns(e);return{s:{r:s,c:l[0],cRel:l[1],rRel:l[2]},e:{r:o,c:c[0],cRel:c[1],rRel:c[2]}}}function e1(e){var r=Ns(e),t=Ns(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:t[0],c:s,cRel:t[1],rRel:t[2]}}}function n5(e,r,t){if(t.biff<8)return e1(e);var n=e.read_shift(t.biff==12?4:2),s=e.read_shift(t.biff==12?4:2),o=Ns(e),l=Ns(e);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function t1(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return s5(e);var n=e.read_shift(t&&t.biff==12?4:2),s=Ns(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function s5(e){var r=Ns(e),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function i5(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function o5(e,r,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return l5(e);var s=e.read_shift(n>=12?4:2),o=e.read_shift(2),l=(o&16384)>>14,c=(o&32768)>>15;if(o&=16383,c==1)for(;s>524287;)s-=1048576;if(l==1)for(;o>8191;)o=o-16384;return{r:s,c:o,cRel:l,rRel:c}}function l5(e){var r=e.read_shift(2),t=e.read_shift(1),n=(r&32768)>>15,s=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),s==1&&t>=128&&(t=t-256),{r,c:t,cRel:s,rRel:n}}function c5(e,r,t){var n=(e[e.l++]&96)>>5,s=Qu(e,t.biff>=2&&t.biff<=5?6:8,t);return[n,s]}function d5(e,r,t){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}var l=Qu(e,o,t);return[n,s,l]}function h5(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function f5(e,r,t){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}return e.l+=o,[n,s]}function u5(e,r,t){var n=(e[e.l++]&96)>>5,s=n5(e,r-1,t);return[n,s]}function m5(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[n]}function cf(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function x5(e,r,t){e.l+=2;for(var n=e.read_shift(t&&t.biff==2?1:2),s=[],o=0;o<=n;++o)s.push(e.read_shift(t&&t.biff==2?1:2));return s}function p5(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function g5(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function v5(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function y5(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[n]}function r1(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function b5(e){return e.read_shift(2),r1(e)}function w5(e){return e.read_shift(2),r1(e)}function N5(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var s=t1(e,0,t);return[n,s]}function j5(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var s=o5(e,0,t);return[n,s]}function S5(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var o=t1(e,0,t);return[n,s,o]}function _5(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(t&&t.biff<=3?1:2);return[_y[s],s1[s],n]}function A5(e,r,t){var n=e[e.l++],s=e.read_shift(1),o=t&&t.biff<=3?[n==88?-1:0,e.read_shift(1)]:k5(e);return[s,(o[0]===0?s1:Sy)[o[1]]]}function k5(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function T5(e,r,t){e.l+=t&&t.biff==2?3:4}function C5(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(t&&t.biff==2?1:2);return[n,s]}function E5(e){return e.l++,qo[e.read_shift(1)]}function L5(e){return e.l++,e.read_shift(2)}function F5(e){return e.l++,e.read_shift(1)!==0}function P5(e){return e.l++,Ui(e)}function O5(e,r,t){return e.l++,Bu(e,r-1,t)}function I5(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=S2(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=qo[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Ui(e);break;case 2:t[1]=T2(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function D5(e,r,t){for(var n=e.read_shift(t.biff==12?4:2),s=[],o=0;o!=n;++o)s.push((t.biff==12?Js:L2)(e));return s}function R5(e,r,t){var n=0,s=0;t.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--s==0&&(s=256));for(var o=0,l=[];o!=n&&(l[o]=[]);++o)for(var c=0;c!=s;++c)l[o][c]=I5(e,t.biff);return l}function B5(e,r,t){var n=e.read_shift(1)>>>5&3,s=!t||t.biff>=8?4:2,o=e.read_shift(s);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,o]}function M5(e,r,t){if(t.biff==5)return U5(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),o=e.read_shift(4);return[n,s,o]}function U5(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[r,t,n]}function H5(e,r,t){var n=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var s=e.read_shift(t&&t.biff==2?1:2);return[n,s]}function W5(e,r,t){var n=e.read_shift(1)>>>5&3,s=e.read_shift(t&&t.biff==2?1:2);return[n,s]}function z5(e,r,t){var n=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[n]}function q5(e,r,t){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),o=4;if(t)switch(t.biff){case 5:o=15;break;case 12:o=6;break}return e.l+=o,[n,s]}var V5=En,G5=En,$5=En;function Vo(e,r,t){return e.l+=2,[i5(e)]}function yd(e){return e.l+=6,[]}var Y5=Vo,K5=yd,X5=yd,J5=Vo;function a1(e){return e.l+=2,[Du(e),e.read_shift(2)&1]}var Z5=Vo,Q5=a1,ey=yd,ty=Vo,ry=Vo,ay=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function ny(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),o=e.read_shift(2),l=ay[t>>2&31];return{ixti:r,coltype:t&3,rt:l,idx:n,c:s,C:o}}function sy(e){return e.l+=2,[e.read_shift(4)]}function iy(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function oy(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function ly(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function cy(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function dy(e){return e.l+=4,[0,0]}var df={1:{n:"PtgExp",f:C5},2:{n:"PtgTbl",f:$5},3:{n:"PtgAdd",f:Cr},4:{n:"PtgSub",f:Cr},5:{n:"PtgMul",f:Cr},6:{n:"PtgDiv",f:Cr},7:{n:"PtgPower",f:Cr},8:{n:"PtgConcat",f:Cr},9:{n:"PtgLt",f:Cr},10:{n:"PtgLe",f:Cr},11:{n:"PtgEq",f:Cr},12:{n:"PtgGe",f:Cr},13:{n:"PtgGt",f:Cr},14:{n:"PtgNe",f:Cr},15:{n:"PtgIsect",f:Cr},16:{n:"PtgUnion",f:Cr},17:{n:"PtgRange",f:Cr},18:{n:"PtgUplus",f:Cr},19:{n:"PtgUminus",f:Cr},20:{n:"PtgPercent",f:Cr},21:{n:"PtgParen",f:Cr},22:{n:"PtgMissArg",f:Cr},23:{n:"PtgStr",f:O5},26:{n:"PtgSheet",f:iy},27:{n:"PtgEndSheet",f:oy},28:{n:"PtgErr",f:E5},29:{n:"PtgBool",f:F5},30:{n:"PtgInt",f:L5},31:{n:"PtgNum",f:P5},32:{n:"PtgArray",f:m5},33:{n:"PtgFunc",f:_5},34:{n:"PtgFuncVar",f:A5},35:{n:"PtgName",f:B5},36:{n:"PtgRef",f:N5},37:{n:"PtgArea",f:c5},38:{n:"PtgMemArea",f:H5},39:{n:"PtgMemErr",f:V5},40:{n:"PtgMemNoMem",f:G5},41:{n:"PtgMemFunc",f:W5},42:{n:"PtgRefErr",f:z5},43:{n:"PtgAreaErr",f:h5},44:{n:"PtgRefN",f:j5},45:{n:"PtgAreaN",f:u5},46:{n:"PtgMemAreaN",f:ly},47:{n:"PtgMemNoMemN",f:cy},57:{n:"PtgNameX",f:M5},58:{n:"PtgRef3d",f:S5},59:{n:"PtgArea3d",f:d5},60:{n:"PtgRefErr3d",f:q5},61:{n:"PtgAreaErr3d",f:f5},255:{}},hy={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},fy={1:{n:"PtgElfLel",f:a1},2:{n:"PtgElfRw",f:ty},3:{n:"PtgElfCol",f:Y5},6:{n:"PtgElfRwV",f:ry},7:{n:"PtgElfColV",f:J5},10:{n:"PtgElfRadical",f:Z5},11:{n:"PtgElfRadicalS",f:ey},13:{n:"PtgElfColS",f:K5},15:{n:"PtgElfColSV",f:X5},16:{n:"PtgElfRadicalLel",f:Q5},25:{n:"PtgList",f:ny},29:{n:"PtgSxName",f:sy},255:{}},uy={0:{n:"PtgAttrNoop",f:dy},1:{n:"PtgAttrSemi",f:y5},2:{n:"PtgAttrIf",f:g5},4:{n:"PtgAttrChoose",f:x5},8:{n:"PtgAttrGoto",f:p5},16:{n:"PtgAttrSum",f:T5},32:{n:"PtgAttrBaxcel",f:cf},33:{n:"PtgAttrBaxcel",f:cf},64:{n:"PtgAttrSpace",f:b5},65:{n:"PtgAttrSpaceSemi",f:w5},128:{n:"PtgAttrIfError",f:v5},255:{}};function my(e,r,t,n){if(n.biff<8)return En(e,r);for(var s=e.l+r,o=[],l=0;l!==t.length;++l)switch(t[l][0]){case"PtgArray":t[l][1]=R5(e,0,n),o.push(t[l][1]);break;case"PtgMemArea":t[l][2]=D5(e,t[l][1],n),o.push(t[l][2]);break;case"PtgExp":n&&n.biff==12&&(t[l][1][1]=e.read_shift(4),o.push(t[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[l][0]}return r=s-e.l,r!==0&&o.push(En(e,r)),o}function xy(e,r,t){for(var n=e.l+r,s,o,l=[];n!=e.l;)r=n-e.l,o=e[e.l],s=df[o]||df[hy[o]],(o===24||o===25)&&(s=(o===24?fy:uy)[e[e.l+1]]),!s||!s.f?En(e,r):l.push([s.n,s.f(e,r,t)]);return l}function py(e){for(var r=[],t=0;t<e.length;++t){for(var n=e[t],s=[],o=0;o<n.length;++o){var l=n[o];if(l)switch(l[0]){case 2:s.push('"'+l[1].replace(/"/g,'""')+'"');break;default:s.push(l[1])}else s.push("")}r.push(s.join(","))}return r.join(";")}var gy={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function vy(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function n1(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!n)return"SH33TJSERR1";var s="";if(t.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function hf(e,r,t){var n=n1(e,r,t);return n=="#REF"?n:vy(n,t)}function Ii(e,r,t,n,s){var o=s&&s.biff||8,l={s:{c:0,r:0}},c=[],d,f,u,g=0,p=0,m,j="";if(!e[0]||!e[0][0])return"";for(var v=-1,N="",b=0,y=e[0].length;b<y;++b){var _=e[0][b];switch(_[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=c.pop(),f=c.pop(),v>=0){switch(e[0][v][1][0]){case 0:N=mr(" ",e[0][v][1][1]);break;case 1:N=mr("\r",e[0][v][1][1]);break;default:if(N="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}f=f+N,v=-1}c.push(f+gy[_[0]]+d);break;case"PtgIsect":d=c.pop(),f=c.pop(),c.push(f+" "+d);break;case"PtgUnion":d=c.pop(),f=c.pop(),c.push(f+","+d);break;case"PtgRange":d=c.pop(),f=c.pop(),c.push(f+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Co(_[1][1],l,s),c.push(Eo(u,o));break;case"PtgRefN":u=t?Co(_[1][1],t,s):_[1][1],c.push(Eo(u,o));break;case"PtgRef3d":g=_[1][1],u=Co(_[1][2],l,s),j=hf(n,g,s),c.push(j+"!"+Eo(u,o));break;case"PtgFunc":case"PtgFuncVar":var T=_[1][0],O=_[1][1];T||(T=0),T&=127;var B=T==0?[]:c.slice(-T);c.length-=T,O==="User"&&(O=B.shift()),c.push(O+"("+B.join(",")+")");break;case"PtgBool":c.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(_[1]);break;case"PtgNum":c.push(String(_[1]));break;case"PtgStr":c.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(_[1]);break;case"PtgAreaN":m=Yh(_[1][1],t?{s:t}:l,s),c.push(A0(m,s));break;case"PtgArea":m=Yh(_[1][1],l,s),c.push(A0(m,s));break;case"PtgArea3d":g=_[1][1],m=_[1][2],j=hf(n,g,s),c.push(j+"!"+A0(m,s));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=_[1][2];var L=(n.names||[])[p-1]||(n[0]||[])[p],E=L?L.Name:"SH33TJSNAME"+String(p);E&&E.slice(0,6)=="_xlfn."&&!s.xlfn&&(E=E.slice(6)),c.push(E);break;case"PtgNameX":var P=_[1][1];p=_[1][2];var D;if(s.biff<=5)P<0&&(P=-P),n[P]&&(D=n[P][p]);else{var k="";if(((n[P]||[])[0]||[])[0]==14849||(((n[P]||[])[0]||[])[0]==1025?n[P][p]&&n[P][p].itab>0&&(k=n.SheetNames[n[P][p].itab-1]+"!"):k=n.SheetNames[p-1]+"!"),n[P]&&n[P][p])k+=n[P][p].Name;else if(n[0]&&n[0][p])k+=n[0][p].Name;else{var C=(n1(n,P,s)||"").split(";;");C[p-1]?k=C[p-1]:k+="SH33TJSERRX"}c.push(k);break}D||(D={Name:"SH33TJSERRY"}),c.push(D.Name);break;case"PtgParen":var z="(",G=")";if(v>=0){switch(N="",e[0][v][1][0]){case 2:z=mr(" ",e[0][v][1][1])+z;break;case 3:z=mr("\r",e[0][v][1][1])+z;break;case 4:G=mr(" ",e[0][v][1][1])+G;break;case 5:G=mr("\r",e[0][v][1][1])+G;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}v=-1}c.push(z+c.pop()+G);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":u={c:_[1][1],r:_[1][0]};var de={c:t.c,r:t.r};if(n.sharedf[Kt(u)]){var J=n.sharedf[Kt(u)];c.push(Ii(J,l,de,n,s))}else{var Z=!1;for(d=0;d!=n.arrayf.length;++d)if(f=n.arrayf[d],!(u.c<f[0].s.c||u.c>f[0].e.c)&&!(u.r<f[0].s.r||u.r>f[0].e.r)){c.push(Ii(f[1],l,de,n,s)),Z=!0;break}Z||c.push(_[1])}break;case"PtgArray":c.push("{"+py(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var oe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&v>=0&&oe.indexOf(e[0][b][0])==-1){_=e[0][v];var ne=!0;switch(_[1][0]){case 4:ne=!1;case 0:N=mr(" ",_[1][1]);break;case 5:ne=!1;case 1:N=mr("\r",_[1][1]);break;default:if(N="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}c.push((ne?N:"")+c.pop()+(ne?"":N)),v=-1}}if(c.length>1&&s.WTF)throw new Error("bad formula stack");return c[0]}function yy(e){if(e==null){var r=Oe(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}else if(typeof e=="number")return qs(e);return qs(0)}function by(e,r,t,n,s){var o=Vs(r,t,s),l=yy(e.v),c=Oe(6),d=33;c.write_shift(2,d),c.write_shift(4,0);for(var f=Oe(e.bf.length),u=0;u<e.bf.length;++u)f[u]=e.bf[u];var g=Yr([o,l,c,f]);return g}function Sc(e,r,t){var n=e.read_shift(4),s=xy(e,n,t),o=e.read_shift(4),l=o>0?my(e,o,s,t):null;return[s,l]}var wy=Sc,_c=Sc,Ny=Sc,jy=Sc,Sy={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},s1={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},_y={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Ay(e){var r="of:="+e.replace(gd,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return r.replace(/;/g,"|").replace(/,/g,";")}function ky(e){return e.replace(/\./,"!")}var Lo=typeof Map<"u";function bd(e,r,t){var n=0,s=e.length;if(t){if(Lo?t.has(r):Object.prototype.hasOwnProperty.call(t,r)){for(var o=Lo?t.get(r):t[r];n<o.length;++n)if(e[o[n]].t===r)return e.Count++,o[n]}}else for(;n<s;++n)if(e[n].t===r)return e.Count++,n;return e[s]={t:r},e.Count++,e.Unique++,t&&(Lo?(t.has(r)||t.set(r,[]),t.get(r).push(s)):(Object.prototype.hasOwnProperty.call(t,r)||(t[r]=[]),t[r].push(s))),s}function Ac(e,r){var t={min:e+1,max:e+1},n=-1;return r.MDW&&(Gn=r.MDW),r.width!=null?t.customWidth=1:r.wpx!=null?n=fc(r.wpx):r.wch!=null&&(n=r.wch),n>-1?(t.width=X0(n),t.customWidth=1):r.width!=null&&(t.width=r.width),r.hidden&&(t.hidden=!0),r.level!=null&&(t.outlineLevel=t.level=r.level),t}function i1(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function Ss(e,r,t){var n=t.revssf[r.z!=null?r.z:"General"],s=60,o=e.length;if(n==null&&t.ssf){for(;s<392;++s)if(t.ssf[s]==null){tu(r.z,s),t.ssf[s]=r.z,t.revssf[r.z]=n=s;break}}for(s=0;s!=o;++s)if(e[s].numFmtId===n)return s;return e[o]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function Ty(e,r,t){if(e&&e["!ref"]){var n=lr(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+t+"): "+e["!ref"])}}function Cy(e){if(e.length===0)return"";for(var r='<mergeCells count="'+e.length+'">',t=0;t!=e.length;++t)r+='<mergeCell ref="'+Er(e[t])+'"/>';return r+"</mergeCells>"}function Ey(e,r,t,n,s){var o=!1,l={},c=null;if(n.bookType!=="xlsx"&&r.vbaraw){var d=r.SheetNames[t];try{r.Workbook&&(d=r.Workbook.Sheets[t].CodeName||d)}catch{}o=!0,l.codeName=Ro(Yt(d))}if(e&&e["!outline"]){var f={summaryBelow:1,summaryRight:1};e["!outline"].above&&(f.summaryBelow=0),e["!outline"].left&&(f.summaryRight=0),c=(c||"")+Ze("outlinePr",null,f)}!o&&!c||(s[s.length]=Ze("sheetPr",c,l))}var Ly=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Fy=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Py(e){var r={sheet:1};return Ly.forEach(function(t){e[t]!=null&&e[t]&&(r[t]="1")}),Fy.forEach(function(t){e[t]!=null&&!e[t]&&(r[t]="0")}),e.password&&(r.password=zu(e.password).toString(16).toUpperCase()),Ze("sheetProtection",null,r)}function Oy(e){return i1(e),Ze("pageMargins",null,e)}function Iy(e,r){for(var t=["<cols>"],n,s=0;s!=r.length;++s)(n=r[s])&&(t[t.length]=Ze("col",null,Ac(s,n)));return t[t.length]="</cols>",t.join("")}function Dy(e,r,t,n){var s=typeof e.ref=="string"?e.ref:Er(e.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var o=t.Workbook.Names,l=Ra(s);l.s.r==l.e.r&&(l.e.r=Ra(r["!ref"]).e.r,s=Er(l));for(var c=0;c<o.length;++c){var d=o[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+t.SheetNames[n]+"'!"+s;break}}return c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+s}),Ze("autoFilter",null,{ref:s})}function Ry(e,r,t,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ze("sheetViews",Ze("sheetView",null,s),{})}function By(e,r,t,n){if(e.c&&t["!comments"].push([r,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",o=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=qo[e.v];break;case"d":n&&n.cellDates?s=ua(e.v,-1).toISOString():(e=ja(e),e.t="n",s=""+(e.v=Na(ua(e.v)))),typeof e.z>"u"&&(e.z=pr[14]);break;default:s=e.v;break}var c=Kr("v",Yt(s)),d={r},f=Ss(n.cellXfs,e,n);switch(f!==0&&(d.s=f),e.t){case"n":break;case"d":d.t="d";break;case"b":d.t="b";break;case"e":d.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){c=Kr("v",""+bd(n.Strings,e.v,n.revStrings)),d.t="s";break}d.t="str";break}if(e.t!=o&&(e.t=o,e.v=l),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,r.length)==r?{t:"array",ref:e.F}:null;c=Ze("f",Yt(e.f),u)+(e.v!=null?c:"")}return e.l&&t["!links"].push([r,e.l]),e.D&&(d.cm=1),Ze("c",c,d)}function My(e,r,t,n){var s=[],o=[],l=lr(e["!ref"]),c="",d,f="",u=[],g=0,p=0,m=e["!rows"],j=Array.isArray(e),v={r:f},N,b=-1;for(p=l.s.c;p<=l.e.c;++p)u[p]=ia(p);for(g=l.s.r;g<=l.e.r;++g){for(o=[],f=Xr(g),p=l.s.c;p<=l.e.c;++p){d=u[p]+f;var y=j?(e[g]||[])[p]:e[d];y!==void 0&&(c=By(y,d,e,r))!=null&&o.push(c)}(o.length>0||m&&m[g])&&(v={r:f},m&&m[g]&&(N=m[g],N.hidden&&(v.hidden=1),b=-1,N.hpx?b=uc(N.hpx):N.hpt&&(b=N.hpt),b>-1&&(v.ht=b,v.customHeight=1),N.level&&(v.outlineLevel=N.level)),s[s.length]=Ze("row",o.join(""),v))}if(m)for(;g<m.length;++g)m&&m[g]&&(v={r:g+1},N=m[g],N.hidden&&(v.hidden=1),b=-1,N.hpx?b=uc(N.hpx):N.hpt&&(b=N.hpt),b>-1&&(v.ht=b,v.customHeight=1),N.level&&(v.outlineLevel=N.level),s[s.length]=Ze("row","",v));return s.join("")}function o1(e,r,t,n){var s=[Lr,Ze("worksheet",null,{xmlns:Ri[0],"xmlns:r":Hr.r})],o=t.SheetNames[e],l=0,c="",d=t.Sheets[o];d==null&&(d={});var f=d["!ref"]||"A1",u=lr(f);if(u.e.c>16383||u.e.r>1048575){if(r.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),f=Er(u)}n||(n={}),d["!comments"]=[];var g=[];Ey(d,t,e,r,s),s[s.length]=Ze("dimension",null,{ref:f}),s[s.length]=Ry(d,r,e,t),r.sheetFormat&&(s[s.length]=Ze("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),d["!cols"]!=null&&d["!cols"].length>0&&(s[s.length]=Iy(d,d["!cols"])),s[l=s.length]="<sheetData/>",d["!links"]=[],d["!ref"]!=null&&(c=My(d,r),c.length>0&&(s[s.length]=c)),s.length>l+1&&(s[s.length]="</sheetData>",s[l]=s[l].replace("/>",">")),d["!protect"]&&(s[s.length]=Py(d["!protect"])),d["!autofilter"]!=null&&(s[s.length]=Dy(d["!autofilter"],d,t,e)),d["!merges"]!=null&&d["!merges"].length>0&&(s[s.length]=Cy(d["!merges"]));var p=-1,m,j=-1;return d["!links"].length>0&&(s[s.length]="<hyperlinks>",d["!links"].forEach(function(v){v[1].Target&&(m={ref:v[0]},v[1].Target.charAt(0)!="#"&&(j=$t(n,-1,Yt(v[1].Target).replace(/#.*$/,""),Mt.HLINK),m["r:id"]="rId"+j),(p=v[1].Target.indexOf("#"))>-1&&(m.location=Yt(v[1].Target.slice(p+1))),v[1].Tooltip&&(m.tooltip=Yt(v[1].Tooltip)),s[s.length]=Ze("hyperlink",null,m))}),s[s.length]="</hyperlinks>"),delete d["!links"],d["!margins"]!=null&&(s[s.length]=Oy(d["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&(s[s.length]=Kr("ignoredErrors",Ze("ignoredError",null,{numberStoredAsText:1,sqref:f}))),g.length>0&&(j=$t(n,-1,"../drawings/drawing"+(e+1)+".xml",Mt.DRAW),s[s.length]=Ze("drawing",null,{"r:id":"rId"+j}),d["!drawing"]=g),d["!comments"].length>0&&(j=$t(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Mt.VML),s[s.length]=Ze("legacyDrawing",null,{"r:id":"rId"+j}),d["!legacy"]=j),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function Uy(e,r){var t={},n=e.l+r;t.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=n,o&7&&(t.level=o&7),o&16&&(t.hidden=!0),o&32&&(t.hpt=s/20),t}function Hy(e,r,t){var n=Oe(145),s=(t["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var o=320;s.hpx?o=uc(s.hpx)*20:s.hpt&&(o=s.hpt*20),n.write_shift(2,o),n.write_shift(1,0);var l=0;s.level&&(l|=s.level),s.hidden&&(l|=16),(s.hpx||s.hpt)&&(l|=32),n.write_shift(1,l),n.write_shift(1,0);var c=0,d=n.l;n.l+=4;for(var f={r:e,c:0},u=0;u<16;++u)if(!(r.s.c>u+1<<10||r.e.c<u<<10)){for(var g=-1,p=-1,m=u<<10;m<u+1<<10;++m){f.c=m;var j=Array.isArray(t)?(t[f.r]||[])[f.c]:t[Kt(f)];j&&(g<0&&(g=m),p=m)}g<0||(++c,n.write_shift(4,g),n.write_shift(4,p))}var v=n.l;return n.l=d,n.write_shift(4,c),n.l=v,n.length>n.l?n.slice(0,n.l):n}function Wy(e,r,t,n){var s=Hy(n,t,r);(s.length>17||(r["!rows"]||[])[n])&&We(e,0,s)}var zy=Js,qy=Mi;function Vy(){}function Gy(e,r){var t={},n=e[e.l];return++e.l,t.above=!(n&64),t.left=!(n&128),e.l+=18,t.name=r2(e),t}function $y(e,r,t){t==null&&(t=Oe(84+4*e.length));var n=192;r&&(r.above&&(n&=-65),r.left&&(n&=-129)),t.write_shift(1,n);for(var s=1;s<3;++s)t.write_shift(1,0);return cc({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),Nu(e,t),t.slice(0,t.l)}function Yy(e){var r=Xa(e);return[r]}function Ky(e,r,t){return t==null&&(t=Oe(8)),Ys(r,t)}function Xy(e){var r=Ks(e);return[r]}function Jy(e,r,t){return t==null&&(t=Oe(4)),Xs(r,t)}function Zy(e){var r=Xa(e),t=e.read_shift(1);return[r,t,"b"]}function Qy(e,r,t){return t==null&&(t=Oe(9)),Ys(r,t),t.write_shift(1,e.v?1:0),t}function eb(e){var r=Ks(e),t=e.read_shift(1);return[r,t,"b"]}function tb(e,r,t){return t==null&&(t=Oe(5)),Xs(r,t),t.write_shift(1,e.v?1:0),t}function rb(e){var r=Xa(e),t=e.read_shift(1);return[r,t,"e"]}function ab(e,r,t){return t==null&&(t=Oe(9)),Ys(r,t),t.write_shift(1,e.v),t}function nb(e){var r=Ks(e),t=e.read_shift(1);return[r,t,"e"]}function sb(e,r,t){return t==null&&(t=Oe(8)),Xs(r,t),t.write_shift(1,e.v),t.write_shift(2,0),t.write_shift(1,0),t}function ib(e){var r=Xa(e),t=e.read_shift(4);return[r,t,"s"]}function ob(e,r,t){return t==null&&(t=Oe(12)),Ys(r,t),t.write_shift(4,r.v),t}function lb(e){var r=Ks(e),t=e.read_shift(4);return[r,t,"s"]}function cb(e,r,t){return t==null&&(t=Oe(8)),Xs(r,t),t.write_shift(4,r.v),t}function db(e){var r=Xa(e),t=Ui(e);return[r,t,"n"]}function hb(e,r,t){return t==null&&(t=Oe(16)),Ys(r,t),qs(e.v,t),t}function fb(e){var r=Ks(e),t=Ui(e);return[r,t,"n"]}function ub(e,r,t){return t==null&&(t=Oe(12)),Xs(r,t),qs(e.v,t),t}function mb(e){var r=Xa(e),t=ju(e);return[r,t,"n"]}function xb(e,r,t){return t==null&&(t=Oe(12)),Ys(r,t),Su(e.v,t),t}function pb(e){var r=Ks(e),t=ju(e);return[r,t,"n"]}function gb(e,r,t){return t==null&&(t=Oe(8)),Xs(r,t),Su(e.v,t),t}function vb(e){var r=Xa(e),t=fd(e);return[r,t,"is"]}function yb(e){var r=Xa(e),t=oa(e);return[r,t,"str"]}function bb(e,r,t){return t==null&&(t=Oe(12+4*e.v.length)),Ys(r,t),zr(e.v,t),t.length>t.l?t.slice(0,t.l):t}function wb(e){var r=Ks(e),t=oa(e);return[r,t,"str"]}function Nb(e,r,t){return t==null&&(t=Oe(8+4*e.v.length)),Xs(r,t),zr(e.v,t),t.length>t.l?t.slice(0,t.l):t}function jb(e,r,t){var n=e.l+r,s=Xa(e);s.r=t["!row"];var o=e.read_shift(1),l=[s,o,"b"];if(t.cellFormula){e.l+=2;var c=_c(e,n-e.l,t);l[3]=Ii(c,null,s,t.supbooks,t)}else e.l=n;return l}function Sb(e,r,t){var n=e.l+r,s=Xa(e);s.r=t["!row"];var o=e.read_shift(1),l=[s,o,"e"];if(t.cellFormula){e.l+=2;var c=_c(e,n-e.l,t);l[3]=Ii(c,null,s,t.supbooks,t)}else e.l=n;return l}function _b(e,r,t){var n=e.l+r,s=Xa(e);s.r=t["!row"];var o=Ui(e),l=[s,o,"n"];if(t.cellFormula){e.l+=2;var c=_c(e,n-e.l,t);l[3]=Ii(c,null,s,t.supbooks,t)}else e.l=n;return l}function Ab(e,r,t){var n=e.l+r,s=Xa(e);s.r=t["!row"];var o=oa(e),l=[s,o,"str"];if(t.cellFormula){e.l+=2;var c=_c(e,n-e.l,t);l[3]=Ii(c,null,s,t.supbooks,t)}else e.l=n;return l}var kb=Js,Tb=Mi;function Cb(e,r){return r==null&&(r=Oe(4)),r.write_shift(4,e),r}function Eb(e,r){var t=e.l+r,n=Js(e),s=ud(e),o=oa(e),l=oa(e),c=oa(e);e.l=t;var d={rfx:n,relId:s,loc:o,display:c};return l&&(d.Tooltip=l),d}function Lb(e,r){var t=Oe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Mi({s:Wr(e[0]),e:Wr(e[0])},t),md("rId"+r,t);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return zr(s||"",t),zr(e[1].Tooltip||"",t),zr("",t),t.slice(0,t.l)}function Fb(){}function Pb(e,r,t){var n=e.l+r,s=_u(e),o=e.read_shift(1),l=[s];if(l[2]=o,t.cellFormula){var c=wy(e,n-e.l,t);l[1]=c}else e.l=n;return l}function Ob(e,r,t){var n=e.l+r,s=Js(e),o=[s];if(t.cellFormula){var l=jy(e,n-e.l,t);o[1]=l,e.l=n}else e.l=n;return o}function Ib(e,r,t){t==null&&(t=Oe(18));var n=Ac(e,r);t.write_shift(-4,e),t.write_shift(-4,e),t.write_shift(4,(n.width||10)*256),t.write_shift(4,0);var s=0;return r.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),r.level&&(s|=r.level<<8),t.write_shift(2,s),t}var l1=["left","right","top","bottom","header","footer"];function Db(e){var r={};return l1.forEach(function(t){r[t]=Ui(e)}),r}function Rb(e,r){return r==null&&(r=Oe(6*8)),i1(e),l1.forEach(function(t){qs(e[t],r)}),r}function Bb(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function Mb(e,r,t){t==null&&(t=Oe(30));var n=924;return(((r||{}).Views||[])[0]||{}).RTL&&(n|=32),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function Ub(e){var r=Oe(24);return r.write_shift(4,4),r.write_shift(4,1),Mi(e,r),r}function Hb(e,r){return r==null&&(r=Oe(16*4+2)),r.write_shift(2,e.password?zu(e.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?r.write_shift(4,e[t[0]]!=null&&!e[t[0]]?1:0):r.write_shift(4,e[t[0]]!=null&&e[t[0]]?0:1)}),r}function Wb(){}function zb(){}function qb(e,r,t,n,s,o,l){if(r.v===void 0)return!1;var c="";switch(r.t){case"b":c=r.v?"1":"0";break;case"d":r=ja(r),r.z=r.z||pr[14],r.v=Na(ua(r.v)),r.t="n";break;case"n":case"e":c=""+r.v;break;default:c=r.v;break}var d={r:t,c:n};switch(d.s=Ss(s.cellXfs,r,s),r.l&&o["!links"].push([Kt(d),r.l]),r.c&&o["!comments"].push([Kt(d),r.c]),r.t){case"s":case"str":return s.bookSST?(c=bd(s.Strings,r.v,s.revStrings),d.t="s",d.v=c,l?We(e,18,cb(r,d)):We(e,7,ob(r,d))):(d.t="str",l?We(e,17,Nb(r,d)):We(e,6,bb(r,d))),!0;case"n":return r.v==(r.v|0)&&r.v>-1e3&&r.v<1e3?l?We(e,13,gb(r,d)):We(e,2,xb(r,d)):l?We(e,16,ub(r,d)):We(e,5,hb(r,d)),!0;case"b":return d.t="b",l?We(e,15,tb(r,d)):We(e,4,Qy(r,d)),!0;case"e":return d.t="e",l?We(e,14,sb(r,d)):We(e,3,ab(r,d)),!0}return l?We(e,12,Jy(r,d)):We(e,1,Ky(r,d)),!0}function Vb(e,r,t,n){var s=lr(r["!ref"]||"A1"),o,l="",c=[];We(e,145);var d=Array.isArray(r),f=s.e.r;r["!rows"]&&(f=Math.max(s.e.r,r["!rows"].length-1));for(var u=s.s.r;u<=f;++u){l=Xr(u),Wy(e,r,s,u);var g=!1;if(u<=s.e.r)for(var p=s.s.c;p<=s.e.c;++p){u===s.s.r&&(c[p]=ia(p)),o=c[p]+l;var m=d?(r[u]||[])[p]:r[o];if(!m){g=!1;continue}g=qb(e,m,u,p,n,r,g)}}We(e,146)}function Gb(e,r){!r||!r["!merges"]||(We(e,177,Cb(r["!merges"].length)),r["!merges"].forEach(function(t){We(e,176,Tb(t))}),We(e,178))}function $b(e,r){!r||!r["!cols"]||(We(e,390),r["!cols"].forEach(function(t,n){t&&We(e,60,Ib(n,t))}),We(e,391))}function Yb(e,r){!r||!r["!ref"]||(We(e,648),We(e,649,Ub(lr(r["!ref"]))),We(e,650))}function Kb(e,r,t){r["!links"].forEach(function(n){if(n[1].Target){var s=$t(t,-1,n[1].Target.replace(/#.*$/,""),Mt.HLINK);We(e,494,Lb(n,s))}}),delete r["!links"]}function Xb(e,r,t,n){if(r["!comments"].length>0){var s=$t(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Mt.VML);We(e,551,md("rId"+s)),r["!legacy"]=s}}function Jb(e,r,t,n){if(r["!autofilter"]){var s=r["!autofilter"],o=typeof s.ref=="string"?s.ref:Er(s.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var l=t.Workbook.Names,c=Ra(o);c.s.r==c.e.r&&(c.e.r=Ra(r["!ref"]).e.r,o=Er(c));for(var d=0;d<l.length;++d){var f=l[d];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+t.SheetNames[n]+"'!"+o;break}}d==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+o}),We(e,161,Mi(lr(o))),We(e,162)}}function Zb(e,r,t){We(e,133),We(e,137,Mb(r,t)),We(e,138),We(e,134)}function Qb(e,r){r["!protect"]&&We(e,535,Hb(r["!protect"]))}function e4(e,r,t,n){var s=wa(),o=t.SheetNames[e],l=t.Sheets[o]||{},c=o;try{t&&t.Workbook&&(c=t.Workbook.Sheets[e].CodeName||c)}catch{}var d=lr(l["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(r.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],We(s,129),(t.vbaraw||l["!outline"])&&We(s,147,$y(c,l["!outline"])),We(s,148,qy(d)),Zb(s,l,t.Workbook),$b(s,l),Vb(s,l,e,r),Qb(s,l),Jb(s,l,t,e),Gb(s,l),Kb(s,l,n),l["!margins"]&&We(s,476,Rb(l["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&Yb(s,l),Xb(s,l,e,n),We(s,130),s.end()}function t4(e,r){e.l+=10;var t=oa(e);return{name:t}}var r4=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function a4(e){return!e.Workbook||!e.Workbook.WBProps?"false":Og(e.Workbook.WBProps.date1904)?"true":"false"}var n4="][*?/\\".split("");function c1(e,r){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return n4.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function s4(e,r,t){e.forEach(function(n,s){c1(n);for(var o=0;o<s;++o)if(n==e[o])throw new Error("Duplicate Sheet Name: "+n);if(t){var l=r&&r[s]&&r[s].CodeName||n;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function i4(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var r=e.Workbook&&e.Workbook.Sheets||[];s4(e.SheetNames,r,!!e.vbaraw);for(var t=0;t<e.SheetNames.length;++t)Ty(e.Sheets[e.SheetNames[t]],e.SheetNames[t],t)}function d1(e){var r=[Lr];r[r.length]=Ze("workbook",null,{xmlns:Ri[0],"xmlns:r":Hr.r});var t=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(r4.forEach(function(c){e.Workbook.WBProps[c[0]]!=null&&e.Workbook.WBProps[c[0]]!=c[1]&&(n[c[0]]=e.Workbook.WBProps[c[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),r[r.length]=Ze("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],o=0;if(s&&s[0]&&s[0].Hidden){for(r[r.length]="<bookViews>",o=0;o!=e.SheetNames.length&&!(!s[o]||!s[o].Hidden);++o);o==e.SheetNames.length&&(o=0),r[r.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",o=0;o!=e.SheetNames.length;++o){var l={name:Yt(e.SheetNames[o].slice(0,31))};if(l.sheetId=""+(o+1),l["r:id"]="rId"+(o+1),s[o])switch(s[o].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}r[r.length]=Ze("sheet",null,l)}return r[r.length]="</sheets>",t&&(r[r.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(c){var d={name:c.Name};c.Comment&&(d.comment=c.Comment),c.Sheet!=null&&(d.localSheetId=""+c.Sheet),c.Hidden&&(d.hidden="1"),c.Ref&&(r[r.length]=Ze("definedName",Yt(c.Ref),d))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function o4(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=K0(e),t.name=oa(e),t}function l4(e,r){return r||(r=Oe(127)),r.write_shift(4,e.Hidden),r.write_shift(4,e.iTabID),md(e.strRelID,r),zr(e.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function c4(e,r){var t={},n=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var s=r>8?oa(e):"";return s.length>0&&(t.CodeName=s),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function d4(e,r){r||(r=Oe(72));var t=0;return e&&e.filterPrivacy&&(t|=8),r.write_shift(4,t),r.write_shift(4,0),Nu(e&&e.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}function h4(e,r,t){var n=e.l+r;e.l+=4,e.l+=1;var s=e.read_shift(4),o=a2(e),l=Ny(e,0,t),c=ud(e);e.l=n;var d={Name:o,Ptg:l};return s<268435455&&(d.Sheet=s),c&&(d.Comment=c),d}function f4(e,r){We(e,143);for(var t=0;t!=r.SheetNames.length;++t){var n=r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t]&&r.Workbook.Sheets[t].Hidden||0,s={Hidden:n,iTabID:t+1,strRelID:"rId"+(t+1),name:r.SheetNames[t]};We(e,156,l4(s))}We(e,144)}function u4(e,r){r||(r=Oe(127));for(var t=0;t!=4;++t)r.write_shift(4,0);return zr("SheetJS",r),zr(tc.version,r),zr(tc.version,r),zr("7262",r),r.length>r.l?r.slice(0,r.l):r}function m4(e,r){r||(r=Oe(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,e),r.write_shift(4,e);var t=120;return r.write_shift(1,t),r.length>r.l?r.slice(0,r.l):r}function x4(e,r){if(!(!r.Workbook||!r.Workbook.Sheets)){for(var t=r.Workbook.Sheets,n=0,s=-1,o=-1;n<t.length;++n)!t[n]||!t[n].Hidden&&s==-1?s=n:t[n].Hidden==1&&o==-1&&(o=n);o>s||(We(e,135),We(e,158,m4(s)),We(e,136))}}function p4(e,r){var t=wa();return We(t,131),We(t,128,u4()),We(t,153,d4(e.Workbook&&e.Workbook.WBProps||null)),x4(t,e),f4(t,e),We(t,132),t.end()}function g4(e,r,t){return(r.slice(-4)===".bin"?p4:d1)(e)}function v4(e,r,t,n,s){return(r.slice(-4)===".bin"?e4:o1)(e,t,n,s)}function y4(e,r,t){return(r.slice(-4)===".bin"?Rv:Gu)(e,t)}function b4(e,r,t){return(r.slice(-4)===".bin"?dv:Wu)(e,t)}function w4(e,r,t){return(r.slice(-4)===".bin"?Qv:Ju)(e)}function N4(e){return(e.slice(-4)===".bin"?Vv:Ku)()}function j4(e,r){var t=[];return e.Props&&t.push(y2(e.Props,r)),e.Custprops&&t.push(b2(e.Props,e.Custprops)),t.join("")}function S4(){return""}function _4(e,r){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(n,s){var o=[];o.push(Ze("NumberFormat",null,{"ss:Format":Yt(pr[n.numFmtId])}));var l={"ss:ID":"s"+(21+s)};t.push(Ze("Style",o.join(""),l))}),Ze("Styles",t.join(""))}function h1(e){return Ze("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+vd(e.Ref,{r:0,c:0})})}function A4(e){if(!((e||{}).Workbook||{}).Names)return"";for(var r=e.Workbook.Names,t=[],n=0;n<r.length;++n){var s=r[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||t.push(h1(s)))}return Ze("Names",t.join(""))}function k4(e,r,t,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,o=[],l=0;l<s.length;++l){var c=s[l];c.Sheet==t&&(c.Name.match(/^_xlfn\./)||o.push(h1(c)))}return o.join("")}function T4(e,r,t,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Ze("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Ze("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Ze("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[t])if(n.Workbook.Sheets[t].Hidden)s.push(Ze("Visible",n.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<t&&!(n.Workbook.Sheets[o]&&!n.Workbook.Sheets[o].Hidden);++o);o==t&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Kr("ProtectContents","True")),e["!protect"].objects&&s.push(Kr("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Kr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Kr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Kr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&s.push("<"+l[1]+"/>")})),s.length==0?"":Ze("WorksheetOptions",s.join(""),{xmlns:Oa.x})}function C4(e){return e.map(function(r){var t=Pg(r.t||""),n=Ze("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ze("Comment",n,{"ss:Author":r.a})}).join("")}function E4(e,r,t,n,s,o,l){if(!e||e.v==null&&e.f==null)return"";var c={};if(e.f&&(c["ss:Formula"]="="+Yt(vd(e.f,l))),e.F&&e.F.slice(0,r.length)==r){var d=Wr(e.F.slice(r.length+1));c["ss:ArrayRange"]="RC:R"+(d.r==l.r?"":"["+(d.r-l.r)+"]")+"C"+(d.c==l.c?"":"["+(d.c-l.c)+"]")}if(e.l&&e.l.Target&&(c["ss:HRef"]=Yt(e.l.Target),e.l.Tooltip&&(c["x:HRefScreenTip"]=Yt(e.l.Tooltip))),t["!merges"])for(var f=t["!merges"],u=0;u!=f.length;++u)f[u].s.c!=l.c||f[u].s.r!=l.r||(f[u].e.c>f[u].s.c&&(c["ss:MergeAcross"]=f[u].e.c-f[u].s.c),f[u].e.r>f[u].s.r&&(c["ss:MergeDown"]=f[u].e.r-f[u].s.r));var g="",p="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":g="Number",p=String(e.v);break;case"b":g="Boolean",p=e.v?"1":"0";break;case"e":g="Error",p=qo[e.v];break;case"d":g="DateTime",p=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||pr[14]);break;case"s":g="String",p=Fg(e.v||"");break}var m=Ss(n.cellXfs,e,n);c["ss:StyleID"]="s"+(21+m),c["ss:Index"]=l.c+1;var j=e.v!=null?p:"",v=e.t=="z"?"":'<Data ss:Type="'+g+'">'+j+"</Data>";return(e.c||[]).length>0&&(v+=C4(e.c)),Ze("Cell",v,c)}function L4(e,r){var t='<Row ss:Index="'+(e+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=Vu(r.hpt)),r.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(t+=' ss:Hidden="1"')),t+">"}function F4(e,r,t,n){if(!e["!ref"])return"";var s=lr(e["!ref"]),o=e["!merges"]||[],l=0,c=[];e["!cols"]&&e["!cols"].forEach(function(N,b){pd(N);var y=!!N.width,_=Ac(b,N),T={"ss:Index":b+1};y&&(T["ss:Width"]=hc(_.width)),N.hidden&&(T["ss:Hidden"]="1"),c.push(Ze("Column",null,T))});for(var d=Array.isArray(e),f=s.s.r;f<=s.e.r;++f){for(var u=[L4(f,(e["!rows"]||[])[f])],g=s.s.c;g<=s.e.c;++g){var p=!1;for(l=0;l!=o.length;++l)if(!(o[l].s.c>g)&&!(o[l].s.r>f)&&!(o[l].e.c<g)&&!(o[l].e.r<f)){(o[l].s.c!=g||o[l].s.r!=f)&&(p=!0);break}if(!p){var m={r:f,c:g},j=Kt(m),v=d?(e[f]||[])[g]:e[j];u.push(E4(v,j,e,r,t,n,m))}}u.push("</Row>"),u.length>2&&c.push(u.join(""))}return c.join("")}function P4(e,r,t){var n=[],s=t.SheetNames[e],o=t.Sheets[s],l=o?k4(o,r,e,t):"";return l.length>0&&n.push("<Names>"+l+"</Names>"),l=o?F4(o,r,e,t):"",l.length>0&&n.push("<Table>"+l+"</Table>"),n.push(T4(o,r,e,t)),n.join("")}function O4(e,r){r||(r={}),e.SSF||(e.SSF=ja(pr)),e.SSF&&(wc(),bc(e.SSF),r.revssf=Nc(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF,r.cellXfs=[],Ss(r.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(j4(e,r)),t.push(S4()),t.push(""),t.push("");for(var n=0;n<e.SheetNames.length;++n)t.push(Ze("Worksheet",P4(n,r,e),{"ss:Name":Yt(e.SheetNames[n])}));return t[2]=_4(e,r),t[3]=A4(e),Lr+Ze("Workbook",t.join(""),{xmlns:Oa.ss,"xmlns:o":Oa.o,"xmlns:x":Oa.x,"xmlns:ss":Oa.ss,"xmlns:dt":Oa.dt,"xmlns:html":Oa.html})}var C0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function I4(e,r){var t=[],n=[],s=[],o=0,l,c=Rh(Xh,"n"),d=Rh(Jh,"n");if(e.Props)for(l=Jr(e.Props),o=0;o<l.length;++o)(Object.prototype.hasOwnProperty.call(c,l[o])?t:Object.prototype.hasOwnProperty.call(d,l[o])?n:s).push([l[o],e.Props[l[o]]]);if(e.Custprops)for(l=Jr(e.Custprops),o=0;o<l.length;++o)Object.prototype.hasOwnProperty.call(e.Props||{},l[o])||(Object.prototype.hasOwnProperty.call(c,l[o])?t:Object.prototype.hasOwnProperty.call(d,l[o])?n:s).push([l[o],e.Custprops[l[o]]]);var f=[];for(o=0;o<s.length;++o)Iu.indexOf(s[o][0])>-1||Fu.indexOf(s[o][0])>-1||s[o][1]!=null&&f.push(s[o]);n.length&&Zt.utils.cfb_add(r,"/SummaryInformation",rf(n,C0.SI,d,Jh)),(t.length||f.length)&&Zt.utils.cfb_add(r,"/DocumentSummaryInformation",rf(t,C0.DSI,c,Xh,f.length?f:null,C0.UDI))}function D4(e,r){var t=r||{},n=Zt.utils.cfb_new({root:"R"}),s="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":s="/Workbook",t.biff=8;break;case"biff5":s="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Zt.utils.cfb_add(n,s,f1(e,t)),t.biff==8&&(e.Props||e.Custprops)&&I4(e,n),t.biff==8&&e.vbaraw&&e5(n,Zt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var R4={0:{f:Uy},1:{f:Yy},2:{f:mb},3:{f:rb},4:{f:Zy},5:{f:db},6:{f:yb},7:{f:ib},8:{f:Ab},9:{f:_b},10:{f:jb},11:{f:Sb},12:{f:Xy},13:{f:pb},14:{f:nb},15:{f:eb},16:{f:fb},17:{f:wb},18:{f:lb},19:{f:fd},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:h4},40:{},42:{},43:{f:yv},44:{f:gv},45:{f:Nv},46:{f:Sv},47:{f:jv},48:{},49:{f:Xg},50:{},51:{f:Uv},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:J2},62:{f:vb},63:{f:Gv},64:{f:Wb},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:En,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Bb},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Gy},148:{f:zy,p:16},151:{f:Fb},152:{},153:{f:c4},154:{},155:{},156:{f:o4},157:{},158:{},159:{T:1,f:ov},160:{T:-1},161:{T:1,f:Js},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:kb},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Bv},336:{T:-1},337:{f:zv,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:K0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:V2},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Pb},427:{f:Ob},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Db},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Vy},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Eb},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:K0},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Jv},633:{T:1},634:{T:-1},635:{T:1,f:Kv},636:{T:-1},637:{f:e2},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:t4},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:zb},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Qe(e,r,t,n){var s=r;if(!isNaN(s)){var o=n||(t||[]).length||0,l=e.next(4);l.write_shift(2,s),l.write_shift(2,o),o>0&&cd(t)&&e.push(t)}}function B4(e,r,t,n){var s=(t||[]).length||0;if(s<=8224)return Qe(e,r,t,s);var o=r;if(!isNaN(o)){for(var l=t.parts||[],c=0,d=0,f=0;f+(l[c]||8224)<=8224;)f+=l[c]||8224,c++;var u=e.next(4);for(u.write_shift(2,o),u.write_shift(2,f),e.push(t.slice(d,d+f)),d+=f;d<s;){for(u=e.next(4),u.write_shift(2,60),f=0;f+(l[c]||8224)<=8224;)f+=l[c]||8224,c++;u.write_shift(2,f),e.push(t.slice(d,d+f)),d+=f}}}function Go(e,r,t){return e||(e=Oe(7)),e.write_shift(2,r),e.write_shift(2,t),e.write_shift(2,0),e.write_shift(1,0),e}function M4(e,r,t,n){var s=Oe(9);return Go(s,e,r),Ru(t,n||"b",s),s}function U4(e,r,t){var n=Oe(8+2*t.length);return Go(n,e,r),n.write_shift(1,t.length),n.write_shift(t.length,t,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function H4(e,r,t,n){if(r.v!=null)switch(r.t){case"d":case"n":var s=r.t=="d"?Na(ua(r.v)):r.v;s==(s|0)&&s>=0&&s<65536?Qe(e,2,tv(t,n,s)):Qe(e,3,ev(t,n,s));return;case"b":case"e":Qe(e,5,M4(t,n,r.v,r.t));return;case"s":case"str":Qe(e,4,U4(t,n,(r.v||"").slice(0,255)));return}Qe(e,1,Go(null,t,n))}function W4(e,r,t,n){var s=Array.isArray(r),o=lr(r["!ref"]||"A1"),l,c="",d=[];if(o.e.c>255||o.e.r>16383){if(n.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),l=Er(o)}for(var f=o.s.r;f<=o.e.r;++f){c=Xr(f);for(var u=o.s.c;u<=o.e.c;++u){f===o.s.r&&(d[u]=ia(u)),l=d[u]+c;var g=s?(r[f]||[])[u]:r[l];g&&H4(e,g,f,u)}}}function z4(e,r){for(var t=r||{},n=wa(),s=0,o=0;o<e.SheetNames.length;++o)e.SheetNames[o]==t.sheet&&(s=o);if(s==0&&t.sheet&&e.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return Qe(n,t.biff==4?1033:t.biff==3?521:9,xd(e,16,t)),W4(n,e.Sheets[e.SheetNames[s]],s,t),Qe(n,10),n.end()}function q4(e,r,t){Qe(e,49,R2({sz:12,name:"Arial"},t))}function V4(e,r,t){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)r[s]!=null&&Qe(e,1054,U2(s,r[s],t))})}function G4(e,r){var t=Oe(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),Qe(e,2151,t),t=Oe(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),Uu(lr(r["!ref"]||"A1"),t),t.write_shift(4,4),Qe(e,2152,t)}function $4(e,r){for(var t=0;t<16;++t)Qe(e,224,nf({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(n){Qe(e,224,nf(n,0,r))})}function Y4(e,r){for(var t=0;t<r["!links"].length;++t){var n=r["!links"][t];Qe(e,440,Y2(n)),n[1].Tooltip&&Qe(e,2048,K2(n))}delete r["!links"]}function K4(e,r){if(r){var t=0;r.forEach(function(n,s){++t<=256&&n&&Qe(e,125,Z2(Ac(s,n),s))})}}function X4(e,r,t,n,s){var o=16+Ss(s.cellXfs,r,s);if(r.v==null&&!r.bf){Qe(e,513,Vs(t,n,o));return}if(r.bf)Qe(e,6,by(r,t,n,s,o));else switch(r.t){case"d":case"n":var l=r.t=="d"?Na(ua(r.v)):r.v;Qe(e,515,q2(t,n,l,o));break;case"b":case"e":Qe(e,517,z2(t,n,r.v,o,s,r.t));break;case"s":case"str":if(s.bookSST){var c=bd(s.Strings,r.v,s.revStrings);Qe(e,253,B2(t,n,c,o))}else Qe(e,516,M2(t,n,(r.v||"").slice(0,255),o,s));break;default:Qe(e,513,Vs(t,n,o))}}function J4(e,r,t){var n=wa(),s=t.SheetNames[e],o=t.Sheets[s]||{},l=(t||{}).Workbook||{},c=(l.Sheets||[])[e]||{},d=Array.isArray(o),f=r.biff==8,u,g="",p=[],m=lr(o["!ref"]||"A1"),j=f?65536:16384;if(m.e.c>255||m.e.r>=j){if(r.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,j-1)}Qe(n,2057,xd(t,16,r)),Qe(n,13,Ka(1)),Qe(n,12,Ka(100)),Qe(n,15,fa(!0)),Qe(n,17,fa(!1)),Qe(n,16,qs(.001)),Qe(n,95,fa(!0)),Qe(n,42,fa(!1)),Qe(n,43,fa(!1)),Qe(n,130,Ka(1)),Qe(n,128,W2()),Qe(n,131,fa(!1)),Qe(n,132,fa(!1)),f&&K4(n,o["!cols"]),Qe(n,512,H2(m,r)),f&&(o["!links"]=[]);for(var v=m.s.r;v<=m.e.r;++v){g=Xr(v);for(var N=m.s.c;N<=m.e.c;++N){v===m.s.r&&(p[N]=ia(N)),u=p[N]+g;var b=d?(o[v]||[])[N]:o[u];b&&(X4(n,b,v,N,r),f&&b.l&&o["!links"].push([u,b.l]))}}var y=c.CodeName||c.name||s;return f&&Qe(n,574,D2((l.Views||[])[0])),f&&(o["!merges"]||[]).length&&Qe(n,229,$2(o["!merges"])),f&&Y4(n,o),Qe(n,442,Mu(y)),f&&G4(n,o),Qe(n,10),n.end()}function Z4(e,r,t){var n=wa(),s=(e||{}).Workbook||{},o=s.Sheets||[],l=s.WBProps||{},c=t.biff==8,d=t.biff==5;if(Qe(n,2057,xd(e,5,t)),t.bookType=="xla"&&Qe(n,135),Qe(n,225,c?Ka(1200):null),Qe(n,193,j2(2)),d&&Qe(n,191),d&&Qe(n,192),Qe(n,226),Qe(n,92,F2("SheetJS",t)),Qe(n,66,Ka(c?1200:1252)),c&&Qe(n,353,Ka(0)),c&&Qe(n,448),Qe(n,317,Q2(e.SheetNames.length)),c&&e.vbaraw&&Qe(n,211),c&&e.vbaraw){var f=l.CodeName||"ThisWorkbook";Qe(n,442,Mu(f))}Qe(n,156,Ka(17)),Qe(n,25,fa(!1)),Qe(n,18,fa(!1)),Qe(n,19,Ka(0)),c&&Qe(n,431,fa(!1)),c&&Qe(n,444,Ka(0)),Qe(n,61,I2()),Qe(n,64,fa(!1)),Qe(n,141,Ka(0)),Qe(n,34,fa(a4(e)=="true")),Qe(n,14,fa(!0)),c&&Qe(n,439,fa(!1)),Qe(n,218,Ka(0)),q4(n,e,t),V4(n,e.SSF,t),$4(n,t),c&&Qe(n,352,fa(!1));var u=n.end(),g=wa();c&&Qe(g,140,X2()),c&&t.Strings&&B4(g,252,O2(t.Strings)),Qe(g,10);var p=g.end(),m=wa(),j=0,v=0;for(v=0;v<e.SheetNames.length;++v)j+=(c?12:11)+(c?2:1)*e.SheetNames[v].length;var N=u.length+j+p.length;for(v=0;v<e.SheetNames.length;++v){var b=o[v]||{};Qe(m,133,P2({pos:N,hs:b.Hidden||0,dt:0,name:e.SheetNames[v]},t)),N+=r[v].length}var y=m.end();if(j!=y.length)throw new Error("BS8 "+j+" != "+y.length);var _=[];return u.length&&_.push(u),y.length&&_.push(y),p.length&&_.push(p),Yr(_)}function Q4(e,r){var t=r||{},n=[];e&&!e.SSF&&(e.SSF=ja(pr)),e&&e.SSF&&(wc(),bc(e.SSF),t.revssf=Nc(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,wd(t),t.cellXfs=[],Ss(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=J4(s,t,e);return n.unshift(Z4(e,n,t)),Yr(n)}function f1(e,r){for(var t=0;t<=e.SheetNames.length;++t){var n=e.Sheets[e.SheetNames[t]];if(!(!n||!n["!ref"])){var s=Ra(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var o=r||{};switch(o.biff||2){case 8:case 5:return Q4(e,r);case 4:case 3:case 2:return z4(e,r)}throw new Error("invalid type "+o.bookType+" for BIFF")}function ew(e,r,t,n){for(var s=e["!merges"]||[],o=[],l=r.s.c;l<=r.e.c;++l){for(var c=0,d=0,f=0;f<s.length;++f)if(!(s[f].s.r>t||s[f].s.c>l)&&!(s[f].e.r<t||s[f].e.c<l)){if(s[f].s.r<t||s[f].s.c<l){c=-1;break}c=s[f].e.r-s[f].s.r+1,d=s[f].e.c-s[f].s.c+1;break}if(!(c<0)){var u=Kt({r:t,c:l}),g=n.dense?(e[t]||[])[l]:e[u],p=g&&g.v!=null&&(g.h||Lg(g.w||(Yn(g),g.w)||""))||"",m={};c>1&&(m.rowspan=c),d>1&&(m.colspan=d),n.editable?p='<span contenteditable="true">'+p+"</span>":g&&(m["data-t"]=g&&g.t||"z",g.v!=null&&(m["data-v"]=g.v),g.z!=null&&(m["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+g.l.Target+'">'+p+"</a>")),m.id=(n.id||"sjs")+"-"+u,o.push(Ze("td",p,m))}}var j="<tr>";return j+o.join("")+"</tr>"}var tw='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',rw="</body></html>";function aw(e,r,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function u1(e,r){var t=r||{},n=t.header!=null?t.header:tw,s=t.footer!=null?t.footer:rw,o=[n],l=Ra(e["!ref"]);t.dense=Array.isArray(e),o.push(aw(e,l,t));for(var c=l.s.r;c<=l.e.r;++c)o.push(ew(e,l,c,t));return o.push("</table>"+s),o.join("")}function m1(e,r,t){var n=t||{},s=0,o=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?Wr(n.origin):n.origin;s=l.r,o=l.c}var c=r.getElementsByTagName("tr"),d=Math.min(n.sheetRows||1e7,c.length),f={s:{r:0,c:0},e:{r:s,c:o}};if(e["!ref"]){var u=Ra(e["!ref"]);f.s.r=Math.min(f.s.r,u.s.r),f.s.c=Math.min(f.s.c,u.s.c),f.e.r=Math.max(f.e.r,u.e.r),f.e.c=Math.max(f.e.c,u.e.c),s==-1&&(f.e.r=s=u.e.r+1)}var g=[],p=0,m=e["!rows"]||(e["!rows"]=[]),j=0,v=0,N=0,b=0,y=0,_=0;for(e["!cols"]||(e["!cols"]=[]);j<c.length&&v<d;++j){var T=c[j];if(ff(T)){if(n.display)continue;m[v]={hidden:!0}}var O=T.children;for(N=b=0;N<O.length;++N){var B=O[N];if(!(n.display&&ff(B))){var L=B.hasAttribute("data-v")?B.getAttribute("data-v"):B.hasAttribute("v")?B.getAttribute("v"):Ig(B.innerHTML),E=B.getAttribute("data-z")||B.getAttribute("z");for(p=0;p<g.length;++p){var P=g[p];P.s.c==b+o&&P.s.r<v+s&&v+s<=P.e.r&&(b=P.e.c+1-o,p=-1)}_=+B.getAttribute("colspan")||1,((y=+B.getAttribute("rowspan")||1)>1||_>1)&&g.push({s:{r:v+s,c:b+o},e:{r:v+s+(y||1)-1,c:b+o+(_||1)-1}});var D={t:"s",v:L},k=B.getAttribute("data-t")||B.getAttribute("t")||"";L!=null&&(L.length==0?D.t=k||"z":n.raw||L.trim().length==0||k=="s"||(L==="TRUE"?D={t:"b",v:!0}:L==="FALSE"?D={t:"b",v:!1}:isNaN(Vn(L))?isNaN(Do(L).getDate())||(D={t:"d",v:ua(L)},n.cellDates||(D={t:"n",v:Na(D.v)}),D.z=n.dateNF||pr[14]):D={t:"n",v:Vn(L)})),D.z===void 0&&E!=null&&(D.z=E);var C="",z=B.getElementsByTagName("A");if(z&&z.length)for(var G=0;G<z.length&&!(z[G].hasAttribute("href")&&(C=z[G].getAttribute("href"),C.charAt(0)!="#"));++G);C&&C.charAt(0)!="#"&&(D.l={Target:C}),n.dense?(e[v+s]||(e[v+s]=[]),e[v+s][b+o]=D):e[Kt({c:b+o,r:v+s})]=D,f.e.c<b+o&&(f.e.c=b+o),b+=_}}++v}return g.length&&(e["!merges"]=(e["!merges"]||[]).concat(g)),f.e.r=Math.max(f.e.r,v-1+s),e["!ref"]=Er(f),v>=d&&(e["!fullref"]=Er((f.e.r=c.length-j+v-1+s,f))),e}function x1(e,r){var t=r||{},n=t.dense?[]:{};return m1(n,e,r)}function nw(e,r){return $s(x1(e,r),r)}function ff(e){var r="",t=sw(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function sw(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var iw=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+Bo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Lr+r}}(),uf=function(){var e=function(o){return Yt(o).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,n=function(o,l,c){var d=[];d.push('      <table:table table:name="'+Yt(l.SheetNames[c])+`" table:style-name="ta1">
`);var f=0,u=0,g=Ra(o["!ref"]||"A1"),p=o["!merges"]||[],m=0,j=Array.isArray(o);if(o["!cols"])for(u=0;u<=g.e.c;++u)d.push("        <table:table-column"+(o["!cols"][u]?' table:style-name="co'+o["!cols"][u].ods+'"':"")+`></table:table-column>
`);var v="",N=o["!rows"]||[];for(f=0;f<g.s.r;++f)v=N[f]?' table:style-name="ro'+N[f].ods+'"':"",d.push("        <table:table-row"+v+`></table:table-row>
`);for(;f<=g.e.r;++f){for(v=N[f]?' table:style-name="ro'+N[f].ods+'"':"",d.push("        <table:table-row"+v+`>
`),u=0;u<g.s.c;++u)d.push(r);for(;u<=g.e.c;++u){var b=!1,y={},_="";for(m=0;m!=p.length;++m)if(!(p[m].s.c>u)&&!(p[m].s.r>f)&&!(p[m].e.c<u)&&!(p[m].e.r<f)){(p[m].s.c!=u||p[m].s.r!=f)&&(b=!0),y["table:number-columns-spanned"]=p[m].e.c-p[m].s.c+1,y["table:number-rows-spanned"]=p[m].e.r-p[m].s.r+1;break}if(b){d.push(t);continue}var T=Kt({r:f,c:u}),O=j?(o[f]||[])[u]:o[T];if(O&&O.f&&(y["table:formula"]=Yt(Ay(O.f)),O.F&&O.F.slice(0,T.length)==T)){var B=Ra(O.F);y["table:number-matrix-columns-spanned"]=B.e.c-B.s.c+1,y["table:number-matrix-rows-spanned"]=B.e.r-B.s.r+1}if(!O){d.push(r);continue}switch(O.t){case"b":_=O.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=O.v?"true":"false";break;case"n":_=O.w||String(O.v||0),y["office:value-type"]="float",y["office:value"]=O.v||0;break;case"s":case"str":_=O.v==null?"":O.v,y["office:value-type"]="string";break;case"d":_=O.w||ua(O.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=ua(O.v).toISOString(),y["table:style-name"]="ce1";break;default:d.push(r);continue}var L=e(_);if(O.l&&O.l.Target){var E=O.l.Target;E=E.charAt(0)=="#"?"#"+ky(E.slice(1)):E,E.charAt(0)!="#"&&!E.match(/^\w+:/)&&(E="../"+E),L=Ze("text:a",L,{"xlink:href":E.replace(/&/g,"&amp;")})}d.push("          "+Ze("table:table-cell",Ze("text:p",L,{}),y)+`
`)}d.push(`        </table:table-row>
`)}return d.push(`      </table:table>
`),d.join("")},s=function(o,l){o.push(` <office:automatic-styles>
`),o.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),o.push(`   <number:month number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:day number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:year/>
`),o.push(`  </number:date-style>
`);var c=0;l.SheetNames.map(function(f){return l.Sheets[f]}).forEach(function(f){if(f&&f["!cols"]){for(var u=0;u<f["!cols"].length;++u)if(f["!cols"][u]){var g=f["!cols"][u];if(g.width==null&&g.wpx==null&&g.wch==null)continue;pd(g),g.ods=c;var p=f["!cols"][u].wpx+"px";o.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),o.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),o.push(`  </style:style>
`),++c}}});var d=0;l.SheetNames.map(function(f){return l.Sheets[f]}).forEach(function(f){if(f&&f["!rows"]){for(var u=0;u<f["!rows"].length;++u)if(f["!rows"][u]){f["!rows"][u].ods=d;var g=f["!rows"][u].hpx+"px";o.push('  <style:style style:name="ro'+d+`" style:family="table-row">
`),o.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+g+`"/>
`),o.push(`  </style:style>
`),++d}}}),o.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),o.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),o.push(`  </style:style>
`),o.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),o.push(` </office:automatic-styles>
`)};return function(l,c){var d=[Lr],f=Bo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Bo({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(d.push("<office:document"+f+u+`>
`),d.push(Eu().replace(/office:document-meta/g,"office:meta"))):d.push("<office:document-content"+f+`>
`),s(d,l),d.push(`  <office:body>
`),d.push(`    <office:spreadsheet>
`);for(var g=0;g!=l.SheetNames.length;++g)d.push(n(l.Sheets[l.SheetNames[g]],l,g));return d.push(`    </office:spreadsheet>
`),d.push(`  </office:body>
`),c.bookType=="fods"?d.push("</office:document>"):d.push("</office:document-content>"),d.join("")}}();function p1(e,r){if(r.bookType=="fods")return uf(e,r);var t=sd(),n="",s=[],o=[];return n="mimetype",Et(t,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Et(t,n,uf(e,r)),s.push([n,"text/xml"]),o.push([n,"ContentFile"]),n="styles.xml",Et(t,n,iw(e,r)),s.push([n,"text/xml"]),o.push([n,"StylesFile"]),n="meta.xml",Et(t,n,Lr+Eu()),s.push([n,"text/xml"]),o.push([n,"MetadataFile"]),n="manifest.rdf",Et(t,n,v2(o)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Et(t,n,p2(s)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function mc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function ow(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):fn(Ro(e))}function lw(e,r){e:for(var t=0;t<=e.length-r.length;++t){for(var n=0;n<r.length;++n)if(e[t+n]!=r[n])continue e;return!0}return!1}function js(e){var r=e.reduce(function(s,o){return s+o.length},0),t=new Uint8Array(r),n=0;return e.forEach(function(s){t.set(s,n),n+=s.length}),t}function cw(e,r,t){var n=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,s=t/Math.pow(10,n-6176);e[r+15]|=n>>7,e[r+14]|=(n&127)<<1;for(var o=0;s>=1;++o,s/=256)e[r+o]=s&255;e[r+15]|=t>=0?0:128}function Mo(e,r){var t=r?r[0]:0,n=e[t]&127;e:if(e[t++]>=128&&(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),n}function Gt(e){var r=new Uint8Array(7);r[0]=e&127;var t=1;e:if(e>127){if(r[t-1]|=128,r[t]=e>>7&127,++t,e<=16383||(r[t-1]|=128,r[t]=e>>14&127,++t,e<=2097151)||(r[t-1]|=128,r[t]=e>>21&127,++t,e<=268435455)||(r[t-1]|=128,r[t]=e/256>>>21&127,++t,e<=34359738367)||(r[t-1]|=128,r[t]=e/65536>>>21&127,++t,e<=4398046511103))break e;r[t-1]|=128,r[t]=e/16777216>>>21&127,++t}return r.slice(0,t)}function Oi(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function Dr(e){for(var r=[],t=[0];t[0]<e.length;){var n=t[0],s=Mo(e,t),o=s&7;s=Math.floor(s/8);var l=0,c;if(s==0)break;switch(o){case 0:{for(var d=t[0];e[t[0]++]>=128;);c=e.slice(d,t[0])}break;case 5:l=4,c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 1:l=8,c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 2:l=Mo(e,t),c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(s," at offset ").concat(n))}var f={data:c,type:o};r[s]==null?r[s]=[f]:r[s].push(f)}return r}function Gr(e){var r=[];return e.forEach(function(t,n){t.forEach(function(s){s.data&&(r.push(Gt(n*8+s.type)),s.type==2&&r.push(Gt(s.data.length)),r.push(s.data))})}),js(r)}function ln(e){for(var r,t=[],n=[0];n[0]<e.length;){var s=Mo(e,n),o=Dr(e.slice(n[0],n[0]+s));n[0]+=s;var l={id:Oi(o[1][0].data),messages:[]};o[2].forEach(function(c){var d=Dr(c.data),f=Oi(d[3][0].data);l.messages.push({meta:d,data:e.slice(n[0],n[0]+f)}),n[0]+=f}),(r=o[3])!=null&&r[0]&&(l.merge=Oi(o[3][0].data)>>>0>0),t.push(l)}return t}function ji(e){var r=[];return e.forEach(function(t){var n=[];n[1]=[{data:Gt(t.id),type:0}],n[2]=[],t.merge!=null&&(n[3]=[{data:Gt(+!!t.merge),type:0}]);var s=[];t.messages.forEach(function(l){s.push(l.data),l.meta[3]=[{type:0,data:Gt(l.data.length)}],n[2].push({data:Gr(l.meta),type:2})});var o=Gr(n);r.push(Gt(o.length)),r.push(o),s.forEach(function(l){return r.push(l)})}),js(r)}function dw(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],n=Mo(r,t),s=[];t[0]<r.length;){var o=r[t[0]]&3;if(o==0){var l=r[t[0]++]>>2;if(l<60)++l;else{var c=l-59;l=r[t[0]],c>1&&(l|=r[t[0]+1]<<8),c>2&&(l|=r[t[0]+2]<<16),c>3&&(l|=r[t[0]+3]<<24),l>>>=0,l++,t[0]+=c}s.push(r.slice(t[0],t[0]+l)),t[0]+=l;continue}else{var d=0,f=0;if(o==1?(f=(r[t[0]]>>2&7)+4,d=(r[t[0]++]&224)<<3,d|=r[t[0]++]):(f=(r[t[0]++]>>2)+1,o==2?(d=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(d=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),s=[js(s)],d==0)throw new Error("Invalid offset 0");if(d>s[0].length)throw new Error("Invalid offset beyond length");if(f>=d)for(s.push(s[0].slice(-d)),f-=d;f>=s[s.length-1].length;)s.push(s[s.length-1]),f-=s[s.length-1].length;s.push(s[0].slice(-d,-d+f))}}var u=js(s);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function cn(e){for(var r=[],t=0;t<e.length;){var n=e[t++],s=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(dw(n,e.slice(t,t+s))),t+=s}if(t!==e.length)throw new Error("data is not a valid framed stream!");return js(r)}function Si(e){for(var r=[],t=0;t<e.length;){var n=Math.min(e.length-t,268435455),s=new Uint8Array(4);r.push(s);var o=Gt(n),l=o.length;r.push(o),n<=60?(l++,r.push(new Uint8Array([n-1<<2]))):n<=256?(l+=2,r.push(new Uint8Array([240,n-1&255]))):n<=65536?(l+=3,r.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(l+=4,r.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(l+=5,r.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),r.push(e.slice(t,t+n)),l+=n,s[0]=0,s[1]=l&255,s[2]=l>>8&255,s[3]=l>>16&255,t+=n}return js(r)}function E0(e,r){var t=new Uint8Array(32),n=mc(t),s=12,o=0;switch(t[0]=5,e.t){case"n":t[1]=2,cw(t,s,e.v),o|=1,s+=16;break;case"b":t[1]=6,n.setFloat64(s,e.v?1:0,!0),o|=2,s+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[1]=3,n.setUint32(s,r.indexOf(e.v),!0),o|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,o,!0),t.slice(0,s)}function L0(e,r){var t=new Uint8Array(32),n=mc(t),s=12,o=0;switch(t[0]=3,e.t){case"n":t[2]=2,n.setFloat64(s,e.v,!0),o|=32,s+=8;break;case"b":t[2]=6,n.setFloat64(s,e.v?1:0,!0),o|=32,s+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[2]=3,n.setUint32(s,r.indexOf(e.v),!0),o|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,o,!0),t.slice(0,s)}function fs(e){var r=Dr(e);return Mo(r[1][0].data)}function hw(e,r,t){var n,s,o,l;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var c=((l=(o=e[8])==null?void 0:o[0])==null?void 0:l.data)&&Oi(e[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var d=0,f=mc(e[7][0].data),u=0,g=[],p=mc(e[4][0].data),m=0,j=[],v=0;v<r.length;++v){if(r[v]==null){f.setUint16(v*2,65535,!0),p.setUint16(v*2,65535);continue}f.setUint16(v*2,u,!0),p.setUint16(v*2,m,!0);var N,b;switch(typeof r[v]){case"string":N=E0({t:"s",v:r[v]},t),b=L0({t:"s",v:r[v]},t);break;case"number":N=E0({t:"n",v:r[v]},t),b=L0({t:"n",v:r[v]},t);break;case"boolean":N=E0({t:"b",v:r[v]},t),b=L0({t:"b",v:r[v]},t);break;default:throw new Error("Unsupported value "+r[v])}g.push(N),u+=N.length,j.push(b),m+=b.length,++d}for(e[2][0].data=Gt(d);v<e[7][0].data.length/2;++v)f.setUint16(v*2,65535,!0),p.setUint16(v*2,65535,!0);return e[6][0].data=js(g),e[3][0].data=js(j),d}function fw(e,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ra(t["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Er(n)));var o=xc(t,{range:n,header:1}),l=["~Sh33tJ5~"];o.forEach(function(I){return I.forEach(function(R){typeof R=="string"&&l.push(R)})});var c={},d=[],f=Zt.read(r.numbers,{type:"base64"});f.FileIndex.map(function(I,R){return[I,f.FullPaths[R]]}).forEach(function(I){var R=I[0],M=I[1];if(R.type==2&&R.name.match(/\.iwa/)){var K=R.content,he=cn(K),fe=ln(he);fe.forEach(function(ee){d.push(ee.id),c[ee.id]={deps:[],location:M,type:Oi(ee.messages[0].meta[1][0].data)}})}}),d.sort(function(I,R){return I-R});var u=d.filter(function(I){return I>1}).map(function(I){return[I,Gt(I)]});f.FileIndex.map(function(I,R){return[I,f.FullPaths[R]]}).forEach(function(I){var R=I[0];if(I[1],!!R.name.match(/\.iwa/)){var M=ln(cn(R.content));M.forEach(function(K){K.messages.forEach(function(he){u.forEach(function(fe){K.messages.some(function(ee){return Oi(ee.meta[1][0].data)!=11006&&lw(ee.data,fe[1])})&&c[fe[0]].deps.push(K.id)})})})}});for(var g=Zt.find(f,c[1].location),p=ln(cn(g.content)),m,j=0;j<p.length;++j){var v=p[j];v.id==1&&(m=v)}var N=fs(Dr(m.messages[0].data)[1][0].data);for(g=Zt.find(f,c[N].location),p=ln(cn(g.content)),j=0;j<p.length;++j)v=p[j],v.id==N&&(m=v);for(N=fs(Dr(m.messages[0].data)[2][0].data),g=Zt.find(f,c[N].location),p=ln(cn(g.content)),j=0;j<p.length;++j)v=p[j],v.id==N&&(m=v);for(N=fs(Dr(m.messages[0].data)[2][0].data),g=Zt.find(f,c[N].location),p=ln(cn(g.content)),j=0;j<p.length;++j)v=p[j],v.id==N&&(m=v);var b=Dr(m.messages[0].data);{b[6][0].data=Gt(n.e.r+1),b[7][0].data=Gt(n.e.c+1);var y=fs(b[46][0].data),_=Zt.find(f,c[y].location),T=ln(cn(_.content));{for(var O=0;O<T.length&&T[O].id!=y;++O);if(T[O].id!=y)throw"Bad ColumnRowUIDMapArchive";var B=Dr(T[O].messages[0].data);B[1]=[],B[2]=[],B[3]=[];for(var L=0;L<=n.e.c;++L){var E=[];E[1]=E[2]=[{type:0,data:Gt(L+420690)}],B[1].push({type:2,data:Gr(E)}),B[2].push({type:0,data:Gt(L)}),B[3].push({type:0,data:Gt(L)})}B[4]=[],B[5]=[],B[6]=[];for(var P=0;P<=n.e.r;++P)E=[],E[1]=E[2]=[{type:0,data:Gt(P+726270)}],B[4].push({type:2,data:Gr(E)}),B[5].push({type:0,data:Gt(P)}),B[6].push({type:0,data:Gt(P)});T[O].messages[0].data=Gr(B)}_.content=Si(ji(T)),_.size=_.content.length,delete b[46];var D=Dr(b[4][0].data);{D[7][0].data=Gt(n.e.r+1);var k=Dr(D[1][0].data),C=fs(k[2][0].data);_=Zt.find(f,c[C].location),T=ln(cn(_.content));{if(T[0].id!=C)throw"Bad HeaderStorageBucket";var z=Dr(T[0].messages[0].data);for(P=0;P<o.length;++P){var G=Dr(z[2][0].data);G[1][0].data=Gt(P),G[4][0].data=Gt(o[P].length),z[2][P]={type:z[2][0].type,data:Gr(G)}}T[0].messages[0].data=Gr(z)}_.content=Si(ji(T)),_.size=_.content.length;var de=fs(D[2][0].data);_=Zt.find(f,c[de].location),T=ln(cn(_.content));{if(T[0].id!=de)throw"Bad HeaderStorageBucket";for(z=Dr(T[0].messages[0].data),L=0;L<=n.e.c;++L)G=Dr(z[2][0].data),G[1][0].data=Gt(L),G[4][0].data=Gt(n.e.r+1),z[2][L]={type:z[2][0].type,data:Gr(G)};T[0].messages[0].data=Gr(z)}_.content=Si(ji(T)),_.size=_.content.length;var J=fs(D[4][0].data);(function(){for(var I=Zt.find(f,c[J].location),R=ln(cn(I.content)),M,K=0;K<R.length;++K){var he=R[K];he.id==J&&(M=he)}var fe=Dr(M.messages[0].data);{fe[3]=[];var ee=[];l.forEach(function(De,$e){ee[1]=[{type:0,data:Gt($e)}],ee[2]=[{type:0,data:Gt(1)}],ee[3]=[{type:2,data:ow(De)}],fe[3].push({type:2,data:Gr(ee)})})}M.messages[0].data=Gr(fe);var ve=ji(R),Ce=Si(ve);I.content=Ce,I.size=I.content.length})();var Z=Dr(D[3][0].data);{var oe=Z[1][0];delete Z[2];var ne=Dr(oe.data);{var me=fs(ne[2][0].data);(function(){for(var I=Zt.find(f,c[me].location),R=ln(cn(I.content)),M,K=0;K<R.length;++K){var he=R[K];he.id==me&&(M=he)}var fe=Dr(M.messages[0].data);{delete fe[6],delete Z[7];var ee=new Uint8Array(fe[5][0].data);fe[5]=[];for(var ve=0,Ce=0;Ce<=n.e.r;++Ce){var De=Dr(ee);ve+=hw(De,o[Ce],l),De[1][0].data=Gt(Ce),fe[5].push({data:Gr(De),type:2})}fe[1]=[{type:0,data:Gt(n.e.c+1)}],fe[2]=[{type:0,data:Gt(n.e.r+1)}],fe[3]=[{type:0,data:Gt(ve)}],fe[4]=[{type:0,data:Gt(n.e.r+1)}]}M.messages[0].data=Gr(fe);var $e=ji(R),Ke=Si($e);I.content=Ke,I.size=I.content.length})()}oe.data=Gr(ne)}D[3][0].data=Gr(Z)}b[4][0].data=Gr(D)}m.messages[0].data=Gr(b);var be=ji(p),A=Si(be);return g.content=A,g.size=g.content.length,f}function uw(e){return function(t){for(var n=0;n!=e.length;++n){var s=e[n];t[s[0]]===void 0&&(t[s[0]]=s[1]),s[2]==="n"&&(t[s[0]]=Number(t[s[0]]))}}}function wd(e){uw([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function mw(e,r){return r.bookType=="ods"?p1(e,r):r.bookType=="numbers"?fw(e,r):r.bookType=="xlsb"?xw(e,r):pw(e,r)}function xw(e,r){Ei=1024,e&&!e.SSF&&(e.SSF=ja(pr)),e&&e.SSF&&(wc(),bc(e.SSF),r.revssf=Nc(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Lo?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t=r.bookType=="xlsb"?"bin":"xml",n=Zu.indexOf(r.bookType)>-1,s=ku();wd(r=r||{});var o=sd(),l="",c=0;if(r.cellXfs=[],Ss(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",Et(o,l,Lu(e.Props,r)),s.coreprops.push(l),$t(r.rels,2,l,Mt.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&d.push(e.SheetNames[f]);e.Props.SheetNames=d}for(e.Props.Worksheets=e.Props.SheetNames.length,Et(o,l,Pu(e.Props)),s.extprops.push(l),$t(r.rels,3,l,Mt.EXT_PROPS),e.Custprops!==e.Props&&Jr(e.Custprops||{}).length>0&&(l="docProps/custom.xml",Et(o,l,Ou(e.Custprops)),s.custprops.push(l),$t(r.rels,4,l,Mt.CUST_PROPS)),c=1;c<=e.SheetNames.length;++c){var u={"!id":{}},g=e.Sheets[e.SheetNames[c-1]],p=(g||{})["!type"]||"sheet";switch(p){case"chart":default:l="xl/worksheets/sheet"+c+"."+t,Et(o,l,v4(c-1,l,r,e,u)),s.sheets.push(l),$t(r.wbrels,-1,"worksheets/sheet"+c+"."+t,Mt.WS[0])}if(g){var m=g["!comments"],j=!1,v="";m&&m.length>0&&(v="xl/comments"+c+"."+t,Et(o,v,w4(m,v)),s.comments.push(v),$t(u,-1,"../comments"+c+"."+t,Mt.CMNT),j=!0),g["!legacy"]&&j&&Et(o,"xl/drawings/vmlDrawing"+c+".vml",Xu(c,g["!comments"])),delete g["!comments"],delete g["!legacy"]}u["!id"].rId1&&Et(o,Cu(l),Fi(u))}return r.Strings!=null&&r.Strings.length>0&&(l="xl/sharedStrings."+t,Et(o,l,b4(r.Strings,l,r)),s.strs.push(l),$t(r.wbrels,-1,"sharedStrings."+t,Mt.SST)),l="xl/workbook."+t,Et(o,l,g4(e,l)),s.workbooks.push(l),$t(r.rels,1,l,Mt.WB),l="xl/theme/theme1.xml",Et(o,l,Yu(e.Themes,r)),s.themes.push(l),$t(r.wbrels,-1,"theme/theme1.xml",Mt.THEME),l="xl/styles."+t,Et(o,l,y4(e,l,r)),s.styles.push(l),$t(r.wbrels,-1,"styles."+t,Mt.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",Et(o,l,e.vbaraw),s.vba.push(l),$t(r.wbrels,-1,"vbaProject.bin",Mt.VBA)),l="xl/metadata."+t,Et(o,l,N4(l)),s.metadata.push(l),$t(r.wbrels,-1,"metadata."+t,Mt.XLMETA),Et(o,"[Content_Types].xml",Tu(s,r)),Et(o,"_rels/.rels",Fi(r.rels)),Et(o,"xl/_rels/workbook."+t+".rels",Fi(r.wbrels)),delete r.revssf,delete r.ssf,o}function pw(e,r){Ei=1024,e&&!e.SSF&&(e.SSF=ja(pr)),e&&e.SSF&&(wc(),bc(e.SSF),r.revssf=Nc(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Lo?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t="xml",n=Zu.indexOf(r.bookType)>-1,s=ku();wd(r=r||{});var o=sd(),l="",c=0;if(r.cellXfs=[],Ss(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",Et(o,l,Lu(e.Props,r)),s.coreprops.push(l),$t(r.rels,2,l,Mt.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&d.push(e.SheetNames[f]);e.Props.SheetNames=d}e.Props.Worksheets=e.Props.SheetNames.length,Et(o,l,Pu(e.Props)),s.extprops.push(l),$t(r.rels,3,l,Mt.EXT_PROPS),e.Custprops!==e.Props&&Jr(e.Custprops||{}).length>0&&(l="docProps/custom.xml",Et(o,l,Ou(e.Custprops)),s.custprops.push(l),$t(r.rels,4,l,Mt.CUST_PROPS));var u=["SheetJ5"];for(r.tcid=0,c=1;c<=e.SheetNames.length;++c){var g={"!id":{}},p=e.Sheets[e.SheetNames[c-1]],m=(p||{})["!type"]||"sheet";switch(m){case"chart":default:l="xl/worksheets/sheet"+c+"."+t,Et(o,l,o1(c-1,r,e,g)),s.sheets.push(l),$t(r.wbrels,-1,"worksheets/sheet"+c+"."+t,Mt.WS[0])}if(p){var j=p["!comments"],v=!1,N="";if(j&&j.length>0){var b=!1;j.forEach(function(y){y[1].forEach(function(_){_.T==!0&&(b=!0)})}),b&&(N="xl/threadedComments/threadedComment"+c+"."+t,Et(o,N,$v(j,u,r)),s.threadedcomments.push(N),$t(g,-1,"../threadedComments/threadedComment"+c+"."+t,Mt.TCMNT)),N="xl/comments"+c+"."+t,Et(o,N,Ju(j)),s.comments.push(N),$t(g,-1,"../comments"+c+"."+t,Mt.CMNT),v=!0}p["!legacy"]&&v&&Et(o,"xl/drawings/vmlDrawing"+c+".vml",Xu(c,p["!comments"])),delete p["!comments"],delete p["!legacy"]}g["!id"].rId1&&Et(o,Cu(l),Fi(g))}return r.Strings!=null&&r.Strings.length>0&&(l="xl/sharedStrings."+t,Et(o,l,Wu(r.Strings,r)),s.strs.push(l),$t(r.wbrels,-1,"sharedStrings."+t,Mt.SST)),l="xl/workbook."+t,Et(o,l,d1(e)),s.workbooks.push(l),$t(r.rels,1,l,Mt.WB),l="xl/theme/theme1.xml",Et(o,l,Yu(e.Themes,r)),s.themes.push(l),$t(r.wbrels,-1,"theme/theme1.xml",Mt.THEME),l="xl/styles."+t,Et(o,l,Gu(e,r)),s.styles.push(l),$t(r.wbrels,-1,"styles."+t,Mt.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",Et(o,l,e.vbaraw),s.vba.push(l),$t(r.wbrels,-1,"vbaProject.bin",Mt.VBA)),l="xl/metadata."+t,Et(o,l,Ku()),s.metadata.push(l),$t(r.wbrels,-1,"metadata."+t,Mt.XLMETA),u.length>1&&(l="xl/persons/person.xml",Et(o,l,Yv(u)),s.people.push(l),$t(r.wbrels,-1,"persons/person.xml",Mt.PEOPLE)),Et(o,"[Content_Types].xml",Tu(s,r)),Et(o,"_rels/.rels",Fi(r.rels)),Et(o,"xl/_rels/workbook."+t+".rels",Fi(r.wbrels)),delete r.revssf,delete r.ssf,o}function gw(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=$n(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function g1(e,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return Wo(r.file,Zt.write(e,{type:Ht?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return Zt.write(e,r)}function vw(e,r){var t=ja(r||{}),n=mw(e,t);return yw(n,t)}function yw(e,r){var t={},n=Ht?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(r.compression&&(t.compression="DEFLATE"),r.password)t.type=n;else switch(r.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":t.type=n;break;default:throw new Error("Unrecognized type "+r.type)}var s=e.FullPaths?Zt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!r.compression}):e.generate(t);if(typeof Deno<"u"&&typeof s=="string"){if(r.type=="binary"||r.type=="base64")return s;s=new Uint8Array(yc(s))}return r.password&&typeof encrypt_agile<"u"?g1(encrypt_agile(s,r.password),r):r.type==="file"?Wo(r.file,s):r.type=="string"?ko(s):s}function bw(e,r){var t=r||{},n=D4(e,t);return g1(n,t)}function kn(e,r,t){t||(t="");var n=t+e;switch(r.type){case"base64":return Io(Ro(n));case"binary":return Ro(n);case"string":return e;case"file":return Wo(r.file,n,"utf8");case"buffer":return Ht?Kn(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):kn(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function ww(e,r){switch(r.type){case"base64":return Io(e);case"binary":return e;case"string":return e;case"file":return Wo(r.file,e,"binary");case"buffer":return Ht?Kn(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function Xl(e,r){switch(r.type){case"string":case"base64":case"binary":for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return r.type=="base64"?Io(t):r.type=="string"?ko(t):t;case"file":return Wo(r.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+r.type)}}function v1(e,r){Kp(),i4(e);var t=ja(r||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var n=v1(e,t);return t.type="array",yc(n)}var s=0;if(t.sheet&&(typeof t.sheet=="number"?s=t.sheet:s=e.SheetNames.indexOf(t.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return kn(O4(e,t),t);case"slk":case"sylk":return kn(av.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"htm":case"html":return kn(u1(e.Sheets[e.SheetNames[s]],t),t);case"txt":return ww(y1(e.Sheets[e.SheetNames[s]],t),t);case"csv":return kn(Nd(e.Sheets[e.SheetNames[s]],t),t,"\uFEFF");case"dif":return kn(nv.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"dbf":return Xl(rv.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"prn":return kn(sv.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"rtf":return kn(fv.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"eth":return kn(Hu.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"fods":return kn(p1(e,t),t);case"wk1":return Xl(sf.sheet_to_wk1(e.Sheets[e.SheetNames[s]],t),t);case"wk3":return Xl(sf.book_to_wk3(e,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Xl(f1(e,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),bw(e,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return vw(e,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function Nw(e){if(!e.bookType){var r={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType=r[e.bookType]||e.bookType}}function jw(e,r,t){var n={};return n.type="file",n.file=r,Nw(n),v1(e,n)}function Sw(e,r,t,n,s,o,l,c){var d=Xr(t),f=c.defval,u=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),g=!0,p=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:t,enumerable:!1})}catch{p.__rowNum__=t}else p.__rowNum__=t;if(!l||e[t])for(var m=r.s.c;m<=r.e.c;++m){var j=l?e[t][m]:e[n[m]+d];if(j===void 0||j.t===void 0){if(f===void 0)continue;o[m]!=null&&(p[o[m]]=f);continue}var v=j.v;switch(j.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+j.t)}if(o[m]!=null){if(v==null)if(j.t=="e"&&v===null)p[o[m]]=null;else if(f!==void 0)p[o[m]]=f;else if(u&&v===null)p[o[m]]=null;else continue;else p[o[m]]=u&&(j.t!=="n"||j.t==="n"&&c.rawNumbers!==!1)?v:Yn(j,v,c);v!=null&&(g=!1)}}return{row:p,isempty:g}}function xc(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},n=0,s=1,o=[],l=0,c="",d={s:{r:0,c:0},e:{r:0,c:0}},f=r||{},u=f.range!=null?f.range:e["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof u){case"string":d=lr(u);break;case"number":d=lr(e["!ref"]),d.s.r=u;break;default:d=u}n>0&&(s=0);var g=Xr(d.s.r),p=[],m=[],j=0,v=0,N=Array.isArray(e),b=d.s.r,y=0,_={};N&&!e[b]&&(e[b]=[]);var T=f.skipHidden&&e["!cols"]||[],O=f.skipHidden&&e["!rows"]||[];for(y=d.s.c;y<=d.e.c;++y)if(!(T[y]||{}).hidden)switch(p[y]=ia(y),t=N?e[b][y]:e[p[y]+g],n){case 1:o[y]=y-d.s.c;break;case 2:o[y]=p[y];break;case 3:o[y]=f.header[y-d.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),c=l=Yn(t,null,f),v=_[l]||0,!v)_[l]=1;else{do c=l+"_"+v++;while(_[c]);_[l]=v,_[c]=1}o[y]=c}for(b=d.s.r+s;b<=d.e.r;++b)if(!(O[b]||{}).hidden){var B=Sw(e,d,b,p,n,o,N,f);(B.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(m[j++]=B.row)}return m.length=j,m}var mf=/"/g;function _w(e,r,t,n,s,o,l,c){for(var d=!0,f=[],u="",g=Xr(t),p=r.s.c;p<=r.e.c;++p)if(n[p]){var m=c.dense?(e[t]||[])[p]:e[n[p]+g];if(m==null)u="";else if(m.v!=null){d=!1,u=""+(c.rawNumbers&&m.t=="n"?m.v:Yn(m,null,c));for(var j=0,v=0;j!==u.length;++j)if((v=u.charCodeAt(j))===s||v===o||v===34||c.forceQuotes){u='"'+u.replace(mf,'""')+'"';break}u=="ID"&&(u='"ID"')}else m.f!=null&&!m.F?(d=!1,u="="+m.f,u.indexOf(",")>=0&&(u='"'+u.replace(mf,'""')+'"')):u="";f.push(u)}return c.blankrows===!1&&d?null:f.join(l)}function Nd(e,r){var t=[],n=r??{};if(e==null||e["!ref"]==null)return"";var s=lr(e["!ref"]),o=n.FS!==void 0?n.FS:",",l=o.charCodeAt(0),c=n.RS!==void 0?n.RS:`
`,d=c.charCodeAt(0),f=new RegExp((o=="|"?"\\|":o)+"+$"),u="",g=[];n.dense=Array.isArray(e);for(var p=n.skipHidden&&e["!cols"]||[],m=n.skipHidden&&e["!rows"]||[],j=s.s.c;j<=s.e.c;++j)(p[j]||{}).hidden||(g[j]=ia(j));for(var v=0,N=s.s.r;N<=s.e.r;++N)(m[N]||{}).hidden||(u=_w(e,s,N,g,l,d,o,n),u!=null&&(n.strip&&(u=u.replace(f,"")),(u||n.blankrows!==!1)&&t.push((v++?c:"")+u)));return delete n.dense,t.join("")}function y1(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=Nd(e,r);return t}function Aw(e){var r="",t,n="";if(e==null||e["!ref"]==null)return[];var s=lr(e["!ref"]),o="",l=[],c,d=[],f=Array.isArray(e);for(c=s.s.c;c<=s.e.c;++c)l[c]=ia(c);for(var u=s.s.r;u<=s.e.r;++u)for(o=Xr(u),c=s.s.c;c<=s.e.c;++c)if(r=l[c]+o,t=f?(e[u]||[])[c]:e[r],n="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;n=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}d[d.length]=r+"="+n}return d}function b1(e,r,t){var n=t||{},s=+!n.skipHeader,o=e||{},l=0,c=0;if(o&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var d=typeof n.origin=="string"?Wr(n.origin):n.origin;l=d.r,c=d.c}var f,u={s:{c:0,r:0},e:{c,r:l+r.length-1+s}};if(o["!ref"]){var g=lr(o["!ref"]);u.e.c=Math.max(u.e.c,g.e.c),u.e.r=Math.max(u.e.r,g.e.r),l==-1&&(l=g.e.r+1,u.e.r=l+r.length-1+s)}else l==-1&&(l=0,u.e.r=r.length-1+s);var p=n.header||[],m=0;r.forEach(function(v,N){Jr(v).forEach(function(b){(m=p.indexOf(b))==-1&&(p[m=p.length]=b);var y=v[b],_="z",T="",O=Kt({c:c+m,r:l+N+s});f=Uo(o,O),y&&typeof y=="object"&&!(y instanceof Date)?o[O]=y:(typeof y=="number"?_="n":typeof y=="boolean"?_="b":typeof y=="string"?_="s":y instanceof Date?(_="d",n.cellDates||(_="n",y=Na(y)),T=n.dateNF||pr[14]):y===null&&n.nullError&&(_="e",y=0),f?(f.t=_,f.v=y,delete f.w,delete f.R,T&&(f.z=T)):o[O]=f={t:_,v:y},T&&(f.z=T))})}),u.e.c=Math.max(u.e.c,c+p.length-1);var j=Xr(l);if(s)for(m=0;m<p.length;++m)o[ia(m+c)+j]={t:"s",v:p[m]};return o["!ref"]=Er(u),o}function kw(e,r){return b1(null,e,r)}function Uo(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var n=Wr(r);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?Uo(e,Kt(r)):Uo(e,Kt({r,c:t||0}))}function Tw(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function Cw(){return{SheetNames:[],Sheets:{}}}function Ew(e,r,t,n){var s=1;if(!t)for(;s<=65535&&e.SheetNames.indexOf(t="Sheet"+s)!=-1;++s,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(t)>=0){var o=t.match(/(^.*?)(\d+)$/);s=o&&+o[2]||0;var l=o&&o[1]||t;for(++s;s<=65535&&e.SheetNames.indexOf(t=l+s)!=-1;++s);}if(c1(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function Lw(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=Tw(e,r);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[n].Hidden=t}function Fw(e,r){return e.z=r,e}function w1(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function Pw(e,r,t){return w1(e,"#"+r,t)}function Ow(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function Iw(e,r,t,n){for(var s=typeof r!="string"?r:lr(r),o=typeof r=="string"?r:Er(r),l=s.s.r;l<=s.e.r;++l)for(var c=s.s.c;c<=s.e.c;++c){var d=Uo(e,l,c);d.t="n",d.F=o,delete d.v,l==s.s.r&&c==s.s.c&&(d.f=t,n&&(d.D=!0))}return e}var Ir={encode_col:ia,encode_row:Xr,encode_cell:Kt,encode_range:Er,decode_col:hd,decode_row:dd,split_cell:Kg,decode_cell:Wr,decode_range:Ra,format_cell:Yn,sheet_add_aoa:wu,sheet_add_json:b1,sheet_add_dom:m1,aoa_to_sheet:Bi,json_to_sheet:kw,table_to_sheet:x1,table_to_book:nw,sheet_to_csv:Nd,sheet_to_txt:y1,sheet_to_json:xc,sheet_to_html:u1,sheet_to_formulae:Aw,sheet_to_row_object_array:xc,sheet_get_cell:Uo,book_new:Cw,book_append_sheet:Ew,book_set_sheet_visibility:Lw,cell_set_number_format:Fw,cell_set_hyperlink:w1,cell_set_internal_link:Pw,cell_add_comment:Ow,sheet_set_array_formula:Iw,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const F0=[{id:"sales",name:"Sales Report",description:"Revenue, orders, and sales performance",icon:"ðŸ“Š",color:"afri-green"},{id:"inventory",name:"Inventory Report",description:"Stock levels, low stock items, and product performance",icon:"ðŸ“¦",color:"blue-600"},{id:"orders",name:"Order Report",description:"Order history, status breakdown, and delivery metrics",icon:"ðŸ“‹",color:"purple-600"},{id:"revenue",name:"Revenue Report",description:"Earnings breakdown, payment status, and financial summary",icon:"ðŸ’°",color:"afri-yellow-dark"}],Dw=[{label:"Today",value:"today"},{label:"Yesterday",value:"yesterday"},{label:"Last 7 Days",value:"week"},{label:"Last 30 Days",value:"month"},{label:"This Month",value:"thisMonth"},{label:"Last Month",value:"lastMonth"},{label:"Custom Range",value:"custom"}];function Rw(){const[e,r]=ge.useState(null),[t,n]=ge.useState("week"),[s,o]=ge.useState(""),[l,c]=ge.useState(""),[d,f]=ge.useState(!1),[u,g]=ge.useState(null),[p,m]=ge.useState(!1),j=async()=>{if(!e){alert("Please select a report type");return}f(!0);try{const{startDate:y,endDate:_}=v();let T;switch(e){case"sales":T=await xr.getSalesReport({startDate:y,endDate:_});break;case"inventory":T=await xr.getInventoryReport();break;case"orders":T=await xr.getOrdersReport({startDate:y,endDate:_});break;case"revenue":T=await xr.getRevenueReport({startDate:y,endDate:_});break;default:throw new Error("Invalid report type")}T.success&&(g(T.data),m(!0))}catch(y){console.error("Error generating report:",y),alert(y.message||"Failed to generate report")}finally{f(!1)}},v=()=>{const y=new Date;let _,T;switch(t){case"today":_=new Date(y.setHours(0,0,0,0)),T=new Date(y.setHours(23,59,59,999));break;case"yesterday":_=new Date(y.setDate(y.getDate()-1)),_.setHours(0,0,0,0),T=new Date(_),T.setHours(23,59,59,999);break;case"week":_=new Date(y.setDate(y.getDate()-7)),T=new Date;break;case"month":_=new Date(y.setDate(y.getDate()-30)),T=new Date;break;case"thisMonth":_=new Date(y.getFullYear(),y.getMonth(),1),T=new Date;break;case"lastMonth":_=new Date(y.getFullYear(),y.getMonth()-1,1),T=new Date(y.getFullYear(),y.getMonth(),0);break;case"custom":_=new Date(s),T=new Date(l);break;default:_=new Date(y.setDate(y.getDate()-7)),T=new Date}return{startDate:_.toISOString(),endDate:T.toISOString()}},N=()=>{var E,P,D,k,C,z;if(!u)return;const y=new pt,_=F0.find(G=>G.id===e);y.setFontSize(20),y.setTextColor(0,178,7),y.text(_.name,14,20),y.setFontSize(10),y.setTextColor(100);const{startDate:T,endDate:O}=v();y.text(`Generated: ${new Date().toLocaleDateString()} | Period: ${new Date(T).toLocaleDateString()} - ${new Date(O).toLocaleDateString()}`,14,28);let B=40;if(e==="sales"){y.setFontSize(14),y.setTextColor(0),y.text("Summary",14,B),B+=10;const G=[["Total Revenue",`Â£${((E=u.totalRevenue)==null?void 0:E.toFixed(2))||"0.00"}`],["Total Orders",u.totalOrders||0],["Average Order Value",`Â£${((P=u.avgOrderValue)==null?void 0:P.toFixed(2))||"0.00"}`],["Total Items Sold",u.totalItemsSold||0]];if(y.autoTable({startY:B,head:[["Metric","Value"]],body:G,theme:"grid",headStyles:{fillColor:[0,178,7]}}),u.topProducts&&u.topProducts.length>0){B=y.lastAutoTable.finalY+15,y.setFontSize(14),y.text("Top Products",14,B),B+=5;const de=u.topProducts.map((J,Z)=>{var oe;return[Z+1,J.name,J.soldQuantity,`Â£${((oe=J.revenue)==null?void 0:oe.toFixed(2))||"0.00"}`]});y.autoTable({startY:B+5,head:[["#","Product","Qty Sold","Revenue"]],body:de,theme:"striped",headStyles:{fillColor:[0,178,7]}})}}else if(e==="inventory"){y.setFontSize(14),y.text("Stock Overview",14,B),B+=10;const G=[["Total Products",u.totalProducts||0],["In Stock",u.inStock||0],["Out of Stock",u.outOfStock||0],["Low Stock",u.lowStock||0]];if(y.autoTable({startY:B,head:[["Category","Count"]],body:G,theme:"grid",headStyles:{fillColor:[0,178,7]}}),u.lowStockItems&&u.lowStockItems.length>0){B=y.lastAutoTable.finalY+15,y.setFontSize(14),y.text("Low Stock Items",14,B),B+=5;const de=u.lowStockItems.map(J=>[J.name,J.currentStock,J.lowStockThreshold,J.status]);y.autoTable({startY:B+5,head:[["Product","Current Stock","Threshold","Status"]],body:de,theme:"striped",headStyles:{fillColor:[255,138,0]}})}}else if(e==="orders"){y.setFontSize(14),y.text("Orders Summary",14,B),B+=10;const G=[["Total Orders",u.totalOrders||0],["Completed",u.completed||0],["Pending",u.pending||0],["Cancelled",u.cancelled||0]];if(y.autoTable({startY:B,head:[["Status","Count"]],body:G,theme:"grid",headStyles:{fillColor:[0,178,7]}}),u.orders&&u.orders.length>0){B=y.lastAutoTable.finalY+15,y.setFontSize(14),y.text("Order Details",14,B),B+=5;const de=u.orders.map(J=>{var Z;return[J.orderNumber,new Date(J.createdAt).toLocaleDateString(),J.status,`Â£${((Z=J.total)==null?void 0:Z.toFixed(2))||"0.00"}`]});y.autoTable({startY:B+5,head:[["Order #","Date","Status","Total"]],body:de,theme:"striped",headStyles:{fillColor:[0,178,7]}})}}else if(e==="revenue"){y.setFontSize(14),y.text("Revenue Summary",14,B),B+=10;const G=[["Total Revenue",`Â£${((D=u.totalRevenue)==null?void 0:D.toFixed(2))||"0.00"}`],["Paid",`Â£${((k=u.paidRevenue)==null?void 0:k.toFixed(2))||"0.00"}`],["Pending",`Â£${((C=u.pendingRevenue)==null?void 0:C.toFixed(2))||"0.00"}`],["Refunded",`Â£${((z=u.refundedRevenue)==null?void 0:z.toFixed(2))||"0.00"}`]];if(y.autoTable({startY:B,head:[["Category","Amount"]],body:G,theme:"grid",headStyles:{fillColor:[0,178,7]}}),u.dailyRevenue&&u.dailyRevenue.length>0){B=y.lastAutoTable.finalY+15,y.setFontSize(14),y.text("Daily Revenue Breakdown",14,B),B+=5;const de=u.dailyRevenue.map(J=>{var Z;return[new Date(J.date).toLocaleDateString(),J.orders,`Â£${((Z=J.revenue)==null?void 0:Z.toFixed(2))||"0.00"}`]});y.autoTable({startY:B+5,head:[["Date","Orders","Revenue"]],body:de,theme:"striped",headStyles:{fillColor:[0,178,7]}})}}const L=y.internal.getNumberOfPages();for(let G=1;G<=L;G++)y.setPage(G),y.setFontSize(8),y.setTextColor(150),y.text(`Afrimercato - ${_.name} | Page ${G} of ${L}`,14,y.internal.pageSize.height-10);y.save(`${e}-report-${new Date().toISOString().split("T")[0]}.pdf`)},b=()=>{var T,O,B,L,E,P;if(!u)return;const y=F0.find(D=>D.id===e),_=Ir.book_new();if(e==="sales"){const D=[["Metric","Value"],["Total Revenue",((T=u.totalRevenue)==null?void 0:T.toFixed(2))||"0.00"],["Total Orders",u.totalOrders||0],["Average Order Value",((O=u.avgOrderValue)==null?void 0:O.toFixed(2))||"0.00"],["Total Items Sold",u.totalItemsSold||0]],k=Ir.aoa_to_sheet(D);if(Ir.book_append_sheet(_,k,"Summary"),u.topProducts&&u.topProducts.length>0){const C=[["Rank","Product","Quantity Sold","Revenue"],...u.topProducts.map((G,de)=>{var J;return[de+1,G.name,G.soldQuantity,((J=G.revenue)==null?void 0:J.toFixed(2))||"0.00"]})],z=Ir.aoa_to_sheet(C);Ir.book_append_sheet(_,z,"Top Products")}}else if(e==="inventory"){const D=[["Category","Count"],["Total Products",u.totalProducts||0],["In Stock",u.inStock||0],["Out of Stock",u.outOfStock||0],["Low Stock",u.lowStock||0]],k=Ir.aoa_to_sheet(D);if(Ir.book_append_sheet(_,k,"Overview"),u.lowStockItems&&u.lowStockItems.length>0){const C=[["Product","Current Stock","Threshold","Status"],...u.lowStockItems.map(G=>[G.name,G.currentStock,G.lowStockThreshold,G.status])],z=Ir.aoa_to_sheet(C);Ir.book_append_sheet(_,z,"Low Stock Items")}if(u.allProducts&&u.allProducts.length>0){const C=[["Name","Category","Stock","Price","Status"],...u.allProducts.map(G=>[G.name,G.category,G.stock,G.price,G.inStock?"In Stock":"Out of Stock"])],z=Ir.aoa_to_sheet(C);Ir.book_append_sheet(_,z,"All Products")}}else if(e==="orders"){const D=[["Status","Count"],["Total Orders",u.totalOrders||0],["Completed",u.completed||0],["Pending",u.pending||0],["Cancelled",u.cancelled||0]],k=Ir.aoa_to_sheet(D);if(Ir.book_append_sheet(_,k,"Summary"),u.orders&&u.orders.length>0){const C=[["Order Number","Date","Customer","Status","Items","Total"],...u.orders.map(G=>{var de;return[G.orderNumber,new Date(G.createdAt).toLocaleDateString(),G.customerName||"N/A",G.status,G.itemsCount||0,((de=G.total)==null?void 0:de.toFixed(2))||"0.00"]})],z=Ir.aoa_to_sheet(C);Ir.book_append_sheet(_,z,"Orders")}}else if(e==="revenue"){const D=[["Category","Amount (Â£)"],["Total Revenue",((B=u.totalRevenue)==null?void 0:B.toFixed(2))||"0.00"],["Paid",((L=u.paidRevenue)==null?void 0:L.toFixed(2))||"0.00"],["Pending",((E=u.pendingRevenue)==null?void 0:E.toFixed(2))||"0.00"],["Refunded",((P=u.refundedRevenue)==null?void 0:P.toFixed(2))||"0.00"]],k=Ir.aoa_to_sheet(D);if(Ir.book_append_sheet(_,k,"Summary"),u.dailyRevenue&&u.dailyRevenue.length>0){const C=[["Date","Orders","Revenue (Â£)"],...u.dailyRevenue.map(G=>{var de;return[new Date(G.date).toLocaleDateString(),G.orders,((de=G.revenue)==null?void 0:de.toFixed(2))||"0.00"]})],z=Ir.aoa_to_sheet(C);Ir.book_append_sheet(_,z,"Daily Revenue")}}jw(_,`${y.name.replace(" ","-")}-${new Date().toISOString().split("T")[0]}.xlsx`)};return a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"mb-8",children:[a.jsx("h1",{className:"text-3xl font-bold text-afri-gray-900",children:"Reports"}),a.jsx("p",{className:"text-afri-gray-600 mt-1",children:"Generate and export business reports"})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsx("div",{className:"lg:col-span-1",children:a.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[a.jsx("h2",{className:"text-lg font-semibold text-afri-gray-900 mb-4",children:"Select Report Type"}),a.jsx("div",{className:"space-y-3",children:F0.map(y=>a.jsx("button",{onClick:()=>r(y.id),className:`w-full text-left p-4 rounded-lg border-2 transition ${e===y.id?`border-${y.color} bg-${y.color} bg-opacity-10`:"border-gray-200 hover:border-gray-300"}`,children:a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"text-2xl mr-3",children:y.icon}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-semibold text-afri-gray-900",children:y.name}),a.jsx("p",{className:"text-sm text-afri-gray-600 mt-1",children:y.description})]})]})},y.id))})]})}),a.jsx("div",{className:"lg:col-span-2",children:a.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[a.jsx("h2",{className:"text-lg font-semibold text-afri-gray-900 mb-4",children:"Report Configuration"}),e?a.jsxs("div",{className:"space-y-6",children:[e!=="inventory"&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-afri-gray-700 mb-2",children:"Date Range"}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:Dw.map(y=>a.jsx("button",{onClick:()=>n(y.value),className:`px-4 py-2 rounded-lg font-medium transition ${t===y.value?"bg-afri-green text-white":"bg-afri-gray-50 text-afri-gray-700 hover:bg-afri-gray-100"}`,children:y.label},y.value))}),t==="custom"&&a.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-afri-gray-700 mb-1",children:"Start Date"}),a.jsx("input",{type:"date",value:s,onChange:y=>o(y.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-afri-gray-700 mb-1",children:"End Date"}),a.jsx("input",{type:"date",value:l,onChange:y=>c(y.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent"})]})]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:j,disabled:d,className:"flex-1 bg-afri-green text-white px-6 py-3 rounded-lg font-semibold hover:bg-afri-green-dark transition disabled:opacity-50 disabled:cursor-not-allowed",children:d?a.jsxs("span",{className:"flex items-center justify-center",children:[a.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generating..."]}):"Generate Report"}),u&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:N,className:"bg-red-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-red-700 transition",children:"Export PDF"}),a.jsx("button",{onClick:b,className:"bg-green-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-green-700 transition",children:"Export Excel"})]})]}),p&&u&&a.jsxs("div",{className:"mt-6 border-t pt-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-afri-gray-900 mb-4",children:"Report Preview"}),a.jsx("div",{className:"bg-afri-gray-50 rounded-lg p-6",children:a.jsx("pre",{className:"text-sm text-afri-gray-700 whitespace-pre-wrap",children:JSON.stringify(u,null,2)})})]})]}):a.jsxs("div",{className:"text-center py-12",children:[a.jsx("svg",{className:"w-16 h-16 text-afri-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),a.jsx("p",{className:"text-afri-gray-600",children:"Select a report type to get started"})]})]})})]})]})}function Bw({message:e,type:r="success",duration:t=3e3,onClose:n}){const[s,o]=ge.useState(!0);ge.useEffect(()=>{const d=setTimeout(()=>{o(!1),setTimeout(n,300)},t);return()=>clearTimeout(d)},[t,n]);const l=()=>{switch(r){case"success":return a.jsx("svg",{className:"w-6 h-6 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});case"error":return a.jsx("svg",{className:"w-6 h-6 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})});case"warning":return a.jsx("svg",{className:"w-6 h-6 text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});case"info":return a.jsx("svg",{className:"w-6 h-6 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});default:return null}},c=()=>{switch(r){case"success":return"bg-green-50 border-green-500";case"error":return"bg-red-50 border-red-500";case"warning":return"bg-yellow-50 border-yellow-500";case"info":return"bg-blue-50 border-blue-500";default:return"bg-gray-50 border-gray-500"}};return a.jsx("div",{className:`fixed top-4 right-4 z-50 max-w-md w-full transform transition-all duration-300 ${s?"translate-x-0 opacity-100":"translate-x-full opacity-0"}`,children:a.jsxs("div",{className:`${c()} border-l-4 rounded-lg shadow-lg p-4 flex items-start`,children:[a.jsx("div",{className:"flex-shrink-0",children:l()}),a.jsx("div",{className:"ml-3 flex-1",children:a.jsx("p",{className:"text-sm font-medium text-gray-900",children:e})}),a.jsx("button",{onClick:()=>{o(!1),setTimeout(n,300)},className:"ml-4 flex-shrink-0 text-gray-400 hover:text-gray-500 transition-colors",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})}const Mw=()=>{const[e,r]=ge.useState([]),t=ge.useCallback((s,o="success",l=3e3)=>{const c=Date.now(),d={id:c,message:s,type:o,duration:l};r(f=>[...f,d]),setTimeout(()=>{n(c)},l+300)},[]),n=ge.useCallback(s=>{r(o=>o.filter(l=>l.id!==s))},[]);return{toasts:e,showToast:t,removeToast:n,success:(s,o)=>t(s,"success",o),error:(s,o)=>t(s,"error",o),warning:(s,o)=>t(s,"warning",o),info:(s,o)=>t(s,"info",o)}},Uw=["fresh-produce","groceries","meat-fish","bakery","beverages","household","beauty-health","other"],Hw=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],Ww=[{code:"GB",name:"United Kingdom",region:"Europe"},{code:"US",name:"United States",region:"North America"},{code:"CA",name:"Canada",region:"North America"},{code:"DE",name:"Germany",region:"Europe"},{code:"FR",name:"France",region:"Europe"},{code:"ES",name:"Spain",region:"Europe"},{code:"IT",name:"Italy",region:"Europe"},{code:"NL",name:"Netherlands",region:"Europe"},{code:"BE",name:"Belgium",region:"Europe"},{code:"IE",name:"Ireland",region:"Europe"}];function zw(){var Z,oe,ne,me,be,A,I,R,M,K,he,fe;const{toasts:e,success:r,error:t,warning:n,removeToast:s}=Mw(),[o,l]=ge.useState("profile"),[c,d]=ge.useState(!0),[f,u]=ge.useState(!1),[g,p]=ge.useState(!1),[m,j]=ge.useState([]),[v,N]=ge.useState(!1),[b,y]=ge.useState({storeName:"",description:"",category:"fresh-produce",phone:"",alternativePhone:"",address:{street:"",city:"",state:"",country:"United Kingdom",postalCode:""},businessHours:{monday:{open:"09:00",close:"18:00",isOpen:!0},tuesday:{open:"09:00",close:"18:00",isOpen:!0},wednesday:{open:"09:00",close:"18:00",isOpen:!0},thursday:{open:"09:00",close:"18:00",isOpen:!0},friday:{open:"09:00",close:"18:00",isOpen:!0},saturday:{open:"09:00",close:"18:00",isOpen:!0},sunday:{open:"09:00",close:"18:00",isOpen:!1}}}),[_,T]=ge.useState({name:"",email:"",phone:""}),[O,B]=ge.useState({currentPassword:"",newPassword:"",confirmPassword:""});ge.useEffect(()=>{L()},[]);const L=async()=>{try{d(!0);const[ee,ve]=await Promise.all([xr.getProfile(),u0.getProfile()]);ee.success&&y(ee.data.vendor),ve.success&&T(ve.data.user)}catch(ee){console.error("Error fetching settings:",ee)}finally{d(!1)}},E=(ee,ve)=>{if(ee.startsWith("address.")){const Ce=ee.split(".")[1];y(De=>({...De,address:{...De.address,[Ce]:ve}}))}else y(Ce=>({...Ce,[ee]:ve}))},P=(ee,ve,Ce)=>{y(De=>({...De,businessHours:{...De.businessHours,[ee]:{...De.businessHours[ee],[ve]:Ce}}}))},D=(ee,ve)=>{T(Ce=>({...Ce,[ee]:ve}))},k=(ee,ve)=>{B(Ce=>({...Ce,[ee]:ve}))},C=async()=>{var ve,Ce;const ee=(Ce=(ve=b.address)==null?void 0:ve.postalCode)==null?void 0:Ce.trim();if(!ee){n("Please enter a postcode first");return}try{p(!0);const $e=await(await fetch(`https://api.postcodes.io/postcodes/${encodeURIComponent(ee)}`)).json();if($e.status===200&&$e.result){const Ke=$e.result;y(Ee=>({...Ee,address:{...Ee.address,city:Ke.admin_district||Ke.postcode_area||"",state:Ke.admin_county||Ke.region||""}})),r("Address details filled! Please enter your street address.")}else n("Postcode not found. Please check and try again.")}catch(De){console.error("Postcode lookup error:",De),t("Failed to lookup postcode. You can still enter address manually.")}finally{p(!1)}},z=async()=>{var ee,ve;try{u(!0),(await xr.updateProfile(b)).success&&r("Vendor profile updated successfully!")}catch(Ce){t(((ve=(ee=Ce.response)==null?void 0:ee.data)==null?void 0:ve.message)||"Failed to update vendor profile")}finally{u(!1)}},G=async()=>{var ee,ve;try{u(!0),(await u0.updateProfile(_)).success&&r("Account updated successfully!")}catch(Ce){t(((ve=(ee=Ce.response)==null?void 0:ee.data)==null?void 0:ve.message)||"Failed to update account")}finally{u(!1)}},de=async()=>{var ee,ve;if(O.newPassword!==O.confirmPassword){n("Passwords do not match!");return}if(O.newPassword.length<6){n("Password must be at least 6 characters!");return}try{u(!0),(await u0.changePassword({currentPassword:O.currentPassword,newPassword:O.newPassword})).success&&(r("Password changed successfully!"),B({currentPassword:"",newPassword:"",confirmPassword:""}))}catch(Ce){t(((ve=(ee=Ce.response)==null?void 0:ee.data)==null?void 0:ve.message)||"Failed to change password")}finally{u(!1)}},J=[{id:"profile",name:"Store Profile",icon:"ðŸª"},{id:"account",name:"Account",icon:"ðŸ‘¤"},{id:"hours",name:"Business Hours",icon:"ðŸ•"},{id:"security",name:"Security",icon:"ðŸ”’"}];return c?a.jsx("div",{className:"flex justify-center items-center h-screen",children:a.jsx("div",{className:"relative",children:a.jsx("div",{className:"w-20 h-20 border-4 border-afri-green border-t-transparent rounded-full animate-spin"})})}):a.jsxs("div",{className:"space-y-6",children:[e.map(ee=>a.jsx(Bw,{message:ee.message,type:ee.type,duration:ee.duration,onClose:()=>s(ee.id)},ee.id)),a.jsxs("div",{children:[a.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-afri-green to-afri-green-dark bg-clip-text text-transparent",children:"Settings"}),a.jsx("p",{className:"text-afri-gray-600 mt-2",children:"Manage your store and account settings"})]}),a.jsx("div",{className:"border-b border-gray-200",children:a.jsx("nav",{className:"-mb-px flex space-x-8",children:J.map(ee=>a.jsxs("button",{onClick:()=>l(ee.id),className:`py-4 px-1 border-b-2 font-medium text-sm transition-all duration-200 flex items-center space-x-2 ${o===ee.id?"border-afri-green text-afri-green":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx("span",{className:"text-xl",children:ee.icon}),a.jsx("span",{children:ee.name})]},ee.id))})}),o==="profile"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 space-y-6 animate-fadeIn",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-afri-gray-900 mb-4",children:"Store Information"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Store Name"}),a.jsx("input",{type:"text",value:b.storeName,onChange:ee=>E("storeName",ee.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Category"}),a.jsx("select",{value:b.category,onChange:ee=>E("category",ee.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all",children:Uw.map(ee=>a.jsx("option",{value:ee,children:ee.split("-").map(ve=>ve.charAt(0).toUpperCase()+ve.slice(1)).join(" ")},ee))})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Description"}),a.jsx("textarea",{value:b.description,onChange:ee=>E("description",ee.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Primary Phone"}),a.jsx("input",{type:"tel",value:b.phone,onChange:ee=>E("phone",ee.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Alternative Phone"}),a.jsx("input",{type:"tel",value:b.alternativePhone||"",onChange:ee=>E("alternativePhone",ee.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all"})]})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-afri-gray-900 mb-4",children:"Address"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Street Address"}),a.jsx("input",{type:"text",value:((Z=b.address)==null?void 0:Z.street)||"",onChange:ee=>E("address.street",ee.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"City"}),a.jsx("input",{type:"text",value:((oe=b.address)==null?void 0:oe.city)||"",onChange:ee=>E("address.city",ee.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:((ne=b.address)==null?void 0:ne.country)==="United Kingdom"?"County":"State/County"}),a.jsx("input",{type:"text",value:((me=b.address)==null?void 0:me.state)||"",onChange:ee=>E("address.state",ee.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all",placeholder:((be=b.address)==null?void 0:be.country)==="United Kingdom"?"e.g., Greater London":"State or County"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:((A=b.address)==null?void 0:A.country)==="United Kingdom"?"Postcode":"Postal/Zip Code"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"text",value:((I=b.address)==null?void 0:I.postalCode)||"",onChange:ee=>E("address.postalCode",ee.target.value.toUpperCase()),className:"flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all",placeholder:((R=b.address)==null?void 0:R.country)==="United Kingdom"?"e.g., SW1A 1AA":"Postal Code"}),((M=b.address)==null?void 0:M.country)==="United Kingdom"&&a.jsx("button",{type:"button",onClick:C,disabled:g||!((K=b.address)!=null&&K.postalCode),className:"px-4 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center whitespace-nowrap",children:g?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Looking up..."]}):a.jsxs(a.Fragment,{children:[a.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Find Address"]})})]}),((he=b.address)==null?void 0:he.country)==="United Kingdom"&&a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:'Enter your postcode and click "Find Address" to auto-fill city and county'})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Country"}),a.jsx("select",{value:((fe=b.address)==null?void 0:fe.country)||"United Kingdom",onChange:ee=>E("address.country",ee.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all",children:Ww.map(ee=>a.jsx("option",{value:ee.name,children:ee.name},ee.code))})]})]})]}),a.jsx("div",{className:"flex justify-end pt-6 border-t",children:a.jsx("button",{onClick:z,disabled:f,className:"px-8 py-3 bg-gradient-to-r from-afri-green to-afri-green-dark text-white rounded-lg font-semibold shadow-lg hover:shadow-xl transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center",children:f?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save Changes"})})]}),o==="account"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 space-y-6 animate-fadeIn",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-afri-gray-900 mb-4",children:"Account Information"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Full Name"}),a.jsx("input",{type:"text",value:_.name,onChange:ee=>D("name",ee.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Email Address"}),a.jsx("input",{type:"email",value:_.email,onChange:ee=>D("email",ee.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Phone Number"}),a.jsx("input",{type:"tel",value:_.phone||"",onChange:ee=>D("phone",ee.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all"})]})]})]}),a.jsx("div",{className:"flex justify-end pt-6 border-t",children:a.jsx("button",{onClick:G,disabled:f,className:"px-8 py-3 bg-gradient-to-r from-afri-green to-afri-green-dark text-white rounded-lg font-semibold shadow-lg hover:shadow-xl transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center",children:f?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save Changes"})})]}),o==="hours"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 space-y-6 animate-fadeIn",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-afri-gray-900 mb-4",children:"Business Hours"}),a.jsx("div",{className:"space-y-4",children:Hw.map(ee=>{var ve,Ce,De,$e,Ke,Ee,le,He;return a.jsxs("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[a.jsx("div",{className:"w-32",children:a.jsx("span",{className:"font-semibold text-afri-gray-900 capitalize",children:ee})}),a.jsxs("label",{className:"flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:(Ce=(ve=b.businessHours)==null?void 0:ve[ee])==null?void 0:Ce.isOpen,onChange:et=>P(ee,"isOpen",et.target.checked),className:"h-5 w-5 text-afri-green focus:ring-afri-green border-gray-300 rounded cursor-pointer"}),a.jsx("span",{className:"ml-2 text-sm text-afri-gray-700",children:"Open"})]}),($e=(De=b.businessHours)==null?void 0:De[ee])!=null&&$e.isOpen?a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"time",value:((Ee=(Ke=b.businessHours)==null?void 0:Ke[ee])==null?void 0:Ee.open)||"09:00",onChange:et=>P(ee,"open",et.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent"}),a.jsx("span",{className:"text-gray-500",children:"to"}),a.jsx("input",{type:"time",value:((He=(le=b.businessHours)==null?void 0:le[ee])==null?void 0:He.close)||"18:00",onChange:et=>P(ee,"close",et.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent"})]}):a.jsx("span",{className:"text-gray-400 italic ml-4",children:"Closed"})]},ee)})})]}),a.jsx("div",{className:"flex justify-end pt-6 border-t",children:a.jsx("button",{onClick:z,disabled:f,className:"px-8 py-3 bg-gradient-to-r from-afri-green to-afri-green-dark text-white rounded-lg font-semibold shadow-lg hover:shadow-xl transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center",children:f?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save Changes"})})]}),o==="security"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 space-y-6 animate-fadeIn",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-afri-gray-900 mb-4",children:"Change Password"}),a.jsxs("div",{className:"max-w-md space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Current Password"}),a.jsx("input",{type:"password",value:O.currentPassword,onChange:ee=>k("currentPassword",ee.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"New Password"}),a.jsx("input",{type:"password",value:O.newPassword,onChange:ee=>k("newPassword",ee.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all"}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Must be at least 6 characters"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Confirm New Password"}),a.jsx("input",{type:"password",value:O.confirmPassword,onChange:ee=>k("confirmPassword",ee.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all"})]})]})]}),a.jsx("div",{className:"flex justify-end pt-6 border-t",children:a.jsx("button",{onClick:de,disabled:f,className:"px-8 py-3 bg-gradient-to-r from-afri-green to-afri-green-dark text-white rounded-lg font-semibold shadow-lg hover:shadow-xl transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center",children:f?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Changing..."]}):"Change Password"})})]}),a.jsx("style",{jsx:!0,children:`
        @keyframes fadeIn {
          from {
            opacity: 0;
            transform: translateY(10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .animate-fadeIn {
          animation: fadeIn 0.3s ease-out;
        }
      `})]})}function qw(){var m,j,v;const[e,r]=ge.useState([]),[t,n]=ge.useState(null),[s,o]=ge.useState(!0),[l,c]=ge.useState(!1);ge.useEffect(()=>{d()},[]);const d=async()=>{try{o(!0);const[N,b]=await Promise.all([Il.getPlans(),Il.getMySubscription()]);N.success&&r(N.data.plans),b.success&&n(b.data.subscription)}catch(N){console.error("Error fetching subscription data:",N)}finally{o(!1)}},f=async N=>{var b,y;try{c(!0),(await Il.subscribe({planId:N})).success&&(alert("Subscription activated successfully!"),d())}catch(_){alert(((y=(b=_.response)==null?void 0:b.data)==null?void 0:y.message)||"Failed to subscribe")}finally{c(!1)}},u=async()=>{var N,b;if(confirm("Are you sure you want to cancel your subscription?"))try{c(!0),(await Il.cancel()).success&&(alert("Subscription cancelled successfully"),d())}catch(y){alert(((b=(N=y.response)==null?void 0:N.data)==null?void 0:b.message)||"Failed to cancel subscription")}finally{c(!1)}},g=N=>({Free:["Up to 50 products","Basic analytics","Email support","5% transaction fee","Standard listing"],Starter:["Up to 200 products","Advanced analytics","Priority email support","3% transaction fee","Featured listing","Promotional tools"],Professional:["Unlimited products","Advanced analytics & reports","24/7 priority support","2% transaction fee","Premium listing","Marketing tools","Custom branding","API access"],Enterprise:["Everything in Professional","Dedicated account manager","1% transaction fee","White-label solution","Custom integrations","Advanced security","SLA guarantee"]})[N]||[],p=N=>({Free:"from-gray-400 to-gray-500",Starter:"from-blue-500 to-blue-600",Professional:"from-afri-green to-afri-green-dark",Enterprise:"from-purple-600 to-purple-700"})[N]||"from-gray-400 to-gray-500";return s?a.jsx("div",{className:"flex justify-center items-center h-screen",children:a.jsx("div",{className:"relative",children:a.jsx("div",{className:"w-20 h-20 border-4 border-afri-green border-t-transparent rounded-full animate-spin"})})}):a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-afri-green to-afri-green-dark bg-clip-text text-transparent",children:"Subscription Plans"}),a.jsx("p",{className:"text-afri-gray-600 mt-2",children:"Choose the perfect plan for your business"})]}),t&&a.jsx("div",{className:"bg-gradient-to-r from-afri-green to-afri-green-dark rounded-xl shadow-2xl p-6 text-white animate-slideDown",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-2xl font-bold mb-2",children:["Current Plan: ",(m=t.plan)==null?void 0:m.name]}),a.jsx("p",{className:"opacity-90",children:t.status==="active"?a.jsxs(a.Fragment,{children:[(((j=t.plan)==null?void 0:j.interval)==="monthly","Renews")," on"," ",new Date(t.currentPeriodEnd).toLocaleDateString()]}):`Status: ${t.status}`})]}),t.status==="active"&&((v=t.plan)==null?void 0:v.name)!=="Free"&&a.jsx("button",{onClick:u,disabled:l,className:"px-6 py-3 bg-white text-afri-green rounded-lg font-semibold hover:bg-gray-100 transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel Subscription"})]})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:e.map((N,b)=>{var y,_;return a.jsxs("div",{className:`relative bg-white rounded-2xl shadow-xl overflow-hidden transform transition-all duration-300 hover:scale-105 hover:shadow-2xl animate-fadeIn ${((y=t==null?void 0:t.plan)==null?void 0:y._id)===N._id?"ring-4 ring-afri-green":""}`,style:{animationDelay:`${b*100}ms`},children:[N.name==="Professional"&&a.jsx("div",{className:"absolute top-0 right-0 bg-gradient-to-r from-afri-yellow to-afri-yellow-dark text-white px-4 py-1 text-xs font-bold rounded-bl-lg",children:"POPULAR"}),a.jsxs("div",{className:`bg-gradient-to-r ${p(N.name)} text-white p-6`,children:[a.jsx("h3",{className:"text-2xl font-bold mb-2",children:N.name}),a.jsxs("div",{className:"flex items-baseline",children:[a.jsxs("span",{className:"text-4xl font-bold",children:["Â£",N.price]}),a.jsxs("span",{className:"ml-2 opacity-90",children:["/",N.interval]})]})]}),a.jsxs("div",{className:"p-6",children:[a.jsx("ul",{className:"space-y-3 mb-6",children:g(N.name).map((T,O)=>a.jsxs("li",{className:"flex items-start",children:[a.jsx("svg",{className:"w-5 h-5 text-afri-green mr-2 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),a.jsx("span",{className:"text-sm text-afri-gray-700",children:T})]},O))}),((_=t==null?void 0:t.plan)==null?void 0:_._id)===N._id?a.jsx("div",{className:"bg-afri-green text-white text-center py-3 rounded-lg font-semibold",children:"Current Plan"}):a.jsx("button",{onClick:()=>f(N._id),disabled:l||N.price===0,className:`w-full py-3 rounded-lg font-semibold transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none ${N.name==="Professional"?"bg-gradient-to-r from-afri-green to-afri-green-dark text-white shadow-lg hover:shadow-xl":"bg-gray-100 text-afri-gray-900 hover:bg-gray-200"}`,children:l?"Processing...":N.price===0?"Current Plan":"Upgrade Now"})]})]},N._id)})}),a.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 rounded-2xl p-8 mt-12",children:[a.jsx("h2",{className:"text-3xl font-bold text-center text-afri-gray-900 mb-8",children:"Why Upgrade to Premium?"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg transform transition-all hover:scale-105",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center text-3xl mb-4 mx-auto",children:"ðŸ“ˆ"}),a.jsx("h3",{className:"text-xl font-bold text-center text-afri-gray-900 mb-2",children:"Grow Your Sales"}),a.jsx("p",{className:"text-center text-afri-gray-600",children:"Get featured listings and access to promotional tools to boost your visibility and sales."})]}),a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg transform transition-all hover:scale-105",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-afri-green to-afri-green-dark rounded-full flex items-center justify-center text-3xl mb-4 mx-auto",children:"ðŸ“Š"}),a.jsx("h3",{className:"text-xl font-bold text-center text-afri-gray-900 mb-2",children:"Advanced Analytics"}),a.jsx("p",{className:"text-center text-afri-gray-600",children:"Make data-driven decisions with comprehensive reports and insights about your business."})]}),a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg transform transition-all hover:scale-105",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-purple-500 to-purple-600 rounded-full flex items-center justify-center text-3xl mb-4 mx-auto",children:"ðŸŽ¨"}),a.jsx("h3",{className:"text-xl font-bold text-center text-afri-gray-900 mb-2",children:"Custom Branding"}),a.jsx("p",{className:"text-center text-afri-gray-600",children:"Stand out with custom branding options and create a unique shopping experience."})]})]})]}),a.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[a.jsx("h2",{className:"text-3xl font-bold text-center text-afri-gray-900 mb-8",children:"Frequently Asked Questions"}),a.jsxs("div",{className:"space-y-4 max-w-3xl mx-auto",children:[a.jsxs("details",{className:"group",children:[a.jsxs("summary",{className:"flex items-center justify-between cursor-pointer p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[a.jsx("span",{className:"font-semibold text-afri-gray-900",children:"Can I change my plan anytime?"}),a.jsx("svg",{className:"w-5 h-5 transition-transform group-open:rotate-180",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),a.jsx("p",{className:"p-4 text-afri-gray-600",children:"Yes! You can upgrade or downgrade your plan at any time. Changes will be reflected in your next billing cycle."})]}),a.jsxs("details",{className:"group",children:[a.jsxs("summary",{className:"flex items-center justify-between cursor-pointer p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[a.jsx("span",{className:"font-semibold text-afri-gray-900",children:"What payment methods do you accept?"}),a.jsx("svg",{className:"w-5 h-5 transition-transform group-open:rotate-180",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),a.jsx("p",{className:"p-4 text-afri-gray-600",children:"We accept all major credit cards, debit cards, and bank transfers. All payments are processed securely through our payment gateway."})]}),a.jsxs("details",{className:"group",children:[a.jsxs("summary",{className:"flex items-center justify-between cursor-pointer p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[a.jsx("span",{className:"font-semibold text-afri-gray-900",children:"Is there a contract or commitment?"}),a.jsx("svg",{className:"w-5 h-5 transition-transform group-open:rotate-180",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),a.jsx("p",{className:"p-4 text-afri-gray-600",children:"No long-term contracts! All plans are month-to-month and you can cancel at any time without penalty."})]}),a.jsxs("details",{className:"group",children:[a.jsxs("summary",{className:"flex items-center justify-between cursor-pointer p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[a.jsx("span",{className:"font-semibold text-afri-gray-900",children:"What happens if I cancel?"}),a.jsx("svg",{className:"w-5 h-5 transition-transform group-open:rotate-180",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),a.jsx("p",{className:"p-4 text-afri-gray-600",children:"Your subscription will remain active until the end of your current billing period. After that, you'll be automatically moved to the Free plan."})]})]})]}),a.jsx("style",{jsx:!0,children:`
        @keyframes fadeIn {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        @keyframes slideDown {
          from {
            opacity: 0;
            transform: translateY(-20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .animate-fadeIn {
          animation: fadeIn 0.5s ease-out forwards;
        }

        .animate-slideDown {
          animation: slideDown 0.4s ease-out;
        }
      `})]})}function Vw({title:e,titleId:r,...t},n){return ge.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?ge.createElement("title",{id:r},e):null,ge.createElement("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25ZM12.75 6a.75.75 0 0 0-1.5 0v6c0 .414.336.75.75.75h4.5a.75.75 0 0 0 0-1.5h-3.75V6Z",clipRule:"evenodd"}))}const Gw=ge.forwardRef(Vw);function $w({title:e,titleId:r,...t},n){return ge.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?ge.createElement("title",{id:r},e):null,ge.createElement("path",{fillRule:"evenodd",d:"M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z",clipRule:"evenodd"}))}const Yw=ge.forwardRef($w);function Kw({title:e,titleId:r,...t},n){return ge.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?ge.createElement("title",{id:r},e):null,ge.createElement("path",{fillRule:"evenodd",d:"m11.54 22.351.07.04.028.016a.76.76 0 0 0 .723 0l.028-.015.071-.041a16.975 16.975 0 0 0 1.144-.742 19.58 19.58 0 0 0 2.683-2.282c1.944-1.99 3.963-4.98 3.963-8.827a8.25 8.25 0 0 0-16.5 0c0 3.846 2.02 6.837 3.963 8.827a19.58 19.58 0 0 0 2.682 2.282 16.975 16.975 0 0 0 1.145.742ZM12 13.5a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z",clipRule:"evenodd"}))}const Xw=ge.forwardRef(Kw);function Jw({title:e,titleId:r,...t},n){return ge.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?ge.createElement("title",{id:r},e):null,ge.createElement("path",{fillRule:"evenodd",d:"M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z",clipRule:"evenodd"}))}const Zw=ge.forwardRef(Jw);function Qw(){const e=xn(),[r,t]=ge.useState(""),[n,s]=ge.useState(!1),o=[{id:1,name:"Green Valley Farms",category:"Fresh Produce",image:"https://images.unsplash.com/photo-1542838132-92c53300491e?w=600",rating:4.8,deliveryTime:"20-30 min",minOrder:"Â£10",tags:["Vegetables","Fruits","Organic"]},{id:2,name:"African Spice Market",category:"African Groceries",image:"https://images.unsplash.com/photo-1488459716781-31db52582fe9?w=600",rating:4.9,deliveryTime:"25-35 min",minOrder:"Â£15",tags:["Spices","Grains","Authentic"]},{id:3,name:"Fresh Meat & Fish",category:"Butcher & Seafood",image:"https://images.unsplash.com/photo-1607623814075-e51df1bdc82f?w=600",rating:4.7,deliveryTime:"30-40 min",minOrder:"Â£20",tags:["Halal","Fresh Fish","Quality"]},{id:4,name:"Daily Dairy",category:"Dairy & Bakery",image:"https://images.unsplash.com/photo-1563636619-e9143da7973b?w=600",rating:4.6,deliveryTime:"15-25 min",minOrder:"Â£8",tags:["Milk","Cheese","Bread"]},{id:5,name:"Tropical Fruits Hub",category:"Exotic Fruits",image:"https://images.unsplash.com/photo-1619566636858-adf3ef46400b?w=600",rating:4.8,deliveryTime:"20-30 min",minOrder:"Â£12",tags:["Plantain","Mango","Yam"]},{id:6,name:"Lagos Kitchen Store",category:"Nigerian Foods",image:"https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=600",rating:4.9,deliveryTime:"25-35 min",minOrder:"Â£15",tags:["Nigerian","Palm Oil","Cassava"]}],l=c=>{c.preventDefault(),r.trim()&&e(`/stores?location=${encodeURIComponent(r)}`)};return a.jsxs("div",{className:"min-h-screen bg-white",children:[a.jsx("nav",{className:"bg-white border-b border-gray-200 sticky top-0 z-50 shadow-sm",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:[a.jsxs("div",{className:"flex justify-between items-center h-16",children:[a.jsxs(Ie,{to:"/",className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-green-600 to-yellow-500 rounded-lg flex items-center justify-center",children:a.jsx("span",{className:"text-white font-bold text-lg",children:"ðŸ›’"})}),a.jsxs("span",{className:"text-xl font-bold text-gray-900",children:["Afri",a.jsx("span",{className:"text-green-600",children:"Mercato"})]})]}),a.jsxs("div",{className:"hidden md:flex items-center space-x-6",children:[a.jsx("a",{href:"#stores",className:"text-gray-600 hover:text-green-600",children:"Browse Stores"}),a.jsx("a",{href:"#how-it-works",className:"text-gray-600 hover:text-green-600",children:"How It Works"}),a.jsx(Ie,{to:"/partner",className:"text-gray-600 hover:text-green-600",children:"Partner With Us"}),a.jsx(Ie,{to:"/login",className:"text-green-600 hover:text-green-700 font-medium",children:"Sign In"}),a.jsx(Ie,{to:"/register?role=customer",className:"bg-green-600 hover:bg-green-700 text-white px-5 py-2 rounded-lg font-medium",children:"Sign Up"})]}),a.jsx("button",{onClick:()=>s(!n),className:"md:hidden p-2",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:n?"M6 18L18 6M6 6l12 12":"M4 6h16M4 12h16M4 18h16"})})})]}),n&&a.jsxs("div",{className:"md:hidden py-4 border-t",children:[a.jsx("a",{href:"#stores",className:"block py-2 text-gray-600",children:"Browse Stores"}),a.jsx("a",{href:"#how-it-works",className:"block py-2 text-gray-600",children:"How It Works"}),a.jsx(Ie,{to:"/partner",className:"block py-2 text-gray-600",children:"Partner With Us"}),a.jsx(Ie,{to:"/login",className:"block py-2 text-green-600 font-medium",children:"Sign In"}),a.jsx(Ie,{to:"/register?role=customer",className:"block mt-2 bg-green-600 text-white px-4 py-2 rounded-lg text-center font-medium",children:"Sign Up"})]})]})}),a.jsxs("section",{className:"relative bg-gradient-to-br from-green-600 via-green-700 to-yellow-500 overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 opacity-10",children:a.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.4'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}})}),a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 py-16 sm:py-24 relative",children:a.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 items-center",children:[a.jsxs("div",{className:"text-center lg:text-left",children:[a.jsxs(Re.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-4xl sm:text-5xl lg:text-6xl font-bold text-white mb-6 leading-tight",children:["African Online Store",a.jsx("br",{}),a.jsx("span",{className:"text-yellow-300",children:"In the United Kingdom"})]}),a.jsx(Re.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"text-lg sm:text-xl text-white/95 mb-8 max-w-2xl mx-auto lg:mx-0",children:"Use existing infrastructure of African products you depend on delivered to your doorstep. Open stores, fresh products delivered to you whenever convenient."}),a.jsxs(Re.form,{onSubmit:l,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-2xl shadow-2xl p-3 flex flex-col sm:flex-row gap-3 max-w-2xl mx-auto lg:mx-0",children:[a.jsxs("div",{className:"flex-1 flex items-center gap-3 bg-gray-50 rounded-xl px-4 py-3",children:[a.jsx(Xw,{className:"w-6 h-6 text-green-600 flex-shrink-0"}),a.jsx("input",{type:"text",value:r,onChange:c=>t(c.target.value),placeholder:"Enter your location (e.g., London, Manchester)",className:"flex-1 bg-transparent border-none outline-none text-gray-900 placeholder-gray-500"})]}),a.jsxs("button",{type:"submit",className:"bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white px-8 py-3 rounded-xl font-bold shadow-lg flex items-center justify-center gap-2 transition-all",children:[a.jsx(Yw,{className:"w-5 h-5"}),"Find Store"]})]}),a.jsxs(Re.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"mt-6 text-white/90 flex items-center justify-center lg:justify-start gap-2",children:[a.jsx("span",{className:"text-2xl",children:"ðŸ‘¥"}),a.jsxs("span",{className:"font-semibold",children:["Trusted by: ",a.jsx("span",{className:"text-yellow-300",children:"4,320+ Vendors"})]})]})]}),a.jsx(Re.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2},className:"hidden lg:block",children:a.jsx("img",{src:"https://images.unsplash.com/photo-1567393537607-1e1a6df6763a?w=800",alt:"Happy customer with groceries",className:"rounded-3xl shadow-2xl w-full object-cover"})})]})})]}),a.jsx("section",{className:"py-8 bg-gray-50 border-b",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4",children:a.jsx("div",{className:"flex gap-4 overflow-x-auto pb-2 scrollbar-hide",children:[{icon:"ðŸ¥¬",name:"Vegetables",color:"bg-green-100 text-green-700"},{icon:"ðŸŒ",name:"Fruits",color:"bg-yellow-100 text-yellow-700"},{icon:"ðŸ¥©",name:"Meat & Fish",color:"bg-red-100 text-red-700"},{icon:"ðŸ¥›",name:"Dairy",color:"bg-blue-100 text-blue-700"},{icon:"ðŸŒ¶ï¸",name:"Spices",color:"bg-orange-100 text-orange-700"},{icon:"ðŸŒ¾",name:"Grains",color:"bg-amber-100 text-amber-700"}].map((c,d)=>a.jsxs("button",{className:`${c.color} px-6 py-3 rounded-xl font-semibold whitespace-nowrap flex items-center gap-2 hover:scale-105 transition-transform`,children:[a.jsx("span",{className:"text-2xl",children:c.icon}),c.name]},d))})})}),a.jsx("section",{id:"stores",className:"py-16",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-8",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-2",children:"Browse Nearby"}),a.jsx("p",{className:"text-gray-600",children:"Popular stores in your area"})]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsx("button",{className:"px-4 py-2 bg-green-600 text-white rounded-lg font-semibold",children:"Top Stores"}),a.jsx("button",{className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg font-semibold hover:bg-gray-200",children:"Featured Stores"})]})]}),a.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-6",children:o.map(c=>a.jsxs(Re.div,{whileHover:{y:-5},className:"bg-white rounded-2xl shadow-lg hover:shadow-xl border border-gray-100 overflow-hidden cursor-pointer transition-all",onClick:()=>e(`/store/${c.id}`),children:[a.jsxs("div",{className:"relative h-48",children:[a.jsx("img",{src:c.image,alt:c.name,className:"w-full h-full object-cover"}),a.jsxs("div",{className:"absolute top-3 right-3 bg-white px-3 py-1 rounded-full shadow-md flex items-center gap-1",children:[a.jsx(Zw,{className:"w-4 h-4 text-yellow-500"}),a.jsx("span",{className:"font-bold text-gray-900",children:c.rating})]})]}),a.jsxs("div",{className:"p-5",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:c.name}),a.jsx("p",{className:"text-sm text-gray-600 mb-3",children:c.category}),a.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:c.tags.slice(0,3).map((d,f)=>a.jsx("span",{className:"bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-xs font-medium",children:d},f))}),a.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 pt-3 border-t",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Gw,{className:"w-4 h-4"}),a.jsx("span",{children:c.deliveryTime})]}),a.jsxs("div",{className:"font-semibold text-gray-900",children:["Min. ",c.minOrder]})]})]})]},c.id))}),a.jsx("div",{className:"text-center mt-10",children:a.jsx("button",{className:"bg-green-600 hover:bg-green-700 text-white px-8 py-3 rounded-xl font-bold shadow-lg",children:"View All Stores"})})]})}),a.jsx("section",{id:"how-it-works",className:"py-16 bg-gradient-to-br from-green-50 to-yellow-50",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[a.jsxs("div",{className:"text-center mb-12",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-2",children:"How It Works"}),a.jsx("p",{className:"text-lg text-gray-600",children:"Get fresh African groceries delivered in 3 simple steps"})]}),a.jsx("div",{className:"grid sm:grid-cols-3 gap-8",children:[{num:1,icon:"ðŸ”",title:"Find Stores Near You",desc:"Enter your location and browse stores in your area"},{num:2,icon:"ðŸ›’",title:"Add to Cart",desc:"Choose products from multiple vendors in one order"},{num:3,icon:"ðŸšš",title:"Fast Delivery",desc:"Get your groceries delivered same-day"}].map(c=>a.jsxs(Re.div,{className:"text-center",whileHover:{y:-5},children:[a.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-green-500 to-green-700 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg",children:a.jsx("span",{className:"text-4xl",children:c.icon})}),a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:c.title}),a.jsx("p",{className:"text-gray-600",children:c.desc})]},c.num))})]})}),a.jsx("section",{className:"bg-gradient-to-r from-yellow-400 via-yellow-500 to-green-600 py-16",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-4 text-center",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-4",children:"Are You a Food Vendor?"}),a.jsx("p",{className:"text-lg text-gray-800 mb-8",children:"Join 4,320+ vendors already selling on AfriMercato. Reach thousands of customers and grow your business online."}),a.jsx(Ie,{to:"/partner",className:"inline-block bg-gray-900 text-white hover:bg-gray-800 px-10 py-4 rounded-xl font-bold shadow-2xl text-lg",children:"Partner With Us â†’"})]})}),a.jsx("footer",{className:"bg-gray-900 text-gray-300 py-12",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-8",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-bold mb-4",children:"AfriMercato"}),a.jsx("p",{className:"text-sm",children:"African groceries delivered to your door across the UK."})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-bold mb-4",children:"For Customers"}),a.jsxs("ul",{className:"space-y-2 text-sm",children:[a.jsx("li",{children:a.jsx("a",{href:"#stores",className:"hover:text-yellow-400",children:"Browse Stores"})}),a.jsx("li",{children:a.jsx("a",{href:"#how-it-works",className:"hover:text-yellow-400",children:"How It Works"})}),a.jsx("li",{children:a.jsx(Ie,{to:"/register?role=customer",className:"hover:text-yellow-400",children:"Sign Up"})})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-bold mb-4",children:"For Partners"}),a.jsxs("ul",{className:"space-y-2 text-sm",children:[a.jsx("li",{children:a.jsx(Ie,{to:"/partner",className:"hover:text-yellow-400",children:"Become a Vendor"})}),a.jsx("li",{children:a.jsx(Ie,{to:"/register?role=rider",className:"hover:text-yellow-400",children:"Become a Rider"})}),a.jsx("li",{children:a.jsx(Ie,{to:"/register?role=picker",className:"hover:text-yellow-400",children:"Become a Picker"})})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-bold mb-4",children:"Company"}),a.jsxs("ul",{className:"space-y-2 text-sm",children:[a.jsx("li",{children:a.jsx("a",{href:"#",className:"hover:text-yellow-400",children:"About Us"})}),a.jsx("li",{children:a.jsx("a",{href:"#",className:"hover:text-yellow-400",children:"Contact"})}),a.jsx("li",{children:a.jsx("a",{href:"#",className:"hover:text-yellow-400",children:"Privacy Policy"})})]})]})]}),a.jsx("div",{className:"border-t border-gray-800 mt-8 pt-8 text-center text-sm",children:a.jsx("p",{children:"Â© 2025 AfriMercato. All rights reserved."})})]})})]})}const e3="https://images.unsplash.com/photo-1531123897727-8f129e1688ce?w=800&q=80";function t3(){const e=xn(),[r,t]=ge.useState(""),[n,s]=ge.useState("all"),[o,l]=ge.useState("all"),[c,d]=ge.useState(!1),[f,u]=ge.useState(!1),[g]=ge.useState(["Bristol","London","Manchester","Birmingham"]),[p,m]=ge.useState(!1),j=ge.useRef(null),{scrollY:v}=hm(),N=Xd(v,[0,500],[0,150]),b=Xd(v,[0,300],[1,.3]);ge.useEffect(()=>{const O=()=>u(window.scrollY>20);return window.addEventListener("scroll",O),()=>window.removeEventListener("scroll",O)},[]);const y=O=>{var B;if(O==null||O.preventDefault(),!r.trim()){(B=j.current)==null||B.focus();return}e(`/stores?location=${encodeURIComponent(r)}&price=${n}&method=${o}`)},_=O=>{t(O),m(!1),e(`/stores?location=${encodeURIComponent(O)}`)},T=[{id:1,name:"Yours Supermarket",image:"https://images.unsplash.com/photo-1604719312566-8912e9227c6a?w=600",hours:"06:00am - 09:00pm",location:"Leicester United Kingdom",distance:"0.1km",deliveryTime:"50 mins",priceRange:"Â£10-Â£500",rating:4.5,isOpen:!0,deliveryFee:"Â£25",methods:["Shopping","Pickup","Delivery"]},{id:2,name:"TESCO Supermarket",image:"https://images.unsplash.com/photo-1534723452862-4c874018d66d?w=600",hours:"06:00am - 08:00pm",location:"Leicester United Kingdom",distance:"1.2km",deliveryTime:"30 mins",priceRange:"Â£10-Â£500",rating:4.8,isOpen:!0,deliveryFee:"Â£25",methods:["In-Shopping","Delivery"]},{id:3,name:"Yours Supermarket",image:"https://images.unsplash.com/photo-1578916171728-46686eac8d58?w=600",hours:"06:00am - 06:00pm",location:"Leicester United Kingdom",distance:"2.8km",deliveryTime:"20 mins",priceRange:"Â£10-Â£500",rating:4.2,isOpen:!0,deliveryFee:"Â£25",methods:["Shopping","Fitted","In-Shopping","Delivery"]}];return a.jsxs("div",{className:"min-h-screen bg-[#F5A623]",children:[a.jsx(Re.nav,{initial:{y:-100},animate:{y:0},className:`fixed top-0 left-0 right-0 z-50 transition-all duration-300 ${f?"bg-white/95 backdrop-blur-md shadow-lg":"bg-transparent"}`,children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs("div",{className:"flex items-center justify-between h-16 sm:h-20",children:[a.jsxs(Ie,{to:"/",className:"flex items-center gap-2 group",children:[a.jsx(Re.div,{whileHover:{rotate:360},transition:{duration:.5},className:"relative",children:a.jsx("svg",{className:"w-8 h-8 sm:w-10 sm:h-10",viewBox:"0 0 40 40",fill:"none",children:a.jsx("path",{d:"M8 8L32 32M32 8L8 32",stroke:"#1a1a1a",strokeWidth:"4",strokeLinecap:"round"})})}),a.jsx("span",{className:"text-xl sm:text-2xl font-bold tracking-tight text-gray-900",children:"Afrimercato"})]}),a.jsx("div",{className:"hidden md:flex items-center",children:a.jsxs("div",{className:`flex items-center gap-1 px-2 py-2 rounded-full ${f?"bg-gray-100":"bg-white/90 backdrop-blur-sm"} shadow-sm`,children:[a.jsx(Jl,{href:"/delivery",children:"Delivery"}),a.jsx(Jl,{href:"/stores",active:!0,children:"Stores"}),a.jsx(Jl,{href:"/about",children:"About us"}),a.jsx(Jl,{href:"/contact",children:"Contact us"})]})}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Ie,{to:"/login",className:"hidden sm:block font-medium text-gray-800 hover:text-gray-900 transition-colors",children:"Log in"}),a.jsx(Re.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:a.jsxs(Ie,{to:"/register",className:"flex items-center gap-2 bg-[#00897B] hover:bg-[#00695C] text-white px-4 sm:px-5 py-2.5 rounded-full font-semibold shadow-lg transition-all",children:[a.jsx("span",{className:"hidden sm:inline",children:"Sign Up"}),a.jsx("span",{className:"sm:hidden",children:"Join"}),a.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})})]})}),a.jsx("button",{onClick:()=>d(!c),className:"md:hidden p-2 rounded-lg hover:bg-white/20","aria-label":"Menu",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:c?"M6 18L18 6M6 6l12 12":"M4 6h16M4 12h16M4 18h16"})})})]})]}),a.jsx(Ql,{children:c&&a.jsx(Re.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"md:hidden bg-white rounded-2xl mb-4 overflow-hidden shadow-xl",children:a.jsxs("div",{className:"p-4 space-y-2",children:[a.jsx(Zl,{to:"/stores",onClick:()=>d(!1),children:"Stores"}),a.jsx(Zl,{to:"/delivery",onClick:()=>d(!1),children:"Delivery"}),a.jsx(Zl,{to:"/about",onClick:()=>d(!1),children:"About us"}),a.jsx(Zl,{to:"/contact",onClick:()=>d(!1),children:"Contact us"}),a.jsx("div",{className:"pt-3 border-t",children:a.jsx(Ie,{to:"/login",className:"block py-3 text-center text-[#00897B] font-semibold",onClick:()=>d(!1),children:"Log in"})})]})})})]})}),a.jsxs("section",{className:"relative min-h-screen pt-20 sm:pt-24 pb-8 overflow-hidden",children:[a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs("div",{className:"grid lg:grid-cols-2 gap-8 lg:gap-12 items-center min-h-[calc(100vh-180px)]",children:[a.jsxs(Re.div,{style:{y:N,opacity:b},className:"relative z-10 pt-8 lg:pt-0",children:[a.jsxs(Re.h1,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,ease:[.22,1,.36,1]},className:"text-4xl sm:text-5xl lg:text-6xl xl:text-7xl font-bold text-gray-900 leading-[1.1] tracking-tight",children:["We Help With the Shopping and Bring it to your"," ",a.jsxs("span",{className:"text-[#00897B] relative inline-block",children:['"DoorStep"',a.jsx(Re.svg,{initial:{pathLength:0},animate:{pathLength:1},transition:{delay:1,duration:.8},className:"absolute -bottom-2 left-0 w-full h-3",viewBox:"0 0 200 12",children:a.jsx(Re.path,{d:"M2 10C50 2 150 2 198 10",stroke:"#00897B",strokeWidth:"3",fill:"none",strokeLinecap:"round"})})]})]}),a.jsx(Re.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3,duration:.6},className:"mt-6 text-lg sm:text-xl text-gray-700 max-w-xl leading-relaxed",children:"Experience the convenience of African and international groceries delivered right to your door. Fresh produce, authentic flavors, fast delivery across the UK."}),a.jsxs(Re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5,duration:.6},className:"mt-8 flex flex-wrap items-center gap-4",children:[a.jsx(Re.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:a.jsx(Ie,{to:"/partner",className:"inline-flex items-center gap-2 bg-[#00897B] hover:bg-[#00695C] text-white px-6 sm:px-8 py-3.5 sm:py-4 rounded-xl font-bold shadow-xl transition-all text-base sm:text-lg",children:"Partner With Us"})}),a.jsx(Re.button,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"relative group",children:a.jsxs("div",{className:"relative w-16 h-16 sm:w-20 sm:h-20",children:[a.jsxs("svg",{className:"absolute inset-0 w-full h-full animate-spin-slow",viewBox:"0 0 100 100",children:[a.jsx("defs",{children:a.jsx("path",{id:"circlePath",d:"M 50, 50 m -37, 0 a 37,37 0 1,1 74,0 a 37,37 0 1,1 -74,0"})}),a.jsx("text",{className:"text-[8px] sm:text-[9px] fill-gray-700 font-medium uppercase tracking-widest",children:a.jsx("textPath",{href:"#circlePath",children:"Learn about us through this video â€¢"})})]}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:a.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-white rounded-full flex items-center justify-center shadow-lg group-hover:shadow-xl transition-shadow",children:a.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-[#00897B] ml-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"})})})})]})})]}),a.jsxs(Re.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8,duration:.6},className:"mt-10 flex items-center gap-4",children:[a.jsxs("div",{className:"flex -space-x-3",children:[[1,2,3].map(O=>a.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-white/80 border-3 border-[#F5A623] flex items-center justify-center text-lg",children:["ðŸ‘©ðŸ¾","ðŸ‘¨ðŸ¿","ðŸ‘©ðŸ½"][O-1]},O)),a.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-white border-3 border-[#F5A623] flex items-center justify-center text-xs sm:text-sm font-bold text-gray-700",children:"+4K"})]}),a.jsxs("p",{className:"text-gray-800 font-medium text-sm sm:text-base",children:["Trusted by ",a.jsx("span",{className:"font-bold text-gray-900",children:"4,320+"})," Vendors"]})]})]}),a.jsx(Re.div,{initial:{opacity:0,x:100},animate:{opacity:1,x:0},transition:{duration:1,ease:[.22,1,.36,1]},className:"relative hidden lg:block",children:a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"relative z-10",children:a.jsx("img",{src:e3,alt:"Happy customer with fresh groceries",className:"w-full h-[500px] xl:h-[600px] object-cover object-top rounded-3xl",onError:O=>{O.target.src="https://images.unsplash.com/photo-1573497019940-1c28c88b4f3e?w=800&q=80"}})}),a.jsx(Re.div,{animate:{y:[0,-10,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},className:"absolute top-10 -left-8 bg-white rounded-2xl p-4 shadow-xl z-20",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:a.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-bold text-gray-900",children:"Fresh Daily"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Quality guaranteed"})]})]})}),a.jsx(Re.div,{animate:{y:[0,10,0]},transition:{duration:4,repeat:1/0,ease:"easeInOut",delay:1},className:"absolute bottom-20 -right-4 bg-white rounded-2xl p-4 shadow-xl z-20",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-xl flex items-center justify-center text-2xl",children:"ðŸšš"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-bold text-gray-900",children:"Fast Delivery"}),a.jsx("p",{className:"text-sm text-gray-600",children:"20-30 minutes"})]})]})})]})})]}),a.jsxs(Re.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{delay:.6,duration:.8},className:"relative z-20 mt-8 lg:-mt-4",children:[a.jsx("form",{onSubmit:y,className:"bg-white rounded-2xl sm:rounded-full shadow-2xl p-3 sm:p-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-0 sm:items-center",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsxs("div",{className:"flex items-center gap-3 px-4 sm:px-6 py-3 sm:py-0",children:[a.jsx("svg",{className:"w-5 h-5 text-gray-400 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),a.jsx("input",{ref:j,type:"text",value:r,onChange:O=>t(O.target.value),onFocus:()=>m(!0),onBlur:()=>setTimeout(()=>m(!1),200),placeholder:"Postcode, store name, location",className:"flex-1 bg-transparent border-none outline-none text-gray-900 placeholder-gray-500 text-base sm:text-lg"})]}),a.jsx(Ql,{children:p&&a.jsx(Re.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute top-full left-0 right-0 mt-2 bg-white rounded-xl shadow-2xl border border-gray-100 overflow-hidden z-50",children:a.jsxs("div",{className:"p-3",children:[a.jsx("p",{className:"text-xs text-gray-500 font-medium mb-2 px-2",children:"Recent searches"}),g.map(O=>a.jsxs("button",{type:"button",onClick:()=>_(O),className:"w-full flex items-center gap-3 px-3 py-2.5 hover:bg-gray-50 rounded-lg transition-colors text-left",children:[a.jsx("svg",{className:"w-4 h-4 text-orange-500",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})}),a.jsx("span",{className:"text-gray-700",children:O})]},O))]})})})]}),a.jsx("div",{className:"hidden sm:block w-px h-10 bg-gray-200 mx-2"}),a.jsx("div",{className:"sm:w-36",children:a.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 sm:py-0",children:[a.jsx("svg",{className:"w-5 h-5 text-gray-400 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),a.jsxs("select",{value:n,onChange:O=>s(O.target.value),className:"flex-1 bg-transparent border-none outline-none text-gray-700 cursor-pointer text-sm appearance-none",children:[a.jsx("option",{value:"all",children:"Price Tag"}),a.jsx("option",{value:"budget",children:"Budget"}),a.jsx("option",{value:"mid",children:"Mid Range"}),a.jsx("option",{value:"premium",children:"Premium"})]})]})}),a.jsx("div",{className:"hidden sm:block w-px h-10 bg-gray-200 mx-2"}),a.jsx("div",{className:"sm:w-44",children:a.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 sm:py-0",children:[a.jsx("svg",{className:"w-5 h-5 text-gray-400 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),a.jsxs("select",{value:o,onChange:O=>l(O.target.value),className:"flex-1 bg-transparent border-none outline-none text-gray-700 cursor-pointer text-sm appearance-none",children:[a.jsx("option",{value:"all",children:"Shopping Method"}),a.jsx("option",{value:"delivery",children:"Delivery"}),a.jsx("option",{value:"pickup",children:"Pickup"}),a.jsx("option",{value:"in-store",children:"In-Store"})]})]})}),a.jsx(Re.button,{type:"submit",whileHover:{scale:1.02},whileTap:{scale:.98},className:"bg-[#00897B] hover:bg-[#00695C] text-white px-6 sm:px-8 py-3.5 sm:py-4 rounded-xl sm:rounded-full font-bold shadow-lg transition-all text-base whitespace-nowrap",children:"Find Store"})]})}),a.jsxs(Re.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1,duration:.6},className:"mt-4 flex flex-wrap items-center gap-2 justify-center sm:justify-start",children:[a.jsx("span",{className:"text-gray-700 text-sm font-medium",children:"Popular:"}),["London","Birmingham","Manchester","Leeds","Bristol"].map(O=>a.jsx("button",{onClick:()=>_(O),className:"px-3 py-1.5 bg-white/60 hover:bg-white text-gray-700 hover:text-gray-900 rounded-full text-sm font-medium transition-all shadow-sm hover:shadow-md",children:O},O))]})]})]}),a.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[a.jsx("div",{className:"absolute top-1/4 right-0 w-96 h-96 bg-yellow-300/30 rounded-full blur-3xl"}),a.jsx("div",{className:"absolute bottom-0 left-1/4 w-64 h-64 bg-orange-300/20 rounded-full blur-2xl"})]})]}),a.jsx("section",{className:"bg-white py-16 sm:py-20",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx(Re.h2,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-900 mb-3",children:"African Online Store In the United Kingdom"}),a.jsx(Re.p,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:.1},className:"text-gray-600 max-w-2xl mx-auto",children:"Use existing infrastructure of African products delivered to your doorstep. Open stores, no staff needed, deliver to you however convenient."})]}),a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Meet Our Partners"}),a.jsxs("div",{className:"inline-flex items-center gap-1 p-1 bg-gray-100 rounded-full mb-6",children:[a.jsx("button",{className:"px-6 py-2 bg-[#00897B] text-white rounded-full font-medium text-sm",children:"Stores"}),a.jsx("button",{className:"px-6 py-2 text-gray-700 hover:bg-gray-200 rounded-full font-medium text-sm transition-colors",children:"Pickers"}),a.jsx("button",{className:"px-6 py-2 text-gray-700 hover:bg-gray-200 rounded-full font-medium text-sm transition-colors",children:"Riders"})]}),a.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-4 mb-8",children:[a.jsx("button",{className:"text-[#00897B] font-medium border-b-2 border-[#00897B] pb-1",children:"Stores near by"}),a.jsx("button",{className:"text-gray-600 hover:text-gray-900 font-medium pb-1",children:"Top stores"}),a.jsx("button",{className:"text-gray-600 hover:text-gray-900 font-medium pb-1",children:"Featured stores"}),a.jsx("button",{className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-full text-gray-700 hover:bg-gray-50",children:"Onboard your store"})]}),a.jsx("div",{className:"text-right mb-4",children:a.jsx(Ie,{to:"/stores",className:"text-[#00897B] font-medium hover:underline",children:"See All Stores â†’"})})]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:T.map((O,B)=>a.jsxs(Re.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:B*.1},whileHover:{y:-8,transition:{duration:.2}},onClick:()=>e(`/store/${O.id}`),className:"bg-white rounded-2xl shadow-lg hover:shadow-2xl border border-gray-100 overflow-hidden cursor-pointer transition-all",children:[a.jsxs("div",{className:"relative h-48",children:[a.jsx("img",{src:O.image,alt:O.name,className:"w-full h-full object-cover"}),a.jsxs("div",{className:"absolute top-3 left-3 bg-white/90 backdrop-blur-sm px-3 py-1.5 rounded-full text-sm font-medium text-gray-700 shadow-md",children:["Shop from ",O.priceRange]}),a.jsxs("div",{className:`absolute top-3 right-3 px-3 py-1.5 rounded-full text-sm font-medium shadow-md ${O.isOpen?"bg-green-500 text-white":"bg-red-500 text-white"}`,children:[O.rating," ",O.isOpen?"Open":"Closed"]})]}),a.jsxs("div",{className:"p-5",children:[a.jsx("div",{className:"flex items-start justify-between mb-2",children:a.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[O.name,a.jsx("svg",{className:"w-5 h-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})]})}),a.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:["Available: ",O.hours]}),a.jsxs("p",{className:"text-sm text-gray-600 mb-3",children:["Location: ",O.location]}),a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-3",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsxs("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),O.distance]}),a.jsx("span",{children:"â€¢"}),a.jsxs("span",{children:[O.deliveryFee," Deliveries"]}),a.jsx("span",{children:"â€¢"}),a.jsx("span",{children:O.deliveryTime})]}),a.jsx("div",{className:"flex items-center gap-1 mb-3",children:[1,2,3,4,5].map(L=>a.jsx("svg",{className:`w-4 h-4 ${L<=Math.floor(O.rating)?"text-yellow-400":"text-gray-300"}`,fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},L))}),a.jsx("div",{className:"flex flex-wrap gap-1",children:O.methods.map(L=>a.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 rounded text-xs font-medium",children:L},L))})]})]},O.id))}),a.jsx("div",{className:"text-center mt-10",children:a.jsx(Re.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:a.jsxs(Ie,{to:"/stores",className:"inline-flex items-center gap-2 bg-[#00897B] hover:bg-[#00695C] text-white px-8 py-4 rounded-xl font-bold shadow-lg transition-all text-lg",children:["View All Stores",a.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8l4 4m0 0l-4 4m4-4H3"})})]})})})]})}),a.jsxs("section",{className:"relative py-16 overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-[#F5A623]",children:a.jsx("svg",{className:"absolute top-0 left-0 w-full",viewBox:"0 0 1440 100",fill:"none",preserveAspectRatio:"none",children:a.jsx("path",{d:"M0 50C240 100 480 0 720 50C960 100 1200 0 1440 50V0H0V50Z",fill:"white"})})}),a.jsxs("div",{className:"relative max-w-3xl mx-auto px-4 sm:px-6 text-center py-12",children:[a.jsx(Re.h2,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-4",children:"Join the waitlist for Our App"}),a.jsx(Re.p,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:.1},className:"text-gray-700 mb-8 max-w-xl mx-auto",children:"Exciting things are coming your way! Be the first to experience the ultimate shopping convenience with our upcoming app. Whether you prefer an in-store shopping experience or hassle-free home delivery, our app puts the power of choice in your hands."}),a.jsxs(Re.form,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:.2},className:"flex flex-col sm:flex-row gap-3 max-w-md mx-auto",children:[a.jsx("input",{type:"email",placeholder:"Enter email address",className:"flex-1 px-5 py-3 rounded-full border-2 border-gray-200 focus:border-[#00897B] outline-none text-gray-900"}),a.jsx(Re.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",className:"bg-[#00897B] hover:bg-[#00695C] text-white px-8 py-3 rounded-full font-bold shadow-lg transition-all whitespace-nowrap",children:"Join List"})]})]})]}),a.jsx("footer",{id:"contact",className:"bg-[#1a1a1a] text-white py-12",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-8 mb-10",children:[a.jsxs("div",{className:"lg:col-span-2",children:[a.jsxs("h3",{className:"text-xl font-bold mb-4",children:["You've Got Questions?",a.jsx("br",{}),"Do Reach Out!"]}),a.jsxs("div",{className:"space-y-3 text-gray-400",children:[a.jsxs("p",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-yellow-500",children:"ðŸ“§"}),"Email: info@afrimercato.co.uk"]}),a.jsxs("p",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-yellow-500",children:"ðŸ“"}),"Location: Washington Ave, Manchester, United Kingdom."]})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold mb-4",children:"Company"}),a.jsxs("ul",{className:"space-y-2 text-gray-400",children:[a.jsx("li",{children:a.jsx(Ie,{to:"/delivery",className:"hover:text-yellow-500 transition-colors",children:"Delivery"})}),a.jsx("li",{children:a.jsx(Ie,{to:"/stores",className:"hover:text-yellow-500 transition-colors",children:"Stores"})}),a.jsx("li",{children:a.jsx(Ie,{to:"/about",className:"hover:text-yellow-500 transition-colors",children:"About us"})}),a.jsx("li",{children:a.jsx(Ie,{to:"/contact",className:"hover:text-yellow-500 transition-colors",children:"Contact us"})}),a.jsx("li",{children:a.jsx(Ie,{to:"/stores",className:"hover:text-yellow-500 transition-colors",children:"Stores near me"})}),a.jsx("li",{children:a.jsx(Ie,{to:"/partner",className:"hover:text-yellow-500 transition-colors",children:"Partner With Us"})})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold mb-4",children:"Cities"}),a.jsxs("ul",{className:"space-y-2 text-gray-400",children:[a.jsx("li",{children:a.jsx("button",{onClick:()=>_("Bristol"),className:"hover:text-yellow-500 transition-colors",children:"Bristol"})}),a.jsx("li",{children:a.jsx("button",{onClick:()=>_("London"),className:"hover:text-yellow-500 transition-colors",children:"London"})}),a.jsx("li",{children:a.jsx("button",{onClick:()=>_("Leicester"),className:"hover:text-yellow-500 transition-colors",children:"Leicester"})}),a.jsx("li",{children:a.jsx("button",{onClick:()=>_("Liverpool"),className:"hover:text-yellow-500 transition-colors",children:"Liverpool"})}),a.jsx("li",{children:a.jsx("button",{onClick:()=>_("Beckham"),className:"hover:text-yellow-500 transition-colors",children:"Beckham"})}),a.jsx("li",{children:a.jsx("button",{onClick:()=>_("Birmingham"),className:"hover:text-yellow-500 transition-colors",children:"Birmingham"})})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold mb-4",children:"Quick stores"}),a.jsxs("ul",{className:"space-y-2 text-gray-400",children:[a.jsx("li",{children:a.jsx(Ie,{to:"#",className:"hover:text-yellow-500 transition-colors",children:"Supermart"})}),a.jsx("li",{children:a.jsx(Ie,{to:"#",className:"hover:text-yellow-500 transition-colors",children:"Justeat"})}),a.jsx("li",{children:a.jsx(Ie,{to:"#",className:"hover:text-yellow-500 transition-colors",children:"Shoprite"})}),a.jsx("li",{children:a.jsx(Ie,{to:"#",className:"hover:text-yellow-500 transition-colors",children:"Jendol"})}),a.jsx("li",{children:a.jsx(Ie,{to:"#",className:"hover:text-yellow-500 transition-colors",children:"Buka"})})]})]})]}),a.jsxs("div",{className:"border-t border-gray-800 pt-8 flex flex-col sm:flex-row justify-between items-center gap-4 text-gray-500 text-sm",children:[a.jsx("p",{children:"Â© 2024 Afrimercato"}),a.jsx("p",{children:"Designed By thedesignpygi"}),a.jsx("p",{children:"All Right Reserved."})]})]})}),a.jsx("style",{children:`
        @keyframes spin-slow {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
        .animate-spin-slow {
          animation: spin-slow 10s linear infinite;
        }
        .border-3 {
          border-width: 3px;
        }
      `})]})}function Jl({href:e,children:r,active:t}){const n=e==null?void 0:e.startsWith("/"),s=n?Ie:"a";return a.jsx(s,{to:n?e:void 0,href:n?void 0:e,className:`px-4 py-2 rounded-full text-sm font-medium transition-all ${t?"bg-[#00897B] text-white":"text-gray-800 hover:bg-white/50"}`,children:r})}function Zl({to:e,onClick:r,children:t}){const n=e==null?void 0:e.startsWith("/"),s=n?Ie:"a";return a.jsx(s,{to:n?e:void 0,href:n?void 0:e,onClick:r,className:"block py-3 px-4 text-gray-700 font-medium hover:bg-gray-50 rounded-xl transition-colors",children:t})}function r3({title:e,titleId:r,...t},n){return ge.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?ge.createElement("title",{id:r},e):null,ge.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const a3=ge.forwardRef(r3);function n3({title:e,titleId:r,...t},n){return ge.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?ge.createElement("title",{id:r},e):null,ge.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const xf=ge.forwardRef(n3);function s3({title:e,titleId:r,...t},n){return ge.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?ge.createElement("title",{id:r},e):null,ge.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 1.5H8.25A2.25 2.25 0 0 0 6 3.75v16.5a2.25 2.25 0 0 0 2.25 2.25h7.5A2.25 2.25 0 0 0 18 20.25V3.75a2.25 2.25 0 0 0-2.25-2.25H13.5m-3 0V3h3V1.5m-3 0h3m-3 18.75h3"}))}const i3=ge.forwardRef(s3);function o3({title:e,titleId:r,...t},n){return ge.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?ge.createElement("title",{id:r},e):null,ge.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 10.5V6a3.75 3.75 0 1 0-7.5 0v4.5m11.356-1.993 1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 0 1-1.12-1.243l1.264-12A1.125 1.125 0 0 1 5.513 7.5h12.974c.576 0 1.059.435 1.119 1.007ZM8.625 10.5a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm7.5 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const l3=ge.forwardRef(o3);function c3({title:e,titleId:r,...t},n){return ge.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?ge.createElement("title",{id:r},e):null,ge.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 18.75a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 0 1-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h1.125c.621 0 1.129-.504 1.09-1.124a17.902 17.902 0 0 0-3.213-9.193 2.056 2.056 0 0 0-1.58-.86H14.25M16.5 18.75h-2.25m0-11.177v-.958c0-.568-.422-1.048-.987-1.106a48.554 48.554 0 0 0-10.026 0 1.106 1.106 0 0 0-.987 1.106v7.635m12-6.677v6.677m0 4.5v-4.5m0 0h-12"}))}const d3=ge.forwardRef(c3);function h3({title:e,titleId:r,...t},n){return ge.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?ge.createElement("title",{id:r},e):null,ge.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"}))}const f3=ge.forwardRef(h3);function u3(){const e=[{icon:l3,title:"Reach Thousands of Customers",description:"Get your products in front of 4,320+ active shoppers looking for African groceries."},{icon:a3,title:"Grow Your Business Online",description:"Track sales, manage inventory, and grow your revenue with our easy-to-use vendor dashboard."},{icon:i3,title:"Easy Store Management",description:"Manage your store from anywhere with our mobile-friendly vendor dashboard."},{icon:d3,title:"We Handle Delivery",description:"Focus on preparing quality products. Our riders handle pickup and delivery to customers."},{icon:f3,title:"Dedicated Support",description:"24/7 support to help you succeed. We're here to answer questions and solve problems."},{icon:xf,title:"Verified & Trusted",description:"Join a trusted marketplace where quality vendors are verified and customer trust is high."}],r=[{number:1,title:"Submit Application",description:"Fill out the vendor application form with your business details and documents.",color:"from-green-500 to-green-600"},{number:2,title:"Verification Process",description:"Our team reviews your application and verifies your business credentials (1-3 business days).",color:"from-yellow-500 to-yellow-600"},{number:3,title:"Set Up Your Store",description:"Once approved, set up your store profile, add products, and configure delivery settings.",color:"from-green-600 to-green-700"},{number:4,title:"Start Selling",description:"Go live and start receiving orders from customers in your area!",color:"from-yellow-600 to-yellow-700"}],t=["Valid business registration or tax ID","Proof of address (business location)","Food safety/handling certification (for food vendors)","Bank account for receiving payments","High-quality photos of your products","Commitment to quality and customer service"],n=[{q:"How much does it cost to join?",a:"Joining AfriMercato is free! We charge a small commission (12-15%) on each sale to cover platform costs, payment processing, and support."},{q:"How long does verification take?",a:"Verification typically takes 1-3 business days. We'll review your documents and get back to you via email."},{q:"What products can I sell?",a:"You can sell fresh produce, meats, dairy, African foods, spices, grains, and packaged goods. All products must meet UK food safety standards."},{q:"How do I receive payments?",a:"Payments are processed through Paystack and deposited directly to your bank account weekly."},{q:"Can I manage multiple stores?",a:"Yes! You can manage multiple store locations from a single vendor account."}];return a.jsxs("div",{className:"min-h-screen bg-white",children:[a.jsx("nav",{className:"bg-white border-b border-gray-200 sticky top-0 z-50 shadow-sm",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:a.jsxs("div",{className:"flex justify-between items-center h-16",children:[a.jsxs(Ie,{to:"/",className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-green-600 to-yellow-500 rounded-lg flex items-center justify-center",children:a.jsx("span",{className:"text-white font-bold text-lg",children:"ðŸ›’"})}),a.jsxs("span",{className:"text-xl font-bold text-gray-900",children:["Afri",a.jsx("span",{className:"text-green-600",children:"Hub"})]})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(Ie,{to:"/",className:"text-gray-600 hover:text-green-600",children:"Home"}),a.jsx(Ie,{to:"/login",className:"text-green-600 hover:text-green-700 font-medium",children:"Vendor Sign In"})]})]})})}),a.jsx("section",{className:"bg-gradient-to-br from-green-600 via-green-700 to-yellow-500 py-20",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 text-center",children:[a.jsx(Re.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-4xl sm:text-5xl lg:text-6xl font-bold text-white mb-6",children:"Grow Your Food Business with AfriMercato"}),a.jsx(Re.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"text-xl text-white/95 mb-8 max-w-3xl mx-auto",children:"Join 4,320+ vendors already selling African groceries and reaching thousands of customers across the UK."}),a.jsxs(Re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"flex flex-col sm:flex-row gap-4 justify-center",children:[a.jsx(Ie,{to:"/register?role=vendor",className:"bg-yellow-400 text-gray-900 hover:bg-yellow-300 px-10 py-4 rounded-xl font-bold text-lg shadow-2xl inline-flex items-center justify-center gap-2",children:"Apply Now â†’"}),a.jsx("a",{href:"#how-it-works",className:"bg-white/10 backdrop-blur text-white hover:bg-white/20 px-10 py-4 rounded-xl font-bold text-lg border-2 border-white/30 inline-flex items-center justify-center",children:"Learn More"})]}),a.jsx("div",{className:"grid grid-cols-3 gap-8 max-w-3xl mx-auto mt-16",children:[{value:"4,320+",label:"Active Vendors"},{value:"Â£2.5M+",label:"Monthly Sales"},{value:"98%",label:"Satisfaction Rate"}].map((s,o)=>a.jsxs(Re.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:.3+o*.1},className:"text-center",children:[a.jsx("div",{className:"text-3xl sm:text-4xl font-bold text-white mb-2",children:s.value}),a.jsx("div",{className:"text-sm text-white/80",children:s.label})]},o))})]})}),a.jsx("section",{className:"py-20 bg-gray-50",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[a.jsxs("div",{className:"text-center mb-12",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-4",children:"Why Sell on AfriMercato?"}),a.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Everything you need to run a successful online grocery business"})]}),a.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-8",children:e.map((s,o)=>a.jsxs(Re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:o*.1},className:"bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all",children:[a.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-green-500 to-green-700 rounded-xl flex items-center justify-center mb-4",children:a.jsx(s.icon,{className:"w-8 h-8 text-white"})}),a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:s.title}),a.jsx("p",{className:"text-gray-600",children:s.description})]},o))})]})}),a.jsx("section",{id:"how-it-works",className:"py-20",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[a.jsxs("div",{className:"text-center mb-12",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-4",children:"How to Get Started"}),a.jsx("p",{className:"text-lg text-gray-600",children:"Simple 4-step process to start selling"})]}),a.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-8",children:r.map((s,o)=>a.jsxs(Re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:o*.1},className:"text-center",children:[a.jsx("div",{className:`w-20 h-20 bg-gradient-to-br ${s.color} rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg`,children:a.jsx("span",{className:"text-3xl font-bold text-white",children:s.number})}),a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:s.title}),a.jsx("p",{className:"text-gray-600 text-sm",children:s.description})]},o))})]})}),a.jsx("section",{className:"py-20 bg-gray-50",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[a.jsxs("div",{className:"text-center mb-12",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-4",children:"What You'll Need"}),a.jsx("p",{className:"text-lg text-gray-600",children:"Requirements for vendor verification"})]}),a.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:a.jsx("ul",{className:"space-y-4",children:t.map((s,o)=>a.jsxs("li",{className:"flex items-start gap-3",children:[a.jsx(xf,{className:"w-6 h-6 text-green-600 flex-shrink-0 mt-0.5"}),a.jsx("span",{className:"text-gray-700",children:s})]},o))})})]})}),a.jsx("section",{className:"py-20",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[a.jsx("div",{className:"text-center mb-12",children:a.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-4",children:"Frequently Asked Questions"})}),a.jsx("div",{className:"space-y-6",children:n.map((s,o)=>a.jsxs(Re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:o*.1},className:"bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition-all",children:[a.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:s.q}),a.jsx("p",{className:"text-gray-600",children:s.a})]},o))})]})}),a.jsx("section",{className:"bg-gradient-to-r from-green-600 via-green-700 to-yellow-500 py-20",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-4 text-center",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-white mb-6",children:"Ready to Start Selling?"}),a.jsx("p",{className:"text-xl text-white/95 mb-8",children:"Join thousands of vendors growing their business on AfriMercato"}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[a.jsx(Ie,{to:"/register?role=vendor",className:"bg-yellow-400 text-gray-900 hover:bg-yellow-300 px-10 py-4 rounded-xl font-bold text-lg shadow-2xl inline-flex items-center justify-center gap-2",children:"Apply as Vendor â†’"}),a.jsx(Ie,{to:"/login",className:"bg-white text-green-700 hover:bg-gray-100 px-10 py-4 rounded-xl font-bold text-lg shadow-2xl inline-flex items-center justify-center",children:"Already a Vendor? Sign In"})]})]})}),a.jsx("footer",{className:"bg-gray-900 text-gray-300 py-12",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-8",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-bold mb-4",children:"AfriMercato"}),a.jsx("p",{className:"text-sm",children:"African groceries delivered to your door across the UK."})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-bold mb-4",children:"For Customers"}),a.jsxs("ul",{className:"space-y-2 text-sm",children:[a.jsx("li",{children:a.jsx(Ie,{to:"/",className:"hover:text-yellow-400",children:"Browse Stores"})}),a.jsx("li",{children:a.jsx(Ie,{to:"/#how-it-works",className:"hover:text-yellow-400",children:"How It Works"})})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-bold mb-4",children:"For Partners"}),a.jsxs("ul",{className:"space-y-2 text-sm",children:[a.jsx("li",{children:a.jsx(Ie,{to:"/partner",className:"hover:text-yellow-400",children:"Become a Vendor"})}),a.jsx("li",{children:a.jsx(Ie,{to:"/register?role=rider",className:"hover:text-yellow-400",children:"Become a Rider"})})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-bold mb-4",children:"Company"}),a.jsxs("ul",{className:"space-y-2 text-sm",children:[a.jsx("li",{children:a.jsx("a",{href:"#",className:"hover:text-yellow-400",children:"About"})}),a.jsx("li",{children:a.jsx("a",{href:"#",className:"hover:text-yellow-400",children:"Contact"})})]})]})]}),a.jsx("div",{className:"border-t border-gray-800 mt-8 pt-8 text-center text-sm",children:a.jsx("p",{children:"Â© 2025 AfriMercato. All rights reserved."})})]})})]})}function m3(){const[e]=om(),r=e.get("location")||"",t=xn(),[n,s]=ge.useState([]),[o,l]=ge.useState(!0),[c,d]=ge.useState(r),[f,u]=ge.useState("stores"),[g,p]=ge.useState("nearby"),[m,j]=ge.useState(!1);ge.useEffect(()=>{v()},[r]);const v=async()=>{var y;try{l(!0);const _=await qm(r,50);_.success&&((y=_.data)!=null&&y.vendors)&&_.data.vendors.length>0?s(_.data.vendors):s(N(r))}catch(_){console.log("Using sample stores:",_.message),s(N(r))}finally{l(!1)}},N=y=>{const _=[{id:1,name:"Josh's African Supermarket",image:"https://images.unsplash.com/photo-1604719312566-8912e9227c6a?w=600",hours:"07:00am - 10:00pm",location:"London United Kingdom",distance:"0.3km",deliveryTime:"25 mins",priceRange:"Â£5-Â£200",rating:4.9,isOpen:!0,deliveryFee:"Free over Â£50",miles:"0.5 miles",methods:["Delivery","Pickup","In-Store"],verified:!0,description:"Authentic Nigerian, Ghanaian & Caribbean groceries. Fresh yams, plantain, palm oil & more."},{id:2,name:"Mama Africa Foods",image:"https://images.unsplash.com/photo-1542838132-92c53300491e?w=600",hours:"08:00am - 09:00pm",location:"Manchester United Kingdom",distance:"1.2km",deliveryTime:"30 mins",priceRange:"Â£3-Â£150",rating:4.8,isOpen:!0,deliveryFee:"Â£3.99",miles:"1.8 miles",methods:["Delivery","Pickup"],verified:!0,description:"Traditional African spices, seasonings, and fresh produce from trusted suppliers."},{id:3,name:"Lagos Provisions",image:"https://images.unsplash.com/photo-1578916171728-46686eac8d58?w=600",hours:"06:00am - 11:00pm",location:"Birmingham United Kingdom",distance:"0.8km",deliveryTime:"20 mins",priceRange:"Â£2-Â£100",rating:4.7,isOpen:!0,deliveryFee:"Â£2.99",miles:"1.2 miles",methods:["Delivery","Pickup","In-Store"],verified:!0,description:"Fresh Nigerian ingredients, frozen fish, stockfish, and authentic seasonings."},{id:4,name:"Accra Spice House",image:"https://images.unsplash.com/photo-1596040033229-a9821ebd058d?w=600",hours:"09:00am - 08:00pm",location:"Leeds United Kingdom",distance:"2.1km",deliveryTime:"35 mins",priceRange:"Â£5-Â£180",rating:4.6,isOpen:!0,deliveryFee:"Â£4.50",miles:"3.2 miles",methods:["Delivery","Pickup"],verified:!0,description:"Ghanaian specialty foods, kenkey, banku flour, shito, and palm soup base."},{id:5,name:"Ethiopian Delights",image:"https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=600",hours:"10:00am - 09:00pm",location:"Bristol United Kingdom",distance:"1.5km",deliveryTime:"40 mins",priceRange:"Â£8-Â£120",rating:4.5,isOpen:!0,deliveryFee:"Â£3.50",miles:"2.3 miles",methods:["Delivery","In-Store"],verified:!0,description:"Authentic Ethiopian & Eritrean foods. Injera, berbere spice, teff flour."},{id:6,name:"Caribbean & African Mart",image:"https://images.unsplash.com/photo-1619566636858-adf3ef46400b?w=600",hours:"07:00am - 10:00pm",location:"Leicester United Kingdom",distance:"0.6km",deliveryTime:"25 mins",priceRange:"Â£4-Â£200",rating:4.8,isOpen:!0,deliveryFee:"Free over Â£40",miles:"0.9 miles",methods:["Delivery","Pickup","In-Store"],verified:!0,description:"Best of Caribbean & African cuisine. Jerk seasoning, ackee, callaloo & more."},{id:7,name:"Naija Fresh Market",image:"https://images.unsplash.com/photo-1488459716781-31db52582fe9?w=600",hours:"06:00am - 10:00pm",location:"Liverpool United Kingdom",distance:"1.0km",deliveryTime:"30 mins",priceRange:"Â£3-Â£150",rating:4.7,isOpen:!0,deliveryFee:"Â£2.99",miles:"1.5 miles",methods:["Delivery","Pickup"],verified:!0,description:"Fresh egusi, ogbono, crayfish, dried fish, and Nigerian cooking essentials."},{id:8,name:"Taste of Kenya",image:"https://images.unsplash.com/photo-1610832958506-aa56368176cf?w=600",hours:"08:00am - 09:00pm",location:"Sheffield United Kingdom",distance:"1.8km",deliveryTime:"35 mins",priceRange:"Â£5-Â£100",rating:4.4,isOpen:!0,deliveryFee:"Â£3.99",miles:"2.7 miles",methods:["Delivery","In-Store"],verified:!0,description:"Kenyan & East African groceries. Ugali flour, sukuma wiki, nyama choma spices."}];if(y){const T=_.filter(O=>O.location.toLowerCase().includes(y.toLowerCase()));return T.length>0?T:_}return _},b=y=>{y.preventDefault(),c.trim()&&t(`/stores?location=${encodeURIComponent(c)}`)};return a.jsxs("div",{className:"min-h-screen bg-[#F8F8F8]",children:[a.jsx("nav",{className:"bg-white border-b border-gray-200 sticky top-0 z-50 shadow-sm",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex justify-between items-center h-16",children:[a.jsxs(Ie,{to:"/",className:"flex items-center gap-2",children:[a.jsx("svg",{className:"w-8 h-8",viewBox:"0 0 40 40",fill:"none",children:a.jsx("path",{d:"M8 8L32 32M32 8L8 32",stroke:"#1a1a1a",strokeWidth:"4",strokeLinecap:"round"})}),a.jsx("span",{className:"text-xl font-bold text-gray-900",children:"Afrimercato"})]}),a.jsxs("div",{className:"hidden md:flex items-center gap-6",children:[a.jsx(Ie,{to:"/",className:"text-gray-600 hover:text-gray-900 font-medium",children:"Home"}),a.jsx(Ie,{to:"/stores",className:"text-[#00897B] font-medium",children:"Stores"}),a.jsx(Ie,{to:"/partner",className:"text-gray-600 hover:text-gray-900 font-medium",children:"Partner With Us"})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Ie,{to:"/login",className:"text-gray-700 hover:text-gray-900 font-medium",children:"Log in"}),a.jsxs(Ie,{to:"/register",className:"flex items-center gap-2 bg-[#00897B] hover:bg-[#00695C] text-white px-4 py-2 rounded-full font-semibold transition-all",children:["Sign Up",a.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})})]})]})]})})}),a.jsx("section",{className:"bg-white py-10 border-b",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"grid lg:grid-cols-2 gap-8 items-center",children:[a.jsxs("div",{children:[a.jsxs(Re.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-4",children:["African Online Store",a.jsx("br",{}),"In the United Kingdom"]}),a.jsx(Re.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"text-gray-600 mb-6",children:"Use existing infrastructure of African products delivered to your doorstep. Open stores, no staff needed, deliver to you however convenient."}),a.jsxs("form",{onSubmit:b,className:"flex gap-2 mb-6",children:[a.jsx("div",{className:"flex-1 relative",children:a.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg px-4 py-3",children:[a.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),a.jsx("input",{type:"text",value:c,onChange:y=>d(y.target.value),onFocus:()=>j(!0),onBlur:()=>setTimeout(()=>j(!1),200),placeholder:"Postcode, store name, location",className:"flex-1 bg-transparent outline-none text-gray-900 placeholder-gray-500"})]})}),a.jsx("button",{type:"submit",className:"bg-[#00897B] hover:bg-[#00695C] text-white px-6 py-3 rounded-lg font-semibold transition-all",children:"Find Store"})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:"text-gray-600 text-sm",children:"Trusted by"}),a.jsx("div",{className:"flex -space-x-2",children:[1,2,3].map(y=>a.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 border-2 border-white flex items-center justify-center text-sm",children:["ðŸ‘©ðŸ¾","ðŸ‘¨ðŸ¿","ðŸ‘©ðŸ½"][y-1]},y))}),a.jsx("span",{className:"bg-white border border-gray-200 px-3 py-1 rounded-full text-sm font-medium text-gray-700",children:"4,320+ Vendors"})]})]}),a.jsx("div",{className:"hidden lg:block",children:a.jsx("div",{className:"relative bg-[#F5A623] rounded-2xl p-6 overflow-hidden",children:a.jsx("img",{src:"https://images.unsplash.com/photo-1610832958506-aa56368176cf?w=600",alt:"Fresh produce",className:"w-full h-64 object-cover rounded-xl"})})})]})})}),a.jsx("section",{className:"py-10",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 text-center mb-6",children:"Meet Our Partners"}),a.jsx("div",{className:"flex justify-center mb-6",children:a.jsx("div",{className:"inline-flex items-center gap-1 p-1 bg-gray-100 rounded-full",children:["stores","pickers","riders"].map(y=>a.jsx("button",{onClick:()=>u(y),className:`px-6 py-2 rounded-full font-medium text-sm capitalize transition-all ${f===y?"bg-[#00897B] text-white":"text-gray-700 hover:bg-gray-200"}`,children:y},y))})}),a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-6",children:[a.jsx("div",{className:"flex flex-wrap items-center gap-4",children:[{id:"nearby",label:"Stores near by"},{id:"top",label:"Top stores"},{id:"featured",label:"Featured stores"}].map(y=>a.jsx("button",{onClick:()=>p(y.id),className:`font-medium pb-1 transition-colors ${g===y.id?"text-[#00897B] border-b-2 border-[#00897B]":"text-gray-600 hover:text-gray-900"}`,children:y.label},y.id))}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(Ie,{to:"/partner",className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-full text-gray-700 hover:bg-gray-50 font-medium text-sm",children:"Onboard your store"}),a.jsx("span",{className:"text-[#00897B] font-medium",children:"See All Stores"})]})]}),o&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#00897B] mx-auto"}),a.jsx("p",{className:"text-gray-600 mt-4",children:"Finding stores..."})]}),!o&&a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map((y,_)=>a.jsxs(Re.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:_*.1},whileHover:{y:-8},onClick:()=>t(`/store/${y.id||y._id}`),className:"bg-white rounded-2xl shadow-lg hover:shadow-xl overflow-hidden cursor-pointer transition-all border border-gray-100",children:[a.jsxs("div",{className:"relative h-48",children:[a.jsx("img",{src:y.image||"https://images.unsplash.com/photo-1604719312566-8912e9227c6a?w=600",alt:y.name||y.storeName,className:"w-full h-full object-cover"}),a.jsxs("div",{className:"absolute top-3 left-3 bg-white/90 backdrop-blur-sm px-3 py-1.5 rounded-full text-sm font-medium text-gray-700 shadow-md",children:["Shop from ",y.priceRange||"Â£10-Â£500"]}),a.jsxs("div",{className:`absolute top-3 right-3 px-3 py-1.5 rounded-full text-sm font-medium shadow-md flex items-center gap-1 ${y.isOpen!==!1?"bg-green-500 text-white":"bg-red-500 text-white"}`,children:[a.jsx("span",{children:y.rating||4.5}),a.jsx("span",{children:y.isOpen!==!1?"Open":"Closed"})]})]}),a.jsxs("div",{className:"p-5",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("h3",{className:"text-lg font-bold text-gray-900",children:y.name||y.storeName||y.businessName}),y.verified!==!1&&a.jsx("svg",{className:"w-5 h-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})]}),a.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:["Available: ",y.hours||"06:00am - 09:00pm"]}),a.jsxs("p",{className:"text-sm text-gray-600 mb-3",children:["Location: ",y.location||"United Kingdom"]}),a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-3",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"})}),a.jsx("span",{children:y.distance||"0.1km"}),a.jsx("span",{children:"â€¢"}),a.jsxs("span",{children:[y.deliveryFee||"Â£25"," Deliveries"]}),a.jsx("span",{children:"â€¢"}),a.jsx("span",{children:y.deliveryTime||"30 mins"})]}),a.jsx("div",{className:"flex items-center gap-1 mb-3",children:[1,2,3,4,5].map(T=>a.jsx("svg",{className:`w-4 h-4 ${T<=Math.floor(y.rating||4.5)?"text-yellow-400":"text-gray-300"}`,fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},T))}),a.jsx("div",{className:"flex flex-wrap gap-1",children:(y.methods||["Shopping","In-Shopping","Delivery"]).map(T=>a.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 rounded text-xs font-medium",children:T},T))})]})]},y.id||_))})]})}),a.jsx("footer",{className:"bg-[#1a1a1a] text-white py-12 mt-10",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold mb-4",children:"Afrimercato"}),a.jsx("p",{className:"text-gray-400 text-sm",children:"Fresh African groceries delivered across the UK."})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold mb-4",children:"Company"}),a.jsxs("ul",{className:"space-y-2 text-gray-400 text-sm",children:[a.jsx("li",{children:a.jsx(Ie,{to:"/",className:"hover:text-yellow-500",children:"Home"})}),a.jsx("li",{children:a.jsx(Ie,{to:"/stores",className:"hover:text-yellow-500",children:"Stores"})}),a.jsx("li",{children:a.jsx(Ie,{to:"/partner",className:"hover:text-yellow-500",children:"Partner With Us"})})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold mb-4",children:"Cities"}),a.jsxs("ul",{className:"space-y-2 text-gray-400 text-sm",children:[a.jsx("li",{children:a.jsx("button",{onClick:()=>t("/stores?location=London"),className:"hover:text-yellow-500",children:"London"})}),a.jsx("li",{children:a.jsx("button",{onClick:()=>t("/stores?location=Manchester"),className:"hover:text-yellow-500",children:"Manchester"})}),a.jsx("li",{children:a.jsx("button",{onClick:()=>t("/stores?location=Birmingham"),className:"hover:text-yellow-500",children:"Birmingham"})})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold mb-4",children:"Contact"}),a.jsx("p",{className:"text-gray-400 text-sm",children:"info@afrimercato.co.uk"})]})]}),a.jsx("div",{className:"border-t border-gray-800 mt-8 pt-8 text-center text-gray-500 text-sm",children:a.jsx("p",{children:"Â© 2024 Afrimercato. All rights reserved."})})]})})]})}function x3(){const e=[{name:"Sarah Adeyemi",role:"Founder & CEO",image:"https://images.unsplash.com/photo-1573496359142-b8d87734a5a2?w=300",bio:"Passionate about connecting African communities with authentic products across the UK."},{name:"David Okonkwo",role:"Head of Operations",image:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=300",bio:"Ensuring seamless delivery experiences for thousands of customers daily."},{name:"Amara Johnson",role:"Head of Vendor Relations",image:"https://images.unsplash.com/photo-1580489944761-15a19d654956?w=300",bio:"Building strong partnerships with vendors across the United Kingdom."}],r=[{year:"2022",title:"Founded",description:"Afrimercato launched in Manchester"},{year:"2023",title:"Expansion",description:"Extended to 15+ UK cities"},{year:"2024",title:"4,320+ Vendors",description:"Trusted by thousands of vendors"},{year:"2025",title:"Growing",description:"Serving communities nationwide"}];return a.jsxs("div",{className:"min-h-screen bg-white",children:[a.jsx("nav",{className:"bg-white border-b border-gray-200 sticky top-0 z-50 shadow-sm",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex justify-between items-center h-16",children:[a.jsxs(Ie,{to:"/",className:"flex items-center gap-2",children:[a.jsx("svg",{className:"w-8 h-8",viewBox:"0 0 40 40",fill:"none",children:a.jsx("path",{d:"M8 8L32 32M32 8L8 32",stroke:"#1a1a1a",strokeWidth:"4",strokeLinecap:"round"})}),a.jsx("span",{className:"text-xl font-bold text-gray-900",children:"Afrimercato"})]}),a.jsxs("div",{className:"hidden md:flex items-center gap-6",children:[a.jsx(Ie,{to:"/",className:"text-gray-600 hover:text-gray-900 font-medium",children:"Home"}),a.jsx(Ie,{to:"/stores",className:"text-gray-600 hover:text-gray-900 font-medium",children:"Stores"}),a.jsx(Ie,{to:"/delivery",className:"text-gray-600 hover:text-gray-900 font-medium",children:"Delivery"}),a.jsx(Ie,{to:"/about",className:"text-[#00897B] font-medium",children:"About us"}),a.jsx(Ie,{to:"/contact",className:"text-gray-600 hover:text-gray-900 font-medium",children:"Contact us"})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Ie,{to:"/login",className:"text-gray-700 hover:text-gray-900 font-medium",children:"Log in"}),a.jsx(Ie,{to:"/register",className:"flex items-center gap-2 bg-[#00897B] hover:bg-[#00695C] text-white px-4 py-2 rounded-full font-semibold transition-all",children:"Sign Up"})]})]})})}),a.jsxs("section",{className:"relative bg-gradient-to-br from-[#F5A623] to-[#FF9800] py-20 overflow-hidden",children:[a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[a.jsx(Re.h1,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},className:"text-4xl md:text-6xl font-bold text-gray-900 mb-6",children:"About Afrimercato"}),a.jsx(Re.p,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.1},className:"text-xl text-gray-800 max-w-3xl mx-auto",children:"We're on a mission to bring authentic African products and groceries to every doorstep across the United Kingdom."})]}),a.jsx("div",{className:"absolute bottom-0 left-0 right-0",children:a.jsx("svg",{viewBox:"0 0 1440 120",fill:"none",preserveAspectRatio:"none",className:"w-full h-20",children:a.jsx("path",{d:"M0 120L1440 120L1440 0C1200 80 800 40 400 60C200 70 0 40 0 0L0 120Z",fill:"white"})})})]}),a.jsx("section",{className:"py-20",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 items-center",children:[a.jsxs(Re.div,{initial:{opacity:0,x:-50},whileInView:{opacity:1,x:0},viewport:{once:!0},children:[a.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-6",children:"Our Story"}),a.jsx("p",{className:"text-gray-600 mb-4 text-lg leading-relaxed",children:"Afrimercato was born from a simple idea: to make authentic African products accessible to everyone in the UK, no matter where they live."}),a.jsx("p",{className:"text-gray-600 mb-4 text-lg leading-relaxed",children:"We noticed that many African communities struggled to find the products they loved from home. Supermarkets often lacked variety, and specialty stores were few and far between."}),a.jsx("p",{className:"text-gray-600 text-lg leading-relaxed",children:"Today, we partner with over 4,320 vendors across the UK, bringing fresh produce, authentic spices, and traditional products directly to your doorstep. We're more than a marketplace - we're a bridge connecting cultures and communities."})]}),a.jsxs(Re.div,{initial:{opacity:0,x:50},whileInView:{opacity:1,x:0},viewport:{once:!0},className:"relative",children:[a.jsx("img",{src:"https://images.unsplash.com/photo-1604719312566-8912e9227c6a?w=600",alt:"African marketplace",className:"rounded-2xl shadow-2xl w-full h-96 object-cover"}),a.jsxs("div",{className:"absolute -bottom-6 -left-6 bg-[#00897B] text-white p-6 rounded-xl shadow-xl",children:[a.jsx("p",{className:"text-3xl font-bold",children:"4,320+"}),a.jsx("p",{className:"text-sm opacity-90",children:"Trusted Vendors"})]})]})]})})}),a.jsx("section",{className:"py-20 bg-gray-50",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 text-center mb-12",children:"Our Values"}),a.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:[{icon:"ðŸŒ",title:"Community First",description:"We believe in supporting local businesses and connecting communities through food."},{icon:"âœ¨",title:"Quality Always",description:"Every product on our platform meets strict quality standards for freshness and authenticity."},{icon:"ðŸšš",title:"Reliable Delivery",description:"Fast, reliable delivery ensures your groceries arrive fresh at your doorstep."}].map((t,n)=>a.jsxs(Re.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:n*.1},className:"bg-white p-8 rounded-2xl shadow-lg hover:shadow-xl transition-shadow",children:[a.jsx("div",{className:"text-5xl mb-4",children:t.icon}),a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3",children:t.title}),a.jsx("p",{className:"text-gray-600",children:t.description})]},t.title))})]})}),a.jsx("section",{className:"py-20",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 text-center mb-12",children:"Our Journey"}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 h-full w-1 bg-[#00897B] hidden md:block"}),a.jsx("div",{className:"space-y-12",children:r.map((t,n)=>a.jsxs(Re.div,{initial:{opacity:0,x:n%2===0?-50:50},whileInView:{opacity:1,x:0},viewport:{once:!0},className:`flex items-center ${n%2===0?"md:flex-row":"md:flex-row-reverse"}`,children:[a.jsx("div",{className:"flex-1 text-center md:text-right md:pr-8",children:n%2===0&&a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg inline-block",children:[a.jsx("p",{className:"text-[#00897B] font-bold text-2xl mb-1",children:t.year}),a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:t.title}),a.jsx("p",{className:"text-gray-600",children:t.description})]})}),a.jsx("div",{className:"hidden md:flex w-8 h-8 bg-[#00897B] rounded-full items-center justify-center text-white font-bold z-10",children:n+1}),a.jsx("div",{className:"flex-1 text-center md:text-left md:pl-8",children:n%2!==0&&a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg inline-block",children:[a.jsx("p",{className:"text-[#00897B] font-bold text-2xl mb-1",children:t.year}),a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:t.title}),a.jsx("p",{className:"text-gray-600",children:t.description})]})})]},t.year))})]})]})}),a.jsx("section",{className:"py-20 bg-gray-50",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 text-center mb-4",children:"Meet Our Team"}),a.jsx("p",{className:"text-gray-600 text-center mb-12 max-w-2xl mx-auto",children:"The passionate people behind Afrimercato, working every day to bring you the best experience."}),a.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:e.map((t,n)=>a.jsxs(Re.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:n*.1},className:"bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-shadow",children:[a.jsx("img",{src:t.image,alt:t.name,className:"w-full h-64 object-cover"}),a.jsxs("div",{className:"p-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900",children:t.name}),a.jsx("p",{className:"text-[#00897B] font-medium mb-3",children:t.role}),a.jsx("p",{className:"text-gray-600 text-sm",children:t.bio})]})]},t.name))})]})}),a.jsx("section",{className:"py-20 bg-[#00897B]",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[a.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-white mb-6",children:"Ready to Start Shopping?"}),a.jsx("p",{className:"text-white/90 text-lg mb-8",children:"Join thousands of happy customers who trust Afrimercato for their grocery needs."}),a.jsxs("div",{className:"flex flex-wrap justify-center gap-4",children:[a.jsx(Ie,{to:"/stores",className:"bg-white text-[#00897B] px-8 py-4 rounded-xl font-bold shadow-lg hover:shadow-xl transition-all",children:"Browse Stores"}),a.jsx(Ie,{to:"/partner",className:"border-2 border-white text-white px-8 py-4 rounded-xl font-bold hover:bg-white hover:text-[#00897B] transition-all",children:"Become a Vendor"})]})]})}),a.jsx("footer",{className:"bg-[#1a1a1a] text-white py-12",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold mb-4",children:"Afrimercato"}),a.jsx("p",{className:"text-gray-400 text-sm",children:"Fresh African groceries delivered across the UK."})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold mb-4",children:"Company"}),a.jsxs("ul",{className:"space-y-2 text-gray-400 text-sm",children:[a.jsx("li",{children:a.jsx(Ie,{to:"/",className:"hover:text-[#F5A623]",children:"Home"})}),a.jsx("li",{children:a.jsx(Ie,{to:"/stores",className:"hover:text-[#F5A623]",children:"Stores"})}),a.jsx("li",{children:a.jsx(Ie,{to:"/about",className:"hover:text-[#F5A623]",children:"About Us"})}),a.jsx("li",{children:a.jsx(Ie,{to:"/contact",className:"hover:text-[#F5A623]",children:"Contact"})})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold mb-4",children:"Support"}),a.jsxs("ul",{className:"space-y-2 text-gray-400 text-sm",children:[a.jsx("li",{children:a.jsx(Ie,{to:"/delivery",className:"hover:text-[#F5A623]",children:"Delivery Info"})}),a.jsx("li",{children:a.jsx(Ie,{to:"/partner",className:"hover:text-[#F5A623]",children:"Partner With Us"})})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold mb-4",children:"Contact"}),a.jsx("p",{className:"text-gray-400 text-sm",children:"info@afrimercato.co.uk"}),a.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Manchester, United Kingdom"})]})]}),a.jsx("div",{className:"border-t border-gray-800 mt-8 pt-8 text-center text-gray-500 text-sm",children:a.jsx("p",{children:"Â© 2024 Afrimercato. All rights reserved."})})]})})]})}function p3(){const e=[{title:"Standard Delivery",time:"2-4 hours",price:"Â£5.00",description:"Perfect for planned shopping",icon:"ðŸ“¦"},{title:"Express Delivery",time:"30-60 mins",price:"Â£8.00",description:"When you need it fast",icon:"ðŸš€"},{title:"Scheduled Delivery",time:"Pick your slot",price:"Â£4.00",description:"Choose your preferred time",icon:"ðŸ“…"}],r=["London","Manchester","Birmingham","Leeds","Liverpool","Bristol","Leicester","Sheffield","Nottingham","Newcastle","Cardiff","Glasgow","Edinburgh","Belfast","Southampton"],t=[{question:"What are your delivery hours?",answer:"We deliver from 8:00 AM to 10:00 PM, 7 days a week. Specific hours may vary by location and vendor."},{question:"Is there a minimum order for delivery?",answer:"The minimum order is Â£15 for standard delivery. Orders over Â£50 qualify for free delivery!"},{question:"Can I track my delivery?",answer:"Yes! Once your order is dispatched, you'll receive real-time tracking updates via SMS and our app."},{question:"What if I'm not home?",answer:"You can add delivery instructions for safe places to leave your order, or reschedule for a more convenient time."},{question:"Do you deliver to my area?",answer:"We cover most major UK cities. Enter your postcode on our homepage to check availability in your area."}];return a.jsxs("div",{className:"min-h-screen bg-white",children:[a.jsx("nav",{className:"bg-white border-b border-gray-200 sticky top-0 z-50 shadow-sm",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex justify-between items-center h-16",children:[a.jsxs(Ie,{to:"/",className:"flex items-center gap-2",children:[a.jsx("svg",{className:"w-8 h-8",viewBox:"0 0 40 40",fill:"none",children:a.jsx("path",{d:"M8 8L32 32M32 8L8 32",stroke:"#1a1a1a",strokeWidth:"4",strokeLinecap:"round"})}),a.jsx("span",{className:"text-xl font-bold text-gray-900",children:"Afrimercato"})]}),a.jsxs("div",{className:"hidden md:flex items-center gap-6",children:[a.jsx(Ie,{to:"/",className:"text-gray-600 hover:text-gray-900 font-medium",children:"Home"}),a.jsx(Ie,{to:"/stores",className:"text-gray-600 hover:text-gray-900 font-medium",children:"Stores"}),a.jsx(Ie,{to:"/delivery",className:"text-[#00897B] font-medium",children:"Delivery"}),a.jsx(Ie,{to:"/about",className:"text-gray-600 hover:text-gray-900 font-medium",children:"About us"}),a.jsx(Ie,{to:"/contact",className:"text-gray-600 hover:text-gray-900 font-medium",children:"Contact us"})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Ie,{to:"/login",className:"text-gray-700 hover:text-gray-900 font-medium",children:"Log in"}),a.jsx(Ie,{to:"/register",className:"flex items-center gap-2 bg-[#00897B] hover:bg-[#00695C] text-white px-4 py-2 rounded-full font-semibold transition-all",children:"Sign Up"})]})]})})}),a.jsxs("section",{className:"relative bg-gradient-to-br from-[#00897B] to-[#00695C] py-20 overflow-hidden",children:[a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 items-center",children:[a.jsxs(Re.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},children:[a.jsx("h1",{className:"text-4xl md:text-6xl font-bold text-white mb-6",children:"Fast, Reliable Delivery Across the UK"}),a.jsx("p",{className:"text-xl text-white/90 mb-8",children:"From our trusted vendors to your doorstep. Fresh groceries delivered when you need them, where you need them."}),a.jsxs("div",{className:"flex flex-wrap gap-4",children:[a.jsx(Ie,{to:"/stores",className:"bg-white text-[#00897B] px-8 py-4 rounded-xl font-bold shadow-lg hover:shadow-xl transition-all",children:"Start Shopping"}),a.jsx("a",{href:"#coverage",className:"border-2 border-white text-white px-8 py-4 rounded-xl font-bold hover:bg-white hover:text-[#00897B] transition-all",children:"Check Coverage"})]})]}),a.jsx(Re.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},transition:{delay:.2},className:"hidden lg:block",children:a.jsx("img",{src:"https://images.unsplash.com/photo-1566576912321-d58ddd7a6088?w=600",alt:"Delivery",className:"rounded-2xl shadow-2xl"})})]})}),a.jsx("div",{className:"absolute bottom-0 left-0 right-0",children:a.jsx("svg",{viewBox:"0 0 1440 120",fill:"none",preserveAspectRatio:"none",className:"w-full h-20",children:a.jsx("path",{d:"M0 120L1440 120L1440 0C1200 80 800 40 400 60C200 70 0 40 0 0L0 120Z",fill:"white"})})})]}),a.jsx("section",{className:"py-20",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 text-center mb-4",children:"Delivery Options"}),a.jsx("p",{className:"text-gray-600 text-center mb-12 max-w-2xl mx-auto",children:"Choose the delivery option that works best for you"}),a.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:e.map((n,s)=>a.jsxs(Re.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:s*.1},className:"bg-white border-2 border-gray-100 p-8 rounded-2xl hover:border-[#00897B] hover:shadow-xl transition-all text-center",children:[a.jsx("div",{className:"text-5xl mb-4",children:n.icon}),a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:n.title}),a.jsx("p",{className:"text-[#00897B] text-2xl font-bold mb-2",children:n.time}),a.jsx("p",{className:"text-gray-600 mb-4",children:n.description}),a.jsx("p",{className:"text-gray-900 font-semibold",children:n.price})]},n.title))}),a.jsxs("div",{className:"mt-12 text-center bg-[#F5A623]/10 rounded-2xl p-8",children:[a.jsx("p",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Free Delivery"}),a.jsx("p",{className:"text-gray-600",children:"On all orders over Â£50!"})]})]})}),a.jsx("section",{className:"py-20 bg-gray-50",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 text-center mb-12",children:"How Delivery Works"}),a.jsx("div",{className:"grid md:grid-cols-4 gap-8",children:[{step:1,title:"Browse & Order",description:"Find your favorite products from local vendors",icon:"ðŸ›’"},{step:2,title:"Vendor Prepares",description:"Fresh products are carefully packed",icon:"ðŸ“¦"},{step:3,title:"On The Way",description:"Track your delivery in real-time",icon:"ðŸšš"},{step:4,title:"Delivered!",description:"Enjoy your fresh groceries at home",icon:"ðŸ "}].map((n,s)=>a.jsxs(Re.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:s*.1},className:"text-center relative",children:[a.jsx("div",{className:"text-5xl mb-4",children:n.icon}),a.jsx("div",{className:"w-10 h-10 bg-[#00897B] text-white rounded-full flex items-center justify-center font-bold mx-auto mb-4",children:n.step}),a.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:n.title}),a.jsx("p",{className:"text-gray-600 text-sm",children:n.description}),s<3&&a.jsx("div",{className:"hidden md:block absolute top-16 left-full w-full h-0.5 bg-[#00897B]/30 -translate-x-1/2"})]},n.step))})]})}),a.jsx("section",{id:"coverage",className:"py-20",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 text-center mb-4",children:"Delivery Coverage"}),a.jsx("p",{className:"text-gray-600 text-center mb-12 max-w-2xl mx-auto",children:"We're rapidly expanding! Currently serving these major cities and surrounding areas."}),a.jsx("div",{className:"flex flex-wrap justify-center gap-4",children:r.map(n=>a.jsx(Re.div,{whileHover:{scale:1.05},className:"bg-white border border-gray-200 px-6 py-3 rounded-full shadow-sm hover:shadow-md hover:border-[#00897B] transition-all cursor-pointer",children:a.jsx("span",{className:"text-gray-900 font-medium",children:n})},n))}),a.jsxs("p",{className:"text-center mt-8 text-gray-600",children:["Don't see your area? ",a.jsx(Ie,{to:"/contact",className:"text-[#00897B] font-semibold hover:underline",children:"Contact us"})," - we're expanding!"]})]})}),a.jsx("section",{className:"py-20 bg-gray-50",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 text-center mb-12",children:"Frequently Asked Questions"}),a.jsx("div",{className:"space-y-4",children:t.map((n,s)=>a.jsxs(Re.details,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden group",children:[a.jsxs("summary",{className:"p-6 cursor-pointer font-semibold text-gray-900 flex justify-between items-center hover:bg-gray-50",children:[n.question,a.jsx("span",{className:"text-[#00897B] group-open:rotate-180 transition-transform",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),a.jsx("div",{className:"px-6 pb-6 text-gray-600",children:n.answer})]},s))})]})}),a.jsx("section",{className:"py-20 bg-[#F5A623]",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[a.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-6",children:"Ready to Order?"}),a.jsx("p",{className:"text-gray-800 text-lg mb-8",children:"Experience the convenience of fresh African groceries delivered to your door."}),a.jsx(Ie,{to:"/stores",className:"inline-block bg-[#00897B] text-white px-10 py-4 rounded-xl font-bold shadow-lg hover:bg-[#00695C] transition-all",children:"Browse Stores Near You"})]})}),a.jsx("footer",{className:"bg-[#1a1a1a] text-white py-12",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold mb-4",children:"Afrimercato"}),a.jsx("p",{className:"text-gray-400 text-sm",children:"Fresh African groceries delivered across the UK."})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold mb-4",children:"Company"}),a.jsxs("ul",{className:"space-y-2 text-gray-400 text-sm",children:[a.jsx("li",{children:a.jsx(Ie,{to:"/",className:"hover:text-[#F5A623]",children:"Home"})}),a.jsx("li",{children:a.jsx(Ie,{to:"/stores",className:"hover:text-[#F5A623]",children:"Stores"})}),a.jsx("li",{children:a.jsx(Ie,{to:"/about",className:"hover:text-[#F5A623]",children:"About Us"})}),a.jsx("li",{children:a.jsx(Ie,{to:"/contact",className:"hover:text-[#F5A623]",children:"Contact"})})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold mb-4",children:"Support"}),a.jsxs("ul",{className:"space-y-2 text-gray-400 text-sm",children:[a.jsx("li",{children:a.jsx(Ie,{to:"/delivery",className:"hover:text-[#F5A623]",children:"Delivery Info"})}),a.jsx("li",{children:a.jsx(Ie,{to:"/partner",className:"hover:text-[#F5A623]",children:"Partner With Us"})})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold mb-4",children:"Contact"}),a.jsx("p",{className:"text-gray-400 text-sm",children:"info@afrimercato.co.uk"}),a.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Manchester, United Kingdom"})]})]}),a.jsx("div",{className:"border-t border-gray-800 mt-8 pt-8 text-center text-gray-500 text-sm",children:a.jsx("p",{children:"Â© 2024 Afrimercato. All rights reserved."})})]})})]})}function g3(){const[e,r]=ge.useState({name:"",email:"",subject:"general",message:""}),[t,n]=ge.useState(!1),s=c=>{c.preventDefault(),n(!0),setTimeout(()=>{r({name:"",email:"",subject:"general",message:""}),n(!1)},3e3)},o=[{icon:"ðŸ“§",title:"Email Us",content:"info@afrimercato.co.uk",description:"We reply within 24 hours"},{icon:"ðŸ“",title:"Visit Us",content:"Washington Ave, Manchester",description:"United Kingdom"},{icon:"ðŸ“ž",title:"Call Us",content:"+44 161 123 4567",description:"Mon-Fri, 9am-6pm"}],l=[{value:"general",label:"General Inquiry"},{value:"order",label:"Order Support"},{value:"delivery",label:"Delivery Issue"},{value:"vendor",label:"Vendor Partnership"},{value:"feedback",label:"Feedback & Suggestions"},{value:"press",label:"Press & Media"}];return a.jsxs("div",{className:"min-h-screen bg-white",children:[a.jsx("nav",{className:"bg-white border-b border-gray-200 sticky top-0 z-50 shadow-sm",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex justify-between items-center h-16",children:[a.jsxs(Ie,{to:"/",className:"flex items-center gap-2",children:[a.jsx("svg",{className:"w-8 h-8",viewBox:"0 0 40 40",fill:"none",children:a.jsx("path",{d:"M8 8L32 32M32 8L8 32",stroke:"#1a1a1a",strokeWidth:"4",strokeLinecap:"round"})}),a.jsx("span",{className:"text-xl font-bold text-gray-900",children:"Afrimercato"})]}),a.jsxs("div",{className:"hidden md:flex items-center gap-6",children:[a.jsx(Ie,{to:"/",className:"text-gray-600 hover:text-gray-900 font-medium",children:"Home"}),a.jsx(Ie,{to:"/stores",className:"text-gray-600 hover:text-gray-900 font-medium",children:"Stores"}),a.jsx(Ie,{to:"/delivery",className:"text-gray-600 hover:text-gray-900 font-medium",children:"Delivery"}),a.jsx(Ie,{to:"/about",className:"text-gray-600 hover:text-gray-900 font-medium",children:"About us"}),a.jsx(Ie,{to:"/contact",className:"text-[#00897B] font-medium",children:"Contact us"})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Ie,{to:"/login",className:"text-gray-700 hover:text-gray-900 font-medium",children:"Log in"}),a.jsx(Ie,{to:"/register",className:"flex items-center gap-2 bg-[#00897B] hover:bg-[#00695C] text-white px-4 py-2 rounded-full font-semibold transition-all",children:"Sign Up"})]})]})})}),a.jsxs("section",{className:"relative bg-gradient-to-br from-[#1a1a1a] to-[#333] py-20 overflow-hidden",children:[a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[a.jsx(Re.h1,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},className:"text-4xl md:text-6xl font-bold text-white mb-6",children:"Get In Touch"}),a.jsx(Re.p,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.1},className:"text-xl text-gray-300 max-w-2xl mx-auto",children:"Have questions? We'd love to hear from you. Send us a message and we'll respond as soon as possible."})]}),a.jsx("div",{className:"absolute bottom-0 left-0 right-0",children:a.jsx("svg",{viewBox:"0 0 1440 120",fill:"none",preserveAspectRatio:"none",className:"w-full h-20",children:a.jsx("path",{d:"M0 120L1440 120L1440 0C1200 80 800 40 400 60C200 70 0 40 0 0L0 120Z",fill:"white"})})})]}),a.jsx("section",{className:"py-16 -mt-12",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsx("div",{className:"grid md:grid-cols-3 gap-6",children:o.map((c,d)=>a.jsxs(Re.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:d*.1},className:"bg-white rounded-2xl shadow-xl p-8 text-center hover:shadow-2xl transition-shadow border border-gray-100",children:[a.jsx("div",{className:"text-5xl mb-4",children:c.icon}),a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:c.title}),a.jsx("p",{className:"text-[#00897B] font-semibold mb-1",children:c.content}),a.jsx("p",{className:"text-gray-500 text-sm",children:c.description})]},c.title))})})}),a.jsx("section",{className:"py-16",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"grid lg:grid-cols-2 gap-12",children:[a.jsxs(Re.div,{initial:{opacity:0,x:-50},whileInView:{opacity:1,x:0},viewport:{once:!0},children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-6",children:"Send Us a Message"}),a.jsxs("form",{onSubmit:s,className:"space-y-6",children:[a.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Your Name *"}),a.jsx("input",{type:"text",required:!0,value:e.name,onChange:c=>r({...e,name:c.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-[#00897B] focus:border-transparent transition-all",placeholder:"John Doe"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Email Address *"}),a.jsx("input",{type:"email",required:!0,value:e.email,onChange:c=>r({...e,email:c.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-[#00897B] focus:border-transparent transition-all",placeholder:"john@example.com"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Subject *"}),a.jsx("select",{required:!0,value:e.subject,onChange:c=>r({...e,subject:c.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-[#00897B] focus:border-transparent transition-all",children:l.map(c=>a.jsx("option",{value:c.value,children:c.label},c.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Message *"}),a.jsx("textarea",{required:!0,rows:5,value:e.message,onChange:c=>r({...e,message:c.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-[#00897B] focus:border-transparent transition-all resize-none",placeholder:"How can we help you?"})]}),a.jsx("button",{type:"submit",disabled:t,className:`w-full py-4 rounded-xl font-bold text-lg transition-all ${t?"bg-green-500 text-white":"bg-[#00897B] hover:bg-[#00695C] text-white shadow-lg hover:shadow-xl"}`,children:t?"Message Sent!":"Send Message"})]})]}),a.jsxs(Re.div,{initial:{opacity:0,x:50},whileInView:{opacity:1,x:0},viewport:{once:!0},className:"space-y-8",children:[a.jsx("div",{className:"bg-gray-100 rounded-2xl h-64 flex items-center justify-center overflow-hidden",children:a.jsx("img",{src:"https://images.unsplash.com/photo-1526778548025-fa2f459cd5c1?w=600",alt:"Location",className:"w-full h-full object-cover"})}),a.jsxs("div",{className:"bg-[#F5A623]/10 rounded-2xl p-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Office Hours"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Monday - Friday"}),a.jsx("span",{className:"font-semibold text-gray-900",children:"9:00 AM - 6:00 PM"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Saturday"}),a.jsx("span",{className:"font-semibold text-gray-900",children:"10:00 AM - 4:00 PM"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Sunday"}),a.jsx("span",{className:"font-semibold text-gray-900",children:"Closed"})]})]})]}),a.jsxs("div",{className:"bg-gray-50 rounded-2xl p-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Follow Us"}),a.jsx("div",{className:"flex gap-4",children:[{name:"Facebook",icon:"ðŸ“˜"},{name:"Twitter",icon:"ðŸ¦"},{name:"Instagram",icon:"ðŸ“·"},{name:"LinkedIn",icon:"ðŸ’¼"}].map(c=>a.jsx("a",{href:"#",className:"w-12 h-12 bg-white rounded-xl shadow-md flex items-center justify-center text-2xl hover:shadow-lg hover:-translate-y-1 transition-all",title:c.name,children:c.icon},c.name))})]}),a.jsxs("div",{className:"bg-[#00897B] rounded-2xl p-6 text-white",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Need Quick Help?"}),a.jsx("p",{className:"text-white/80 mb-4",children:"Check our FAQ section for instant answers to common questions."}),a.jsx(Ie,{to:"/delivery#faqs",className:"inline-block bg-white text-[#00897B] px-6 py-3 rounded-xl font-semibold hover:bg-gray-100 transition-all",children:"View FAQs"})]})]})]})})}),a.jsx("section",{className:"py-16 bg-gray-50",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Interested in Partnering With Us?"}),a.jsx("p",{className:"text-gray-600 mb-8",children:"Join over 4,320 vendors already selling on Afrimercato and reach thousands of customers."}),a.jsx(Ie,{to:"/partner",className:"inline-block bg-[#F5A623] text-gray-900 px-10 py-4 rounded-xl font-bold shadow-lg hover:bg-[#FF9800] transition-all",children:"Become a Vendor"})]})}),a.jsx("footer",{className:"bg-[#1a1a1a] text-white py-12",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold mb-4",children:"Afrimercato"}),a.jsx("p",{className:"text-gray-400 text-sm",children:"Fresh African groceries delivered across the UK."})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold mb-4",children:"Company"}),a.jsxs("ul",{className:"space-y-2 text-gray-400 text-sm",children:[a.jsx("li",{children:a.jsx(Ie,{to:"/",className:"hover:text-[#F5A623]",children:"Home"})}),a.jsx("li",{children:a.jsx(Ie,{to:"/stores",className:"hover:text-[#F5A623]",children:"Stores"})}),a.jsx("li",{children:a.jsx(Ie,{to:"/about",className:"hover:text-[#F5A623]",children:"About Us"})}),a.jsx("li",{children:a.jsx(Ie,{to:"/contact",className:"hover:text-[#F5A623]",children:"Contact"})})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold mb-4",children:"Support"}),a.jsxs("ul",{className:"space-y-2 text-gray-400 text-sm",children:[a.jsx("li",{children:a.jsx(Ie,{to:"/delivery",className:"hover:text-[#F5A623]",children:"Delivery Info"})}),a.jsx("li",{children:a.jsx(Ie,{to:"/partner",className:"hover:text-[#F5A623]",children:"Partner With Us"})})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold mb-4",children:"Contact"}),a.jsx("p",{className:"text-gray-400 text-sm",children:"info@afrimercato.co.uk"}),a.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Manchester, United Kingdom"})]})]}),a.jsx("div",{className:"border-t border-gray-800 mt-8 pt-8 text-center text-gray-500 text-sm",children:a.jsx("p",{children:"Â© 2024 Afrimercato. All rights reserved."})})]})})]})}const v3=[{name:"Fresh Produce",image:"https://images.unsplash.com/photo-1610832958506-aa56368176cf?w=300",items:45,price:"Â£2"},{name:"Spices & Seasonings",image:"https://images.unsplash.com/photo-1596040033229-a9821ebd058d?w=300",items:60,price:"Â£3"},{name:"Grains & Flour",image:"https://images.unsplash.com/photo-1586201375761-83865001e31c?w=300",items:35,price:"Â£4"},{name:"Dried Fish & Meat",image:"https://images.unsplash.com/photo-1544943910-4c1dc44aab44?w=300",items:28,price:"Â£8"}],y3=[{id:1,name:"Fresh Plantain (Ripe)",category:"Fresh Produce",price:3.99,originalPrice:4.5,rating:5,image:"https://images.unsplash.com/photo-1528825871115-3581a5387919?w=300"},{id:2,name:"Yam Tuber 2kg",category:"Fresh Produce",price:8.99,originalPrice:10,rating:5,image:"https://images.unsplash.com/photo-1598170845058-32b9d6a5da37?w=300"},{id:3,name:"Egusi (Ground) 500g",category:"Spices & Seasonings",price:7.99,originalPrice:9,rating:5,image:"https://images.unsplash.com/photo-1596040033229-a9821ebd058d?w=300"},{id:4,name:"Palm Oil 1L",category:"Cooking Oils",price:6.99,originalPrice:8,rating:4,image:"https://images.unsplash.com/photo-1474979266404-7eaacbcd87c5?w=300"},{id:5,name:"Ogbono (Ground) 400g",category:"Spices & Seasonings",price:8.99,originalPrice:10,rating:5,image:"https://images.unsplash.com/photo-1599909533681-74d488b9dddf?w=300"},{id:6,name:"Stockfish (Medium)",category:"Dried Fish & Meat",price:12.99,originalPrice:15,rating:4,image:"https://images.unsplash.com/photo-1544943910-4c1dc44aab44?w=300"},{id:7,name:"Crayfish (Ground) 200g",category:"Dried Fish & Meat",price:5.99,originalPrice:7,rating:5,image:"https://images.unsplash.com/photo-1565680018434-b513d5e5fd47?w=300"},{id:8,name:"Garri (White) 2kg",category:"Grains & Flour",price:4.99,originalPrice:6,rating:5,image:"https://images.unsplash.com/photo-1586201375761-83865001e31c?w=300"},{id:9,name:"Scotch Bonnet Peppers",category:"Fresh Produce",price:2.99,originalPrice:3.5,rating:4,image:"https://images.unsplash.com/photo-1583119022894-919a68a3d0e3?w=300"},{id:10,name:"Jollof Rice Spice Mix",category:"Spices & Seasonings",price:4.99,originalPrice:5.5,rating:5,image:"https://images.unsplash.com/photo-1596040033229-a9821ebd058d?w=300"},{id:11,name:"Fufu Flour (Pounded Yam)",category:"Grains & Flour",price:5.99,originalPrice:7,rating:5,image:"https://images.unsplash.com/photo-1586201375761-83865001e31c?w=300"},{id:12,name:"Suya Spice Mix 100g",category:"Spices & Seasonings",price:3.99,originalPrice:4.5,rating:5,image:"https://images.unsplash.com/photo-1596040033229-a9821ebd058d?w=300"}];function b3(){const{vendorId:e}=J0(),r=xn(),[t,n]=ge.useState(null),[s,o]=ge.useState(y3),[l,c]=ge.useState(!0),[d,f]=ge.useState("All"),[u,g]=ge.useState(""),[p,m]=ge.useState([]),[j,v]=ge.useState(!1),[N,b]=ge.useState({hours:10,minutes:56,seconds:21}),y=["All","Fresh Produce","Spices & Seasonings","Grains & Flour","Dried Fish & Meat","Cooking Oils"];ge.useEffect(()=>{_()},[e]),ge.useEffect(()=>{const D=setInterval(()=>{b(k=>k.seconds>0?{...k,seconds:k.seconds-1}:k.minutes>0?{...k,minutes:k.minutes-1,seconds:59}:k.hours>0?{hours:k.hours-1,minutes:59,seconds:59}:k)},1e3);return()=>clearInterval(D)},[]);const _=async()=>{var D,k;try{c(!0);const C=await Vm(e);C.data||C.storeName?n(C.data||C):n({storeName:"Josh Supermarket",businessName:"Josh Supermarket",phone:"+44 - 2071 - 234567",deliveryTime:"20 mins"});const z=await Gm(e);((k=(D=z.data)==null?void 0:D.products)==null?void 0:k.length)>0&&o(z.data.products)}catch(C){console.log("Using sample data:",C.message),n({storeName:"Josh Supermarket",businessName:"Josh Supermarket",phone:"+44 - 2071 - 234567",deliveryTime:"20 mins"})}finally{c(!1)}},T=D=>{const k=p.find(C=>C.id===D.id||C._id===D._id);m(k?p.map(C=>C.id===D.id||C._id===D._id?{...C,quantity:C.quantity+1}:C):[...p,{...D,quantity:1}])},O=(D,k)=>{k<=0?m(p.filter(C=>C.id!==D&&C._id!==D)):m(p.map(C=>C.id===D||C._id===D?{...C,quantity:k}:C))},B=D=>{m(p.filter(k=>k.id!==D&&k._id!==D))},L=p.reduce((D,k)=>D+(k.price||0)*(k.quantity||1),0),E=p.reduce((D,k)=>D+(k.quantity||1),0),P=s.filter(D=>{var C;return(C=D.name)==null?void 0:C.toLowerCase().includes(u.toLowerCase())});return l?a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#00897B] mx-auto"}),a.jsx("p",{className:"text-gray-600 mt-4",children:"Loading store..."})]})}):a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("header",{className:"bg-white border-b sticky top-0 z-50",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs("div",{className:"flex items-center justify-between h-16",children:[a.jsx("div",{className:"flex items-center gap-6",children:a.jsxs(Ie,{to:"/",className:"flex items-center gap-2",children:[a.jsx("svg",{className:"w-8 h-8",viewBox:"0 0 40 40",fill:"none",children:a.jsx("path",{d:"M8 8L32 32M32 8L8 32",stroke:"#1a1a1a",strokeWidth:"4",strokeLinecap:"round"})}),a.jsx("span",{className:"text-lg font-bold text-gray-900",children:"Afrimercato"})]})}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(Ie,{to:"/login",className:"text-gray-600 hover:text-gray-900 font-medium",children:"Account"}),a.jsxs("button",{onClick:()=>v(!0),className:"relative flex items-center gap-2 bg-[#00897B] hover:bg-[#00695C] text-white px-4 py-2 rounded-lg font-semibold transition-all",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),"Cart",E>0&&a.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold",children:E})]})]})]}),a.jsxs("div",{className:"flex items-center justify-between py-2 border-t text-sm",children:[a.jsxs("div",{className:"flex items-center gap-6",children:[a.jsx("button",{onClick:()=>r(-1),className:"flex items-center gap-1 text-[#00897B] font-medium hover:underline",children:"â† Go Back"}),a.jsxs("span",{className:"text-gray-600",children:["Shopping Method: ",a.jsx("span",{className:"text-gray-900 font-medium",children:"In-Shopping, Delivery"})]})]}),a.jsxs("div",{className:"flex items-center gap-6 text-gray-600",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Deliveries in ",(t==null?void 0:t.deliveryTime)||"20 mins"]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),(t==null?void 0:t.phone)||"+44 - 2071 - 234567"]})]})]})]})}),a.jsxs("section",{className:"bg-gradient-to-r from-[#E8F5E9] to-[#FFF8E1] py-12 relative overflow-hidden",children:[a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"grid lg:grid-cols-2 gap-8 items-center",children:[a.jsxs("div",{children:[a.jsx(Re.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-4xl sm:text-5xl font-bold text-gray-900 mb-2",children:(t==null?void 0:t.storeName)||(t==null?void 0:t.businessName)||"Josh Supermarket"}),a.jsx(Re.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"text-2xl text-[#00897B] font-semibold mb-4",children:"Got You."}),a.jsx(Re.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"text-lg text-gray-600 mb-6",children:"Save up to 60% off on your first order"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"email",placeholder:"Email Address",className:"flex-1 max-w-xs px-4 py-3 rounded-lg border border-gray-300 focus:border-[#00897B] outline-none"}),a.jsx("button",{className:"bg-[#00897B] hover:bg-[#00695C] text-white px-6 py-3 rounded-lg font-semibold transition-all",children:"Find Store"})]})]}),a.jsx("div",{className:"hidden lg:block",children:a.jsx("img",{src:"https://images.unsplash.com/photo-1610832958506-aa56368176cf?w=600",alt:"Fresh produce",className:"w-full h-64 object-cover rounded-2xl shadow-xl"})})]})}),a.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-[#E8F5E9] rounded-full blur-3xl opacity-50"})]}),a.jsx("div",{className:"bg-white border-b sticky top-[104px] z-40",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex items-center justify-between py-4",children:[a.jsx("div",{className:"flex gap-6 overflow-x-auto",children:y.map(D=>a.jsx("button",{onClick:()=>f(D),className:`whitespace-nowrap font-medium pb-2 transition-colors ${d===D?"text-[#00897B] border-b-2 border-[#00897B]":"text-gray-600 hover:text-gray-900"}`,children:D},D))}),a.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg px-4 py-2 min-w-[200px]",children:[a.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),a.jsx("input",{type:"text",placeholder:"Search",value:u,onChange:D=>g(D.target.value),className:"bg-transparent outline-none flex-1 text-gray-900"})]})]})})}),a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[a.jsx("div",{className:"mb-12",children:a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:v3.map((D,k)=>a.jsxs(Re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:k*.1},className:"bg-white rounded-2xl p-4 shadow-md hover:shadow-lg cursor-pointer transition-all text-center",children:[a.jsx("img",{src:D.image,alt:D.name,className:"w-24 h-24 mx-auto object-cover rounded-xl mb-3"}),a.jsxs("p",{className:"text-xs text-gray-500 mb-1",children:[D.items," Items in Store"]}),a.jsx("h3",{className:"font-bold text-gray-900 mb-1",children:D.name}),a.jsxs("p",{className:"text-sm text-gray-600",children:["From ",D.price]})]},D.name))})}),a.jsxs("div",{className:"mb-12",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Daily Best Sales"}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4",children:P.slice(0,10).map((D,k)=>a.jsx(pf,{product:D,onAddToCart:()=>T(D)},D.id||D._id||k))})]}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mb-12",children:[a.jsxs("div",{className:"bg-gradient-to-r from-[#00897B] to-[#00695C] text-white p-6 rounded-2xl relative overflow-hidden",children:[a.jsx("img",{src:"https://images.unsplash.com/photo-1498837167922-ddd27525d352?w=200",alt:"Fresh produce",className:"absolute right-0 bottom-0 w-32 h-32 object-cover opacity-30"}),a.jsx("h3",{className:"text-xl font-bold mb-2 relative z-10",children:"Free delivery"}),a.jsx("p",{className:"mb-4 relative z-10",children:"over Â£50"}),a.jsx("button",{className:"bg-white text-[#00897B] px-4 py-2 rounded-lg font-semibold hover:bg-gray-100 transition relative z-10",children:"Shop Now â†’"})]}),a.jsxs("div",{className:"bg-gradient-to-r from-[#F5A623] to-[#FF9800] text-white p-6 rounded-2xl relative overflow-hidden",children:[a.jsx("span",{className:"absolute top-4 right-4 bg-white/20 px-2 py-1 rounded text-sm font-medium",children:"60% off"}),a.jsx("img",{src:"https://images.unsplash.com/photo-1610832958506-aa56368176cf?w=200",alt:"Organic food",className:"absolute right-0 bottom-0 w-32 h-32 object-cover opacity-30"}),a.jsx("h3",{className:"text-xl font-bold mb-2 relative z-10",children:"Organic Food"}),a.jsx("p",{className:"mb-4 relative z-10",children:"Save up to 60% off on your first order"}),a.jsx("button",{className:"bg-white text-[#F5A623] px-4 py-2 rounded-lg font-semibold hover:bg-gray-100 transition relative z-10",children:"Order Now â†’"})]}),a.jsxs("div",{className:"bg-gradient-to-r from-[#00897B] to-[#00695C] text-white p-6 rounded-2xl relative overflow-hidden",children:[a.jsx("img",{src:"https://images.unsplash.com/photo-1542838132-92c53300491e?w=200",alt:"Free delivery",className:"absolute right-0 bottom-0 w-32 h-32 object-cover opacity-30"}),a.jsx("h3",{className:"text-xl font-bold mb-2 relative z-10",children:"Free delivery"}),a.jsx("p",{className:"mb-4 relative z-10",children:"Shop Â£50 get free delivery"}),a.jsx("button",{className:"bg-white text-[#00897B] px-4 py-2 rounded-lg font-semibold hover:bg-gray-100 transition relative z-10",children:"Shop Now â†’"})]})]}),a.jsxs("div",{className:"mb-12",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Discounts Sales"}),a.jsxs("div",{className:"flex items-center gap-2 bg-[#00897B] text-white px-4 py-2 rounded-lg",children:[a.jsx("span",{className:"text-sm",children:"Expires in:"}),a.jsxs("span",{className:"font-bold",children:[String(N.hours).padStart(2,"0"),":",String(N.minutes).padStart(2,"0"),":",String(N.seconds).padStart(2,"0")]})]})]}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4",children:P.slice(0,10).map((D,k)=>a.jsx(pf,{product:D,onAddToCart:()=>T(D),isDiscount:!0},`discount-${D.id||D._id||k}`))})]})]}),a.jsxs("section",{className:"relative py-16 overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-[#F5A623]",children:a.jsx("svg",{className:"absolute top-0 left-0 w-full",viewBox:"0 0 1440 100",fill:"none",preserveAspectRatio:"none",children:a.jsx("path",{d:"M0 50C240 100 480 0 720 50C960 100 1200 0 1440 50V0H0V50Z",fill:"#F8F8F8"})})}),a.jsxs("div",{className:"relative max-w-3xl mx-auto px-4 sm:px-6 text-center py-8",children:[a.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-4",children:"Join the waitlist for Our App"}),a.jsx("p",{className:"text-gray-700 mb-6 max-w-xl mx-auto",children:"Exciting things are coming your way! Be the first to experience the ultimate shopping convenience with our upcoming app."}),a.jsxs("form",{className:"flex flex-col sm:flex-row gap-3 max-w-md mx-auto",children:[a.jsx("input",{type:"email",placeholder:"Enter email address",className:"flex-1 px-5 py-3 rounded-full border-2 border-gray-200 focus:border-[#00897B] outline-none"}),a.jsx("button",{type:"submit",className:"bg-[#00897B] hover:bg-[#00695C] text-white px-8 py-3 rounded-full font-bold transition-all",children:"Join List"})]})]})]}),a.jsx("footer",{className:"bg-[#1a1a1a] text-white py-12",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-8 mb-10",children:[a.jsxs("div",{className:"lg:col-span-2",children:[a.jsxs("h3",{className:"text-xl font-bold mb-4",children:["You've Got Questions?",a.jsx("br",{}),"Do Reach Out!"]}),a.jsx("p",{className:"text-gray-400 text-sm mb-2",children:"Email: info@afrimercato.co.uk"}),a.jsx("p",{className:"text-gray-400 text-sm",children:"Location: Washington Ave, Manchester, UK"})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold mb-4",children:"Company"}),a.jsxs("ul",{className:"space-y-2 text-gray-400 text-sm",children:[a.jsx("li",{children:a.jsx(Ie,{to:"/",className:"hover:text-yellow-500",children:"Home"})}),a.jsx("li",{children:a.jsx(Ie,{to:"/stores",className:"hover:text-yellow-500",children:"Stores"})}),a.jsx("li",{children:a.jsx(Ie,{to:"/partner",className:"hover:text-yellow-500",children:"Partner"})})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold mb-4",children:"Cities"}),a.jsxs("ul",{className:"space-y-2 text-gray-400 text-sm",children:[a.jsx("li",{children:a.jsx(Ie,{to:"/stores?location=London",className:"hover:text-yellow-500",children:"London"})}),a.jsx("li",{children:a.jsx(Ie,{to:"/stores?location=Manchester",className:"hover:text-yellow-500",children:"Manchester"})}),a.jsx("li",{children:a.jsx(Ie,{to:"/stores?location=Birmingham",className:"hover:text-yellow-500",children:"Birmingham"})})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold mb-4",children:"Quick stores"}),a.jsxs("ul",{className:"space-y-2 text-gray-400 text-sm",children:[a.jsx("li",{children:a.jsx("span",{className:"hover:text-yellow-500 cursor-pointer",children:"Supermart"})}),a.jsx("li",{children:a.jsx("span",{className:"hover:text-yellow-500 cursor-pointer",children:"Shoprite"})}),a.jsx("li",{children:a.jsx("span",{className:"hover:text-yellow-500 cursor-pointer",children:"Buka"})})]})]})]}),a.jsxs("div",{className:"border-t border-gray-800 pt-8 flex flex-col sm:flex-row justify-between items-center gap-4 text-gray-500 text-sm",children:[a.jsx("p",{children:"Â© 2024 Afrimercato"}),a.jsx("p",{children:"Designed By thedesignpygi"}),a.jsx("p",{children:"All Right Reserved."})]})]})}),a.jsx(Ql,{children:j&&a.jsxs(a.Fragment,{children:[a.jsx(Re.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>v(!1),className:"fixed inset-0 bg-black/50 z-50"}),a.jsx(Re.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},className:"fixed right-0 top-0 bottom-0 w-full max-w-md bg-white shadow-2xl z-50 overflow-y-auto",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Shopping Cart"}),a.jsx("button",{onClick:()=>v(!1),className:"text-gray-400 hover:text-gray-600 text-2xl",children:"Ã—"})]}),p.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("p",{className:"text-4xl mb-2",children:"ðŸ›’"}),a.jsx("p",{className:"text-gray-600",children:"Your cart is empty"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"space-y-4 mb-6",children:p.map(D=>a.jsxs("div",{className:"flex gap-4 border-b pb-4",children:[a.jsx("img",{src:D.image||"https://images.unsplash.com/photo-1542838132-92c53300491e?w=100",alt:D.name,className:"w-20 h-20 object-cover rounded-lg"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:D.name}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Â£",(D.price||0).toFixed(2)]}),a.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.jsx("button",{onClick:()=>O(D.id||D._id,D.quantity-1),className:"w-6 h-6 bg-gray-200 rounded hover:bg-gray-300",children:"-"}),a.jsx("span",{className:"font-semibold",children:D.quantity}),a.jsx("button",{onClick:()=>O(D.id||D._id,D.quantity+1),className:"w-6 h-6 bg-gray-200 rounded hover:bg-gray-300",children:"+"}),a.jsx("button",{onClick:()=>B(D.id||D._id),className:"ml-auto text-red-500 hover:text-red-700",children:"ðŸ—‘ï¸"})]})]})]},D.id||D._id))}),a.jsxs("div",{className:"border-t pt-4 mb-6",children:[a.jsxs("div",{className:"flex justify-between mb-2",children:[a.jsx("span",{className:"text-gray-600",children:"Subtotal:"}),a.jsxs("span",{className:"font-semibold",children:["Â£",L.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between mb-2",children:[a.jsx("span",{className:"text-gray-600",children:"Delivery:"}),a.jsxs("span",{className:"font-semibold",children:["Â£",L>=50?"0.00":"5.00"]})]}),a.jsxs("div",{className:"flex justify-between text-xl font-bold border-t pt-2",children:[a.jsx("span",{children:"Total:"}),a.jsxs("span",{children:["Â£",(L+(L>=50?0:5)).toFixed(2)]})]})]}),a.jsx("button",{onClick:()=>{localStorage.setItem("cart",JSON.stringify(p)),r("/checkout")},className:"w-full bg-[#00897B] hover:bg-[#00695C] text-white py-4 rounded-lg font-bold text-lg transition-all",children:"Proceed to Checkout"})]})]})})]})})]})}function pf({product:e,onAddToCart:r,isDiscount:t}){const[n,s]=ge.useState(!1),o=()=>{r(),s(!0),setTimeout(()=>s(!1),1e3)};return a.jsxs(Re.div,{whileHover:{y:-5},className:"bg-white rounded-xl shadow-md hover:shadow-lg transition-all overflow-hidden",children:[a.jsxs("div",{className:"relative h-32 bg-gray-100",children:[a.jsx("img",{src:e.image||"https://images.unsplash.com/photo-1542838132-92c53300491e?w=200",alt:e.name,className:"w-full h-full object-cover",onError:l=>{l.target.src="https://images.unsplash.com/photo-1542838132-92c53300491e?w=200"}}),t&&a.jsx("span",{className:"absolute top-2 right-2 bg-red-500 text-white px-2 py-0.5 rounded text-xs font-bold",children:"Sale"})]}),a.jsxs("div",{className:"p-3",children:[a.jsx("p",{className:"text-xs text-gray-500 mb-1",children:e.category||"Vegetables"}),a.jsx("h3",{className:"font-semibold text-gray-900 text-sm mb-1 truncate",children:e.name}),a.jsx("div",{className:"flex items-center gap-0.5 mb-2",children:[...Array(5)].map((l,c)=>a.jsx("span",{className:`text-xs ${c<(e.rating||4)?"text-yellow-400":"text-gray-300"}`,children:"â˜…"},c))}),a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.originalPrice&&a.jsxs("span",{className:"text-xs text-gray-400 line-through",children:["Â£",e.originalPrice.toFixed(2)]}),a.jsxs("span",{className:"font-bold text-[#00B207]",children:["Â£",(e.price||18.99).toFixed(2)]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{className:"p-1.5 bg-gray-100 hover:bg-gray-200 rounded transition",children:a.jsx("svg",{className:"w-4 h-4 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}),a.jsx("button",{onClick:o,className:`flex-1 py-1.5 rounded text-sm font-semibold transition ${n?"bg-green-500 text-white":"bg-[#00897B] hover:bg-[#00695C] text-white"}`,children:n?"âœ“ Added":"Add"})]})]})]})}function w3(){const e=xn(),[r,t]=ge.useState(!0),[n,s]=ge.useState({activeOrders:0,totalOrders:0,wishlistItems:0,rewardPoints:0}),[o,l]=ge.useState([]),[c,d]=ge.useState([]);ge.useEffect(()=>{f()},[]);const f=async()=>{try{t(!0);const[p,m,j]=await Promise.all([f0.getDashboardStats(),f0.getRecentOrders({limit:5}),f0.getRecommendedProducts({limit:4})]);p.success&&s(p.data),m.success&&l(m.data.orders||m.data||[]),j.success&&d(j.data.products||j.data||[])}catch(p){console.error("Dashboard error:",p)}finally{t(!1)}},u=p=>({pending:"bg-yellow-100 text-yellow-800",confirmed:"bg-blue-100 text-blue-800",preparing:"bg-orange-100 text-orange-800","out-for-delivery":"bg-purple-100 text-purple-800",delivered:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"})[p]||"bg-gray-100 text-gray-800",g=[{icon:"ðŸ›ï¸",title:"Browse Products",description:"Explore our fresh products",action:()=>e("/products"),color:"from-blue-500 to-blue-600"},{icon:"ðŸ“",title:"Find Vendors",description:"Discover local stores",action:()=>e("/vendors"),color:"from-green-500 to-green-600"},{icon:"ðŸ“¦",title:"Track Orders",description:"Check delivery status",action:()=>e("/orders"),color:"from-purple-500 to-purple-600"},{icon:"â¤ï¸",title:"Wishlist",description:"View saved items",action:()=>e("/wishlist"),color:"from-red-500 to-red-600"}];return r?a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-afri-green mx-auto mb-4"}),a.jsx("p",{className:"text-afri-gray-600",children:"Loading your dashboard..."})]})}):a.jsxs("div",{className:"min-h-screen bg-gray-50 pb-12",children:[a.jsx("div",{className:"bg-gradient-to-r from-afri-green to-afri-green-dark text-white py-8 animate-slideDown",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Welcome Back! ðŸ‘‹"}),a.jsx("p",{className:"text-afri-green-light",children:"Here's what's happening with your orders"})]})}),a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 -mt-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 transform hover:scale-105 transition-all duration-300 animate-fadeIn",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-yellow-400 to-yellow-500 rounded-lg flex items-center justify-center text-2xl shadow-lg",children:"ðŸ“¦"}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.activeOrders}),a.jsx("p",{className:"text-sm text-gray-500",children:"Active Orders"})]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-gradient-to-r from-yellow-400 to-yellow-500 h-2 rounded-full",style:{width:"70%"}})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 transform hover:scale-105 transition-all duration-300 animate-fadeIn",style:{animationDelay:"100ms"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-400 to-blue-500 rounded-lg flex items-center justify-center text-2xl shadow-lg",children:"ðŸ“Š"}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.totalOrders}),a.jsx("p",{className:"text-sm text-gray-500",children:"Total Orders"})]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-gradient-to-r from-blue-400 to-blue-500 h-2 rounded-full",style:{width:"100%"}})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 transform hover:scale-105 transition-all duration-300 animate-fadeIn",style:{animationDelay:"200ms"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-red-400 to-red-500 rounded-lg flex items-center justify-center text-2xl shadow-lg",children:"â¤ï¸"}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.wishlistItems}),a.jsx("p",{className:"text-sm text-gray-500",children:"Wishlist Items"})]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-gradient-to-r from-red-400 to-red-500 h-2 rounded-full",style:{width:"85%"}})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 transform hover:scale-105 transition-all duration-300 animate-fadeIn",style:{animationDelay:"300ms"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-400 to-purple-500 rounded-lg flex items-center justify-center text-2xl shadow-lg",children:"â­"}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.rewardPoints}),a.jsx("p",{className:"text-sm text-gray-500",children:"Reward Points"})]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-gradient-to-r from-purple-400 to-purple-500 h-2 rounded-full",style:{width:"60%"}})})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-8 animate-slideUp",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Quick Actions"}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:g.map((p,m)=>a.jsxs("button",{onClick:p.action,className:"flex flex-col items-center p-6 bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl hover:shadow-xl transition-all duration-300 transform hover:scale-105 group",children:[a.jsx("div",{className:`w-16 h-16 bg-gradient-to-r ${p.color} rounded-full flex items-center justify-center text-3xl mb-3 shadow-lg group-hover:scale-110 transition-transform`,children:p.icon}),a.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:p.title}),a.jsx("p",{className:"text-sm text-gray-500 text-center",children:p.description})]},m))})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[a.jsxs("div",{className:"lg:col-span-2 bg-white rounded-xl shadow-lg p-6 animate-fadeIn",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Recent Orders"}),a.jsx("button",{onClick:()=>e("/orders"),className:"text-afri-green hover:text-afri-green-dark font-semibold text-sm",children:"View All â†’"})]}),o.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“¦"}),a.jsx("p",{className:"text-gray-500 mb-4",children:"No orders yet"}),a.jsx("button",{onClick:()=>e("/products"),className:"px-6 py-2 bg-gradient-to-r from-afri-green to-afri-green-dark text-white rounded-lg font-semibold hover:shadow-lg transition-all",children:"Start Shopping"})]}):a.jsx("div",{className:"space-y-4",children:o.map((p,m)=>{var j,v,N,b;return a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>e(`/orders/${p._id}`),children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"w-12 h-12 bg-gradient-to-br from-afri-green to-afri-green-dark rounded-lg flex items-center justify-center text-white font-bold",children:["#",((j=p.orderNumber)==null?void 0:j.slice(-4))||"N/A"]}),a.jsxs("div",{children:[a.jsxs("p",{className:"font-semibold text-gray-900",children:[((v=p.items)==null?void 0:v.length)||0," items"]}),a.jsx("p",{className:"text-sm text-gray-500",children:new Date(p.createdAt).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"font-bold text-gray-900",children:["Â£",((N=p.totalAmount)==null?void 0:N.toFixed(2))||"0.00"]}),a.jsx("span",{className:`text-xs px-3 py-1 rounded-full font-semibold ${u(p.status)}`,children:((b=p.status)==null?void 0:b.replace(/-/g," ").replace(/\b\w/g,y=>y.toUpperCase()))||"Pending"})]})]},p._id||m)})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 animate-fadeIn",style:{animationDelay:"200ms"},children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Recommended for You"}),c.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"text-5xl mb-3",children:"ðŸ›ï¸"}),a.jsx("p",{className:"text-gray-500 text-sm",children:"No recommendations yet"})]}):a.jsx("div",{className:"space-y-4",children:c.map((p,m)=>{var j;return a.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>e(`/products/${p._id}`),children:[a.jsx("img",{src:Nx(p),alt:p.name,className:"w-16 h-16 rounded-lg object-cover"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-gray-900 text-sm line-clamp-1",children:p.name}),a.jsx("p",{className:"text-xs text-gray-500",children:p.unit||"per item"}),a.jsxs("p",{className:"text-afri-green font-bold mt-1",children:["Â£",((j=p.price)==null?void 0:j.toFixed(2))||"0.00"]})]})]},p._id||m)})}),a.jsx("button",{onClick:()=>e("/products"),className:"w-full mt-4 py-2 bg-gradient-to-r from-afri-green to-afri-green-dark text-white rounded-lg font-semibold hover:shadow-lg transition-all",children:"Browse All Products"})]})]})]}),a.jsx("style",{jsx:!0,children:`
        @keyframes slideDown {
          from {
            opacity: 0;
            transform: translateY(-20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        @keyframes slideUp {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        @keyframes fadeIn {
          from {
            opacity: 0;
          }
          to {
            opacity: 1;
          }
        }

        .animate-slideDown {
          animation: slideDown 0.5s ease-out;
        }

        .animate-slideUp {
          animation: slideUp 0.6s ease-out;
        }

        .animate-fadeIn {
          animation: fadeIn 0.6s ease-out;
        }

        .line-clamp-1 {
          overflow: hidden;
          display: -webkit-box;
          -webkit-line-clamp: 1;
          -webkit-box-orient: vertical;
        }
      `})]})}const N3="https://afrimercato-backend-production-0329.up.railway.app";function j3(){const e=xn(),{isAuthenticated:r}=Di(),[t,n]=ge.useState([]),[s,o]=ge.useState(1),[l,c]=ge.useState(!1),[d,f]=ge.useState({fullName:"",phone:"",street:"",city:"",postcode:"",instructions:""}),[u,g]=ge.useState({method:"card",saveCard:!1});ge.useEffect(()=>{const b=JSON.parse(localStorage.getItem("cart")||"[]");n(b),b.length===0&&e("/stores"),r||(localStorage.setItem("checkout_redirect","true"),e("/login"))},[r,e]);const p=t.reduce((b,y)=>b+y.price*y.quantity,0),m=p>=50?0:5,j=p+m,v=b=>{b.preventDefault(),o(2)},N=async b=>{b.preventDefault(),c(!0);try{const y={items:t.map(O=>({product:O._id,name:O.name,price:O.price,quantity:O.quantity,unit:O.unit||"piece"})),deliveryAddress:d,payment:{method:u.method,status:"pending"},pricing:{subtotal:p,deliveryFee:m,total:j}},T=await(await fetch(`${N3}/api/checkout/payment/initialize`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("afrimercato_token")}`},body:JSON.stringify(y)})).json();T.success?(localStorage.removeItem("cart"),e(`/order-confirmation/${T.data.order._id}`)):alert("Order failed: "+T.message)}catch(y){console.error("Order error:",y),alert("Failed to place order. Please try again.")}finally{c(!1)}};return t.length===0?null:a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("header",{className:"bg-white border-b sticky top-0 z-40 shadow-sm",children:a.jsx("div",{className:"container mx-auto px-6 py-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-2xl",children:"ðŸ›’"}),a.jsx("span",{className:"text-xl font-bold text-gray-900",children:"Afrimercato Checkout"})]}),a.jsx("button",{onClick:()=>e(-1),className:"text-gray-600 hover:text-gray-900",children:"â¬…ï¸ Back"})]})})}),a.jsx("div",{className:"container mx-auto px-6 py-8",children:a.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[a.jsxs("div",{className:"lg:col-span-2",children:[a.jsxs("div",{className:"flex items-center justify-between mb-8",children:[a.jsxs("div",{className:`flex items-center ${s>=1?"text-green-600":"text-gray-400"}`,children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${s>=1?"bg-green-600 text-white":"bg-gray-200"}`,children:s>1?"âœ“":"1"}),a.jsx("span",{className:"ml-2 font-semibold",children:"Delivery"})]}),a.jsx("div",{className:"flex-1 h-1 bg-gray-200 mx-4"}),a.jsxs("div",{className:`flex items-center ${s>=2?"text-green-600":"text-gray-400"}`,children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${s>=2?"bg-green-600 text-white":"bg-gray-200"}`,children:s>2?"âœ“":"2"}),a.jsx("span",{className:"ml-2 font-semibold",children:"Payment"})]}),a.jsx("div",{className:"flex-1 h-1 bg-gray-200 mx-4"}),a.jsxs("div",{className:`flex items-center ${s>=3?"text-green-600":"text-gray-400"}`,children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${s>=3?"bg-green-600 text-white":"bg-gray-200"}`,children:"3"}),a.jsx("span",{className:"ml-2 font-semibold",children:"Confirm"})]})]}),s===1&&a.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Delivery Address"}),a.jsxs("form",{onSubmit:v,children:[a.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Full Name *"}),a.jsx("input",{type:"text",required:!0,value:d.fullName,onChange:b=>f({...d,fullName:b.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"John Doe"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Phone Number *"}),a.jsx("input",{type:"tel",required:!0,value:d.phone,onChange:b=>f({...d,phone:b.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"+44 7700 900000"})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Street Address *"}),a.jsx("input",{type:"text",required:!0,value:d.street,onChange:b=>f({...d,street:b.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"123 High Street"})]}),a.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"City *"}),a.jsx("input",{type:"text",required:!0,value:d.city,onChange:b=>f({...d,city:b.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"London"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Postcode *"}),a.jsx("input",{type:"text",required:!0,value:d.postcode,onChange:b=>f({...d,postcode:b.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"SW1A 1AA"})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Delivery Instructions (Optional)"}),a.jsx("textarea",{value:d.instructions,onChange:b=>f({...d,instructions:b.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",rows:"3",placeholder:"e.g., Leave at door, Ring doorbell, etc."})]}),a.jsx("button",{type:"submit",className:"w-full bg-gradient-to-r from-green-600 to-green-700 text-white py-3 rounded-lg font-bold text-lg hover:shadow-lg transition",children:"Continue to Payment â†’"})]})]}),s===2&&a.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Payment Method"}),a.jsxs("form",{onSubmit:()=>o(3),children:[a.jsxs("div",{className:"space-y-4 mb-6",children:[a.jsx("div",{onClick:()=>g({...u,method:"card"}),className:`border-2 rounded-lg p-4 cursor-pointer transition ${u.method==="card"?"border-green-600 bg-green-50":"border-gray-200"}`,children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{type:"radio",checked:u.method==="card",onChange:()=>g({...u,method:"card"}),className:"mr-3"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold text-gray-900",children:"ðŸ’³ Card Payment"}),a.jsx("div",{className:"text-sm text-gray-600",children:"Pay securely with Paystack"})]})]})}),a.jsx("div",{onClick:()=>g({...u,method:"cash"}),className:`border-2 rounded-lg p-4 cursor-pointer transition ${u.method==="cash"?"border-green-600 bg-green-50":"border-gray-200"}`,children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{type:"radio",checked:u.method==="cash",onChange:()=>g({...u,method:"cash"}),className:"mr-3"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold text-gray-900",children:"ðŸ’µ Cash on Delivery"}),a.jsx("div",{className:"text-sm text-gray-600",children:"Pay when you receive your order"})]})]})})]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsx("button",{type:"button",onClick:()=>o(1),className:"flex-1 bg-gray-200 text-gray-700 py-3 rounded-lg font-bold hover:bg-gray-300 transition",children:"â† Back"}),a.jsx("button",{type:"button",onClick:()=>o(3),className:"flex-1 bg-gradient-to-r from-green-600 to-green-700 text-white py-3 rounded-lg font-bold hover:shadow-lg transition",children:"Review Order â†’"})]})]})]}),s===3&&a.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Review & Confirm"}),a.jsxs("div",{className:"mb-6 pb-6 border-b",children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Delivery Address"}),a.jsxs("p",{className:"text-gray-700",children:[d.fullName,a.jsx("br",{}),d.phone,a.jsx("br",{}),d.street,a.jsx("br",{}),d.city,", ",d.postcode]}),d.instructions&&a.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[a.jsx("strong",{children:"Instructions:"})," ",d.instructions]}),a.jsx("button",{onClick:()=>o(1),className:"text-green-600 text-sm font-semibold mt-2 hover:underline",children:"Edit"})]}),a.jsxs("div",{className:"mb-6 pb-6 border-b",children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Payment Method"}),a.jsx("p",{className:"text-gray-700",children:u.method==="card"?"ðŸ’³ Card Payment (Paystack)":"ðŸ’µ Cash on Delivery"}),a.jsx("button",{onClick:()=>o(2),className:"text-green-600 text-sm font-semibold mt-2 hover:underline",children:"Edit"})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Order Items"}),t.map(b=>a.jsxs("div",{className:"flex justify-between py-2",children:[a.jsxs("span",{className:"text-gray-700",children:[b.name," x ",b.quantity]}),a.jsxs("span",{className:"font-semibold",children:["Â£",(b.price*b.quantity).toFixed(2)]})]},b._id))]}),a.jsx("form",{onSubmit:N,children:a.jsxs("div",{className:"flex gap-4",children:[a.jsx("button",{type:"button",onClick:()=>o(2),className:"flex-1 bg-gray-200 text-gray-700 py-3 rounded-lg font-bold hover:bg-gray-300 transition",children:"â† Back"}),a.jsx("button",{type:"submit",disabled:l,className:"flex-1 bg-gradient-to-r from-green-600 to-green-700 text-white py-3 rounded-lg font-bold hover:shadow-lg transition disabled:opacity-50",children:l?"Placing Order...":`Place Order (Â£${j.toFixed(2)})`})]})})]})]}),a.jsx("div",{className:"lg:col-span-1",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 sticky top-24",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Order Summary"}),a.jsx("div",{className:"space-y-3 mb-4 max-h-60 overflow-y-auto",children:t.map(b=>{var y,_;return a.jsxs("div",{className:"flex gap-3",children:[a.jsx("img",{src:((_=(y=b.images)==null?void 0:y[0])==null?void 0:_.url)||"https://images.unsplash.com/photo-1542838132-92c53300491e?w=200&q=80",alt:b.name,className:"w-16 h-16 object-cover rounded",onError:T=>{T.target.src="https://images.unsplash.com/photo-1542838132-92c53300491e?w=200&q=80"}}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-sm text-gray-900",children:b.name}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Qty: ",b.quantity]}),a.jsxs("p",{className:"text-sm font-bold text-green-600",children:["Â£",b.price.toFixed(2)]})]})]},b._id)})}),a.jsxs("div",{className:"border-t pt-4 space-y-2",children:[a.jsxs("div",{className:"flex justify-between text-gray-700",children:[a.jsx("span",{children:"Subtotal"}),a.jsxs("span",{children:["Â£",p.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between text-gray-700",children:[a.jsx("span",{children:"Delivery Fee"}),a.jsx("span",{children:m===0?"FREE":`Â£${m.toFixed(2)}`})]}),p>=50&&a.jsx("p",{className:"text-xs text-green-600",children:"ðŸŽ‰ Free delivery on orders over Â£50"}),a.jsxs("div",{className:"flex justify-between text-xl font-bold text-gray-900 border-t pt-2",children:[a.jsx("span",{children:"Total"}),a.jsxs("span",{children:["Â£",j.toFixed(2)]})]})]}),a.jsx("div",{className:"mt-6 bg-green-50 rounded-lg p-3 text-center",children:a.jsx("p",{className:"text-xs text-green-800",children:"ðŸ”’ Secure checkout powered by Paystack"})})]})})]})})]})}const S3="https://afrimercato-backend-production-0329.up.railway.app";function _3(){var o,l,c,d,f,u,g,p,m,j,v,N,b,y,_,T,O;const{orderId:e}=J0();xn();const[r,t]=ge.useState(null),[n,s]=ge.useState(!0);return ge.useEffect(()=>{(async()=>{try{const E=await(await fetch(`${S3}/api/orders/${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("afrimercato_token")}`}})).json();E.success&&t(E.data)}catch(L){console.error("Error fetching order:",L)}finally{s(!1)}})()},[e]),n?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-4 border-b-4 border-green-600 mx-auto"}),a.jsx("p",{className:"text-gray-600 mt-4",children:"Loading order..."})]})}):r?a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("header",{className:"bg-white border-b shadow-sm",children:a.jsx("div",{className:"container mx-auto px-6 py-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-2xl",children:"ðŸ›’"}),a.jsx("span",{className:"text-xl font-bold text-gray-900",children:"Afrimercato"})]}),a.jsx(Ie,{to:"/stores",className:"text-gray-600 hover:text-gray-900",children:"Continue Shopping"})]})})}),a.jsxs("div",{className:"container mx-auto px-6 py-12",children:[a.jsxs("div",{className:"max-w-2xl mx-auto text-center mb-8",children:[a.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx("span",{className:"text-4xl",children:"âœ“"})}),a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Order Placed Successfully!"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Thank you for your order. We've received your order and will start preparing it shortly."}),a.jsxs("p",{className:"text-sm text-gray-500",children:["Order Number: ",a.jsx("span",{className:"font-bold text-gray-900",children:r.orderNumber})]})]}),a.jsxs("div",{className:"max-w-2xl mx-auto",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mb-6",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Order Details"}),a.jsxs("div",{className:"mb-6 pb-6 border-b",children:[a.jsx("h3",{className:"font-semibold text-gray-700 mb-2",children:"Delivery Address"}),a.jsxs("p",{className:"text-gray-600",children:[(o=r.deliveryAddress)==null?void 0:o.fullName,a.jsx("br",{}),(l=r.deliveryAddress)==null?void 0:l.phone,a.jsx("br",{}),(c=r.deliveryAddress)==null?void 0:c.street,a.jsx("br",{}),(d=r.deliveryAddress)==null?void 0:d.city,", ",(f=r.deliveryAddress)==null?void 0:f.postalCode]})]}),a.jsxs("div",{className:"mb-6 pb-6 border-b",children:[a.jsx("h3",{className:"font-semibold text-gray-700 mb-3",children:"Order Items"}),a.jsx("div",{className:"space-y-3",children:(u=r.items)==null?void 0:u.map((B,L)=>a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-900",children:B.name}),a.jsxs("p",{className:"text-sm text-gray-500",children:["Qty: ",B.quantity]})]}),a.jsxs("p",{className:"font-semibold text-gray-900",children:["Â£",(B.price*B.quantity).toFixed(2)]})]},L))})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between text-gray-700",children:[a.jsx("span",{children:"Subtotal"}),a.jsxs("span",{children:["Â£",(p=(g=r.pricing)==null?void 0:g.subtotal)==null?void 0:p.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between text-gray-700",children:[a.jsx("span",{children:"Delivery Fee"}),a.jsxs("span",{children:["Â£",(j=(m=r.pricing)==null?void 0:m.deliveryFee)==null?void 0:j.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between text-xl font-bold text-gray-900 border-t pt-2",children:[a.jsx("span",{children:"Total"}),a.jsxs("span",{children:["Â£",(N=(v=r.pricing)==null?void 0:v.total)==null?void 0:N.toFixed(2)]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mb-6",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Order Status"}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-2xl",children:"ðŸ“¦"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-900 capitalize",children:(b=r.status)==null?void 0:b.replace("-"," ")}),a.jsx("p",{className:"text-sm text-gray-600",children:"Your order is being prepared"})]})]}),a.jsx(Ie,{to:`/track-order/${r._id}`,className:"mt-4 block w-full text-center bg-green-600 text-white py-3 rounded-lg font-semibold hover:bg-green-700 transition",children:"Track Your Order"})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mb-6",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Payment"}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-gray-700",children:((y=r.payment)==null?void 0:y.method)==="card"?"ðŸ’³ Card Payment":"ðŸ’µ Cash on Delivery"}),a.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-semibold ${((_=r.payment)==null?void 0:_.status)==="paid"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:(O=(T=r.payment)==null?void 0:T.status)==null?void 0:O.toUpperCase()})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsx(Ie,{to:"/stores",className:"bg-gray-200 text-gray-700 py-3 rounded-lg font-semibold text-center hover:bg-gray-300 transition",children:"Continue Shopping"}),a.jsx(Ie,{to:"/my-dashboard",className:"bg-green-600 text-white py-3 rounded-lg font-semibold text-center hover:bg-green-700 transition",children:"View All Orders"})]})]}),a.jsxs("div",{className:"max-w-2xl mx-auto mt-8 bg-blue-50 rounded-xl p-6",children:[a.jsx("h3",{className:"font-bold text-gray-900 mb-3",children:"What happens next?"}),a.jsxs("ul",{className:"space-y-2 text-sm text-gray-700",children:[a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx("span",{children:"1ï¸âƒ£"}),a.jsx("span",{children:"Your order will be picked and packed by our team"})]}),a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx("span",{children:"2ï¸âƒ£"}),a.jsx("span",{children:"A rider will be assigned to deliver your order"})]}),a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx("span",{children:"3ï¸âƒ£"}),a.jsx("span",{children:"You'll receive real-time updates on delivery status"})]}),a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx("span",{children:"4ï¸âƒ£"}),a.jsx("span",{children:"Estimated delivery time: 20-40 minutes"})]})]})]})]})]}):a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-2xl mb-4",children:"ðŸ˜”"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Order not found"}),a.jsx(Ie,{to:"/stores",className:"text-green-600 hover:underline",children:"Continue Shopping"})]})})}const A3="https://afrimercato-backend-production-0329.up.railway.app";function k3(){var f,u,g,p,m,j,v,N,b,y;const{orderId:e}=J0(),[r,t]=ge.useState(null),[n,s]=ge.useState(null),[o,l]=ge.useState(!0);ge.useEffect(()=>{const _=async()=>{try{const B=await(await fetch(`${A3}/api/orders/${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("afrimercato_token")}`}})).json();B.success&&t(B.data)}catch(O){console.error("Error fetching order:",O)}finally{l(!1)}};_();const T=setInterval(_,1e4);return()=>clearInterval(T)},[e]);const c=_=>({pending:1,confirmed:2,picking:3,ready_for_pickup:4,"out-for-delivery":5,delivered:6})[_]||1;if(o)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-4 border-b-4 border-green-600 mx-auto"}),a.jsx("p",{className:"text-gray-600 mt-4",children:"Loading tracking info..."})]})});if(!r)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-2xl mb-4",children:"ðŸ˜”"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Order not found"}),a.jsx(Ie,{to:"/stores",className:"text-green-600 hover:underline",children:"Continue Shopping"})]})});const d=c(r.status);return a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("header",{className:"bg-white border-b shadow-sm",children:a.jsx("div",{className:"container mx-auto px-6 py-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-2xl",children:"ðŸ›’"}),a.jsx("span",{className:"text-xl font-bold text-gray-900",children:"Afrimercato"})]}),a.jsx(Ie,{to:"/my-dashboard",className:"text-gray-600 hover:text-gray-900",children:"My Orders"})]})})}),a.jsx("div",{className:"container mx-auto px-6 py-8",children:a.jsxs("div",{className:"max-w-4xl mx-auto",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mb-6",children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-1",children:"Track Your Order"}),a.jsxs("p",{className:"text-gray-600",children:["Order #",r.orderNumber]})]}),a.jsx("div",{className:`px-4 py-2 rounded-full text-sm font-semibold ${r.status==="delivered"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:(f=r.status)==null?void 0:f.replace("-"," ").toUpperCase()})]}),r.status!=="delivered"&&a.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:"text-3xl",children:"ðŸšš"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-900",children:"Estimated Delivery Time"}),a.jsx("p",{className:"text-sm text-gray-600",children:"20-40 minutes from now"})]})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mb-6",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Order Progress"}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${d>=1?"bg-green-600 text-white":"bg-gray-200 text-gray-500"}`,children:d>1?"âœ“":"1"}),d>1&&a.jsx("div",{className:"w-1 h-16 bg-green-600 mt-2"}),d===1&&a.jsx("div",{className:"w-1 h-16 bg-gray-200 mt-2"})]}),a.jsxs("div",{className:"flex-1 pb-6",children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:"Order Placed"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Your order has been received"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(r.createdAt).toLocaleString()})]})]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${d>=2?"bg-green-600 text-white":"bg-gray-200 text-gray-500"}`,children:d>2?"âœ“":"2"}),d>2&&a.jsx("div",{className:"w-1 h-16 bg-green-600 mt-2"}),d<=2&&a.jsx("div",{className:"w-1 h-16 bg-gray-200 mt-2"})]}),a.jsxs("div",{className:"flex-1 pb-6",children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:"Order Confirmed"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Store is preparing your order"})]})]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${d>=3?"bg-green-600 text-white":"bg-gray-200 text-gray-500"}`,children:d>3?"âœ“":"3"}),d>3&&a.jsx("div",{className:"w-1 h-16 bg-green-600 mt-2"}),d<=3&&a.jsx("div",{className:"w-1 h-16 bg-gray-200 mt-2"})]}),a.jsxs("div",{className:"flex-1 pb-6",children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:"Picking Items"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Items are being picked from shelves"})]})]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${d>=4?"bg-green-600 text-white":"bg-gray-200 text-gray-500"}`,children:d>4?"âœ“":"4"}),d>4&&a.jsx("div",{className:"w-1 h-16 bg-green-600 mt-2"}),d<=4&&a.jsx("div",{className:"w-1 h-16 bg-gray-200 mt-2"})]}),a.jsxs("div",{className:"flex-1 pb-6",children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:"Ready for Pickup"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Packed and waiting for rider"})]})]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${d>=5?"bg-green-600 text-white":"bg-gray-200 text-gray-500"}`,children:d>5?"âœ“":"5"}),d>5&&a.jsx("div",{className:"w-1 h-16 bg-green-600 mt-2"}),d<=5&&a.jsx("div",{className:"w-1 h-16 bg-gray-200 mt-2"})]}),a.jsxs("div",{className:"flex-1 pb-6",children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:"Out for Delivery"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Rider is on the way"}),n&&a.jsx("div",{className:"mt-2 bg-blue-50 rounded p-2",children:a.jsx("p",{className:"text-xs text-blue-700",children:"ðŸ“ Rider location updating in real-time"})})]})]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsx("div",{className:"flex flex-col items-center",children:a.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${d>=6?"bg-green-600 text-white":"bg-gray-200 text-gray-500"}`,children:d>=6?"âœ“":"6"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:"Delivered"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Order delivered successfully"})]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mb-6",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Order Items"}),a.jsx("div",{className:"space-y-3",children:(u=r.items)==null?void 0:u.map((_,T)=>a.jsxs("div",{className:"flex justify-between items-center pb-3 border-b last:border-b-0",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-900",children:_.name}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Quantity: ",_.quantity]})]}),a.jsxs("p",{className:"font-semibold text-gray-900",children:["Â£",(_.price*_.quantity).toFixed(2)]})]},T))}),a.jsxs("div",{className:"flex justify-between text-xl font-bold text-gray-900 border-t mt-4 pt-4",children:[a.jsx("span",{children:"Total"}),a.jsxs("span",{children:["Â£",(p=(g=r.pricing)==null?void 0:g.total)==null?void 0:p.toFixed(2)]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mb-6",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Delivery Address"}),a.jsxs("p",{className:"text-gray-700",children:[(m=r.deliveryAddress)==null?void 0:m.fullName,a.jsx("br",{}),(j=r.deliveryAddress)==null?void 0:j.phone,a.jsx("br",{}),(v=r.deliveryAddress)==null?void 0:v.street,a.jsx("br",{}),(N=r.deliveryAddress)==null?void 0:N.city,", ",(b=r.deliveryAddress)==null?void 0:b.postalCode]}),((y=r.deliveryAddress)==null?void 0:y.instructions)&&a.jsx("div",{className:"mt-3 bg-yellow-50 rounded p-3",children:a.jsxs("p",{className:"text-sm text-gray-700",children:[a.jsx("strong",{children:"Instructions:"})," ",r.deliveryAddress.instructions]})})]}),r.status==="delivered"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Rate Your Experience"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"How was your delivery experience?"}),a.jsx("button",{className:"w-full bg-green-600 text-white py-3 rounded-lg font-semibold hover:bg-green-700 transition",children:"Leave a Review"})]})]})})]})}function T3(){const[e,r]=ge.useState(!1),[t,n]=ge.useState([]),[s,o]=ge.useState(0),[l,c]=ge.useState(!1),d=ge.useRef(null);ge.useEffect(()=>{f();const v=setInterval(()=>{f()},3e4);return()=>clearInterval(v)},[]),ge.useEffect(()=>{e&&u()},[e]),ge.useEffect(()=>{const v=N=>{d.current&&!d.current.contains(N.target)&&r(!1)};return document.addEventListener("mousedown",v),()=>document.removeEventListener("mousedown",v)},[]);const f=async()=>{try{const v=await Dl.getUnreadCount();v.success&&o(v.data.count)}catch(v){console.error("Error fetching unread count:",v)}},u=async()=>{try{c(!0);const v=await Dl.getNotifications({limit:10});v.success&&n(v.data.notifications)}catch(v){console.error("Error fetching notifications:",v)}finally{c(!1)}},g=async v=>{try{v.isRead||(await Dl.markAsRead(v._id),o(N=>Math.max(0,N-1)),n(N=>N.map(b=>b._id===v._id?{...b,isRead:!0}:b))),v.actionUrl&&(window.location.href=v.actionUrl)}catch(N){console.error("Error marking notification as read:",N)}},p=async()=>{try{await Dl.markAllAsRead(),o(0),n(v=>v.map(N=>({...N,isRead:!0})))}catch(v){console.error("Error marking all as read:",v)}},m=v=>({order_placed:"ðŸ›’",order_confirmed:"âœ…",order_shipped:"ðŸ“¦",order_delivered:"ðŸŽ‰",order_cancelled:"âŒ",payment_received:"ðŸ’°",low_stock:"âš ï¸",product_review:"â­",rider_assigned:"ðŸš´",system_alert:"ðŸ””",promotion:"ðŸŽ"})[v]||"ðŸ””",j=v=>{const N={urgent:"text-red-600 bg-red-50",high:"text-orange-600 bg-orange-50",normal:"text-blue-600 bg-blue-50",low:"text-gray-600 bg-gray-50"};return N[v]||N.normal};return a.jsxs("div",{className:"relative",ref:d,children:[a.jsxs("button",{onClick:()=>r(!e),className:"relative p-2 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100 transition-colors",children:[a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),s>0&&a.jsx("span",{className:"absolute top-0 right-0 flex items-center justify-center h-5 w-5 text-xs font-bold text-white bg-red-500 rounded-full animate-pulse",children:s>9?"9+":s})]}),e&&a.jsxs("div",{className:"absolute right-0 mt-2 w-96 bg-white rounded-xl shadow-2xl border border-gray-200 z-50 transform transition-all duration-200 ease-out animate-slideDown",children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200",children:[a.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Notifications"}),s>0&&a.jsx("button",{onClick:p,className:"text-sm text-afri-green hover:text-afri-green-dark font-medium transition-colors",children:"Mark all read"})]}),a.jsx("div",{className:"max-h-96 overflow-y-auto",children:l?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-afri-green"})}):t.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"text-5xl mb-2",children:"ðŸ””"}),a.jsx("p",{className:"text-gray-500",children:"No notifications yet"})]}):a.jsx("div",{children:t.map(v=>a.jsxs("div",{onClick:()=>g(v),className:`px-4 py-3 border-b border-gray-100 cursor-pointer transition-colors ${v.isRead?"bg-white hover:bg-gray-50":"bg-blue-50 hover:bg-blue-100"}`,children:[a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx("div",{className:`flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center text-xl ${j(v.priority)}`,children:v.icon||m(v.type)}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate",children:v.title}),a.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 mt-1",children:v.message}),a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:v.timeAgo})]}),!v.isRead&&a.jsx("div",{className:"flex-shrink-0 w-2 h-2 bg-afri-green rounded-full"})]}),v.priority==="urgent"&&a.jsx("div",{className:"mt-2 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"ðŸš¨ Urgent"})]},v._id))})}),t.length>0&&a.jsx("div",{className:"px-4 py-3 border-t border-gray-200 bg-gray-50 rounded-b-xl",children:a.jsx("button",{onClick:()=>{r(!1),window.location.href="/notifications"},className:"w-full text-center text-sm text-afri-green hover:text-afri-green-dark font-medium transition-colors",children:"View all notifications"})})]})]})}function _i({children:e}){var u;const r=lm(),t=xn(),{user:n,logout:s}=Di(),[o,l]=ge.useState(!1),c=[{name:"Dashboard",path:"/dashboard",icon:"ðŸ“Š"},{name:"Products",path:"/products",icon:"ðŸ“¦"},{name:"Orders",path:"/orders",icon:"ðŸ›’"},{name:"Reports",path:"/reports",icon:"ðŸ“ˆ"},{name:"Subscription",path:"/subscription",icon:"ðŸ’³"},{name:"Settings",path:"/settings",icon:"âš™ï¸"}],d=()=>{s(),t("/login")},f=g=>r.pathname===g;return a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[o&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden",onClick:()=>l(!1)}),a.jsx("div",{className:`fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-xl transform transition-transform duration-300 ease-in-out lg:translate-x-0 ${o?"translate-x-0":"-translate-x-full"}`,children:a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"flex items-center justify-between h-16 px-6 bg-gradient-to-r from-afri-green to-afri-green-dark",children:[a.jsx(Ie,{to:"/dashboard",className:"flex items-center",children:a.jsx("span",{className:"text-2xl font-bold text-white",children:"Afrimercato"})}),a.jsx("button",{onClick:()=>l(!1),className:"lg:hidden text-white hover:text-afri-yellow",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:"w-10 h-10 rounded-full bg-afri-green text-white flex items-center justify-center font-bold",children:((u=n==null?void 0:n.name)==null?void 0:u.charAt(0).toUpperCase())||"V"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate",children:(n==null?void 0:n.name)||"Vendor"}),a.jsx("p",{className:"text-xs text-gray-500 truncate",children:(n==null?void 0:n.email)||""})]})]})}),a.jsx("nav",{className:"flex-1 px-4 py-4 space-y-1 overflow-y-auto",children:c.map(g=>a.jsxs(Ie,{to:g.path,className:`flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${f(g.path)?"bg-afri-green text-white":"text-gray-700 hover:bg-gray-100"}`,children:[a.jsx("span",{className:"text-xl",children:g.icon}),a.jsx("span",{className:"font-medium",children:g.name})]},g.name))}),a.jsx("div",{className:"p-4 border-t border-gray-200",children:a.jsxs("button",{onClick:d,className:"w-full flex items-center space-x-3 px-4 py-3 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[a.jsx("span",{className:"text-xl",children:"ðŸšª"}),a.jsx("span",{className:"font-medium",children:"Logout"})]})})]})}),a.jsxs("div",{className:"lg:ml-64",children:[a.jsx("div",{className:"sticky top-0 z-30 bg-white shadow-sm",children:a.jsxs("div",{className:"flex items-center justify-between h-16 px-4 sm:px-6 lg:px-8",children:[a.jsx("button",{onClick:()=>l(!0),className:"lg:hidden text-gray-500 hover:text-gray-700",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),a.jsx("div",{className:"flex-1 lg:flex-none"}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx(T3,{}),a.jsx("div",{className:"hidden lg:flex items-center space-x-2 text-sm",children:a.jsx("span",{className:"font-medium text-gray-700",children:n==null?void 0:n.name})})]})]})}),a.jsx("main",{className:"p-4 sm:p-6 lg:p-8",children:e})]})]})}function us(){const{user:e}=Di();switch((e==null?void 0:e.role)||(e==null?void 0:e.primaryRole)||"customer"){case"vendor":return a.jsx(hn,{to:"/dashboard",replace:!0});case"rider":return a.jsx(hn,{to:"/rider/dashboard",replace:!0});case"picker":return a.jsx(hn,{to:"/picker/dashboard",replace:!0});case"customer":default:return a.jsx(hn,{to:"/",replace:!0})}}function C3(){const{isAuthenticated:e,user:r,loading:t}=Di();return t?a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-afri-green to-afri-green-dark",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-white mx-auto"}),a.jsx("p",{className:"text-white mt-4 text-lg font-semibold",children:"Loading Afrimercato..."})]})}):a.jsxs(cm,{children:[a.jsx(Tr,{path:"/",element:a.jsx(t3,{})}),a.jsx(Tr,{path:"/old-home",element:a.jsx(Qw,{})})," ",a.jsx(Tr,{path:"/partner",element:a.jsx(u3,{})}),a.jsx(Tr,{path:"/stores",element:a.jsx(m3,{})}),a.jsx(Tr,{path:"/store/:vendorId",element:a.jsx(b3,{})}),a.jsx(Tr,{path:"/about",element:a.jsx(x3,{})}),a.jsx(Tr,{path:"/delivery",element:a.jsx(p3,{})}),a.jsx(Tr,{path:"/contact",element:a.jsx(g3,{})}),a.jsx(Tr,{path:"/my-dashboard",element:e?a.jsx(w3,{}):a.jsx(hn,{to:"/login"})}),a.jsx(Tr,{path:"/checkout",element:a.jsx(j3,{})}),a.jsx(Tr,{path:"/order-confirmation/:orderId",element:a.jsx(_3,{})}),a.jsx(Tr,{path:"/track-order/:orderId",element:a.jsx(k3,{})}),a.jsx(Tr,{path:"/login",element:e?a.jsx(us,{}):a.jsx(bx,{})}),a.jsx(Tr,{path:"/register",element:e?a.jsx(us,{}):a.jsx(jx,{})}),a.jsx(Tr,{path:"/dashboard",element:e?(r==null?void 0:r.role)==="vendor"?a.jsx(_i,{children:a.jsx(kx,{})}):a.jsx(us,{}):a.jsx(hn,{to:"/login"})}),a.jsx(Tr,{path:"/products",element:e?(r==null?void 0:r.role)==="vendor"?a.jsx(_i,{children:a.jsx(Px,{})}):a.jsx(us,{}):a.jsx(hn,{to:"/login"})}),a.jsx(Tr,{path:"/orders",element:e?(r==null?void 0:r.role)==="vendor"?a.jsx(_i,{children:a.jsx(zx,{})}):a.jsx(us,{}):a.jsx(hn,{to:"/login"})}),a.jsx(Tr,{path:"/reports",element:e?(r==null?void 0:r.role)==="vendor"?a.jsx(_i,{children:a.jsx(Rw,{})}):a.jsx(us,{}):a.jsx(hn,{to:"/login"})}),a.jsx(Tr,{path:"/subscription",element:e?(r==null?void 0:r.role)==="vendor"?a.jsx(_i,{children:a.jsx(qw,{})}):a.jsx(us,{}):a.jsx(hn,{to:"/login"})}),a.jsx(Tr,{path:"/settings",element:e?(r==null?void 0:r.role)==="vendor"?a.jsx(_i,{children:a.jsx(zw,{})}):a.jsx(us,{}):a.jsx(hn,{to:"/login"})})]})}function E3(){return a.jsx(yx,{children:a.jsx(C3,{})})}class L3 extends gf.Component{constructor(r){super(r),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0}}componentDidCatch(r,t){this.setState({error:r,errorInfo:t}),console.error("ErrorBoundary caught an error:",r,t)}render(){return this.state.hasError?a.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center px-4",children:a.jsxs("div",{className:"max-w-lg w-full bg-white rounded-lg shadow-xl p-8",children:[a.jsx("div",{className:"flex items-center justify-center w-16 h-16 bg-red-100 rounded-full mx-auto mb-4",children:a.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),a.jsx("h1",{className:"text-2xl font-bold text-center text-gray-900 mb-4",children:"Oops! Something went wrong"}),a.jsx("p",{className:"text-gray-600 text-center mb-6",children:"We're sorry for the inconvenience. Please try refreshing the page."}),a.jsxs("div",{className:"flex justify-center space-x-4",children:[a.jsx("button",{onClick:()=>window.location.reload(),className:"bg-green-600 text-white px-6 py-2 rounded-lg font-medium hover:bg-green-700",children:"Refresh Page"}),a.jsx("a",{href:"/",className:"bg-gray-200 text-gray-800 px-6 py-2 rounded-lg font-medium hover:bg-gray-300",children:"Go Home"})]}),!1]})}):this.props.children}}P0.createRoot(document.getElementById("root")).render(a.jsx(gf.StrictMode,{children:a.jsxs(dm,{children:["  ",a.jsx(L3,{children:a.jsx(E3,{})})]})}));
