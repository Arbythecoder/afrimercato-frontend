const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.es-CYUj7cQv.js","assets/vendor-BOvbtTVj.js","assets/date-CmiLJgMe.js"])))=>i.map(i=>d[i]);
import{j as a,_ as rr}from"./date-CmiLJgMe.js";import{a as cm,r as ue,u as pa,L as ft,b as dm,c as c0,d as fm,e as Z0,f as hm,h as um,i as Vr,N as fa,R as wh,H as mm}from"./vendor-BOvbtTVj.js";import{m as nt,A as Zl}from"./ui-B-S5vQyI.js";import{R as d0,L as pm,C as tf,X as rf,Y as nf,T as f0,a as af,b as xm,B as gm,c as vm,P as ym,d as bm,e as wm}from"./charts-C7uDCmWg.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();var O0={},sf=cm;O0.createRoot=sf.createRoot,O0.hydrateRoot=sf.hydrateRoot;const Q0="https://afrimercato-backend-production-0329.up.railway.app";console.log("ðŸ”— API Base URL:",Q0);let Il=!1,I0=[];const of=(e,r=null)=>{I0.forEach(t=>{e?t.reject(e):t.resolve(r)}),I0=[]},Nm=async()=>{var r;const e=localStorage.getItem("afrimercato_refresh_token");if(!e)throw new Error("No refresh token available");try{const t=await fetch(`${Q0}/api/auth/refresh-token`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:e})});if(!t.ok)throw new Error("Failed to refresh token");const n=await t.json();if(n.success&&((r=n.data)!=null&&r.token))return localStorage.setItem("afrimercato_token",n.data.token),n.data.token;throw new Error("Invalid refresh response")}catch(t){throw localStorage.removeItem("afrimercato_token"),localStorage.removeItem("afrimercato_refresh_token"),t}},gt=async(e,r={},t=!1)=>{try{const n=`${Q0}/api${e}`,s={headers:{...r.headers},credentials:"include",...r};r.body instanceof FormData||(s.headers["Content-Type"]="application/json");const o=localStorage.getItem("afrimercato_token");o&&(s.headers.Authorization=`Bearer ${o}`),console.log("ðŸŒ Fetching:",n);const l=await fetch(n,s);if(!l.ok){const d=await l.json().catch(()=>({}));if(l.status===401&&!t&&(d.errorCode==="TOKEN_EXPIRED"||d.errorCode==="INVALID_TOKEN")){if(Il)return new Promise((h,u)=>{I0.push({resolve:h,reject:u})}).then(h=>gt(e,r,!0)).catch(h=>{throw h});Il=!0;try{const h=await Nm();return of(null,h),Il=!1,gt(e,r,!0)}catch(h){throw of(h,null),Il=!1,window.location.href="/login",new Error("Session expired. Please log in again.")}}throw l.status===401?(localStorage.removeItem("afrimercato_token"),localStorage.removeItem("afrimercato_refresh_token"),new Error("Session expired. Please log in again.")):new Error(d.message||`HTTP error! status: ${l.status}`)}return await l.json()}catch(n){throw console.error(`âŒ API Error (${e}):`,n),n}},jm=async e=>{var t;const r=await gt("/auth/login",{method:"POST",body:JSON.stringify(e)});return r.success&&((t=r.data)!=null&&t.token)&&(localStorage.setItem("afrimercato_token",r.data.token),r.data.refreshToken&&localStorage.setItem("afrimercato_refresh_token",r.data.refreshToken)),r},Sm=async e=>{var t;const r=await gt("/auth/register",{method:"POST",body:JSON.stringify(e)});return r.success&&((t=r.data)!=null&&t.token)&&(localStorage.setItem("afrimercato_token",r.data.token),r.data.refreshToken&&localStorage.setItem("afrimercato_refresh_token",r.data.refreshToken)),r},_m=async()=>{try{await gt("/auth/logout",{method:"POST"})}finally{localStorage.removeItem("afrimercato_token"),localStorage.removeItem("afrimercato_refresh_token"),window.location.href="/login"}},Am=async()=>gt("/auth/refresh",{method:"POST"}),km=async()=>gt("/vendor/profile"),Tm=async e=>gt("/vendor/profile",{method:"PUT",body:JSON.stringify(e)}),Nh=async e=>gt("/vendor/profile",{method:"POST",body:JSON.stringify(e)}),Cm=async(e={})=>{const r=new URLSearchParams(e).toString();return gt(`/vendor/products?${r}`)},Em=async e=>gt("/vendor/products",{method:"POST",body:JSON.stringify(e)}),Fm=async(e,r)=>gt(`/vendor/products/${e}`,{method:"PUT",body:JSON.stringify(r)}),Lm=async e=>gt(`/vendor/products/${e}`,{method:"DELETE"}),Pm=async(e={})=>{const r=new URLSearchParams(e).toString();return gt(`/vendor/orders?${r}`)},Om=async e=>gt(`/vendor/orders/${e}`),Im=async(e,r)=>gt(`/vendor/orders/${e}/status`,{method:"PUT",body:JSON.stringify(r)}),Dm=async(e,r)=>gt(`/vendor/orders/${e}/rate-rider`,{method:"POST",body:JSON.stringify(r)}),Rm=async()=>gt("/vendor/dashboard/stats"),Mm=async(e="7d")=>gt(`/vendor/dashboard/chart-data?timeRange=${e}`),Bm=async(e={})=>{const r=new URLSearchParams(e).toString();return gt(`/vendor/reports/sales?${r}`)},Um=async()=>gt("/vendor/reports/inventory"),Hm=async(e={})=>{const r=new URLSearchParams(e).toString();return gt(`/vendor/reports/orders?${r}`)},Wm=async(e={})=>{const r=new URLSearchParams(e).toString();return gt(`/vendor/reports/revenue?${r}`)},zm=async()=>gt("/subscription/plans"),qm=async e=>gt("/subscription/subscribe",{method:"POST",body:JSON.stringify(e)}),Vm=async()=>gt("/subscription/my-subscription"),Gm=async()=>gt("/subscription/cancel",{method:"POST"}),$m=async(e,r=50)=>{const t=new URLSearchParams({location:e,radius:r});return gt(`/location/search-vendors?${t}`)},Ym=async e=>gt(`/location/vendor/${e}`),Xm=async e=>gt(`/products/vendor/${e}`),Km=async()=>gt("/users/profile"),Jm=async e=>gt("/users/profile",{method:"PATCH",body:JSON.stringify(e)}),Zm=async e=>gt("/users/change-password",{method:"PATCH",body:JSON.stringify(e)}),Qm=async e=>{const r=new FormData;e.forEach(n=>{r.append("productImages",n)});const t=localStorage.getItem("afrimercato_token");return gt("/vendor/upload/images",{method:"POST",headers:{...t&&{Authorization:`Bearer ${t}`}},body:r})},ep=async e=>gt("/vendor/products/bulk-delete",{method:"POST",body:JSON.stringify(e)}),tp=async e=>gt("/vendor/products/bulk-status",{method:"POST",body:JSON.stringify(e)}),rp=async e=>gt("/vendor/products/bulk-price",{method:"POST",body:JSON.stringify(e)}),np=async e=>gt("/vendor/products/bulk-stock",{method:"POST",body:JSON.stringify(e)}),ap=()=>!!localStorage.getItem("afrimercato_token"),sp=()=>localStorage.getItem("afrimercato_token"),ip=e=>{localStorage.setItem("afrimercato_token",e)},op=()=>{localStorage.removeItem("afrimercato_token"),localStorage.removeItem("afrimercato_refresh_token")},lf={login:jm,register:Sm,logout:_m,refreshToken:Am,isAuthenticated:ap,getAuthToken:sp,setAuthToken:ip,clearAuthToken:op},lp=async()=>gt("/vendor/delivery-settings"),cp=async e=>gt("/vendor/delivery-settings",{method:"PUT",body:JSON.stringify(e)}),pr={getProfile:km,updateProfile:Tm,createProfile:Nh,getProducts:Cm,createProduct:Em,updateProduct:Fm,deleteProduct:Lm,getOrders:Pm,getOrder:Om,updateOrderStatus:Im,rateRider:Dm,getDashboardStats:Rm,getChartData:Mm,getSalesReport:Bm,getInventoryReport:Um,getOrdersReport:Hm,getRevenueReport:Wm,uploadProductImages:Qm,bulkDeleteProducts:ep,bulkUpdateStatus:tp,bulkUpdatePrices:rp,bulkUpdateStock:np,getDeliverySettings:lp,updateDeliverySettings:cp},dp=async()=>gt("/customers/dashboard/stats"),fp=async(e={})=>{const r=new URLSearchParams(e).toString();return gt(`/customers/orders/recent?${r}`)},hp=async(e={})=>{const r=new URLSearchParams(e).toString();return gt(`/customers/products/recommended?${r}`)},up=async()=>gt("/customers/wishlist"),mp=async e=>gt("/customers/wishlist",{method:"POST",body:JSON.stringify({productId:e})}),pp=async e=>gt(`/customers/wishlist/${e}`,{method:"DELETE"}),h0={getDashboardStats:dp,getRecentOrders:fp,getRecommendedProducts:hp,getWishlist:up,addToWishlist:mp,removeFromWishlist:pp},u0={getProfile:Km,updateProfile:Jm,changePassword:Zm},Dl={getPlans:zm,subscribe:qm,getMySubscription:Vm,cancel:Gm},xp=async(e={})=>{const r=new URLSearchParams(e).toString();return gt(`/notifications?${r}`)},gp=async()=>gt("/notifications/unread-count"),vp=async e=>gt(`/notifications/${e}/read`,{method:"PUT"}),yp=async()=>gt("/notifications/mark-all-read",{method:"PUT"}),bp=async e=>gt(`/notifications/${e}`,{method:"DELETE"}),wp=async()=>gt("/notifications",{method:"DELETE"}),Rl={getNotifications:xp,getUnreadCount:gp,markAsRead:vp,markAllAsRead:yp,deleteNotification:bp,deleteAllRead:wp},jh=ue.createContext(),Ri=()=>{const e=ue.useContext(jh);if(!e)throw new Error("useAuth must be used within AuthProvider");return e},Np=({children:e})=>{const[r,t]=ue.useState(null),[n,s]=ue.useState(!0),[o,l]=ue.useState(!1);ue.useEffect(()=>{c()},[]);const c=async()=>{const x=localStorage.getItem("afrimercato_token"),m=localStorage.getItem("afrimercato_user");if(x&&(l(!0),m))try{t(JSON.parse(m))}catch(y){console.error("Error parsing user data:",y)}s(!1)},g={user:r,isAuthenticated:o,loading:n,login:async(x,m)=>{try{const y=await lf.login({email:x,password:m});if(y.success){const{token:v,user:j}=y.data;return localStorage.setItem("afrimercato_token",v),localStorage.setItem("afrimercato_user",JSON.stringify(j)),t(j),l(!0),{success:!0,user:j}}}catch(y){return{success:!1,message:y.message||"Login failed"}}},register:async x=>{try{const m=await lf.register(x);if(m.success){const{token:y,user:v}=m.data;return localStorage.setItem("afrimercato_token",y),localStorage.setItem("afrimercato_user",JSON.stringify(v)),t(v),l(!0),{success:!0,user:v}}}catch(m){return{success:!1,message:m.message||"Registration failed"}}},logout:()=>{localStorage.removeItem("afrimercato_token"),localStorage.removeItem("afrimercato_user"),t(null),l(!1)},checkAuth:c};return a.jsx(jh.Provider,{value:g,children:e})};function jp(){const e=pa(),{login:r}=Ri(),[t,n]=ue.useState({email:"",password:""}),[s,o]=ue.useState(""),[l,c]=ue.useState(!1),[d,h]=ue.useState(!1),u=x=>{n({...t,[x.target.name]:x.target.value}),o("")},g=async x=>{var y,v;x.preventDefault(),o(""),c(!0);const m=await r(t.email,t.password);if(m.success)switch(((y=m.user)==null?void 0:y.role)||((v=m.user)==null?void 0:v.primaryRole)||"customer"){case"vendor":e("/dashboard");break;case"rider":e("/rider/dashboard");break;case"picker":e("/picker/dashboard");break;case"customer":default:e("/");break}else o(m.message||"Login failed. Please try again.");c(!1)};return a.jsxs("div",{className:"min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8 overflow-hidden relative bg-gradient-to-br from-afri-green to-afri-green-dark",style:{backgroundSize:"400% 400%",animation:"gradient 15s ease infinite"},children:[a.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:a.jsx("div",{className:"absolute inset-0",style:{background:"radial-gradient(circle at center, rgba(255,255,255,0.1) 0%, transparent 60%)",animation:"pulse 4s ease-in-out infinite"}})}),a.jsxs(nt.div,{className:"max-w-md w-full relative",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[a.jsxs(nt.div,{className:"text-center mb-8",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5},children:[a.jsx(nt.h1,{className:"text-5xl font-bold text-white mb-2",initial:{y:-20},animate:{y:0},transition:{type:"spring",stiffness:300,damping:20},children:"Afrimercato"}),a.jsx(nt.p,{className:"text-afri-yellow text-lg",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:"Fresh African Groceries"})]}),a.jsxs(nt.div,{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl p-8",initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.4,delay:.3},children:[a.jsx(nt.h2,{className:"text-3xl font-bold text-gray-900 mb-2",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{duration:.4,delay:.4},children:"Welcome Back"}),a.jsx(nt.p,{className:"text-gray-600 mb-6",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{duration:.4,delay:.5},children:"Sign in to your account"}),s&&a.jsx(nt.div,{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-6 rounded",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3},children:a.jsx("p",{className:"text-red-700 text-sm",children:s})}),a.jsxs("form",{onSubmit:g,className:"space-y-6",children:[a.jsxs(nt.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.6},children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),a.jsx(nt.input,{whileFocus:{scale:1.01},transition:{type:"spring",stiffness:300,damping:20},id:"email",name:"email",type:"email",required:!0,value:t.email,onChange:u,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"vendor@example.com"})]}),a.jsxs(nt.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.7},children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx(nt.input,{whileFocus:{scale:1.01},transition:{type:"spring",stiffness:300,damping:20},id:"password",name:"password",type:d?"text":"password",required:!0,value:t.password,onChange:u,className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"}),a.jsx("button",{type:"button",onClick:()=>h(!d),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700 focus:outline-none",children:d?a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):a.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),a.jsxs(nt.div,{className:"flex items-center justify-between",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.8},children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(nt.input,{whileHover:{scale:1.1},transition:{type:"spring",stiffness:400,damping:10},id:"remember",name:"remember",type:"checkbox",className:"h-4 w-4 text-afri-green focus:ring-afri-green border-gray-300 rounded"}),a.jsx("label",{htmlFor:"remember",className:"ml-2 block text-sm text-gray-700",children:"Remember me"})]}),a.jsx(nt.div,{whileHover:{scale:1.05},children:a.jsx(ft,{to:"/forgot-password",className:"text-sm text-afri-green hover:text-afri-green-dark font-medium",children:"Forgot password?"})})]}),a.jsx(nt.button,{type:"submit",disabled:l,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-white bg-gradient-to-r from-afri-green to-afri-green-dark hover:from-afri-green-dark hover:to-afri-green focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-afri-green font-semibold text-lg transition disabled:opacity-50 disabled:cursor-not-allowed",whileHover:{scale:1.02},whileTap:{scale:.98},initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.9},children:l?a.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):"Sign In"})]}),a.jsxs(nt.div,{className:"mt-6",initial:{opacity:0},animate:{opacity:1},transition:{delay:1},children:[a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-0 flex items-center",children:a.jsx("div",{className:"w-full border-t border-gray-300"})}),a.jsx("div",{className:"relative flex justify-center text-sm",children:a.jsx("span",{className:"px-4 bg-white text-gray-500",children:"New to Afrimercato?"})})]}),a.jsx(nt.div,{className:"mt-6 text-center",whileHover:{scale:1.05},children:a.jsxs(ft,{to:"/register",className:"text-afri-green hover:text-afri-green-dark font-semibold text-base inline-flex items-center",children:["Create an account",a.jsx(nt.span,{animate:{x:[0,5,0]},transition:{repeat:1/0,duration:1.5},className:"ml-2",children:"â†’"})]})})]})]}),a.jsx(nt.p,{className:"mt-8 text-center text-sm text-white",initial:{opacity:0},animate:{opacity:1},transition:{delay:1.1},children:"Â© 2025 Afrimercato. Fresh African Groceries Delivered."})]}),a.jsx("style",{jsx:!0,children:`
        @keyframes gradient {
          0% { background-position: 0% 50% }
          50% { background-position: 100% 50% }
          100% { background-position: 0% 50% }
        }
        @keyframes pulse {
          0% { opacity: 0.4 }
          50% { opacity: 0.6 }
          100% { opacity: 0.4 }
        }
      `})]})}const m0={vegetables:"https://images.unsplash.com/photo-1598170845058-32b9d6a5da37?w=800&q=80",fruits:"https://images.unsplash.com/photo-1619566636858-adf3ef46400b?w=800&q=80","meat-fish":"https://images.unsplash.com/photo-1546964053-d018e345e490?w=800&q=80",dairy:"https://images.unsplash.com/photo-1563636619-e9143da7973b?w=800&q=80",grains:"https://images.unsplash.com/photo-1596797882870-8c33deeac224?w=800&q=80",beverages:"https://images.unsplash.com/photo-1598614187854-26a60e982dc4?w=800&q=80",spices:"https://images.unsplash.com/photo-1596040033229-a0b3b46fe6b6?w=800&q=80","fresh-produce":"https://images.unsplash.com/photo-1610832958506-aa56368176cf?w=800&q=80",bakery:"https://images.unsplash.com/photo-1509440159596-0249088772ff?w=800&q=80",snacks:"https://images.unsplash.com/photo-1599490659213-e2b9527bd087?w=800&q=80",groceries:"https://images.unsplash.com/photo-1542838132-92c53300491e?w=800&q=80",household:"https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?w=800&q=80","beauty-health":"https://images.unsplash.com/photo-1596462502278-27bfdc403348?w=800&q=80",default:"https://images.unsplash.com/photo-1604719312566-8912e9227c6a?w=800&q=80"},p0={default:"https://images.unsplash.com/photo-1578916171728-46686eac8d58?w=800&q=80",market:"https://images.unsplash.com/photo-1488459716781-31db52582fe9?w=800&q=80",grocery:"https://images.unsplash.com/photo-1534723328310-e82dad3ee43f?w=800&q=80"},Ml={hero1:"https://images.unsplash.com/photo-1578916171728-46686eac8d58?w=1600&q=80",hero2:"https://images.unsplash.com/photo-1573496359142-b8d87734a5a2?w=1600&q=80",store1:"https://images.unsplash.com/photo-1604719312566-8912e9227c6a?w=1600&q=80",store2:"https://images.unsplash.com/photo-1534723328310-e82dad3ee43f?w=1600&q=80"},Sp=e=>{if(!e)return m0.default;const r=e.toLowerCase().replace(/\s+/g,"-");return m0[r]||m0.default},_p=e=>{if(!e)return p0.default;const r=e.toLowerCase();return p0[r]||p0.default},ed=e=>{var r;if(e!=null&&e.images&&e.images.length>0){const t=e.images.find(n=>n.isPrimary);if(t!=null&&t.url)return t.url;if((r=e.images[0])!=null&&r.url)return e.images[0].url}return Sp(e==null?void 0:e.category)},Ap=e=>{var r,t;return(r=e==null?void 0:e.banner)!=null&&r.url?e.banner.url:(t=e==null?void 0:e.logo)!=null&&t.url?e.logo.url:_p((e==null?void 0:e.businessType)||(e==null?void 0:e.category))};function kp(){const e=pa(),{register:r}=Ri(),[t,n]=ue.useState({name:"",email:"",password:"",confirmPassword:"",role:"customer"}),[s,o]=ue.useState(""),[l,c]=ue.useState(!1),[d,h]=ue.useState(!1),[u,g]=ue.useState(!1),x=N=>{n({...t,[N.target.name]:N.target.value}),o("")},m=async N=>{if(N.preventDefault(),o(""),t.password!==t.confirmPassword){o("Passwords do not match");return}if(t.password.length<6){o("Password must be at least 6 characters");return}c(!0);const _=await r(t);if(_.success)switch(t.role){case"vendor":e("/dashboard");break;case"rider":e("/rider/dashboard");break;case"picker":e("/picker/dashboard");break;case"customer":default:e("/");break}else o(_.message);c(!1)},y={hidden:{opacity:0},visible:{opacity:1,transition:{delayChildren:.1,staggerChildren:.1}}},v={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",stiffness:100}}},w=(()=>{switch(t.role){case"vendor":return{title:"Start Selling Today",subtitle:"Join thousands of vendors on Afrimercato",benefit1:"ðŸ“Š Real-time sales analytics",benefit2:"ðŸš€ Instant order notifications",benefit3:"ðŸ’° Low commission rates",image:Ml.store1};case"rider":return{title:"Become a Delivery Partner",subtitle:"Deliver groceries and earn on your schedule",benefit1:"â° Flexible working hours",benefit2:"ðŸ’µ Competitive earnings",benefit3:"ðŸ“± Easy-to-use rider app",image:Ml.hero2};case"picker":return{title:"Join Our Fulfillment Team",subtitle:"Help fulfill orders from local stores",benefit1:"ðŸª Work with top vendors",benefit2:"ðŸ“¦ Simple picking process",benefit3:"ðŸ’ª Great team environment",image:Ml.store2};default:return{title:"Join Our Community",subtitle:"Start shopping for fresh African groceries",benefit1:"ðŸ¥¬ Fresh produce daily",benefit2:"ðŸšš Fast delivery",benefit3:"ðŸŽ Exclusive deals",image:Ml.hero1}}})();return a.jsxs("div",{className:"min-h-screen flex bg-gray-50",children:[a.jsxs(nt.div,{initial:{x:-50,opacity:0},animate:{x:0,opacity:1},transition:{duration:.6},className:"hidden lg:flex lg:w-1/2 bg-gradient-to-br from-afri-green via-afri-green-dark to-green-900 p-12 flex-col justify-between relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 opacity-10",children:a.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 2px 2px, white 1px, transparent 0)",backgroundSize:"40px 40px"}})}),a.jsxs("div",{className:"relative z-10",children:[a.jsxs(nt.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.6},children:[a.jsx("h1",{className:"text-6xl font-bold text-white mb-2",children:"Afrimercato"}),a.jsx("p",{className:"text-afri-yellow text-xl font-semibold",children:w.title})]}),a.jsxs(nt.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4,duration:.6},className:"mt-12 space-y-6",children:[a.jsxs("div",{className:"flex items-start space-x-4",children:[a.jsx("div",{className:"bg-white/20 rounded-lg p-3 backdrop-blur-sm",children:a.jsx("svg",{className:"w-6 h-6 text-afri-yellow",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),a.jsx("div",{children:a.jsx("p",{className:"text-white text-lg font-medium",children:w.benefit1})})]}),a.jsxs("div",{className:"flex items-start space-x-4",children:[a.jsx("div",{className:"bg-white/20 rounded-lg p-3 backdrop-blur-sm",children:a.jsx("svg",{className:"w-6 h-6 text-afri-yellow",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),a.jsx("div",{children:a.jsx("p",{className:"text-white text-lg font-medium",children:w.benefit2})})]}),a.jsxs("div",{className:"flex items-start space-x-4",children:[a.jsx("div",{className:"bg-white/20 rounded-lg p-3 backdrop-blur-sm",children:a.jsx("svg",{className:"w-6 h-6 text-afri-yellow",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),a.jsx("div",{children:a.jsx("p",{className:"text-white text-lg font-medium",children:w.benefit3})})]})]})]}),a.jsx(nt.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.6,duration:.6},className:"relative z-10",children:a.jsx("img",{src:w.image,alt:w.title,className:"rounded-2xl shadow-2xl w-full h-64 object-cover border-4 border-white/20"})}),a.jsx(nt.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},className:"relative z-10 text-white/70 text-sm",children:"Â© 2025 Afrimercato. Fresh African Groceries Delivered."})]}),a.jsx("div",{className:"w-full lg:w-1/2 flex items-center justify-center p-8",children:a.jsxs(nt.div,{variants:y,initial:"hidden",animate:"visible",className:"w-full max-w-md",children:[a.jsxs(nt.div,{variants:v,className:"lg:hidden text-center mb-8",children:[a.jsx("h1",{className:"text-4xl font-bold text-afri-green mb-2",children:"Afrimercato"}),a.jsx("p",{className:"text-gray-600",children:w.title})]}),a.jsxs(nt.div,{variants:v,className:"bg-white rounded-2xl shadow-xl p-8 border border-gray-100",children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Create Account"}),a.jsxs("p",{className:"text-gray-600 mb-6",children:[t.role==="vendor"&&"Join thousands of vendors on Afrimercato",t.role==="customer"&&"Start shopping for fresh African groceries",t.role==="rider"&&"Deliver groceries and earn on your schedule",t.role==="picker"&&"Help fulfill orders from local stores"]}),s&&a.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-6 rounded",children:a.jsx("p",{className:"text-red-700 text-sm",children:s})}),a.jsxs("form",{onSubmit:m,className:"space-y-5",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 mb-2",children:"I want to register as"}),a.jsxs("select",{id:"role",name:"role",required:!0,value:t.role,onChange:x,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition bg-white",children:[a.jsx("option",{value:"customer",children:"Customer - Shop for groceries"}),a.jsx("option",{value:"vendor",children:"Vendor - Sell products"}),a.jsx("option",{value:"rider",children:"Rider - Deliver orders"}),a.jsx("option",{value:"picker",children:"Picker - Fulfill orders"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name"}),a.jsx("input",{id:"name",name:"name",type:"text",required:!0,value:t.name,onChange:x,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"John Doe"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),a.jsx("input",{id:"email",name:"email",type:"email",required:!0,value:t.email,onChange:x,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"vendor@example.com"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{id:"password",name:"password",type:d?"text":"password",required:!0,value:t.password,onChange:x,className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"}),a.jsx("button",{type:"button",onClick:()=>h(!d),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700 focus:outline-none",children:d?a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.542 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):a.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"At least 6 characters"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:u?"text":"password",required:!0,value:t.confirmPassword,onChange:x,className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"}),a.jsx("button",{type:"button",onClick:()=>g(!u),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700 focus:outline-none",children:u?a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.542 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):a.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("input",{id:"terms",name:"terms",type:"checkbox",required:!0,className:"h-4 w-4 mt-1 text-afri-green focus:ring-afri-green border-gray-300 rounded"}),a.jsxs("label",{htmlFor:"terms",className:"ml-2 block text-sm text-gray-700",children:["I agree to the"," ",a.jsx(ft,{to:"/terms",className:"text-afri-green hover:text-afri-green-dark font-medium",children:"Terms of Service"})," ","and"," ",a.jsx(ft,{to:"/privacy",className:"text-afri-green hover:text-afri-green-dark font-medium",children:"Privacy Policy"})]})]}),a.jsx("button",{type:"submit",disabled:l,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-white bg-gradient-to-r from-afri-green to-afri-green-dark hover:from-afri-green-dark hover:to-afri-green focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-afri-green font-semibold text-lg transition disabled:opacity-50 disabled:cursor-not-allowed",children:l?a.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):"Create Account"})]}),a.jsxs("div",{className:"mt-6",children:[a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-0 flex items-center",children:a.jsx("div",{className:"w-full border-t border-gray-300"})}),a.jsx("div",{className:"relative flex justify-center text-sm",children:a.jsx("span",{className:"px-4 bg-white text-gray-500",children:"Already have an account?"})})]}),a.jsx("div",{className:"mt-6 text-center",children:a.jsx(ft,{to:"/login",className:"text-afri-green hover:text-afri-green-dark font-semibold text-base",children:"Sign in here â†’"})})]})]}),a.jsx("p",{className:"mt-8 text-center text-sm text-gray-600 lg:hidden",children:"Â© 2025 Afrimercato. Fresh African Groceries Delivered."})]})})]})}var Bl=function(e,r){return e<r?-1:e>r?1:0},cf=function(e){return e.reduce(function(r,t){return r+t},0)},Tp=function(){function e(t){this.colors=t}var r=e.prototype;return r.palette=function(){return this.colors},r.map=function(t){return t},e}(),Cp=function(){function e(o,l,c){return(o<<10)+(l<<5)+c}function r(o){var l=[],c=!1;function d(){l.sort(o),c=!0}return{push:function(h){l.push(h),c=!1},peek:function(h){return c||d(),h===void 0&&(h=l.length-1),l[h]},pop:function(){return c||d(),l.pop()},size:function(){return l.length},map:function(h){return l.map(h)},debug:function(){return c||d(),l}}}function t(o,l,c,d,h,u,g){var x=this;x.r1=o,x.r2=l,x.g1=c,x.g2=d,x.b1=h,x.b2=u,x.histo=g}function n(){this.vboxes=new r(function(o,l){return Bl(o.vbox.count()*o.vbox.volume(),l.vbox.count()*l.vbox.volume())})}function s(o,l){if(l.count()){var c=l.r2-l.r1+1,d=l.g2-l.g1+1,h=Math.max.apply(null,[c,d,l.b2-l.b1+1]);if(l.count()==1)return[l.copy()];var u,g,x,m,y=0,v=[],j=[];if(h==c)for(u=l.r1;u<=l.r2;u++){for(m=0,g=l.g1;g<=l.g2;g++)for(x=l.b1;x<=l.b2;x++)m+=o[e(u,g,x)]||0;v[u]=y+=m}else if(h==d)for(u=l.g1;u<=l.g2;u++){for(m=0,g=l.r1;g<=l.r2;g++)for(x=l.b1;x<=l.b2;x++)m+=o[e(g,u,x)]||0;v[u]=y+=m}else for(u=l.b1;u<=l.b2;u++){for(m=0,g=l.r1;g<=l.r2;g++)for(x=l.g1;x<=l.g2;x++)m+=o[e(g,x,u)]||0;v[u]=y+=m}return v.forEach(function(w,N){j[N]=y-w}),function(w){var N,_,C,M,D,L=w+"1",E=w+"2",P=0;for(u=l[L];u<=l[E];u++)if(v[u]>y/2){for(C=l.copy(),M=l.copy(),D=(N=u-l[L])<=(_=l[E]-u)?Math.min(l[E]-1,~~(u+_/2)):Math.max(l[L],~~(u-1-N/2));!v[D];)D++;for(P=j[D];!P&&v[D-1];)P=j[--D];return C[E]=D,M[L]=C[E]+1,[C,M]}}(h==c?"r":h==d?"g":"b")}}return t.prototype={volume:function(o){var l=this;return l._volume&&!o||(l._volume=(l.r2-l.r1+1)*(l.g2-l.g1+1)*(l.b2-l.b1+1)),l._volume},count:function(o){var l=this,c=l.histo;if(!l._count_set||o){var d,h,u,g=0;for(d=l.r1;d<=l.r2;d++)for(h=l.g1;h<=l.g2;h++)for(u=l.b1;u<=l.b2;u++)g+=c[e(d,h,u)]||0;l._count=g,l._count_set=!0}return l._count},copy:function(){var o=this;return new t(o.r1,o.r2,o.g1,o.g2,o.b1,o.b2,o.histo)},avg:function(o){var l=this,c=l.histo;if(!l._avg||o){var d,h,u,g,x=0,m=0,y=0,v=0;if(l.r1===l.r2&&l.g1===l.g2&&l.b1===l.b2)l._avg=[l.r1<<3,l.g1<<3,l.b1<<3];else{for(h=l.r1;h<=l.r2;h++)for(u=l.g1;u<=l.g2;u++)for(g=l.b1;g<=l.b2;g++)x+=d=c[e(h,u,g)]||0,m+=d*(h+.5)*8,y+=d*(u+.5)*8,v+=d*(g+.5)*8;l._avg=x?[~~(m/x),~~(y/x),~~(v/x)]:[~~(8*(l.r1+l.r2+1)/2),~~(8*(l.g1+l.g2+1)/2),~~(8*(l.b1+l.b2+1)/2)]}}return l._avg},contains:function(o){var l=this,c=o[0]>>3;return gval=o[1]>>3,bval=o[2]>>3,c>=l.r1&&c<=l.r2&&gval>=l.g1&&gval<=l.g2&&bval>=l.b1&&bval<=l.b2}},n.prototype={push:function(o){this.vboxes.push({vbox:o,color:o.avg()})},palette:function(){return this.vboxes.map(function(o){return o.color})},size:function(){return this.vboxes.size()},map:function(o){for(var l=this.vboxes,c=0;c<l.size();c++)if(l.peek(c).vbox.contains(o))return l.peek(c).color;return this.nearest(o)},nearest:function(o){for(var l,c,d,h=this.vboxes,u=0;u<h.size();u++)((c=Math.sqrt(Math.pow(o[0]-h.peek(u).color[0],2)+Math.pow(o[1]-h.peek(u).color[1],2)+Math.pow(o[2]-h.peek(u).color[2],2)))<l||l===void 0)&&(l=c,d=h.peek(u).color);return d},forcebw:function(){var o=this.vboxes;o.sort(function(h,u){return Bl(cf(h.color),cf(u.color))});var l=o[0].color;l[0]<5&&l[1]<5&&l[2]<5&&(o[0].color=[0,0,0]);var c=o.length-1,d=o[c].color;d[0]>251&&d[1]>251&&d[2]>251&&(o[c].color=[255,255,255])}},{quantize:function(o,l){if(!Number.isInteger(l)||l<1||l>256)throw new Error("Invalid maximum color count. It must be an integer between 1 and 256.");if(!o.length||l<2||l>256||!o.length||l<2||l>256)return!1;for(var c=[],d=new Set,h=0;h<o.length;h++){var u=o[h],g=u.join(",");d.has(g)||(d.add(g),c.push(u))}if(c.length<=l)return new Tp(c);var x=function(N){var _,C=new Array(32768);return N.forEach(function(M){_=e(M[0]>>3,M[1]>>3,M[2]>>3),C[_]=(C[_]||0)+1}),C}(o);x.forEach(function(){});var m=function(N,_){var C,M,D,L=1e6,E=0,P=1e6,H=0,k=1e6,T=0;return N.forEach(function(W){(C=W[0]>>3)<L?L=C:C>E&&(E=C),(M=W[1]>>3)<P?P=M:M>H&&(H=M),(D=W[2]>>3)<k?k=D:D>T&&(T=D)}),new t(L,E,P,H,k,T,_)}(o,x),y=new r(function(N,_){return Bl(N.count(),_.count())});function v(N,_){for(var C,M=N.size(),D=0;D<1e3;){if(M>=_||D++>1e3)return;if((C=N.pop()).count()){var L=s(x,C),E=L[0],P=L[1];if(!E)return;N.push(E),P&&(N.push(P),M++)}else N.push(C),D++}}y.push(m),v(y,.75*l);for(var j=new r(function(N,_){return Bl(N.count()*N.volume(),_.count()*_.volume())});y.size();)j.push(y.pop());v(j,l);for(var w=new n;j.size();)w.push(j.pop());return w}}}().quantize,Sh=function(e){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.width=this.canvas.width=e.naturalWidth,this.height=this.canvas.height=e.naturalHeight,this.context.drawImage(e,0,0,this.width,this.height)};Sh.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)};var ki=function(){};ki.prototype.getColor=function(e,r){return r===void 0&&(r=10),this.getPalette(e,5,r)[0]},ki.prototype.getPalette=function(e,r,t){var n=function(c){var d=c.colorCount,h=c.quality;if(d!==void 0&&Number.isInteger(d)){if(d===1)throw new Error("colorCount should be between 2 and 20. To get one color, call getColor() instead of getPalette()");d=Math.max(d,2),d=Math.min(d,20)}else d=10;return(h===void 0||!Number.isInteger(h)||h<1)&&(h=10),{colorCount:d,quality:h}}({colorCount:r,quality:t}),s=new Sh(e),o=function(c,d,h){for(var u,g,x,m,y,v=c,j=[],w=0;w<d;w+=h)g=v[0+(u=4*w)],x=v[u+1],m=v[u+2],((y=v[u+3])===void 0||y>=125)&&(g>250&&x>250&&m>250||j.push([g,x,m]));return j}(s.getImageData().data,s.width*s.height,n.quality),l=Cp(o,n.colorCount);return l?l.palette():null},ki.prototype.getColorFromUrl=function(e,r,t){var n=this,s=document.createElement("img");s.addEventListener("load",function(){var o=n.getPalette(s,5,t);r(o[0],e)}),s.src=e},ki.prototype.getImageData=function(e,r){var t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="arraybuffer",t.onload=function(){if(this.status==200){var n=new Uint8Array(this.response);i=n.length;for(var s=new Array(i),o=0;o<n.length;o++)s[o]=String.fromCharCode(n[o]);var l=s.join(""),c=window.btoa(l);r("data:image/png;base64,"+c)}},t.send()},ki.prototype.getColorAsync=function(e,r,t){var n=this;this.getImageData(e,function(s){var o=document.createElement("img");o.addEventListener("load",function(){var l=n.getPalette(o,5,t);r(l[0],this)}),o.src=s})};const Ep=({onComplete:e})=>{const r=pa(),[t,n]=ue.useState(1),[s,o]=ue.useState(!1),[l,c]=ue.useState(""),d=ue.useRef(null),h=ue.useRef(new ki),[u,g]=ue.useState({storeName:"",description:"",category:"fresh-produce",phone:"",alternativePhone:"",address:{street:"",city:"",state:"",country:"Nigeria",postalCode:""},businessHours:{monday:{open:"09:00",close:"18:00",closed:!1},tuesday:{open:"09:00",close:"18:00",closed:!1},wednesday:{open:"09:00",close:"18:00",closed:!1},thursday:{open:"09:00",close:"18:00",closed:!1},friday:{open:"09:00",close:"18:00",closed:!1},saturday:{open:"09:00",close:"18:00",closed:!1},sunday:{open:"09:00",close:"18:00",closed:!0}},logo:null,logoPreview:null,brandColors:{primary:"#059669",secondary:"#FFC107"}}),x=[{value:"fresh-produce",label:"Fresh Produce",icon:"ðŸ¥¬"},{value:"meat-seafood",label:"Meat & Seafood",icon:"ðŸ¥©"},{value:"dairy-eggs",label:"Dairy & Eggs",icon:"ðŸ¥›"},{value:"bakery",label:"Bakery",icon:"ðŸž"},{value:"pantry-staples",label:"Pantry Staples",icon:"ðŸŒ¾"},{value:"beverages",label:"Beverages",icon:"ðŸ¥¤"},{value:"snacks",label:"Snacks",icon:"ðŸ¿"},{value:"specialty",label:"Specialty Items",icon:"âœ¨"}],m=D=>{const{name:L,value:E}=D.target;if(L.startsWith("address.")){const P=L.split(".")[1];g(H=>({...H,address:{...H.address,[P]:E}}))}else g(P=>({...P,[L]:E}))},y=async D=>{const L=D.target.files[0];if(!L)return;if(!L.type.startsWith("image/")){c("Please upload an image file");return}if(L.size>5*1024*1024){c("Image size should be less than 5MB");return}const E=new FileReader;E.onload=async P=>{const H=new Image;H.crossOrigin="Anonymous",H.onload=()=>{try{const k=h.current.getPalette(H,5),T=k[0],W=(J,Z,oe)=>"#"+[J,Z,oe].map(ae=>ae.toString(16).padStart(2,"0")).join(""),G=W(...T),de=k[1]?W(...k[1]):"#FFC107";g(J=>({...J,logo:L,logoPreview:P.target.result,brandColors:{primary:G,secondary:de}}))}catch(k){console.error("Color extraction error:",k),g(T=>({...T,logo:L,logoPreview:P.target.result}))}},H.src=P.target.result},E.readAsDataURL(L),c("")},v=(D,L,E)=>{g(P=>({...P,businessHours:{...P.businessHours,[D]:{...P.businessHours[D],[L]:E}}}))},j=D=>{switch(D){case 1:if(!u.storeName.trim())return c("Store name is required"),!1;if(!u.description.trim())return c("Store description is required"),!1;break;case 2:if(!u.phone.trim())return c("Phone number is required"),!1;break;case 3:if(!u.address.street.trim()||!u.address.city.trim()||!u.address.state.trim())return c("Please fill in all address fields"),!1;break}return c(""),!0},w=()=>{j(t)&&n(D=>Math.min(D+1,5))},N=()=>{n(D=>Math.max(D-1,1)),c("")},_=async()=>{var D,L,E,P;o(!0),c("");try{const H={storeName:u.storeName,description:u.description,category:u.category,phone:u.phone,alternativePhone:u.alternativePhone||void 0,address:u.address,businessHours:u.businessHours,brandColors:u.brandColors};console.log("Sending profile data:",JSON.stringify(H,null,2));const k=await Nh(H);k.success?(u.logo&&console.log("Logo upload will be implemented"),e?e():r("/dashboard")):c(k.message||"Failed to create vendor profile")}catch(H){if(console.error("Onboarding error:",H),(L=(D=H.response)==null?void 0:D.data)!=null&&L.errors&&Array.isArray(H.response.data.errors)){const k=H.response.data.errors.map(T=>`â€¢ ${T.field}: ${T.message}`).join(`
`);c(`Validation errors:
${k}`),console.error("Validation errors:",H.response.data.errors)}else c(((P=(E=H.response)==null?void 0:E.data)==null?void 0:P.message)||H.message||"Failed to create vendor profile")}finally{o(!1)}},C=[{number:1,title:"Store Info",icon:"ðŸª"},{number:2,title:"Contact",icon:"ðŸ“ž"},{number:3,title:"Location",icon:"ðŸ“"},{number:4,title:"Hours",icon:"ðŸ•"},{number:5,title:"Branding",icon:"ðŸŽ¨"}],M={enter:D=>({x:D>0?1e3:-1e3,opacity:0}),center:{zIndex:1,x:0,opacity:1},exit:D=>({zIndex:0,x:D<0?1e3:-1e3,opacity:0})};return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 py-12 px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"max-w-4xl mx-auto",children:[a.jsxs(nt.div,{className:"text-center mb-8",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},children:[a.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Welcome to Afrimercato! ðŸŽ‰"}),a.jsx("p",{className:"text-lg text-gray-600",children:"Let's set up your store in just 5 easy steps"})]}),a.jsx(nt.div,{className:"mb-8",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:a.jsx("div",{className:"flex justify-between items-center",children:C.map((D,L)=>a.jsxs("div",{className:"flex items-center flex-1",children:[a.jsxs("div",{className:"flex flex-col items-center flex-1",children:[a.jsx(nt.div,{className:`w-12 h-12 rounded-full flex items-center justify-center text-2xl border-4 transition-all duration-300 ${t>=D.number?"bg-afri-green border-afri-green text-white":"bg-white border-gray-300 text-gray-400"}`,whileHover:{scale:1.1},animate:{scale:t===D.number?[1,1.1,1]:1},transition:{duration:.3},children:D.icon}),a.jsx("span",{className:`mt-2 text-xs font-medium ${t>=D.number?"text-afri-green":"text-gray-400"}`,children:D.title})]}),L<C.length-1&&a.jsx("div",{className:`h-1 flex-1 mx-2 rounded transition-all duration-300 ${t>D.number?"bg-afri-green":"bg-gray-300"}`})]},D.number))})}),a.jsxs(nt.div,{className:"bg-white rounded-2xl shadow-xl p-8",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.5,delay:.3},children:[l&&a.jsx(nt.div,{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-6 rounded",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:a.jsx("p",{className:"text-red-700",children:l})}),a.jsxs(Zl,{mode:"wait",custom:t,children:[t===1&&a.jsxs(nt.div,{custom:1,variants:M,initial:"enter",animate:"center",exit:"exit",transition:{duration:.3},className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Tell us about your store"}),a.jsx("p",{className:"text-gray-600",children:"This information will help customers find and learn about your business"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Store Name *"}),a.jsx("input",{type:"text",name:"storeName",value:u.storeName,onChange:m,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"e.g., Fresh Valley Farms"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Store Description *"}),a.jsx("textarea",{name:"description",value:u.description,onChange:m,rows:"4",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"Describe what makes your store special..."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Store Category *"}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:x.map(D=>a.jsxs(nt.button,{type:"button",onClick:()=>g(L=>({...L,category:D.value})),className:`p-4 rounded-lg border-2 transition-all ${u.category===D.value?"border-afri-green bg-afri-green/10 text-afri-green":"border-gray-200 hover:border-gray-300"}`,whileHover:{scale:1.05},whileTap:{scale:.95},children:[a.jsx("div",{className:"text-3xl mb-1",children:D.icon}),a.jsx("div",{className:"text-xs font-medium",children:D.label})]},D.value))})]})]},"step1"),t===2&&a.jsxs(nt.div,{custom:2,variants:M,initial:"enter",animate:"center",exit:"exit",transition:{duration:.3},className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Contact Information"}),a.jsx("p",{className:"text-gray-600",children:"How can customers reach you?"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Primary Phone Number *"}),a.jsx("input",{type:"tel",name:"phone",value:u.phone,onChange:m,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"+234-800-555-0001"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Alternative Phone (Optional)"}),a.jsx("input",{type:"tel",name:"alternativePhone",value:u.alternativePhone,onChange:m,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"+234-800-555-0002"})]})]},"step2"),t===3&&a.jsxs(nt.div,{custom:3,variants:M,initial:"enter",animate:"center",exit:"exit",transition:{duration:.3},className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Where are you located?"}),a.jsx("p",{className:"text-gray-600",children:"Your business address"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Street Address *"}),a.jsx("input",{type:"text",name:"address.street",value:u.address.street,onChange:m,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"123 Main Street"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City *"}),a.jsx("input",{type:"text",name:"address.city",value:u.address.city,onChange:m,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"Lagos"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"State *"}),a.jsx("input",{type:"text",name:"address.state",value:u.address.state,onChange:m,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"Lagos State"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Country"}),a.jsx("input",{type:"text",name:"address.country",value:u.address.country,onChange:m,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition bg-gray-50",readOnly:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Postal Code"}),a.jsx("input",{type:"text",name:"address.postalCode",value:u.address.postalCode,onChange:m,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"100001"})]})]})]},"step3"),t===4&&a.jsxs(nt.div,{custom:4,variants:M,initial:"enter",animate:"center",exit:"exit",transition:{duration:.3},className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"When are you open?"}),a.jsx("p",{className:"text-gray-600",children:"Set your business hours for each day"})]}),a.jsx("div",{className:"space-y-4",children:Object.keys(u.businessHours).map(D=>a.jsxs("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-lg",children:[a.jsx("div",{className:"w-28",children:a.jsx("span",{className:"font-medium text-gray-700 capitalize",children:D})}),a.jsx("input",{type:"checkbox",checked:!u.businessHours[D].closed,onChange:L=>v(D,"closed",!L.target.checked),className:"h-5 w-5 text-afri-green focus:ring-afri-green border-gray-300 rounded"}),u.businessHours[D].closed?a.jsx("span",{className:"text-gray-400 italic",children:"Closed"}):a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"time",value:u.businessHours[D].open,onChange:L=>v(D,"open",L.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent"}),a.jsx("span",{className:"text-gray-500",children:"to"}),a.jsx("input",{type:"time",value:u.businessHours[D].close,onChange:L=>v(D,"close",L.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent"})]})]},D))})]},"step4"),t===5&&a.jsxs(nt.div,{custom:5,variants:M,initial:"enter",animate:"center",exit:"exit",transition:{duration:.3},className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Make it yours!"}),a.jsx("p",{className:"text-gray-600",children:"Upload your logo and we'll extract your brand colors automatically"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Store Logo"}),a.jsxs("div",{className:"flex items-center gap-6",children:[u.logoPreview?a.jsxs(nt.div,{className:"relative",initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200},children:[a.jsx("img",{src:u.logoPreview,alt:"Logo preview",className:"w-32 h-32 rounded-lg object-cover border-4 border-gray-200"}),a.jsx(nt.button,{type:"button",onClick:()=>g(D=>({...D,logo:null,logoPreview:null})),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 shadow-lg",whileHover:{scale:1.1},whileTap:{scale:.9},children:a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):a.jsxs(nt.button,{type:"button",onClick:()=>{var D;return(D=d.current)==null?void 0:D.click()},className:"w-32 h-32 border-2 border-dashed border-gray-300 rounded-lg flex flex-col items-center justify-center hover:border-afri-green hover:bg-afri-green/5 transition-all",whileHover:{scale:1.05},whileTap:{scale:.95},children:[a.jsx("svg",{className:"w-8 h-8 text-gray-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),a.jsx("span",{className:"text-xs text-gray-500",children:"Upload Logo"})]}),a.jsx("input",{ref:d,type:"file",accept:"image/*",onChange:y,className:"hidden"}),u.logoPreview&&a.jsxs(nt.div,{className:"flex-1",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:[a.jsx("p",{className:"text-sm font-medium text-gray-700 mb-3",children:"Extracted Brand Colors:"}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"h-16 rounded-lg shadow-md mb-2 border-2 border-white",style:{backgroundColor:u.brandColors.primary}}),a.jsx("p",{className:"text-xs text-gray-600 text-center font-mono",children:u.brandColors.primary}),a.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Primary"})]}),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"h-16 rounded-lg shadow-md mb-2 border-2 border-white",style:{backgroundColor:u.brandColors.secondary}}),a.jsx("p",{className:"text-xs text-gray-600 text-center font-mono",children:u.brandColors.secondary}),a.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Secondary"})]})]})]})]}),a.jsx("p",{className:"mt-3 text-sm text-gray-500",children:"Upload a square image (recommended: 500x500px, max 5MB)"})]}),a.jsxs(nt.div,{className:"bg-gradient-to-r from-afri-green/10 to-afri-yellow/10 p-6 rounded-lg border border-afri-green/20",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:[a.jsx("h4",{className:"font-bold text-gray-900 mb-2",children:"You're all set! ðŸŽ‰"}),a.jsx("p",{className:"text-gray-600 text-sm",children:'Click "Complete Setup" to create your vendor profile and start selling on Afrimercato!'})]})]},"step5")]}),a.jsxs("div",{className:"flex justify-between mt-8 pt-6 border-t",children:[a.jsx(nt.button,{type:"button",onClick:N,disabled:t===1,className:`px-6 py-3 rounded-lg font-medium transition-all ${t===1?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,whileHover:t!==1?{scale:1.05}:{},whileTap:t!==1?{scale:.95}:{},children:"â† Previous"}),t<5?a.jsx(nt.button,{type:"button",onClick:w,className:"px-8 py-3 bg-gradient-to-r from-afri-green to-afri-green-dark text-white rounded-lg font-semibold hover:from-afri-green-dark hover:to-afri-green transition-all shadow-lg",whileHover:{scale:1.05},whileTap:{scale:.95},children:"Next â†’"}):a.jsx(nt.button,{type:"button",onClick:_,disabled:s,className:"px-8 py-3 bg-gradient-to-r from-afri-green to-afri-green-dark text-white rounded-lg font-semibold hover:from-afri-green-dark hover:to-afri-green transition-all shadow-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",whileHover:{scale:s?1:1.05},whileTap:{scale:s?1:.95},children:s?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating..."]}):a.jsx(a.Fragment,{children:"Complete Setup âœ¨"})})]})]}),a.jsx(nt.p,{className:"mt-6 text-center text-sm text-gray-500",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:"Need help? Contact our support team at support@afrimercato.com"})]})})},df=["#00B207","#FFD700","#FF6B6B","#4ECDC4","#95E1D3"];function Fp(){var v,j,w,N,_,C,M,D,L,E;const[e,r]=ue.useState(null),[t,n]=ue.useState(null),[s,o]=ue.useState(!0),[l,c]=ue.useState("7d"),[d,h]=ue.useState(!1),[u,g]=ue.useState(!1);ue.useEffect(()=>{x(),setTimeout(()=>h(!0),100)},[l]);const x=async()=>{try{o(!0);const[P,H]=await Promise.all([pr.getDashboardStats(),pr.getChartData({timeRange:l})]);P.success&&r(P.data),H.success&&n(H.data),g(!1)}catch(P){console.error("Dashboard error:",P),P.message&&P.message.includes("Vendor profile not found")&&g(!0)}finally{o(!1)}},m=()=>{g(!1),x()},y=({title:P,value:H,icon:k,trend:T,color:W,delay:G})=>a.jsx("div",{className:`bg-white rounded-xl shadow-lg p-6 transform transition-all duration-700 hover:scale-105 hover:shadow-2xl ${d?"translate-y-0 opacity-100":"translate-y-4 opacity-0"}`,style:{transitionDelay:`${G}ms`},children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-medium text-afri-gray-600 mb-1",children:P}),a.jsx("h3",{className:"text-3xl font-bold text-afri-gray-900",children:H}),T&&a.jsxs("div",{className:`flex items-center mt-2 text-sm ${T>=0?"text-green-600":"text-red-600"}`,children:[a.jsx("svg",{className:`w-4 h-4 mr-1 transform ${T>=0?"":"rotate-180"}`,fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M12 7a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0V8.414l-4.293 4.293a1 1 0 01-1.414 0L8 10.414l-4.293 4.293a1 1 0 01-1.414-1.414l5-5a1 1 0 011.414 0L11 10.586 14.586 7H12z",clipRule:"evenodd"})}),a.jsxs("span",{className:"font-semibold",children:[Math.abs(T),"%"]}),a.jsx("span",{className:"ml-1 text-afri-gray-500",children:"vs last period"})]})]}),a.jsx("div",{className:`w-16 h-16 rounded-full bg-gradient-to-br ${W} flex items-center justify-center text-white text-3xl shadow-lg transform transition-transform duration-300 hover:rotate-12`,children:k})]})});return u&&!s?a.jsx(Ep,{onComplete:m}):s?a.jsx("div",{className:"flex justify-center items-center h-screen",children:a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"w-20 h-20 border-4 border-afri-green border-t-transparent rounded-full animate-spin"}),a.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:a.jsx("div",{className:"w-12 h-12 border-4 border-afri-yellow border-t-transparent rounded-full animate-spin"})})]})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-afri-green to-afri-green-dark bg-clip-text text-transparent",children:"Dashboard"}),a.jsx("p",{className:"text-afri-gray-600 mt-2",children:"Welcome back! Here's what's happening with your store."})]}),a.jsx("div",{className:"mt-4 md:mt-0",children:a.jsx("div",{className:"inline-flex rounded-lg border border-gray-200 bg-white p-1 shadow-sm",children:["7d","30d","90d"].map(P=>a.jsx("button",{onClick:()=>c(P),className:`px-4 py-2 rounded-md font-medium transition-all duration-300 ${l===P?"bg-gradient-to-r from-afri-green to-afri-green-dark text-white shadow-md":"text-afri-gray-700 hover:bg-afri-gray-50"}`,children:P==="7d"?"Last 7 Days":P==="30d"?"Last 30 Days":"Last 90 Days"},P))})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[a.jsx(y,{title:"Total Revenue",value:`Â£${((j=(v=e==null?void 0:e.revenue)==null?void 0:v.total)==null?void 0:j.toFixed(2))||"0.00"}`,icon:"ðŸ’°",trend:(w=e==null?void 0:e.revenue)==null?void 0:w.trend,color:"from-green-400 to-green-600",delay:0}),a.jsx(y,{title:"Total Orders",value:((N=e==null?void 0:e.orders)==null?void 0:N.total)||0,icon:"ðŸ›’",trend:(_=e==null?void 0:e.orders)==null?void 0:_.trend,color:"from-blue-400 to-blue-600",delay:100}),a.jsx(y,{title:"Total Products",value:((C=e==null?void 0:e.products)==null?void 0:C.total)||0,icon:"ðŸ“¦",trend:(M=e==null?void 0:e.products)==null?void 0:M.trend,color:"from-purple-400 to-purple-600",delay:200}),a.jsx(y,{title:"Average Order Value",value:`Â£${((L=(D=e==null?void 0:e.revenue)==null?void 0:D.avgOrderValue)==null?void 0:L.toFixed(2))||"0.00"}`,icon:"ðŸ“Š",trend:(E=e==null?void 0:e.revenue)==null?void 0:E.avgTrend,color:"from-yellow-400 to-yellow-600",delay:300})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 transform transition-all duration-500 hover:shadow-2xl",children:[a.jsxs("h3",{className:"text-lg font-semibold text-afri-gray-900 mb-4 flex items-center",children:[a.jsx("span",{className:"w-3 h-3 bg-gradient-to-r from-afri-green to-afri-green-dark rounded-full mr-2"}),"Revenue Trend"]}),a.jsx(d0,{width:"100%",height:300,children:a.jsxs(pm,{data:(t==null?void 0:t.revenueData)||[],children:[a.jsx("defs",{children:a.jsxs("linearGradient",{id:"revenueGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[a.jsx("stop",{offset:"5%",stopColor:"#00B207",stopOpacity:.8}),a.jsx("stop",{offset:"95%",stopColor:"#00B207",stopOpacity:.1})]})}),a.jsx(tf,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),a.jsx(rf,{dataKey:"date",stroke:"#6B7280"}),a.jsx(nf,{stroke:"#6B7280"}),a.jsx(f0,{contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"}}),a.jsx(af,{}),a.jsx(xm,{type:"monotone",dataKey:"revenue",stroke:"#00B207",strokeWidth:3,fill:"url(#revenueGradient)",dot:{fill:"#00B207",r:5},activeDot:{r:8,stroke:"#FFD700",strokeWidth:2}})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 transform transition-all duration-500 hover:shadow-2xl",children:[a.jsxs("h3",{className:"text-lg font-semibold text-afri-gray-900 mb-4 flex items-center",children:[a.jsx("span",{className:"w-3 h-3 bg-gradient-to-r from-blue-400 to-blue-600 rounded-full mr-2"}),"Orders Overview"]}),a.jsx(d0,{width:"100%",height:300,children:a.jsxs(gm,{data:(t==null?void 0:t.ordersData)||[],children:[a.jsx("defs",{children:a.jsxs("linearGradient",{id:"ordersGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[a.jsx("stop",{offset:"5%",stopColor:"#3B82F6",stopOpacity:.8}),a.jsx("stop",{offset:"95%",stopColor:"#3B82F6",stopOpacity:.3})]})}),a.jsx(tf,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),a.jsx(rf,{dataKey:"date",stroke:"#6B7280"}),a.jsx(nf,{stroke:"#6B7280"}),a.jsx(f0,{contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"}}),a.jsx(af,{}),a.jsx(vm,{dataKey:"orders",fill:"url(#ordersGradient)",radius:[8,8,0,0]})]})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 transform transition-all duration-500 hover:shadow-2xl",children:[a.jsxs("h3",{className:"text-lg font-semibold text-afri-gray-900 mb-4 flex items-center",children:[a.jsx("span",{className:"w-3 h-3 bg-gradient-to-r from-purple-400 to-purple-600 rounded-full mr-2"}),"Order Status Distribution"]}),a.jsx(d0,{width:"100%",height:300,children:a.jsxs(ym,{children:[a.jsx(bm,{data:(t==null?void 0:t.orderStatusData)||[],cx:"50%",cy:"50%",labelLine:!1,label:({name:P,percent:H})=>`${P}: ${(H*100).toFixed(0)}%`,outerRadius:100,fill:"#8884d8",dataKey:"value",animationBegin:0,animationDuration:800,children:((t==null?void 0:t.orderStatusData)||[]).map((P,H)=>a.jsx(wm,{fill:df[H%df.length]},`cell-${H}`))}),a.jsx(f0,{})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 transform transition-all duration-500 hover:shadow-2xl",children:[a.jsxs("h3",{className:"text-lg font-semibold text-afri-gray-900 mb-4 flex items-center",children:[a.jsx("span",{className:"w-3 h-3 bg-gradient-to-r from-afri-yellow to-afri-yellow-dark rounded-full mr-2"}),"Top Selling Products"]}),a.jsx("div",{className:"space-y-3",children:((e==null?void 0:e.topProducts)||[]).slice(0,5).map((P,H)=>{var k;return a.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-gradient-to-r from-afri-gray-50 to-white hover:from-afri-green hover:to-afri-green-dark hover:text-white transition-all duration-300 cursor-pointer group",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-afri-green to-afri-green-dark text-white flex items-center justify-center font-bold group-hover:scale-110 transition-transform",children:H+1}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium group-hover:text-white",children:P.name}),a.jsxs("p",{className:"text-sm text-afri-gray-500 group-hover:text-white group-hover:opacity-80",children:[P.soldQuantity," sold"]})]})]}),a.jsxs("span",{className:"font-bold text-afri-green group-hover:text-white",children:["Â£",(k=P.revenue)==null?void 0:k.toFixed(2)]})]},P._id)})})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 transform transition-all duration-500 hover:shadow-2xl",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h3",{className:"text-lg font-semibold text-afri-gray-900 flex items-center",children:[a.jsx("span",{className:"w-3 h-3 bg-gradient-to-r from-afri-green to-afri-green-dark rounded-full mr-2"}),"Recent Orders"]}),a.jsxs(ft,{to:"/orders",className:"text-afri-green hover:text-afri-green-dark font-medium transition-colors duration-200 flex items-center group",children:["View All",a.jsx("svg",{className:"w-4 h-4 ml-1 transform group-hover:translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full",children:[a.jsx("thead",{className:"bg-afri-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Order #"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Customer"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Total"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Date"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:((e==null?void 0:e.recentOrders)||[]).slice(0,5).map(P=>{var H,k,T;return a.jsxs("tr",{className:"hover:bg-gradient-to-r hover:from-afri-gray-50 hover:to-white transition-all duration-200 cursor-pointer",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-afri-gray-900",children:P.orderNumber}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-afri-gray-500",children:((H=P.customer)==null?void 0:H.name)||"N/A"}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-afri-green",children:["Â£",((T=(k=P.pricing)==null?void 0:k.total)==null?void 0:T.toFixed(2))||"0.00"]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-gradient-to-r from-afri-green to-afri-green-dark text-white",children:P.status})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-afri-gray-500",children:new Date(P.createdAt).toLocaleDateString()})]},P._id)})})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsx(ft,{to:"/products",className:"bg-gradient-to-br from-afri-green to-afri-green-dark text-white rounded-xl shadow-lg p-6 transform transition-all duration-300 hover:scale-105 hover:shadow-2xl group",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-semibold mb-2",children:"Manage Products"}),a.jsx("p",{className:"text-sm opacity-90",children:"Add, edit, or remove products"})]}),a.jsx("svg",{className:"w-10 h-10 opacity-75 group-hover:scale-110 transition-transform",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{d:"M3 1a1 1 0 000 2h1.22l.305 1.222a.997.997 0 00.01.042l1.358 5.43-.893.892C3.74 11.846 4.632 14 6.414 14H15a1 1 0 000-2H6.414l1-1H14a1 1 0 00.894-.553l3-6A1 1 0 0017 3H6.28l-.31-1.243A1 1 0 005 1H3zM16 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM6.5 18a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"})})]})}),a.jsx(ft,{to:"/orders",className:"bg-gradient-to-br from-blue-500 to-blue-700 text-white rounded-xl shadow-lg p-6 transform transition-all duration-300 hover:scale-105 hover:shadow-2xl group",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-semibold mb-2",children:"Process Orders"}),a.jsx("p",{className:"text-sm opacity-90",children:"View and manage orders"})]}),a.jsxs("svg",{className:"w-10 h-10 opacity-75 group-hover:scale-110 transition-transform",fill:"currentColor",viewBox:"0 0 20 20",children:[a.jsx("path",{d:"M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"}),a.jsx("path",{fillRule:"evenodd",d:"M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm9.707 5.707a1 1 0 00-1.414-1.414L9 12.586l-1.293-1.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})]})]})}),a.jsx(ft,{to:"/reports",className:"bg-gradient-to-br from-purple-500 to-purple-700 text-white rounded-xl shadow-lg p-6 transform transition-all duration-300 hover:scale-105 hover:shadow-2xl group",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-semibold mb-2",children:"View Reports"}),a.jsx("p",{className:"text-sm opacity-90",children:"Analytics and insights"})]}),a.jsx("svg",{className:"w-10 h-10 opacity-75 group-hover:scale-110 transition-transform",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{d:"M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z"})})]})})]})]})}const Lp=["fruits","vegetables","grains","dairy","meat","fish","poultry","bakery","beverages","spices","snacks","household","beauty","other"],Pp=["kg","g","lb","piece","bunch","pack","liter","ml","dozen"];function Op({product:e,onClose:r,onSave:t}){const[n,s]=ue.useState({name:"",description:"",category:"fruits",price:"",originalPrice:"",unit:"kg",stock:"",lowStockThreshold:10,inStock:!0,isActive:!0}),[o,l]=ue.useState([]),[c,d]=ue.useState([]),[h,u]=ue.useState(!1),[g,x]=ue.useState({});ue.useEffect(()=>{e&&(s({name:e.name||"",description:e.description||"",category:e.category||"fruits",price:e.price||"",originalPrice:e.originalPrice||"",unit:e.unit||"kg",stock:e.stock||"",lowStockThreshold:e.lowStockThreshold||10,inStock:e.inStock!==void 0?e.inStock:!0,isActive:e.isActive!==void 0?e.isActive:!0}),e.images&&e.images.length>0&&d(e.images.map(N=>N.url)))},[e]);const m=N=>{const{name:_,value:C,type:M,checked:D}=N.target;s(L=>({...L,[_]:M==="checkbox"?D:C})),g[_]&&x(L=>({...L,[_]:""}))},y=N=>{const _=Array.from(N.target.files);if(_.length>5){alert("You can only upload up to 5 images");return}l(_);const C=_.map(M=>URL.createObjectURL(M));d(C)},v=N=>{l(_=>_.filter((C,M)=>M!==N)),d(_=>_.filter((C,M)=>M!==N))},j=()=>{const N={};return n.name.trim()||(N.name="Product name is required"),n.description.trim()||(N.description="Description is required"),(!n.price||n.price<=0)&&(N.price="Valid price is required"),(!n.stock||n.stock<0)&&(N.stock="Valid stock quantity is required"),x(N),Object.keys(N).length===0},w=async N=>{var _,C;if(N.preventDefault(),!!j())try{u(!0);let M=(e==null?void 0:e.images)||[];if(o.length>0){const E=await pr.uploadProductImages(o);E.success&&(M=E.data.images)}const D={...n,price:parseFloat(n.price),originalPrice:n.originalPrice?parseFloat(n.originalPrice):void 0,stock:parseInt(n.stock),lowStockThreshold:parseInt(n.lowStockThreshold),images:M};let L;e?L=await pr.updateProduct(e._id,D):L=await pr.createProduct(D),L.success&&(alert(e?"Product updated successfully!":"Product created successfully!"),t())}catch(M){console.error("Product save error:",M),alert(((C=(_=M.response)==null?void 0:_.data)==null?void 0:C.message)||"Failed to save product")}finally{u(!1)}};return a.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm transition-opacity",onClick:r}),a.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:a.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto transform transition-all animate-slideUp",children:[a.jsx("div",{className:"sticky top-0 bg-gradient-to-r from-afri-green to-afri-green-dark text-white px-6 py-4 rounded-t-2xl z-10",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h2",{className:"text-2xl font-bold",children:e?"Edit Product":"Add New Product"}),a.jsx("button",{onClick:r,className:"text-white hover:text-afri-yellow transition-colors p-2 hover:bg-white hover:bg-opacity-20 rounded-lg",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),a.jsxs("form",{onSubmit:w,className:"p-6 space-y-6",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:["Product Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"name",value:n.name,onChange:m,className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all ${g.name?"border-red-500":"border-gray-300"}`,placeholder:"e.g., Fresh Organic Tomatoes"}),g.name&&a.jsx("p",{className:"mt-1 text-sm text-red-500",children:g.name})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:["Description ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("textarea",{name:"description",value:n.description,onChange:m,rows:4,className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all ${g.description?"border-red-500":"border-gray-300"}`,placeholder:"Describe your product..."}),g.description&&a.jsx("p",{className:"mt-1 text-sm text-red-500",children:g.description})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Category"}),a.jsx("select",{name:"category",value:n.category,onChange:m,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all",children:Lp.map(N=>a.jsx("option",{value:N,children:N.charAt(0).toUpperCase()+N.slice(1)},N))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Unit"}),a.jsx("select",{name:"unit",value:n.unit,onChange:m,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all",children:Pp.map(N=>a.jsx("option",{value:N,children:N},N))})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:["Price (Â£) ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"number",name:"price",value:n.price,onChange:m,step:"0.01",min:"0",className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all ${g.price?"border-red-500":"border-gray-300"}`,placeholder:"0.00"}),g.price&&a.jsx("p",{className:"mt-1 text-sm text-red-500",children:g.price})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Original Price (Â£)"}),a.jsx("input",{type:"number",name:"originalPrice",value:n.originalPrice,onChange:m,step:"0.01",min:"0",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all",placeholder:"0.00 (optional)"}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"For showing discounts"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:["Stock Quantity ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"number",name:"stock",value:n.stock,onChange:m,min:"0",className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all ${g.stock?"border-red-500":"border-gray-300"}`,placeholder:"0"}),g.stock&&a.jsx("p",{className:"mt-1 text-sm text-red-500",children:g.stock})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Low Stock Alert"}),a.jsx("input",{type:"number",name:"lowStockThreshold",value:n.lowStockThreshold,onChange:m,min:"0",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all",placeholder:"10"}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Get alert when stock is below this number"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Product Images"}),a.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 hover:border-afri-green transition-colors",children:[a.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:y,className:"hidden",id:"product-images"}),a.jsxs("label",{htmlFor:"product-images",className:"flex flex-col items-center cursor-pointer text-center",children:[a.jsx("svg",{className:"w-12 h-12 text-gray-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),a.jsx("p",{className:"text-sm text-gray-600",children:"Click to upload images (max 5)"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"PNG, JPG, GIF up to 10MB"})]})]}),c.length>0&&a.jsx("div",{className:"mt-4 grid grid-cols-5 gap-4",children:c.map((N,_)=>a.jsxs("div",{className:"relative group",children:[a.jsx("img",{src:N,alt:`Preview ${_+1}`,className:"w-full h-24 object-cover rounded-lg border-2 border-gray-200 group-hover:border-afri-green transition-all"}),a.jsx("button",{type:"button",onClick:()=>v(_),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity shadow-lg hover:bg-red-600",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},_))})]}),a.jsxs("div",{className:"flex items-center space-x-6",children:[a.jsxs("label",{className:"flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",name:"inStock",checked:n.inStock,onChange:m,className:"w-5 h-5 text-afri-green border-gray-300 rounded focus:ring-afri-green cursor-pointer"}),a.jsx("span",{className:"ml-2 text-sm font-medium text-afri-gray-900",children:"In Stock"})]}),a.jsxs("label",{className:"flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",name:"isActive",checked:n.isActive,onChange:m,className:"w-5 h-5 text-afri-green border-gray-300 rounded focus:ring-afri-green cursor-pointer"}),a.jsx("span",{className:"ml-2 text-sm font-medium text-afri-gray-900",children:"Active"})]})]}),a.jsxs("div",{className:"flex items-center justify-end space-x-4 pt-6 border-t",children:[a.jsx("button",{type:"button",onClick:r,className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-all",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:h,className:"px-6 py-3 bg-gradient-to-r from-afri-green to-afri-green-dark text-white rounded-lg font-semibold shadow-lg hover:shadow-xl transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center",children:h?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):a.jsx(a.Fragment,{children:e?"Update Product":"Create Product"})})]})]})]})}),a.jsx("style",{jsx:!0,children:`
        @keyframes slideUp {
          from {
            opacity: 0;
            transform: translateY(20px) scale(0.95);
          }
          to {
            opacity: 1;
            transform: translateY(0) scale(1);
          }
        }

        .animate-slideUp {
          animation: slideUp 0.3s ease-out;
        }
      `})]})}function Ip({selectedProducts:e,onClose:r,onComplete:t}){const[n,s]=ue.useState("delete"),[o,l]=ue.useState({isActive:!0,priceType:"percentage",priceValue:"",stockType:"adjust",stockValue:""}),[c,d]=ue.useState(!1),h=async g=>{var x,m;g.preventDefault(),d(!0);try{let y;switch(n){case"delete":if(!confirm(`Delete ${e.length} products? This cannot be undone.`)){d(!1);return}y=await pr.bulkDeleteProducts({productIds:e});break;case"status":y=await pr.bulkUpdateStatus({productIds:e,isActive:o.isActive});break;case"price":if(!o.priceValue||o.priceValue==="0"){alert("Please enter a valid price value"),d(!1);return}y=await pr.bulkUpdatePrices({productIds:e,type:o.priceType,value:parseFloat(o.priceValue)});break;case"stock":if(!o.stockValue||o.stockValue==="0"){alert("Please enter a valid stock value"),d(!1);return}y=await pr.bulkUpdateStock({productIds:e,type:o.stockType,value:parseInt(o.stockValue)});break;default:throw new Error("Invalid action")}y.success&&(alert(`Successfully updated ${e.length} products!`),t())}catch(y){console.error("Bulk action error:",y),alert(((m=(x=y.response)==null?void 0:x.data)==null?void 0:m.message)||"Failed to perform bulk action")}finally{d(!1)}},u=()=>{switch(n){case"delete":return a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start",children:[a.jsx("svg",{className:"w-6 h-6 text-red-600 mt-0.5 mr-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold text-red-900 mb-1",children:"Warning: Permanent Deletion"}),a.jsxs("p",{className:"text-sm text-red-700",children:["You are about to delete ",a.jsxs("span",{className:"font-bold",children:[e.length," products"]}),". This action cannot be undone."]})]})]})});case"status":return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("p",{className:"text-sm text-afri-gray-600",children:["Change status for ",a.jsxs("span",{className:"font-semibold",children:[e.length," products"]})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("label",{className:"flex items-center cursor-pointer",children:[a.jsx("input",{type:"radio",name:"status",checked:o.isActive===!0,onChange:()=>l({...o,isActive:!0}),className:"w-5 h-5 text-afri-green border-gray-300 focus:ring-afri-green cursor-pointer"}),a.jsx("span",{className:"ml-2 text-sm font-medium text-afri-gray-900",children:"Activate"})]}),a.jsxs("label",{className:"flex items-center cursor-pointer",children:[a.jsx("input",{type:"radio",name:"status",checked:o.isActive===!1,onChange:()=>l({...o,isActive:!1}),className:"w-5 h-5 text-afri-green border-gray-300 focus:ring-afri-green cursor-pointer"}),a.jsx("span",{className:"ml-2 text-sm font-medium text-afri-gray-900",children:"Deactivate"})]})]})]});case"price":return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("p",{className:"text-sm text-afri-gray-600",children:["Update prices for ",a.jsxs("span",{className:"font-semibold",children:[e.length," products"]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-afri-gray-700 mb-2",children:"Update Type"}),a.jsxs("select",{value:o.priceType,onChange:g=>l({...o,priceType:g.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent",children:[a.jsx("option",{value:"percentage",children:"Percentage (%)"}),a.jsx("option",{value:"fixed",children:"Fixed Amount (Â£)"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-afri-gray-700 mb-2",children:o.priceType==="percentage"?"Percentage":"Amount (Â£)"}),a.jsx("input",{type:"number",step:"0.01",value:o.priceValue,onChange:g=>l({...o,priceValue:g.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent",placeholder:"0.00"})]})]}),a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:a.jsx("p",{className:"text-sm text-blue-800",children:o.priceType==="percentage"?a.jsxs(a.Fragment,{children:[o.priceValue>0?"Increase":"Decrease"," prices by"," ",a.jsxs("span",{className:"font-bold",children:[Math.abs(o.priceValue),"%"]})]}):a.jsxs(a.Fragment,{children:[o.priceValue>0?"Add":"Subtract"," ",a.jsxs("span",{className:"font-bold",children:["Â£",Math.abs(o.priceValue)]})," to/from prices"]})})})]});case"stock":return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("p",{className:"text-sm text-afri-gray-600",children:["Update stock for ",a.jsxs("span",{className:"font-semibold",children:[e.length," products"]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-afri-gray-700 mb-2",children:"Update Type"}),a.jsxs("select",{value:o.stockType,onChange:g=>l({...o,stockType:g.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent",children:[a.jsx("option",{value:"adjust",children:"Adjust (+/-)"}),a.jsx("option",{value:"set",children:"Set to Value"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-afri-gray-700 mb-2",children:"Quantity"}),a.jsx("input",{type:"number",value:o.stockValue,onChange:g=>l({...o,stockValue:g.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent",placeholder:"0"})]})]}),a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:a.jsx("p",{className:"text-sm text-blue-800",children:o.stockType==="adjust"?a.jsxs(a.Fragment,{children:[o.stockValue>0?"Add":"Remove"," ",a.jsx("span",{className:"font-bold",children:Math.abs(o.stockValue)})," units"]}):a.jsxs(a.Fragment,{children:["Set stock to ",a.jsx("span",{className:"font-bold",children:o.stockValue})," units"]})})})]});default:return null}};return a.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm transition-opacity",onClick:r}),a.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:a.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl max-w-2xl w-full transform transition-all animate-slideUp",children:[a.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white px-6 py-4 rounded-t-2xl",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Bulk Actions"}),a.jsx("button",{onClick:r,className:"text-white hover:text-afri-yellow transition-colors p-2 hover:bg-white hover:bg-opacity-20 rounded-lg",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsxs("p",{className:"text-sm opacity-90 mt-1",children:[e.length," product",e.length>1?"s":""," selected"]})]}),a.jsxs("form",{onSubmit:h,className:"p-6 space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-3",children:"Select Action"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("button",{type:"button",onClick:()=>s("delete"),className:`p-4 rounded-lg border-2 transition-all transform hover:scale-105 ${n==="delete"?"border-red-500 bg-red-50 shadow-lg":"border-gray-200 hover:border-gray-300"}`,children:[a.jsx("div",{className:"text-3xl mb-2",children:"ðŸ—‘ï¸"}),a.jsx("div",{className:"font-semibold text-afri-gray-900",children:"Delete"}),a.jsx("div",{className:"text-xs text-afri-gray-500 mt-1",children:"Remove products"})]}),a.jsxs("button",{type:"button",onClick:()=>s("status"),className:`p-4 rounded-lg border-2 transition-all transform hover:scale-105 ${n==="status"?"border-afri-green bg-green-50 shadow-lg":"border-gray-200 hover:border-gray-300"}`,children:[a.jsx("div",{className:"text-3xl mb-2",children:"ðŸ”„"}),a.jsx("div",{className:"font-semibold text-afri-gray-900",children:"Status"}),a.jsx("div",{className:"text-xs text-afri-gray-500 mt-1",children:"Activate/Deactivate"})]}),a.jsxs("button",{type:"button",onClick:()=>s("price"),className:`p-4 rounded-lg border-2 transition-all transform hover:scale-105 ${n==="price"?"border-blue-500 bg-blue-50 shadow-lg":"border-gray-200 hover:border-gray-300"}`,children:[a.jsx("div",{className:"text-3xl mb-2",children:"ðŸ’°"}),a.jsx("div",{className:"font-semibold text-afri-gray-900",children:"Price"}),a.jsx("div",{className:"text-xs text-afri-gray-500 mt-1",children:"Update prices"})]}),a.jsxs("button",{type:"button",onClick:()=>s("stock"),className:`p-4 rounded-lg border-2 transition-all transform hover:scale-105 ${n==="stock"?"border-purple-500 bg-purple-50 shadow-lg":"border-gray-200 hover:border-gray-300"}`,children:[a.jsx("div",{className:"text-3xl mb-2",children:"ðŸ“¦"}),a.jsx("div",{className:"font-semibold text-afri-gray-900",children:"Stock"}),a.jsx("div",{className:"text-xs text-afri-gray-500 mt-1",children:"Adjust inventory"})]})]})]}),a.jsx("div",{className:"border-t pt-6",children:u()}),a.jsxs("div",{className:"flex items-center justify-end space-x-4 pt-6 border-t",children:[a.jsx("button",{type:"button",onClick:r,className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-all",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:c,className:`px-6 py-3 text-white rounded-lg font-semibold shadow-lg hover:shadow-xl transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center ${n==="delete"?"bg-gradient-to-r from-red-600 to-red-700":"bg-gradient-to-r from-afri-green to-afri-green-dark"}`,children:c?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):`Apply to ${e.length} Product${e.length>1?"s":""}`})]})]})]})}),a.jsx("style",{jsx:!0,children:`
        @keyframes slideUp {
          from {
            opacity: 0;
            transform: translateY(20px) scale(0.95);
          }
          to {
            opacity: 1;
            transform: translateY(0) scale(1);
          }
        }

        .animate-slideUp {
          animation: slideUp 0.3s ease-out;
        }
      `})]})}const Dp=["fruits","vegetables","grains","dairy","meat","fish","poultry","bakery","beverages","spices","snacks","household","beauty","other"];function Rp(){const[e,r]=ue.useState([]),[t,n]=ue.useState(!0),[s,o]=ue.useState(!1),[l,c]=ue.useState(!1),[d,h]=ue.useState(null),[u,g]=ue.useState([]),[x,m]=ue.useState({search:"",category:"",status:"",page:1,limit:20}),[y,v]=ue.useState({});ue.useEffect(()=>{j()},[x]);const j=async()=>{try{n(!0);const E=await pr.getProducts(x);E.success&&(r(E.data.products),v(E.data.pagination))}catch(E){console.error("Error fetching products:",E)}finally{n(!1)}},w=()=>{h(null),o(!0)},N=E=>{h(E),o(!0)},_=async E=>{var P,H;if(confirm("Are you sure you want to delete this product?"))try{(await pr.deleteProduct(E)).success&&(j(),alert("Product deleted successfully!"))}catch(k){alert(((H=(P=k.response)==null?void 0:P.data)==null?void 0:H.message)||"Failed to delete product")}},C=E=>{g(P=>P.includes(E)?P.filter(H=>H!==E):[...P,E])},M=()=>{u.length===e.length?g([]):g(e.map(E=>E._id))},D=()=>{if(u.length===0){alert("Please select products first");return}c(!0)},L=E=>E.inStock?E.stock<=E.lowStockThreshold?a.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800",children:"Low Stock"}):a.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800",children:"In Stock"}):a.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800",children:"Out of Stock"});return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-afri-green to-afri-green-dark bg-clip-text text-transparent",children:"Products"}),a.jsx("p",{className:"text-afri-gray-600 mt-2",children:"Manage your inventory and product listings"})]}),a.jsxs("button",{onClick:w,className:"mt-4 md:mt-0 bg-gradient-to-r from-afri-green to-afri-green-dark text-white px-6 py-3 rounded-lg font-semibold shadow-lg transform transition-all duration-300 hover:scale-105 hover:shadow-xl flex items-center group",children:[a.jsx("svg",{className:"w-5 h-5 mr-2 transform group-hover:rotate-90 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Product"]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsx("div",{className:"md:col-span-2",children:a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Search products...",value:x.search,onChange:E=>m({...x,search:E.target.value,page:1}),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all"}),a.jsx("svg",{className:"absolute left-3 top-3.5 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})}),a.jsxs("select",{value:x.category,onChange:E=>m({...x,category:E.target.value,page:1}),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all",children:[a.jsx("option",{value:"",children:"All Categories"}),Dp.map(E=>a.jsx("option",{value:E,children:E.charAt(0).toUpperCase()+E.slice(1)},E))]}),a.jsxs("select",{value:x.status,onChange:E=>m({...x,status:E.target.value,page:1}),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all",children:[a.jsx("option",{value:"",children:"All Status"}),a.jsx("option",{value:"active",children:"Active"}),a.jsx("option",{value:"inactive",children:"Inactive"}),a.jsx("option",{value:"low-stock",children:"Low Stock"}),a.jsx("option",{value:"out-of-stock",children:"Out of Stock"})]})]}),u.length>0&&a.jsxs("div",{className:"mt-4 p-4 bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg border border-blue-200 flex items-center justify-between animate-slideDown",children:[a.jsx("div",{className:"flex items-center",children:a.jsxs("span",{className:"font-semibold text-blue-900",children:[u.length," products selected"]})}),a.jsx("button",{onClick:D,className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white px-4 py-2 rounded-lg font-medium hover:from-blue-700 hover:to-blue-800 transition-all transform hover:scale-105",children:"Bulk Actions"})]})]}),t?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"relative",children:a.jsx("div",{className:"w-20 h-20 border-4 border-afri-green border-t-transparent rounded-full animate-spin"})})}):e.length===0?a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-12 text-center",children:[a.jsx("svg",{className:"w-24 h-24 text-afri-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),a.jsx("h3",{className:"text-xl font-semibold text-afri-gray-900 mb-2",children:"No products found"}),a.jsx("p",{className:"text-afri-gray-500 mb-6",children:x.search||x.category||x.status?"Try adjusting your filters":"Get started by adding your first product"}),a.jsx("button",{onClick:w,className:"bg-gradient-to-r from-afri-green to-afri-green-dark text-white px-6 py-3 rounded-lg font-semibold shadow-lg hover:shadow-xl transition-all transform hover:scale-105",children:"Add Your First Product"})]}):a.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gradient-to-r from-afri-gray-50 to-afri-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-4",children:a.jsx("input",{type:"checkbox",checked:u.length===e.length,onChange:M,className:"w-4 h-4 text-afri-green border-gray-300 rounded focus:ring-afri-green cursor-pointer"})}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-afri-gray-700 uppercase tracking-wider",children:"Product"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-afri-gray-700 uppercase tracking-wider",children:"Category"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-afri-gray-700 uppercase tracking-wider",children:"Price"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-afri-gray-700 uppercase tracking-wider",children:"Stock"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-afri-gray-700 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-afri-gray-700 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map((E,P)=>a.jsxs("tr",{className:"hover:bg-gradient-to-r hover:from-afri-gray-50 hover:to-white transition-all duration-200 animate-fadeIn",style:{animationDelay:`${P*50}ms`},children:[a.jsx("td",{className:"px-6 py-4",children:a.jsx("input",{type:"checkbox",checked:u.includes(E._id),onChange:()=>C(E._id),className:"w-4 h-4 text-afri-green border-gray-300 rounded focus:ring-afri-green cursor-pointer"})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"h-12 w-12 flex-shrink-0 rounded-lg overflow-hidden bg-afri-gray-100 shadow-sm",children:E.images&&E.images.length>0?a.jsx("img",{src:E.images[0].url,alt:E.name,className:"h-full w-full object-cover transform hover:scale-110 transition-transform duration-300"}):a.jsx("div",{className:"h-full w-full flex items-center justify-center text-afri-gray-400",children:"ðŸ“¦"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("div",{className:"text-sm font-semibold text-afri-gray-900",children:E.name}),a.jsx("div",{className:"text-sm text-afri-gray-500",children:E.unit})]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800",children:E.category})}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[a.jsxs("div",{className:"text-sm font-bold text-afri-green",children:["Â£",E.price.toFixed(2)]}),E.originalPrice&&E.originalPrice>E.price&&a.jsxs("div",{className:"text-xs text-gray-400 line-through",children:["Â£",E.originalPrice.toFixed(2)]})]}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[a.jsx("div",{className:"text-sm text-afri-gray-900 font-semibold",children:E.stock}),E.lowStockThreshold&&a.jsxs("div",{className:"text-xs text-gray-500",children:["Min: ",E.lowStockThreshold]})]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:L(E)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:a.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[a.jsx("button",{onClick:()=>N(E),className:"text-blue-600 hover:text-blue-900 transition-colors p-2 hover:bg-blue-50 rounded-lg group",title:"Edit",children:a.jsx("svg",{className:"w-5 h-5 transform group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),a.jsx("button",{onClick:()=>_(E._id),className:"text-red-600 hover:text-red-900 transition-colors p-2 hover:bg-red-50 rounded-lg group",title:"Delete",children:a.jsx("svg",{className:"w-5 h-5 transform group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},E._id))})]})}),y.pages>1&&a.jsx("div",{className:"px-6 py-4 bg-gradient-to-r from-afri-gray-50 to-white border-t border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"text-sm text-afri-gray-700",children:["Showing ",a.jsx("span",{className:"font-semibold",children:(y.currentPage-1)*x.limit+1})," to"," ",a.jsx("span",{className:"font-semibold",children:Math.min(y.currentPage*x.limit,y.total)})," ","of ",a.jsx("span",{className:"font-semibold",children:y.total})," products"]}),a.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[a.jsx("button",{onClick:()=>m({...x,page:x.page-1}),disabled:y.currentPage===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:a.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),[...Array(y.pages)].map((E,P)=>a.jsx("button",{onClick:()=>m({...x,page:P+1}),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium transition-all ${y.currentPage===P+1?"z-10 bg-gradient-to-r from-afri-green to-afri-green-dark text-white border-afri-green":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:P+1},P)),a.jsx("button",{onClick:()=>m({...x,page:x.page+1}),disabled:y.currentPage===y.pages,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:a.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]})})]}),s&&a.jsx(Op,{product:d,onClose:()=>{o(!1),h(null)},onSave:()=>{j(),o(!1),h(null)}}),l&&a.jsx(Ip,{selectedProducts:u,onClose:()=>c(!1),onComplete:()=>{j(),g([]),c(!1)}}),a.jsx("style",{jsx:!0,children:`
        @keyframes fadeIn {
          from {
            opacity: 0;
            transform: translateY(10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        @keyframes slideDown {
          from {
            opacity: 0;
            transform: translateY(-10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .animate-fadeIn {
          animation: fadeIn 0.5s ease-out forwards;
        }

        .animate-slideDown {
          animation: slideDown 0.3s ease-out;
        }
      `})]})}function Mp({order:e,onPackingComplete:r,onStatusUpdate:t}){var v;const[n,s]=ue.useState([]),[o,l]=ue.useState({});ue.useEffect(()=>{const j=e.items.map(w=>({itemId:w._id||w.productId||w.name,name:w.name,quantity:w.quantity,unit:w.unit,packed:!1,pickedQuantity:0}));s(j)},[e.items]);const c=j=>{s(w=>w.map(N=>N.itemId===j?{...N,packed:!N.packed,pickedQuantity:N.packed?0:N.quantity}:N))},d=(j,w)=>{s(N=>N.map(_=>_.itemId===j?{..._,pickedQuantity:Math.max(0,Math.min(w,_.quantity))}:_))},h=(j,w)=>{l(N=>({...N,[j]:w}))},u=()=>{s(j=>j.map(w=>({...w,packed:!0,pickedQuantity:w.quantity})))},g=async()=>{!n.every(w=>w.packed)&&!window.confirm("Not all items are marked as packed. Are you sure you want to mark this order as ready?")||(r&&r(n),t&&await t("ready_for_pickup","All items packed and ready for pickup"))},x=n.filter(j=>j.packed).length,m=n.length,y=m>0?x/m*100:0;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-gradient-to-br from-[#FFB300] to-[#FFA726] rounded-xl p-6 text-white shadow-lg",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-2xl font-bold",children:"Packing Checklist"}),a.jsxs("p",{className:"text-gray-900 mt-1",children:[x," of ",m," items packed"]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"text-4xl font-bold",children:[Math.round(y),"%"]}),a.jsx("div",{className:"text-sm text-gray-900",children:"Complete"})]})]}),a.jsx("div",{className:"w-full bg-gray-900/20 rounded-full h-4 overflow-hidden shadow-inner",children:a.jsx("div",{className:"bg-gradient-to-r from-[#00897B] to-[#26A69A] h-full rounded-full transition-all duration-500 ease-out shadow-lg",style:{width:`${y}%`}})}),a.jsxs("div",{className:"mt-4 flex gap-3",children:[a.jsx("button",{onClick:u,className:"flex-1 bg-white text-gray-900 px-4 py-2 rounded-lg font-semibold shadow-md hover:shadow-lg transition-all transform hover:-translate-y-0.5",children:"âœ“ Mark All Packed"}),a.jsx("button",{onClick:g,disabled:x===0,className:"flex-1 bg-[#00897B] text-white px-4 py-2 rounded-lg font-semibold shadow-md hover:shadow-lg hover:bg-[#00695C] transition-all transform hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none",children:"ðŸ“¦ Ready for Pickup"})]})]}),((v=e.deliveryAddress)==null?void 0:v.instructions)&&a.jsx("div",{className:"bg-yellow-50 border-l-4 border-[#FFB300] rounded-lg p-4 shadow-sm",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("svg",{className:"w-5 h-5 text-[#FFB300] mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"Special Instructions"}),a.jsx("p",{className:"text-gray-700 text-sm",children:e.deliveryAddress.instructions})]})]})}),a.jsx("div",{className:"space-y-3",children:n.map((j,w)=>{const N=e.items[w];return a.jsx("div",{className:`
                bg-white rounded-xl p-5 shadow-md border-2 transition-all duration-300
                ${j.packed?"border-[#00897B] bg-green-50/50":"border-gray-200 hover:border-[#FFB300]"}
              `,children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"flex-shrink-0 pt-1",children:a.jsx("button",{onClick:()=>c(j.itemId),className:`
                      w-8 h-8 rounded-lg border-2 flex items-center justify-center
                      transition-all duration-200 transform hover:scale-110
                      ${j.packed?"bg-[#00897B] border-[#00897B] shadow-lg":"bg-white border-gray-300 hover:border-[#FFB300]"}
                    `,children:j.packed&&a.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-start justify-between gap-4 mb-3",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:`text-lg font-semibold ${j.packed?"text-[#00897B] line-through":"text-gray-900"}`,children:j.name}),a.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-1",children:[a.jsxs("span",{className:"text-sm text-gray-600",children:["Ordered: ",a.jsxs("span",{className:"font-semibold",children:[j.quantity," ",j.unit]})]}),N.price&&a.jsxs("span",{className:"text-sm text-gray-600",children:["Price: ",a.jsxs("span",{className:"font-semibold",children:["Â£",N.price.toFixed(2)]})]})]})]}),N.image&&a.jsx("img",{src:N.image,alt:j.name,className:"w-20 h-20 object-cover rounded-lg shadow-md"})]}),a.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Picked Quantity:"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>d(j.itemId,j.pickedQuantity-1),disabled:j.pickedQuantity<=0,className:"w-8 h-8 rounded-lg bg-gray-200 hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed font-semibold transition-colors",children:"-"}),a.jsx("input",{type:"number",value:j.pickedQuantity,onChange:_=>d(j.itemId,parseInt(_.target.value)||0),className:"w-20 text-center px-2 py-1 border-2 border-gray-300 rounded-lg font-semibold focus:border-[#FFB300] focus:ring-2 focus:ring-[#FFB300]/20",min:"0",max:j.quantity}),a.jsx("button",{onClick:()=>d(j.itemId,j.pickedQuantity+1),disabled:j.pickedQuantity>=j.quantity,className:"w-8 h-8 rounded-lg bg-gray-200 hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed font-semibold transition-colors",children:"+"}),a.jsxs("span",{className:"text-sm text-gray-600",children:["/ ",j.quantity," ",j.unit]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes (optional)"}),a.jsx("input",{type:"text",value:o[j.itemId]||"",onChange:_=>h(j.itemId,_.target.value),placeholder:"E.g., substitution, quality issue...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-[#FFB300] focus:border-transparent"})]}),j.pickedQuantity>0&&j.pickedQuantity<j.quantity&&a.jsx("div",{className:"mt-2 p-2 bg-orange-50 border-l-4 border-orange-400 rounded",children:a.jsxs("p",{className:"text-xs text-orange-700",children:["âš ï¸ Short by ",j.quantity-j.pickedQuantity," ",j.unit]})})]})]})},j.itemId)})}),a.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-6 shadow-lg border border-gray-200",children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Packing Summary"}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{className:"text-center p-3 bg-white rounded-lg shadow-sm",children:[a.jsx("div",{className:"text-2xl font-bold text-gray-900",children:m}),a.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Total Items"})]}),a.jsxs("div",{className:"text-center p-3 bg-white rounded-lg shadow-sm",children:[a.jsx("div",{className:"text-2xl font-bold text-[#00897B]",children:x}),a.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Packed"})]}),a.jsxs("div",{className:"text-center p-3 bg-white rounded-lg shadow-sm",children:[a.jsx("div",{className:"text-2xl font-bold text-orange-600",children:m-x}),a.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Remaining"})]})]})]}),a.jsx("div",{className:"sticky bottom-0 bg-white border-t-2 border-gray-200 p-4 -mx-6 -mb-6 rounded-b-xl shadow-lg",children:a.jsx("button",{onClick:g,disabled:x===0,className:`
            w-full py-4 rounded-xl font-bold text-lg text-white shadow-lg
            transition-all duration-200 transform hover:-translate-y-1 hover:shadow-xl
            ${x===m?"bg-gradient-to-r from-[#00897B] to-[#26A69A]":"bg-gradient-to-r from-gray-500 to-gray-600"}
            disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none
          `,children:x===m?a.jsx(a.Fragment,{children:"âœ“ Mark Order as Ready for Pickup"}):a.jsxs(a.Fragment,{children:["Pack ",m-x," More Items"]})})})]})}function Bp({order:e,onPickerAssigned:r}){var j,w,N,_;const[t,n]=ue.useState([]),[s,o]=ue.useState(null),[l,c]=ue.useState(!0),[d,h]=ue.useState(!1);ue.useEffect(()=>{u()},[]);const u=async()=>{try{c(!0);const C=[{id:"picker-1",name:"John Smith",status:"available",activeOrders:0,rating:4.8,completedOrders:156,avatar:null},{id:"picker-2",name:"Sarah Johnson",status:"available",activeOrders:1,rating:4.9,completedOrders:203,avatar:null},{id:"picker-3",name:"Michael Brown",status:"busy",activeOrders:3,rating:4.7,completedOrders:189,avatar:null},{id:"picker-4",name:"Emily Davis",status:"available",activeOrders:0,rating:5,completedOrders:98,avatar:null}];setTimeout(()=>{n(C),c(!1)},500)}catch(C){console.error("Error fetching pickers:",C),c(!1)}},g=async()=>{if(!s){alert("Please select a picker");return}h(!0);try{await new Promise(C=>setTimeout(C,1e3)),r&&await r(s.id),alert(`Order assigned to ${s.name}`)}catch(C){console.error("Error assigning picker:",C),alert("Failed to assign picker. Please try again.")}finally{h(!1)}},x=C=>{switch(C){case"available":return"bg-green-100 text-green-700 border-green-200";case"busy":return"bg-orange-100 text-orange-700 border-orange-200";case"offline":return"bg-gray-100 text-gray-700 border-gray-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}},m=C=>{switch(C){case"available":return"bg-green-500";case"busy":return"bg-orange-500";case"offline":return"bg-gray-400";default:return"bg-gray-400"}};if(l)return a.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#FFB300] mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading available pickers..."})]});const y=t.filter(C=>C.status==="available"),v=t.filter(C=>C.status==="busy");return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-gradient-to-br from-[#FFB300] to-[#FFA726] rounded-xl p-6 text-white shadow-lg",children:[a.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Assign Order Picker"}),a.jsxs("p",{className:"text-gray-900",children:["Select a picker to handle this order â€¢ ",y.length," available"]})]}),a.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-md border border-gray-200",children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Order Details"}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Order Number"}),a.jsx("p",{className:"font-semibold text-gray-900",children:e.orderNumber})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Total Items"}),a.jsx("p",{className:"font-semibold text-gray-900",children:((j=e.items)==null?void 0:j.length)||0})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Order Value"}),a.jsxs("p",{className:"font-semibold text-[#00897B]",children:["Â£",(N=(w=e.pricing)==null?void 0:w.total)==null?void 0:N.toFixed(2)]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Customer"}),a.jsx("p",{className:"font-semibold text-gray-900",children:((_=e.deliveryAddress)==null?void 0:_.fullName)||"N/A"})]})]})]}),y.length>0&&a.jsxs("div",{children:[a.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[a.jsx("span",{className:"w-3 h-3 bg-green-500 rounded-full animate-pulse"}),"Available Pickers (",y.length,")"]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:y.map(C=>a.jsx("div",{onClick:()=>o(C),className:`
                  bg-white rounded-xl p-5 shadow-md cursor-pointer transition-all duration-200
                  border-2 ${(s==null?void 0:s.id)===C.id?"border-[#FFB300] shadow-lg scale-105":"border-gray-200 hover:border-[#FFB300] hover:shadow-lg"}
                `,children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsxs("div",{className:"flex-shrink-0",children:[C.avatar?a.jsx("img",{src:C.avatar,alt:C.name,className:"w-16 h-16 rounded-full object-cover shadow-md"}):a.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-[#FFB300] to-[#FFA726] flex items-center justify-center text-white text-2xl font-bold shadow-md",children:C.name.charAt(0)}),a.jsx("div",{className:`w-4 h-4 rounded-full ${m(C.status)} border-2 border-white shadow-sm -mt-3 ml-12`})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[a.jsx("h5",{className:"font-bold text-gray-900 text-lg",children:C.name}),(s==null?void 0:s.id)===C.id&&a.jsx("svg",{className:"w-6 h-6 text-[#FFB300] flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[a.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded-lg",children:[a.jsx("div",{className:"text-sm font-bold text-gray-900",children:C.rating}),a.jsx("div",{className:"text-xs text-gray-500",children:"Rating"})]}),a.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded-lg",children:[a.jsx("div",{className:"text-sm font-bold text-gray-900",children:C.completedOrders}),a.jsx("div",{className:"text-xs text-gray-500",children:"Orders"})]}),a.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded-lg",children:[a.jsx("div",{className:"text-sm font-bold text-gray-900",children:C.activeOrders}),a.jsx("div",{className:"text-xs text-gray-500",children:"Active"})]})]}),a.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold border ${x(C.status)}`,children:[a.jsx("span",{className:`w-2 h-2 rounded-full ${m(C.status)} mr-2`}),C.status.charAt(0).toUpperCase()+C.status.slice(1)]})]})]})},C.id))})]}),v.length>0&&a.jsxs("div",{children:[a.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[a.jsx("span",{className:"w-3 h-3 bg-orange-500 rounded-full"}),"Busy Pickers (",v.length,")"]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:v.map(C=>a.jsx("div",{className:"bg-white rounded-xl p-5 shadow-md border-2 border-gray-200 opacity-60",children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"flex-shrink-0",children:C.avatar?a.jsx("img",{src:C.avatar,alt:C.name,className:"w-16 h-16 rounded-full object-cover shadow-md grayscale"}):a.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-400 flex items-center justify-center text-white text-2xl font-bold shadow-md",children:C.name.charAt(0)})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h5",{className:"font-bold text-gray-700 text-lg mb-1",children:C.name}),a.jsxs("p",{className:"text-sm text-gray-500 mb-2",children:["Currently handling ",C.activeOrders," orders"]}),a.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold border ${x(C.status)}`,children:[a.jsx("span",{className:`w-2 h-2 rounded-full ${m(C.status)} mr-2`}),"Busy"]})]})]})},C.id))})]}),t.length===0&&a.jsxs("div",{className:"bg-gray-50 rounded-xl p-12 text-center",children:[a.jsx("svg",{className:"w-16 h-16 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Pickers Available"}),a.jsx("p",{className:"text-gray-600",children:"All pickers are currently busy. Please check back in a few minutes."})]}),s&&a.jsx("div",{className:"sticky bottom-0 bg-white border-t-2 border-gray-200 p-4 -mx-6 -mb-6 rounded-b-xl shadow-lg",children:a.jsx("button",{onClick:g,disabled:d,className:"w-full py-4 bg-gradient-to-r from-[#00897B] to-[#26A69A] text-white rounded-xl font-bold text-lg shadow-lg hover:shadow-xl transition-all duration-200 transform hover:-translate-y-1 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center justify-center gap-2",children:d?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Assigning..."]}):a.jsxs(a.Fragment,{children:["âœ“ Assign to ",s.name]})})})]})}function Up({order:e,onStatusUpdate:r,isUpdating:t}){const[n,s]=ue.useState(!1),[o,l]=ue.useState(null),[c,d]=ue.useState(""),h=()=>({pending:[{status:"confirmed",label:"Accept Order",icon:"âœ“",color:"green",description:"Confirm and start preparing this order"},{status:"cancelled",label:"Reject Order",icon:"âœ•",color:"red",description:"Cancel this order (requires reason)",requiresNote:!0}],confirmed:[{status:"preparing",label:"Start Preparing",icon:"ðŸ‘¨â€ðŸ³",color:"orange",description:"Begin preparing the order"},{status:"cancelled",label:"Cancel Order",icon:"âœ•",color:"red",description:"Cancel this order",requiresNote:!0}],preparing:[{status:"ready",label:"Mark as Ready",icon:"âœ“",color:"green",description:"Order is ready for pickup"}],ready:[{status:"out-for-delivery",label:"Out for Delivery",icon:"ðŸšš",color:"blue",description:"Rider has picked up the order"}],"out-for-delivery":[{status:"delivered",label:"Mark as Delivered",icon:"âœ“",color:"green",description:"Order has been delivered to customer"}],delivered:[{status:"completed",label:"Complete Order",icon:"âœ“",color:"gray",description:"Finalize and archive this order"}],assigned_picker:[{status:"picking",label:"Start Picking",icon:"ðŸ“¦",color:"purple",description:"Picker starts collecting items"}],picking:[{status:"picked",label:"Items Picked",icon:"âœ“",color:"purple",description:"All items have been picked"}],picked:[{status:"packing",label:"Start Packing",icon:"ðŸ“¦",color:"indigo",description:"Begin packing the items"}],packing:[{status:"ready_for_pickup",label:"Ready for Pickup",icon:"âœ“",color:"teal",description:"Order is packed and ready"}]})[e.status]||[],u=v=>{l(v),s(!0)},g=async()=>{if(!o)return;const v=o.requiresNote?c:"";if(o.requiresNote&&!v.trim()){alert("Please provide a reason for cancellation");return}try{await r(o.status,v),s(!1),l(null),d("")}catch(j){console.error("Error updating status:",j),alert("Failed to update order status. Please try again.")}},x=()=>{s(!1),l(null),d("")},m=h();if(m.length===0)return null;const y={green:{bg:"bg-gradient-to-r from-green-600 to-green-700",hover:"hover:from-green-700 hover:to-green-800",border:"border-green-600",text:"text-green-700"},red:{bg:"bg-gradient-to-r from-red-600 to-red-700",hover:"hover:from-red-700 hover:to-red-800",border:"border-red-600",text:"text-red-700"},orange:{bg:"bg-gradient-to-r from-orange-600 to-orange-700",hover:"hover:from-orange-700 hover:to-orange-800",border:"border-orange-600",text:"text-orange-700"},blue:{bg:"bg-gradient-to-r from-blue-600 to-blue-700",hover:"hover:from-blue-700 hover:to-blue-800",border:"border-blue-600",text:"text-blue-700"},purple:{bg:"bg-gradient-to-r from-purple-600 to-purple-700",hover:"hover:from-purple-700 hover:to-purple-800",border:"border-purple-600",text:"text-purple-700"},indigo:{bg:"bg-gradient-to-r from-indigo-600 to-indigo-700",hover:"hover:from-indigo-700 hover:to-indigo-800",border:"border-indigo-600",text:"text-indigo-700"},teal:{bg:"bg-gradient-to-r from-[#00897B] to-[#00695C]",hover:"hover:from-[#00695C] hover:to-[#004D40]",border:"border-[#00897B]",text:"text-[#00897B]"},gray:{bg:"bg-gradient-to-r from-gray-600 to-gray-700",hover:"hover:from-gray-700 hover:to-gray-800",border:"border-gray-600",text:"text-gray-700"}};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg border-2 border-[#FFB300]",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[a.jsx("svg",{className:"w-5 h-5 text-[#FFB300]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"Quick Actions"]}),a.jsx("div",{className:"flex flex-wrap gap-3",children:m.map(v=>{const j=y[v.color]||y.gray;return a.jsxs("button",{onClick:()=>u(v),disabled:t,className:`
                  flex items-center gap-2 px-6 py-3 rounded-lg font-semibold text-white
                  ${j.bg} ${j.hover}
                  shadow-md hover:shadow-lg
                  transition-all duration-200 transform hover:-translate-y-0.5
                  disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none
                `,children:[a.jsx("span",{className:"text-xl",children:v.icon}),a.jsx("span",{children:v.label}),t&&a.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})]},v.status)})})]}),n&&o&&a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[60] p-4 animate-fadeIn",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-slideUp",children:[a.jsx("div",{className:`w-16 h-16 rounded-full mx-auto mb-4 flex items-center justify-center ${o.color==="red"?"bg-red-100":"bg-green-100"}`,children:a.jsx("span",{className:"text-3xl",children:o.icon})}),a.jsx("h3",{className:"text-xl font-bold text-gray-900 text-center mb-2",children:o.label}),a.jsx("p",{className:"text-gray-600 text-center mb-4",children:o.description}),o.requiresNote&&a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for cancellation *"}),a.jsx("textarea",{value:c,onChange:v=>d(v.target.value),placeholder:"Please provide a reason...",rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#FFB300] focus:border-transparent resize-none",required:!0})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-4",children:[a.jsx("div",{className:"text-sm text-gray-600",children:"Order Number"}),a.jsx("div",{className:"font-semibold text-gray-900",children:e.orderNumber})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:x,className:"flex-1 px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium rounded-lg transition-colors",children:"Cancel"}),a.jsx("button",{onClick:g,disabled:o.requiresNote&&!c.trim(),className:`
                  flex-1 px-4 py-2 text-white font-medium rounded-lg transition-all
                  ${y[o.color].bg} ${y[o.color].hover}
                  shadow-md hover:shadow-lg
                  disabled:opacity-50 disabled:cursor-not-allowed
                `,children:"Confirm"})]})]})})]})}function Hp({order:e}){var y;const[r,t]=ue.useState(!1),[n,s]=ue.useState(0),o=[{status:"pending",label:"Order Placed",icon:"ðŸ“‹",description:"Customer placed the order"},{status:"confirmed",label:"Order Confirmed",icon:"âœ“",description:"Vendor accepted the order"},{status:"assigned_picker",label:"Picker Assigned",icon:"ðŸ‘¤",description:"Order assigned to picker"},{status:"picking",label:"Picking Items",icon:"ðŸ›’",description:"Picker is collecting items"},{status:"picked",label:"Items Picked",icon:"âœ“",description:"All items collected"},{status:"packing",label:"Packing Order",icon:"ðŸ“¦",description:"Items being packed"},{status:"ready_for_pickup",label:"Ready for Pickup",icon:"âœ“",description:"Order ready for rider"},{status:"out-for-delivery",label:"Out for Delivery",icon:"ðŸšš",description:"Rider on the way"},{status:"delivered",label:"Delivered",icon:"âœ“",description:"Order delivered to customer"},{status:"completed",label:"Completed",icon:"âœ“",description:"Order completed"}],l={label:"Order Cancelled",icon:"âœ•",description:"Order was cancelled"},d=e.status==="cancelled"?-1:o.findIndex(v=>v.status===e.status),h=e.status==="cancelled",u=v=>h?"cancelled":v<d?"completed":v===d?"current":"upcoming",g=v=>{switch(v){case"completed":return{bg:"bg-[#00897B]",text:"text-[#00897B]",border:"border-[#00897B]",line:"bg-[#00897B]"};case"current":return{bg:"bg-[#FFB300]",text:"text-[#FFB300]",border:"border-[#FFB300]",line:"bg-gray-300"};case"cancelled":return{bg:"bg-red-500",text:"text-red-500",border:"border-red-500",line:"bg-gray-300"};default:return{bg:"bg-gray-300",text:"text-gray-400",border:"border-gray-300",line:"bg-gray-300"}}},x=e.statusHistory||[{status:"pending",timestamp:e.createdAt,note:"Order placed by customer",user:"System"},...e.status!=="pending"?[{status:e.status,timestamp:e.updatedAt,note:"Current status",user:"Vendor"}]:[]],m=r?x:x.slice(0,3);return ue.useEffect(()=>{const v=(d+1)/o.length*100;let j=0;const w=v/50,N=setInterval(()=>{j+=w,j>=v?(s(v),clearInterval(N)):s(j)},20);return()=>clearInterval(N)},[d,o.length]),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-gradient-to-br from-[#FFB300] to-[#FFA726] rounded-xl p-6 text-white shadow-lg animate-slideDown",children:[a.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Order Timeline"}),a.jsxs("p",{className:"text-gray-900",children:["Track the progress of order ",e.orderNumber]})]}),!h&&a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-gray-200 animate-fadeIn",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Overall Progress"}),a.jsxs("span",{className:"text-2xl font-bold bg-gradient-to-r from-[#00897B] to-[#00695C] bg-clip-text text-transparent",children:[Math.round(n),"%"]})]}),a.jsxs("div",{className:"relative w-full h-6 bg-gray-200 rounded-full overflow-hidden shadow-inner",children:[a.jsx("div",{className:"absolute top-0 left-0 h-full bg-gradient-to-r from-[#00897B] via-[#00695C] to-[#00897B] rounded-full transition-all duration-1000 ease-out shadow-lg animate-shimmer",style:{width:`${n}%`},children:a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-30 animate-pulse"})}),o.map((v,j)=>{const w=(j+1)/o.length*100;return a.jsx("div",{className:"absolute top-1/2 transform -translate-y-1/2 w-2 h-2 bg-white rounded-full shadow-md",style:{left:`${w}%`,marginLeft:"-4px"}},j)})]}),a.jsxs("div",{className:"flex justify-between mt-2 text-xs text-gray-500",children:[a.jsx("span",{children:"Started"}),a.jsx("span",{className:"font-semibold text-[#FFB300]",children:((y=o[d])==null?void 0:y.label)||"Unknown"}),a.jsx("span",{children:"Completed"})]})]}),a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-gray-200",children:[a.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Progress Stages"}),a.jsx("div",{className:"relative",children:h?a.jsxs("div",{className:"relative flex items-start gap-4",children:[a.jsx("div",{className:"relative z-10 flex-shrink-0",children:a.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center border-4 border-white shadow-lg bg-red-500",children:a.jsx("span",{className:"text-white text-xl",children:l.icon})})}),a.jsxs("div",{className:"flex-1 pt-1",children:[a.jsx("h5",{className:"font-bold text-lg text-red-500 mb-1",children:l.label}),a.jsx("p",{className:"text-sm text-gray-600",children:l.description}),e.cancellationReason&&a.jsx("div",{className:"mt-2 p-3 bg-red-50 border-l-4 border-red-500 rounded",children:a.jsxs("p",{className:"text-sm text-gray-700",children:[a.jsx("span",{className:"font-semibold",children:"Reason:"})," ",e.cancellationReason]})})]})]}):o.map((v,j)=>{const w=u(j),N=g(w),_=j===o.length-1;return a.jsxs("div",{className:"relative flex items-start gap-4 pb-8 animate-slideIn",style:{animationDelay:`${j*100}ms`},children:[!_&&a.jsx("div",{className:"absolute left-5 top-12 w-0.5 h-full",children:a.jsx("div",{className:`w-full transition-all duration-500 ${N.line}`,style:{height:w==="completed"?"100%":w==="current"?"50%":"0%"}})}),a.jsxs("div",{className:"relative z-10 flex-shrink-0",children:[a.jsx("div",{className:`
                        w-10 h-10 rounded-full flex items-center justify-center
                        border-4 border-white shadow-lg transform transition-all duration-500
                        ${N.bg}
                        ${w==="current"?"animate-pulseGlow scale-110 ring-4 ring-[#FFB300] ring-opacity-50":""}
                        ${w==="completed"?"animate-bounceIn":""}
                        ${w==="upcoming"?"scale-90 opacity-50":""}
                      `,children:a.jsx("span",{className:"text-white text-xl",children:v.icon})}),w==="completed"&&a.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-[#00897B] rounded-full flex items-center justify-center animate-checkmark",children:a.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),w==="current"&&a.jsx("div",{className:"absolute inset-0 rounded-full bg-[#FFB300] animate-ping opacity-20"})]}),a.jsxs("div",{className:"flex-1 pt-1",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("h5",{className:`font-bold text-lg ${N.text}`,children:v.label}),w==="completed"&&x.find(C=>C.status===v.status)&&a.jsx("span",{className:"text-sm text-gray-500",children:new Date(x.find(C=>C.status===v.status).timestamp).toLocaleString("en-GB",{dateStyle:"short",timeStyle:"short"})}),w==="current"&&a.jsx("span",{className:"px-3 py-1 bg-[#FFB300] text-gray-900 text-xs font-semibold rounded-full",children:"Current"})]}),a.jsx("p",{className:"text-sm text-gray-600",children:v.description}),w==="current"&&a.jsx("div",{className:"mt-2 p-3 bg-yellow-50 border-l-4 border-[#FFB300] rounded",children:a.jsxs("p",{className:"text-sm text-gray-700",children:[a.jsx("span",{className:"font-semibold",children:"In Progress:"})," This stage is currently active"]})})]})]},v.status)})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-gray-200",children:[a.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[a.jsx("svg",{className:"w-5 h-5 text-[#00897B]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Status History"]}),a.jsx("div",{className:"space-y-3",children:m.map((v,j)=>a.jsxs("div",{className:"flex items-start gap-4 p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[a.jsx("div",{className:"flex-shrink-0 w-2 h-2 mt-2 rounded-full bg-[#00897B]"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[a.jsx("h5",{className:"font-semibold text-gray-900 capitalize",children:v.status.replace(/_/g," ").replace(/-/g," ")}),a.jsx("span",{className:"text-sm text-gray-500 whitespace-nowrap",children:new Date(v.timestamp).toLocaleString("en-GB",{dateStyle:"short",timeStyle:"short"})})]}),v.note&&a.jsx("p",{className:"text-sm text-gray-600",children:v.note}),v.user&&a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["By ",v.user]})]})]},j))}),x.length>3&&a.jsx("button",{onClick:()=>t(!r),className:"mt-4 w-full py-2 text-[#00897B] font-medium hover:bg-gray-50 rounded-lg transition-colors",children:r?"â–² Show Less":`â–¼ Show ${x.length-3} More`})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-5 shadow-md border border-blue-200",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-500 flex items-center justify-center",children:a.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),a.jsx("h5",{className:"font-semibold text-gray-900",children:"Total Time"})]}),a.jsxs("p",{className:"text-2xl font-bold text-blue-700",children:[Math.round((new Date-new Date(e.createdAt))/1e3/60)," mins"]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Since order placed"})]}),a.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-5 shadow-md border border-green-200",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-green-500 flex items-center justify-center",children:a.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),a.jsx("h5",{className:"font-semibold text-gray-900",children:"Progress"})]}),a.jsxs("p",{className:"text-2xl font-bold text-green-700",children:[Math.round((d+1)/o.length*100),"%"]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Order completion"})]}),a.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-5 shadow-md border border-purple-200",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-purple-500 flex items-center justify-center",children:a.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),a.jsx("h5",{className:"font-semibold text-gray-900",children:"Updates"})]}),a.jsx("p",{className:"text-2xl font-bold text-purple-700",children:x.length}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Status changes"})]})]}),a.jsx("style",{jsx:!0,children:`
        @keyframes slideDown {
          from {
            opacity: 0;
            transform: translateY(-20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        @keyframes fadeIn {
          from {
            opacity: 0;
          }
          to {
            opacity: 1;
          }
        }

        @keyframes slideIn {
          from {
            opacity: 0;
            transform: translateX(-20px);
          }
          to {
            opacity: 1;
            transform: translateX(0);
          }
        }

        @keyframes pulseGlow {
          0%, 100% {
            box-shadow: 0 0 20px rgba(255, 179, 0, 0.5);
          }
          50% {
            box-shadow: 0 0 40px rgba(255, 179, 0, 0.8);
          }
        }

        @keyframes bounceIn {
          0% {
            transform: scale(0.5);
            opacity: 0;
          }
          50% {
            transform: scale(1.1);
          }
          100% {
            transform: scale(1);
            opacity: 1;
          }
        }

        @keyframes checkmark {
          0% {
            transform: scale(0) rotate(-45deg);
            opacity: 0;
          }
          50% {
            transform: scale(1.2) rotate(0deg);
          }
          100% {
            transform: scale(1) rotate(0deg);
            opacity: 1;
          }
        }

        @keyframes shimmer {
          0% {
            background-position: -200% center;
          }
          100% {
            background-position: 200% center;
          }
        }

        .animate-slideDown {
          animation: slideDown 0.5s ease-out;
        }

        .animate-fadeIn {
          animation: fadeIn 0.6s ease-out;
        }

        .animate-slideIn {
          animation: slideIn 0.5s ease-out forwards;
          opacity: 0;
        }

        .animate-pulseGlow {
          animation: pulseGlow 2s ease-in-out infinite;
        }

        .animate-bounceIn {
          animation: bounceIn 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .animate-checkmark {
          animation: checkmark 0.4s ease-out;
        }

        .animate-shimmer {
          background-size: 200% 100%;
          animation: shimmer 3s linear infinite;
        }
      `})]})}function Wp({order:e,onRatingSubmitted:r}){var m,y,v;const[t,n]=ue.useState(((m=e==null?void 0:e.riderRating)==null?void 0:m.rating)||0),[s,o]=ue.useState(0),[l,c]=ue.useState(((y=e==null?void 0:e.riderRating)==null?void 0:y.feedback)||""),[d,h]=ue.useState(!1),u=!!(e!=null&&e.riderRating),g=async j=>{var w,N;if(j.preventDefault(),t===0){alert("Please select a rating");return}try{h(!0);const _=await pr.rateRider(e._id,{rating:t,feedback:l.trim()});_.success&&(alert("Thank you for rating the delivery agent!"),r&&r(_.data))}catch(_){console.error("Rating submission error:",_),alert(((N=(w=_.response)==null?void 0:w.data)==null?void 0:N.message)||"Failed to submit rating")}finally{h(!1)}},x=()=>a.jsx("div",{className:"flex items-center space-x-2",children:[1,2,3,4,5].map(j=>a.jsx("button",{type:"button",disabled:u||d,onMouseEnter:()=>!u&&o(j),onMouseLeave:()=>!u&&o(0),onClick:()=>!u&&n(j),className:`text-4xl transition-all transform ${u?"cursor-default":"cursor-pointer hover:scale-110"} ${j<=(s||t)?"animate-starPulse":""}`,children:j<=(s||t)?a.jsx("span",{className:"text-afri-yellow drop-shadow-lg",children:"â­"}):a.jsx("span",{className:"text-gray-300",children:"â˜†"})},j))});return e!=null&&e.rider?a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 space-y-6 animate-fadeIn",children:[a.jsxs("div",{className:"flex items-center space-x-4 pb-4 border-b",children:[a.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-afri-green to-afri-green-dark flex items-center justify-center text-white text-2xl font-bold shadow-lg",children:((v=e.rider.name)==null?void 0:v.charAt(0).toUpperCase())||"R"}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-afri-gray-900",children:u?"Your Rating":"Rate Delivery Agent"}),a.jsx("p",{className:"text-afri-gray-600",children:e.rider.name}),e.rider.phone&&a.jsx("p",{className:"text-sm text-afri-gray-500",children:e.rider.phone})]}),u&&a.jsx("div",{className:"ml-auto",children:a.jsxs("div",{className:"bg-green-100 text-green-800 px-4 py-2 rounded-lg font-semibold flex items-center",children:[a.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Rated"]})})]}),a.jsxs("form",{onSubmit:g,className:"space-y-6",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-3",children:"How was your delivery experience?"}),x(),a.jsx("div",{className:"mt-2",children:t>0&&a.jsxs("p",{className:"text-sm text-afri-gray-600 animate-slideDown",children:[t===5&&"ðŸŽ‰ Excellent!",t===4&&"ðŸ˜Š Great!",t===3&&"ðŸ‘ Good",t===2&&"ðŸ˜ Could be better",t===1&&"ðŸ˜ž Poor"]})})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:["Additional Feedback ",!u&&a.jsx("span",{className:"text-afri-gray-500 font-normal",children:"(Optional)"})]}),a.jsx("textarea",{value:l,onChange:j=>c(j.target.value),disabled:u||d,rows:4,placeholder:u?"No feedback provided":"Share your thoughts about the delivery service...",className:`w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent resize-none ${u?"bg-gray-50 cursor-default":""}`})]}),!u&&a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{type:"submit",disabled:d||t===0,className:"px-8 py-3 bg-gradient-to-r from-afri-green to-afri-green-dark text-white rounded-lg font-semibold shadow-lg hover:shadow-xl transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center",children:d?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Submitting..."]}):a.jsxs(a.Fragment,{children:[a.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})}),"Submit Rating"]})})}),u&&a.jsx("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-lg p-4 text-center",children:a.jsx("p",{className:"text-sm text-afri-gray-700",children:"Thank you for your feedback! Your rating helps us improve our delivery service."})})]}),a.jsx("style",{jsx:!0,children:`
        @keyframes fadeIn {
          from {
            opacity: 0;
            transform: translateY(10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        @keyframes slideDown {
          from {
            opacity: 0;
            transform: translateY(-10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        @keyframes starPulse {
          0%,
          100% {
            transform: scale(1);
          }
          50% {
            transform: scale(1.1);
          }
        }

        .animate-fadeIn {
          animation: fadeIn 0.5s ease-out;
        }

        .animate-slideDown {
          animation: slideDown 0.3s ease-out;
        }

        .animate-starPulse {
          animation: starPulse 0.3s ease-out;
        }
      `})]}):a.jsx("div",{className:"bg-gray-50 rounded-xl p-6 text-center",children:a.jsx("p",{className:"text-afri-gray-600",children:"No delivery agent assigned to this order"})})}const zp={pending:"bg-gradient-to-r from-yellow-400 to-yellow-500 text-gray-900",confirmed:"bg-gradient-to-r from-blue-500 to-blue-600 text-white",assigned_picker:"bg-gradient-to-r from-purple-500 to-purple-600 text-white",picking:"bg-gradient-to-r from-purple-600 to-purple-700 text-white",picked:"bg-gradient-to-r from-purple-700 to-purple-800 text-white",packing:"bg-gradient-to-r from-indigo-500 to-indigo-600 text-white",ready_for_pickup:"bg-gradient-to-r from-teal-500 to-teal-600 text-white",preparing:"bg-gradient-to-r from-orange-500 to-orange-600 text-white",ready:"bg-gradient-to-r from-green-600 to-green-700 text-white","out-for-delivery":"bg-gradient-to-r from-blue-600 to-blue-700 text-white",delivered:"bg-gradient-to-r from-green-700 to-green-800 text-white",completed:"bg-gradient-to-r from-gray-700 to-gray-800 text-white",cancelled:"bg-gradient-to-r from-red-500 to-red-600 text-white"},qp={pending:"Pending",confirmed:"Confirmed",assigned_picker:"Picker Assigned",picking:"Picking Items",picked:"Items Picked",packing:"Packing",ready_for_pickup:"Ready for Pickup",preparing:"Preparing",ready:"Ready","out-for-delivery":"Out for Delivery",delivered:"Delivered",completed:"Completed",cancelled:"Cancelled"};function Vp({order:e,onClose:r,onStatusUpdate:t,onRefresh:n}){var v,j,w,N,_,C,M,D,L,E,P,H,k,T,W,G,de,J,Z,oe,ae,pe;const[s,o]=ue.useState("details"),[l,c]=ue.useState([]),[d,h]=ue.useState(!1);ue.useEffect(()=>{if(e.status==="packing"||e.status==="picking"){const be=e.items.map(A=>({itemId:A._id||A.productId,packed:!1}));c(be)}},[e]);const u=async(be,A="")=>{h(!0);try{await t(e._id,be,A),n&&await n()}catch(O){console.error("Error updating status:",O)}finally{h(!1)}},g=be=>{c(be),be.every(O=>O.packed)&&u("ready_for_pickup","All items packed and ready")},x=async be=>{try{await u("assigned_picker",`Picker ${be} assigned`)}catch(A){console.error("Error assigning picker:",A)}},m=e.items.reduce((be,A)=>be+A.quantity,0),y=Math.ceil(m*2);return a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fadeIn",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-6xl w-full max-h-[95vh] overflow-hidden flex flex-col animate-slideUp",children:[a.jsx("div",{className:"bg-gradient-to-r from-[#FFB300] to-[#FFA726] text-gray-900 p-6",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-3xl font-bold",children:e.orderNumber}),a.jsxs("p",{className:"text-gray-800 mt-1 text-sm",children:["Placed on ",new Date(e.createdAt).toLocaleString("en-GB",{dateStyle:"medium",timeStyle:"short"})]}),a.jsxs("div",{className:"mt-2 flex items-center gap-3",children:[a.jsx("span",{className:`px-4 py-1.5 inline-flex text-sm font-semibold rounded-full shadow-lg ${zp[e.status]}`,children:qp[e.status]}),a.jsxs("span",{className:"text-sm text-gray-800",children:[m," items â€¢ Est. ",y," mins"]})]})]}),a.jsx("button",{onClick:r,className:"text-gray-900 hover:text-gray-700 transition-all hover:rotate-90 duration-300",children:a.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})]})}),a.jsx("div",{className:"border-b border-gray-200 bg-gray-50",children:a.jsx("div",{className:"flex overflow-x-auto",children:[{id:"details",label:"Order Details",icon:"ðŸ“‹"},{id:"timeline",label:"Timeline",icon:"ðŸ“"},{id:"packing",label:"Packing",icon:"ðŸ“¦",show:["packing","picking","assigned_picker"].includes(e.status)},{id:"picker",label:"Picker",icon:"ðŸ‘¤",show:["pending","confirmed"].includes(e.status)},{id:"rating",label:"Rate Rider",icon:"â­",show:["delivered","completed"].includes(e.status)}].map(be=>be.show===!1||be.show&&!be.show?null:a.jsxs("button",{onClick:()=>o(be.id),className:`px-6 py-4 text-sm font-medium transition-all duration-200 border-b-2 whitespace-nowrap ${s===be.id?"border-[#FFB300] text-[#FFB300] bg-white":"border-transparent text-gray-600 hover:text-[#FFB300] hover:bg-gray-100"}`,children:[a.jsx("span",{className:"mr-2",children:be.icon}),be.label]},be.id))})}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[s==="details"&&a.jsxs("div",{className:"space-y-6",children:[a.jsx(Up,{order:e,onStatusUpdate:u,isUpdating:d}),a.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-6 shadow-sm border border-gray-200",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[a.jsx("svg",{className:"w-5 h-5 text-[#00897B]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Customer Information"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Name"}),a.jsx("p",{className:"font-semibold text-gray-900",children:((v=e.deliveryAddress)==null?void 0:v.fullName)||((j=e.customer)==null?void 0:j.name)||"N/A"})]}),a.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Phone"}),a.jsx("p",{className:"font-semibold text-gray-900",children:((w=e.deliveryAddress)==null?void 0:w.phone)||((N=e.customer)==null?void 0:N.phone)||"N/A"})]}),a.jsxs("div",{className:"col-span-1 md:col-span-2 bg-white rounded-lg p-4 shadow-sm",children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Delivery Address"}),a.jsxs("p",{className:"font-semibold text-gray-900",children:[(_=e.deliveryAddress)==null?void 0:_.street,", ",(C=e.deliveryAddress)==null?void 0:C.city,", ",(M=e.deliveryAddress)==null?void 0:M.state," ",(D=e.deliveryAddress)==null?void 0:D.postalCode]}),((L=e.deliveryAddress)==null?void 0:L.instructions)&&a.jsx("div",{className:"mt-2 p-3 bg-yellow-50 border-l-4 border-[#FFB300] rounded",children:a.jsxs("p",{className:"text-sm text-gray-700",children:[a.jsx("span",{className:"font-semibold",children:"Delivery Note:"})," ",e.deliveryAddress.instructions]})})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden",children:[a.jsx("div",{className:"bg-gradient-to-r from-[#00897B] to-[#26A69A] text-white px-6 py-4",children:a.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),"Order Items (",((E=e.items)==null?void 0:E.length)||0,")"]})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Product"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Price"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Quantity"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Subtotal"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(P=e.items)==null?void 0:P.map((be,A)=>{var O,I;return a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[be.image&&a.jsx("img",{src:be.image,alt:be.name,className:"w-12 h-12 object-cover rounded-lg shadow-sm"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:be.name}),be.notes&&a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Note: ",be.notes]})]})]})}),a.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:["Â£",(O=be.price)==null?void 0:O.toFixed(2)]}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:a.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full bg-gray-100 font-medium",children:[be.quantity," ",be.unit]})}),a.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900 text-right font-semibold",children:["Â£",(I=be.subtotal)==null?void 0:I.toFixed(2)]})]},A)})})]})})]}),a.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-6 shadow-lg border border-gray-200",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Subtotal"}),a.jsxs("span",{className:"text-gray-900 font-medium",children:["Â£",(k=(H=e.pricing)==null?void 0:H.subtotal)==null?void 0:k.toFixed(2)]})]}),((T=e.pricing)==null?void 0:T.deliveryFee)>0&&a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Delivery Fee"}),a.jsxs("span",{className:"text-gray-900 font-medium",children:["Â£",e.pricing.deliveryFee.toFixed(2)]})]}),((W=e.pricing)==null?void 0:W.tax)>0&&a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Tax (VAT)"}),a.jsxs("span",{className:"text-gray-900 font-medium",children:["Â£",e.pricing.tax.toFixed(2)]})]}),((G=e.pricing)==null?void 0:G.discount)>0&&a.jsxs("div",{className:"flex justify-between text-sm text-[#00897B]",children:[a.jsx("span",{children:"Discount"}),a.jsxs("span",{className:"font-medium",children:["-Â£",e.pricing.discount.toFixed(2)]})]}),a.jsxs("div",{className:"border-t-2 border-gray-300 pt-3 flex justify-between items-center",children:[a.jsx("span",{className:"font-bold text-lg text-gray-900",children:"Total"}),a.jsxs("span",{className:"font-bold text-2xl text-[#00897B]",children:["Â£",(J=(de=e.pricing)==null?void 0:de.total)==null?void 0:J.toFixed(2)]})]})]}),a.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-300 flex flex-wrap items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm text-gray-500",children:"Payment Method:"}),a.jsx("span",{className:"font-semibold text-gray-900 capitalize px-3 py-1 bg-white rounded-lg shadow-sm",children:((Z=e.payment)==null?void 0:Z.method)||"N/A"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm text-gray-500",children:"Status:"}),a.jsx("span",{className:`font-semibold px-3 py-1 rounded-lg shadow-sm ${((oe=e.payment)==null?void 0:oe.status)==="paid"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:((pe=(ae=e.payment)==null?void 0:ae.status)==null?void 0:pe.toUpperCase())||"PENDING"})]})]})]})]}),s==="timeline"&&a.jsx(Hp,{order:e}),s==="packing"&&a.jsx(Mp,{order:e,onPackingComplete:g,onStatusUpdate:u}),s==="picker"&&a.jsx(Bp,{order:e,onPickerAssigned:x}),s==="rating"&&a.jsx(Wp,{order:e,onRatingSubmitted:n})]}),a.jsxs("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200 flex justify-between items-center",children:[a.jsxs("div",{className:"text-sm text-gray-600",children:["Last updated: ",new Date(e.updatedAt||e.createdAt).toLocaleString("en-GB",{dateStyle:"short",timeStyle:"short"})]}),a.jsx("button",{onClick:r,className:"px-6 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium rounded-lg transition-all duration-200 shadow-sm hover:shadow-md",children:"Close"})]})]})})}const Gp={pending:"bg-gradient-to-r from-yellow-400 to-yellow-500 text-gray-900",confirmed:"bg-gradient-to-r from-blue-500 to-blue-600 text-white",assigned_picker:"bg-gradient-to-r from-purple-500 to-purple-600 text-white",picking:"bg-gradient-to-r from-purple-600 to-purple-700 text-white",picked:"bg-gradient-to-r from-purple-700 to-purple-800 text-white",packing:"bg-gradient-to-r from-indigo-500 to-indigo-600 text-white",ready_for_pickup:"bg-gradient-to-r from-teal-500 to-teal-600 text-white",preparing:"bg-gradient-to-r from-orange-500 to-orange-600 text-white",ready:"bg-gradient-to-r from-green-600 to-green-700 text-white","out-for-delivery":"bg-gradient-to-r from-blue-600 to-blue-700 text-white",delivered:"bg-gradient-to-r from-green-700 to-green-800 text-white",completed:"bg-gradient-to-r from-gray-700 to-gray-800 text-white",cancelled:"bg-gradient-to-r from-red-500 to-red-600 text-white"},ff={pending:"Pending",confirmed:"Confirmed",assigned_picker:"Picker Assigned",picking:"Picking Items",picked:"Items Picked",packing:"Packing",ready_for_pickup:"Ready for Pickup",preparing:"Preparing",ready:"Ready","out-for-delivery":"Out for Delivery",delivered:"Delivered",completed:"Completed",cancelled:"Cancelled"};function $p(){const[e,r]=ue.useState([]),[t,n]=ue.useState(!0),[s,o]=ue.useState(null),[l,c]=ue.useState(!1),[d,h]=ue.useState({status:"",search:"",page:1,limit:20}),[u,g]=ue.useState({total:0,pages:0,currentPage:1});ue.useEffect(()=>{x()},[d]);const x=async()=>{try{n(!0);const w=await pr.getOrders(d);w.success&&(r(w.data.orders),g(w.data.pagination))}catch(w){console.error("Error fetching orders:",w)}finally{n(!1)}},m=w=>{h({...d,status:w===d.status?"":w,page:1})},y=w=>{h({...d,search:w.target.value,page:1})},v=async w=>{try{const N=await pr.getOrder(w);N.success&&(o(N.data.order),c(!0))}catch(N){console.error("Error fetching order details:",N)}},j=async(w,N,_="")=>{var C,M;try{if((await pr.updateOrderStatus(w,{status:N,note:_})).success&&(x(),s&&s._id===w)){const L=await pr.getOrder(w);L.success&&o(L.data.order)}}catch(D){console.error("Error updating order status:",D),alert(((M=(C=D.response)==null?void 0:C.data)==null?void 0:M.message)||"Failed to update order status")}};return a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h1",{className:"text-3xl font-bold text-afri-gray-900",children:"Orders"}),a.jsx("p",{className:"text-afri-gray-600 mt-1",children:"Manage and track all your orders"})]}),a.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:a.jsxs("div",{className:"flex flex-wrap gap-4",children:[a.jsx("div",{className:"flex-1 min-w-[250px]",children:a.jsx("input",{type:"text",placeholder:"Search by order number...",value:d.search,onChange:y,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent"})}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[["pending","confirmed","preparing","ready","out-for-delivery","delivered"].map(w=>a.jsx("button",{onClick:()=>m(w),className:`px-4 py-2 rounded-lg font-medium transition ${d.status===w?"bg-afri-green text-white":"bg-afri-gray-50 text-afri-gray-700 hover:bg-afri-gray-100"}`,children:ff[w]},w)),d.status&&a.jsx("button",{onClick:()=>h({...d,status:""}),className:"px-4 py-2 rounded-lg font-medium bg-red-100 text-red-700 hover:bg-red-200",children:"Clear Filter"})]})]})}),t?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-afri-green"})}):e.length===0?a.jsxs("div",{className:"bg-white rounded-lg shadow p-12 text-center",children:[a.jsx("svg",{className:"w-16 h-16 text-afri-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),a.jsx("h3",{className:"text-lg font-medium text-afri-gray-900 mb-1",children:"No orders found"}),a.jsx("p",{className:"text-afri-gray-500",children:d.status||d.search?"Try adjusting your filters":"Orders will appear here"})]}):a.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-afri-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Order Number"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Customer"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Items"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Total"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Date"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(w=>{var N,_,C,M,D;return a.jsxs("tr",{className:"hover:bg-afri-gray-50 transition",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("div",{className:"text-sm font-medium text-afri-gray-900",children:w.orderNumber})}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[a.jsx("div",{className:"text-sm text-afri-gray-900",children:((N=w.customer)==null?void 0:N.name)||"N/A"}),a.jsx("div",{className:"text-sm text-afri-gray-500",children:((_=w.customer)==null?void 0:_.phone)||""})]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"text-sm text-afri-gray-900",children:[((C=w.items)==null?void 0:C.length)||0," items"]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"text-sm font-medium text-afri-gray-900",children:["Â£",((D=(M=w.pricing)==null?void 0:M.total)==null?void 0:D.toFixed(2))||"0.00"]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${Gp[w.status]}`,children:ff[w.status]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-afri-gray-500",children:new Date(w.createdAt).toLocaleDateString()}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:a.jsx("button",{onClick:()=>v(w._id),className:"text-afri-green hover:text-afri-green-dark font-medium",children:"View Details"})})]},w._id)})})]})}),u.pages>1&&a.jsx("div",{className:"mt-6 flex justify-center",children:a.jsx("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[...Array(u.pages)].map((w,N)=>a.jsx("button",{onClick:()=>h({...d,page:N+1}),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${u.currentPage===N+1?"z-10 bg-afri-green text-white border-afri-green":"bg-white border-gray-300 text-afri-gray-700 hover:bg-afri-gray-50"}`,children:N+1},N))})}),l&&s&&a.jsx(Vp,{order:s,onClose:()=>{c(!1),o(null)},onStatusUpdate:j,onRefresh:x})]})}const Yp="modulepreload",Xp=function(e){return"/afrimercato-frontend/"+e},hf={},D0=function(r,t,n){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));s=Promise.allSettled(t.map(d=>{if(d=Xp(d),d in hf)return;hf[d]=!0;const h=d.endsWith(".css"),u=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${u}`))return;const g=document.createElement("link");if(g.rel=h?"stylesheet":Yp,h||(g.as="script"),g.crossOrigin="",g.href=d,c&&g.setAttribute("nonce",c),document.head.appendChild(g),h)return new Promise((x,m)=>{g.addEventListener("load",x),g.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${d}`)))})}))}function o(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return s.then(l=>{for(const c of l||[])c.status==="rejected"&&o(c.reason);return r().catch(o)})};var sn=Uint8Array,Rn=Uint16Array,td=Int32Array,xc=new sn([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),gc=new sn([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),R0=new sn([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),_h=function(e,r){for(var t=new Rn(31),n=0;n<31;++n)t[n]=r+=1<<e[n-1];for(var s=new td(t[30]),n=1;n<30;++n)for(var o=t[n];o<t[n+1];++o)s[o]=o-t[n]<<5|n;return{b:t,r:s}},Ah=_h(xc,2),kh=Ah.b,M0=Ah.r;kh[28]=258,M0[258]=28;var Th=_h(gc,0),Kp=Th.b,uf=Th.r,B0=new Rn(32768);for(var or=0;or<32768;++or){var fs=(or&43690)>>1|(or&21845)<<1;fs=(fs&52428)>>2|(fs&13107)<<2,fs=(fs&61680)>>4|(fs&3855)<<4,B0[or]=((fs&65280)>>8|(fs&255)<<8)>>1}var Ea=function(e,r,t){for(var n=e.length,s=0,o=new Rn(r);s<n;++s)e[s]&&++o[e[s]-1];var l=new Rn(r);for(s=1;s<r;++s)l[s]=l[s-1]+o[s-1]<<1;var c;if(t){c=new Rn(1<<r);var d=15-r;for(s=0;s<n;++s)if(e[s])for(var h=s<<4|e[s],u=r-e[s],g=l[e[s]-1]++<<u,x=g|(1<<u)-1;g<=x;++g)c[B0[g]>>d]=h}else for(c=new Rn(n),s=0;s<n;++s)e[s]&&(c[s]=B0[l[e[s]-1]++]>>15-e[s]);return c},bs=new sn(288);for(var or=0;or<144;++or)bs[or]=8;for(var or=144;or<256;++or)bs[or]=9;for(var or=256;or<280;++or)bs[or]=7;for(var or=280;or<288;++or)bs[or]=8;var Po=new sn(32);for(var or=0;or<32;++or)Po[or]=5;var Jp=Ea(bs,9,0),Zp=Ea(bs,9,1),Qp=Ea(Po,5,0),ex=Ea(Po,5,1),x0=function(e){for(var r=e[0],t=1;t<e.length;++t)e[t]>r&&(r=e[t]);return r},ia=function(e,r,t){var n=r/8|0;return(e[n]|e[n+1]<<8)>>(r&7)&t},g0=function(e,r){var t=r/8|0;return(e[t]|e[t+1]<<8|e[t+2]<<16)>>(r&7)},rd=function(e){return(e+7)/8|0},Ch=function(e,r,t){return(t==null||t>e.length)&&(t=e.length),new sn(e.subarray(r,t))},tx=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],da=function(e,r,t){var n=new Error(r||tx[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,da),!t)throw n;return n},rx=function(e,r,t,n){var s=e.length,o=0;if(!s||r.f&&!r.l)return t||new sn(0);var l=!t,c=l||r.i!=2,d=r.i;l&&(t=new sn(s*3));var h=function(Ce){var Ie=t.length;if(Ce>Ie){var Ve=new sn(Math.max(Ie*2,Ce));Ve.set(t),t=Ve}},u=r.f||0,g=r.p||0,x=r.b||0,m=r.l,y=r.d,v=r.m,j=r.n,w=s*8;do{if(!m){u=ia(e,g,1);var N=ia(e,g+1,3);if(g+=3,N)if(N==1)m=Zp,y=ex,v=9,j=5;else if(N==2){var D=ia(e,g,31)+257,L=ia(e,g+10,15)+4,E=D+ia(e,g+5,31)+1;g+=14;for(var P=new sn(E),H=new sn(19),k=0;k<L;++k)H[R0[k]]=ia(e,g+k*3,7);g+=L*3;for(var T=x0(H),W=(1<<T)-1,G=Ea(H,T,1),k=0;k<E;){var de=G[ia(e,g,W)];g+=de&15;var _=de>>4;if(_<16)P[k++]=_;else{var J=0,Z=0;for(_==16?(Z=3+ia(e,g,3),g+=2,J=P[k-1]):_==17?(Z=3+ia(e,g,7),g+=3):_==18&&(Z=11+ia(e,g,127),g+=7);Z--;)P[k++]=J}}var oe=P.subarray(0,D),ae=P.subarray(D);v=x0(oe),j=x0(ae),m=Ea(oe,v,1),y=Ea(ae,j,1)}else da(1);else{var _=rd(g)+4,C=e[_-4]|e[_-3]<<8,M=_+C;if(M>s){d&&da(0);break}c&&h(x+C),t.set(e.subarray(_,M),x),r.b=x+=C,r.p=g=M*8,r.f=u;continue}if(g>w){d&&da(0);break}}c&&h(x+131072);for(var pe=(1<<v)-1,be=(1<<j)-1,A=g;;A=g){var J=m[g0(e,g)&pe],O=J>>4;if(g+=J&15,g>w){d&&da(0);break}if(J||da(2),O<256)t[x++]=O;else if(O==256){A=g,m=null;break}else{var I=O-254;if(O>264){var k=O-257,R=xc[k];I=ia(e,g,(1<<R)-1)+kh[k],g+=R}var X=y[g0(e,g)&be],fe=X>>4;X||da(3),g+=X&15;var ae=Kp[fe];if(fe>3){var R=gc[fe];ae+=g0(e,g)&(1<<R)-1,g+=R}if(g>w){d&&da(0);break}c&&h(x+131072);var he=x+I;if(x<ae){var ee=o-ae,ve=Math.min(ae,he);for(ee+x<0&&da(3);x<ve;++x)t[x]=n[ee+x]}for(;x<he;++x)t[x]=t[x-ae]}}r.l=m,r.p=A,r.b=x,r.f=u,m&&(u=1,r.m=v,r.d=y,r.n=j)}while(!u);return x!=t.length&&l?Ch(t,0,x):t.subarray(0,x)},qa=function(e,r,t){t<<=r&7;var n=r/8|0;e[n]|=t,e[n+1]|=t>>8},vo=function(e,r,t){t<<=r&7;var n=r/8|0;e[n]|=t,e[n+1]|=t>>8,e[n+2]|=t>>16},v0=function(e,r){for(var t=[],n=0;n<e.length;++n)e[n]&&t.push({s:n,f:e[n]});var s=t.length,o=t.slice();if(!s)return{t:Fh,l:0};if(s==1){var l=new sn(t[0].s+1);return l[t[0].s]=1,{t:l,l:1}}t.sort(function(M,D){return M.f-D.f}),t.push({s:-1,f:25001});var c=t[0],d=t[1],h=0,u=1,g=2;for(t[0]={s:-1,f:c.f+d.f,l:c,r:d};u!=s-1;)c=t[t[h].f<t[g].f?h++:g++],d=t[h!=u&&t[h].f<t[g].f?h++:g++],t[u++]={s:-1,f:c.f+d.f,l:c,r:d};for(var x=o[0].s,n=1;n<s;++n)o[n].s>x&&(x=o[n].s);var m=new Rn(x+1),y=U0(t[u-1],m,0);if(y>r){var n=0,v=0,j=y-r,w=1<<j;for(o.sort(function(D,L){return m[L.s]-m[D.s]||D.f-L.f});n<s;++n){var N=o[n].s;if(m[N]>r)v+=w-(1<<y-m[N]),m[N]=r;else break}for(v>>=j;v>0;){var _=o[n].s;m[_]<r?v-=1<<r-m[_]++-1:++n}for(;n>=0&&v;--n){var C=o[n].s;m[C]==r&&(--m[C],++v)}y=r}return{t:new sn(m),l:y}},U0=function(e,r,t){return e.s==-1?Math.max(U0(e.l,r,t+1),U0(e.r,r,t+1)):r[e.s]=t},mf=function(e){for(var r=e.length;r&&!e[--r];);for(var t=new Rn(++r),n=0,s=e[0],o=1,l=function(d){t[n++]=d},c=1;c<=r;++c)if(e[c]==s&&c!=r)++o;else{if(!s&&o>2){for(;o>138;o-=138)l(32754);o>2&&(l(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(l(s),--o;o>6;o-=6)l(8304);o>2&&(l(o-3<<5|8208),o=0)}for(;o--;)l(s);o=1,s=e[c]}return{c:t.subarray(0,n),n:r}},yo=function(e,r){for(var t=0,n=0;n<r.length;++n)t+=e[n]*r[n];return t},Eh=function(e,r,t){var n=t.length,s=rd(r+2);e[s]=n&255,e[s+1]=n>>8,e[s+2]=e[s]^255,e[s+3]=e[s+1]^255;for(var o=0;o<n;++o)e[s+o+4]=t[o];return(s+4+n)*8},pf=function(e,r,t,n,s,o,l,c,d,h,u){qa(r,u++,t),++s[256];for(var g=v0(s,15),x=g.t,m=g.l,y=v0(o,15),v=y.t,j=y.l,w=mf(x),N=w.c,_=w.n,C=mf(v),M=C.c,D=C.n,L=new Rn(19),E=0;E<N.length;++E)++L[N[E]&31];for(var E=0;E<M.length;++E)++L[M[E]&31];for(var P=v0(L,7),H=P.t,k=P.l,T=19;T>4&&!H[R0[T-1]];--T);var W=h+5<<3,G=yo(s,bs)+yo(o,Po)+l,de=yo(s,x)+yo(o,v)+l+14+3*T+yo(L,H)+2*L[16]+3*L[17]+7*L[18];if(d>=0&&W<=G&&W<=de)return Eh(r,u,e.subarray(d,d+h));var J,Z,oe,ae;if(qa(r,u,1+(de<G)),u+=2,de<G){J=Ea(x,m,0),Z=x,oe=Ea(v,j,0),ae=v;var pe=Ea(H,k,0);qa(r,u,_-257),qa(r,u+5,D-1),qa(r,u+10,T-4),u+=14;for(var E=0;E<T;++E)qa(r,u+3*E,H[R0[E]]);u+=3*T;for(var be=[N,M],A=0;A<2;++A)for(var O=be[A],E=0;E<O.length;++E){var I=O[E]&31;qa(r,u,pe[I]),u+=H[I],I>15&&(qa(r,u,O[E]>>5&127),u+=O[E]>>12)}}else J=Jp,Z=bs,oe=Qp,ae=Po;for(var E=0;E<c;++E){var R=n[E];if(R>255){var I=R>>18&31;vo(r,u,J[I+257]),u+=Z[I+257],I>7&&(qa(r,u,R>>23&31),u+=xc[I]);var X=R&31;vo(r,u,oe[X]),u+=ae[X],X>3&&(vo(r,u,R>>5&8191),u+=gc[X])}else vo(r,u,J[R]),u+=Z[R]}return vo(r,u,J[256]),u+Z[256]},nx=new td([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Fh=new sn(0),ax=function(e,r,t,n,s,o){var l=o.z||e.length,c=new sn(n+l+5*(1+Math.ceil(l/7e3))+s),d=c.subarray(n,c.length-s),h=o.l,u=(o.r||0)&7;if(r){u&&(d[0]=o.r>>3);for(var g=nx[r-1],x=g>>13,m=g&8191,y=(1<<t)-1,v=o.p||new Rn(32768),j=o.h||new Rn(y+1),w=Math.ceil(t/3),N=2*w,_=function($e){return(e[$e]^e[$e+1]<<w^e[$e+2]<<N)&y},C=new td(25e3),M=new Rn(288),D=new Rn(32),L=0,E=0,P=o.i||0,H=0,k=o.w||0,T=0;P+2<l;++P){var W=_(P),G=P&32767,de=j[W];if(v[G]=de,j[W]=G,k<=P){var J=l-P;if((L>7e3||H>24576)&&(J>423||!h)){u=pf(e,d,0,C,M,D,E,H,T,P-T,u),H=L=E=0,T=P;for(var Z=0;Z<286;++Z)M[Z]=0;for(var Z=0;Z<30;++Z)D[Z]=0}var oe=2,ae=0,pe=m,be=G-de&32767;if(J>2&&W==_(P-be))for(var A=Math.min(x,J)-1,O=Math.min(32767,P),I=Math.min(258,J);be<=O&&--pe&&G!=de;){if(e[P+oe]==e[P+oe-be]){for(var R=0;R<I&&e[P+R]==e[P+R-be];++R);if(R>oe){if(oe=R,ae=be,R>A)break;for(var X=Math.min(be,R-2),fe=0,Z=0;Z<X;++Z){var he=P-be+Z&32767,ee=v[he],ve=he-ee&32767;ve>fe&&(fe=ve,de=he)}}}G=de,de=v[G],be+=G-de&32767}if(ae){C[H++]=268435456|M0[oe]<<18|uf[ae];var Ce=M0[oe]&31,Ie=uf[ae]&31;E+=xc[Ce]+gc[Ie],++M[257+Ce],++D[Ie],k=P+oe,++L}else C[H++]=e[P],++M[e[P]]}}for(P=Math.max(P,k);P<l;++P)C[H++]=e[P],++M[e[P]];u=pf(e,d,h,C,M,D,E,H,T,P-T,u),h||(o.r=u&7|d[u/8|0]<<3,u-=7,o.h=j,o.p=v,o.i=P,o.w=k)}else{for(var P=o.w||0;P<l+h;P+=65535){var Ve=P+65535;Ve>=l&&(d[u/8|0]=h,Ve=l),u=Eh(d,u+1,e.subarray(P,Ve))}o.i=l}return Ch(c,0,n+rd(u)+s)},Lh=function(){var e=1,r=0;return{p:function(t){for(var n=e,s=r,o=t.length|0,l=0;l!=o;){for(var c=Math.min(l+2655,o);l<c;++l)s+=n+=t[l];n=(n&65535)+15*(n>>16),s=(s&65535)+15*(s>>16)}e=n,r=s},d:function(){return e%=65521,r%=65521,(e&255)<<24|(e&65280)<<8|(r&255)<<8|r>>8}}},sx=function(e,r,t,n,s){if(!s&&(s={l:1},r.dictionary)){var o=r.dictionary.subarray(-32768),l=new sn(o.length+e.length);l.set(o),l.set(e,o.length),e=l,s.w=o.length}return ax(e,r.level==null?6:r.level,r.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+r.mem,t,n,s)},Ph=function(e,r,t){for(;t;++r)e[r]=t,t>>>=8},ix=function(e,r){var t=r.level,n=t==0?0:t<6?1:t==9?3:2;if(e[0]=120,e[1]=n<<6|(r.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,r.dictionary){var s=Lh();s.p(r.dictionary),Ph(e,2,s.d())}},ox=function(e,r){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&da(6,"invalid zlib data"),(e[1]>>5&1)==1&&da(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function H0(e,r){r||(r={});var t=Lh();t.p(e);var n=sx(e,r,r.dictionary?6:2,4);return ix(n,r),Ph(n,n.length-4,t.d()),n}function lx(e,r){return rx(e.subarray(ox(e),-4),{i:2},r,r)}var cx=typeof TextDecoder<"u"&&new TextDecoder,dx=0;try{cx.decode(Fh,{stream:!0}),dx=1}catch{}var yt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function y0(){yt.console&&typeof yt.console.log=="function"&&yt.console.log.apply(yt.console,arguments)}var tr={log:y0,warn:function(e){yt.console&&(typeof yt.console.warn=="function"?yt.console.warn.apply(yt.console,arguments):y0.call(null,arguments))},error:function(e){yt.console&&(typeof yt.console.error=="function"?yt.console.error.apply(yt.console,arguments):y0(e))}};function b0(e,r,t){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){Ds(n.response,r,t)},n.onerror=function(){tr.error("could not download file")},n.send()}function xf(e){var r=new XMLHttpRequest;r.open("HEAD",e,!1);try{r.send()}catch{}return r.status>=200&&r.status<=299}function Ul(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(r)}}var No,W0,Ds=yt.saveAs||((typeof window>"u"?"undefined":rr(window))!=="object"||window!==yt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,r,t){var n=yt.URL||yt.webkitURL,s=document.createElement("a");r=r||e.name||"download",s.download=r,s.rel="noopener",typeof e=="string"?(s.href=e,s.origin!==location.origin?xf(s.href)?b0(e,r,t):Ul(s,s.target="_blank"):Ul(s)):(s.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(s.href)},4e4),setTimeout(function(){Ul(s)},0))}:"msSaveOrOpenBlob"in navigator?function(e,r,t){if(r=r||e.name||"download",typeof e=="string")if(xf(e))b0(e,r,t);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){Ul(n)})}else navigator.msSaveOrOpenBlob(function(s,o){return o===void 0?o={autoBom:!1}:rr(o)!=="object"&&(tr.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}(e,t),r)}:function(e,r,t,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return b0(e,r,t);var s=e.type==="application/octet-stream",o=/constructor/i.test(yt.HTMLElement)||yt.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||s&&o)&&(typeof FileReader>"u"?"undefined":rr(FileReader))==="object"){var c=new FileReader;c.onloadend=function(){var u=c.result;u=l?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=u:location=u,n=null},c.readAsDataURL(e)}else{var d=yt.URL||yt.webkitURL,h=d.createObjectURL(e);n?n.location=h:location.href=h,n=null,setTimeout(function(){d.revokeObjectURL(h)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function Oh(e){var r;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(c){return[parseInt(c[1]),parseInt(c[2]),parseInt(c[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(c){return[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(c){return[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)]}}],n=0;n<t.length;n++){var s=t[n].re,o=t[n].process,l=s.exec(e);l&&(r=o(l),this.r=r[0],this.g=r[1],this.b=r[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var c=this.r.toString(16),d=this.g.toString(16),h=this.b.toString(16);return c.length==1&&(c="0"+c),d.length==1&&(d="0"+d),h.length==1&&(h="0"+h),"#"+c+d+h}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function w0(e,r){var t=e[0],n=e[1],s=e[2],o=e[3];t=tn(t,n,s,o,r[0],7,-680876936),o=tn(o,t,n,s,r[1],12,-389564586),s=tn(s,o,t,n,r[2],17,606105819),n=tn(n,s,o,t,r[3],22,-1044525330),t=tn(t,n,s,o,r[4],7,-176418897),o=tn(o,t,n,s,r[5],12,1200080426),s=tn(s,o,t,n,r[6],17,-1473231341),n=tn(n,s,o,t,r[7],22,-45705983),t=tn(t,n,s,o,r[8],7,1770035416),o=tn(o,t,n,s,r[9],12,-1958414417),s=tn(s,o,t,n,r[10],17,-42063),n=tn(n,s,o,t,r[11],22,-1990404162),t=tn(t,n,s,o,r[12],7,1804603682),o=tn(o,t,n,s,r[13],12,-40341101),s=tn(s,o,t,n,r[14],17,-1502002290),t=rn(t,n=tn(n,s,o,t,r[15],22,1236535329),s,o,r[1],5,-165796510),o=rn(o,t,n,s,r[6],9,-1069501632),s=rn(s,o,t,n,r[11],14,643717713),n=rn(n,s,o,t,r[0],20,-373897302),t=rn(t,n,s,o,r[5],5,-701558691),o=rn(o,t,n,s,r[10],9,38016083),s=rn(s,o,t,n,r[15],14,-660478335),n=rn(n,s,o,t,r[4],20,-405537848),t=rn(t,n,s,o,r[9],5,568446438),o=rn(o,t,n,s,r[14],9,-1019803690),s=rn(s,o,t,n,r[3],14,-187363961),n=rn(n,s,o,t,r[8],20,1163531501),t=rn(t,n,s,o,r[13],5,-1444681467),o=rn(o,t,n,s,r[2],9,-51403784),s=rn(s,o,t,n,r[7],14,1735328473),t=nn(t,n=rn(n,s,o,t,r[12],20,-1926607734),s,o,r[5],4,-378558),o=nn(o,t,n,s,r[8],11,-2022574463),s=nn(s,o,t,n,r[11],16,1839030562),n=nn(n,s,o,t,r[14],23,-35309556),t=nn(t,n,s,o,r[1],4,-1530992060),o=nn(o,t,n,s,r[4],11,1272893353),s=nn(s,o,t,n,r[7],16,-155497632),n=nn(n,s,o,t,r[10],23,-1094730640),t=nn(t,n,s,o,r[13],4,681279174),o=nn(o,t,n,s,r[0],11,-358537222),s=nn(s,o,t,n,r[3],16,-722521979),n=nn(n,s,o,t,r[6],23,76029189),t=nn(t,n,s,o,r[9],4,-640364487),o=nn(o,t,n,s,r[12],11,-421815835),s=nn(s,o,t,n,r[15],16,530742520),t=an(t,n=nn(n,s,o,t,r[2],23,-995338651),s,o,r[0],6,-198630844),o=an(o,t,n,s,r[7],10,1126891415),s=an(s,o,t,n,r[14],15,-1416354905),n=an(n,s,o,t,r[5],21,-57434055),t=an(t,n,s,o,r[12],6,1700485571),o=an(o,t,n,s,r[3],10,-1894986606),s=an(s,o,t,n,r[10],15,-1051523),n=an(n,s,o,t,r[1],21,-2054922799),t=an(t,n,s,o,r[8],6,1873313359),o=an(o,t,n,s,r[15],10,-30611744),s=an(s,o,t,n,r[6],15,-1560198380),n=an(n,s,o,t,r[13],21,1309151649),t=an(t,n,s,o,r[4],6,-145523070),o=an(o,t,n,s,r[11],10,-1120210379),s=an(s,o,t,n,r[2],15,718787259),n=an(n,s,o,t,r[9],21,-343485551),e[0]=xs(t,e[0]),e[1]=xs(n,e[1]),e[2]=xs(s,e[2]),e[3]=xs(o,e[3])}function vc(e,r,t,n,s,o){return r=xs(xs(r,e),xs(n,o)),xs(r<<s|r>>>32-s,t)}function tn(e,r,t,n,s,o,l){return vc(r&t|~r&n,e,r,s,o,l)}function rn(e,r,t,n,s,o,l){return vc(r&n|t&~n,e,r,s,o,l)}function nn(e,r,t,n,s,o,l){return vc(r^t^n,e,r,s,o,l)}function an(e,r,t,n,s,o,l){return vc(t^(r|~n),e,r,s,o,l)}function Ih(e){var r,t=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=e.length;r+=64)w0(n,fx(e.substring(r-64,r)));e=e.substring(r-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<e.length;r++)s[r>>2]|=e.charCodeAt(r)<<(r%4<<3);if(s[r>>2]|=128<<(r%4<<3),r>55)for(w0(n,s),r=0;r<16;r++)s[r]=0;return s[14]=8*t,w0(n,s),n}function fx(e){var r,t=[];for(r=0;r<64;r+=4)t[r>>2]=e.charCodeAt(r)+(e.charCodeAt(r+1)<<8)+(e.charCodeAt(r+2)<<16)+(e.charCodeAt(r+3)<<24);return t}No=yt.atob.bind(yt),W0=yt.btoa.bind(yt);var gf="0123456789abcdef".split("");function hx(e){for(var r="",t=0;t<4;t++)r+=gf[e>>8*t+4&15]+gf[e>>8*t&15];return r}function ux(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function z0(e){return Ih(e).map(ux).join("")}var mx=function(e){for(var r=0;r<e.length;r++)e[r]=hx(e[r]);return e.join("")}(Ih("hello"))!="5d41402abc4b2a76b9719d911017c592";function xs(e,r){if(mx){var t=(65535&e)+(65535&r);return(e>>16)+(r>>16)+(t>>16)<<16|65535&t}return e+r&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function q0(e,r){var t,n,s,o;if(e!==t){for(var l=(s=e,o=1+(256/e.length>>0),new Array(o+1).join(s)),c=[],d=0;d<256;d++)c[d]=d;var h=0;for(d=0;d<256;d++){var u=c[d];h=(h+u+l.charCodeAt(d))%256,c[d]=c[h],c[h]=u}t=e,n=c}else c=n;var g=r.length,x=0,m=0,y="";for(d=0;d<g;d++)m=(m+(u=c[x=(x+1)%256]))%256,c[x]=c[m],c[m]=u,l=c[(c[x]+c[m])%256],y+=String.fromCharCode(r.charCodeAt(d)^l);return y}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var vf={print:4,modify:8,copy:16,"annot-forms":32};function Ti(e,r,t,n){this.v=1,this.r=2;var s=192;e.forEach(function(c){if(vf.perm!==void 0)throw new Error("Invalid permission: "+c);s+=vf[c]}),this.padding="(Â¿N^NuÂŠAd\0NVÃ¿Ãº\b..\0Â¶Ãh>Â€/\fÂ©Ã¾dSiz";var o=(r+this.padding).substr(0,32),l=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(o,l),this.P=-(1+(255^s)),this.encryptionKey=z0(o+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=q0(this.encryptionKey,this.padding)}function Ci(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var r="",t=e.length,n=0;n<t;n++){var s=e.charCodeAt(n);s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?r+="#"+("0"+s.toString(16)).slice(-2):r+=e[n]}return r}function yf(e){if(rr(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var r={};this.subscribe=function(t,n,s){if(s=s||!1,typeof t!="string"||typeof n!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");r.hasOwnProperty(t)||(r[t]={});var o=Math.random().toString(35);return r[t][o]=[n,!!s],o},this.unsubscribe=function(t){for(var n in r)if(r[n][t])return delete r[n][t],Object.keys(r[n]).length===0&&delete r[n],!0;return!1},this.publish=function(t){if(r.hasOwnProperty(t)){var n=Array.prototype.slice.call(arguments,1),s=[];for(var o in r[t]){var l=r[t][o];try{l[0].apply(e,n)}catch(c){yt.console&&tr.error("jsPDF PubSub Error",c.message,c)}l[1]&&s.push(o)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return r}}function Oo(e){if(!(this instanceof Oo))return new Oo(e);var r="opacity,stroke-opacity".split(",");for(var t in e)e.hasOwnProperty(t)&&r.indexOf(t)>=0&&(this[t]=e[t]);this.id="",this.objectNumber=-1}function Dh(e,r){this.gState=e,this.matrix=r,this.id="",this.objectNumber=-1}function ps(e,r,t,n,s){if(!(this instanceof ps))return new ps(e,r,t,n,s);this.type=e==="axial"?2:3,this.coords=r,this.colors=t,Dh.call(this,n,s)}function Ms(e,r,t,n,s){if(!(this instanceof Ms))return new Ms(e,r,t,n,s);this.boundingBox=e,this.xStep=r,this.yStep=t,this.stream="",this.cloneIndex=0,Dh.call(this,n,s)}function xt(e){var r,t=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],s=arguments[2],o=arguments[3],l=[],c=1,d=16,h="S",u=null;rr(e=e||{})==="object"&&(t=e.orientation,n=e.unit||n,s=e.format||s,o=e.compress||e.compressPdf||o,(u=e.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),c=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(r=e.precision),e.floatPrecision!==void 0&&(d=e.floatPrecision),h=e.defaultPathOperation||"S"),l=e.filters||(o===!0?["FlateEncode"]:l),n=n||"mm",t=(""+(t||"P")).toLowerCase();var g=e.putOnlyUsedFonts||!1,x={},m={internal:{},__private__:{}};m.__private__.PubSub=yf;var y="1.3",v=m.__private__.getPdfVersion=function(){return y};m.__private__.setPdfVersion=function(b){y=b};var j={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};m.__private__.getPageFormats=function(){return j};var w=m.__private__.getPageFormat=function(b){return j[b]};s=s||"a4";var N={COMPAT:"compat",ADVANCED:"advanced"},_=N.COMPAT;function C(){this.saveGraphicsState(),le(new mt(at,0,0,-at,0,Qa()*at).toString()+" cm"),this.setFontSize(this.getFontSize()/at),h="n",_=N.ADVANCED}function M(){this.restoreGraphicsState(),h="S",_=N.COMPAT}var D=m.__private__.combineFontStyleAndFontWeight=function(b,U){if(b=="bold"&&U=="normal"||b=="bold"&&U==400||b=="normal"&&U=="italic"||b=="bold"&&U=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return U&&(b=U==400||U==="normal"?b==="italic"?"italic":"normal":U!=700&&U!=="bold"||b!=="normal"?(U==700?"bold":U)+""+b:"bold"),b};m.advancedAPI=function(b){var U=_===N.COMPAT;return U&&C.call(this),typeof b!="function"||(b(this),U&&M.call(this)),this},m.compatAPI=function(b){var U=_===N.ADVANCED;return U&&M.call(this),typeof b!="function"||(b(this),U&&C.call(this)),this},m.isAdvancedAPI=function(){return _===N.ADVANCED};var L,E=function(b){if(_!==N.ADVANCED)throw new Error(b+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},P=m.roundToPrecision=m.__private__.roundToPrecision=function(b,U){var ce=r||U;if(isNaN(b)||isNaN(ce))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return b.toFixed(ce).replace(/0+$/,"")};L=m.hpf=m.__private__.hpf=typeof d=="number"?function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.hpf");return P(b,d)}:d==="smart"?function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.hpf");return P(b,b>-1&&b<1?16:5)}:function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.hpf");return P(b,16)};var H=m.f2=m.__private__.f2=function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.f2");return P(b,2)},k=m.__private__.f3=function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.f3");return P(b,3)},T=m.scale=m.__private__.scale=function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.scale");return _===N.COMPAT?b*at:_===N.ADVANCED?b:void 0},W=function(b){return _===N.COMPAT?Qa()-b:_===N.ADVANCED?b:void 0},G=function(b){return T(W(b))};m.__private__.setPrecision=m.setPrecision=function(b){typeof parseInt(b,10)=="number"&&(r=parseInt(b,10))};var de,J="00000000000000000000000000000000",Z=m.__private__.getFileId=function(){return J},oe=m.__private__.setFileId=function(b){return J=b!==void 0&&/^[a-fA-F0-9]{32}$/.test(b)?b.toUpperCase():J.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(Qr=new Ti(u.userPermissions,u.userPassword,u.ownerPassword,J)),J};m.setFileId=function(b){return oe(b),this},m.getFileId=function(){return Z()};var ae=m.__private__.convertDateToPDFDate=function(b){var U=b.getTimezoneOffset(),ce=U<0?"+":"-",me=Math.floor(Math.abs(U/60)),Ne=Math.abs(U%60),Pe=[ce,I(me),"'",I(Ne),"'"].join("");return["D:",b.getFullYear(),I(b.getMonth()+1),I(b.getDate()),I(b.getHours()),I(b.getMinutes()),I(b.getSeconds()),Pe].join("")},pe=m.__private__.convertPDFDateToDate=function(b){var U=parseInt(b.substr(2,4),10),ce=parseInt(b.substr(6,2),10)-1,me=parseInt(b.substr(8,2),10),Ne=parseInt(b.substr(10,2),10),Pe=parseInt(b.substr(12,2),10),ze=parseInt(b.substr(14,2),10);return new Date(U,ce,me,Ne,Pe,ze,0)},be=m.__private__.setCreationDate=function(b){var U;if(b===void 0&&(b=new Date),b instanceof Date)U=ae(b);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(b))throw new Error("Invalid argument passed to jsPDF.setCreationDate");U=b}return de=U},A=m.__private__.getCreationDate=function(b){var U=de;return b==="jsDate"&&(U=pe(de)),U};m.setCreationDate=function(b){return be(b),this},m.getCreationDate=function(b){return A(b)};var O,I=m.__private__.padd2=function(b){return("0"+parseInt(b)).slice(-2)},R=m.__private__.padd2Hex=function(b){return("00"+(b=b.toString())).substr(b.length)},X=0,fe=[],he=[],ee=0,ve=[],Ce=[],Ie=!1,Ve=he,$e=function(){X=0,ee=0,he=[],fe=[],ve=[],Q=dr(),te=dr()};m.__private__.setCustomOutputDestination=function(b){Ie=!0,Ve=b};var Ee=function(b){Ie||(Ve=b)};m.__private__.resetCustomOutputDestination=function(){Ie=!1,Ve=he};var le=m.__private__.out=function(b){return b=b.toString(),ee+=b.length+1,Ve.push(b),Ve},Be=m.__private__.write=function(b){return le(arguments.length===1?b.toString():Array.prototype.join.call(arguments," "))},Ze=m.__private__.getArrayBuffer=function(b){for(var U=b.length,ce=new ArrayBuffer(U),me=new Uint8Array(ce);U--;)me[U]=b.charCodeAt(U);return ce},We=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];m.__private__.getStandardFonts=function(){return We};var Ye=e.fontSize||16;m.__private__.setFontSize=m.setFontSize=function(b){return Ye=_===N.ADVANCED?b/at:b,this};var Qe,tt=m.__private__.getFontSize=m.getFontSize=function(){return _===N.COMPAT?Ye:Ye*at},dt=e.R2L||!1;m.__private__.setR2L=m.setR2L=function(b){return dt=b,this},m.__private__.getR2L=m.getR2L=function(){return dt};var ht,wt=m.__private__.setZoomMode=function(b){var U=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(b))Qe=b;else if(isNaN(b)){if(U.indexOf(b)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+b+'" is not recognized.');Qe=b}else Qe=parseInt(b,10)};m.__private__.getZoomMode=function(){return Qe};var kt,Ft=m.__private__.setPageMode=function(b){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(b)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+b+'" is not recognized.');ht=b};m.__private__.getPageMode=function(){return ht};var Lt=m.__private__.setLayoutMode=function(b){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(b)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+b+'" is not recognized.');kt=b};m.__private__.getLayoutMode=function(){return kt},m.__private__.setDisplayMode=m.setDisplayMode=function(b,U,ce){return wt(b),Lt(U),Ft(ce),this};var vt={title:"",subject:"",author:"",keywords:"",creator:""};m.__private__.getDocumentProperty=function(b){if(Object.keys(vt).indexOf(b)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return vt[b]},m.__private__.getDocumentProperties=function(){return vt},m.__private__.setDocumentProperties=m.setProperties=m.setDocumentProperties=function(b){for(var U in vt)vt.hasOwnProperty(U)&&b[U]&&(vt[U]=b[U]);return this},m.__private__.setDocumentProperty=function(b,U){if(Object.keys(vt).indexOf(b)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return vt[b]=U};var Ct,at,Fr,Ot,pn,Wt={},nr={},Bn=[],Dt={},va={},ir={},An={},Zn=null,Qt=0,Nt=[],Mt=new yf(m),Pa=e.hotfixes||[],Lr={},Un={},Hn=[],mt=function b(U,ce,me,Ne,Pe,ze){if(!(this instanceof b))return new b(U,ce,me,Ne,Pe,ze);isNaN(U)&&(U=1),isNaN(ce)&&(ce=0),isNaN(me)&&(me=0),isNaN(Ne)&&(Ne=1),isNaN(Pe)&&(Pe=0),isNaN(ze)&&(ze=0),this._matrix=[U,ce,me,Ne,Pe,ze]};Object.defineProperty(mt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(b){this._matrix[0]=b}}),Object.defineProperty(mt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(b){this._matrix[1]=b}}),Object.defineProperty(mt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(b){this._matrix[2]=b}}),Object.defineProperty(mt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(b){this._matrix[3]=b}}),Object.defineProperty(mt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(b){this._matrix[4]=b}}),Object.defineProperty(mt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(b){this._matrix[5]=b}}),Object.defineProperty(mt.prototype,"a",{get:function(){return this._matrix[0]},set:function(b){this._matrix[0]=b}}),Object.defineProperty(mt.prototype,"b",{get:function(){return this._matrix[1]},set:function(b){this._matrix[1]=b}}),Object.defineProperty(mt.prototype,"c",{get:function(){return this._matrix[2]},set:function(b){this._matrix[2]=b}}),Object.defineProperty(mt.prototype,"d",{get:function(){return this._matrix[3]},set:function(b){this._matrix[3]=b}}),Object.defineProperty(mt.prototype,"e",{get:function(){return this._matrix[4]},set:function(b){this._matrix[4]=b}}),Object.defineProperty(mt.prototype,"f",{get:function(){return this._matrix[5]},set:function(b){this._matrix[5]=b}}),Object.defineProperty(mt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(mt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(mt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(mt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),mt.prototype.join=function(b){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(L).join(b)},mt.prototype.multiply=function(b){var U=b.sx*this.sx+b.shy*this.shx,ce=b.sx*this.shy+b.shy*this.sy,me=b.shx*this.sx+b.sy*this.shx,Ne=b.shx*this.shy+b.sy*this.sy,Pe=b.tx*this.sx+b.ty*this.shx+this.tx,ze=b.tx*this.shy+b.ty*this.sy+this.ty;return new mt(U,ce,me,Ne,Pe,ze)},mt.prototype.decompose=function(){var b=this.sx,U=this.shy,ce=this.shx,me=this.sy,Ne=this.tx,Pe=this.ty,ze=Math.sqrt(b*b+U*U),ot=(b/=ze)*ce+(U/=ze)*me;ce-=b*ot,me-=U*ot;var ut=Math.sqrt(ce*ce+me*me);return ot/=ut,b*(me/=ut)<U*(ce/=ut)&&(b=-b,U=-U,ot=-ot,ze=-ze),{scale:new mt(ze,0,0,ut,0,0),translate:new mt(1,0,0,1,Ne,Pe),rotate:new mt(b,U,-U,b,0,0),skew:new mt(1,0,ot,1,0,0)}},mt.prototype.toString=function(b){return this.join(" ")},mt.prototype.inversed=function(){var b=this.sx,U=this.shy,ce=this.shx,me=this.sy,Ne=this.tx,Pe=this.ty,ze=1/(b*me-U*ce),ot=me*ze,ut=-U*ze,At=-ce*ze,St=b*ze;return new mt(ot,ut,At,St,-ot*Ne-At*Pe,-ut*Ne-St*Pe)},mt.prototype.applyToPoint=function(b){var U=b.x*this.sx+b.y*this.shx+this.tx,ce=b.x*this.shy+b.y*this.sy+this.ty;return new si(U,ce)},mt.prototype.applyToRectangle=function(b){var U=this.applyToPoint(b),ce=this.applyToPoint(new si(b.x+b.w,b.y+b.h));return new Ji(U.x,U.y,ce.x-U.x,ce.y-U.y)},mt.prototype.clone=function(){var b=this.sx,U=this.shy,ce=this.shx,me=this.sy,Ne=this.tx,Pe=this.ty;return new mt(b,U,ce,me,Ne,Pe)},m.Matrix=mt;var kn=m.matrixMult=function(b,U){return U.multiply(b)},xn=new mt(1,0,0,1,0,0);m.unitMatrix=m.identityMatrix=xn;var Zr=function(b,U){if(!va[b]){var ce=(U instanceof ps?"Sh":"P")+(Object.keys(Dt).length+1).toString(10);U.id=ce,va[b]=ce,Dt[ce]=U,Mt.publish("addPattern",U)}};m.ShadingPattern=ps,m.TilingPattern=Ms,m.addShadingPattern=function(b,U){return E("addShadingPattern()"),Zr(b,U),this},m.beginTilingPattern=function(b){E("beginTilingPattern()"),cl(b.boundingBox[0],b.boundingBox[1],b.boundingBox[2]-b.boundingBox[0],b.boundingBox[3]-b.boundingBox[1],b.matrix)},m.endTilingPattern=function(b,U){E("endTilingPattern()"),U.stream=Ce[O].join(`
`),Zr(b,U),Mt.publish("endTilingPattern",U),Hn.pop().restore()};var gr=m.__private__.newObject=function(){var b=dr();return q(b,!0),b},dr=m.__private__.newObjectDeferred=function(){return X++,fe[X]=function(){return ee},X},q=function(b,U){return U=typeof U=="boolean"&&U,fe[b]=ee,U&&le(b+" 0 obj"),b},se=m.__private__.newAdditionalObject=function(){var b={objId:dr(),content:""};return ve.push(b),b},Q=dr(),te=dr(),ne=m.__private__.decodeColorString=function(b){var U=b.split(" ");if(U.length!==2||U[1]!=="g"&&U[1]!=="G")U.length===5&&(U[4]==="k"||U[4]==="K")&&(U=[(1-U[0])*(1-U[3]),(1-U[1])*(1-U[3]),(1-U[2])*(1-U[3]),"r"]);else{var ce=parseFloat(U[0]);U=[ce,ce,ce,"r"]}for(var me="#",Ne=0;Ne<3;Ne++)me+=("0"+Math.floor(255*parseFloat(U[Ne])).toString(16)).slice(-2);return me},ie=m.__private__.encodeColorString=function(b){var U;typeof b=="string"&&(b={ch1:b});var ce=b.ch1,me=b.ch2,Ne=b.ch3,Pe=b.ch4,ze=b.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ce=="string"&&ce.charAt(0)!=="#"){var ot=new Oh(ce);if(ot.ok)ce=ot.toHex();else if(!/^\d*\.?\d*$/.test(ce))throw new Error('Invalid color "'+ce+'" passed to jsPDF.encodeColorString.')}if(typeof ce=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ce)&&(ce="#"+ce[1]+ce[1]+ce[2]+ce[2]+ce[3]+ce[3]),typeof ce=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ce)){var ut=parseInt(ce.substr(1),16);ce=ut>>16&255,me=ut>>8&255,Ne=255&ut}if(me===void 0||Pe===void 0&&ce===me&&me===Ne)if(typeof ce=="string")U=ce+" "+ze[0];else switch(b.precision){case 2:U=H(ce/255)+" "+ze[0];break;case 3:default:U=k(ce/255)+" "+ze[0]}else if(Pe===void 0||rr(Pe)==="object"){if(Pe&&!isNaN(Pe.a)&&Pe.a===0)return U=["1.","1.","1.",ze[1]].join(" ");if(typeof ce=="string")U=[ce,me,Ne,ze[1]].join(" ");else switch(b.precision){case 2:U=[H(ce/255),H(me/255),H(Ne/255),ze[1]].join(" ");break;default:case 3:U=[k(ce/255),k(me/255),k(Ne/255),ze[1]].join(" ")}}else if(typeof ce=="string")U=[ce,me,Ne,Pe,ze[2]].join(" ");else switch(b.precision){case 2:U=[H(ce),H(me),H(Ne),H(Pe),ze[2]].join(" ");break;case 3:default:U=[k(ce),k(me),k(Ne),k(Pe),ze[2]].join(" ")}return U},Se=m.__private__.getFilters=function(){return l},Fe=m.__private__.putStream=function(b){var U=(b=b||{}).data||"",ce=b.filters||Se(),me=b.alreadyAppliedFilters||[],Ne=b.addLength1||!1,Pe=U.length,ze=b.objectId,ot=function(en){return en};if(u!==null&&ze===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(ot=Qr.encryptor(ze,0));var ut={};ce===!0&&(ce=["FlateEncode"]);var At=b.additionalKeyValues||[],St=(ut=xt.API.processDataByFilters!==void 0?xt.API.processDataByFilters(U,ce):{data:U,reverseChain:[]}).reverseChain+(Array.isArray(me)?me.join(" "):me.toString());if(ut.data.length!==0&&(At.push({key:"Length",value:ut.data.length}),Ne===!0&&At.push({key:"Length1",value:Pe})),St.length!=0)if(St.split("/").length-1==1)At.push({key:"Filter",value:St});else{At.push({key:"Filter",value:"["+St+"]"});for(var It=0;It<At.length;It+=1)if(At[It].key==="DecodeParms"){for(var cr=[],fr=0;fr<ut.reverseChain.split("/").length-1;fr+=1)cr.push("null");cr.push(At[It].value),At[It].value="["+cr.join(" ")+"]"}}le("<<");for(var _r=0;_r<At.length;_r++)le("/"+At[_r].key+" "+At[_r].value);le(">>"),ut.data.length!==0&&(le("stream"),le(ot(ut.data)),le("endstream"))},je=m.__private__.putPage=function(b){var U=b.number,ce=b.data,me=b.objId,Ne=b.contentsObjId;q(me,!0),le("<</Type /Page"),le("/Parent "+b.rootDictionaryObjId+" 0 R"),le("/Resources "+b.resourceDictionaryObjId+" 0 R"),le("/MediaBox ["+parseFloat(L(b.mediaBox.bottomLeftX))+" "+parseFloat(L(b.mediaBox.bottomLeftY))+" "+L(b.mediaBox.topRightX)+" "+L(b.mediaBox.topRightY)+"]"),b.cropBox!==null&&le("/CropBox ["+L(b.cropBox.bottomLeftX)+" "+L(b.cropBox.bottomLeftY)+" "+L(b.cropBox.topRightX)+" "+L(b.cropBox.topRightY)+"]"),b.bleedBox!==null&&le("/BleedBox ["+L(b.bleedBox.bottomLeftX)+" "+L(b.bleedBox.bottomLeftY)+" "+L(b.bleedBox.topRightX)+" "+L(b.bleedBox.topRightY)+"]"),b.trimBox!==null&&le("/TrimBox ["+L(b.trimBox.bottomLeftX)+" "+L(b.trimBox.bottomLeftY)+" "+L(b.trimBox.topRightX)+" "+L(b.trimBox.topRightY)+"]"),b.artBox!==null&&le("/ArtBox ["+L(b.artBox.bottomLeftX)+" "+L(b.artBox.bottomLeftY)+" "+L(b.artBox.topRightX)+" "+L(b.artBox.topRightY)+"]"),typeof b.userUnit=="number"&&b.userUnit!==1&&le("/UserUnit "+b.userUnit),Mt.publish("putPage",{objId:me,pageContext:Nt[U],pageNumber:U,page:ce}),le("/Contents "+Ne+" 0 R"),le(">>"),le("endobj");var Pe=ce.join(`
`);return _===N.ADVANCED&&(Pe+=`
Q`),q(Ne,!0),Fe({data:Pe,filters:Se(),objectId:Ne}),le("endobj"),me},ke=m.__private__.putPages=function(){var b,U,ce=[];for(b=1;b<=Qt;b++)Nt[b].objId=dr(),Nt[b].contentsObjId=dr();for(b=1;b<=Qt;b++)ce.push(je({number:b,data:Ce[b],objId:Nt[b].objId,contentsObjId:Nt[b].contentsObjId,mediaBox:Nt[b].mediaBox,cropBox:Nt[b].cropBox,bleedBox:Nt[b].bleedBox,trimBox:Nt[b].trimBox,artBox:Nt[b].artBox,userUnit:Nt[b].userUnit,rootDictionaryObjId:Q,resourceDictionaryObjId:te}));q(Q,!0),le("<</Type /Pages");var me="/Kids [";for(U=0;U<Qt;U++)me+=ce[U]+" 0 R ";le(me+"]"),le("/Count "+Qt),le(">>"),le("endobj"),Mt.publish("postPutPages")},Te=function(b){Mt.publish("putFont",{font:b,out:le,newObject:gr,putStream:Fe}),b.isAlreadyPutted!==!0&&(b.objectNumber=gr(),le("<<"),le("/Type /Font"),le("/BaseFont /"+Ci(b.postScriptName)),le("/Subtype /Type1"),typeof b.encoding=="string"&&le("/Encoding /"+b.encoding),le("/FirstChar 32"),le("/LastChar 255"),le(">>"),le("endobj"))},qe=function(){for(var b in Wt)Wt.hasOwnProperty(b)&&(g===!1||g===!0&&x.hasOwnProperty(b))&&Te(Wt[b])},Xe=function(b){b.objectNumber=gr();var U=[];U.push({key:"Type",value:"/XObject"}),U.push({key:"Subtype",value:"/Form"}),U.push({key:"BBox",value:"["+[L(b.x),L(b.y),L(b.x+b.width),L(b.y+b.height)].join(" ")+"]"}),U.push({key:"Matrix",value:"["+b.matrix.toString()+"]"});var ce=b.pages[1].join(`
`);Fe({data:ce,additionalKeyValues:U,objectId:b.objectNumber}),le("endobj")},it=function(){for(var b in Lr)Lr.hasOwnProperty(b)&&Xe(Lr[b])},Ge=function(b,U){var ce,me=[],Ne=1/(U-1);for(ce=0;ce<1;ce+=Ne)me.push(ce);if(me.push(1),b[0].offset!=0){var Pe={offset:0,color:b[0].color};b.unshift(Pe)}if(b[b.length-1].offset!=1){var ze={offset:1,color:b[b.length-1].color};b.push(ze)}for(var ot="",ut=0,At=0;At<me.length;At++){for(ce=me[At];ce>b[ut+1].offset;)ut++;var St=b[ut].offset,It=(ce-St)/(b[ut+1].offset-St),cr=b[ut].color,fr=b[ut+1].color;ot+=R(Math.round((1-It)*cr[0]+It*fr[0]).toString(16))+R(Math.round((1-It)*cr[1]+It*fr[1]).toString(16))+R(Math.round((1-It)*cr[2]+It*fr[2]).toString(16))}return ot.trim()},st=function(b,U){U||(U=21);var ce=gr(),me=Ge(b.colors,U),Ne=[];Ne.push({key:"FunctionType",value:"0"}),Ne.push({key:"Domain",value:"[0.0 1.0]"}),Ne.push({key:"Size",value:"["+U+"]"}),Ne.push({key:"BitsPerSample",value:"8"}),Ne.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ne.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Fe({data:me,additionalKeyValues:Ne,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ce}),le("endobj"),b.objectNumber=gr(),le("<< /ShadingType "+b.type),le("/ColorSpace /DeviceRGB");var Pe="/Coords ["+L(parseFloat(b.coords[0]))+" "+L(parseFloat(b.coords[1]))+" ";b.type===2?Pe+=L(parseFloat(b.coords[2]))+" "+L(parseFloat(b.coords[3])):Pe+=L(parseFloat(b.coords[2]))+" "+L(parseFloat(b.coords[3]))+" "+L(parseFloat(b.coords[4]))+" "+L(parseFloat(b.coords[5])),le(Pe+="]"),b.matrix&&le("/Matrix ["+b.matrix.toString()+"]"),le("/Function "+ce+" 0 R"),le("/Extend [true true]"),le(">>"),le("endobj")},bt=function(b,U){var ce=dr(),me=gr();U.push({resourcesOid:ce,objectOid:me}),b.objectNumber=me;var Ne=[];Ne.push({key:"Type",value:"/Pattern"}),Ne.push({key:"PatternType",value:"1"}),Ne.push({key:"PaintType",value:"1"}),Ne.push({key:"TilingType",value:"1"}),Ne.push({key:"BBox",value:"["+b.boundingBox.map(L).join(" ")+"]"}),Ne.push({key:"XStep",value:L(b.xStep)}),Ne.push({key:"YStep",value:L(b.yStep)}),Ne.push({key:"Resources",value:ce+" 0 R"}),b.matrix&&Ne.push({key:"Matrix",value:"["+b.matrix.toString()+"]"}),Fe({data:b.stream,additionalKeyValues:Ne,objectId:b.objectNumber}),le("endobj")},zt=function(b){var U;for(U in Dt)Dt.hasOwnProperty(U)&&(Dt[U]instanceof ps?st(Dt[U]):Dt[U]instanceof Ms&&bt(Dt[U],b))},Kt=function(b){for(var U in b.objectNumber=gr(),le("<<"),b)switch(U){case"opacity":le("/ca "+H(b[U]));break;case"stroke-opacity":le("/CA "+H(b[U]))}le(">>"),le("endobj")},Sr=function(){var b;for(b in ir)ir.hasOwnProperty(b)&&Kt(ir[b])},Qn=function(){for(var b in le("/XObject <<"),Lr)Lr.hasOwnProperty(b)&&Lr[b].objectNumber>=0&&le("/"+b+" "+Lr[b].objectNumber+" 0 R");Mt.publish("putXobjectDict"),le(">>")},Oa=function(){Qr.oid=gr(),le("<<"),le("/Filter /Standard"),le("/V "+Qr.v),le("/R "+Qr.r),le("/U <"+Qr.toHexString(Qr.U)+">"),le("/O <"+Qr.toHexString(Qr.O)+">"),le("/P "+Qr.P),le(">>"),le("endobj")},ya=function(){for(var b in le("/Font <<"),Wt)Wt.hasOwnProperty(b)&&(g===!1||g===!0&&x.hasOwnProperty(b))&&le("/"+b+" "+Wt[b].objectNumber+" 0 R");le(">>")},ea=function(){if(Object.keys(Dt).length>0){for(var b in le("/Shading <<"),Dt)Dt.hasOwnProperty(b)&&Dt[b]instanceof ps&&Dt[b].objectNumber>=0&&le("/"+b+" "+Dt[b].objectNumber+" 0 R");Mt.publish("putShadingPatternDict"),le(">>")}},ba=function(b){if(Object.keys(Dt).length>0){for(var U in le("/Pattern <<"),Dt)Dt.hasOwnProperty(U)&&Dt[U]instanceof m.TilingPattern&&Dt[U].objectNumber>=0&&Dt[U].objectNumber<b&&le("/"+U+" "+Dt[U].objectNumber+" 0 R");Mt.publish("putTilingPatternDict"),le(">>")}},Tn=function(){if(Object.keys(ir).length>0){var b;for(b in le("/ExtGState <<"),ir)ir.hasOwnProperty(b)&&ir[b].objectNumber>=0&&le("/"+b+" "+ir[b].objectNumber+" 0 R");Mt.publish("putGStateDict"),le(">>")}},vr=function(b){q(b.resourcesOid,!0),le("<<"),le("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),ya(),ea(),ba(b.objectOid),Tn(),Qn(),le(">>"),le("endobj")},Yo=function(){var b=[];qe(),Sr(),it(),zt(b),Mt.publish("putResources"),b.forEach(vr),vr({resourcesOid:te,objectOid:Number.MAX_SAFE_INTEGER}),Mt.publish("postPutResources")},Xo=function(){Mt.publish("putAdditionalObjects");for(var b=0;b<ve.length;b++){var U=ve[b];q(U.objId,!0),le(U.content),le("endobj")}Mt.publish("postPutAdditionalObjects")},Ko=function(b){nr[b.fontName]=nr[b.fontName]||{},nr[b.fontName][b.fontStyle]=b.id},Wi=function(b,U,ce,me,Ne){var Pe={id:"F"+(Object.keys(Wt).length+1).toString(10),postScriptName:b,fontName:U,fontStyle:ce,encoding:me,isStandardFont:Ne||!1,metadata:{}};return Mt.publish("addFont",{font:Pe,instance:this}),Wt[Pe.id]=Pe,Ko(Pe),Pe.id},kc=function(b){for(var U=0,ce=We.length;U<ce;U++){var me=Wi.call(this,b[U][0],b[U][1],b[U][2],We[U][3],!0);g===!1&&(x[me]=!0);var Ne=b[U][0].split("-");Ko({id:me,fontName:Ne[0],fontStyle:Ne[1]||""})}Mt.publish("addFonts",{fonts:Wt,dictionary:nr})},ta=function(b){return b.foo=function(){try{return b.apply(this,arguments)}catch(me){var U=me.stack||"";~U.indexOf(" at ")&&(U=U.split(" at ")[1]);var ce="Error in function "+U.split(`
`)[0].split("<")[0]+": "+me.message;if(!yt.console)throw new Error(ce);yt.console.error(ce,me),yt.alert&&alert(ce)}},b.foo.bar=b,b.foo},Qs=function(b,U){var ce,me,Ne,Pe,ze,ot,ut,At,St;if(Ne=(U=U||{}).sourceEncoding||"Unicode",ze=U.outputEncoding,(U.autoencode||ze)&&Wt[Ct].metadata&&Wt[Ct].metadata[Ne]&&Wt[Ct].metadata[Ne].encoding&&(Pe=Wt[Ct].metadata[Ne].encoding,!ze&&Wt[Ct].encoding&&(ze=Wt[Ct].encoding),!ze&&Pe.codePages&&(ze=Pe.codePages[0]),typeof ze=="string"&&(ze=Pe[ze]),ze)){for(ut=!1,ot=[],ce=0,me=b.length;ce<me;ce++)(At=ze[b.charCodeAt(ce)])?ot.push(String.fromCharCode(At)):ot.push(b[ce]),ot[ce].charCodeAt(0)>>8&&(ut=!0);b=ot.join("")}for(ce=b.length;ut===void 0&&ce!==0;)b.charCodeAt(ce-1)>>8&&(ut=!0),ce--;if(!ut)return b;for(ot=U.noBOM?[]:[254,255],ce=0,me=b.length;ce<me;ce++){if((St=(At=b.charCodeAt(ce))>>8)>>8)throw new Error("Character at position "+ce+" of string '"+b+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");ot.push(St),ot.push(At-(St<<8))}return String.fromCharCode.apply(void 0,ot)},gn=m.__private__.pdfEscape=m.pdfEscape=function(b,U){return Qs(b,U).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},zi=m.__private__.beginPage=function(b){Ce[++Qt]=[],Nt[Qt]={objId:0,contentsObjId:0,userUnit:Number(c),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(b[0]),topRightY:Number(b[1])}},Zo(Qt),Ee(Ce[O])},Jo=function(b,U){var ce,me,Ne;switch(t=U||t,typeof b=="string"&&(ce=w(b.toLowerCase()),Array.isArray(ce)&&(me=ce[0],Ne=ce[1])),Array.isArray(b)&&(me=b[0]*at,Ne=b[1]*at),isNaN(me)&&(me=s[0],Ne=s[1]),(me>14400||Ne>14400)&&(tr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),me=Math.min(14400,me),Ne=Math.min(14400,Ne)),s=[me,Ne],t.substr(0,1)){case"l":Ne>me&&(s=[Ne,me]);break;case"p":me>Ne&&(s=[Ne,me])}zi(s),al($i),le(ra),Xi!==0&&le(Xi+" J"),Ki!==0&&le(Ki+" j"),Mt.publish("addPage",{pageNumber:Qt})},Tc=function(b){b>0&&b<=Qt&&(Ce.splice(b,1),Nt.splice(b,1),Qt--,O>Qt&&(O=Qt),this.setPage(O))},Zo=function(b){b>0&&b<=Qt&&(O=b)},Cc=m.__private__.getNumberOfPages=m.getNumberOfPages=function(){return Ce.length-1},Qo=function(b,U,ce){var me,Ne=void 0;return ce=ce||{},b=b!==void 0?b:Wt[Ct].fontName,U=U!==void 0?U:Wt[Ct].fontStyle,me=b.toLowerCase(),nr[me]!==void 0&&nr[me][U]!==void 0?Ne=nr[me][U]:nr[b]!==void 0&&nr[b][U]!==void 0?Ne=nr[b][U]:ce.disableWarning===!1&&tr.warn("Unable to look up font label for font '"+b+"', '"+U+"'. Refer to getFontList() for available fonts."),Ne||ce.noFallback||(Ne=nr.times[U])==null&&(Ne=nr.times.normal),Ne},Ec=m.__private__.putInfo=function(){var b=gr(),U=function(me){return me};for(var ce in u!==null&&(U=Qr.encryptor(b,0)),le("<<"),le("/Producer ("+gn(U("jsPDF "+xt.version))+")"),vt)vt.hasOwnProperty(ce)&&vt[ce]&&le("/"+ce.substr(0,1).toUpperCase()+ce.substr(1)+" ("+gn(U(vt[ce]))+")");le("/CreationDate ("+gn(U(de))+")"),le(">>"),le("endobj")},qi=m.__private__.putCatalog=function(b){var U=(b=b||{}).rootDictionaryObjId||Q;switch(gr(),le("<<"),le("/Type /Catalog"),le("/Pages "+U+" 0 R"),Qe||(Qe="fullwidth"),Qe){case"fullwidth":le("/OpenAction [3 0 R /FitH null]");break;case"fullheight":le("/OpenAction [3 0 R /FitV null]");break;case"fullpage":le("/OpenAction [3 0 R /Fit]");break;case"original":le("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ce=""+Qe;ce.substr(ce.length-1)==="%"&&(Qe=parseInt(Qe)/100),typeof Qe=="number"&&le("/OpenAction [3 0 R /XYZ null null "+H(Qe)+"]")}switch(kt||(kt="continuous"),kt){case"continuous":le("/PageLayout /OneColumn");break;case"single":le("/PageLayout /SinglePage");break;case"two":case"twoleft":le("/PageLayout /TwoColumnLeft");break;case"tworight":le("/PageLayout /TwoColumnRight")}ht&&le("/PageMode /"+ht),Mt.publish("putCatalog"),le(">>"),le("endobj")},Fc=m.__private__.putTrailer=function(){le("trailer"),le("<<"),le("/Size "+(X+1)),le("/Root "+X+" 0 R"),le("/Info "+(X-1)+" 0 R"),u!==null&&le("/Encrypt "+Qr.oid+" 0 R"),le("/ID [ <"+J+"> <"+J+"> ]"),le(">>")},Lc=m.__private__.putHeader=function(){le("%PDF-"+y),le("%ÂºÃŸÂ¬Ã ")},Pc=m.__private__.putXRef=function(){var b="0000000000";le("xref"),le("0 "+(X+1)),le("0000000000 65535 f ");for(var U=1;U<=X;U++)typeof fe[U]=="function"?le((b+fe[U]()).slice(-10)+" 00000 n "):fe[U]!==void 0?le((b+fe[U]).slice(-10)+" 00000 n "):le("0000000000 00000 n ")},Ia=m.__private__.buildDocument=function(){$e(),Ee(he),Mt.publish("buildDocument"),Lc(),ke(),Xo(),Yo(),u!==null&&Oa(),Ec(),qi();var b=ee;return Pc(),Fc(),le("startxref"),le(""+b),le("%%EOF"),Ee(Ce[O]),he.join(`
`)},ei=m.__private__.getBlob=function(b){return new Blob([Ze(b)],{type:"application/pdf"})},ti=m.output=m.__private__.output=ta(function(b,U){switch(typeof(U=U||{})=="string"?U={filename:U}:U.filename=U.filename||"generated.pdf",b){case void 0:return Ia();case"save":m.save(U.filename);break;case"arraybuffer":return Ze(Ia());case"blob":return ei(Ia());case"bloburi":case"bloburl":if(yt.URL!==void 0&&typeof yt.URL.createObjectURL=="function")return yt.URL&&yt.URL.createObjectURL(ei(Ia()))||void 0;tr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ce="",me=Ia();try{ce=W0(me)}catch{ce=W0(unescape(encodeURIComponent(me)))}return"data:application/pdf;filename="+U.filename+";base64,"+ce;case"pdfobjectnewwindow":if(Object.prototype.toString.call(yt)==="[object Window]"){var Ne="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Pe=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';U.pdfObjectUrl&&(Ne=U.pdfObjectUrl,Pe="");var ze='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ne+'"'+Pe+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(U)+");<\/script></body></html>",ot=yt.open();return ot!==null&&ot.document.write(ze),ot}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(yt)==="[object Window]"){var ut='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(U.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+U.filename+'" width="500px" height="400px" /></body></html>',At=yt.open();if(At!==null){At.document.write(ut);var St=this;At.document.documentElement.querySelector("#pdfViewer").onload=function(){At.document.title=U.filename,At.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(St.output("bloburl"))}}return At}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(yt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var It='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",U)+'"></iframe></body></html>',cr=yt.open();if(cr!==null&&(cr.document.write(It),cr.document.title=U.filename),cr||typeof safari>"u")return cr;break;case"datauri":case"dataurl":return yt.document.location.href=this.output("datauristring",U);default:return null}}),el=function(b){return Array.isArray(Pa)===!0&&Pa.indexOf(b)>-1};switch(n){case"pt":at=1;break;case"mm":at=72/25.4;break;case"cm":at=72/2.54;break;case"in":at=72;break;case"px":at=el("px_scaling")==1?.75:96/72;break;case"pc":case"em":at=12;break;case"ex":at=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);at=n}var Qr=null;be(),oe();var Oc=function(b){return u!==null?Qr.encryptor(b,0):function(U){return U}},tl=m.__private__.getPageInfo=m.getPageInfo=function(b){if(isNaN(b)||b%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Nt[b].objId,pageNumber:b,pageContext:Nt[b]}},jt=m.__private__.getPageInfoByObjId=function(b){if(isNaN(b)||b%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var U in Nt)if(Nt[U].objId===b)break;return tl(U)},Ic=m.__private__.getCurrentPageInfo=m.getCurrentPageInfo=function(){return{objId:Nt[O].objId,pageNumber:O,pageContext:Nt[O]}};m.addPage=function(){return Jo.apply(this,arguments),this},m.setPage=function(){return Zo.apply(this,arguments),Ee.call(this,Ce[O]),this},m.insertPage=function(b){return this.addPage(),this.movePage(O,b),this},m.movePage=function(b,U){var ce,me;if(b>U){ce=Ce[b],me=Nt[b];for(var Ne=b;Ne>U;Ne--)Ce[Ne]=Ce[Ne-1],Nt[Ne]=Nt[Ne-1];Ce[U]=ce,Nt[U]=me,this.setPage(U)}else if(b<U){ce=Ce[b],me=Nt[b];for(var Pe=b;Pe<U;Pe++)Ce[Pe]=Ce[Pe+1],Nt[Pe]=Nt[Pe+1];Ce[U]=ce,Nt[U]=me,this.setPage(U)}return this},m.deletePage=function(){return Tc.apply(this,arguments),this},m.__private__.text=m.text=function(b,U,ce,me,Ne){var Pe,ze,ot,ut,At,St,It,cr,fr,_r=(me=me||{}).scope||this;if(typeof b=="number"&&typeof U=="number"&&(typeof ce=="string"||Array.isArray(ce))){var en=ce;ce=U,U=b,b=en}if(arguments[3]instanceof mt?(E("The transform parameter of text() with a Matrix value"),fr=Ne):(ot=arguments[4],ut=arguments[5],rr(It=arguments[3])==="object"&&It!==null||(typeof ot=="string"&&(ut=ot,ot=null),typeof It=="string"&&(ut=It,It=null),typeof It=="number"&&(ot=It,It=null),me={flags:It,angle:ot,align:ut})),isNaN(U)||isNaN(ce)||b==null)throw new Error("Invalid arguments passed to jsPDF.text");if(b.length===0)return _r;var Rr="",na=!1,Cn=typeof me.lineHeightFactor=="number"?me.lineHeightFactor:ks,ja=_r.internal.scaleFactor;function dl(ar){return ar=ar.split("	").join(Array(me.TabLen||9).join(" ")),gn(ar,It)}function to(ar){for(var sr,br=ar.concat(),Pr=[],Ua=br.length;Ua--;)typeof(sr=br.shift())=="string"?Pr.push(sr):Array.isArray(ar)&&(sr.length===1||sr[1]===void 0&&sr[2]===void 0)?Pr.push(sr[0]):Pr.push([sr[0],sr[1],sr[2]]);return Pr}function ro(ar,sr){var br;if(typeof ar=="string")br=sr(ar)[0];else if(Array.isArray(ar)){for(var Pr,Ua,fo=ar.concat(),xi=[],pl=fo.length;pl--;)typeof(Pr=fo.shift())=="string"?xi.push(sr(Pr)[0]):Array.isArray(Pr)&&typeof Pr[0]=="string"&&(Ua=sr(Pr[0],Pr[1],Pr[2]),xi.push([Ua[0],Ua[1],Ua[2]]));br=xi}return br}var oi=!1,no=!0;if(typeof b=="string")oi=!0;else if(Array.isArray(b)){var ao=b.concat();ze=[];for(var li,zr=ao.length;zr--;)(typeof(li=ao.shift())!="string"||Array.isArray(li)&&typeof li[0]!="string")&&(no=!1);oi=no}if(oi===!1)throw new Error('Type of text must be string or Array. "'+b+'" is not recognized.');typeof b=="string"&&(b=b.match(/[\r?\n]/)?b.split(/\r\n|\r|\n/g):[b]);var ci=Ye/_r.internal.scaleFactor,di=ci*(Cn-1);switch(me.baseline){case"bottom":ce-=di;break;case"top":ce+=ci-di;break;case"hanging":ce+=ci-2*di;break;case"middle":ce+=ci/2-di}if((St=me.maxWidth||0)>0&&(typeof b=="string"?b=_r.splitTextToSize(b,St):Object.prototype.toString.call(b)==="[object Array]"&&(b=b.reduce(function(ar,sr){return ar.concat(_r.splitTextToSize(sr,St))},[]))),Pe={text:b,x:U,y:ce,options:me,mutex:{pdfEscape:gn,activeFontKey:Ct,fonts:Wt,activeFontSize:Ye}},Mt.publish("preProcessText",Pe),b=Pe.text,ot=(me=Pe.options).angle,!(fr instanceof mt)&&ot&&typeof ot=="number"){ot*=Math.PI/180,me.rotationDirection===0&&(ot=-ot),_===N.ADVANCED&&(ot=-ot);var fi=Math.cos(ot),so=Math.sin(ot);fr=new mt(fi,so,-so,fi,0,0)}else ot&&ot instanceof mt&&(fr=ot);_!==N.ADVANCED||fr||(fr=xn),(At=me.charSpace||ai)!==void 0&&(Rr+=L(T(At))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(cr=me.horizontalScale)!==void 0&&(Rr+=L(100*cr)+` Tz
`),me.lang;var vn=-1,Vc=me.renderingMode!==void 0?me.renderingMode:me.stroke,io=_r.internal.getCurrentPageInfo().pageContext;switch(Vc){case 0:case!1:case"fill":vn=0;break;case 1:case!0:case"stroke":vn=1;break;case 2:case"fillThenStroke":vn=2;break;case 3:case"invisible":vn=3;break;case 4:case"fillAndAddForClipping":vn=4;break;case 5:case"strokeAndAddPathForClipping":vn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":vn=6;break;case 7:case"addToPathForClipping":vn=7}var fl=io.usedRenderingMode!==void 0?io.usedRenderingMode:-1;vn!==-1?Rr+=vn+` Tr
`:fl!==-1&&(Rr+=`0 Tr
`),vn!==-1&&(io.usedRenderingMode=vn),ut=me.align||"left";var Wn,hi=Ye*Cn,hl=_r.internal.pageSize.getWidth(),ul=Wt[Ct];At=me.charSpace||ai,St=me.maxWidth||0,It=Object.assign({autoencode:!0,noBOM:!0},me.flags);var es=[],Es=function(ar){return _r.getStringUnitWidth(ar,{font:ul,charSpace:At,fontSize:Ye,doKerning:!1})*Ye/ja};if(Object.prototype.toString.call(b)==="[object Array]"){var yn;ze=to(b),ut!=="left"&&(Wn=ze.map(Es));var cn,ts=0;if(ut==="right"){U-=Wn[0],b=[],zr=ze.length;for(var Ra=0;Ra<zr;Ra++)Ra===0?(cn=Na(U),yn=Da(ce)):(cn=T(ts-Wn[Ra]),yn=-hi),b.push([ze[Ra],cn,yn]),ts=Wn[Ra]}else if(ut==="center"){U-=Wn[0]/2,b=[],zr=ze.length;for(var Ma=0;Ma<zr;Ma++)Ma===0?(cn=Na(U),yn=Da(ce)):(cn=T((ts-Wn[Ma])/2),yn=-hi),b.push([ze[Ma],cn,yn]),ts=Wn[Ma]}else if(ut==="left"){b=[],zr=ze.length;for(var ui=0;ui<zr;ui++)b.push(ze[ui])}else if(ut==="justify"&&ul.encoding==="Identity-H"){b=[],zr=ze.length,St=St!==0?St:hl;for(var Ba=0,yr=0;yr<zr;yr++)if(yn=yr===0?Da(ce):-hi,cn=yr===0?Na(U):Ba,yr<zr-1){var oo=T((St-Wn[yr])/(ze[yr].split(" ").length-1)),dn=ze[yr].split(" ");b.push([dn[0]+" ",cn,yn]),Ba=0;for(var zn=1;zn<dn.length;zn++){var mi=(Es(dn[zn-1]+" "+dn[zn])-Es(dn[zn]))*ja+oo;zn==dn.length-1?b.push([dn[zn],mi,0]):b.push([dn[zn]+" ",mi,0]),Ba-=mi}}else b.push([ze[yr],cn,yn]);b.push(["",Ba,0])}else{if(ut!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(b=[],zr=ze.length,St=St!==0?St:hl,yr=0;yr<zr;yr++)yn=yr===0?Da(ce):-hi,cn=yr===0?Na(U):0,yr<zr-1?es.push(L(T((St-Wn[yr])/(ze[yr].split(" ").length-1)))):es.push(0),b.push([ze[yr],cn,yn])}}var ml=typeof me.R2L=="boolean"?me.R2L:dt;ml===!0&&(b=ro(b,function(ar,sr,br){return[ar.split("").reverse().join(""),sr,br]})),Pe={text:b,x:U,y:ce,options:me,mutex:{pdfEscape:gn,activeFontKey:Ct,fonts:Wt,activeFontSize:Ye}},Mt.publish("postProcessText",Pe),b=Pe.text,na=Pe.mutex.isHex||!1;var lo=Wt[Ct].encoding;lo!=="WinAnsiEncoding"&&lo!=="StandardEncoding"||(b=ro(b,function(ar,sr,br){return[dl(ar),sr,br]})),ze=to(b),b=[];for(var Fs,Ls,rs,Ps=0,pi=1,Os=Array.isArray(ze[0])?pi:Ps,ns="",co=function(ar,sr,br){var Pr="";return br instanceof mt?(br=typeof me.angle=="number"?kn(br,new mt(1,0,0,1,ar,sr)):kn(new mt(1,0,0,1,ar,sr),br),_===N.ADVANCED&&(br=kn(new mt(1,0,0,-1,0,0),br)),Pr=br.join(" ")+` Tm
`):Pr=L(ar)+" "+L(sr)+` Td
`,Pr},qn=0;qn<ze.length;qn++){switch(ns="",Os){case pi:rs=(na?"<":"(")+ze[qn][0]+(na?">":")"),Fs=parseFloat(ze[qn][1]),Ls=parseFloat(ze[qn][2]);break;case Ps:rs=(na?"<":"(")+ze[qn]+(na?">":")"),Fs=Na(U),Ls=Da(ce)}es!==void 0&&es[qn]!==void 0&&(ns=es[qn]+` Tw
`),qn===0?b.push(ns+co(Fs,Ls,fr)+rs):Os===Ps?b.push(ns+rs):Os===pi&&b.push(ns+co(Fs,Ls,fr)+rs)}b=Os===Ps?b.join(` Tj
T* `):b.join(` Tj
`),b+=` Tj
`;var Vn=`BT
/`;return Vn+=Ct+" "+Ye+` Tf
`,Vn+=L(Ye*Cn)+` TL
`,Vn+=Ts+`
`,Vn+=Rr,Vn+=b,le(Vn+="ET"),x[Ct]=!0,_r};var Dc=m.__private__.clip=m.clip=function(b){return le(b==="evenodd"?"W*":"W"),this};m.clipEvenOdd=function(){return Dc("evenodd")},m.__private__.discardPath=m.discardPath=function(){return le("n"),this};var wa=m.__private__.isValidStyle=function(b){var U=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(b)!==-1&&(U=!0),U};m.__private__.setDefaultPathOperation=m.setDefaultPathOperation=function(b){return wa(b)&&(h=b),this};var rl=m.__private__.getStyle=m.getStyle=function(b){var U=h;switch(b){case"D":case"S":U="S";break;case"F":U="f";break;case"FD":case"DF":U="B";break;case"f":case"f*":case"B":case"B*":U=b}return U},nl=m.close=function(){return le("h"),this};m.stroke=function(){return le("S"),this},m.fill=function(b){return ri("f",b),this},m.fillEvenOdd=function(b){return ri("f*",b),this},m.fillStroke=function(b){return ri("B",b),this},m.fillStrokeEvenOdd=function(b){return ri("B*",b),this};var ri=function(b,U){rr(U)==="object"?Mc(U,b):le(b)},Vi=function(b){b===null||_===N.ADVANCED&&b===void 0||(b=rl(b),le(b))};function Rc(b,U,ce,me,Ne){var Pe=new Ms(U||this.boundingBox,ce||this.xStep,me||this.yStep,this.gState,Ne||this.matrix);Pe.stream=this.stream;var ze=b+"$$"+this.cloneIndex+++"$$";return Zr(ze,Pe),Pe}var Mc=function(b,U){var ce=va[b.key],me=Dt[ce];if(me instanceof ps)le("q"),le(Bc(U)),me.gState&&m.setGState(me.gState),le(b.matrix.toString()+" cm"),le("/"+ce+" sh"),le("Q");else if(me instanceof Ms){var Ne=new mt(1,0,0,-1,0,Qa());b.matrix&&(Ne=Ne.multiply(b.matrix||xn),ce=Rc.call(me,b.key,b.boundingBox,b.xStep,b.yStep,Ne).id),le("q"),le("/Pattern cs"),le("/"+ce+" scn"),me.gState&&m.setGState(me.gState),le(U),le("Q")}},Bc=function(b){switch(b){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Gi=m.moveTo=function(b,U){return le(L(T(b))+" "+L(G(U))+" m"),this},As=m.lineTo=function(b,U){return le(L(T(b))+" "+L(G(U))+" l"),this},Ja=m.curveTo=function(b,U,ce,me,Ne,Pe){return le([L(T(b)),L(G(U)),L(T(ce)),L(G(me)),L(T(Ne)),L(G(Pe)),"c"].join(" ")),this};m.__private__.line=m.line=function(b,U,ce,me,Ne){if(isNaN(b)||isNaN(U)||isNaN(ce)||isNaN(me)||!wa(Ne))throw new Error("Invalid arguments passed to jsPDF.line");return _===N.COMPAT?this.lines([[ce-b,me-U]],b,U,[1,1],Ne||"S"):this.lines([[ce-b,me-U]],b,U,[1,1]).stroke()},m.__private__.lines=m.lines=function(b,U,ce,me,Ne,Pe){var ze,ot,ut,At,St,It,cr,fr,_r,en,Rr,na;if(typeof b=="number"&&(na=ce,ce=U,U=b,b=na),me=me||[1,1],Pe=Pe||!1,isNaN(U)||isNaN(ce)||!Array.isArray(b)||!Array.isArray(me)||!wa(Ne)||typeof Pe!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Gi(U,ce),ze=me[0],ot=me[1],At=b.length,en=U,Rr=ce,ut=0;ut<At;ut++)(St=b[ut]).length===2?(en=St[0]*ze+en,Rr=St[1]*ot+Rr,As(en,Rr)):(It=St[0]*ze+en,cr=St[1]*ot+Rr,fr=St[2]*ze+en,_r=St[3]*ot+Rr,en=St[4]*ze+en,Rr=St[5]*ot+Rr,Ja(It,cr,fr,_r,en,Rr));return Pe&&nl(),Vi(Ne),this},m.path=function(b){for(var U=0;U<b.length;U++){var ce=b[U],me=ce.c;switch(ce.op){case"m":Gi(me[0],me[1]);break;case"l":As(me[0],me[1]);break;case"c":Ja.apply(this,me);break;case"h":nl()}}return this},m.__private__.rect=m.rect=function(b,U,ce,me,Ne){if(isNaN(b)||isNaN(U)||isNaN(ce)||isNaN(me)||!wa(Ne))throw new Error("Invalid arguments passed to jsPDF.rect");return _===N.COMPAT&&(me=-me),le([L(T(b)),L(G(U)),L(T(ce)),L(T(me)),"re"].join(" ")),Vi(Ne),this},m.__private__.triangle=m.triangle=function(b,U,ce,me,Ne,Pe,ze){if(isNaN(b)||isNaN(U)||isNaN(ce)||isNaN(me)||isNaN(Ne)||isNaN(Pe)||!wa(ze))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ce-b,me-U],[Ne-ce,Pe-me],[b-Ne,U-Pe]],b,U,[1,1],ze,!0),this},m.__private__.roundedRect=m.roundedRect=function(b,U,ce,me,Ne,Pe,ze){if(isNaN(b)||isNaN(U)||isNaN(ce)||isNaN(me)||isNaN(Ne)||isNaN(Pe)||!wa(ze))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var ot=4/3*(Math.SQRT2-1);return Ne=Math.min(Ne,.5*ce),Pe=Math.min(Pe,.5*me),this.lines([[ce-2*Ne,0],[Ne*ot,0,Ne,Pe-Pe*ot,Ne,Pe],[0,me-2*Pe],[0,Pe*ot,-Ne*ot,Pe,-Ne,Pe],[2*Ne-ce,0],[-Ne*ot,0,-Ne,-Pe*ot,-Ne,-Pe],[0,2*Pe-me],[0,-Pe*ot,Ne*ot,-Pe,Ne,-Pe]],b+Ne,U,[1,1],ze,!0),this},m.__private__.ellipse=m.ellipse=function(b,U,ce,me,Ne){if(isNaN(b)||isNaN(U)||isNaN(ce)||isNaN(me)||!wa(Ne))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Pe=4/3*(Math.SQRT2-1)*ce,ze=4/3*(Math.SQRT2-1)*me;return Gi(b+ce,U),Ja(b+ce,U-ze,b+Pe,U-me,b,U-me),Ja(b-Pe,U-me,b-ce,U-ze,b-ce,U),Ja(b-ce,U+ze,b-Pe,U+me,b,U+me),Ja(b+Pe,U+me,b+ce,U+ze,b+ce,U),Vi(Ne),this},m.__private__.circle=m.circle=function(b,U,ce,me){if(isNaN(b)||isNaN(U)||isNaN(ce)||!wa(me))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(b,U,ce,ce,me)},m.setFont=function(b,U,ce){return ce&&(U=D(U,ce)),Ct=Qo(b,U,{disableWarning:!1}),this};var Uc=m.__private__.getFont=m.getFont=function(){return Wt[Qo.apply(m,arguments)]};m.__private__.getFontList=m.getFontList=function(){var b,U,ce={};for(b in nr)if(nr.hasOwnProperty(b))for(U in ce[b]=[],nr[b])nr[b].hasOwnProperty(U)&&ce[b].push(U);return ce},m.addFont=function(b,U,ce,me,Ne){var Pe=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Pe.indexOf(arguments[3])!==-1?Ne=arguments[3]:arguments[3]&&Pe.indexOf(arguments[3])==-1&&(ce=D(ce,me)),Ne=Ne||"Identity-H",Wi.call(this,b,U,ce,Ne)};var ks,$i=e.lineWidth||.200025,ni=m.__private__.getLineWidth=m.getLineWidth=function(){return $i},al=m.__private__.setLineWidth=m.setLineWidth=function(b){return $i=b,le(L(T(b))+" w"),this};m.__private__.setLineDash=xt.API.setLineDash=xt.API.setLineDashPattern=function(b,U){if(b=b||[],U=U||0,isNaN(U)||!Array.isArray(b))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return b=b.map(function(ce){return L(T(ce))}).join(" "),U=L(T(U)),le("["+b+"] "+U+" d"),this};var sl=m.__private__.getLineHeight=m.getLineHeight=function(){return Ye*ks};m.__private__.getLineHeight=m.getLineHeight=function(){return Ye*ks};var il=m.__private__.setLineHeightFactor=m.setLineHeightFactor=function(b){return typeof(b=b||1.15)=="number"&&(ks=b),this},ol=m.__private__.getLineHeightFactor=m.getLineHeightFactor=function(){return ks};il(e.lineHeight);var Na=m.__private__.getHorizontalCoordinate=function(b){return T(b)},Da=m.__private__.getVerticalCoordinate=function(b){return _===N.ADVANCED?b:Nt[O].mediaBox.topRightY-Nt[O].mediaBox.bottomLeftY-T(b)},Hc=m.__private__.getHorizontalCoordinateString=m.getHorizontalCoordinateString=function(b){return L(Na(b))},Za=m.__private__.getVerticalCoordinateString=m.getVerticalCoordinateString=function(b){return L(Da(b))},ra=e.strokeColor||"0 G";m.__private__.getStrokeColor=m.getDrawColor=function(){return ne(ra)},m.__private__.setStrokeColor=m.setDrawColor=function(b,U,ce,me){return ra=ie({ch1:b,ch2:U,ch3:ce,ch4:me,pdfColorType:"draw",precision:2}),le(ra),this};var Yi=e.fillColor||"0 g";m.__private__.getFillColor=m.getFillColor=function(){return ne(Yi)},m.__private__.setFillColor=m.setFillColor=function(b,U,ce,me){return Yi=ie({ch1:b,ch2:U,ch3:ce,ch4:me,pdfColorType:"fill",precision:2}),le(Yi),this};var Ts=e.textColor||"0 g",Wc=m.__private__.getTextColor=m.getTextColor=function(){return ne(Ts)};m.__private__.setTextColor=m.setTextColor=function(b,U,ce,me){return Ts=ie({ch1:b,ch2:U,ch3:ce,ch4:me,pdfColorType:"text",precision:3}),this};var ai=e.charSpace,zc=m.__private__.getCharSpace=m.getCharSpace=function(){return parseFloat(ai||0)};m.__private__.setCharSpace=m.setCharSpace=function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return ai=b,this};var Xi=0;m.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},m.__private__.setLineCap=m.setLineCap=function(b){var U=m.CapJoinStyles[b];if(U===void 0)throw new Error("Line cap style of '"+b+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Xi=U,le(U+" J"),this};var Ki=0;m.__private__.setLineJoin=m.setLineJoin=function(b){var U=m.CapJoinStyles[b];if(U===void 0)throw new Error("Line join style of '"+b+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ki=U,le(U+" j"),this},m.__private__.setLineMiterLimit=m.__private__.setMiterLimit=m.setLineMiterLimit=m.setMiterLimit=function(b){if(b=b||0,isNaN(b))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return le(L(T(b))+" M"),this},m.GState=Oo,m.setGState=function(b){(b=typeof b=="string"?ir[An[b]]:ll(null,b)).equals(Zn)||(le("/"+b.id+" gs"),Zn=b)};var ll=function(b,U){if(!b||!An[b]){var ce=!1;for(var me in ir)if(ir.hasOwnProperty(me)&&ir[me].equals(U)){ce=!0;break}if(ce)U=ir[me];else{var Ne="GS"+(Object.keys(ir).length+1).toString(10);ir[Ne]=U,U.id=Ne}return b&&(An[b]=U.id),Mt.publish("addGState",U),U}};m.addGState=function(b,U){return ll(b,U),this},m.saveGraphicsState=function(){return le("q"),Bn.push({key:Ct,size:Ye,color:Ts}),this},m.restoreGraphicsState=function(){le("Q");var b=Bn.pop();return Ct=b.key,Ye=b.size,Ts=b.color,Zn=null,this},m.setCurrentTransformationMatrix=function(b){return le(b.toString()+" cm"),this},m.comment=function(b){return le("#"+b),this};var si=function(b,U){var ce=b||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ce},set:function(Pe){isNaN(Pe)||(ce=parseFloat(Pe))}});var me=U||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return me},set:function(Pe){isNaN(Pe)||(me=parseFloat(Pe))}});var Ne="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ne},set:function(Pe){Ne=Pe.toString()}}),this},Ji=function(b,U,ce,me){si.call(this,b,U),this.type="rect";var Ne=ce||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ne},set:function(ze){isNaN(ze)||(Ne=parseFloat(ze))}});var Pe=me||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Pe},set:function(ze){isNaN(ze)||(Pe=parseFloat(ze))}}),this},Zi=function(){this.page=Qt,this.currentPage=O,this.pages=Ce.slice(0),this.pagesContext=Nt.slice(0),this.x=Fr,this.y=Ot,this.matrix=pn,this.width=Cs(O),this.height=Qa(O),this.outputDestination=Ve,this.id="",this.objectNumber=-1};Zi.prototype.restore=function(){Qt=this.page,O=this.currentPage,Nt=this.pagesContext,Ce=this.pages,Fr=this.x,Ot=this.y,pn=this.matrix,Qi(O,this.width),eo(O,this.height),Ve=this.outputDestination};var cl=function(b,U,ce,me,Ne){Hn.push(new Zi),Qt=O=0,Ce=[],Fr=b,Ot=U,pn=Ne,zi([ce,me])},qc=function(b){if(Un[b])Hn.pop().restore();else{var U=new Zi,ce="Xo"+(Object.keys(Lr).length+1).toString(10);U.id=ce,Un[b]=ce,Lr[ce]=U,Mt.publish("addFormObject",U),Hn.pop().restore()}};for(var ii in m.beginFormObject=function(b,U,ce,me,Ne){return cl(b,U,ce,me,Ne),this},m.endFormObject=function(b){return qc(b),this},m.doFormObject=function(b,U){var ce=Lr[Un[b]];return le("q"),le(U.toString()+" cm"),le("/"+ce.id+" Do"),le("Q"),this},m.getFormObject=function(b){var U=Lr[Un[b]];return{x:U.x,y:U.y,width:U.width,height:U.height,matrix:U.matrix}},m.save=function(b,U){return b=b||"generated.pdf",(U=U||{}).returnPromise=U.returnPromise||!1,U.returnPromise===!1?(Ds(ei(Ia()),b),typeof Ds.unload=="function"&&yt.setTimeout&&setTimeout(Ds.unload,911),this):new Promise(function(ce,me){try{var Ne=Ds(ei(Ia()),b);typeof Ds.unload=="function"&&yt.setTimeout&&setTimeout(Ds.unload,911),ce(Ne)}catch(Pe){me(Pe.message)}})},xt.API)xt.API.hasOwnProperty(ii)&&(ii==="events"&&xt.API.events.length?function(b,U){var ce,me,Ne;for(Ne=U.length-1;Ne!==-1;Ne--)ce=U[Ne][0],me=U[Ne][1],b.subscribe.apply(b,[ce].concat(typeof me=="function"?[me]:me))}(Mt,xt.API.events):m[ii]=xt.API[ii]);var Cs=m.getPageWidth=function(b){return(Nt[b=b||O].mediaBox.topRightX-Nt[b].mediaBox.bottomLeftX)/at},Qi=m.setPageWidth=function(b,U){Nt[b].mediaBox.topRightX=U*at+Nt[b].mediaBox.bottomLeftX},Qa=m.getPageHeight=function(b){return(Nt[b=b||O].mediaBox.topRightY-Nt[b].mediaBox.bottomLeftY)/at},eo=m.setPageHeight=function(b,U){Nt[b].mediaBox.topRightY=U*at+Nt[b].mediaBox.bottomLeftY};return m.internal={pdfEscape:gn,getStyle:rl,getFont:Uc,getFontSize:tt,getCharSpace:zc,getTextColor:Wc,getLineHeight:sl,getLineHeightFactor:ol,getLineWidth:ni,write:Be,getHorizontalCoordinate:Na,getVerticalCoordinate:Da,getCoordinateString:Hc,getVerticalCoordinateString:Za,collections:{},newObject:gr,newAdditionalObject:se,newObjectDeferred:dr,newObjectDeferredBegin:q,getFilters:Se,putStream:Fe,events:Mt,scaleFactor:at,pageSize:{getWidth:function(){return Cs(O)},setWidth:function(b){Qi(O,b)},getHeight:function(){return Qa(O)},setHeight:function(b){eo(O,b)}},encryptionOptions:u,encryption:Qr,getEncryptor:Oc,output:ti,getNumberOfPages:Cc,pages:Ce,out:le,f2:H,f3:k,getPageInfo:tl,getPageInfoByObjId:jt,getCurrentPageInfo:Ic,getPDFVersion:v,Point:si,Rectangle:Ji,Matrix:mt,hasHotfix:el},Object.defineProperty(m.internal.pageSize,"width",{get:function(){return Cs(O)},set:function(b){Qi(O,b)},enumerable:!0,configurable:!0}),Object.defineProperty(m.internal.pageSize,"height",{get:function(){return Qa(O)},set:function(b){eo(O,b)},enumerable:!0,configurable:!0}),kc.call(m,We),Ct="F1",Jo(s,t),Mt.publish("initialized"),m}Ti.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},Ti.prototype.toHexString=function(e){return e.split("").map(function(r){return("0"+(255&r.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Ti.prototype.hexToBytes=function(e){for(var r=[],t=0;t<e.length;t+=2)r.push(String.fromCharCode(parseInt(e.substr(t,2),16)));return r.join("")},Ti.prototype.processOwnerPassword=function(e,r){return q0(z0(r).substr(0,5),e)},Ti.prototype.encryptor=function(e,r){var t=z0(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&r,r>>8&255)).substr(0,10);return function(n){return q0(t,n)}},Oo.prototype.equals=function(e){var r,t="id,objectNumber,equals";if(!e||rr(e)!==rr(this))return!1;var n=0;for(r in this)if(!(t.indexOf(r)>=0)){if(this.hasOwnProperty(r)&&!e.hasOwnProperty(r)||this[r]!==e[r])return!1;n++}for(r in e)e.hasOwnProperty(r)&&t.indexOf(r)<0&&n--;return n===0},xt.API={events:[]},xt.version="2.5.2";var ur=xt.API,nd=1,$s=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},wi=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},_t=function(e){return e.toFixed(2)},hs=function(e){return e.toFixed(5)};ur.__acroform__={};var _n=function(e,r){e.prototype=Object.create(r.prototype),e.prototype.constructor=e},bf=function(e){return e*nd},Aa=function(e){var r=new Mh,t=ct.internal.getHeight(e)||0,n=ct.internal.getWidth(e)||0;return r.BBox=[0,0,Number(_t(n)),Number(_t(t))],r},px=ur.__acroform__.setBit=function(e,r){if(e=e||0,r=r||0,isNaN(e)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<r},xx=ur.__acroform__.clearBit=function(e,r){if(e=e||0,r=r||0,isNaN(e)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<r)},gx=ur.__acroform__.getBit=function(e,r){if(isNaN(e)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<r?1:0},wr=ur.__acroform__.getBitForPdf=function(e,r){if(isNaN(e)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return gx(e,r-1)},Nr=ur.__acroform__.setBitForPdf=function(e,r){if(isNaN(e)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return px(e,r-1)},jr=ur.__acroform__.clearBitForPdf=function(e,r){if(isNaN(e)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return xx(e,r-1)},vx=ur.__acroform__.calculateCoordinates=function(e,r){var t=r.internal.getHorizontalCoordinate,n=r.internal.getVerticalCoordinate,s=e[0],o=e[1],l=e[2],c=e[3],d={};return d.lowerLeft_X=t(s)||0,d.lowerLeft_Y=n(o+c)||0,d.upperRight_X=t(s+l)||0,d.upperRight_Y=n(o)||0,[Number(_t(d.lowerLeft_X)),Number(_t(d.lowerLeft_Y)),Number(_t(d.upperRight_X)),Number(_t(d.upperRight_Y))]},yx=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var r=[],t=e._V||e.DV,n=V0(e,t),s=e.scope.internal.getFont(e.fontName,e.fontStyle).id;r.push("/Tx BMC"),r.push("q"),r.push("BT"),r.push(e.scope.__private__.encodeColorString(e.color)),r.push("/"+s+" "+_t(n.fontSize)+" Tf"),r.push("1 0 0 1 0 0 Tm"),r.push(n.text),r.push("ET"),r.push("Q"),r.push("EMC");var o=Aa(e);return o.scope=e.scope,o.stream=r.join(`
`),o}},V0=function(e,r){var t=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},s=(r=(r=r.substr(0,1)=="("?r.substr(1):r).substr(r.length-1)==")"?r.substr(0,r.length-1):r).split(" ");s=e.multiline?s.map(function(k){return k.split(`
`)}):s.map(function(k){return[k]});var o=t,l=ct.internal.getHeight(e)||0;l=l<0?-l:l;var c=ct.internal.getWidth(e)||0;c=c<0?-c:c;var d=function(k,T,W){if(k+1<s.length){var G=T+" "+s[k+1][0];return Hl(G,e,W).width<=c-4}return!1};o++;e:for(;o>0;){r="",o--;var h,u,g=Hl("3",e,o).height,x=e.multiline?l-o:(l-g)/2,m=x+=2,y=0,v=0,j=0;if(o<=0){r=`(...) Tj
`,r+="% Width of Text: "+Hl(r,e,o=12).width+", FieldWidth:"+c+`
`;break}for(var w="",N=0,_=0;_<s.length;_++)if(s.hasOwnProperty(_)){var C=!1;if(s[_].length!==1&&j!==s[_].length-1){if((g+2)*(N+2)+2>l)continue e;w+=s[_][j],C=!0,v=_,_--}else{w=(w+=s[_][j]+" ").substr(w.length-1)==" "?w.substr(0,w.length-1):w;var M=parseInt(_),D=d(M,w,o),L=_>=s.length-1;if(D&&!L){w+=" ",j=0;continue}if(D||L){if(L)v=M;else if(e.multiline&&(g+2)*(N+2)+2>l)continue e}else{if(!e.multiline||(g+2)*(N+2)+2>l)continue e;v=M}}for(var E="",P=y;P<=v;P++){var H=s[P];if(e.multiline){if(P===v){E+=H[j]+" ",j=(j+1)%H.length;continue}if(P===y){E+=H[H.length-1]+" ";continue}}E+=H[0]+" "}switch(E=E.substr(E.length-1)==" "?E.substr(0,E.length-1):E,u=Hl(E,e,o).width,e.textAlign){case"right":h=c-u-2;break;case"center":h=(c-u)/2;break;case"left":default:h=2}r+=_t(h)+" "+_t(m)+` Td
`,r+="("+$s(E)+`) Tj
`,r+=-_t(h)+` 0 Td
`,m=-(o+2),u=0,y=C?v:v+1,N++,w=""}break}return n.text=r,n.fontSize=o,n},Hl=function(e,r,t){var n=r.scope.internal.getFont(r.fontName,r.fontStyle),s=r.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:r.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:s}},bx={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},wx=function(e,r){var t={type:"reference",object:e};r.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===t.type&&n.object===t.object})===void 0&&r.internal.getPageInfo(e.page).pageContext.annotations.push(t)},Nx=function(e,r){for(var t in e)if(e.hasOwnProperty(t)){var n=t,s=e[t];r.internal.newObjectDeferredBegin(s.objId,!0),rr(s)==="object"&&typeof s.putStream=="function"&&s.putStream(),delete e[n]}},jx=function(e,r){if(r.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(xa.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(bx)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");nd=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new Bh,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in n)if(n.hasOwnProperty(s)){var o=n[s];o.objId=void 0,o.hasAnnotation&&wx(o,t)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(t){(function(n,s){var o=!n;for(var l in n||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(l)){var c=n[l],d=[],h=c.Rect;if(c.Rect&&(c.Rect=vx(c.Rect,s)),s.internal.newObjectDeferredBegin(c.objId,!0),c.DA=ct.createDefaultAppearanceStream(c),rr(c)==="object"&&typeof c.getKeyValueListForStream=="function"&&(d=c.getKeyValueListForStream()),c.Rect=h,c.hasAppearanceStream&&!c.appearanceStreamContent){var u=yx(c);d.push({key:"AP",value:"<</N "+u+">>"}),s.internal.acroformPlugin.xForms.push(u)}if(c.appearanceStreamContent){var g="";for(var x in c.appearanceStreamContent)if(c.appearanceStreamContent.hasOwnProperty(x)){var m=c.appearanceStreamContent[x];if(g+="/"+x+" ",g+="<<",Object.keys(m).length>=1||Array.isArray(m)){for(var l in m)if(m.hasOwnProperty(l)){var y=m[l];typeof y=="function"&&(y=y.call(s,c)),g+="/"+l+" "+y+" ",s.internal.acroformPlugin.xForms.indexOf(y)>=0||s.internal.acroformPlugin.xForms.push(y)}}else typeof(y=m)=="function"&&(y=y.call(s,c)),g+="/"+l+" "+y,s.internal.acroformPlugin.xForms.indexOf(y)>=0||s.internal.acroformPlugin.xForms.push(y);g+=">>"}d.push({key:"AP",value:`<<
`+g+">>"})}s.internal.putStream({additionalKeyValues:d,objectId:c.objId}),s.internal.out("endobj")}o&&Nx(s.internal.acroformPlugin.xForms,s)})(t,e)}),e.internal.acroformPlugin.isInitialized=!0}},Rh=ur.__acroform__.arrayToPdfArray=function(e,r,t){var n=function(l){return l};if(Array.isArray(e)){for(var s="[",o=0;o<e.length;o++)switch(o!==0&&(s+=" "),rr(e[o])){case"boolean":case"number":case"object":s+=e[o].toString();break;case"string":e[o].substr(0,1)!=="/"?(r!==void 0&&t&&(n=t.internal.getEncryptor(r)),s+="("+$s(n(e[o].toString()))+")"):s+=e[o].toString()}return s+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},N0=function(e,r,t){var n=function(s){return s};return r!==void 0&&t&&(n=t.internal.getEncryptor(r)),(e=e||"").toString(),e="("+$s(n(e))+")"},Ca=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Ca.prototype.toString=function(){return this.objId+" 0 R"},Ca.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Ca.prototype.getKeyValueListForStream=function(){var e=[],r=Object.getOwnPropertyNames(this).filter(function(o){return o!="content"&&o!="appearanceStreamContent"&&o!="scope"&&o!="objId"&&o.substring(0,1)!="_"});for(var t in r)if(Object.getOwnPropertyDescriptor(this,r[t]).configurable===!1){var n=r[t],s=this[n];s&&(Array.isArray(s)?e.push({key:n,value:Rh(s,this.objId,this.scope)}):s instanceof Ca?(s.scope=this.scope,e.push({key:n,value:s.objId+" 0 R"})):typeof s!="function"&&e.push({key:n,value:s}))}return e};var Mh=function(){Ca.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,r=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){e=t.trim()},get:function(){return e||null}})};_n(Mh,Ca);var Bh=function(){Ca.call(this);var e,r=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return r.length>0?r:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return r}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var t=function(n){return n};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+$s(t(e))+")"}},set:function(t){e=t}})};_n(Bh,Ca);var xa=function e(){Ca.call(this);var r=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return r},set:function(w){if(isNaN(w))throw new Error('Invalid value "'+w+'" for attribute F supplied.');r=w}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!wr(r,3)},set:function(w){w?this.F=Nr(r,3):this.F=jr(r,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(w){if(isNaN(w))throw new Error('Invalid value "'+w+'" for attribute Ff supplied.');t=w}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(w){n=w!==void 0?w:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(w){n[0]=w}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(w){n[1]=w}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(w){n[2]=w}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(w){n[3]=w}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(w){switch(w){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=w;break;default:throw new Error('Invalid value "'+w+'" for attribute FT supplied.')}}});var o=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!o||o.length<1){if(this instanceof Ql)return;o="FieldObject"+e.FieldNum++}var w=function(N){return N};return this.scope&&(w=this.scope.internal.getEncryptor(this.objId)),"("+$s(w(o))+")"},set:function(w){o=w.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return o},set:function(w){o=w}});var l="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return l},set:function(w){l=w}});var c="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return c},set:function(w){c=w}});var d=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return d},set:function(w){d=w}});var h=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return h===void 0?50/nd:h},set:function(w){h=w}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(w){u=w}});var g="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!g||this instanceof Ql||this instanceof ys))return N0(g,this.objId,this.scope)},set:function(w){w=w.toString(),g=w}});var x=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(x)return this instanceof Dr?x:N0(x,this.objId,this.scope)},set:function(w){w=w.toString(),x=this instanceof Dr?w:w.substr(0,1)==="("?wi(w.substr(1,w.length-2)):wi(w)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Dr?wi(x.substr(1,x.length-1)):x},set:function(w){w=w.toString(),x=this instanceof Dr?"/"+w:w}});var m=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(m)return m},set:function(w){this.V=w}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof Dr?m:N0(m,this.objId,this.scope)},set:function(w){w=w.toString(),m=this instanceof Dr?w:w.substr(0,1)==="("?wi(w.substr(1,w.length-2)):wi(w)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Dr?wi(m.substr(1,m.length-1)):m},set:function(w){w=w.toString(),m=this instanceof Dr?"/"+w:w}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var y,v=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return v},set:function(w){w=!!w,v=w}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(y)return y},set:function(w){y=w}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,1)},set:function(w){w?this.Ff=Nr(this.Ff,1):this.Ff=jr(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,2)},set:function(w){w?this.Ff=Nr(this.Ff,2):this.Ff=jr(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,3)},set:function(w){w?this.Ff=Nr(this.Ff,3):this.Ff=jr(this.Ff,3)}});var j=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(j!==null)return j},set:function(w){if([0,1,2].indexOf(w)===-1)throw new Error('Invalid value "'+w+'" for attribute Q supplied.');j=w}}),Object.defineProperty(this,"textAlign",{get:function(){var w;switch(j){case 0:default:w="left";break;case 1:w="center";break;case 2:w="right"}return w},configurable:!0,enumerable:!0,set:function(w){switch(w){case"right":case 2:j=2;break;case"center":case 1:j=1;break;case"left":case 0:default:j=0}}})};_n(xa,Ca);var Bs=function(){xa.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){e=t}});var r=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Rh(r,this.objId,this.scope)},set:function(t){var n,s;s=[],typeof(n=t)=="string"&&(s=function(o,l,c){c||(c=1);for(var d,h=[];d=l.exec(o);)h.push(d[c]);return h}(n,/\((.*?)\)/g)),r=s}}),this.getOptions=function(){return r},this.setOptions=function(t){r=t,this.sort&&r.sort()},this.addOption=function(t){t=(t=t||"").toString(),r.push(t),this.sort&&r.sort()},this.removeOption=function(t,n){for(n=n||!1,t=(t=t||"").toString();r.indexOf(t)!==-1&&(r.splice(r.indexOf(t),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,18)},set:function(t){t?this.Ff=Nr(this.Ff,18):this.Ff=jr(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=Nr(this.Ff,19):this.Ff=jr(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,20)},set:function(t){t?(this.Ff=Nr(this.Ff,20),r.sort()):this.Ff=jr(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,22)},set:function(t){t?this.Ff=Nr(this.Ff,22):this.Ff=jr(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,23)},set:function(t){t?this.Ff=Nr(this.Ff,23):this.Ff=jr(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,27)},set:function(t){t?this.Ff=Nr(this.Ff,27):this.Ff=jr(this.Ff,27)}}),this.hasAppearanceStream=!1};_n(Bs,xa);var Us=function(){Bs.call(this),this.fontName="helvetica",this.combo=!1};_n(Us,Bs);var Hs=function(){Us.call(this),this.combo=!0};_n(Hs,Us);var jo=function(){Hs.call(this),this.edit=!0};_n(jo,Hs);var Dr=function(){xa.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,15)},set:function(t){t?this.Ff=Nr(this.Ff,15):this.Ff=jr(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,16)},set:function(t){t?this.Ff=Nr(this.Ff,16):this.Ff=jr(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,17)},set:function(t){t?this.Ff=Nr(this.Ff,17):this.Ff=jr(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,26)},set:function(t){t?this.Ff=Nr(this.Ff,26):this.Ff=jr(this.Ff,26)}});var e,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(o){return o};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(r).length!==0){var n,s=[];for(n in s.push("<<"),r)s.push("/"+n+" ("+$s(t(r[n]))+")");return s.push(">>"),s.join(`
`)}},set:function(t){rr(t)==="object"&&(r=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(t){typeof t=="string"&&(r.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(t){e="/"+t}})};_n(Dr,xa);var So=function(){Dr.call(this),this.pushButton=!0};_n(So,Dr);var Ws=function(){Dr.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r!==void 0?r:[]}})};_n(Ws,Dr);var Ql=function(){var e,r;xa.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(s){e=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return r},set:function(s){r=s}});var t,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(c){return c};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var o,l=[];for(o in l.push("<<"),n)l.push("/"+o+" ("+$s(s(n[o]))+")");return l.push(">>"),l.join(`
`)},set:function(s){rr(s)==="object"&&(n=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(s){typeof s=="string"&&(n.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(s){t=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(s){t="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=ct.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};_n(Ql,xa),Ws.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var r in this.Kids)if(this.Kids.hasOwnProperty(r)){var t=this.Kids[r];t.appearanceStreamContent=e.createAppearanceStream(t.optionName),t.caption=e.getCA()}},Ws.prototype.createOption=function(e){var r=new Ql;return r.Parent=this,r.optionName=e,this.Kids.push(r),Sx.call(this.scope,r),r};var _o=function(){Dr.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=ct.CheckBox.createAppearanceStream()};_n(_o,Dr);var ys=function(){xa.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,13)},set:function(r){r?this.Ff=Nr(this.Ff,13):this.Ff=jr(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,21)},set:function(r){r?this.Ff=Nr(this.Ff,21):this.Ff=jr(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,23)},set:function(r){r?this.Ff=Nr(this.Ff,23):this.Ff=jr(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,24)},set:function(r){r?this.Ff=Nr(this.Ff,24):this.Ff=jr(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,25)},set:function(r){r?this.Ff=Nr(this.Ff,25):this.Ff=jr(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,26)},set:function(r){r?this.Ff=Nr(this.Ff,26):this.Ff=jr(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){Number.isInteger(r)&&(e=r)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};_n(ys,xa);var Ao=function(){ys.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,14)},set:function(e){e?this.Ff=Nr(this.Ff,14):this.Ff=jr(this.Ff,14)}}),this.password=!0};_n(Ao,ys);var ct={CheckBox:{createAppearanceStream:function(){return{N:{On:ct.CheckBox.YesNormal},D:{On:ct.CheckBox.YesPushDown,Off:ct.CheckBox.OffPushDown}}},YesPushDown:function(e){var r=Aa(e);r.scope=e.scope;var t=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,s=e.scope.__private__.encodeColorString(e.color),o=V0(e,e.caption);return t.push("0.749023 g"),t.push("0 0 "+_t(ct.internal.getWidth(e))+" "+_t(ct.internal.getHeight(e))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+n+" "+_t(o.fontSize)+" Tf "+s),t.push("BT"),t.push(o.text),t.push("ET"),t.push("Q"),t.push("EMC"),r.stream=t.join(`
`),r},YesNormal:function(e){var r=Aa(e);r.scope=e.scope;var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),s=[],o=ct.internal.getHeight(e),l=ct.internal.getWidth(e),c=V0(e,e.caption);return s.push("1 g"),s.push("0 0 "+_t(l)+" "+_t(o)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+_t(l-1)+" "+_t(o-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+t+" "+_t(c.fontSize)+" Tf "+n),s.push(c.text),s.push("ET"),s.push("Q"),r.stream=s.join(`
`),r},OffPushDown:function(e){var r=Aa(e);r.scope=e.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+_t(ct.internal.getWidth(e))+" "+_t(ct.internal.getHeight(e))+" re"),t.push("f"),r.stream=t.join(`
`),r}},RadioButton:{Circle:{createAppearanceStream:function(e){var r={D:{Off:ct.RadioButton.Circle.OffPushDown},N:{}};return r.N[e]=ct.RadioButton.Circle.YesNormal,r.D[e]=ct.RadioButton.Circle.YesPushDown,r},getCA:function(){return"l"},YesNormal:function(e){var r=Aa(e);r.scope=e.scope;var t=[],n=ct.internal.getWidth(e)<=ct.internal.getHeight(e)?ct.internal.getWidth(e)/4:ct.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=ct.internal.Bezier_C,o=Number((n*s).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+hs(ct.internal.getWidth(e)/2)+" "+hs(ct.internal.getHeight(e)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),t.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),t.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),t.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),t.push("f"),t.push("Q"),r.stream=t.join(`
`),r},YesPushDown:function(e){var r=Aa(e);r.scope=e.scope;var t=[],n=ct.internal.getWidth(e)<=ct.internal.getHeight(e)?ct.internal.getWidth(e)/4:ct.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),o=Number((s*ct.internal.Bezier_C).toFixed(5)),l=Number((n*ct.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+hs(ct.internal.getWidth(e)/2)+" "+hs(ct.internal.getHeight(e)/2)+" cm"),t.push(s+" 0 m"),t.push(s+" "+o+" "+o+" "+s+" 0 "+s+" c"),t.push("-"+o+" "+s+" -"+s+" "+o+" -"+s+" 0 c"),t.push("-"+s+" -"+o+" -"+o+" -"+s+" 0 -"+s+" c"),t.push(o+" -"+s+" "+s+" -"+o+" "+s+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+hs(ct.internal.getWidth(e)/2)+" "+hs(ct.internal.getHeight(e)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+l+" "+l+" "+n+" 0 "+n+" c"),t.push("-"+l+" "+n+" -"+n+" "+l+" -"+n+" 0 c"),t.push("-"+n+" -"+l+" -"+l+" -"+n+" 0 -"+n+" c"),t.push(l+" -"+n+" "+n+" -"+l+" "+n+" 0 c"),t.push("f"),t.push("Q"),r.stream=t.join(`
`),r},OffPushDown:function(e){var r=Aa(e);r.scope=e.scope;var t=[],n=ct.internal.getWidth(e)<=ct.internal.getHeight(e)?ct.internal.getWidth(e)/4:ct.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),o=Number((s*ct.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+hs(ct.internal.getWidth(e)/2)+" "+hs(ct.internal.getHeight(e)/2)+" cm"),t.push(s+" 0 m"),t.push(s+" "+o+" "+o+" "+s+" 0 "+s+" c"),t.push("-"+o+" "+s+" -"+s+" "+o+" -"+s+" 0 c"),t.push("-"+s+" -"+o+" -"+o+" -"+s+" 0 -"+s+" c"),t.push(o+" -"+s+" "+s+" -"+o+" "+s+" 0 c"),t.push("f"),t.push("Q"),r.stream=t.join(`
`),r}},Cross:{createAppearanceStream:function(e){var r={D:{Off:ct.RadioButton.Cross.OffPushDown},N:{}};return r.N[e]=ct.RadioButton.Cross.YesNormal,r.D[e]=ct.RadioButton.Cross.YesPushDown,r},getCA:function(){return"8"},YesNormal:function(e){var r=Aa(e);r.scope=e.scope;var t=[],n=ct.internal.calculateCross(e);return t.push("q"),t.push("1 1 "+_t(ct.internal.getWidth(e)-2)+" "+_t(ct.internal.getHeight(e)-2)+" re"),t.push("W"),t.push("n"),t.push(_t(n.x1.x)+" "+_t(n.x1.y)+" m"),t.push(_t(n.x2.x)+" "+_t(n.x2.y)+" l"),t.push(_t(n.x4.x)+" "+_t(n.x4.y)+" m"),t.push(_t(n.x3.x)+" "+_t(n.x3.y)+" l"),t.push("s"),t.push("Q"),r.stream=t.join(`
`),r},YesPushDown:function(e){var r=Aa(e);r.scope=e.scope;var t=ct.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+_t(ct.internal.getWidth(e))+" "+_t(ct.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+_t(ct.internal.getWidth(e)-2)+" "+_t(ct.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(_t(t.x1.x)+" "+_t(t.x1.y)+" m"),n.push(_t(t.x2.x)+" "+_t(t.x2.y)+" l"),n.push(_t(t.x4.x)+" "+_t(t.x4.y)+" m"),n.push(_t(t.x3.x)+" "+_t(t.x3.y)+" l"),n.push("s"),n.push("Q"),r.stream=n.join(`
`),r},OffPushDown:function(e){var r=Aa(e);r.scope=e.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+_t(ct.internal.getWidth(e))+" "+_t(ct.internal.getHeight(e))+" re"),t.push("f"),r.stream=t.join(`
`),r}}},createDefaultAppearanceStream:function(e){var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,t=e.scope.__private__.encodeColorString(e.color);return"/"+r+" "+e.fontSize+" Tf "+t}};ct.internal={Bezier_C:.551915024494,calculateCross:function(e){var r=ct.internal.getWidth(e),t=ct.internal.getHeight(e),n=Math.min(r,t);return{x1:{x:(r-n)/2,y:(t-n)/2+n},x2:{x:(r-n)/2+n,y:(t-n)/2},x3:{x:(r-n)/2,y:(t-n)/2},x4:{x:(r-n)/2+n,y:(t-n)/2+n}}}},ct.internal.getWidth=function(e){var r=0;return rr(e)==="object"&&(r=bf(e.Rect[2])),r},ct.internal.getHeight=function(e){var r=0;return rr(e)==="object"&&(r=bf(e.Rect[3])),r};var Sx=ur.addField=function(e){if(jx(this,e),!(e instanceof xa))throw new Error("Invalid argument passed to jsPDF.addField.");var r;return(r=e).scope.internal.acroformPlugin.printedOut&&(r.scope.internal.acroformPlugin.printedOut=!1,r.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),r.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(r),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};ur.AcroFormChoiceField=Bs,ur.AcroFormListBox=Us,ur.AcroFormComboBox=Hs,ur.AcroFormEditBox=jo,ur.AcroFormButton=Dr,ur.AcroFormPushButton=So,ur.AcroFormRadioButton=Ws,ur.AcroFormCheckBox=_o,ur.AcroFormTextField=ys,ur.AcroFormPasswordField=Ao,ur.AcroFormAppearance=ct,ur.AcroForm={ChoiceField:Bs,ListBox:Us,ComboBox:Hs,EditBox:jo,Button:Dr,PushButton:So,RadioButton:Ws,CheckBox:_o,TextField:ys,PasswordField:Ao,Appearance:ct},xt.AcroForm={ChoiceField:Bs,ListBox:Us,ComboBox:Hs,EditBox:jo,Button:Dr,PushButton:So,RadioButton:Ws,CheckBox:_o,TextField:ys,PasswordField:Ao,Appearance:ct};var _x=xt.AcroForm;function Uh(e){return e.reduce(function(r,t,n){return r[t]=n,r},{})}(function(e){e.__addimage__={};var r="UNKNOWN",t={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=e.__addimage__.getImageFileTypeByImageData=function(k,T){var W,G,de,J,Z,oe=r;if((T=T||r)==="RGBA"||k.data!==void 0&&k.data instanceof Uint8ClampedArray&&"height"in k&&"width"in k)return"RGBA";if(D(k))for(Z in t)for(de=t[Z],W=0;W<de.length;W+=1){for(J=!0,G=0;G<de[W].length;G+=1)if(de[W][G]!==void 0&&de[W][G]!==k[G]){J=!1;break}if(J===!0){oe=Z;break}}else for(Z in t)for(de=t[Z],W=0;W<de.length;W+=1){for(J=!0,G=0;G<de[W].length;G+=1)if(de[W][G]!==void 0&&de[W][G]!==k.charCodeAt(G)){J=!1;break}if(J===!0){oe=Z;break}}return oe===r&&T!==r&&(oe=T),oe},s=function k(T){for(var W=this.internal.write,G=this.internal.putStream,de=(0,this.internal.getFilters)();de.indexOf("FlateEncode")!==-1;)de.splice(de.indexOf("FlateEncode"),1);T.objectId=this.internal.newObject();var J=[];if(J.push({key:"Type",value:"/XObject"}),J.push({key:"Subtype",value:"/Image"}),J.push({key:"Width",value:T.width}),J.push({key:"Height",value:T.height}),T.colorSpace===j.INDEXED?J.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(T.palette.length/3-1)+" "+("sMask"in T&&T.sMask!==void 0?T.objectId+2:T.objectId+1)+" 0 R]"}):(J.push({key:"ColorSpace",value:"/"+T.colorSpace}),T.colorSpace===j.DEVICE_CMYK&&J.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),J.push({key:"BitsPerComponent",value:T.bitsPerComponent}),"decodeParameters"in T&&T.decodeParameters!==void 0&&J.push({key:"DecodeParms",value:"<<"+T.decodeParameters+">>"}),"transparency"in T&&Array.isArray(T.transparency)){for(var Z="",oe=0,ae=T.transparency.length;oe<ae;oe++)Z+=T.transparency[oe]+" "+T.transparency[oe]+" ";J.push({key:"Mask",value:"["+Z+"]"})}T.sMask!==void 0&&J.push({key:"SMask",value:T.objectId+1+" 0 R"});var pe=T.filter!==void 0?["/"+T.filter]:void 0;if(G({data:T.data,additionalKeyValues:J,alreadyAppliedFilters:pe,objectId:T.objectId}),W("endobj"),"sMask"in T&&T.sMask!==void 0){var be="/Predictor "+T.predictor+" /Colors 1 /BitsPerComponent "+T.bitsPerComponent+" /Columns "+T.width,A={width:T.width,height:T.height,colorSpace:"DeviceGray",bitsPerComponent:T.bitsPerComponent,decodeParameters:be,data:T.sMask};"filter"in T&&(A.filter=T.filter),k.call(this,A)}if(T.colorSpace===j.INDEXED){var O=this.internal.newObject();G({data:E(new Uint8Array(T.palette)),objectId:O}),W("endobj")}},o=function(){var k=this.internal.collections.addImage_images;for(var T in k)s.call(this,k[T])},l=function(){var k,T=this.internal.collections.addImage_images,W=this.internal.write;for(var G in T)W("/I"+(k=T[G]).index,k.objectId,"0","R")},c=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},d=function(){var k=this.internal.collections.addImage_images;return c.call(this),k},h=function(){return Object.keys(this.internal.collections.addImage_images).length},u=function(k){return typeof e["process"+k.toUpperCase()]=="function"},g=function(k){return rr(k)==="object"&&k.nodeType===1},x=function(k,T){if(k.nodeName==="IMG"&&k.hasAttribute("src")){var W=""+k.getAttribute("src");if(W.indexOf("data:image/")===0)return No(unescape(W).split("base64,").pop());var G=e.loadFile(W,!0);if(G!==void 0)return G}if(k.nodeName==="CANVAS"){if(k.width===0||k.height===0)throw new Error("Given canvas must have data. Canvas width: "+k.width+", height: "+k.height);var de;switch(T){case"PNG":de="image/png";break;case"WEBP":de="image/webp";break;case"JPEG":case"JPG":default:de="image/jpeg"}return No(k.toDataURL(de,1).split("base64,").pop())}},m=function(k){var T=this.internal.collections.addImage_images;if(T){for(var W in T)if(k===T[W].alias)return T[W]}},y=function(k,T,W){return k||T||(k=-96,T=-96),k<0&&(k=-1*W.width*72/k/this.internal.scaleFactor),T<0&&(T=-1*W.height*72/T/this.internal.scaleFactor),k===0&&(k=T*W.width/W.height),T===0&&(T=k*W.height/W.width),[k,T]},v=function(k,T,W,G,de,J){var Z=y.call(this,W,G,de),oe=this.internal.getCoordinateString,ae=this.internal.getVerticalCoordinateString,pe=d.call(this);if(W=Z[0],G=Z[1],pe[de.index]=de,J){J*=Math.PI/180;var be=Math.cos(J),A=Math.sin(J),O=function(R){return R.toFixed(4)},I=[O(be),O(A),O(-1*A),O(be),0,0,"cm"]}this.internal.write("q"),J?(this.internal.write([1,"0","0",1,oe(k),ae(T+G),"cm"].join(" ")),this.internal.write(I.join(" ")),this.internal.write([oe(W),"0","0",oe(G),"0","0","cm"].join(" "))):this.internal.write([oe(W),"0","0",oe(G),oe(k),ae(T+G),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+de.index+" Do"),this.internal.write("Q")},j=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var w=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},N=e.__addimage__.sHashCode=function(k){var T,W,G=0;if(typeof k=="string")for(W=k.length,T=0;T<W;T++)G=(G<<5)-G+k.charCodeAt(T),G|=0;else if(D(k))for(W=k.byteLength/2,T=0;T<W;T++)G=(G<<5)-G+k[T],G|=0;return G},_=e.__addimage__.validateStringAsBase64=function(k){(k=k||"").toString().trim();var T=!0;return k.length===0&&(T=!1),k.length%4!=0&&(T=!1),/^[A-Za-z0-9+/]+$/.test(k.substr(0,k.length-2))===!1&&(T=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(k.substr(-2))===!1&&(T=!1),T},C=e.__addimage__.extractImageFromDataUrl=function(k){var T=(k=k||"").split("base64,"),W=null;if(T.length===2){var G=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(T[0]);Array.isArray(G)&&(W={mimeType:G[1],charset:G[2],data:T[1]})}return W},M=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(k){return M()&&k instanceof ArrayBuffer};var D=e.__addimage__.isArrayBufferView=function(k){return M()&&typeof Uint32Array<"u"&&(k instanceof Int8Array||k instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&k instanceof Uint8ClampedArray||k instanceof Int16Array||k instanceof Uint16Array||k instanceof Int32Array||k instanceof Uint32Array||k instanceof Float32Array||k instanceof Float64Array)},L=e.__addimage__.binaryStringToUint8Array=function(k){for(var T=k.length,W=new Uint8Array(T),G=0;G<T;G++)W[G]=k.charCodeAt(G);return W},E=e.__addimage__.arrayBufferToBinaryString=function(k){for(var T="",W=D(k)?k:new Uint8Array(k),G=0;G<W.length;G+=8192)T+=String.fromCharCode.apply(null,W.subarray(G,G+8192));return T};e.addImage=function(){var k,T,W,G,de,J,Z,oe,ae;if(typeof arguments[1]=="number"?(T=r,W=arguments[1],G=arguments[2],de=arguments[3],J=arguments[4],Z=arguments[5],oe=arguments[6],ae=arguments[7]):(T=arguments[1],W=arguments[2],G=arguments[3],de=arguments[4],J=arguments[5],Z=arguments[6],oe=arguments[7],ae=arguments[8]),rr(k=arguments[0])==="object"&&!g(k)&&"imageData"in k){var pe=k;k=pe.imageData,T=pe.format||T||r,W=pe.x||W||0,G=pe.y||G||0,de=pe.w||pe.width||de,J=pe.h||pe.height||J,Z=pe.alias||Z,oe=pe.compression||oe,ae=pe.rotation||pe.angle||ae}var be=this.internal.getFilters();if(oe===void 0&&be.indexOf("FlateEncode")!==-1&&(oe="SLOW"),isNaN(W)||isNaN(G))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var A=P.call(this,k,T,Z,oe);return v.call(this,W,G,de,J,A,ae),this};var P=function(k,T,W,G){var de,J,Z;if(typeof k=="string"&&n(k)===r){k=unescape(k);var oe=H(k,!1);(oe!==""||(oe=e.loadFile(k,!0))!==void 0)&&(k=oe)}if(g(k)&&(k=x(k,T)),T=n(k,T),!u(T))throw new Error("addImage does not support files of type '"+T+"', please ensure that a plugin for '"+T+"' support is added.");if(((Z=W)==null||Z.length===0)&&(W=function(ae){return typeof ae=="string"||D(ae)?N(ae):D(ae.data)?N(ae.data):null}(k)),(de=m.call(this,W))||(M()&&(k instanceof Uint8Array||T==="RGBA"||(J=k,k=L(k))),de=this["process"+T.toUpperCase()](k,h.call(this),W,function(ae){return ae&&typeof ae=="string"&&(ae=ae.toUpperCase()),ae in e.image_compression?ae:w.NONE}(G),J)),!de)throw new Error("An unknown error occurred whilst processing the image.");return de},H=e.__addimage__.convertBase64ToBinaryString=function(k,T){var W;T=typeof T!="boolean"||T;var G,de="";if(typeof k=="string"){G=(W=C(k))!==null?W.data:k;try{de=No(G)}catch(J){if(T)throw _(G)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+J.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return de};e.getImageProperties=function(k){var T,W,G="";if(g(k)&&(k=x(k)),typeof k=="string"&&n(k)===r&&((G=H(k,!1))===""&&(G=e.loadFile(k)||""),k=G),W=n(k),!u(W))throw new Error("addImage does not support files of type '"+W+"', please ensure that a plugin for '"+W+"' support is added.");if(!M()||k instanceof Uint8Array||(k=L(k)),!(T=this["process"+W.toUpperCase()](k)))throw new Error("An unknown error occurred whilst processing the image");return T.fileType=W,T}})(xt.API),function(e){var r=function(t){if(t!==void 0&&t!="")return!0};xt.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(t){for(var n,s,o,l=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString,d=this.internal.getPageInfoByObjId(t.objId),h=t.pageContext.annotations,u=!1,g=0;g<h.length&&!u;g++)switch((n=h[g]).type){case"link":(r(n.options.url)||r(n.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var x=0;x<h.length;x++){n=h[x];var m=this.internal.pdfEscape,y=this.internal.getEncryptor(t.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var v=this.internal.newAdditionalObject(),j=this.internal.newAdditionalObject(),w=this.internal.getEncryptor(v.objId),N=n.title||"Note";o="<</Type /Annot /Subtype /Text "+(s="/Rect ["+l(n.bounds.x)+" "+c(n.bounds.y+n.bounds.h)+" "+l(n.bounds.x+n.bounds.w)+" "+c(n.bounds.y)+"] ")+"/Contents ("+m(w(n.contents))+")",o+=" /Popup "+j.objId+" 0 R",o+=" /P "+d.objId+" 0 R",o+=" /T ("+m(w(N))+") >>",v.content=o;var _=v.objId+" 0 R";o="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+l(n.bounds.x+30)+" "+c(n.bounds.y+n.bounds.h)+" "+l(n.bounds.x+n.bounds.w+30)+" "+c(n.bounds.y)+"] ")+" /Parent "+_,n.open&&(o+=" /Open true"),o+=" >>",j.content=o,this.internal.write(v.objId,"0 R",j.objId,"0 R");break;case"freetext":s="/Rect ["+l(n.bounds.x)+" "+c(n.bounds.y)+" "+l(n.bounds.x+n.bounds.w)+" "+c(n.bounds.y+n.bounds.h)+"] ";var C=n.color||"#000000";o="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+m(y(n.contents))+")",o+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+C+")",o+=" /Border [0 0 0]",o+=" >>",this.internal.write(o);break;case"link":if(n.options.name){var M=this.annotations._nameMap[n.options.name];n.options.pageNumber=M.page,n.options.top=M.y}else n.options.top||(n.options.top=0);if(s="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",o="",n.options.url)o="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+m(y(n.options.url))+") >>";else if(n.options.pageNumber)switch(o="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":o+=" /Fit]";break;case"FitH":o+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,o+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var D=c(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),o+=" /XYZ "+n.options.left+" "+D+" "+n.options.zoom+"]"}o!=""&&(o+=" >>",this.internal.write(o))}}this.internal.write("]")}}]),e.createAnnotation=function(t){var n=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":n.pageContext.annotations.push(t)}},e.link=function(t,n,s,o,l){var c=this.internal.getCurrentPageInfo(),d=this.internal.getCoordinateString,h=this.internal.getVerticalCoordinateString;c.pageContext.annotations.push({finalBounds:{x:d(t),y:h(n),w:d(t+s),h:h(n+o)},options:l,type:"link"})},e.textWithLink=function(t,n,s,o){var l,c,d=this.getTextWidth(t),h=this.internal.getLineHeight()/this.internal.scaleFactor;if(o.maxWidth!==void 0){c=o.maxWidth;var u=this.splitTextToSize(t,c).length;l=Math.ceil(h*u)}else c=d,l=h;return this.text(t,n,s,o),s+=.2*h,o.align==="center"&&(n-=d/2),o.align==="right"&&(n-=d),this.link(n,s-h,c,l,o),d},e.getTextWidth=function(t){var n=this.internal.getFontSize();return this.getStringUnitWidth(t)*n/this.internal.scaleFactor}}(xt.API),function(e){var r={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];e.__arabicParser__={};var o=e.__arabicParser__.isInArabicSubstitutionA=function(v){return r[v.charCodeAt(0)]!==void 0},l=e.__arabicParser__.isArabicLetter=function(v){return typeof v=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(v)},c=e.__arabicParser__.isArabicEndLetter=function(v){return l(v)&&o(v)&&r[v.charCodeAt(0)].length<=2},d=e.__arabicParser__.isArabicAlfLetter=function(v){return l(v)&&s.indexOf(v.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(v){return l(v)&&o(v)&&r[v.charCodeAt(0)].length>=1};var h=e.__arabicParser__.arabicLetterHasFinalForm=function(v){return l(v)&&o(v)&&r[v.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(v){return l(v)&&o(v)&&r[v.charCodeAt(0)].length>=3};var u=e.__arabicParser__.arabicLetterHasMedialForm=function(v){return l(v)&&o(v)&&r[v.charCodeAt(0)].length==4},g=e.__arabicParser__.resolveLigatures=function(v){var j=0,w=t,N="",_=0;for(j=0;j<v.length;j+=1)w[v.charCodeAt(j)]!==void 0?(_++,typeof(w=w[v.charCodeAt(j)])=="number"&&(N+=String.fromCharCode(w),w=t,_=0),j===v.length-1&&(w=t,N+=v.charAt(j-(_-1)),j-=_-1,_=0)):(w=t,N+=v.charAt(j-_),j-=_,_=0);return N};e.__arabicParser__.isArabicDiacritic=function(v){return v!==void 0&&n[v.charCodeAt(0)]!==void 0};var x=e.__arabicParser__.getCorrectForm=function(v,j,w){return l(v)?o(v)===!1?-1:!h(v)||!l(j)&&!l(w)||!l(w)&&c(j)||c(v)&&!l(j)||c(v)&&d(j)||c(v)&&c(j)?0:u(v)&&l(j)&&!c(j)&&l(w)&&h(w)?3:c(v)||!l(w)?1:2:-1},m=function(v){var j=0,w=0,N=0,_="",C="",M="",D=(v=v||"").split("\\s+"),L=[];for(j=0;j<D.length;j+=1){for(L.push(""),w=0;w<D[j].length;w+=1)_=D[j][w],C=D[j][w-1],M=D[j][w+1],l(_)?(N=x(_,C,M),L[j]+=N!==-1?String.fromCharCode(r[_.charCodeAt(0)][N]):_):L[j]+=_;L[j]=g(L[j])}return L.join(" ")},y=e.__arabicParser__.processArabic=e.processArabic=function(){var v,j=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,w=[];if(Array.isArray(j)){var N=0;for(w=[],N=0;N<j.length;N+=1)Array.isArray(j[N])?w.push([m(j[N][0]),j[N][1],j[N][2]]):w.push([m(j[N])]);v=w}else v=m(j);return typeof arguments[0]=="string"?v:(arguments[0].text=v,arguments[0])};e.events.push(["preProcessText",y])}(xt.API),xt.API.autoPrint=function(e){var r;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){r=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+r+" 0 R")})}return this},function(e){var r=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(c){t=c}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(c){n=isNaN(c)||Number.isInteger(c)===!1||c<0?150:c,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(c){s=isNaN(c)||Number.isInteger(c)===!1||c<0?300:c,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var o=[];Object.defineProperty(this,"childNodes",{get:function(){return o},set:function(c){o=c}});var l={};Object.defineProperty(this,"style",{get:function(){return l},set:function(c){l=c}}),Object.defineProperty(this,"parentNode",{})};r.prototype.getContext=function(t,n){var s;if((t=t||"2d")!=="2d")return null;for(s in n)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=n[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},r.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new r,this.canvas.pdf=this}])}(xt.API),function(e){var r={left:0,top:0,bottom:0,right:0},t=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},r),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new o,this.internal.__cell__.pages=1},o=function(){var d=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return d},set:function(v){d=v}});var h=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return h},set:function(v){h=v}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(v){u=v}});var g=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return g},set:function(v){g=v}});var x=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return x},set:function(v){x=v}});var m=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return m},set:function(v){m=v}});var y=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return y},set:function(v){y=v}}),this};o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},o.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(d){return n.call(this),this.internal.__cell__.headerFunction=typeof d=="function"?d:void 0,this},e.getTextDimensions=function(d,h){n.call(this);var u=(h=h||{}).fontSize||this.getFontSize(),g=h.font||this.getFont(),x=h.scaleFactor||this.internal.scaleFactor,m=0,y=0,v=0,j=this;if(!Array.isArray(d)&&typeof d!="string"){if(typeof d!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");d=String(d)}var w=h.maxWidth;w>0?typeof d=="string"?d=this.splitTextToSize(d,w):Object.prototype.toString.call(d)==="[object Array]"&&(d=d.reduce(function(_,C){return _.concat(j.splitTextToSize(C,w))},[])):d=Array.isArray(d)?d:[d];for(var N=0;N<d.length;N++)m<(v=this.getStringUnitWidth(d[N],{font:g})*u)&&(m=v);return m!==0&&(y=d.length),{w:m/=x,h:Math.max((y*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/x,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var d=this.internal.__cell__.margins||r;return this.internal.__cell__.lastCell=new o(d.left,d.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var l=e.cell=function(){var d;d=arguments[0]instanceof o?arguments[0]:new o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var h=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,g=this.internal.__cell__.margins||r,x=this.internal.__cell__.tableHeaderRow,m=this.internal.__cell__.printHeaders;return h.lineNumber!==void 0&&(h.lineNumber===d.lineNumber?(d.x=(h.x||0)+(h.width||0),d.y=h.y||0):h.y+h.height+d.height+g.bottom>this.getPageHeight()?(this.cellAddPage(),d.y=g.top,m&&x&&(this.printHeaderRow(d.lineNumber,!0),d.y+=x[0].height)):d.y=h.y+h.height||d.y),d.text[0]!==void 0&&(this.rect(d.x,d.y,d.width,d.height,t===!0?"FD":void 0),d.align==="right"?this.text(d.text,d.x+d.width-u,d.y+u,{align:"right",baseline:"top"}):d.align==="center"?this.text(d.text,d.x+d.width/2,d.y+u,{align:"center",baseline:"top",maxWidth:d.width-u-u}):this.text(d.text,d.x+u,d.y+u,{align:"left",baseline:"top",maxWidth:d.width-u-u})),this.internal.__cell__.lastCell=d,this};e.table=function(d,h,u,g,x){if(n.call(this),!u)throw new Error("No data for PDF table.");var m,y,v,j,w=[],N=[],_=[],C={},M={},D=[],L=[],E=(x=x||{}).autoSize||!1,P=x.printHeaders!==!1,H=x.css&&x.css["font-size"]!==void 0?16*x.css["font-size"]:x.fontSize||12,k=x.margins||Object.assign({width:this.getPageWidth()},r),T=typeof x.padding=="number"?x.padding:3,W=x.headerBackgroundColor||"#c8c8c8",G=x.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=P,this.internal.__cell__.margins=k,this.internal.__cell__.table_font_size=H,this.internal.__cell__.padding=T,this.internal.__cell__.headerBackgroundColor=W,this.internal.__cell__.headerTextColor=G,this.setFontSize(H),g==null)N=w=Object.keys(u[0]),_=w.map(function(){return"left"});else if(Array.isArray(g)&&rr(g[0])==="object")for(w=g.map(function(pe){return pe.name}),N=g.map(function(pe){return pe.prompt||pe.name||""}),_=g.map(function(pe){return pe.align||"left"}),m=0;m<g.length;m+=1)M[g[m].name]=g[m].width*(19.049976/25.4);else Array.isArray(g)&&typeof g[0]=="string"&&(N=w=g,_=w.map(function(){return"left"}));if(E||Array.isArray(g)&&typeof g[0]=="string")for(m=0;m<w.length;m+=1){for(C[j=w[m]]=u.map(function(pe){return pe[j]}),this.setFont(void 0,"bold"),D.push(this.getTextDimensions(N[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),y=C[j],this.setFont(void 0,"normal"),v=0;v<y.length;v+=1)D.push(this.getTextDimensions(y[v],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);M[j]=Math.max.apply(null,D)+T+T,D=[]}if(P){var de={};for(m=0;m<w.length;m+=1)de[w[m]]={},de[w[m]].text=N[m],de[w[m]].align=_[m];var J=c.call(this,de,M);L=w.map(function(pe){return new o(d,h,M[pe],J,de[pe].text,void 0,de[pe].align)}),this.setTableHeaderRow(L),this.printHeaderRow(1,!1)}var Z=g.reduce(function(pe,be){return pe[be.name]=be.align,pe},{});for(m=0;m<u.length;m+=1){"rowStart"in x&&x.rowStart instanceof Function&&x.rowStart({row:m,data:u[m]},this);var oe=c.call(this,u[m],M);for(v=0;v<w.length;v+=1){var ae=u[m][w[v]];"cellStart"in x&&x.cellStart instanceof Function&&x.cellStart({row:m,col:v,data:ae},this),l.call(this,new o(d,h,M[w[v]],oe,ae,m+2,Z[w[v]]))}}return this.internal.__cell__.table_x=d,this.internal.__cell__.table_y=h,this};var c=function(d,h){var u=this.internal.__cell__.padding,g=this.internal.__cell__.table_font_size,x=this.internal.scaleFactor;return Object.keys(d).map(function(m){var y=d[m];return this.splitTextToSize(y.hasOwnProperty("text")?y.text:y,h[m]-u-u)},this).map(function(m){return this.getLineHeightFactor()*m.length*g/x+u+u},this).reduce(function(m,y){return Math.max(m,y)},0)};e.setTableHeaderRow=function(d){n.call(this),this.internal.__cell__.tableHeaderRow=d},e.printHeaderRow=function(d,h){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var g=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new o(g[0],g[1],g[2],g[3],void 0,-1)}this.setFont(void 0,"bold");for(var x=[],m=0;m<this.internal.__cell__.tableHeaderRow.length;m+=1){u=this.internal.__cell__.tableHeaderRow[m].clone(),h&&(u.y=this.internal.__cell__.margins.top||0,x.push(u)),u.lineNumber=d;var y=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),l.call(this,u),this.setTextColor(y)}x.length>0&&this.setTableHeaderRow(x),this.setFont(void 0,"normal"),t=!1}}(xt.API);var Hh={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Wh=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],G0=Uh(Wh),zh=[100,200,300,400,500,600,700,800,900],Ax=Uh(zh);function $0(e){var r=e.family.replace(/"|'/g,"").toLowerCase(),t=function(o){return Hh[o=o||"normal"]?o:"normal"}(e.style),n=function(o){if(!o)return 400;if(typeof o=="number")return o>=100&&o<=900&&o%100==0?o:400;if(/^\d00$/.test(o))return parseInt(o);switch(o){case"bold":return 700;case"normal":default:return 400}}(e.weight),s=function(o){return typeof G0[o=o||"normal"]=="number"?o:"normal"}(e.stretch);return{family:r,style:t,weight:n,stretch:s,src:e.src||[],ref:e.ref||{name:r,style:[s,t,n].join(" ")}}}function wf(e,r,t,n){var s;for(s=t;s>=0&&s<r.length;s+=n)if(e[r[s]])return e[r[s]];for(s=t;s>=0&&s<r.length;s-=n)if(e[r[s]])return e[r[s]]}var kx={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Nf={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function jf(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function Tx(e,r,t){for(var n=(t=t||{}).defaultFontFamily||"times",s=Object.assign({},kx,t.genericFontFamilies||{}),o=null,l=null,c=0;c<r.length;++c)if(s[(o=$0(r[c])).family]&&(o.family=s[o.family]),e.hasOwnProperty(o.family)){l=e[o.family];break}if(!(l=l||e[n]))throw new Error("Could not find a font-family for the rule '"+jf(o)+"' and default family '"+n+"'.");if(l=function(d,h){if(h[d])return h[d];var u=G0[d],g=u<=G0.normal?-1:1,x=wf(h,Wh,u,g);if(!x)throw new Error("Could not find a matching font-stretch value for "+d);return x}(o.stretch,l),l=function(d,h){if(h[d])return h[d];for(var u=Hh[d],g=0;g<u.length;++g)if(h[u[g]])return h[u[g]];throw new Error("Could not find a matching font-style for "+d)}(o.style,l),!(l=function(d,h){if(h[d])return h[d];if(d===400&&h[500])return h[500];if(d===500&&h[400])return h[400];var u=Ax[d],g=wf(h,zh,u,d<400?-1:1);if(!g)throw new Error("Could not find a matching font-weight for value "+d);return g}(o.weight,l)))throw new Error("Failed to resolve a font for the rule '"+jf(o)+"'.");return l}function Sf(e){return e.trimLeft()}function Cx(e,r){for(var t=0;t<e.length;){if(e.charAt(t)===r)return[e.substring(0,t),e.substring(t+1)];t+=1}return null}function Ex(e){var r=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return r===null?null:[r[0],e.substring(r[0].length)]}var Wl,_f,Af,j0=["times"];(function(e){var r,t,n,s,o,l,c,d,h,u=function(A){return A=A||{},this.isStrokeTransparent=A.isStrokeTransparent||!1,this.strokeOpacity=A.strokeOpacity||1,this.strokeStyle=A.strokeStyle||"#000000",this.fillStyle=A.fillStyle||"#000000",this.isFillTransparent=A.isFillTransparent||!1,this.fillOpacity=A.fillOpacity||1,this.font=A.font||"10px sans-serif",this.textBaseline=A.textBaseline||"alphabetic",this.textAlign=A.textAlign||"left",this.lineWidth=A.lineWidth||1,this.lineJoin=A.lineJoin||"miter",this.lineCap=A.lineCap||"butt",this.path=A.path||[],this.transform=A.transform!==void 0?A.transform.clone():new d,this.globalCompositeOperation=A.globalCompositeOperation||"normal",this.globalAlpha=A.globalAlpha||1,this.clip_path=A.clip_path||[],this.currentPoint=A.currentPoint||new l,this.miterLimit=A.miterLimit||10,this.lastPoint=A.lastPoint||new l,this.lineDashOffset=A.lineDashOffset||0,this.lineDash=A.lineDash||[],this.margin=A.margin||[0,0,0,0],this.prevPageLastElemOffset=A.prevPageLastElemOffset||0,this.ignoreClearRect=typeof A.ignoreClearRect!="boolean"||A.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new g(this),r=this.internal.f2,t=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,o=this.internal.getVerticalCoordinate,l=this.internal.Point,c=this.internal.Rectangle,d=this.internal.Matrix,h=new u}]);var g=function(A){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var O=A;Object.defineProperty(this,"pdf",{get:function(){return O}});var I=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return I},set:function(Ee){I=!!Ee}});var R=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return R},set:function(Ee){R=!!Ee}});var X=0;Object.defineProperty(this,"posX",{get:function(){return X},set:function(Ee){isNaN(Ee)||(X=Ee)}});var fe=0;Object.defineProperty(this,"posY",{get:function(){return fe},set:function(Ee){isNaN(Ee)||(fe=Ee)}}),Object.defineProperty(this,"margin",{get:function(){return h.margin},set:function(Ee){var le;typeof Ee=="number"?le=[Ee,Ee,Ee,Ee]:((le=new Array(4))[0]=Ee[0],le[1]=Ee.length>=2?Ee[1]:le[0],le[2]=Ee.length>=3?Ee[2]:le[0],le[3]=Ee.length>=4?Ee[3]:le[1]),h.margin=le}});var he=!1;Object.defineProperty(this,"autoPaging",{get:function(){return he},set:function(Ee){he=Ee}});var ee=0;Object.defineProperty(this,"lastBreak",{get:function(){return ee},set:function(Ee){ee=Ee}});var ve=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ve},set:function(Ee){ve=Ee}}),Object.defineProperty(this,"ctx",{get:function(){return h},set:function(Ee){Ee instanceof u&&(h=Ee)}}),Object.defineProperty(this,"path",{get:function(){return h.path},set:function(Ee){h.path=Ee}});var Ce=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ce},set:function(Ee){Ce=Ee}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Ee){var le;le=x(Ee),this.ctx.fillStyle=le.style,this.ctx.isFillTransparent=le.a===0,this.ctx.fillOpacity=le.a,this.pdf.setFillColor(le.r,le.g,le.b,{a:le.a}),this.pdf.setTextColor(le.r,le.g,le.b,{a:le.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Ee){var le=x(Ee);this.ctx.strokeStyle=le.style,this.ctx.isStrokeTransparent=le.a===0,this.ctx.strokeOpacity=le.a,le.a===0?this.pdf.setDrawColor(255,255,255):(le.a,this.pdf.setDrawColor(le.r,le.g,le.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Ee){["butt","round","square"].indexOf(Ee)!==-1&&(this.ctx.lineCap=Ee,this.pdf.setLineCap(Ee))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Ee){isNaN(Ee)||(this.ctx.lineWidth=Ee,this.pdf.setLineWidth(Ee))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Ee){["bevel","round","miter"].indexOf(Ee)!==-1&&(this.ctx.lineJoin=Ee,this.pdf.setLineJoin(Ee))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Ee){isNaN(Ee)||(this.ctx.miterLimit=Ee,this.pdf.setMiterLimit(Ee))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Ee){this.ctx.textBaseline=Ee}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Ee){["right","end","center","left","start"].indexOf(Ee)!==-1&&(this.ctx.textAlign=Ee)}});var Ie=null;function Ve(Ee,le){if(Ie===null){var Be=function(Ze){var We=[];return Object.keys(Ze).forEach(function(Ye){Ze[Ye].forEach(function(Qe){var tt=null;switch(Qe){case"bold":tt={family:Ye,weight:"bold"};break;case"italic":tt={family:Ye,style:"italic"};break;case"bolditalic":tt={family:Ye,weight:"bold",style:"italic"};break;case"":case"normal":tt={family:Ye}}tt!==null&&(tt.ref={name:Ye,style:Qe},We.push(tt))})}),We}(Ee.getFontList());Ie=function(Ze){for(var We={},Ye=0;Ye<Ze.length;++Ye){var Qe=$0(Ze[Ye]),tt=Qe.family,dt=Qe.stretch,ht=Qe.style,wt=Qe.weight;We[tt]=We[tt]||{},We[tt][dt]=We[tt][dt]||{},We[tt][dt][ht]=We[tt][dt][ht]||{},We[tt][dt][ht][wt]=Qe}return We}(Be.concat(le))}return Ie}var $e=null;Object.defineProperty(this,"fontFaces",{get:function(){return $e},set:function(Ee){Ie=null,$e=Ee}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Ee){var le;if(this.ctx.font=Ee,(le=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Ee))!==null){var Be=le[1],Ze=(le[2],le[3]),We=le[4],Ye=(le[5],le[6]),Qe=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(We)[2];We=Math.floor(Qe==="px"?parseFloat(We)*this.pdf.internal.scaleFactor:Qe==="em"?parseFloat(We)*this.pdf.getFontSize():parseFloat(We)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(We);var tt=function(vt){var Ct,at,Fr=[],Ot=vt.trim();if(Ot==="")return j0;if(Ot in Nf)return[Nf[Ot]];for(;Ot!=="";){switch(at=null,Ct=(Ot=Sf(Ot)).charAt(0)){case'"':case"'":at=Cx(Ot.substring(1),Ct);break;default:at=Ex(Ot)}if(at===null||(Fr.push(at[0]),(Ot=Sf(at[1]))!==""&&Ot.charAt(0)!==","))return j0;Ot=Ot.replace(/^,/,"")}return Fr}(Ye);if(this.fontFaces){var dt=Tx(Ve(this.pdf,this.fontFaces),tt.map(function(vt){return{family:vt,stretch:"normal",weight:Ze,style:Be}}));this.pdf.setFont(dt.ref.name,dt.ref.style)}else{var ht="";(Ze==="bold"||parseInt(Ze,10)>=700||Be==="bold")&&(ht="bold"),Be==="italic"&&(ht+="italic"),ht.length===0&&(ht="normal");for(var wt="",kt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Ft=0;Ft<tt.length;Ft++){if(this.pdf.internal.getFont(tt[Ft],ht,{noFallback:!0,disableWarning:!0})!==void 0){wt=tt[Ft];break}if(ht==="bolditalic"&&this.pdf.internal.getFont(tt[Ft],"bold",{noFallback:!0,disableWarning:!0})!==void 0)wt=tt[Ft],ht="bold";else if(this.pdf.internal.getFont(tt[Ft],"normal",{noFallback:!0,disableWarning:!0})!==void 0){wt=tt[Ft],ht="normal";break}}if(wt===""){for(var Lt=0;Lt<tt.length;Lt++)if(kt[tt[Lt]]){wt=kt[tt[Lt]];break}}wt=wt===""?"Times":wt,this.pdf.setFont(wt,ht)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Ee){this.ctx.globalCompositeOperation=Ee}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Ee){this.ctx.globalAlpha=Ee}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Ee){this.ctx.lineDashOffset=Ee,be.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Ee){this.ctx.lineDash=Ee,be.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Ee){this.ctx.ignoreClearRect=!!Ee}})};g.prototype.setLineDash=function(A){this.lineDash=A},g.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},g.prototype.fill=function(){C.call(this,"fill",!1)},g.prototype.stroke=function(){C.call(this,"stroke",!1)},g.prototype.beginPath=function(){this.path=[{type:"begin"}]},g.prototype.moveTo=function(A,O){if(isNaN(A)||isNaN(O))throw tr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var I=this.ctx.transform.applyToPoint(new l(A,O));this.path.push({type:"mt",x:I.x,y:I.y}),this.ctx.lastPoint=new l(A,O)},g.prototype.closePath=function(){var A=new l(0,0),O=0;for(O=this.path.length-1;O!==-1;O--)if(this.path[O].type==="begin"&&rr(this.path[O+1])==="object"&&typeof this.path[O+1].x=="number"){A=new l(this.path[O+1].x,this.path[O+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new l(A.x,A.y)},g.prototype.lineTo=function(A,O){if(isNaN(A)||isNaN(O))throw tr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var I=this.ctx.transform.applyToPoint(new l(A,O));this.path.push({type:"lt",x:I.x,y:I.y}),this.ctx.lastPoint=new l(I.x,I.y)},g.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),C.call(this,null,!0)},g.prototype.quadraticCurveTo=function(A,O,I,R){if(isNaN(I)||isNaN(R)||isNaN(A)||isNaN(O))throw tr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var X=this.ctx.transform.applyToPoint(new l(I,R)),fe=this.ctx.transform.applyToPoint(new l(A,O));this.path.push({type:"qct",x1:fe.x,y1:fe.y,x:X.x,y:X.y}),this.ctx.lastPoint=new l(X.x,X.y)},g.prototype.bezierCurveTo=function(A,O,I,R,X,fe){if(isNaN(X)||isNaN(fe)||isNaN(A)||isNaN(O)||isNaN(I)||isNaN(R))throw tr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var he=this.ctx.transform.applyToPoint(new l(X,fe)),ee=this.ctx.transform.applyToPoint(new l(A,O)),ve=this.ctx.transform.applyToPoint(new l(I,R));this.path.push({type:"bct",x1:ee.x,y1:ee.y,x2:ve.x,y2:ve.y,x:he.x,y:he.y}),this.ctx.lastPoint=new l(he.x,he.y)},g.prototype.arc=function(A,O,I,R,X,fe){if(isNaN(A)||isNaN(O)||isNaN(I)||isNaN(R)||isNaN(X))throw tr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(fe=!!fe,!this.ctx.transform.isIdentity){var he=this.ctx.transform.applyToPoint(new l(A,O));A=he.x,O=he.y;var ee=this.ctx.transform.applyToPoint(new l(0,I)),ve=this.ctx.transform.applyToPoint(new l(0,0));I=Math.sqrt(Math.pow(ee.x-ve.x,2)+Math.pow(ee.y-ve.y,2))}Math.abs(X-R)>=2*Math.PI&&(R=0,X=2*Math.PI),this.path.push({type:"arc",x:A,y:O,radius:I,startAngle:R,endAngle:X,counterclockwise:fe})},g.prototype.arcTo=function(A,O,I,R,X){throw new Error("arcTo not implemented.")},g.prototype.rect=function(A,O,I,R){if(isNaN(A)||isNaN(O)||isNaN(I)||isNaN(R))throw tr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(A,O),this.lineTo(A+I,O),this.lineTo(A+I,O+R),this.lineTo(A,O+R),this.lineTo(A,O),this.lineTo(A+I,O),this.lineTo(A,O)},g.prototype.fillRect=function(A,O,I,R){if(isNaN(A)||isNaN(O)||isNaN(I)||isNaN(R))throw tr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!m.call(this)){var X={};this.lineCap!=="butt"&&(X.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(X.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(A,O,I,R),this.fill(),X.hasOwnProperty("lineCap")&&(this.lineCap=X.lineCap),X.hasOwnProperty("lineJoin")&&(this.lineJoin=X.lineJoin)}},g.prototype.strokeRect=function(A,O,I,R){if(isNaN(A)||isNaN(O)||isNaN(I)||isNaN(R))throw tr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");y.call(this)||(this.beginPath(),this.rect(A,O,I,R),this.stroke())},g.prototype.clearRect=function(A,O,I,R){if(isNaN(A)||isNaN(O)||isNaN(I)||isNaN(R))throw tr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(A,O,I,R))},g.prototype.save=function(A){A=typeof A!="boolean"||A;for(var O=this.pdf.internal.getCurrentPageInfo().pageNumber,I=0;I<this.pdf.internal.getNumberOfPages();I++)this.pdf.setPage(I+1),this.pdf.internal.out("q");if(this.pdf.setPage(O),A){this.ctx.fontSize=this.pdf.internal.getFontSize();var R=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=R}},g.prototype.restore=function(A){A=typeof A!="boolean"||A;for(var O=this.pdf.internal.getCurrentPageInfo().pageNumber,I=0;I<this.pdf.internal.getNumberOfPages();I++)this.pdf.setPage(I+1),this.pdf.internal.out("Q");this.pdf.setPage(O),A&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},g.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var x=function(A){var O,I,R,X;if(A.isCanvasGradient===!0&&(A=A.getColor()),!A)return{r:0,g:0,b:0,a:0,style:A};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(A))O=0,I=0,R=0,X=0;else{var fe=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(A);if(fe!==null)O=parseInt(fe[1]),I=parseInt(fe[2]),R=parseInt(fe[3]),X=1;else if((fe=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(A))!==null)O=parseInt(fe[1]),I=parseInt(fe[2]),R=parseInt(fe[3]),X=parseFloat(fe[4]);else{if(X=1,typeof A=="string"&&A.charAt(0)!=="#"){var he=new Oh(A);A=he.ok?he.toHex():"#000000"}A.length===4?(O=A.substring(1,2),O+=O,I=A.substring(2,3),I+=I,R=A.substring(3,4),R+=R):(O=A.substring(1,3),I=A.substring(3,5),R=A.substring(5,7)),O=parseInt(O,16),I=parseInt(I,16),R=parseInt(R,16)}}return{r:O,g:I,b:R,a:X,style:A}},m=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},y=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};g.prototype.fillText=function(A,O,I,R){if(isNaN(O)||isNaN(I)||typeof A!="string")throw tr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(R=isNaN(R)?void 0:R,!m.call(this)){var X=oe(this.ctx.transform.rotation),fe=this.ctx.transform.scaleX;T.call(this,{text:A,x:O,y:I,scale:fe,angle:X,align:this.textAlign,maxWidth:R})}},g.prototype.strokeText=function(A,O,I,R){if(isNaN(O)||isNaN(I)||typeof A!="string")throw tr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!y.call(this)){R=isNaN(R)?void 0:R;var X=oe(this.ctx.transform.rotation),fe=this.ctx.transform.scaleX;T.call(this,{text:A,x:O,y:I,scale:fe,renderingMode:"stroke",angle:X,align:this.textAlign,maxWidth:R})}},g.prototype.measureText=function(A){if(typeof A!="string")throw tr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var O=this.pdf,I=this.pdf.internal.scaleFactor,R=O.internal.getFontSize(),X=O.getStringUnitWidth(A)*R/O.internal.scaleFactor,fe=function(he){var ee=(he=he||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ee}}),this};return new fe({width:X*=Math.round(96*I/72*1e4)/1e4})},g.prototype.scale=function(A,O){if(isNaN(A)||isNaN(O))throw tr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var I=new d(A,0,0,O,0,0);this.ctx.transform=this.ctx.transform.multiply(I)},g.prototype.rotate=function(A){if(isNaN(A))throw tr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var O=new d(Math.cos(A),Math.sin(A),-Math.sin(A),Math.cos(A),0,0);this.ctx.transform=this.ctx.transform.multiply(O)},g.prototype.translate=function(A,O){if(isNaN(A)||isNaN(O))throw tr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var I=new d(1,0,0,1,A,O);this.ctx.transform=this.ctx.transform.multiply(I)},g.prototype.transform=function(A,O,I,R,X,fe){if(isNaN(A)||isNaN(O)||isNaN(I)||isNaN(R)||isNaN(X)||isNaN(fe))throw tr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var he=new d(A,O,I,R,X,fe);this.ctx.transform=this.ctx.transform.multiply(he)},g.prototype.setTransform=function(A,O,I,R,X,fe){A=isNaN(A)?1:A,O=isNaN(O)?0:O,I=isNaN(I)?0:I,R=isNaN(R)?1:R,X=isNaN(X)?0:X,fe=isNaN(fe)?0:fe,this.ctx.transform=new d(A,O,I,R,X,fe)};var v=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};g.prototype.drawImage=function(A,O,I,R,X,fe,he,ee,ve){var Ce=this.pdf.getImageProperties(A),Ie=1,Ve=1,$e=1,Ee=1;R!==void 0&&ee!==void 0&&($e=ee/R,Ee=ve/X,Ie=Ce.width/R*ee/R,Ve=Ce.height/X*ve/X),fe===void 0&&(fe=O,he=I,O=0,I=0),R!==void 0&&ee===void 0&&(ee=R,ve=X),R===void 0&&ee===void 0&&(ee=Ce.width,ve=Ce.height);for(var le,Be=this.ctx.transform.decompose(),Ze=oe(Be.rotate.shx),We=new d,Ye=(We=(We=(We=We.multiply(Be.translate)).multiply(Be.skew)).multiply(Be.scale)).applyToRectangle(new c(fe-O*$e,he-I*Ee,R*Ie,X*Ve)),Qe=j.call(this,Ye),tt=[],dt=0;dt<Qe.length;dt+=1)tt.indexOf(Qe[dt])===-1&&tt.push(Qe[dt]);if(_(tt),this.autoPaging)for(var ht=tt[0],wt=tt[tt.length-1],kt=ht;kt<wt+1;kt++){this.pdf.setPage(kt);var Ft=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Lt=kt===1?this.posY+this.margin[0]:this.margin[0],vt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ct=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],at=kt===1?0:vt+(kt-2)*Ct;if(this.ctx.clip_path.length!==0){var Fr=this.path;le=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=N(le,this.posX+this.margin[3],-at+Lt+this.ctx.prevPageLastElemOffset),M.call(this,"fill",!0),this.path=Fr}var Ot=JSON.parse(JSON.stringify(Ye));Ot=N([Ot],this.posX+this.margin[3],-at+Lt+this.ctx.prevPageLastElemOffset)[0];var pn=(kt>ht||kt<wt)&&v.call(this);pn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ft,Ct,null).clip().discardPath()),this.pdf.addImage(A,"JPEG",Ot.x,Ot.y,Ot.w,Ot.h,null,null,Ze),pn&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(A,"JPEG",Ye.x,Ye.y,Ye.w,Ye.h,null,null,Ze)};var j=function(A,O,I){var R=[];O=O||this.pdf.internal.pageSize.width,I=I||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var X=this.posY+this.ctx.prevPageLastElemOffset;switch(A.type){default:case"mt":case"lt":R.push(Math.floor((A.y+X)/I)+1);break;case"arc":R.push(Math.floor((A.y+X-A.radius)/I)+1),R.push(Math.floor((A.y+X+A.radius)/I)+1);break;case"qct":var fe=ae(this.ctx.lastPoint.x,this.ctx.lastPoint.y,A.x1,A.y1,A.x,A.y);R.push(Math.floor((fe.y+X)/I)+1),R.push(Math.floor((fe.y+fe.h+X)/I)+1);break;case"bct":var he=pe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,A.x1,A.y1,A.x2,A.y2,A.x,A.y);R.push(Math.floor((he.y+X)/I)+1),R.push(Math.floor((he.y+he.h+X)/I)+1);break;case"rect":R.push(Math.floor((A.y+X)/I)+1),R.push(Math.floor((A.y+A.h+X)/I)+1)}for(var ee=0;ee<R.length;ee+=1)for(;this.pdf.internal.getNumberOfPages()<R[ee];)w.call(this);return R},w=function(){var A=this.fillStyle,O=this.strokeStyle,I=this.font,R=this.lineCap,X=this.lineWidth,fe=this.lineJoin;this.pdf.addPage(),this.fillStyle=A,this.strokeStyle=O,this.font=I,this.lineCap=R,this.lineWidth=X,this.lineJoin=fe},N=function(A,O,I){for(var R=0;R<A.length;R++)switch(A[R].type){case"bct":A[R].x2+=O,A[R].y2+=I;case"qct":A[R].x1+=O,A[R].y1+=I;case"mt":case"lt":case"arc":default:A[R].x+=O,A[R].y+=I}return A},_=function(A){return A.sort(function(O,I){return O-I})},C=function(A,O){for(var I,R,X=this.fillStyle,fe=this.strokeStyle,he=this.lineCap,ee=this.lineWidth,ve=Math.abs(ee*this.ctx.transform.scaleX),Ce=this.lineJoin,Ie=JSON.parse(JSON.stringify(this.path)),Ve=JSON.parse(JSON.stringify(this.path)),$e=[],Ee=0;Ee<Ve.length;Ee++)if(Ve[Ee].x!==void 0)for(var le=j.call(this,Ve[Ee]),Be=0;Be<le.length;Be+=1)$e.indexOf(le[Be])===-1&&$e.push(le[Be]);for(var Ze=0;Ze<$e.length;Ze++)for(;this.pdf.internal.getNumberOfPages()<$e[Ze];)w.call(this);if(_($e),this.autoPaging)for(var We=$e[0],Ye=$e[$e.length-1],Qe=We;Qe<Ye+1;Qe++){this.pdf.setPage(Qe),this.fillStyle=X,this.strokeStyle=fe,this.lineCap=he,this.lineWidth=ve,this.lineJoin=Ce;var tt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],dt=Qe===1?this.posY+this.margin[0]:this.margin[0],ht=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],wt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],kt=Qe===1?0:ht+(Qe-2)*wt;if(this.ctx.clip_path.length!==0){var Ft=this.path;I=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=N(I,this.posX+this.margin[3],-kt+dt+this.ctx.prevPageLastElemOffset),M.call(this,A,!0),this.path=Ft}if(R=JSON.parse(JSON.stringify(Ie)),this.path=N(R,this.posX+this.margin[3],-kt+dt+this.ctx.prevPageLastElemOffset),O===!1||Qe===0){var Lt=(Qe>We||Qe<Ye)&&v.call(this);Lt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],tt,wt,null).clip().discardPath()),M.call(this,A,O),Lt&&this.pdf.restoreGraphicsState()}this.lineWidth=ee}else this.lineWidth=ve,M.call(this,A,O),this.lineWidth=ee;this.path=Ie},M=function(A,O){if((A!=="stroke"||O||!y.call(this))&&(A==="stroke"||O||!m.call(this))){for(var I,R,X=[],fe=this.path,he=0;he<fe.length;he++){var ee=fe[he];switch(ee.type){case"begin":X.push({begin:!0});break;case"close":X.push({close:!0});break;case"mt":X.push({start:ee,deltas:[],abs:[]});break;case"lt":var ve=X.length;if(fe[he-1]&&!isNaN(fe[he-1].x)&&(I=[ee.x-fe[he-1].x,ee.y-fe[he-1].y],ve>0)){for(;ve>=0;ve--)if(X[ve-1].close!==!0&&X[ve-1].begin!==!0){X[ve-1].deltas.push(I),X[ve-1].abs.push(ee);break}}break;case"bct":I=[ee.x1-fe[he-1].x,ee.y1-fe[he-1].y,ee.x2-fe[he-1].x,ee.y2-fe[he-1].y,ee.x-fe[he-1].x,ee.y-fe[he-1].y],X[X.length-1].deltas.push(I);break;case"qct":var Ce=fe[he-1].x+2/3*(ee.x1-fe[he-1].x),Ie=fe[he-1].y+2/3*(ee.y1-fe[he-1].y),Ve=ee.x+2/3*(ee.x1-ee.x),$e=ee.y+2/3*(ee.y1-ee.y),Ee=ee.x,le=ee.y;I=[Ce-fe[he-1].x,Ie-fe[he-1].y,Ve-fe[he-1].x,$e-fe[he-1].y,Ee-fe[he-1].x,le-fe[he-1].y],X[X.length-1].deltas.push(I);break;case"arc":X.push({deltas:[],abs:[],arc:!0}),Array.isArray(X[X.length-1].abs)&&X[X.length-1].abs.push(ee)}}R=O?null:A==="stroke"?"stroke":"fill";for(var Be=!1,Ze=0;Ze<X.length;Ze++)if(X[Ze].arc)for(var We=X[Ze].abs,Ye=0;Ye<We.length;Ye++){var Qe=We[Ye];Qe.type==="arc"?E.call(this,Qe.x,Qe.y,Qe.radius,Qe.startAngle,Qe.endAngle,Qe.counterclockwise,void 0,O,!Be):W.call(this,Qe.x,Qe.y),Be=!0}else if(X[Ze].close===!0)this.pdf.internal.out("h"),Be=!1;else if(X[Ze].begin!==!0){var tt=X[Ze].start.x,dt=X[Ze].start.y;G.call(this,X[Ze].deltas,tt,dt),Be=!0}R&&P.call(this,R),O&&H.call(this)}},D=function(A){var O=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,I=O*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return A-I;case"top":return A+O-I;case"hanging":return A+O-2*I;case"middle":return A+O/2-I;case"ideographic":return A;case"alphabetic":default:return A}},L=function(A){return A+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};g.prototype.createLinearGradient=function(){var A=function(){};return A.colorStops=[],A.addColorStop=function(O,I){this.colorStops.push([O,I])},A.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},A.isCanvasGradient=!0,A},g.prototype.createPattern=function(){return this.createLinearGradient()},g.prototype.createRadialGradient=function(){return this.createLinearGradient()};var E=function(A,O,I,R,X,fe,he,ee,ve){for(var Ce=J.call(this,I,R,X,fe),Ie=0;Ie<Ce.length;Ie++){var Ve=Ce[Ie];Ie===0&&(ve?k.call(this,Ve.x1+A,Ve.y1+O):W.call(this,Ve.x1+A,Ve.y1+O)),de.call(this,A,O,Ve.x2,Ve.y2,Ve.x3,Ve.y3,Ve.x4,Ve.y4)}ee?H.call(this):P.call(this,he)},P=function(A){switch(A){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},H=function(){this.pdf.clip(),this.pdf.discardPath()},k=function(A,O){this.pdf.internal.out(t(A)+" "+n(O)+" m")},T=function(A){var O;switch(A.align){case"right":case"end":O="right";break;case"center":O="center";break;case"left":case"start":default:O="left"}var I=this.pdf.getTextDimensions(A.text),R=D.call(this,A.y),X=L.call(this,R)-I.h,fe=this.ctx.transform.applyToPoint(new l(A.x,R)),he=this.ctx.transform.decompose(),ee=new d;ee=(ee=(ee=ee.multiply(he.translate)).multiply(he.skew)).multiply(he.scale);for(var ve,Ce,Ie,Ve=this.ctx.transform.applyToRectangle(new c(A.x,R,I.w,I.h)),$e=ee.applyToRectangle(new c(A.x,X,I.w,I.h)),Ee=j.call(this,$e),le=[],Be=0;Be<Ee.length;Be+=1)le.indexOf(Ee[Be])===-1&&le.push(Ee[Be]);if(_(le),this.autoPaging)for(var Ze=le[0],We=le[le.length-1],Ye=Ze;Ye<We+1;Ye++){this.pdf.setPage(Ye);var Qe=Ye===1?this.posY+this.margin[0]:this.margin[0],tt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],dt=this.pdf.internal.pageSize.height-this.margin[2],ht=dt-this.margin[0],wt=this.pdf.internal.pageSize.width-this.margin[1],kt=wt-this.margin[3],Ft=Ye===1?0:tt+(Ye-2)*ht;if(this.ctx.clip_path.length!==0){var Lt=this.path;ve=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=N(ve,this.posX+this.margin[3],-1*Ft+Qe),M.call(this,"fill",!0),this.path=Lt}var vt=N([JSON.parse(JSON.stringify($e))],this.posX+this.margin[3],-Ft+Qe+this.ctx.prevPageLastElemOffset)[0];A.scale>=.01&&(Ce=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ce*A.scale),Ie=this.lineWidth,this.lineWidth=Ie*A.scale);var Ct=this.autoPaging!=="text";if(Ct||vt.y+vt.h<=dt){if(Ct||vt.y>=Qe&&vt.x<=wt){var at=Ct?A.text:this.pdf.splitTextToSize(A.text,A.maxWidth||wt-vt.x)[0],Fr=N([JSON.parse(JSON.stringify(Ve))],this.posX+this.margin[3],-Ft+Qe+this.ctx.prevPageLastElemOffset)[0],Ot=Ct&&(Ye>Ze||Ye<We)&&v.call(this);Ot&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],kt,ht,null).clip().discardPath()),this.pdf.text(at,Fr.x,Fr.y,{angle:A.angle,align:O,renderingMode:A.renderingMode}),Ot&&this.pdf.restoreGraphicsState()}}else vt.y<dt&&(this.ctx.prevPageLastElemOffset+=dt-vt.y);A.scale>=.01&&(this.pdf.setFontSize(Ce),this.lineWidth=Ie)}else A.scale>=.01&&(Ce=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ce*A.scale),Ie=this.lineWidth,this.lineWidth=Ie*A.scale),this.pdf.text(A.text,fe.x+this.posX,fe.y+this.posY,{angle:A.angle,align:O,renderingMode:A.renderingMode,maxWidth:A.maxWidth}),A.scale>=.01&&(this.pdf.setFontSize(Ce),this.lineWidth=Ie)},W=function(A,O,I,R){I=I||0,R=R||0,this.pdf.internal.out(t(A+I)+" "+n(O+R)+" l")},G=function(A,O,I){return this.pdf.lines(A,O,I,null,null)},de=function(A,O,I,R,X,fe,he,ee){this.pdf.internal.out([r(s(I+A)),r(o(R+O)),r(s(X+A)),r(o(fe+O)),r(s(he+A)),r(o(ee+O)),"c"].join(" "))},J=function(A,O,I,R){for(var X=2*Math.PI,fe=Math.PI/2;O>I;)O-=X;var he=Math.abs(I-O);he<X&&R&&(he=X-he);for(var ee=[],ve=R?-1:1,Ce=O;he>1e-5;){var Ie=Ce+ve*Math.min(he,fe);ee.push(Z.call(this,A,Ce,Ie)),he-=Math.abs(Ie-Ce),Ce=Ie}return ee},Z=function(A,O,I){var R=(I-O)/2,X=A*Math.cos(R),fe=A*Math.sin(R),he=X,ee=-fe,ve=he*he+ee*ee,Ce=ve+he*X+ee*fe,Ie=4/3*(Math.sqrt(2*ve*Ce)-Ce)/(he*fe-ee*X),Ve=he-Ie*ee,$e=ee+Ie*he,Ee=Ve,le=-$e,Be=R+O,Ze=Math.cos(Be),We=Math.sin(Be);return{x1:A*Math.cos(O),y1:A*Math.sin(O),x2:Ve*Ze-$e*We,y2:Ve*We+$e*Ze,x3:Ee*Ze-le*We,y3:Ee*We+le*Ze,x4:A*Math.cos(I),y4:A*Math.sin(I)}},oe=function(A){return 180*A/Math.PI},ae=function(A,O,I,R,X,fe){var he=A+.5*(I-A),ee=O+.5*(R-O),ve=X+.5*(I-X),Ce=fe+.5*(R-fe),Ie=Math.min(A,X,he,ve),Ve=Math.max(A,X,he,ve),$e=Math.min(O,fe,ee,Ce),Ee=Math.max(O,fe,ee,Ce);return new c(Ie,$e,Ve-Ie,Ee-$e)},pe=function(A,O,I,R,X,fe,he,ee){var ve,Ce,Ie,Ve,$e,Ee,le,Be,Ze,We,Ye,Qe,tt,dt,ht=I-A,wt=R-O,kt=X-I,Ft=fe-R,Lt=he-X,vt=ee-fe;for(Ce=0;Ce<41;Ce++)Ze=(le=(Ie=A+(ve=Ce/40)*ht)+ve*(($e=I+ve*kt)-Ie))+ve*($e+ve*(X+ve*Lt-$e)-le),We=(Be=(Ve=O+ve*wt)+ve*((Ee=R+ve*Ft)-Ve))+ve*(Ee+ve*(fe+ve*vt-Ee)-Be),Ce==0?(Ye=Ze,Qe=We,tt=Ze,dt=We):(Ye=Math.min(Ye,Ze),Qe=Math.min(Qe,We),tt=Math.max(tt,Ze),dt=Math.max(dt,We));return new c(Math.round(Ye),Math.round(Qe),Math.round(tt-Ye),Math.round(dt-Qe))},be=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var A,O,I=(A=this.ctx.lineDash,O=this.ctx.lineDashOffset,JSON.stringify({lineDash:A,lineDashOffset:O}));this.prevLineDash!==I&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=I)}}})(xt.API),function(e){var r=function(o){var l,c,d,h,u,g,x,m,y,v;for(c=[],d=0,h=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;h>d;d+=4)(u=(o.charCodeAt(d)<<24)+(o.charCodeAt(d+1)<<16)+(o.charCodeAt(d+2)<<8)+o.charCodeAt(d+3))!==0?(g=(u=((u=((u=((u=(u-(v=u%85))/85)-(y=u%85))/85)-(m=u%85))/85)-(x=u%85))/85)%85,c.push(g+33,x+33,m+33,y+33,v+33)):c.push(122);return function(j,w){for(var N=w;N>0;N--)j.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},t=function(o){var l,c,d,h,u,g=String,x="length",m=255,y="charCodeAt",v="slice",j="replace";for(o[v](-2),o=o[v](0,-2)[j](/\s/g,"")[j]("z","!!!!!"),d=[],h=0,u=(o+=l="uuuuu"[v](o[x]%5||5))[x];u>h;h+=5)c=52200625*(o[y](h)-33)+614125*(o[y](h+1)-33)+7225*(o[y](h+2)-33)+85*(o[y](h+3)-33)+(o[y](h+4)-33),d.push(m&c>>24,m&c>>16,m&c>>8,m&c);return function(w,N){for(var _=N;_>0;_--)w.pop()}(d,l[x]),g.fromCharCode.apply(g,d)},n=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",d=0;d<o.length;d+=2)c+=String.fromCharCode("0x"+(o[d]+o[d+1]));return c},s=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return o=(l=H0(l)).reduce(function(d,h){return d+String.fromCharCode(h)},"")};e.processDataByFilters=function(o,l){var c=0,d=o||"",h=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":d=t(d),h.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":d=r(d),h.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":d=n(d),h.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":d=d.split("").map(function(u){return("0"+u.charCodeAt().toString(16)).slice(-2)}).join("")+">",h.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":d=s(d),h.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:d,reverseChain:h.reverse().join(" ")}}}(xt.API),function(e){e.loadFile=function(r,t,n){return function(s,o,l){o=o!==!1,l=typeof l=="function"?l:function(){};var c=void 0;try{c=function(d,h,u){var g=new XMLHttpRequest,x=0,m=function(y){var v=y.length,j=[],w=String.fromCharCode;for(x=0;x<v;x+=1)j.push(w(255&y.charCodeAt(x)));return j.join("")};if(g.open("GET",d,!h),g.overrideMimeType("text/plain; charset=x-user-defined"),h===!1&&(g.onload=function(){g.status===200?u(m(this.responseText)):u(void 0)}),g.send(null),h&&g.status===200)return m(g.responseText)}(s,o,l)}catch{}return c}(r,t,n)},e.loadImageFile=e.loadFile}(xt.API),function(e){function r(){return(yt.html2canvas?Promise.resolve(yt.html2canvas):D0(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function t(){return(yt.DOMPurify?Promise.resolve(yt.DOMPurify):D0(()=>import("./purify.es-C_uT9hQ1.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=rr(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},s=function(l,c){var d=document.createElement(l);for(var h in c.className&&(d.className=c.className),c.innerHTML&&c.dompurify&&(d.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)d.style[h]=c.style[h];return d},o=function l(c){var d=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),h=l.convert(Promise.resolve(),d);return h=(h=h.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(d){switch(n(d)){case"string":return"string";case"element":return d.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l)){case"string":return this.then(t).then(function(d){return this.set({src:s("div",{innerHTML:l,dompurify:d})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=function d(h,u){for(var g=h.nodeType===3?document.createTextNode(h.nodeValue):h.cloneNode(!1),x=h.firstChild;x;x=x.nextSibling)u!==!0&&x.nodeType===1&&x.nodeName==="SCRIPT"||g.appendChild(d(x,u));return h.nodeType===1&&(h.nodeName==="CANVAS"?(g.width=h.width,g.height=h.height,g.getContext("2d").drawImage(h,0,0)):h.nodeName!=="TEXTAREA"&&h.nodeName!=="SELECT"||(g.value=h.value),g.addEventListener("load",function(){g.scrollTop=h.scrollTop,g.scrollLeft=h.scrollLeft},!0)),g}(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(r).then(function(c){var d=Object.assign({},this.opt.html2canvas);return delete d.onrendered,c(this.prop.container,d)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(r).then(function(c){var d=this.opt.jsPDF,h=this.opt.fontFaces,u=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,g=Object.assign({async:!0,allowTaint:!0,scale:u,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete g.onrendered,d.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,d.context2d.posX=this.opt.x,d.context2d.posY=this.opt.y,d.context2d.margin=this.opt.margin,d.context2d.fontFaces=h,h)for(var x=0;x<h.length;++x){var m=h[x],y=m.src.find(function(v){return v.format==="truetype"});y&&d.addFont(y.url,m.ref.name,m.ref.style)}return g.windowHeight=g.windowHeight||0,g.windowHeight=g.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):g.windowHeight,d.context2d.save(!0),c(this.prop.container,g)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,d){return(d=d||"pdf").toLowerCase()==="img"||d.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(d){if(d in o.template.prop)return function(){this.prop[d]=l[d]};switch(d){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[d]=l[d]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var d=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(d):d})},o.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(d,h){return Math.floor(d*h/72*96)}return this.then(function(){(l=l||xt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,d,h){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),d!=null&&(this.progress.n=d),h!=null&&(this.progress.stack=h),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,d,h){return this.setProgress(l?this.progress.val+l:null,c||null,d?this.progress.n+d:null,h?this.progress.stack.concat(h):null)},o.prototype.then=function(l,c){var d=this;return this.thenCore(l,c,function(h,u){return d.updateProgress(null,null,1,[h]),Promise.prototype.then.call(this,function(g){return d.updateProgress(null,h),g}).then(h,u).then(function(g){return d.updateProgress(1),g})})},o.prototype.thenCore=function(l,c,d){d=d||Promise.prototype.then,l&&(l=l.bind(this)),c&&(c=c.bind(this));var h=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:o.convert(Object.assign({},this),Promise.prototype),u=d.call(h,l,c);return o.convert(u,this.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(d){c=c.thenCore(d)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,xt.getPageSize=function(l,c,d){if(rr(l)==="object"){var h=l;l=h.orientation,c=h.unit||c,d=h.format||d}c=c||"mm",d=d||"a4",l=(""+(l||"P")).toLowerCase();var u,g=(""+d).toLowerCase(),x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":u=1;break;case"mm":u=72/25.4;break;case"cm":u=72/2.54;break;case"in":u=72;break;case"px":u=.75;break;case"pc":case"em":u=12;break;case"ex":u=6;break;default:throw"Invalid unit: "+c}var m,y=0,v=0;if(x.hasOwnProperty(g))y=x[g][1]/u,v=x[g][0]/u;else try{y=d[1],v=d[0]}catch{throw new Error("Invalid format: "+d)}if(l==="p"||l==="portrait")l="p",v>y&&(m=v,v=y,y=m);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",y>v&&(m=v,v=y,y=m)}return{width:v,height:y,unit:c,k:u,orientation:l}},e.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map($0):null;var d=new o(c);return c.worker?d:d.from(l).doCallback()}}(xt.API),xt.API.addJS=function(e){return Af=e,this.internal.events.subscribe("postPutResources",function(){Wl=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Wl+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),_f=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Af+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Wl!==void 0&&_f!==void 0&&this.internal.out("/Names <</JavaScript "+Wl+" 0 R>>")}),this},function(e){var r;e.events.push(["postPutResources",function(){var t=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=t.outline.render().split(/\r\n/),o=0;o<s.length;o++){var l=s[o],c=n.exec(l);if(c!=null){var d=c[1];t.internal.newObjectDeferredBegin(d,!1)}t.internal.write(l)}if(this.outline.createNamedDestinations){var h=this.internal.pages.length,u=[];for(o=0;o<h;o++){var g=t.internal.newObject();u.push(g);var x=t.internal.getPageInfo(o+1);t.internal.write("<< /D["+x.objId+" 0 R /XYZ null null null]>> endobj")}var m=t.internal.newObject();for(t.internal.write("<< /Names [ "),o=0;o<u.length;o++)t.internal.write("(page_"+(o+1)+")"+u[o]+" 0 R");t.internal.write(" ] >>","endobj"),r=t.internal.newObject(),t.internal.write("<< /Dests "+m+" 0 R"),t.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+r+" 0 R"))}]),e.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(n,s,o){var l={title:s,options:o,children:[]};return n==null&&(n=this.root),n.children.push(l),l},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(n){n.id=t.internal.newObjectDeferred();for(var s=0;s<n.children.length;s++)this.genIds_r(n.children[s])},t.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},t.outline.renderItems=function(n){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,o=0;o<n.children.length;o++){var l=n.children[o];this.objStart(l),this.line("/Title "+this.makeString(l.title)),this.line("/Parent "+this.makeRef(n)),o>0&&this.line("/Prev "+this.makeRef(n.children[o-1])),o<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[o+1])),l.children.length>0&&(this.line("/First "+this.makeRef(l.children[0])),this.line("/Last "+this.makeRef(l.children[l.children.length-1])));var c=this.count=this.count_r({count:0},l);if(c>0&&this.line("/Count "+c),l.options&&l.options.pageNumber){var d=t.internal.getPageInfo(l.options.pageNumber);this.line("/Dest ["+d.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var h=0;h<n.children.length;h++)this.renderItems(n.children[h])},t.outline.line=function(n){this.ctx.val+=n+`\r
`},t.outline.makeRef=function(n){return n.id+" 0 R"},t.outline.makeString=function(n){return"("+t.internal.pdfEscape(n)+")"},t.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(n,s){for(var o=0;o<s.children.length;o++)n.count++,this.count_r(n,s.children[o]);return n.count}}])}(xt.API),function(e){var r=[192,193,194,195,196,197,198,199];e.processJPEG=function(t,n,s,o,l,c){var d,h=this.decode.DCT_DECODE,u=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=l||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,(d=function(g){for(var x,m=256*g.charCodeAt(4)+g.charCodeAt(5),y=g.length,v={width:0,height:0,numcomponents:1},j=4;j<y;j+=2){if(j+=m,r.indexOf(g.charCodeAt(j+1))!==-1){x=256*g.charCodeAt(j+5)+g.charCodeAt(j+6),v={width:256*g.charCodeAt(j+7)+g.charCodeAt(j+8),height:x,numcomponents:g.charCodeAt(j+9)};break}m=256*g.charCodeAt(j+2)+g.charCodeAt(j+3)}return v}(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t)).numcomponents){case 1:c=this.color_spaces.DEVICE_GRAY;break;case 4:c=this.color_spaces.DEVICE_CMYK;break;case 3:c=this.color_spaces.DEVICE_RGB}u={data:t,width:d.width,height:d.height,colorSpace:c,bitsPerComponent:8,filter:h,index:n,alias:s}}return u}}(xt.API);var Ni,zl,kf,Tf,Cf,Fx=function(){var e,r,t;function n(o){var l,c,d,h,u,g,x,m,y,v,j,w,N,_;for(this.data=o,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},g=null;;){switch(l=this.readUInt32(),y=(function(){var C,M;for(M=[],C=0;C<4;++C)M.push(String.fromCharCode(this.data[this.pos++]));return M}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(l);break;case"fcTL":g&&this.animation.frames.push(g),this.pos+=4,g={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},u=this.readUInt16(),h=this.readUInt16()||100,g.delay=1e3*u/h,g.disposeOp=this.data[this.pos++],g.blendOp=this.data[this.pos++],g.data=[];break;case"IDAT":case"fdAT":for(y==="fdAT"&&(this.pos+=4,l-=4),o=(g!=null?g.data:void 0)||this.imgData,w=0;0<=l?w<l:w>l;0<=l?++w:--w)o.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(d=this.palette.length/3,this.transparency.indexed=this.read(l),this.transparency.indexed.length>d)throw new Error("More transparent colors than palette size");if((v=d-this.transparency.indexed.length)>0)for(N=0;0<=v?N<v:N>v;0<=v?++N:--N)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(l)[0];break;case 2:this.transparency.rgb=this.read(l)}break;case"tEXt":x=(j=this.read(l)).indexOf(0),m=String.fromCharCode.apply(String,j.slice(0,x)),this.text[m]=String.fromCharCode.apply(String,j.slice(x+1));break;case"IEND":return g&&this.animation.frames.push(g),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(_=this.colorType)===4||_===6,c=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*c,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=l}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(o){var l,c;for(c=[],l=0;0<=o?l<o:l>o;0<=o?++l:--l)c.push(this.data[this.pos++]);return c},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(o){var l=this.pixelBitlength/8,c=new Uint8Array(this.width*this.height*l),d=0,h=this;if(o==null&&(o=this.imgData),o.length===0)return new Uint8Array(0);function u(g,x,m,y){var v,j,w,N,_,C,M,D,L,E,P,H,k,T,W,G,de,J,Z,oe,ae,pe=Math.ceil((h.width-g)/m),be=Math.ceil((h.height-x)/y),A=h.width==pe&&h.height==be;for(T=l*pe,H=A?c:new Uint8Array(T*be),C=o.length,k=0,j=0;k<be&&d<C;){switch(o[d++]){case 0:for(N=de=0;de<T;N=de+=1)H[j++]=o[d++];break;case 1:for(N=J=0;J<T;N=J+=1)v=o[d++],_=N<l?0:H[j-l],H[j++]=(v+_)%256;break;case 2:for(N=Z=0;Z<T;N=Z+=1)v=o[d++],w=(N-N%l)/l,W=k&&H[(k-1)*T+w*l+N%l],H[j++]=(W+v)%256;break;case 3:for(N=oe=0;oe<T;N=oe+=1)v=o[d++],w=(N-N%l)/l,_=N<l?0:H[j-l],W=k&&H[(k-1)*T+w*l+N%l],H[j++]=(v+Math.floor((_+W)/2))%256;break;case 4:for(N=ae=0;ae<T;N=ae+=1)v=o[d++],w=(N-N%l)/l,_=N<l?0:H[j-l],k===0?W=G=0:(W=H[(k-1)*T+w*l+N%l],G=w&&H[(k-1)*T+(w-1)*l+N%l]),M=_+W-G,D=Math.abs(M-_),E=Math.abs(M-W),P=Math.abs(M-G),L=D<=E&&D<=P?_:E<=P?W:G,H[j++]=(v+L)%256;break;default:throw new Error("Invalid filter algorithm: "+o[d-1])}if(!A){var O=((x+k*y)*h.width+g)*l,I=k*T;for(N=0;N<pe;N+=1){for(var R=0;R<l;R+=1)c[O++]=H[I++];O+=(m-1)*l}}k++}}return o=lx(o),h.interlaceMethod==1?(u(0,0,8,8),u(4,0,8,8),u(0,4,4,8),u(2,0,4,4),u(0,2,2,4),u(1,0,2,2),u(0,1,1,2)):u(0,0,1,1),c},n.prototype.decodePalette=function(){var o,l,c,d,h,u,g,x,m;for(c=this.palette,u=this.transparency.indexed||[],h=new Uint8Array((u.length||0)+c.length),d=0,o=0,l=g=0,x=c.length;g<x;l=g+=3)h[d++]=c[l],h[d++]=c[l+1],h[d++]=c[l+2],h[d++]=(m=u[o++])!=null?m:255;return h},n.prototype.copyToImageData=function(o,l){var c,d,h,u,g,x,m,y,v,j,w;if(d=this.colors,v=null,c=this.hasAlphaChannel,this.palette.length&&(v=(w=this._decodedPalette)!=null?w:this._decodedPalette=this.decodePalette(),d=4,c=!0),y=(h=o.data||o).length,g=v||l,u=x=0,d===1)for(;u<y;)m=v?4*l[u/4]:x,j=g[m++],h[u++]=j,h[u++]=j,h[u++]=j,h[u++]=c?g[m++]:255,x=m;else for(;u<y;)m=v?4*l[u/4]:x,h[u++]=g[m++],h[u++]=g[m++],h[u++]=g[m++],h[u++]=c?g[m++]:255,x=m},n.prototype.decode=function(){var o;return o=new Uint8Array(this.width*this.height*4),this.copyToImageData(o,this.decodePixels()),o};var s=function(){if(Object.prototype.toString.call(yt)==="[object Window]"){try{r=yt.document.createElement("canvas"),t=r.getContext("2d")}catch{return!1}return!0}return!1};return s(),e=function(o){var l;if(s()===!0)return t.width=o.width,t.height=o.height,t.clearRect(0,0,o.width,o.height),t.putImageData(o,0,0),(l=new Image).src=r.toDataURL(),l;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(o){var l,c,d,h,u,g,x,m;if(this.animation){for(m=[],c=u=0,g=(x=this.animation.frames).length;u<g;c=++u)l=x[c],d=o.createImageData(l.width,l.height),h=this.decodePixels(new Uint8Array(l.data)),this.copyToImageData(d,h),l.imageData=d,m.push(l.image=e(d));return m}},n.prototype.renderFrame=function(o,l){var c,d,h;return c=(d=this.animation.frames)[l],h=d[l-1],l===0&&o.clearRect(0,0,this.width,this.height),(h!=null?h.disposeOp:void 0)===1?o.clearRect(h.xOffset,h.yOffset,h.width,h.height):(h!=null?h.disposeOp:void 0)===2&&o.putImageData(h.imageData,h.xOffset,h.yOffset),c.blendOp===0&&o.clearRect(c.xOffset,c.yOffset,c.width,c.height),o.drawImage(c.image,c.xOffset,c.yOffset)},n.prototype.animate=function(o){var l,c,d,h,u,g,x=this;return c=0,g=this.animation,h=g.numFrames,d=g.frames,u=g.numPlays,(l=function(){var m,y;if(m=c++%h,y=d[m],x.renderFrame(o,m),h>1&&c/h<u)return x.animation._timeout=setTimeout(l,y.delay)})()},n.prototype.stopAnimation=function(){var o;return clearTimeout((o=this.animation)!=null?o._timeout:void 0)},n.prototype.render=function(o){var l,c;return o._png&&o._png.stopAnimation(),o._png=this,o.width=this.width,o.height=this.height,l=o.getContext("2d"),this.animation?(this.decodeFrames(l),this.animate(l)):(c=l.createImageData(this.width,this.height),this.copyToImageData(c,this.decodePixels()),l.putImageData(c,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function Lx(e){var r=0;if(e[r++]!==71||e[r++]!==73||e[r++]!==70||e[r++]!==56||(e[r++]+1&253)!=56||e[r++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=e[r++]|e[r++]<<8,n=e[r++]|e[r++]<<8,s=e[r++],o=s>>7,l=1<<(7&s)+1;e[r++],e[r++];var c=null,d=null;o&&(c=r,d=l,r+=3*l);var h=!0,u=[],g=0,x=null,m=0,y=null;for(this.width=t,this.height=n;h&&r<e.length;)switch(e[r++]){case 33:switch(e[r++]){case 255:if(e[r]!==11||e[r+1]==78&&e[r+2]==69&&e[r+3]==84&&e[r+4]==83&&e[r+5]==67&&e[r+6]==65&&e[r+7]==80&&e[r+8]==69&&e[r+9]==50&&e[r+10]==46&&e[r+11]==48&&e[r+12]==3&&e[r+13]==1&&e[r+16]==0)r+=14,y=e[r++]|e[r++]<<8,r++;else for(r+=12;;){if(!((k=e[r++])>=0))throw Error("Invalid block size");if(k===0)break;r+=k}break;case 249:if(e[r++]!==4||e[r+4]!==0)throw new Error("Invalid graphics extension block.");var v=e[r++];g=e[r++]|e[r++]<<8,x=e[r++],!(1&v)&&(x=null),m=v>>2&7,r++;break;case 254:for(;;){if(!((k=e[r++])>=0))throw Error("Invalid block size");if(k===0)break;r+=k}break;default:throw new Error("Unknown graphic control label: 0x"+e[r-1].toString(16))}break;case 44:var j=e[r++]|e[r++]<<8,w=e[r++]|e[r++]<<8,N=e[r++]|e[r++]<<8,_=e[r++]|e[r++]<<8,C=e[r++],M=C>>6&1,D=1<<(7&C)+1,L=c,E=d,P=!1;C>>7&&(P=!0,L=r,E=D,r+=3*D);var H=r;for(r++;;){var k;if(!((k=e[r++])>=0))throw Error("Invalid block size");if(k===0)break;r+=k}u.push({x:j,y:w,width:N,height:_,has_local_palette:P,palette_offset:L,palette_size:E,data_offset:H,data_length:r-H,transparent_index:x,interlaced:!!M,delay:g,disposal:m});break;case 59:h=!1;break;default:throw new Error("Unknown gif block: 0x"+e[r-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return y},this.frameInfo=function(T){if(T<0||T>=u.length)throw new Error("Frame index out of range.");return u[T]},this.decodeAndBlitFrameBGRA=function(T,W){var G=this.frameInfo(T),de=G.width*G.height,J=new Uint8Array(de);Ef(e,G.data_offset,J,de);var Z=G.palette_offset,oe=G.transparent_index;oe===null&&(oe=256);var ae=G.width,pe=t-ae,be=ae,A=4*(G.y*t+G.x),O=4*((G.y+G.height)*t+G.x),I=A,R=4*pe;G.interlaced===!0&&(R+=4*t*7);for(var X=8,fe=0,he=J.length;fe<he;++fe){var ee=J[fe];if(be===0&&(be=ae,(I+=R)>=O&&(R=4*pe+4*t*(X-1),I=A+(ae+pe)*(X<<1),X>>=1)),ee===oe)I+=4;else{var ve=e[Z+3*ee],Ce=e[Z+3*ee+1],Ie=e[Z+3*ee+2];W[I++]=Ie,W[I++]=Ce,W[I++]=ve,W[I++]=255}--be}},this.decodeAndBlitFrameRGBA=function(T,W){var G=this.frameInfo(T),de=G.width*G.height,J=new Uint8Array(de);Ef(e,G.data_offset,J,de);var Z=G.palette_offset,oe=G.transparent_index;oe===null&&(oe=256);var ae=G.width,pe=t-ae,be=ae,A=4*(G.y*t+G.x),O=4*((G.y+G.height)*t+G.x),I=A,R=4*pe;G.interlaced===!0&&(R+=4*t*7);for(var X=8,fe=0,he=J.length;fe<he;++fe){var ee=J[fe];if(be===0&&(be=ae,(I+=R)>=O&&(R=4*pe+4*t*(X-1),I=A+(ae+pe)*(X<<1),X>>=1)),ee===oe)I+=4;else{var ve=e[Z+3*ee],Ce=e[Z+3*ee+1],Ie=e[Z+3*ee+2];W[I++]=ve,W[I++]=Ce,W[I++]=Ie,W[I++]=255}--be}}}function Ef(e,r,t,n){for(var s=e[r++],o=1<<s,l=o+1,c=l+1,d=s+1,h=(1<<d)-1,u=0,g=0,x=0,m=e[r++],y=new Int32Array(4096),v=null;;){for(;u<16&&m!==0;)g|=e[r++]<<u,u+=8,m===1?m=e[r++]:--m;if(u<d)break;var j=g&h;if(g>>=d,u-=d,j!==o){if(j===l)break;for(var w=j<c?j:v,N=0,_=w;_>o;)_=y[_]>>8,++N;var C=_;if(x+N+(w!==j?1:0)>n)return void tr.log("Warning, gif stream longer than expected.");t[x++]=C;var M=x+=N;for(w!==j&&(t[x++]=C),_=w;N--;)_=y[_],t[--M]=255&_,_>>=8;v!==null&&c<4096&&(y[c++]=v<<8|C,c>=h+1&&d<12&&(++d,h=h<<1|1)),v=j}else c=l+1,h=(1<<(d=s+1))-1,v=null}return x!==n&&tr.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function S0(e){var r,t,n,s,o,l=Math.floor,c=new Array(64),d=new Array(64),h=new Array(64),u=new Array(64),g=new Array(65535),x=new Array(65535),m=new Array(64),y=new Array(64),v=[],j=0,w=7,N=new Array(64),_=new Array(64),C=new Array(64),M=new Array(256),D=new Array(2048),L=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],E=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],P=[0,1,2,3,4,5,6,7,8,9,10,11],H=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],k=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],T=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],W=[0,1,2,3,4,5,6,7,8,9,10,11],G=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],de=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function J(A,O){for(var I=0,R=0,X=new Array,fe=1;fe<=16;fe++){for(var he=1;he<=A[fe];he++)X[O[R]]=[],X[O[R]][0]=I,X[O[R]][1]=fe,R++,I++;I*=2}return X}function Z(A){for(var O=A[0],I=A[1]-1;I>=0;)O&1<<I&&(j|=1<<w),I--,--w<0&&(j==255?(oe(255),oe(0)):oe(j),w=7,j=0)}function oe(A){v.push(A)}function ae(A){oe(A>>8&255),oe(255&A)}function pe(A,O,I,R,X){for(var fe,he=X[0],ee=X[240],ve=function(We,Ye){var Qe,tt,dt,ht,wt,kt,Ft,Lt,vt,Ct,at=0;for(vt=0;vt<8;++vt){Qe=We[at],tt=We[at+1],dt=We[at+2],ht=We[at+3],wt=We[at+4],kt=We[at+5],Ft=We[at+6];var Fr=Qe+(Lt=We[at+7]),Ot=Qe-Lt,pn=tt+Ft,Wt=tt-Ft,nr=dt+kt,Bn=dt-kt,Dt=ht+wt,va=ht-wt,ir=Fr+Dt,An=Fr-Dt,Zn=pn+nr,Qt=pn-nr;We[at]=ir+Zn,We[at+4]=ir-Zn;var Nt=.707106781*(Qt+An);We[at+2]=An+Nt,We[at+6]=An-Nt;var Mt=.382683433*((ir=va+Bn)-(Qt=Wt+Ot)),Pa=.5411961*ir+Mt,Lr=1.306562965*Qt+Mt,Un=.707106781*(Zn=Bn+Wt),Hn=Ot+Un,mt=Ot-Un;We[at+5]=mt+Pa,We[at+3]=mt-Pa,We[at+1]=Hn+Lr,We[at+7]=Hn-Lr,at+=8}for(at=0,vt=0;vt<8;++vt){Qe=We[at],tt=We[at+8],dt=We[at+16],ht=We[at+24],wt=We[at+32],kt=We[at+40],Ft=We[at+48];var kn=Qe+(Lt=We[at+56]),xn=Qe-Lt,Zr=tt+Ft,gr=tt-Ft,dr=dt+kt,q=dt-kt,se=ht+wt,Q=ht-wt,te=kn+se,ne=kn-se,ie=Zr+dr,Se=Zr-dr;We[at]=te+ie,We[at+32]=te-ie;var Fe=.707106781*(Se+ne);We[at+16]=ne+Fe,We[at+48]=ne-Fe;var je=.382683433*((te=Q+q)-(Se=gr+xn)),ke=.5411961*te+je,Te=1.306562965*Se+je,qe=.707106781*(ie=q+gr),Xe=xn+qe,it=xn-qe;We[at+40]=it+ke,We[at+24]=it-ke,We[at+8]=Xe+Te,We[at+56]=Xe-Te,at++}for(vt=0;vt<64;++vt)Ct=We[vt]*Ye[vt],m[vt]=Ct>0?Ct+.5|0:Ct-.5|0;return m}(A,O),Ce=0;Ce<64;++Ce)y[L[Ce]]=ve[Ce];var Ie=y[0]-I;I=y[0],Ie==0?Z(R[0]):(Z(R[x[fe=32767+Ie]]),Z(g[fe]));for(var Ve=63;Ve>0&&y[Ve]==0;)Ve--;if(Ve==0)return Z(he),I;for(var $e,Ee=1;Ee<=Ve;){for(var le=Ee;y[Ee]==0&&Ee<=Ve;)++Ee;var Be=Ee-le;if(Be>=16){$e=Be>>4;for(var Ze=1;Ze<=$e;++Ze)Z(ee);Be&=15}fe=32767+y[Ee],Z(X[(Be<<4)+x[fe]]),Z(g[fe]),Ee++}return Ve!=63&&Z(he),I}function be(A){A=Math.min(Math.max(A,1),100),o!=A&&(function(O){for(var I=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],R=0;R<64;R++){var X=l((I[R]*O+50)/100);X=Math.min(Math.max(X,1),255),c[L[R]]=X}for(var fe=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],he=0;he<64;he++){var ee=l((fe[he]*O+50)/100);ee=Math.min(Math.max(ee,1),255),d[L[he]]=ee}for(var ve=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ce=0,Ie=0;Ie<8;Ie++)for(var Ve=0;Ve<8;Ve++)h[Ce]=1/(c[L[Ce]]*ve[Ie]*ve[Ve]*8),u[Ce]=1/(d[L[Ce]]*ve[Ie]*ve[Ve]*8),Ce++}(A<50?Math.floor(5e3/A):Math.floor(200-2*A)),o=A)}this.encode=function(A,O){O&&be(O),v=new Array,j=0,w=7,ae(65496),ae(65504),ae(16),oe(74),oe(70),oe(73),oe(70),oe(0),oe(1),oe(1),oe(0),ae(1),ae(1),oe(0),oe(0),function(){ae(65499),ae(132),oe(0);for(var tt=0;tt<64;tt++)oe(c[tt]);oe(1);for(var dt=0;dt<64;dt++)oe(d[dt])}(),function(tt,dt){ae(65472),ae(17),oe(8),ae(dt),ae(tt),oe(3),oe(1),oe(17),oe(0),oe(2),oe(17),oe(1),oe(3),oe(17),oe(1)}(A.width,A.height),function(){ae(65476),ae(418),oe(0);for(var tt=0;tt<16;tt++)oe(E[tt+1]);for(var dt=0;dt<=11;dt++)oe(P[dt]);oe(16);for(var ht=0;ht<16;ht++)oe(H[ht+1]);for(var wt=0;wt<=161;wt++)oe(k[wt]);oe(1);for(var kt=0;kt<16;kt++)oe(T[kt+1]);for(var Ft=0;Ft<=11;Ft++)oe(W[Ft]);oe(17);for(var Lt=0;Lt<16;Lt++)oe(G[Lt+1]);for(var vt=0;vt<=161;vt++)oe(de[vt])}(),ae(65498),ae(12),oe(3),oe(1),oe(0),oe(2),oe(17),oe(3),oe(17),oe(0),oe(63),oe(0);var I=0,R=0,X=0;j=0,w=7,this.encode.displayName="_encode_";for(var fe,he,ee,ve,Ce,Ie,Ve,$e,Ee,le=A.data,Be=A.width,Ze=A.height,We=4*Be,Ye=0;Ye<Ze;){for(fe=0;fe<We;){for(Ce=We*Ye+fe,Ve=-1,$e=0,Ee=0;Ee<64;Ee++)Ie=Ce+($e=Ee>>3)*We+(Ve=4*(7&Ee)),Ye+$e>=Ze&&(Ie-=We*(Ye+1+$e-Ze)),fe+Ve>=We&&(Ie-=fe+Ve-We+4),he=le[Ie++],ee=le[Ie++],ve=le[Ie++],N[Ee]=(D[he]+D[ee+256>>0]+D[ve+512>>0]>>16)-128,_[Ee]=(D[he+768>>0]+D[ee+1024>>0]+D[ve+1280>>0]>>16)-128,C[Ee]=(D[he+1280>>0]+D[ee+1536>>0]+D[ve+1792>>0]>>16)-128;I=pe(N,h,I,r,n),R=pe(_,u,R,t,s),X=pe(C,u,X,t,s),fe+=32}Ye+=8}if(w>=0){var Qe=[];Qe[1]=w+1,Qe[0]=(1<<w+1)-1,Z(Qe)}return ae(65497),new Uint8Array(v)},e=e||50,function(){for(var A=String.fromCharCode,O=0;O<256;O++)M[O]=A(O)}(),r=J(E,P),t=J(T,W),n=J(H,k),s=J(G,de),function(){for(var A=1,O=2,I=1;I<=15;I++){for(var R=A;R<O;R++)x[32767+R]=I,g[32767+R]=[],g[32767+R][1]=I,g[32767+R][0]=R;for(var X=-(O-1);X<=-A;X++)x[32767+X]=I,g[32767+X]=[],g[32767+X][1]=I,g[32767+X][0]=O-1+X;A<<=1,O<<=1}}(),function(){for(var A=0;A<256;A++)D[A]=19595*A,D[A+256>>0]=38470*A,D[A+512>>0]=7471*A+32768,D[A+768>>0]=-11059*A,D[A+1024>>0]=-21709*A,D[A+1280>>0]=32768*A+8421375,D[A+1536>>0]=-27439*A,D[A+1792>>0]=-5329*A}(),be(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function oa(e,r){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!r,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Ff(e){function r(E){if(!E)throw Error("assert :P")}function t(E,P,H){for(var k=0;4>k;k++)if(E[P+k]!=H.charCodeAt(k))return!0;return!1}function n(E,P,H,k,T){for(var W=0;W<T;W++)E[P+W]=H[k+W]}function s(E,P,H,k){for(var T=0;T<k;T++)E[P+T]=H}function o(E){return new Int32Array(E)}function l(E,P){for(var H=[],k=0;k<E;k++)H.push(new P);return H}function c(E,P){var H=[];return function k(T,W,G){for(var de=G[W],J=0;J<de&&(T.push(G.length>W+1?[]:new P),!(G.length<W+1));J++)k(T[J],W+1,G)}(H,0,E),H}var d=function(){var E=this;function P(f,p){for(var S=1<<p-1>>>0;f&S;)S>>>=1;return S?(f&S-1)+S:f}function H(f,p,S,F,B){r(!(F%S));do f[p+(F-=S)]=B;while(0<F)}function k(f,p,S,F,B){if(r(2328>=B),512>=B)var z=o(512);else if((z=o(B))==null)return 0;return function(V,Y,K,re,xe,_e){var Ae,we,Me=Y,Le=1<<K,ge=o(16),ye=o(16);for(r(xe!=0),r(re!=null),r(V!=null),r(0<K),we=0;we<xe;++we){if(15<re[we])return 0;++ge[re[we]]}if(ge[0]==xe)return 0;for(ye[1]=0,Ae=1;15>Ae;++Ae){if(ge[Ae]>1<<Ae)return 0;ye[Ae+1]=ye[Ae]+ge[Ae]}for(we=0;we<xe;++we)Ae=re[we],0<re[we]&&(_e[ye[Ae]++]=we);if(ye[15]==1)return(re=new T).g=0,re.value=_e[0],H(V,Me,1,Le,re),Le;var De,He=-1,Re=Le-1,lt=0,et=1,pt=1,rt=1<<K;for(we=0,Ae=1,xe=2;Ae<=K;++Ae,xe<<=1){if(et+=pt<<=1,0>(pt-=ge[Ae]))return 0;for(;0<ge[Ae];--ge[Ae])(re=new T).g=Ae,re.value=_e[we++],H(V,Me+lt,xe,rt,re),lt=P(lt,Ae)}for(Ae=K+1,xe=2;15>=Ae;++Ae,xe<<=1){if(et+=pt<<=1,0>(pt-=ge[Ae]))return 0;for(;0<ge[Ae];--ge[Ae]){if(re=new T,(lt&Re)!=He){for(Me+=rt,De=1<<(He=Ae)-K;15>He&&!(0>=(De-=ge[He]));)++He,De<<=1;Le+=rt=1<<(De=He-K),V[Y+(He=lt&Re)].g=De+K,V[Y+He].value=Me-Y-He}re.g=Ae-K,re.value=_e[we++],H(V,Me+(lt>>K),xe,rt,re),lt=P(lt,Ae)}}return et!=2*ye[15]-1?0:Le}(f,p,S,F,B,z)}function T(){this.value=this.g=0}function W(){this.value=this.g=0}function G(){this.G=l(5,T),this.H=o(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=l(zr,W)}function de(f,p,S,F){r(f!=null),r(p!=null),r(2147483648>F),f.Ca=254,f.I=0,f.b=-8,f.Ka=0,f.oa=p,f.pa=S,f.Jd=p,f.Yc=S+F,f.Zc=4<=F?S+F-4+1:S,fe(f)}function J(f,p){for(var S=0;0<p--;)S|=ee(f,128)<<p;return S}function Z(f,p){var S=J(f,p);return he(f)?-S:S}function oe(f,p,S,F){var B,z=0;for(r(f!=null),r(p!=null),r(4294967288>F),f.Sb=F,f.Ra=0,f.u=0,f.h=0,4<F&&(F=4),B=0;B<F;++B)z+=p[S+B]<<8*B;f.Ra=z,f.bb=F,f.oa=p,f.pa=S}function ae(f){for(;8<=f.u&&f.bb<f.Sb;)f.Ra>>>=8,f.Ra+=f.oa[f.pa+f.bb]<<fi-8>>>0,++f.bb,f.u-=8;I(f)&&(f.h=1,f.u=0)}function pe(f,p){if(r(0<=p),!f.h&&p<=di){var S=O(f)&ci[p];return f.u+=p,ae(f),S}return f.h=1,f.u=0}function be(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function A(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function O(f){return f.Ra>>>(f.u&fi-1)>>>0}function I(f){return r(f.bb<=f.Sb),f.h||f.bb==f.Sb&&f.u>fi}function R(f,p){f.u=p,f.h=I(f)}function X(f){f.u>=so&&(r(f.u>=so),ae(f))}function fe(f){r(f!=null&&f.oa!=null),f.pa<f.Zc?(f.I=(f.oa[f.pa++]|f.I<<8)>>>0,f.b+=8):(r(f!=null&&f.oa!=null),f.pa<f.Yc?(f.b+=8,f.I=f.oa[f.pa++]|f.I<<8):f.Ka?f.b=0:(f.I<<=8,f.b+=8,f.Ka=1))}function he(f){return J(f,1)}function ee(f,p){var S=f.Ca;0>f.b&&fe(f);var F=f.b,B=S*p>>>8,z=(f.I>>>F>B)+0;for(z?(S-=B,f.I-=B+1<<F>>>0):S=B+1,F=S,B=0;256<=F;)B+=8,F>>=8;return F=7^B+vn[F],f.b-=F,f.Ca=(S<<F)-1,z}function ve(f,p,S){f[p+0]=S>>24&255,f[p+1]=S>>16&255,f[p+2]=S>>8&255,f[p+3]=S>>0&255}function Ce(f,p){return f[p+0]<<0|f[p+1]<<8}function Ie(f,p){return Ce(f,p)|f[p+2]<<16}function Ve(f,p){return Ce(f,p)|Ce(f,p+2)<<16}function $e(f,p){var S=1<<p;return r(f!=null),r(0<p),f.X=o(S),f.X==null?0:(f.Mb=32-p,f.Xa=p,1)}function Ee(f,p){r(f!=null),r(p!=null),r(f.Xa==p.Xa),n(p.X,0,f.X,0,1<<p.Xa)}function le(){this.X=[],this.Xa=this.Mb=0}function Be(f,p,S,F){r(S!=null),r(F!=null);var B=S[0],z=F[0];return B==0&&(B=(f*z+p/2)/p),z==0&&(z=(p*B+f/2)/f),0>=B||0>=z?0:(S[0]=B,F[0]=z,1)}function Ze(f,p){return f+(1<<p)-1>>>p}function We(f,p){return((4278255360&f)+(4278255360&p)>>>0&4278255360)+((16711935&f)+(16711935&p)>>>0&16711935)>>>0}function Ye(f,p){E[p]=function(S,F,B,z,V,Y,K){var re;for(re=0;re<V;++re){var xe=E[f](Y[K+re-1],B,z+re);Y[K+re]=We(S[F+re],xe)}}}function Qe(){this.ud=this.hd=this.jd=0}function tt(f,p){return((4278124286&(f^p))>>>1)+(f&p)>>>0}function dt(f){return 0<=f&&256>f?f:0>f?0:255<f?255:void 0}function ht(f,p){return dt(f+(f-p+.5>>1))}function wt(f,p,S){return Math.abs(p-S)-Math.abs(f-S)}function kt(f,p,S,F,B,z,V){for(F=z[V-1],S=0;S<B;++S)z[V+S]=F=We(f[p+S],F)}function Ft(f,p,S,F,B){var z;for(z=0;z<S;++z){var V=f[p+z],Y=V>>8&255,K=16711935&(K=(K=16711935&V)+((Y<<16)+Y));F[B+z]=(4278255360&V)+K>>>0}}function Lt(f,p){p.jd=f>>0&255,p.hd=f>>8&255,p.ud=f>>16&255}function vt(f,p,S,F,B,z){var V;for(V=0;V<F;++V){var Y=p[S+V],K=Y>>>8,re=Y,xe=255&(xe=(xe=Y>>>16)+((f.jd<<24>>24)*(K<<24>>24)>>>5));re=255&(re=(re=re+((f.hd<<24>>24)*(K<<24>>24)>>>5))+((f.ud<<24>>24)*(xe<<24>>24)>>>5)),B[z+V]=(4278255360&Y)+(xe<<16)+re}}function Ct(f,p,S,F,B){E[p]=function(z,V,Y,K,re,xe,_e,Ae,we){for(K=_e;K<Ae;++K)for(_e=0;_e<we;++_e)re[xe++]=B(Y[F(z[V++])])},E[f]=function(z,V,Y,K,re,xe,_e){var Ae=8>>z.b,we=z.Ea,Me=z.K[0],Le=z.w;if(8>Ae)for(z=(1<<z.b)-1,Le=(1<<Ae)-1;V<Y;++V){var ge,ye=0;for(ge=0;ge<we;++ge)ge&z||(ye=F(K[re++])),xe[_e++]=B(Me[ye&Le]),ye>>=Ae}else E["VP8LMapColor"+S](K,re,Me,Le,xe,_e,V,Y,we)}}function at(f,p,S,F,B){for(S=p+S;p<S;){var z=f[p++];F[B++]=z>>16&255,F[B++]=z>>8&255,F[B++]=z>>0&255}}function Fr(f,p,S,F,B){for(S=p+S;p<S;){var z=f[p++];F[B++]=z>>16&255,F[B++]=z>>8&255,F[B++]=z>>0&255,F[B++]=z>>24&255}}function Ot(f,p,S,F,B){for(S=p+S;p<S;){var z=(V=f[p++])>>16&240|V>>12&15,V=V>>0&240|V>>28&15;F[B++]=z,F[B++]=V}}function pn(f,p,S,F,B){for(S=p+S;p<S;){var z=(V=f[p++])>>16&248|V>>13&7,V=V>>5&224|V>>3&31;F[B++]=z,F[B++]=V}}function Wt(f,p,S,F,B){for(S=p+S;p<S;){var z=f[p++];F[B++]=z>>0&255,F[B++]=z>>8&255,F[B++]=z>>16&255}}function nr(f,p,S,F,B,z){if(z==0)for(S=p+S;p<S;)ve(F,((z=f[p++])[0]>>24|z[1]>>8&65280|z[2]<<8&16711680|z[3]<<24)>>>0),B+=32;else n(F,B,f,p,S)}function Bn(f,p){E[p][0]=E[f+"0"],E[p][1]=E[f+"1"],E[p][2]=E[f+"2"],E[p][3]=E[f+"3"],E[p][4]=E[f+"4"],E[p][5]=E[f+"5"],E[p][6]=E[f+"6"],E[p][7]=E[f+"7"],E[p][8]=E[f+"8"],E[p][9]=E[f+"9"],E[p][10]=E[f+"10"],E[p][11]=E[f+"11"],E[p][12]=E[f+"12"],E[p][13]=E[f+"13"],E[p][14]=E[f+"0"],E[p][15]=E[f+"0"]}function Dt(f){return f==Yc||f==Xc||f==wl||f==Kc}function va(){this.eb=[],this.size=this.A=this.fb=0}function ir(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function An(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new va,this.f.kb=new ir,this.sd=null}function Zn(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Qt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Nt(f){return alert("todo:WebPSamplerProcessPlane"),f.T}function Mt(f,p){var S=f.T,F=p.ba.f.RGBA,B=F.eb,z=F.fb+f.ka*F.A,V=$n[p.ba.S],Y=f.y,K=f.O,re=f.f,xe=f.N,_e=f.ea,Ae=f.W,we=p.cc,Me=p.dc,Le=p.Mc,ge=p.Nc,ye=f.ka,De=f.ka+f.T,He=f.U,Re=He+1>>1;for(ye==0?V(Y,K,null,null,re,xe,_e,Ae,re,xe,_e,Ae,B,z,null,null,He):(V(p.ec,p.fc,Y,K,we,Me,Le,ge,re,xe,_e,Ae,B,z-F.A,B,z,He),++S);ye+2<De;ye+=2)we=re,Me=xe,Le=_e,ge=Ae,xe+=f.Rc,Ae+=f.Rc,z+=2*F.A,V(Y,(K+=2*f.fa)-f.fa,Y,K,we,Me,Le,ge,re,xe,_e,Ae,B,z-F.A,B,z,He);return K+=f.fa,f.j+De<f.o?(n(p.ec,p.fc,Y,K,He),n(p.cc,p.dc,re,xe,Re),n(p.Mc,p.Nc,_e,Ae,Re),S--):1&De||V(Y,K,null,null,re,xe,_e,Ae,re,xe,_e,Ae,B,z+F.A,null,null,He),S}function Pa(f,p,S){var F=f.F,B=[f.J];if(F!=null){var z=f.U,V=p.ba.S,Y=V==bl||V==wl;p=p.ba.f.RGBA;var K=[0],re=f.ka;K[0]=f.T,f.Kb&&(re==0?--K[0]:(--re,B[0]-=f.width),f.j+f.ka+f.T==f.o&&(K[0]=f.o-f.j-re));var xe=p.eb;re=p.fb+re*p.A,f=sr(F,B[0],f.width,z,K,xe,re+(Y?0:3),p.A),r(S==K),f&&Dt(V)&&Vn(xe,re,Y,z,K,p.A)}return 0}function Lr(f){var p=f.ma,S=p.ba.S,F=11>S,B=S==vl||S==yl||S==bl||S==$c||S==12||Dt(S);if(p.memory=null,p.Ib=null,p.Jb=null,p.Nd=null,!no(p.Oa,f,B?11:12))return 0;if(B&&Dt(S)&&ze(),f.da)alert("todo:use_scaling");else{if(F){if(p.Ib=Nt,f.Kb){if(S=f.U+1>>1,p.memory=o(f.U+2*S),p.memory==null)return 0;p.ec=p.memory,p.fc=0,p.cc=p.ec,p.dc=p.fc+f.U,p.Mc=p.cc,p.Nc=p.dc+S,p.Ib=Mt,ze()}}else alert("todo:EmitYUV");B&&(p.Jb=Pa,F&&Ne())}if(F&&!Rd){for(f=0;256>f;++f)q1[f]=89858*(f-128)+jl>>Nl,$1[f]=-22014*(f-128)+jl,G1[f]=-45773*(f-128),V1[f]=113618*(f-128)+jl>>Nl;for(f=uo;f<Qc;++f)p=76283*(f-16)+jl>>Nl,Y1[f-uo]=Cn(p,255),X1[f-uo]=Cn(p+8>>4,15);Rd=1}return 1}function Un(f){var p=f.ma,S=f.U,F=f.T;return r(!(1&f.ka)),0>=S||0>=F?0:(S=p.Ib(f,p),p.Jb!=null&&p.Jb(f,p,S),p.Dc+=S,1)}function Hn(f){f.ma.memory=null}function mt(f,p,S,F){return pe(f,8)!=47?0:(p[0]=pe(f,14)+1,S[0]=pe(f,14)+1,F[0]=pe(f,1),pe(f,3)!=0?0:!f.h)}function kn(f,p){if(4>f)return f+1;var S=f-2>>1;return(2+(1&f)<<S)+pe(p,S)+1}function xn(f,p){return 120<p?p-120:1<=(S=((S=E1[p-1])>>4)*f+(8-(15&S)))?S:1;var S}function Zr(f,p,S){var F=O(S),B=f[p+=255&F].g-8;return 0<B&&(R(S,S.u+8),F=O(S),p+=f[p].value,p+=F&(1<<B)-1),R(S,S.u+f[p].g),f[p].value}function gr(f,p,S){return S.g+=f.g,S.value+=f.value<<p>>>0,r(8>=S.g),f.g}function dr(f,p,S){var F=f.xc;return r((p=F==0?0:f.vc[f.md*(S>>F)+(p>>F)])<f.Wb),f.Ya[p]}function q(f,p,S,F){var B=f.ab,z=f.c*p,V=f.C;p=V+p;var Y=S,K=F;for(F=f.Ta,S=f.Ua;0<B--;){var re=f.gc[B],xe=V,_e=p,Ae=Y,we=K,Me=(K=F,Y=S,re.Ea);switch(r(xe<_e),r(_e<=re.nc),re.hc){case 2:fl(Ae,we,(_e-xe)*Me,K,Y);break;case 0:var Le=xe,ge=_e,ye=K,De=Y,He=(rt=re).Ea;Le==0&&(Vc(Ae,we,null,null,1,ye,De),kt(Ae,we+1,0,0,He-1,ye,De+1),we+=He,De+=He,++Le);for(var Re=1<<rt.b,lt=Re-1,et=Ze(He,rt.b),pt=rt.K,rt=rt.w+(Le>>rt.b)*et;Le<ge;){var Ut=pt,qt=rt,Rt=1;for(io(Ae,we,ye,De-He,1,ye,De);Rt<He;){var Pt=(Rt&~lt)+Re;Pt>He&&(Pt=He),(0,es[Ut[qt++]>>8&15])(Ae,we+ +Rt,ye,De+Rt-He,Pt-Rt,ye,De+Rt),Rt=Pt}we+=He,De+=He,++Le&lt||(rt+=et)}_e!=re.nc&&n(K,Y-Me,K,Y+(_e-xe-1)*Me,Me);break;case 1:for(Me=Ae,ge=we,He=(Ae=re.Ea)-(De=Ae&~(ye=(we=1<<re.b)-1)),Le=Ze(Ae,re.b),Re=re.K,re=re.w+(xe>>re.b)*Le;xe<_e;){for(lt=Re,et=re,pt=new Qe,rt=ge+De,Ut=ge+Ae;ge<rt;)Lt(lt[et++],pt),Es(pt,Me,ge,we,K,Y),ge+=we,Y+=we;ge<Ut&&(Lt(lt[et++],pt),Es(pt,Me,ge,He,K,Y),ge+=He,Y+=He),++xe&ye||(re+=Le)}break;case 3:if(Ae==K&&we==Y&&0<re.b){for(ge=K,Ae=Me=Y+(_e-xe)*Me-(De=(_e-xe)*Ze(re.Ea,re.b)),we=K,ye=Y,Le=[],De=(He=De)-1;0<=De;--De)Le[De]=we[ye+De];for(De=He-1;0<=De;--De)ge[Ae+De]=Le[De];Wn(re,xe,_e,K,Me,K,Y)}else Wn(re,xe,_e,Ae,we,K,Y)}Y=F,K=S}K!=S&&n(F,S,Y,K,z)}function se(f,p){var S=f.V,F=f.Ba+f.c*f.C,B=p-f.C;if(r(p<=f.l.o),r(16>=B),0<B){var z=f.l,V=f.Ta,Y=f.Ua,K=z.width;if(q(f,B,S,F),B=Y=[Y],r((S=f.C)<(F=p)),r(z.v<z.va),F>z.o&&(F=z.o),S<z.j){var re=z.j-S;S=z.j,B[0]+=re*K}if(S>=F?S=0:(B[0]+=4*z.v,z.ka=S-z.j,z.U=z.va-z.v,z.T=F-S,S=1),S){if(Y=Y[0],11>(S=f.ca).S){var xe=S.f.RGBA,_e=(F=S.S,B=z.U,z=z.T,re=xe.eb,xe.A),Ae=z;for(xe=xe.fb+f.Ma*xe.A;0<Ae--;){var we=V,Me=Y,Le=B,ge=re,ye=xe;switch(F){case gl:yn(we,Me,Le,ge,ye);break;case vl:cn(we,Me,Le,ge,ye);break;case Yc:cn(we,Me,Le,ge,ye),Vn(ge,ye,0,Le,1,0);break;case Td:Ma(we,Me,Le,ge,ye);break;case yl:nr(we,Me,Le,ge,ye,1);break;case Xc:nr(we,Me,Le,ge,ye,1),Vn(ge,ye,0,Le,1,0);break;case bl:nr(we,Me,Le,ge,ye,0);break;case wl:nr(we,Me,Le,ge,ye,0),Vn(ge,ye,1,Le,1,0);break;case $c:ts(we,Me,Le,ge,ye);break;case Kc:ts(we,Me,Le,ge,ye),ar(ge,ye,Le,1,0);break;case Cd:Ra(we,Me,Le,ge,ye);break;default:r(0)}Y+=K,xe+=_e}f.Ma+=z}else alert("todo:EmitRescaledRowsYUVA");r(f.Ma<=S.height)}}f.C=p,r(f.C<=f.i)}function Q(f){var p;if(0<f.ua)return 0;for(p=0;p<f.Wb;++p){var S=f.Ya[p].G,F=f.Ya[p].H;if(0<S[1][F[1]+0].g||0<S[2][F[2]+0].g||0<S[3][F[3]+0].g)return 0}return 1}function te(f,p,S,F,B,z){if(f.Z!=0){var V=f.qd,Y=f.rd;for(r(ss[f.Z]!=null);p<S;++p)ss[f.Z](V,Y,F,B,F,B,z),V=F,Y=B,B+=z;f.qd=V,f.rd=Y}}function ne(f,p){var S=f.l.ma,F=S.Z==0||S.Z==1?f.l.j:f.C;if(F=f.C<F?F:f.C,r(p<=f.l.o),p>F){var B=f.l.width,z=S.ca,V=S.tb+B*F,Y=f.V,K=f.Ba+f.c*F,re=f.gc;r(f.ab==1),r(re[0].hc==3),hl(re[0],F,p,Y,K,z,V),te(S,F,p,z,V,B)}f.C=f.Ma=p}function ie(f,p,S,F,B,z,V){var Y=f.$/F,K=f.$%F,re=f.m,xe=f.s,_e=S+f.$,Ae=_e;B=S+F*B;var we=S+F*z,Me=280+xe.ua,Le=f.Pb?Y:16777216,ge=0<xe.ua?xe.Wa:null,ye=xe.wc,De=_e<we?dr(xe,K,Y):null;r(f.C<z),r(we<=B);var He=!1;e:for(;;){for(;He||_e<we;){var Re=0;if(Y>=Le){var lt=_e-S;r((Le=f).Pb),Le.wd=Le.m,Le.xd=lt,0<Le.s.ua&&Ee(Le.s.Wa,Le.s.vb),Le=Y+L1}if(K&ye||(De=dr(xe,K,Y)),r(De!=null),De.Qb&&(p[_e]=De.qb,He=!0),!He)if(X(re),De.jc){Re=re,lt=p;var et=_e,pt=De.pd[O(Re)&zr-1];r(De.jc),256>pt.g?(R(Re,Re.u+pt.g),lt[et]=pt.value,Re=0):(R(Re,Re.u+pt.g-256),r(256<=pt.value),Re=pt.value),Re==0&&(He=!0)}else Re=Zr(De.G[0],De.H[0],re);if(re.h)break;if(He||256>Re){if(!He)if(De.nd)p[_e]=(De.qb|Re<<8)>>>0;else{if(X(re),He=Zr(De.G[1],De.H[1],re),X(re),lt=Zr(De.G[2],De.H[2],re),et=Zr(De.G[3],De.H[3],re),re.h)break;p[_e]=(et<<24|He<<16|Re<<8|lt)>>>0}if(He=!1,++_e,++K>=F&&(K=0,++Y,V!=null&&Y<=z&&!(Y%16)&&V(f,Y),ge!=null))for(;Ae<_e;)Re=p[Ae++],ge.X[(506832829*Re&4294967295)>>>ge.Mb]=Re}else if(280>Re){if(Re=kn(Re-256,re),lt=Zr(De.G[4],De.H[4],re),X(re),lt=xn(F,lt=kn(lt,re)),re.h)break;if(_e-S<lt||B-_e<Re)break e;for(et=0;et<Re;++et)p[_e+et]=p[_e+et-lt];for(_e+=Re,K+=Re;K>=F;)K-=F,++Y,V!=null&&Y<=z&&!(Y%16)&&V(f,Y);if(r(_e<=B),K&ye&&(De=dr(xe,K,Y)),ge!=null)for(;Ae<_e;)Re=p[Ae++],ge.X[(506832829*Re&4294967295)>>>ge.Mb]=Re}else{if(!(Re<Me))break e;for(He=Re-280,r(ge!=null);Ae<_e;)Re=p[Ae++],ge.X[(506832829*Re&4294967295)>>>ge.Mb]=Re;Re=_e,r(!(He>>>(lt=ge).Xa)),p[Re]=lt.X[He],He=!0}He||r(re.h==I(re))}if(f.Pb&&re.h&&_e<B)r(f.m.h),f.a=5,f.m=f.wd,f.$=f.xd,0<f.s.ua&&Ee(f.s.vb,f.s.Wa);else{if(re.h)break e;V!=null&&V(f,Y>z?z:Y),f.a=0,f.$=_e-S}return 1}return f.a=3,0}function Se(f){r(f!=null),f.vc=null,f.yc=null,f.Ya=null;var p=f.Wa;p!=null&&(p.X=null),f.vb=null,r(f!=null)}function Fe(){var f=new qc;return f==null?null:(f.a=0,f.xb=Ld,Bn("Predictor","VP8LPredictors"),Bn("Predictor","VP8LPredictors_C"),Bn("PredictorAdd","VP8LPredictorsAdd"),Bn("PredictorAdd","VP8LPredictorsAdd_C"),fl=Ft,Es=vt,yn=at,cn=Fr,ts=Ot,Ra=pn,Ma=Wt,E.VP8LMapColor32b=hi,E.VP8LMapColor8b=ul,f)}function je(f,p,S,F,B){var z=1,V=[f],Y=[p],K=F.m,re=F.s,xe=null,_e=0;e:for(;;){if(S)for(;z&&pe(K,1);){var Ae=V,we=Y,Me=F,Le=1,ge=Me.m,ye=Me.gc[Me.ab],De=pe(ge,2);if(Me.Oc&1<<De)z=0;else{switch(Me.Oc|=1<<De,ye.hc=De,ye.Ea=Ae[0],ye.nc=we[0],ye.K=[null],++Me.ab,r(4>=Me.ab),De){case 0:case 1:ye.b=pe(ge,3)+2,Le=je(Ze(ye.Ea,ye.b),Ze(ye.nc,ye.b),0,Me,ye.K),ye.K=ye.K[0];break;case 3:var He,Re=pe(ge,8)+1,lt=16<Re?0:4<Re?1:2<Re?2:3;if(Ae[0]=Ze(ye.Ea,lt),ye.b=lt,He=Le=je(Re,1,0,Me,ye.K)){var et,pt=Re,rt=ye,Ut=1<<(8>>rt.b),qt=o(Ut);if(qt==null)He=0;else{var Rt=rt.K[0],Pt=rt.w;for(qt[0]=rt.K[0][0],et=1;et<1*pt;++et)qt[et]=We(Rt[Pt+et],qt[et-1]);for(;et<4*Ut;++et)qt[et]=0;rt.K[0]=null,rt.K[0]=qt,He=1}}Le=He;break;case 2:break;default:r(0)}z=Le}}if(V=V[0],Y=Y[0],z&&pe(K,1)&&!(z=1<=(_e=pe(K,4))&&11>=_e)){F.a=3;break e}var er;if(er=z)t:{var Jt,Tt,Ar,bn=F,kr=V,wn=Y,Vt=_e,Fn=S,Ln=bn.m,Mr=bn.s,qr=[null],fn=1,Yn=0,Sa=F1[Vt];r:for(;;){if(Fn&&pe(Ln,1)){var Br=pe(Ln,3)+2,Wa=Ze(kr,Br),Is=Ze(wn,Br),gi=Wa*Is;if(!je(Wa,Is,0,bn,qr))break r;for(qr=qr[0],Mr.xc=Br,Jt=0;Jt<gi;++Jt){var is=qr[Jt]>>8&65535;qr[Jt]=is,is>=fn&&(fn=is+1)}}if(Ln.h)break r;for(Tt=0;5>Tt;++Tt){var hr=Ed[Tt];!Tt&&0<Vt&&(hr+=1<<Vt),Yn<hr&&(Yn=hr)}var e0=l(fn*Sa,T),Ud=fn,Hd=l(Ud,G);if(Hd==null)var _l=null;else r(65536>=Ud),_l=Hd;var mo=o(Yn);if(_l==null||mo==null||e0==null){bn.a=1;break r}var Al=e0;for(Jt=Ar=0;Jt<fn;++Jt){var sa=_l[Jt],vi=sa.G,yi=sa.H,Wd=0,kl=1,zd=0;for(Tt=0;5>Tt;++Tt){hr=Ed[Tt],vi[Tt]=Al,yi[Tt]=Ar,!Tt&&0<Vt&&(hr+=1<<Vt);a:{var Tl,t0=hr,Cl=bn,po=mo,Z1=Al,Q1=Ar,r0=0,os=Cl.m,em=pe(os,1);if(s(po,0,0,t0),em){var tm=pe(os,1)+1,rm=pe(os,1),qd=pe(os,rm==0?1:8);po[qd]=1,tm==2&&(po[qd=pe(os,8)]=1);var El=1}else{var Vd=o(19),Gd=pe(os,4)+4;if(19<Gd){Cl.a=3;var Fl=0;break a}for(Tl=0;Tl<Gd;++Tl)Vd[C1[Tl]]=pe(os,3);var n0=void 0,xo=void 0,$d=Cl,nm=Vd,Ll=t0,Yd=po,a0=0,ls=$d.m,Xd=8,Kd=l(128,T);n:for(;k(Kd,0,7,nm,19);){if(pe(ls,1)){var am=2+2*pe(ls,3);if((n0=2+pe(ls,am))>Ll)break n}else n0=Ll;for(xo=0;xo<Ll&&n0--;){X(ls);var Jd=Kd[0+(127&O(ls))];R(ls,ls.u+Jd.g);var bi=Jd.value;if(16>bi)Yd[xo++]=bi,bi!=0&&(Xd=bi);else{var sm=bi==16,Zd=bi-16,im=k1[Zd],Qd=pe(ls,A1[Zd])+im;if(xo+Qd>Ll)break n;for(var om=sm?Xd:0;0<Qd--;)Yd[xo++]=om}}a0=1;break n}a0||($d.a=3),El=a0}(El=El&&!os.h)&&(r0=k(Z1,Q1,8,po,t0)),El&&r0!=0?Fl=r0:(Cl.a=3,Fl=0)}if(Fl==0)break r;if(kl&&T1[Tt]==1&&(kl=Al[Ar].g==0),Wd+=Al[Ar].g,Ar+=Fl,3>=Tt){var go,s0=mo[0];for(go=1;go<hr;++go)mo[go]>s0&&(s0=mo[go]);zd+=s0}}if(sa.nd=kl,sa.Qb=0,kl&&(sa.qb=(vi[3][yi[3]+0].value<<24|vi[1][yi[1]+0].value<<16|vi[2][yi[2]+0].value)>>>0,Wd==0&&256>vi[0][yi[0]+0].value&&(sa.Qb=1,sa.qb+=vi[0][yi[0]+0].value<<8)),sa.jc=!sa.Qb&&6>zd,sa.jc){var Pl,za=sa;for(Pl=0;Pl<zr;++Pl){var cs=Pl,ds=za.pd[cs],Ol=za.G[0][za.H[0]+cs];256<=Ol.value?(ds.g=Ol.g+256,ds.value=Ol.value):(ds.g=0,ds.value=0,cs>>=gr(Ol,8,ds),cs>>=gr(za.G[1][za.H[1]+cs],16,ds),cs>>=gr(za.G[2][za.H[2]+cs],0,ds),gr(za.G[3][za.H[3]+cs],24,ds))}}}Mr.vc=qr,Mr.Wb=fn,Mr.Ya=_l,Mr.yc=e0,er=1;break t}er=0}if(!(z=er)){F.a=3;break e}if(0<_e){if(re.ua=1<<_e,!$e(re.Wa,_e)){F.a=1,z=0;break e}}else re.ua=0;var i0=F,ef=V,lm=Y,o0=i0.s,l0=o0.xc;if(i0.c=ef,i0.i=lm,o0.md=Ze(ef,l0),o0.wc=l0==0?-1:(1<<l0)-1,S){F.xb=B1;break e}if((xe=o(V*Y))==null){F.a=1,z=0;break e}z=(z=ie(F,xe,0,V,Y,Y,null))&&!K.h;break e}return z?(B!=null?B[0]=xe:(r(xe==null),r(S)),F.$=0,S||Se(re)):Se(re),z}function ke(f,p){var S=f.c*f.i,F=S+p+16*p;return r(f.c<=p),f.V=o(F),f.V==null?(f.Ta=null,f.Ua=0,f.a=1,0):(f.Ta=f.V,f.Ua=f.Ba+S+p,1)}function Te(f,p){var S=f.C,F=p-S,B=f.V,z=f.Ba+f.c*S;for(r(p<=f.l.o);0<F;){var V=16<F?16:F,Y=f.l.ma,K=f.l.width,re=K*V,xe=Y.ca,_e=Y.tb+K*S,Ae=f.Ta,we=f.Ua;q(f,V,B,z),br(Ae,we,xe,_e,re),te(Y,S,S+V,xe,_e,K),F-=V,B+=V*f.c,S+=V}r(S==p),f.C=f.Ma=p}function qe(){this.ub=this.yd=this.td=this.Rb=0}function Xe(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function it(){this.Fb=this.Bb=this.Cb=0,this.Zb=o(4),this.Lb=o(4)}function Ge(){this.Yb=function(){var f=[];return function p(S,F,B){for(var z=B[F],V=0;V<z&&(S.push(B.length>F+1?[]:0),!(B.length<F+1));V++)p(S[V],F+1,B)}(f,0,[3,11]),f}()}function st(){this.jb=o(3),this.Wc=c([4,8],Ge),this.Xc=c([4,17],Ge)}function bt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new o(4),this.od=new o(4)}function zt(){this.ld=this.La=this.dd=this.tc=0}function Kt(){this.Na=this.la=0}function Sr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Qn(){this.ad=o(384),this.Za=0,this.Ob=o(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Oa(){this.uc=this.M=this.Nb=0,this.wa=Array(new zt),this.Y=0,this.ya=Array(new Qn),this.aa=0,this.l=new ba}function ya(){this.y=o(16),this.f=o(8),this.ea=o(8)}function ea(){this.cb=this.a=0,this.sc="",this.m=new be,this.Od=new qe,this.Kc=new Xe,this.ed=new bt,this.Qa=new it,this.Ic=this.$c=this.Aa=0,this.D=new Oa,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=l(8,be),this.ia=0,this.pb=l(4,Sr),this.Pa=new st,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new ya),this.Hd=0,this.rb=Array(new Kt),this.sb=0,this.wa=Array(new zt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Qn),this.L=this.aa=0,this.gd=c([4,2],zt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function ba(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Tn(){var f=new ea;return f!=null&&(f.a=0,f.sc="OK",f.cb=0,f.Xb=0,ho||(ho=Ko)),f}function vr(f,p,S){return f.a==0&&(f.a=p,f.sc=S,f.cb=0),0}function Yo(f,p,S){return 3<=S&&f[p+0]==157&&f[p+1]==1&&f[p+2]==42}function Xo(f,p){if(f==null)return 0;if(f.a=0,f.sc="OK",p==null)return vr(f,2,"null VP8Io passed to VP8GetHeaders()");var S=p.data,F=p.w,B=p.ha;if(4>B)return vr(f,7,"Truncated header.");var z=S[F+0]|S[F+1]<<8|S[F+2]<<16,V=f.Od;if(V.Rb=!(1&z),V.td=z>>1&7,V.yd=z>>4&1,V.ub=z>>5,3<V.td)return vr(f,3,"Incorrect keyframe parameters.");if(!V.yd)return vr(f,4,"Frame not displayable.");F+=3,B-=3;var Y=f.Kc;if(V.Rb){if(7>B)return vr(f,7,"cannot parse picture header");if(!Yo(S,F,B))return vr(f,3,"Bad code word");Y.c=16383&(S[F+4]<<8|S[F+3]),Y.Td=S[F+4]>>6,Y.i=16383&(S[F+6]<<8|S[F+5]),Y.Ud=S[F+6]>>6,F+=7,B-=7,f.za=Y.c+15>>4,f.Ub=Y.i+15>>4,p.width=Y.c,p.height=Y.i,p.Da=0,p.j=0,p.v=0,p.va=p.width,p.o=p.height,p.da=0,p.ib=p.width,p.hb=p.height,p.U=p.width,p.T=p.height,s((z=f.Pa).jb,0,255,z.jb.length),r((z=f.Qa)!=null),z.Cb=0,z.Bb=0,z.Fb=1,s(z.Zb,0,0,z.Zb.length),s(z.Lb,0,0,z.Lb)}if(V.ub>B)return vr(f,7,"bad partition length");de(z=f.m,S,F,V.ub),F+=V.ub,B-=V.ub,V.Rb&&(Y.Ld=he(z),Y.Kd=he(z)),Y=f.Qa;var K,re=f.Pa;if(r(z!=null),r(Y!=null),Y.Cb=he(z),Y.Cb){if(Y.Bb=he(z),he(z)){for(Y.Fb=he(z),K=0;4>K;++K)Y.Zb[K]=he(z)?Z(z,7):0;for(K=0;4>K;++K)Y.Lb[K]=he(z)?Z(z,6):0}if(Y.Bb)for(K=0;3>K;++K)re.jb[K]=he(z)?J(z,8):255}else Y.Bb=0;if(z.Ka)return vr(f,3,"cannot parse segment header");if((Y=f.ed).zd=he(z),Y.Tb=J(z,6),Y.wb=J(z,3),Y.Pc=he(z),Y.Pc&&he(z)){for(re=0;4>re;++re)he(z)&&(Y.vd[re]=Z(z,6));for(re=0;4>re;++re)he(z)&&(Y.od[re]=Z(z,6))}if(f.L=Y.Tb==0?0:Y.zd?1:2,z.Ka)return vr(f,3,"cannot parse filter header");var xe=B;if(B=K=F,F=K+xe,Y=xe,f.Xb=(1<<J(f.m,2))-1,xe<3*(re=f.Xb))S=7;else{for(K+=3*re,Y-=3*re,xe=0;xe<re;++xe){var _e=S[B+0]|S[B+1]<<8|S[B+2]<<16;_e>Y&&(_e=Y),de(f.Jc[+xe],S,K,_e),K+=_e,Y-=_e,B+=3}de(f.Jc[+re],S,K,Y),S=K<F?0:5}if(S!=0)return vr(f,S,"cannot parse partitions");for(S=J(K=f.m,7),B=he(K)?Z(K,4):0,F=he(K)?Z(K,4):0,Y=he(K)?Z(K,4):0,re=he(K)?Z(K,4):0,K=he(K)?Z(K,4):0,xe=f.Qa,_e=0;4>_e;++_e){if(xe.Cb){var Ae=xe.Zb[_e];xe.Fb||(Ae+=S)}else{if(0<_e){f.pb[_e]=f.pb[0];continue}Ae=S}var we=f.pb[_e];we.Sc[0]=Jc[Cn(Ae+B,127)],we.Sc[1]=Zc[Cn(Ae+0,127)],we.Eb[0]=2*Jc[Cn(Ae+F,127)],we.Eb[1]=101581*Zc[Cn(Ae+Y,127)]>>16,8>we.Eb[1]&&(we.Eb[1]=8),we.Qc[0]=Jc[Cn(Ae+re,117)],we.Qc[1]=Zc[Cn(Ae+K,127)],we.lc=Ae+K}if(!V.Rb)return vr(f,4,"Not a key frame.");for(he(z),V=f.Pa,S=0;4>S;++S){for(B=0;8>B;++B)for(F=0;3>F;++F)for(Y=0;11>Y;++Y)re=ee(z,R1[S][B][F][Y])?J(z,8):I1[S][B][F][Y],V.Wc[S][B].Yb[F][Y]=re;for(B=0;17>B;++B)V.Xc[S][B]=V.Wc[S][M1[B]]}return f.kc=he(z),f.kc&&(f.Bd=J(z,8)),f.cb=1}function Ko(f,p,S,F,B,z,V){var Y=p[B].Yb[S];for(S=0;16>B;++B){if(!ee(f,Y[S+0]))return B;for(;!ee(f,Y[S+1]);)if(Y=p[++B].Yb[0],S=0,B==16)return 16;var K=p[B+1].Yb;if(ee(f,Y[S+2])){var re=f,xe=0;if(ee(re,(Ae=Y)[(_e=S)+3]))if(ee(re,Ae[_e+6])){for(Y=0,_e=2*(xe=ee(re,Ae[_e+8]))+(Ae=ee(re,Ae[_e+9+xe])),xe=0,Ae=P1[_e];Ae[Y];++Y)xe+=xe+ee(re,Ae[Y]);xe+=3+(8<<_e)}else ee(re,Ae[_e+7])?(xe=7+2*ee(re,165),xe+=ee(re,145)):xe=5+ee(re,159);else xe=ee(re,Ae[_e+4])?3+ee(re,Ae[_e+5]):2;Y=K[2]}else xe=1,Y=K[1];K=V+O1[B],0>(re=f).b&&fe(re);var _e,Ae=re.b,we=(_e=re.Ca>>1)-(re.I>>Ae)>>31;--re.b,re.Ca+=we,re.Ca|=1,re.I-=(_e+1&we)<<Ae,z[K]=((xe^we)-we)*F[(0<B)+0]}return 16}function Wi(f){var p=f.rb[f.sb-1];p.la=0,p.Na=0,s(f.zc,0,0,f.zc.length),f.ja=0}function kc(f,p){if(f==null)return 0;if(p==null)return vr(f,2,"NULL VP8Io parameter in VP8Decode().");if(!f.cb&&!Xo(f,p))return 0;if(r(f.cb),p.ac==null||p.ac(p)){p.ob&&(f.L=0);var S=Sl[f.L];if(f.L==2?(f.yb=0,f.zb=0):(f.yb=p.v-S>>4,f.zb=p.j-S>>4,0>f.yb&&(f.yb=0),0>f.zb&&(f.zb=0)),f.Va=p.o+15+S>>4,f.Hb=p.va+15+S>>4,f.Hb>f.za&&(f.Hb=f.za),f.Va>f.Ub&&(f.Va=f.Ub),0<f.L){var F=f.ed;for(S=0;4>S;++S){var B;if(f.Qa.Cb){var z=f.Qa.Lb[S];f.Qa.Fb||(z+=F.Tb)}else z=F.Tb;for(B=0;1>=B;++B){var V=f.gd[S][B],Y=z;if(F.Pc&&(Y+=F.vd[0],B&&(Y+=F.od[0])),0<(Y=0>Y?0:63<Y?63:Y)){var K=Y;0<F.wb&&(K=4<F.wb?K>>2:K>>1)>9-F.wb&&(K=9-F.wb),1>K&&(K=1),V.dd=K,V.tc=2*Y+K,V.ld=40<=Y?2:15<=Y?1:0}else V.tc=0;V.La=B}}}S=0}else vr(f,6,"Frame setup failed"),S=f.a;if(S=S==0){if(S){f.$c=0,0<f.Aa||(f.Ic=J1);e:{S=f.Ic,F=4*(K=f.za);var re=32*K,xe=K+1,_e=0<f.L?K*(0<f.Aa?2:1):0,Ae=(f.Aa==2?2:1)*K;if((V=F+832+(B=3*(16*S+Sl[f.L])/2*re)+(z=f.Fa!=null&&0<f.Fa.length?f.Kc.c*f.Kc.i:0))!=V)S=0;else{if(V>f.Vb){if(f.Vb=0,f.Ec=o(V),f.Fc=0,f.Ec==null){S=vr(f,1,"no memory during frame initialization.");break e}f.Vb=V}V=f.Ec,Y=f.Fc,f.Ac=V,f.Bc=Y,Y+=F,f.Gd=l(re,ya),f.Hd=0,f.rb=l(xe+1,Kt),f.sb=1,f.wa=_e?l(_e,zt):null,f.Y=0,f.D.Nb=0,f.D.wa=f.wa,f.D.Y=f.Y,0<f.Aa&&(f.D.Y+=K),r(!0),f.oc=V,f.pc=Y,Y+=832,f.ya=l(Ae,Qn),f.aa=0,f.D.ya=f.ya,f.D.aa=f.aa,f.Aa==2&&(f.D.aa+=K),f.R=16*K,f.B=8*K,K=(re=Sl[f.L])*f.R,re=re/2*f.B,f.sa=V,f.ta=Y+K,f.qa=f.sa,f.ra=f.ta+16*S*f.R+re,f.Ha=f.qa,f.Ia=f.ra+8*S*f.B+re,f.$c=0,Y+=B,f.mb=z?V:null,f.nb=z?Y:null,r(Y+z<=f.Fc+f.Vb),Wi(f),s(f.Ac,f.Bc,0,F),S=1}}if(S){if(p.ka=0,p.y=f.sa,p.O=f.ta,p.f=f.qa,p.N=f.ra,p.ea=f.Ha,p.Vd=f.Ia,p.fa=f.R,p.Rc=f.B,p.F=null,p.J=0,!pl){for(S=-255;255>=S;++S)Pr[255+S]=0>S?-S:S;for(S=-1020;1020>=S;++S)Ua[1020+S]=-128>S?-128:127<S?127:S;for(S=-112;112>=S;++S)fo[112+S]=-16>S?-16:15<S?15:S;for(S=-255;510>=S;++S)xi[255+S]=0>S?0:255<S?255:S;pl=1}ui=Ec,Ba=Tc,oo=Zo,dn=Cc,zn=Qo,yr=Jo,mi=Yi,ml=Ts,lo=zc,Fs=Xi,Ls=Wc,rs=ai,Ps=Ki,pi=ll,Os=ol,ns=Na,co=Da,qn=Hc,aa[0]=wa,aa[1]=Fc,aa[2]=Ic,aa[3]=Dc,aa[4]=rl,aa[5]=ri,aa[6]=nl,aa[7]=Vi,aa[8]=Mc,aa[9]=Rc,as[0]=el,as[1]=Pc,as[2]=Ia,as[3]=ei,as[4]=Qr,as[5]=Oc,as[6]=tl,Ha[0]=Ja,Ha[1]=Lc,Ha[2]=Bc,Ha[3]=Gi,Ha[4]=ks,Ha[5]=Uc,Ha[6]=$i,S=1}else S=0}S&&(S=function(we,Me){for(we.M=0;we.M<we.Va;++we.M){var Le,ge=we.Jc[we.M&we.Xb],ye=we.m,De=we;for(Le=0;Le<De.za;++Le){var He=ye,Re=De,lt=Re.Ac,et=Re.Bc+4*Le,pt=Re.zc,rt=Re.ya[Re.aa+Le];if(Re.Qa.Bb?rt.$b=ee(He,Re.Pa.jb[0])?2+ee(He,Re.Pa.jb[2]):ee(He,Re.Pa.jb[1]):rt.$b=0,Re.kc&&(rt.Ad=ee(He,Re.Bd)),rt.Za=!ee(He,145)+0,rt.Za){var Ut=rt.Ob,qt=0;for(Re=0;4>Re;++Re){var Rt,Pt=pt[0+Re];for(Rt=0;4>Rt;++Rt){Pt=D1[lt[et+Rt]][Pt];for(var er=Fd[ee(He,Pt[0])];0<er;)er=Fd[2*er+ee(He,Pt[er])];Pt=-er,lt[et+Rt]=Pt}n(Ut,qt,lt,et,4),qt+=4,pt[0+Re]=Pt}}else Pt=ee(He,156)?ee(He,128)?1:3:ee(He,163)?2:0,rt.Ob[0]=Pt,s(lt,et,Pt,4),s(pt,0,Pt,4);rt.Dd=ee(He,142)?ee(He,114)?ee(He,183)?1:3:2:0}if(De.m.Ka)return vr(we,7,"Premature end-of-partition0 encountered.");for(;we.ja<we.za;++we.ja){if(De=ge,He=(ye=we).rb[ye.sb-1],lt=ye.rb[ye.sb+ye.ja],Le=ye.ya[ye.aa+ye.ja],et=ye.kc?Le.Ad:0)He.la=lt.la=0,Le.Za||(He.Na=lt.Na=0),Le.Hc=0,Le.Gc=0,Le.ia=0;else{var Jt,Tt;if(He=lt,lt=De,et=ye.Pa.Xc,pt=ye.ya[ye.aa+ye.ja],rt=ye.pb[pt.$b],Re=pt.ad,Ut=0,qt=ye.rb[ye.sb-1],Pt=Rt=0,s(Re,Ut,0,384),pt.Za)var Ar=0,bn=et[3];else{er=o(16);var kr=He.Na+qt.Na;if(kr=ho(lt,et[1],kr,rt.Eb,0,er,0),He.Na=qt.Na=(0<kr)+0,1<kr)ui(er,0,Re,Ut);else{var wn=er[0]+3>>3;for(er=0;256>er;er+=16)Re[Ut+er]=wn}Ar=1,bn=et[0]}var Vt=15&He.la,Fn=15&qt.la;for(er=0;4>er;++er){var Ln=1&Fn;for(wn=Tt=0;4>wn;++wn)Vt=Vt>>1|(Ln=(kr=ho(lt,bn,kr=Ln+(1&Vt),rt.Sc,Ar,Re,Ut))>Ar)<<7,Tt=Tt<<2|(3<kr?3:1<kr?2:Re[Ut+0]!=0),Ut+=16;Vt>>=4,Fn=Fn>>1|Ln<<7,Rt=(Rt<<8|Tt)>>>0}for(bn=Vt,Ar=Fn>>4,Jt=0;4>Jt;Jt+=2){for(Tt=0,Vt=He.la>>4+Jt,Fn=qt.la>>4+Jt,er=0;2>er;++er){for(Ln=1&Fn,wn=0;2>wn;++wn)kr=Ln+(1&Vt),Vt=Vt>>1|(Ln=0<(kr=ho(lt,et[2],kr,rt.Qc,0,Re,Ut)))<<3,Tt=Tt<<2|(3<kr?3:1<kr?2:Re[Ut+0]!=0),Ut+=16;Vt>>=2,Fn=Fn>>1|Ln<<5}Pt|=Tt<<4*Jt,bn|=Vt<<4<<Jt,Ar|=(240&Fn)<<Jt}He.la=bn,qt.la=Ar,pt.Hc=Rt,pt.Gc=Pt,pt.ia=43690&Pt?0:rt.ia,et=!(Rt|Pt)}if(0<ye.L&&(ye.wa[ye.Y+ye.ja]=ye.gd[Le.$b][Le.Za],ye.wa[ye.Y+ye.ja].La|=!et),De.Ka)return vr(we,7,"Premature end-of-file encountered.")}if(Wi(we),ye=Me,De=1,Le=(ge=we).D,He=0<ge.L&&ge.M>=ge.zb&&ge.M<=ge.Va,ge.Aa==0)e:{if(Le.M=ge.M,Le.uc=He,ro(ge,Le),De=1,Le=(Tt=ge.D).Nb,He=(Pt=Sl[ge.L])*ge.R,lt=Pt/2*ge.B,er=16*Le*ge.R,wn=8*Le*ge.B,et=ge.sa,pt=ge.ta-He+er,rt=ge.qa,Re=ge.ra-lt+wn,Ut=ge.Ha,qt=ge.Ia-lt+wn,Fn=(Vt=Tt.M)==0,Rt=Vt>=ge.Va-1,ge.Aa==2&&ro(ge,Tt),Tt.uc)for(Ln=(kr=ge).D.M,r(kr.D.uc),Tt=kr.yb;Tt<kr.Hb;++Tt){Ar=Tt,bn=Ln;var Mr=(qr=(hr=kr).D).Nb;Jt=hr.R;var qr=qr.wa[qr.Y+Ar],fn=hr.sa,Yn=hr.ta+16*Mr*Jt+16*Ar,Sa=qr.dd,Br=qr.tc;if(Br!=0)if(r(3<=Br),hr.L==1)0<Ar&&ns(fn,Yn,Jt,Br+4),qr.La&&qn(fn,Yn,Jt,Br),0<bn&&Os(fn,Yn,Jt,Br+4),qr.La&&co(fn,Yn,Jt,Br);else{var Wa=hr.B,Is=hr.qa,gi=hr.ra+8*Mr*Wa+8*Ar,is=hr.Ha,hr=hr.Ia+8*Mr*Wa+8*Ar;Mr=qr.ld,0<Ar&&(ml(fn,Yn,Jt,Br+4,Sa,Mr),Fs(Is,gi,is,hr,Wa,Br+4,Sa,Mr)),qr.La&&(rs(fn,Yn,Jt,Br,Sa,Mr),pi(Is,gi,is,hr,Wa,Br,Sa,Mr)),0<bn&&(mi(fn,Yn,Jt,Br+4,Sa,Mr),lo(Is,gi,is,hr,Wa,Br+4,Sa,Mr)),qr.La&&(Ls(fn,Yn,Jt,Br,Sa,Mr),Ps(Is,gi,is,hr,Wa,Br,Sa,Mr))}}if(ge.ia&&alert("todo:DitherRow"),ye.put!=null){if(Tt=16*Vt,Vt=16*(Vt+1),Fn?(ye.y=ge.sa,ye.O=ge.ta+er,ye.f=ge.qa,ye.N=ge.ra+wn,ye.ea=ge.Ha,ye.W=ge.Ia+wn):(Tt-=Pt,ye.y=et,ye.O=pt,ye.f=rt,ye.N=Re,ye.ea=Ut,ye.W=qt),Rt||(Vt-=Pt),Vt>ye.o&&(Vt=ye.o),ye.F=null,ye.J=null,ge.Fa!=null&&0<ge.Fa.length&&Tt<Vt&&(ye.J=eo(ge,ye,Tt,Vt-Tt),ye.F=ge.mb,ye.F==null&&ye.F.length==0)){De=vr(ge,3,"Could not decode alpha data.");break e}Tt<ye.j&&(Pt=ye.j-Tt,Tt=ye.j,r(!(1&Pt)),ye.O+=ge.R*Pt,ye.N+=ge.B*(Pt>>1),ye.W+=ge.B*(Pt>>1),ye.F!=null&&(ye.J+=ye.width*Pt)),Tt<Vt&&(ye.O+=ye.v,ye.N+=ye.v>>1,ye.W+=ye.v>>1,ye.F!=null&&(ye.J+=ye.v),ye.ka=Tt-ye.j,ye.U=ye.va-ye.v,ye.T=Vt-Tt,De=ye.put(ye))}Le+1!=ge.Ic||Rt||(n(ge.sa,ge.ta-He,et,pt+16*ge.R,He),n(ge.qa,ge.ra-lt,rt,Re+8*ge.B,lt),n(ge.Ha,ge.Ia-lt,Ut,qt+8*ge.B,lt))}if(!De)return vr(we,6,"Output aborted.")}return 1}(f,p)),p.bc!=null&&p.bc(p),S&=1}return S?(f.cb=0,S):0}function ta(f,p,S,F,B){B=f[p+S+32*F]+(B>>3),f[p+S+32*F]=-256&B?0>B?0:255:B}function Qs(f,p,S,F,B,z){ta(f,p,0,S,F+B),ta(f,p,1,S,F+z),ta(f,p,2,S,F-z),ta(f,p,3,S,F-B)}function gn(f){return(20091*f>>16)+f}function zi(f,p,S,F){var B,z=0,V=o(16);for(B=0;4>B;++B){var Y=f[p+0]+f[p+8],K=f[p+0]-f[p+8],re=(35468*f[p+4]>>16)-gn(f[p+12]),xe=gn(f[p+4])+(35468*f[p+12]>>16);V[z+0]=Y+xe,V[z+1]=K+re,V[z+2]=K-re,V[z+3]=Y-xe,z+=4,p++}for(B=z=0;4>B;++B)Y=(f=V[z+0]+4)+V[z+8],K=f-V[z+8],re=(35468*V[z+4]>>16)-gn(V[z+12]),ta(S,F,0,0,Y+(xe=gn(V[z+4])+(35468*V[z+12]>>16))),ta(S,F,1,0,K+re),ta(S,F,2,0,K-re),ta(S,F,3,0,Y-xe),z++,F+=32}function Jo(f,p,S,F){var B=f[p+0]+4,z=35468*f[p+4]>>16,V=gn(f[p+4]),Y=35468*f[p+1]>>16;Qs(S,F,0,B+V,f=gn(f[p+1]),Y),Qs(S,F,1,B+z,f,Y),Qs(S,F,2,B-z,f,Y),Qs(S,F,3,B-V,f,Y)}function Tc(f,p,S,F,B){zi(f,p,S,F),B&&zi(f,p+16,S,F+4)}function Zo(f,p,S,F){Ba(f,p+0,S,F,1),Ba(f,p+32,S,F+128,1)}function Cc(f,p,S,F){var B;for(f=f[p+0]+4,B=0;4>B;++B)for(p=0;4>p;++p)ta(S,F,p,B,f)}function Qo(f,p,S,F){f[p+0]&&dn(f,p+0,S,F),f[p+16]&&dn(f,p+16,S,F+4),f[p+32]&&dn(f,p+32,S,F+128),f[p+48]&&dn(f,p+48,S,F+128+4)}function Ec(f,p,S,F){var B,z=o(16);for(B=0;4>B;++B){var V=f[p+0+B]+f[p+12+B],Y=f[p+4+B]+f[p+8+B],K=f[p+4+B]-f[p+8+B],re=f[p+0+B]-f[p+12+B];z[0+B]=V+Y,z[8+B]=V-Y,z[4+B]=re+K,z[12+B]=re-K}for(B=0;4>B;++B)V=(f=z[0+4*B]+3)+z[3+4*B],Y=z[1+4*B]+z[2+4*B],K=z[1+4*B]-z[2+4*B],re=f-z[3+4*B],S[F+0]=V+Y>>3,S[F+16]=re+K>>3,S[F+32]=V-Y>>3,S[F+48]=re-K>>3,F+=64}function qi(f,p,S){var F,B=p-32,z=En,V=255-f[B-1];for(F=0;F<S;++F){var Y,K=z,re=V+f[p-1];for(Y=0;Y<S;++Y)f[p+Y]=K[re+f[B+Y]];p+=32}}function Fc(f,p){qi(f,p,4)}function Lc(f,p){qi(f,p,8)}function Pc(f,p){qi(f,p,16)}function Ia(f,p){var S;for(S=0;16>S;++S)n(f,p+32*S,f,p-32,16)}function ei(f,p){var S;for(S=16;0<S;--S)s(f,p,f[p-1],16),p+=32}function ti(f,p,S){var F;for(F=0;16>F;++F)s(p,S+32*F,f,16)}function el(f,p){var S,F=16;for(S=0;16>S;++S)F+=f[p-1+32*S]+f[p+S-32];ti(F>>5,f,p)}function Qr(f,p){var S,F=8;for(S=0;16>S;++S)F+=f[p-1+32*S];ti(F>>4,f,p)}function Oc(f,p){var S,F=8;for(S=0;16>S;++S)F+=f[p+S-32];ti(F>>4,f,p)}function tl(f,p){ti(128,f,p)}function jt(f,p,S){return f+2*p+S+2>>2}function Ic(f,p){var S,F=p-32;for(F=new Uint8Array([jt(f[F-1],f[F+0],f[F+1]),jt(f[F+0],f[F+1],f[F+2]),jt(f[F+1],f[F+2],f[F+3]),jt(f[F+2],f[F+3],f[F+4])]),S=0;4>S;++S)n(f,p+32*S,F,0,F.length)}function Dc(f,p){var S=f[p-1],F=f[p-1+32],B=f[p-1+64],z=f[p-1+96];ve(f,p+0,16843009*jt(f[p-1-32],S,F)),ve(f,p+32,16843009*jt(S,F,B)),ve(f,p+64,16843009*jt(F,B,z)),ve(f,p+96,16843009*jt(B,z,z))}function wa(f,p){var S,F=4;for(S=0;4>S;++S)F+=f[p+S-32]+f[p-1+32*S];for(F>>=3,S=0;4>S;++S)s(f,p+32*S,F,4)}function rl(f,p){var S=f[p-1+0],F=f[p-1+32],B=f[p-1+64],z=f[p-1-32],V=f[p+0-32],Y=f[p+1-32],K=f[p+2-32],re=f[p+3-32];f[p+0+96]=jt(F,B,f[p-1+96]),f[p+1+96]=f[p+0+64]=jt(S,F,B),f[p+2+96]=f[p+1+64]=f[p+0+32]=jt(z,S,F),f[p+3+96]=f[p+2+64]=f[p+1+32]=f[p+0+0]=jt(V,z,S),f[p+3+64]=f[p+2+32]=f[p+1+0]=jt(Y,V,z),f[p+3+32]=f[p+2+0]=jt(K,Y,V),f[p+3+0]=jt(re,K,Y)}function nl(f,p){var S=f[p+1-32],F=f[p+2-32],B=f[p+3-32],z=f[p+4-32],V=f[p+5-32],Y=f[p+6-32],K=f[p+7-32];f[p+0+0]=jt(f[p+0-32],S,F),f[p+1+0]=f[p+0+32]=jt(S,F,B),f[p+2+0]=f[p+1+32]=f[p+0+64]=jt(F,B,z),f[p+3+0]=f[p+2+32]=f[p+1+64]=f[p+0+96]=jt(B,z,V),f[p+3+32]=f[p+2+64]=f[p+1+96]=jt(z,V,Y),f[p+3+64]=f[p+2+96]=jt(V,Y,K),f[p+3+96]=jt(Y,K,K)}function ri(f,p){var S=f[p-1+0],F=f[p-1+32],B=f[p-1+64],z=f[p-1-32],V=f[p+0-32],Y=f[p+1-32],K=f[p+2-32],re=f[p+3-32];f[p+0+0]=f[p+1+64]=z+V+1>>1,f[p+1+0]=f[p+2+64]=V+Y+1>>1,f[p+2+0]=f[p+3+64]=Y+K+1>>1,f[p+3+0]=K+re+1>>1,f[p+0+96]=jt(B,F,S),f[p+0+64]=jt(F,S,z),f[p+0+32]=f[p+1+96]=jt(S,z,V),f[p+1+32]=f[p+2+96]=jt(z,V,Y),f[p+2+32]=f[p+3+96]=jt(V,Y,K),f[p+3+32]=jt(Y,K,re)}function Vi(f,p){var S=f[p+0-32],F=f[p+1-32],B=f[p+2-32],z=f[p+3-32],V=f[p+4-32],Y=f[p+5-32],K=f[p+6-32],re=f[p+7-32];f[p+0+0]=S+F+1>>1,f[p+1+0]=f[p+0+64]=F+B+1>>1,f[p+2+0]=f[p+1+64]=B+z+1>>1,f[p+3+0]=f[p+2+64]=z+V+1>>1,f[p+0+32]=jt(S,F,B),f[p+1+32]=f[p+0+96]=jt(F,B,z),f[p+2+32]=f[p+1+96]=jt(B,z,V),f[p+3+32]=f[p+2+96]=jt(z,V,Y),f[p+3+64]=jt(V,Y,K),f[p+3+96]=jt(Y,K,re)}function Rc(f,p){var S=f[p-1+0],F=f[p-1+32],B=f[p-1+64],z=f[p-1+96];f[p+0+0]=S+F+1>>1,f[p+2+0]=f[p+0+32]=F+B+1>>1,f[p+2+32]=f[p+0+64]=B+z+1>>1,f[p+1+0]=jt(S,F,B),f[p+3+0]=f[p+1+32]=jt(F,B,z),f[p+3+32]=f[p+1+64]=jt(B,z,z),f[p+3+64]=f[p+2+64]=f[p+0+96]=f[p+1+96]=f[p+2+96]=f[p+3+96]=z}function Mc(f,p){var S=f[p-1+0],F=f[p-1+32],B=f[p-1+64],z=f[p-1+96],V=f[p-1-32],Y=f[p+0-32],K=f[p+1-32],re=f[p+2-32];f[p+0+0]=f[p+2+32]=S+V+1>>1,f[p+0+32]=f[p+2+64]=F+S+1>>1,f[p+0+64]=f[p+2+96]=B+F+1>>1,f[p+0+96]=z+B+1>>1,f[p+3+0]=jt(Y,K,re),f[p+2+0]=jt(V,Y,K),f[p+1+0]=f[p+3+32]=jt(S,V,Y),f[p+1+32]=f[p+3+64]=jt(F,S,V),f[p+1+64]=f[p+3+96]=jt(B,F,S),f[p+1+96]=jt(z,B,F)}function Bc(f,p){var S;for(S=0;8>S;++S)n(f,p+32*S,f,p-32,8)}function Gi(f,p){var S;for(S=0;8>S;++S)s(f,p,f[p-1],8),p+=32}function As(f,p,S){var F;for(F=0;8>F;++F)s(p,S+32*F,f,8)}function Ja(f,p){var S,F=8;for(S=0;8>S;++S)F+=f[p+S-32]+f[p-1+32*S];As(F>>4,f,p)}function Uc(f,p){var S,F=4;for(S=0;8>S;++S)F+=f[p+S-32];As(F>>3,f,p)}function ks(f,p){var S,F=4;for(S=0;8>S;++S)F+=f[p-1+32*S];As(F>>3,f,p)}function $i(f,p){As(128,f,p)}function ni(f,p,S){var F=f[p-S],B=f[p+0],z=3*(B-F)+Gc[1020+f[p-2*S]-f[p+S]],V=xl[112+(z+4>>3)];f[p-S]=En[255+F+xl[112+(z+3>>3)]],f[p+0]=En[255+B-V]}function al(f,p,S,F){var B=f[p+0],z=f[p+S];return Gn[255+f[p-2*S]-f[p-S]]>F||Gn[255+z-B]>F}function sl(f,p,S,F){return 4*Gn[255+f[p-S]-f[p+0]]+Gn[255+f[p-2*S]-f[p+S]]<=F}function il(f,p,S,F,B){var z=f[p-3*S],V=f[p-2*S],Y=f[p-S],K=f[p+0],re=f[p+S],xe=f[p+2*S],_e=f[p+3*S];return 4*Gn[255+Y-K]+Gn[255+V-re]>F?0:Gn[255+f[p-4*S]-z]<=B&&Gn[255+z-V]<=B&&Gn[255+V-Y]<=B&&Gn[255+_e-xe]<=B&&Gn[255+xe-re]<=B&&Gn[255+re-K]<=B}function ol(f,p,S,F){var B=2*F+1;for(F=0;16>F;++F)sl(f,p+F,S,B)&&ni(f,p+F,S)}function Na(f,p,S,F){var B=2*F+1;for(F=0;16>F;++F)sl(f,p+F*S,1,B)&&ni(f,p+F*S,1)}function Da(f,p,S,F){var B;for(B=3;0<B;--B)ol(f,p+=4*S,S,F)}function Hc(f,p,S,F){var B;for(B=3;0<B;--B)Na(f,p+=4,S,F)}function Za(f,p,S,F,B,z,V,Y){for(z=2*z+1;0<B--;){if(il(f,p,S,z,V))if(al(f,p,S,Y))ni(f,p,S);else{var K=f,re=p,xe=S,_e=K[re-2*xe],Ae=K[re-xe],we=K[re+0],Me=K[re+xe],Le=K[re+2*xe],ge=27*(De=Gc[1020+3*(we-Ae)+Gc[1020+_e-Me]])+63>>7,ye=18*De+63>>7,De=9*De+63>>7;K[re-3*xe]=En[255+K[re-3*xe]+De],K[re-2*xe]=En[255+_e+ye],K[re-xe]=En[255+Ae+ge],K[re+0]=En[255+we-ge],K[re+xe]=En[255+Me-ye],K[re+2*xe]=En[255+Le-De]}p+=F}}function ra(f,p,S,F,B,z,V,Y){for(z=2*z+1;0<B--;){if(il(f,p,S,z,V))if(al(f,p,S,Y))ni(f,p,S);else{var K=f,re=p,xe=S,_e=K[re-xe],Ae=K[re+0],we=K[re+xe],Me=xl[112+((Le=3*(Ae-_e))+4>>3)],Le=xl[112+(Le+3>>3)],ge=Me+1>>1;K[re-2*xe]=En[255+K[re-2*xe]+ge],K[re-xe]=En[255+_e+Le],K[re+0]=En[255+Ae-Me],K[re+xe]=En[255+we-ge]}p+=F}}function Yi(f,p,S,F,B,z){Za(f,p,S,1,16,F,B,z)}function Ts(f,p,S,F,B,z){Za(f,p,1,S,16,F,B,z)}function Wc(f,p,S,F,B,z){var V;for(V=3;0<V;--V)ra(f,p+=4*S,S,1,16,F,B,z)}function ai(f,p,S,F,B,z){var V;for(V=3;0<V;--V)ra(f,p+=4,1,S,16,F,B,z)}function zc(f,p,S,F,B,z,V,Y){Za(f,p,B,1,8,z,V,Y),Za(S,F,B,1,8,z,V,Y)}function Xi(f,p,S,F,B,z,V,Y){Za(f,p,1,B,8,z,V,Y),Za(S,F,1,B,8,z,V,Y)}function Ki(f,p,S,F,B,z,V,Y){ra(f,p+4*B,B,1,8,z,V,Y),ra(S,F+4*B,B,1,8,z,V,Y)}function ll(f,p,S,F,B,z,V,Y){ra(f,p+4,1,B,8,z,V,Y),ra(S,F+4,1,B,8,z,V,Y)}function si(){this.ba=new An,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Qt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Ji(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Zi(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function cl(){this.ua=0,this.Wa=new le,this.vb=new le,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new G,this.yc=new T}function qc(){this.xb=this.a=0,this.l=new ba,this.ca=new An,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new A,this.Pb=0,this.wd=new A,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new cl,this.ab=0,this.gc=l(4,Zi),this.Oc=0}function ii(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new ba,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Cs(f,p,S,F,B,z,V){for(f=f==null?0:f[p+0],p=0;p<V;++p)B[z+p]=f+S[F+p]&255,f=B[z+p]}function Qi(f,p,S,F,B,z,V){var Y;if(f==null)Cs(null,null,S,F,B,z,V);else for(Y=0;Y<V;++Y)B[z+Y]=f[p+Y]+S[F+Y]&255}function Qa(f,p,S,F,B,z,V){if(f==null)Cs(null,null,S,F,B,z,V);else{var Y,K=f[p+0],re=K,xe=K;for(Y=0;Y<V;++Y)re=xe+(K=f[p+Y])-re,xe=S[F+Y]+(-256&re?0>re?0:255:re)&255,re=K,B[z+Y]=xe}}function eo(f,p,S,F){var B=p.width,z=p.o;if(r(f!=null&&p!=null),0>S||0>=F||S+F>z)return null;if(!f.Cc){if(f.ga==null){var V;if(f.ga=new ii,(V=f.ga==null)||(V=p.width*p.o,r(f.Gb.length==0),f.Gb=o(V),f.Uc=0,f.Gb==null?V=0:(f.mb=f.Gb,f.nb=f.Uc,f.rc=null,V=1),V=!V),!V){V=f.ga;var Y=f.Fa,K=f.P,re=f.qc,xe=f.mb,_e=f.nb,Ae=K+1,we=re-1,Me=V.l;if(r(Y!=null&&xe!=null&&p!=null),ss[0]=null,ss[1]=Cs,ss[2]=Qi,ss[3]=Qa,V.ca=xe,V.tb=_e,V.c=p.width,V.i=p.height,r(0<V.c&&0<V.i),1>=re)p=0;else if(V.$a=Y[K+0]>>0&3,V.Z=Y[K+0]>>2&3,V.Lc=Y[K+0]>>4&3,K=Y[K+0]>>6&3,0>V.$a||1<V.$a||4<=V.Z||1<V.Lc||K)p=0;else if(Me.put=Un,Me.ac=Lr,Me.bc=Hn,Me.ma=V,Me.width=p.width,Me.height=p.height,Me.Da=p.Da,Me.v=p.v,Me.va=p.va,Me.j=p.j,Me.o=p.o,V.$a)e:{r(V.$a==1),p=Fe();t:for(;;){if(p==null){p=0;break e}if(r(V!=null),V.mc=p,p.c=V.c,p.i=V.i,p.l=V.l,p.l.ma=V,p.l.width=V.c,p.l.height=V.i,p.a=0,oe(p.m,Y,Ae,we),!je(V.c,V.i,1,p,null)||(p.ab==1&&p.gc[0].hc==3&&Q(p.s)?(V.ic=1,Y=p.c*p.i,p.Ta=null,p.Ua=0,p.V=o(Y),p.Ba=0,p.V==null?(p.a=1,p=0):p=1):(V.ic=0,p=ke(p,V.c)),!p))break t;p=1;break e}V.mc=null,p=0}else p=we>=V.c*V.i;V=!p}if(V)return null;f.ga.Lc!=1?f.Ga=0:F=z-S}r(f.ga!=null),r(S+F<=z);e:{if(p=(Y=f.ga).c,z=Y.l.o,Y.$a==0){if(Ae=f.rc,we=f.Vc,Me=f.Fa,K=f.P+1+S*p,re=f.mb,xe=f.nb+S*p,r(K<=f.P+f.qc),Y.Z!=0)for(r(ss[Y.Z]!=null),V=0;V<F;++V)ss[Y.Z](Ae,we,Me,K,re,xe,p),Ae=re,we=xe,xe+=p,K+=p;else for(V=0;V<F;++V)n(re,xe,Me,K,p),Ae=re,we=xe,xe+=p,K+=p;f.rc=Ae,f.Vc=we}else{if(r(Y.mc!=null),p=S+F,r((V=Y.mc)!=null),r(p<=V.i),V.C>=p)p=1;else if(Y.ic||Ne(),Y.ic){Y=V.V,Ae=V.Ba,we=V.c;var Le=V.i,ge=(Me=1,K=V.$/we,re=V.$%we,xe=V.m,_e=V.s,V.$),ye=we*Le,De=we*p,He=_e.wc,Re=ge<De?dr(_e,re,K):null;r(ge<=ye),r(p<=Le),r(Q(_e));t:for(;;){for(;!xe.h&&ge<De;){if(re&He||(Re=dr(_e,re,K)),r(Re!=null),X(xe),256>(Le=Zr(Re.G[0],Re.H[0],xe)))Y[Ae+ge]=Le,++ge,++re>=we&&(re=0,++K<=p&&!(K%16)&&ne(V,K));else{if(!(280>Le)){Me=0;break t}Le=kn(Le-256,xe);var lt,et=Zr(Re.G[4],Re.H[4],xe);if(X(xe),!(ge>=(et=xn(we,et=kn(et,xe)))&&ye-ge>=Le)){Me=0;break t}for(lt=0;lt<Le;++lt)Y[Ae+ge+lt]=Y[Ae+ge+lt-et];for(ge+=Le,re+=Le;re>=we;)re-=we,++K<=p&&!(K%16)&&ne(V,K);ge<De&&re&He&&(Re=dr(_e,re,K))}r(xe.h==I(xe))}ne(V,K>p?p:K);break t}!Me||xe.h&&ge<ye?(Me=0,V.a=xe.h?5:3):V.$=ge,p=Me}else p=ie(V,V.V,V.Ba,V.c,V.i,p,Te);if(!p){F=0;break e}}S+F>=z&&(f.Cc=1),F=1}if(!F)return null;if(f.Cc&&((F=f.ga)!=null&&(F.mc=null),f.ga=null,0<f.Ga))return alert("todo:WebPDequantizeLevels"),null}return f.nb+S*B}function b(f,p,S,F,B,z){for(;0<B--;){var V,Y=f,K=p+(S?1:0),re=f,xe=p+(S?0:3);for(V=0;V<F;++V){var _e=re[xe+4*V];_e!=255&&(_e*=32897,Y[K+4*V+0]=Y[K+4*V+0]*_e>>23,Y[K+4*V+1]=Y[K+4*V+1]*_e>>23,Y[K+4*V+2]=Y[K+4*V+2]*_e>>23)}p+=z}}function U(f,p,S,F,B){for(;0<F--;){var z;for(z=0;z<S;++z){var V=f[p+2*z+0],Y=15&(re=f[p+2*z+1]),K=4369*Y,re=(240&re|re>>4)*K>>16;f[p+2*z+0]=(240&V|V>>4)*K>>16&240|(15&V|V<<4)*K>>16>>4&15,f[p+2*z+1]=240&re|Y}p+=B}}function ce(f,p,S,F,B,z,V,Y){var K,re,xe=255;for(re=0;re<B;++re){for(K=0;K<F;++K){var _e=f[p+K];z[V+4*K]=_e,xe&=_e}p+=S,V+=Y}return xe!=255}function me(f,p,S,F,B){var z;for(z=0;z<B;++z)S[F+z]=f[p+z]>>8}function Ne(){Vn=b,ar=U,sr=ce,br=me}function Pe(f,p,S){E[f]=function(F,B,z,V,Y,K,re,xe,_e,Ae,we,Me,Le,ge,ye,De,He){var Re,lt=He-1>>1,et=Y[K+0]|re[xe+0]<<16,pt=_e[Ae+0]|we[Me+0]<<16;r(F!=null);var rt=3*et+pt+131074>>2;for(p(F[B+0],255&rt,rt>>16,Le,ge),z!=null&&(rt=3*pt+et+131074>>2,p(z[V+0],255&rt,rt>>16,ye,De)),Re=1;Re<=lt;++Re){var Ut=Y[K+Re]|re[xe+Re]<<16,qt=_e[Ae+Re]|we[Me+Re]<<16,Rt=et+Ut+pt+qt+524296,Pt=Rt+2*(Ut+pt)>>3;rt=Pt+et>>1,et=(Rt=Rt+2*(et+qt)>>3)+Ut>>1,p(F[B+2*Re-1],255&rt,rt>>16,Le,ge+(2*Re-1)*S),p(F[B+2*Re-0],255&et,et>>16,Le,ge+(2*Re-0)*S),z!=null&&(rt=Rt+pt>>1,et=Pt+qt>>1,p(z[V+2*Re-1],255&rt,rt>>16,ye,De+(2*Re-1)*S),p(z[V+2*Re+0],255&et,et>>16,ye,De+(2*Re+0)*S)),et=Ut,pt=qt}1&He||(rt=3*et+pt+131074>>2,p(F[B+He-1],255&rt,rt>>16,Le,ge+(He-1)*S),z!=null&&(rt=3*pt+et+131074>>2,p(z[V+He-1],255&rt,rt>>16,ye,De+(He-1)*S)))}}function ze(){$n[gl]=U1,$n[vl]=Pd,$n[Td]=H1,$n[yl]=Od,$n[bl]=Id,$n[$c]=Dd,$n[Cd]=W1,$n[Yc]=Pd,$n[Xc]=Od,$n[wl]=Id,$n[Kc]=Dd}function ot(f){return f&-16384?0>f?0:255:f>>z1}function ut(f,p){return ot((19077*f>>8)+(26149*p>>8)-14234)}function At(f,p,S){return ot((19077*f>>8)-(6419*p>>8)-(13320*S>>8)+8708)}function St(f,p){return ot((19077*f>>8)+(33050*p>>8)-17685)}function It(f,p,S,F,B){F[B+0]=ut(f,S),F[B+1]=At(f,p,S),F[B+2]=St(f,p)}function cr(f,p,S,F,B){F[B+0]=St(f,p),F[B+1]=At(f,p,S),F[B+2]=ut(f,S)}function fr(f,p,S,F,B){var z=At(f,p,S);p=z<<3&224|St(f,p)>>3,F[B+0]=248&ut(f,S)|z>>5,F[B+1]=p}function _r(f,p,S,F,B){var z=240&St(f,p)|15;F[B+0]=240&ut(f,S)|At(f,p,S)>>4,F[B+1]=z}function en(f,p,S,F,B){F[B+0]=255,It(f,p,S,F,B+1)}function Rr(f,p,S,F,B){cr(f,p,S,F,B),F[B+3]=255}function na(f,p,S,F,B){It(f,p,S,F,B),F[B+3]=255}function Cn(f,p){return 0>f?0:f>p?p:f}function ja(f,p,S){E[f]=function(F,B,z,V,Y,K,re,xe,_e){for(var Ae=xe+(-2&_e)*S;xe!=Ae;)p(F[B+0],z[V+0],Y[K+0],re,xe),p(F[B+1],z[V+0],Y[K+0],re,xe+S),B+=2,++V,++K,xe+=2*S;1&_e&&p(F[B+0],z[V+0],Y[K+0],re,xe)}}function dl(f,p,S){return S==0?f==0?p==0?6:5:p==0?4:0:S}function to(f,p,S,F,B){switch(f>>>30){case 3:Ba(p,S,F,B,0);break;case 2:yr(p,S,F,B);break;case 1:dn(p,S,F,B)}}function ro(f,p){var S,F,B=p.M,z=p.Nb,V=f.oc,Y=f.pc+40,K=f.oc,re=f.pc+584,xe=f.oc,_e=f.pc+600;for(S=0;16>S;++S)V[Y+32*S-1]=129;for(S=0;8>S;++S)K[re+32*S-1]=129,xe[_e+32*S-1]=129;for(0<B?V[Y-1-32]=K[re-1-32]=xe[_e-1-32]=129:(s(V,Y-32-1,127,21),s(K,re-32-1,127,9),s(xe,_e-32-1,127,9)),F=0;F<f.za;++F){var Ae=p.ya[p.aa+F];if(0<F){for(S=-1;16>S;++S)n(V,Y+32*S-4,V,Y+32*S+12,4);for(S=-1;8>S;++S)n(K,re+32*S-4,K,re+32*S+4,4),n(xe,_e+32*S-4,xe,_e+32*S+4,4)}var we=f.Gd,Me=f.Hd+F,Le=Ae.ad,ge=Ae.Hc;if(0<B&&(n(V,Y-32,we[Me].y,0,16),n(K,re-32,we[Me].f,0,8),n(xe,_e-32,we[Me].ea,0,8)),Ae.Za){var ye=V,De=Y-32+16;for(0<B&&(F>=f.za-1?s(ye,De,we[Me].y[15],4):n(ye,De,we[Me+1].y,0,4)),S=0;4>S;S++)ye[De+128+S]=ye[De+256+S]=ye[De+384+S]=ye[De+0+S];for(S=0;16>S;++S,ge<<=2)ye=V,De=Y+Md[S],aa[Ae.Ob[S]](ye,De),to(ge,Le,16*+S,ye,De)}else if(ye=dl(F,B,Ae.Ob[0]),as[ye](V,Y),ge!=0)for(S=0;16>S;++S,ge<<=2)to(ge,Le,16*+S,V,Y+Md[S]);for(S=Ae.Gc,ye=dl(F,B,Ae.Dd),Ha[ye](K,re),Ha[ye](xe,_e),ge=Le,ye=K,De=re,255&(Ae=S>>0)&&(170&Ae?oo(ge,256,ye,De):zn(ge,256,ye,De)),Ae=xe,ge=_e,255&(S>>=8)&&(170&S?oo(Le,320,Ae,ge):zn(Le,320,Ae,ge)),B<f.Ub-1&&(n(we[Me].y,0,V,Y+480,16),n(we[Me].f,0,K,re+224,8),n(we[Me].ea,0,xe,_e+224,8)),S=8*z*f.B,we=f.sa,Me=f.ta+16*F+16*z*f.R,Le=f.qa,Ae=f.ra+8*F+S,ge=f.Ha,ye=f.Ia+8*F+S,S=0;16>S;++S)n(we,Me+S*f.R,V,Y+32*S,16);for(S=0;8>S;++S)n(Le,Ae+S*f.B,K,re+32*S,8),n(ge,ye+S*f.B,xe,_e+32*S,8)}}function oi(f,p,S,F,B,z,V,Y,K){var re=[0],xe=[0],_e=0,Ae=K!=null?K.kd:0,we=K??new Ji;if(f==null||12>S)return 7;we.data=f,we.w=p,we.ha=S,p=[p],S=[S],we.gb=[we.gb];e:{var Me=p,Le=S,ge=we.gb;if(r(f!=null),r(Le!=null),r(ge!=null),ge[0]=0,12<=Le[0]&&!t(f,Me[0],"RIFF")){if(t(f,Me[0]+8,"WEBP")){ge=3;break e}var ye=Ve(f,Me[0]+4);if(12>ye||4294967286<ye){ge=3;break e}if(Ae&&ye>Le[0]-8){ge=7;break e}ge[0]=ye,Me[0]+=12,Le[0]-=12}ge=0}if(ge!=0)return ge;for(ye=0<we.gb[0],S=S[0];;){e:{var De=f;Le=p,ge=S;var He=re,Re=xe,lt=Me=[0];if((rt=_e=[_e])[0]=0,8>ge[0])ge=7;else{if(!t(De,Le[0],"VP8X")){if(Ve(De,Le[0]+4)!=10){ge=3;break e}if(18>ge[0]){ge=7;break e}var et=Ve(De,Le[0]+8),pt=1+Ie(De,Le[0]+12);if(2147483648<=pt*(De=1+Ie(De,Le[0]+15))){ge=3;break e}lt!=null&&(lt[0]=et),He!=null&&(He[0]=pt),Re!=null&&(Re[0]=De),Le[0]+=18,ge[0]-=18,rt[0]=1}ge=0}}if(_e=_e[0],Me=Me[0],ge!=0)return ge;if(Le=!!(2&Me),!ye&&_e)return 3;if(z!=null&&(z[0]=!!(16&Me)),V!=null&&(V[0]=Le),Y!=null&&(Y[0]=0),V=re[0],Me=xe[0],_e&&Le&&K==null){ge=0;break}if(4>S){ge=7;break}if(ye&&_e||!ye&&!_e&&!t(f,p[0],"ALPH")){S=[S],we.na=[we.na],we.P=[we.P],we.Sa=[we.Sa];e:{et=f,ge=p,ye=S;var rt=we.gb;He=we.na,Re=we.P,lt=we.Sa,pt=22,r(et!=null),r(ye!=null),De=ge[0];var Ut=ye[0];for(r(He!=null),r(lt!=null),He[0]=null,Re[0]=null,lt[0]=0;;){if(ge[0]=De,ye[0]=Ut,8>Ut){ge=7;break e}var qt=Ve(et,De+4);if(4294967286<qt){ge=3;break e}var Rt=8+qt+1&-2;if(pt+=Rt,0<rt&&pt>rt){ge=3;break e}if(!t(et,De,"VP8 ")||!t(et,De,"VP8L")){ge=0;break e}if(Ut[0]<Rt){ge=7;break e}t(et,De,"ALPH")||(He[0]=et,Re[0]=De+8,lt[0]=qt),De+=Rt,Ut-=Rt}}if(S=S[0],we.na=we.na[0],we.P=we.P[0],we.Sa=we.Sa[0],ge!=0)break}S=[S],we.Ja=[we.Ja],we.xa=[we.xa];e:if(rt=f,ge=p,ye=S,He=we.gb[0],Re=we.Ja,lt=we.xa,et=ge[0],De=!t(rt,et,"VP8 "),pt=!t(rt,et,"VP8L"),r(rt!=null),r(ye!=null),r(Re!=null),r(lt!=null),8>ye[0])ge=7;else{if(De||pt){if(rt=Ve(rt,et+4),12<=He&&rt>He-12){ge=3;break e}if(Ae&&rt>ye[0]-8){ge=7;break e}Re[0]=rt,ge[0]+=8,ye[0]-=8,lt[0]=pt}else lt[0]=5<=ye[0]&&rt[et+0]==47&&!(rt[et+4]>>5),Re[0]=ye[0];ge=0}if(S=S[0],we.Ja=we.Ja[0],we.xa=we.xa[0],p=p[0],ge!=0)break;if(4294967286<we.Ja)return 3;if(Y==null||Le||(Y[0]=we.xa?2:1),V=[V],Me=[Me],we.xa){if(5>S){ge=7;break}Y=V,Ae=Me,Le=z,f==null||5>S?f=0:5<=S&&f[p+0]==47&&!(f[p+4]>>5)?(ye=[0],rt=[0],He=[0],oe(Re=new A,f,p,S),mt(Re,ye,rt,He)?(Y!=null&&(Y[0]=ye[0]),Ae!=null&&(Ae[0]=rt[0]),Le!=null&&(Le[0]=He[0]),f=1):f=0):f=0}else{if(10>S){ge=7;break}Y=Me,f==null||10>S||!Yo(f,p+3,S-3)?f=0:(Ae=f[p+0]|f[p+1]<<8|f[p+2]<<16,Le=16383&(f[p+7]<<8|f[p+6]),f=16383&(f[p+9]<<8|f[p+8]),1&Ae||3<(Ae>>1&7)||!(Ae>>4&1)||Ae>>5>=we.Ja||!Le||!f?f=0:(V&&(V[0]=Le),Y&&(Y[0]=f),f=1))}if(!f||(V=V[0],Me=Me[0],_e&&(re[0]!=V||xe[0]!=Me)))return 3;K!=null&&(K[0]=we,K.offset=p-K.w,r(4294967286>p-K.w),r(K.offset==K.ha-S));break}return ge==0||ge==7&&_e&&K==null?(z!=null&&(z[0]|=we.na!=null&&0<we.na.length),F!=null&&(F[0]=V),B!=null&&(B[0]=Me),0):ge}function no(f,p,S){var F=p.width,B=p.height,z=0,V=0,Y=F,K=B;if(p.Da=f!=null&&0<f.Da,p.Da&&(Y=f.cd,K=f.bd,z=f.v,V=f.j,11>S||(z&=-2,V&=-2),0>z||0>V||0>=Y||0>=K||z+Y>F||V+K>B))return 0;if(p.v=z,p.j=V,p.va=z+Y,p.o=V+K,p.U=Y,p.T=K,p.da=f!=null&&0<f.da,p.da){if(!Be(Y,K,S=[f.ib],z=[f.hb]))return 0;p.ib=S[0],p.hb=z[0]}return p.ob=f!=null&&f.ob,p.Kb=f==null||!f.Sd,p.da&&(p.ob=p.ib<3*F/4&&p.hb<3*B/4,p.Kb=0),1}function ao(f){if(f==null)return 2;if(11>f.S){var p=f.f.RGBA;p.fb+=(f.height-1)*p.A,p.A=-p.A}else p=f.f.kb,f=f.height,p.O+=(f-1)*p.fa,p.fa=-p.fa,p.N+=(f-1>>1)*p.Ab,p.Ab=-p.Ab,p.W+=(f-1>>1)*p.Db,p.Db=-p.Db,p.F!=null&&(p.J+=(f-1)*p.lb,p.lb=-p.lb);return 0}function li(f,p,S,F){if(F==null||0>=f||0>=p)return 2;if(S!=null){if(S.Da){var B=S.cd,z=S.bd,V=-2&S.v,Y=-2&S.j;if(0>V||0>Y||0>=B||0>=z||V+B>f||Y+z>p)return 2;f=B,p=z}if(S.da){if(!Be(f,p,B=[S.ib],z=[S.hb]))return 2;f=B[0],p=z[0]}}F.width=f,F.height=p;e:{var K=F.width,re=F.height;if(f=F.S,0>=K||0>=re||!(f>=gl&&13>f))f=2;else{if(0>=F.Rd&&F.sd==null){V=z=B=p=0;var xe=(Y=K*Bd[f])*re;if(11>f||(z=(re+1)/2*(p=(K+1)/2),f==12&&(V=(B=K)*re)),(re=o(xe+2*z+V))==null){f=1;break e}F.sd=re,11>f?((K=F.f.RGBA).eb=re,K.fb=0,K.A=Y,K.size=xe):((K=F.f.kb).y=re,K.O=0,K.fa=Y,K.Fd=xe,K.f=re,K.N=0+xe,K.Ab=p,K.Cd=z,K.ea=re,K.W=0+xe+z,K.Db=p,K.Ed=z,f==12&&(K.F=re,K.J=0+xe+2*z),K.Tc=V,K.lb=B)}if(p=1,B=F.S,z=F.width,V=F.height,B>=gl&&13>B)if(11>B)f=F.f.RGBA,p&=(Y=Math.abs(f.A))*(V-1)+z<=f.size,p&=Y>=z*Bd[B],p&=f.eb!=null;else{f=F.f.kb,Y=(z+1)/2,xe=(V+1)/2,K=Math.abs(f.fa),re=Math.abs(f.Ab);var _e=Math.abs(f.Db),Ae=Math.abs(f.lb),we=Ae*(V-1)+z;p&=K*(V-1)+z<=f.Fd,p&=re*(xe-1)+Y<=f.Cd,p=(p&=_e*(xe-1)+Y<=f.Ed)&K>=z&re>=Y&_e>=Y,p&=f.y!=null,p&=f.f!=null,p&=f.ea!=null,B==12&&(p&=Ae>=z,p&=we<=f.Tc,p&=f.F!=null)}else p=0;f=p?0:2}}return f!=0||S!=null&&S.fd&&(f=ao(F)),f}var zr=64,ci=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],di=24,fi=32,so=8,vn=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ye("Predictor0","PredictorAdd0"),E.Predictor0=function(){return 4278190080},E.Predictor1=function(f){return f},E.Predictor2=function(f,p,S){return p[S+0]},E.Predictor3=function(f,p,S){return p[S+1]},E.Predictor4=function(f,p,S){return p[S-1]},E.Predictor5=function(f,p,S){return tt(tt(f,p[S+1]),p[S+0])},E.Predictor6=function(f,p,S){return tt(f,p[S-1])},E.Predictor7=function(f,p,S){return tt(f,p[S+0])},E.Predictor8=function(f,p,S){return tt(p[S-1],p[S+0])},E.Predictor9=function(f,p,S){return tt(p[S+0],p[S+1])},E.Predictor10=function(f,p,S){return tt(tt(f,p[S-1]),tt(p[S+0],p[S+1]))},E.Predictor11=function(f,p,S){var F=p[S+0];return 0>=wt(F>>24&255,f>>24&255,(p=p[S-1])>>24&255)+wt(F>>16&255,f>>16&255,p>>16&255)+wt(F>>8&255,f>>8&255,p>>8&255)+wt(255&F,255&f,255&p)?F:f},E.Predictor12=function(f,p,S){var F=p[S+0];return(dt((f>>24&255)+(F>>24&255)-((p=p[S-1])>>24&255))<<24|dt((f>>16&255)+(F>>16&255)-(p>>16&255))<<16|dt((f>>8&255)+(F>>8&255)-(p>>8&255))<<8|dt((255&f)+(255&F)-(255&p)))>>>0},E.Predictor13=function(f,p,S){var F=p[S-1];return(ht((f=tt(f,p[S+0]))>>24&255,F>>24&255)<<24|ht(f>>16&255,F>>16&255)<<16|ht(f>>8&255,F>>8&255)<<8|ht(f>>0&255,F>>0&255))>>>0};var Vc=E.PredictorAdd0;E.PredictorAdd1=kt,Ye("Predictor2","PredictorAdd2"),Ye("Predictor3","PredictorAdd3"),Ye("Predictor4","PredictorAdd4"),Ye("Predictor5","PredictorAdd5"),Ye("Predictor6","PredictorAdd6"),Ye("Predictor7","PredictorAdd7"),Ye("Predictor8","PredictorAdd8"),Ye("Predictor9","PredictorAdd9"),Ye("Predictor10","PredictorAdd10"),Ye("Predictor11","PredictorAdd11"),Ye("Predictor12","PredictorAdd12"),Ye("Predictor13","PredictorAdd13");var io=E.PredictorAdd2;Ct("ColorIndexInverseTransform","MapARGB","32b",function(f){return f>>8&255},function(f){return f}),Ct("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(f){return f},function(f){return f>>8&255});var fl,Wn=E.ColorIndexInverseTransform,hi=E.MapARGB,hl=E.VP8LColorIndexInverseTransformAlpha,ul=E.MapAlpha,es=E.VP8LPredictorsAdd=[];es.length=16,(E.VP8LPredictors=[]).length=16,(E.VP8LPredictorsAdd_C=[]).length=16,(E.VP8LPredictors_C=[]).length=16;var Es,yn,cn,ts,Ra,Ma,ui,Ba,yr,oo,dn,zn,mi,ml,lo,Fs,Ls,rs,Ps,pi,Os,ns,co,qn,Vn,ar,sr,br,Pr=o(511),Ua=o(2041),fo=o(225),xi=o(767),pl=0,Gc=Ua,xl=fo,En=xi,Gn=Pr,gl=0,vl=1,Td=2,yl=3,bl=4,$c=5,Cd=6,Yc=7,Xc=8,wl=9,Kc=10,A1=[2,3,7],k1=[3,3,11],Ed=[280,256,256,256,40],T1=[0,1,1,1,0],C1=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],E1=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],F1=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],L1=8,Jc=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Zc=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],ho=null,P1=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],O1=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Fd=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],I1=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],D1=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],R1=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],M1=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],as=[],aa=[],Ha=[],B1=1,Ld=2,ss=[],$n=[];Pe("UpsampleRgbLinePair",It,3),Pe("UpsampleBgrLinePair",cr,3),Pe("UpsampleRgbaLinePair",na,4),Pe("UpsampleBgraLinePair",Rr,4),Pe("UpsampleArgbLinePair",en,4),Pe("UpsampleRgba4444LinePair",_r,2),Pe("UpsampleRgb565LinePair",fr,2);var U1=E.UpsampleRgbLinePair,H1=E.UpsampleBgrLinePair,Pd=E.UpsampleRgbaLinePair,Od=E.UpsampleBgraLinePair,Id=E.UpsampleArgbLinePair,Dd=E.UpsampleRgba4444LinePair,W1=E.UpsampleRgb565LinePair,Nl=16,jl=1<<Nl-1,uo=-227,Qc=482,z1=6,Rd=0,q1=o(256),V1=o(256),G1=o(256),$1=o(256),Y1=o(Qc-uo),X1=o(Qc-uo);ja("YuvToRgbRow",It,3),ja("YuvToBgrRow",cr,3),ja("YuvToRgbaRow",na,4),ja("YuvToBgraRow",Rr,4),ja("YuvToArgbRow",en,4),ja("YuvToRgba4444Row",_r,2),ja("YuvToRgb565Row",fr,2);var Md=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Sl=[0,2,8],K1=[8,7,6,4,4,2,2,2,1,1,1,1],J1=1;this.WebPDecodeRGBA=function(f,p,S,F,B){var z=vl,V=new si,Y=new An;V.ba=Y,Y.S=z,Y.width=[Y.width],Y.height=[Y.height];var K=Y.width,re=Y.height,xe=new Zn;if(xe==null||f==null)var _e=2;else r(xe!=null),_e=oi(f,p,S,xe.width,xe.height,xe.Pd,xe.Qd,xe.format,null);if(_e!=0?K=0:(K!=null&&(K[0]=xe.width[0]),re!=null&&(re[0]=xe.height[0]),K=1),K){Y.width=Y.width[0],Y.height=Y.height[0],F!=null&&(F[0]=Y.width),B!=null&&(B[0]=Y.height);e:{if(F=new ba,(B=new Ji).data=f,B.w=p,B.ha=S,B.kd=1,p=[0],r(B!=null),((f=oi(B.data,B.w,B.ha,null,null,null,p,null,B))==0||f==7)&&p[0]&&(f=4),(p=f)==0){if(r(V!=null),F.data=B.data,F.w=B.w+B.offset,F.ha=B.ha-B.offset,F.put=Un,F.ac=Lr,F.bc=Hn,F.ma=V,B.xa){if((f=Fe())==null){V=1;break e}if(function(Ae,we){var Me=[0],Le=[0],ge=[0];t:for(;;){if(Ae==null)return 0;if(we==null)return Ae.a=2,0;if(Ae.l=we,Ae.a=0,oe(Ae.m,we.data,we.w,we.ha),!mt(Ae.m,Me,Le,ge)){Ae.a=3;break t}if(Ae.xb=Ld,we.width=Me[0],we.height=Le[0],!je(Me[0],Le[0],1,Ae,null))break t;return 1}return r(Ae.a!=0),0}(f,F)){if(F=(p=li(F.width,F.height,V.Oa,V.ba))==0){t:{F=f;r:for(;;){if(F==null){F=0;break t}if(r(F.s.yc!=null),r(F.s.Ya!=null),r(0<F.s.Wb),r((S=F.l)!=null),r((B=S.ma)!=null),F.xb!=0){if(F.ca=B.ba,F.tb=B.tb,r(F.ca!=null),!no(B.Oa,S,yl)){F.a=2;break r}if(!ke(F,S.width)||S.da)break r;if((S.da||Dt(F.ca.S))&&Ne(),11>F.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),F.ca.f.kb.F!=null&&Ne()),F.Pb&&0<F.s.ua&&F.s.vb.X==null&&!$e(F.s.vb,F.s.Wa.Xa)){F.a=1;break r}F.xb=0}if(!ie(F,F.V,F.Ba,F.c,F.i,S.o,se))break r;B.Dc=F.Ma,F=1;break t}r(F.a!=0),F=0}F=!F}F&&(p=f.a)}else p=f.a}else{if((f=new Tn)==null){V=1;break e}if(f.Fa=B.na,f.P=B.P,f.qc=B.Sa,Xo(f,F)){if((p=li(F.width,F.height,V.Oa,V.ba))==0){if(f.Aa=0,S=V.Oa,r((B=f)!=null),S!=null){if(0<(K=0>(K=S.Md)?0:100<K?255:255*K/100)){for(re=xe=0;4>re;++re)12>(_e=B.pb[re]).lc&&(_e.ia=K*K1[0>_e.lc?0:_e.lc]>>3),xe|=_e.ia;xe&&(alert("todo:VP8InitRandom"),B.ia=1)}B.Ga=S.Id,100<B.Ga?B.Ga=100:0>B.Ga&&(B.Ga=0)}kc(f,F)||(p=f.a)}}else p=f.a}p==0&&V.Oa!=null&&V.Oa.fd&&(p=ao(V.ba))}V=p}z=V!=0?null:11>z?Y.f.RGBA.eb:Y.f.kb.y}else z=null;return z};var Bd=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function h(E,P){for(var H="",k=0;k<4;k++)H+=String.fromCharCode(E[P++]);return H}function u(E,P){return(E[P+0]<<0|E[P+1]<<8|E[P+2]<<16)>>>0}function g(E,P){return(E[P+0]<<0|E[P+1]<<8|E[P+2]<<16|E[P+3]<<24)>>>0}new d;var x=[0],m=[0],y=[],v=new d,j=e,w=function(E,P){var H={},k=0,T=!1,W=0,G=0;if(H.frames=[],!function(O,I,R,X){for(var fe=0;fe<X;fe++)if(O[I+fe]!=R.charCodeAt(fe))return!0;return!1}(E,P,"RIFF",4)){var de,J;for(g(E,P+=4),P+=8;P<E.length;){var Z=h(E,P),oe=g(E,P+=4);P+=4;var ae=oe+(1&oe);switch(Z){case"VP8 ":case"VP8L":H.frames[k]===void 0&&(H.frames[k]={}),(A=H.frames[k]).src_off=T?G:P-8,A.src_size=W+oe+8,k++,T&&(T=!1,W=0,G=0);break;case"VP8X":(A=H.header={}).feature_flags=E[P];var pe=P+4;A.canvas_width=1+u(E,pe),pe+=3,A.canvas_height=1+u(E,pe),pe+=3;break;case"ALPH":T=!0,W=ae+8,G=P-8;break;case"ANIM":(A=H.header).bgcolor=g(E,P),pe=P+4,A.loop_count=(de=E)[(J=pe)+0]<<0|de[J+1]<<8,pe+=2;break;case"ANMF":var be,A;(A=H.frames[k]={}).offset_x=2*u(E,P),P+=3,A.offset_y=2*u(E,P),P+=3,A.width=1+u(E,P),P+=3,A.height=1+u(E,P),P+=3,A.duration=u(E,P),P+=3,be=E[P++],A.dispose=1&be,A.blend=be>>1&1}Z!="ANMF"&&(P+=ae)}return H}}(j,0);w.response=j,w.rgbaoutput=!0,w.dataurl=!1;var N=w.header?w.header:null,_=w.frames?w.frames:null;if(N){N.loop_counter=N.loop_count,x=[N.canvas_height],m=[N.canvas_width];for(var C=0;C<_.length&&_[C].blend!=0;C++);}var M=_[0],D=v.WebPDecodeRGBA(j,M.src_off,M.src_size,m,x);M.rgba=D,M.imgwidth=m[0],M.imgheight=x[0];for(var L=0;L<m[0]*x[0]*4;L++)y[L]=D[L];return this.width=m,this.height=x,this.data=y,this}(function(e){var r=function(){return typeof H0=="function"},t=function(x,m,y,v){var j=4,w=l;switch(v){case e.image_compression.FAST:j=1,w=o;break;case e.image_compression.MEDIUM:j=6,w=c;break;case e.image_compression.SLOW:j=9,w=d}x=n(x,m,y,w);var N=H0(x,{level:j});return e.__addimage__.arrayBufferToBinaryString(N)},n=function(x,m,y,v){for(var j,w,N,_=x.length/m,C=new Uint8Array(x.length+_),M=u(),D=0;D<_;D+=1){if(N=D*m,j=x.subarray(N,N+m),v)C.set(v(j,y,w),N+D);else{for(var L,E=M.length,P=[];L<E;L+=1)P[L]=M[L](j,y,w);var H=g(P.concat());C.set(P[H],N+D)}w=j}return C},s=function(x){var m=Array.apply([],x);return m.unshift(0),m},o=function(x,m){var y,v=[],j=x.length;v[0]=1;for(var w=0;w<j;w+=1)y=x[w-m]||0,v[w+1]=x[w]-y+256&255;return v},l=function(x,m,y){var v,j=[],w=x.length;j[0]=2;for(var N=0;N<w;N+=1)v=y&&y[N]||0,j[N+1]=x[N]-v+256&255;return j},c=function(x,m,y){var v,j,w=[],N=x.length;w[0]=3;for(var _=0;_<N;_+=1)v=x[_-m]||0,j=y&&y[_]||0,w[_+1]=x[_]+256-(v+j>>>1)&255;return w},d=function(x,m,y){var v,j,w,N,_=[],C=x.length;_[0]=4;for(var M=0;M<C;M+=1)v=x[M-m]||0,j=y&&y[M]||0,w=y&&y[M-m]||0,N=h(v,j,w),_[M+1]=x[M]-N+256&255;return _},h=function(x,m,y){if(x===m&&m===y)return x;var v=Math.abs(m-y),j=Math.abs(x-y),w=Math.abs(x+m-y-y);return v<=j&&v<=w?x:j<=w?m:y},u=function(){return[s,o,l,c,d]},g=function(x){var m=x.map(function(y){return y.reduce(function(v,j){return v+Math.abs(j)},0)});return m.indexOf(Math.min.apply(null,m))};e.processPNG=function(x,m,y,v){var j,w,N,_,C,M,D,L,E,P,H,k,T,W,G,de=this.decode.FLATE_DECODE,J="";if(this.__addimage__.isArrayBuffer(x)&&(x=new Uint8Array(x)),this.__addimage__.isArrayBufferView(x)){if(x=(N=new Fx(x)).imgData,w=N.bits,j=N.colorSpace,C=N.colors,[4,6].indexOf(N.colorType)!==-1){if(N.bits===8){E=(L=N.pixelBitlength==32?new Uint32Array(N.decodePixels().buffer):N.pixelBitlength==16?new Uint16Array(N.decodePixels().buffer):new Uint8Array(N.decodePixels().buffer)).length,H=new Uint8Array(E*N.colors),P=new Uint8Array(E);var Z,oe=N.pixelBitlength-N.bits;for(W=0,G=0;W<E;W++){for(T=L[W],Z=0;Z<oe;)H[G++]=T>>>Z&255,Z+=N.bits;P[W]=T>>>Z&255}}if(N.bits===16){E=(L=new Uint32Array(N.decodePixels().buffer)).length,H=new Uint8Array(E*(32/N.pixelBitlength)*N.colors),P=new Uint8Array(E*(32/N.pixelBitlength)),k=N.colors>1,W=0,G=0;for(var ae=0;W<E;)T=L[W++],H[G++]=T>>>0&255,k&&(H[G++]=T>>>16&255,T=L[W++],H[G++]=T>>>0&255),P[ae++]=T>>>16&255;w=8}v!==e.image_compression.NONE&&r()?(x=t(H,N.width*N.colors,N.colors,v),D=t(P,N.width,1,v)):(x=H,D=P,de=void 0)}if(N.colorType===3&&(j=this.color_spaces.INDEXED,M=N.palette,N.transparency.indexed)){var pe=N.transparency.indexed,be=0;for(W=0,E=pe.length;W<E;++W)be+=pe[W];if((be/=255)===E-1&&pe.indexOf(0)!==-1)_=[pe.indexOf(0)];else if(be!==E){for(L=N.decodePixels(),P=new Uint8Array(L.length),W=0,E=L.length;W<E;W++)P[W]=pe[L[W]];D=t(P,N.width,1)}}var A=function(O){var I;switch(O){case e.image_compression.FAST:I=11;break;case e.image_compression.MEDIUM:I=13;break;case e.image_compression.SLOW:I=14;break;default:I=12}return I}(v);return de===this.decode.FLATE_DECODE&&(J="/Predictor "+A+" "),J+="/Colors "+C+" /BitsPerComponent "+w+" /Columns "+N.width,(this.__addimage__.isArrayBuffer(x)||this.__addimage__.isArrayBufferView(x))&&(x=this.__addimage__.arrayBufferToBinaryString(x)),(D&&this.__addimage__.isArrayBuffer(D)||this.__addimage__.isArrayBufferView(D))&&(D=this.__addimage__.arrayBufferToBinaryString(D)),{alias:y,data:x,index:m,filter:de,decodeParameters:J,transparency:_,palette:M,sMask:D,predictor:A,width:N.width,height:N.height,bitsPerComponent:w,colorSpace:j}}}})(xt.API),function(e){e.processGIF89A=function(r,t,n,s){var o=new Lx(r),l=o.width,c=o.height,d=[];o.decodeAndBlitFrameRGBA(0,d);var h={data:d,width:l,height:c},u=new S0(100).encode(h,100);return e.processJPEG.call(this,u,t,n,s)},e.processGIF87A=e.processGIF89A}(xt.API),oa.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var r=0;r<e;r++){var t=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0);this.palette[r]={red:s,green:n,blue:t,quad:o}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},oa.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,r=this.width*this.height*4;this.data=new Uint8Array(r),this[e]()}catch(t){tr.log("bit decode error:"+t)}},oa.prototype.bit1=function(){var e,r=Math.ceil(this.width/8),t=r%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,s=0;s<r;s++)for(var o=this.datav.getUint8(this.pos++,!0),l=n*this.width*4+8*s*4,c=0;c<8&&8*s+c<this.width;c++){var d=this.palette[o>>7-c&1];this.data[l+4*c]=d.blue,this.data[l+4*c+1]=d.green,this.data[l+4*c+2]=d.red,this.data[l+4*c+3]=255}t!==0&&(this.pos+=4-t)}},oa.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),r=e%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,s=0;s<e;s++){var o=this.datav.getUint8(this.pos++,!0),l=n*this.width*4+2*s*4,c=o>>4,d=15&o,h=this.palette[c];if(this.data[l]=h.blue,this.data[l+1]=h.green,this.data[l+2]=h.red,this.data[l+3]=255,2*s+1>=this.width)break;h=this.palette[d],this.data[l+4]=h.blue,this.data[l+4+1]=h.green,this.data[l+4+2]=h.red,this.data[l+4+3]=255}r!==0&&(this.pos+=4-r)}},oa.prototype.bit8=function(){for(var e=this.width%4,r=this.height-1;r>=0;r--){for(var t=this.bottom_up?r:this.height-1-r,n=0;n<this.width;n++){var s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*n;if(s<this.palette.length){var l=this.palette[s];this.data[o]=l.red,this.data[o+1]=l.green,this.data[o+2]=l.blue,this.data[o+3]=255}else this.data[o]=255,this.data[o+1]=255,this.data[o+2]=255,this.data[o+3]=255}e!==0&&(this.pos+=4-e)}},oa.prototype.bit15=function(){for(var e=this.width%3,r=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&r)/r*255|0,c=(o>>5&r)/r*255|0,d=(o>>10&r)/r*255|0,h=o>>15?255:0,u=n*this.width*4+4*s;this.data[u]=d,this.data[u+1]=c,this.data[u+2]=l,this.data[u+3]=h}this.pos+=e}},oa.prototype.bit16=function(){for(var e=this.width%3,r=parseInt("11111",2),t=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,o=0;o<this.width;o++){var l=this.datav.getUint16(this.pos,!0);this.pos+=2;var c=(l&r)/r*255|0,d=(l>>5&t)/t*255|0,h=(l>>11)/r*255|0,u=s*this.width*4+4*o;this.data[u]=h,this.data[u+1]=d,this.data[u+2]=c,this.data[u+3]=255}this.pos+=e}},oa.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=r*this.width*4+4*t;this.data[l]=o,this.data[l+1]=s,this.data[l+2]=n,this.data[l+3]=255}this.pos+=this.width%4}},oa.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var r=this.bottom_up?e:this.height-1-e,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),c=r*this.width*4+4*t;this.data[c]=o,this.data[c+1]=s,this.data[c+2]=n,this.data[c+3]=l}},oa.prototype.getData=function(){return this.data},function(e){e.processBMP=function(r,t,n,s){var o=new oa(r,!1),l=o.width,c=o.height,d={data:o.getData(),width:l,height:c},h=new S0(100).encode(d,100);return e.processJPEG.call(this,h,t,n,s)}}(xt.API),Ff.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(r,t,n,s){var o=new Ff(r),l=o.width,c=o.height,d={data:o.getData(),width:l,height:c},h=new S0(100).encode(d,100);return e.processJPEG.call(this,h,t,n,s)}}(xt.API),xt.API.processRGBA=function(e,r,t){for(var n=e.data,s=n.length,o=new Uint8Array(s/4*3),l=new Uint8Array(s/4),c=0,d=0,h=0;h<s;h+=4){var u=n[h],g=n[h+1],x=n[h+2],m=n[h+3];o[c++]=u,o[c++]=g,o[c++]=x,l[d++]=m}var y=this.__addimage__.arrayBufferToBinaryString(o);return{alpha:this.__addimage__.arrayBufferToBinaryString(l),data:y,index:r,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},xt.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Ni=xt.API,zl=Ni.getCharWidthsArray=function(e,r){var t,n,s=(r=r||{}).font||this.internal.getFont(),o=r.fontSize||this.internal.getFontSize(),l=r.charSpace||this.internal.getCharSpace(),c=r.widths?r.widths:s.metadata.Unicode.widths,d=c.fof?c.fof:1,h=r.kerning?r.kerning:s.metadata.Unicode.kerning,u=h.fof?h.fof:1,g=r.doKerning!==!1,x=0,m=e.length,y=0,v=c[0]||d,j=[];for(t=0;t<m;t++)n=e.charCodeAt(t),typeof s.metadata.widthOfString=="function"?j.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(n))+l*(1e3/o)||0)/1e3):(x=g&&rr(h[n])==="object"&&!isNaN(parseInt(h[n][y],10))?h[n][y]/u:0,j.push((c[n]||v)/d+x)),y=n;return j},kf=Ni.getStringUnitWidth=function(e,r){var t=(r=r||{}).fontSize||this.internal.getFontSize(),n=r.font||this.internal.getFont(),s=r.charSpace||this.internal.getCharSpace();return Ni.processArabic&&(e=Ni.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,t,s)/t:zl.apply(this,arguments).reduce(function(o,l){return o+l},0)},Tf=function(e,r,t,n){for(var s=[],o=0,l=e.length,c=0;o!==l&&c+r[o]<t;)c+=r[o],o++;s.push(e.slice(0,o));var d=o;for(c=0;o!==l;)c+r[o]>n&&(s.push(e.slice(d,o)),c=0,d=o),c+=r[o],o++;return d!==o&&s.push(e.slice(d,o)),s},Cf=function(e,r,t){t||(t={});var n,s,o,l,c,d,h,u=[],g=[u],x=t.textIndent||0,m=0,y=0,v=e.split(" "),j=zl.apply(this,[" ",t])[0];if(d=t.lineIndent===-1?v[0].length+2:t.lineIndent||0){var w=Array(d).join(" "),N=[];v.map(function(C){(C=C.split(/\s*\n/)).length>1?N=N.concat(C.map(function(M,D){return(D&&M.length?`
`:"")+M})):N.push(C[0])}),v=N,d=kf.apply(this,[w,t])}for(o=0,l=v.length;o<l;o++){var _=0;if(n=v[o],d&&n[0]==`
`&&(n=n.substr(1),_=1),x+m+(y=(s=zl.apply(this,[n,t])).reduce(function(C,M){return C+M},0))>r||_){if(y>r){for(c=Tf.apply(this,[n,s,r-(x+m),r]),u.push(c.shift()),u=[c.pop()];c.length;)g.push([c.shift()]);y=s.slice(n.length-(u[0]?u[0].length:0)).reduce(function(C,M){return C+M},0)}else u=[n];g.push(u),x=y+d,m=j}else u.push(n),x+=m+y,m=j}return h=d?function(C,M){return(M?w:"")+C.join(" ")}:function(C){return C.join(" ")},g.map(h)},Ni.splitTextToSize=function(e,r,t){var n,s=(t=t||{}).fontSize||this.internal.getFontSize(),o=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var g=this.internal.getFont(u.fontName,u.fontStyle);return g.metadata.Unicode?{widths:g.metadata.Unicode.widths||{0:1},kerning:g.metadata.Unicode.kerning||{}}:{font:g.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var l=1*this.internal.scaleFactor*r/s;o.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/s:0,o.lineIndent=t.lineIndent;var c,d,h=[];for(c=0,d=n.length;c<d;c++)h=h.concat(Cf.apply(this,[n[c],l,o]));return h},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var r="klmnopqrstuvwxyz",t={},n={},s=0;s<r.length;s++)t[r[s]]="0123456789abcdef"[s],n["0123456789abcdef"[s]]=r[s];var o=function(g){return"0x"+parseInt(g,10).toString(16)},l=e.__fontmetrics__.compress=function(g){var x,m,y,v,j=["{"];for(var w in g){if(x=g[w],isNaN(parseInt(w,10))?m="'"+w+"'":(w=parseInt(w,10),m=(m=o(w).slice(2)).slice(0,-1)+n[m.slice(-1)]),typeof x=="number")x<0?(y=o(x).slice(3),v="-"):(y=o(x).slice(2),v=""),y=v+y.slice(0,-1)+n[y.slice(-1)];else{if(rr(x)!=="object")throw new Error("Don't know what to do with value type "+rr(x)+".");y=l(x)}j.push(m+y)}return j.push("}"),j.join("")},c=e.__fontmetrics__.uncompress=function(g){if(typeof g!="string")throw new Error("Invalid argument passed to uncompress.");for(var x,m,y,v,j={},w=1,N=j,_=[],C="",M="",D=g.length-1,L=1;L<D;L+=1)(v=g[L])=="'"?x?(y=x.join(""),x=void 0):x=[]:x?x.push(v):v=="{"?(_.push([N,y]),N={},y=void 0):v=="}"?((m=_.pop())[0][m[1]]=N,y=void 0,N=m[0]):v=="-"?w=-1:y===void 0?t.hasOwnProperty(v)?(C+=t[v],y=parseInt(C,16)*w,w=1,C=""):C+=v:t.hasOwnProperty(v)?(M+=t[v],N[y]=parseInt(M,16)*w,w=1,y=void 0,M=""):M+=v;return j},d={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},h={Unicode:{Courier:d,"Courier-Bold":d,"Courier-BoldOblique":d,"Courier-Oblique":d,Helvetica:d,"Helvetica-Bold":d,"Helvetica-BoldOblique":d,"Helvetica-Oblique":d,"Times-Roman":d,"Times-Bold":d,"Times-BoldItalic":d,"Times-Italic":d}},u={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(g){var x=g.font,m=u.Unicode[x.postScriptName];m&&(x.metadata.Unicode={},x.metadata.Unicode.widths=m.widths,x.metadata.Unicode.kerning=m.kerning);var y=h.Unicode[x.postScriptName];y&&(x.metadata.Unicode.encoding=y,x.encoding=y.codePages[0])}])}(xt.API),function(e){var r=function(t){for(var n=t.length,s=new Uint8Array(n),o=0;o<n;o++)s[o]=t.charCodeAt(o);return s};e.API.events.push(["addFont",function(t){var n=void 0,s=t.font,o=t.instance;if(!s.isStandardFont){if(o===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(n=o.existsFileInVFS(s.postScriptName)===!1?o.loadFile(s.postScriptName):o.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(l,c){c=/^\x00\x01\x00\x00/.test(c)?r(c):r(No(c)),l.metadata=e.API.TTFFont.open(c),l.metadata.Unicode=l.metadata.Unicode||{encoding:{},kerning:{},widths:[]},l.metadata.glyIdsUsed=[0]})(s,n)}}])}(xt),function(e){function r(){return(yt.canvg?Promise.resolve(yt.canvg):D0(()=>import("./index.es-CYUj7cQv.js"),__vite__mapDeps([0,1,2]))).catch(function(t){return Promise.reject(new Error("Could not load canvg: "+t))}).then(function(t){return t.default?t.default:t})}xt.API.addSvgAsImage=function(t,n,s,o,l,c,d,h){if(isNaN(n)||isNaN(s))throw tr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(o)||isNaN(l))throw tr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=o,u.height=l;var g=u.getContext("2d");g.fillStyle="#fff",g.fillRect(0,0,u.width,u.height);var x={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},m=this;return r().then(function(y){return y.fromString(g,t,x)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(y){return y.render(x)}).then(function(){m.addImage(u.toDataURL("image/jpeg",1),n,s,o,l,d,h)})}}(),xt.API.putTotalPages=function(e){var r,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(r=new RegExp(e,"g"),t=this.internal.getNumberOfPages()):(r=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var s=0;s<this.internal.pages[n].length;s++)this.internal.pages[n][s]=this.internal.pages[n][s].replace(r,t);return this},xt.API.viewerPreferences=function(e,r){var t;e=e||{},r=r||!1;var n,s,o,l={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},c=Object.keys(l),d=[],h=0,u=0,g=0;function x(y,v){var j,w=!1;for(j=0;j<y.length;j+=1)y[j]===v&&(w=!0);return w}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(l)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,e==="reset"||r===!0){var m=c.length;for(g=0;g<m;g+=1)t[c[g]].value=t[c[g]].defaultValue,t[c[g]].explicitSet=!1}if(rr(e)==="object"){for(s in e)if(o=e[s],x(c,s)&&o!==void 0){if(t[s].type==="boolean"&&typeof o=="boolean")t[s].value=o;else if(t[s].type==="name"&&x(t[s].valueSet,o))t[s].value=o;else if(t[s].type==="integer"&&Number.isInteger(o))t[s].value=o;else if(t[s].type==="array"){for(h=0;h<o.length;h+=1)if(n=!0,o[h].length===1&&typeof o[h][0]=="number")d.push(String(o[h]-1));else if(o[h].length>1){for(u=0;u<o[h].length;u+=1)typeof o[h][u]!="number"&&(n=!1);n===!0&&d.push([o[h][0]-1,o[h][1]-1].join(" "))}t[s].value="["+d.join(" ")+"]"}else t[s].value=t[s].defaultValue;t[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var y,v=[];for(y in t)t[y].explicitSet===!0&&(t[y].type==="name"?v.push("/"+y+" /"+t[y].value):v.push("/"+y+" "+t[y].value));v.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+v.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},function(e){var r=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),o=unescape(encodeURIComponent(n)),l=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),c=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),d=unescape(encodeURIComponent("</x:xmpmeta>")),h=o.length+l.length+c.length+s.length+d.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+h+" >>"),this.internal.write("stream"),this.internal.write(s+o+l+c+d),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",r)),this}}(xt.API),function(e){var r=e.API,t=r.pdfEscape16=function(o,l){for(var c,d=l.metadata.Unicode.widths,h=["","0","00","000","0000"],u=[""],g=0,x=o.length;g<x;++g){if(c=l.metadata.characterToGlyph(o.charCodeAt(g)),l.metadata.glyIdsUsed.push(c),l.metadata.toUnicode[c]=o.charCodeAt(g),d.indexOf(c)==-1&&(d.push(c),d.push([parseInt(l.metadata.widthOfGlyph(c),10)])),c=="0")return u.join("");c=c.toString(16),u.push(h[4-c.length],c)}return u.join("")},n=function(o){var l,c,d,h,u,g,x;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,d=[],g=0,x=(c=Object.keys(o).sort(function(m,y){return m-y})).length;g<x;g++)l=c[g],d.length>=100&&(u+=`
`+d.length+` beginbfchar
`+d.join(`
`)+`
endbfchar`,d=[]),o[l]!==void 0&&o[l]!==null&&typeof o[l].toString=="function"&&(h=("0000"+o[l].toString(16)).slice(-4),l=("0000"+(+l).toString(16)).slice(-4),d.push("<"+l+"><"+h+">"));return d.length&&(u+=`
`+d.length+` beginbfchar
`+d.join(`
`)+`
endbfchar
`),u+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};r.events.push(["putFont",function(o){(function(l){var c=l.font,d=l.out,h=l.newObject,u=l.putStream;if(c.metadata instanceof e.API.TTFFont&&c.encoding==="Identity-H"){for(var g=c.metadata.Unicode.widths,x=c.metadata.subset.encode(c.metadata.glyIdsUsed,1),m="",y=0;y<x.length;y++)m+=String.fromCharCode(x[y]);var v=h();u({data:m,addLength1:!0,objectId:v}),d("endobj");var j=h();u({data:n(c.metadata.toUnicode),addLength1:!0,objectId:j}),d("endobj");var w=h();d("<<"),d("/Type /FontDescriptor"),d("/FontName /"+Ci(c.fontName)),d("/FontFile2 "+v+" 0 R"),d("/FontBBox "+e.API.PDFObject.convert(c.metadata.bbox)),d("/Flags "+c.metadata.flags),d("/StemV "+c.metadata.stemV),d("/ItalicAngle "+c.metadata.italicAngle),d("/Ascent "+c.metadata.ascender),d("/Descent "+c.metadata.decender),d("/CapHeight "+c.metadata.capHeight),d(">>"),d("endobj");var N=h();d("<<"),d("/Type /Font"),d("/BaseFont /"+Ci(c.fontName)),d("/FontDescriptor "+w+" 0 R"),d("/W "+e.API.PDFObject.convert(g)),d("/CIDToGIDMap /Identity"),d("/DW 1000"),d("/Subtype /CIDFontType2"),d("/CIDSystemInfo"),d("<<"),d("/Supplement 0"),d("/Registry (Adobe)"),d("/Ordering ("+c.encoding+")"),d(">>"),d(">>"),d("endobj"),c.objectNumber=h(),d("<<"),d("/Type /Font"),d("/Subtype /Type0"),d("/ToUnicode "+j+" 0 R"),d("/BaseFont /"+Ci(c.fontName)),d("/Encoding /"+c.encoding),d("/DescendantFonts ["+N+" 0 R]"),d(">>"),d("endobj"),c.isAlreadyPutted=!0}})(o)}]),r.events.push(["putFont",function(o){(function(l){var c=l.font,d=l.out,h=l.newObject,u=l.putStream;if(c.metadata instanceof e.API.TTFFont&&c.encoding==="WinAnsiEncoding"){for(var g=c.metadata.rawData,x="",m=0;m<g.length;m++)x+=String.fromCharCode(g[m]);var y=h();u({data:x,addLength1:!0,objectId:y}),d("endobj");var v=h();u({data:n(c.metadata.toUnicode),addLength1:!0,objectId:v}),d("endobj");var j=h();d("<<"),d("/Descent "+c.metadata.decender),d("/CapHeight "+c.metadata.capHeight),d("/StemV "+c.metadata.stemV),d("/Type /FontDescriptor"),d("/FontFile2 "+y+" 0 R"),d("/Flags 96"),d("/FontBBox "+e.API.PDFObject.convert(c.metadata.bbox)),d("/FontName /"+Ci(c.fontName)),d("/ItalicAngle "+c.metadata.italicAngle),d("/Ascent "+c.metadata.ascender),d(">>"),d("endobj"),c.objectNumber=h();for(var w=0;w<c.metadata.hmtx.widths.length;w++)c.metadata.hmtx.widths[w]=parseInt(c.metadata.hmtx.widths[w]*(1e3/c.metadata.head.unitsPerEm));d("<</Subtype/TrueType/Type/Font/ToUnicode "+v+" 0 R/BaseFont/"+Ci(c.fontName)+"/FontDescriptor "+j+" 0 R/Encoding/"+c.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(c.metadata.hmtx.widths)+">>"),d("endobj"),c.isAlreadyPutted=!0}})(o)}]);var s=function(o){var l,c=o.text||"",d=o.x,h=o.y,u=o.options||{},g=o.mutex||{},x=g.pdfEscape,m=g.activeFontKey,y=g.fonts,v=m,j="",w=0,N="",_=y[v].encoding;if(y[v].encoding!=="Identity-H")return{text:c,x:d,y:h,options:u,mutex:g};for(N=c,v=m,Array.isArray(c)&&(N=c[0]),w=0;w<N.length;w+=1)y[v].metadata.hasOwnProperty("cmap")&&(l=y[v].metadata.cmap.unicode.codeMap[N[w].charCodeAt(0)]),l||N[w].charCodeAt(0)<256&&y[v].metadata.hasOwnProperty("Unicode")?j+=N[w]:j+="";var C="";return parseInt(v.slice(1))<14||_==="WinAnsiEncoding"?C=x(j,v).split("").map(function(M){return M.charCodeAt(0).toString(16)}).join(""):_==="Identity-H"&&(C=t(j,y[v])),g.isHex=!0,{text:C,x:d,y:h,options:u,mutex:g}};r.events.push(["postProcessText",function(o){var l=o.text||"",c=[],d={text:l,x:o.x,y:o.y,options:o.options,mutex:o.mutex};if(Array.isArray(l)){var h=0;for(h=0;h<l.length;h+=1)Array.isArray(l[h])&&l[h].length===3?c.push([s(Object.assign({},d,{text:l[h][0]})).text,l[h][1],l[h][2]]):c.push(s(Object.assign({},d,{text:l[h]})).text);o.text=c}else o.text=s(Object.assign({},d,{text:l})).text}])}(xt),function(e){var r=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(t){return r.call(this),this.internal.vFS[t]!==void 0},e.addFileToVFS=function(t,n){return r.call(this),this.internal.vFS[t]=n,this},e.getFileFromVFS=function(t){return r.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}}(xt.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var s,o,l,c,d,h,u,g=r,x=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],m=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],y={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},v={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},j=["(",")","(","<",">","<","[","]","[","{","}","{","Â«","Â»","Â«","â€¹","â€º","â€¹","â…","â†","â…","â½","â¾","â½","â‚","â‚Ž","â‚","â‰¤","â‰¥","â‰¤","âŒ©","âŒª","âŒ©","ï¹™","ï¹š","ï¹™","ï¹›","ï¹œ","ï¹›","ï¹","ï¹ž","ï¹","ï¹¤","ï¹¥","ï¹¤"],w=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),N=!1,_=0;this.__bidiEngine__={};var C=function(k){var T=k.charCodeAt(),W=T>>8,G=v[W];return G!==void 0?g[256*G+(255&T)]:W===252||W===253?"AL":w.test(W)?"L":W===8?"R":"N"},M=function(k){for(var T,W=0;W<k.length;W++){if((T=C(k.charAt(W)))==="L")return!1;if(T==="R")return!0}return!1},D=function(k,T,W,G){var de,J,Z,oe,ae=T[G];switch(ae){case"L":case"R":N=!1;break;case"N":case"AN":break;case"EN":N&&(ae="AN");break;case"AL":N=!0,ae="R";break;case"WS":ae="N";break;case"CS":G<1||G+1>=T.length||(de=W[G-1])!=="EN"&&de!=="AN"||(J=T[G+1])!=="EN"&&J!=="AN"?ae="N":N&&(J="AN"),ae=J===de?J:"N";break;case"ES":ae=(de=G>0?W[G-1]:"B")==="EN"&&G+1<T.length&&T[G+1]==="EN"?"EN":"N";break;case"ET":if(G>0&&W[G-1]==="EN"){ae="EN";break}if(N){ae="N";break}for(Z=G+1,oe=T.length;Z<oe&&T[Z]==="ET";)Z++;ae=Z<oe&&T[Z]==="EN"?"EN":"N";break;case"NSM":if(l&&!c){for(oe=T.length,Z=G+1;Z<oe&&T[Z]==="NSM";)Z++;if(Z<oe){var pe=k[G],be=pe>=1425&&pe<=2303||pe===64286;if(de=T[Z],be&&(de==="R"||de==="AL")){ae="R";break}}}ae=G<1||(de=T[G-1])==="B"?"N":W[G-1];break;case"B":N=!1,s=!0,ae=_;break;case"S":o=!0,ae="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":N=!1;break;case"BN":ae="N"}return ae},L=function(k,T,W){var G=k.split("");return W&&E(G,W,{hiLevel:_}),G.reverse(),T&&T.reverse(),G.join("")},E=function(k,T,W){var G,de,J,Z,oe,ae=-1,pe=k.length,be=0,A=[],O=_?m:x,I=[];for(N=!1,s=!1,o=!1,de=0;de<pe;de++)I[de]=C(k[de]);for(J=0;J<pe;J++){if(oe=be,A[J]=D(k,I,A,J),G=240&(be=O[oe][y[A[J]]]),be&=15,T[J]=Z=O[be][5],G>0)if(G===16){for(de=ae;de<J;de++)T[de]=1;ae=-1}else ae=-1;if(O[be][6])ae===-1&&(ae=J);else if(ae>-1){for(de=ae;de<J;de++)T[de]=Z;ae=-1}I[J]==="B"&&(T[J]=0),W.hiLevel|=Z}o&&function(R,X,fe){for(var he=0;he<fe;he++)if(R[he]==="S"){X[he]=_;for(var ee=he-1;ee>=0&&R[ee]==="WS";ee--)X[ee]=_}}(I,T,pe)},P=function(k,T,W,G,de){if(!(de.hiLevel<k)){if(k===1&&_===1&&!s)return T.reverse(),void(W&&W.reverse());for(var J,Z,oe,ae,pe=T.length,be=0;be<pe;){if(G[be]>=k){for(oe=be+1;oe<pe&&G[oe]>=k;)oe++;for(ae=be,Z=oe-1;ae<Z;ae++,Z--)J=T[ae],T[ae]=T[Z],T[Z]=J,W&&(J=W[ae],W[ae]=W[Z],W[Z]=J);be=oe}be++}}},H=function(k,T,W){var G=k.split(""),de={hiLevel:_};return W||(W=[]),E(G,W,de),function(J,Z,oe){if(oe.hiLevel!==0&&u)for(var ae,pe=0;pe<J.length;pe++)Z[pe]===1&&(ae=j.indexOf(J[pe]))>=0&&(J[pe]=j[ae+1])}(G,W,de),P(2,G,T,W,de),P(1,G,T,W,de),G.join("")};return this.__bidiEngine__.doBidiReorder=function(k,T,W){if(function(de,J){if(J)for(var Z=0;Z<de.length;Z++)J[Z]=Z;c===void 0&&(c=M(de)),h===void 0&&(h=M(de))}(k,T),l||!d||h)if(l&&d&&c^h)_=c?1:0,k=L(k,T,W);else if(!l&&d&&h)_=c?1:0,k=H(k,T,W),k=L(k,T);else if(!l||c||d||h){if(l&&!d&&c^h)k=L(k,T),c?(_=0,k=H(k,T,W)):(_=1,k=H(k,T,W),k=L(k,T));else if(l&&c&&!d&&h)_=1,k=H(k,T,W),k=L(k,T);else if(!l&&!d&&c^h){var G=u;c?(_=1,k=H(k,T,W),_=0,u=!1,k=H(k,T,W),u=G):(_=0,k=H(k,T,W),k=L(k,T),_=1,u=!1,k=H(k,T,W),u=G,k=L(k,T))}}else _=0,k=H(k,T,W);else _=c?1:0,k=H(k,T,W);return k},this.__bidiEngine__.setOptions=function(k){k&&(l=k.isInputVisual,d=k.isOutputVisual,c=k.isInputRtl,h=k.isOutputRtl,u=k.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var r=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var s=n.text,o=(n.x,n.y,n.options||{}),l=(n.mutex,o.lang,[]);if(o.isInputVisual=typeof o.isInputVisual!="boolean"||o.isInputVisual,t.setOptions(o),Object.prototype.toString.call(s)==="[object Array]"){var c=0;for(l=[],c=0;c<s.length;c+=1)Object.prototype.toString.call(s[c])==="[object Array]"?l.push([t.doBidiReorder(s[c][0]),s[c][1],s[c][2]]):l.push([t.doBidiReorder(s[c])]);n.text=l}else n.text=t.doBidiReorder(s);t.setOptions({isInputVisual:!0})}])}(xt),xt.API.TTFFont=function(){function e(r){var t;if(this.rawData=r,t=this.contents=new ws(r),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new $x(this),this.registerTTF()}return e.open=function(r){return new e(r)},e.prototype.parse=function(){return this.directory=new Px(this.contents),this.head=new Ix(this),this.name=new Ux(this),this.cmap=new qh(this),this.toUnicode={},this.hhea=new Dx(this),this.maxp=new Hx(this),this.hmtx=new Wx(this),this.post=new Mx(this),this.os2=new Rx(this),this.loca=new Gx(this),this.glyf=new zx(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var r,t,n,s,o;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var l,c,d,h;for(h=[],l=0,c=(d=this.bbox).length;l<c;l++)r=d[l],h.push(Math.round(r*this.scaleFactor));return h}).call(this),this.stemV=0,this.post.exists?(n=255&(s=this.post.italic_angle),32768&(t=s>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(o=this.familyClass)===1||o===2||o===3||o===4||o===5||o===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(r){var t;return((t=this.cmap.unicode)!=null?t.codeMap[r]:void 0)||0},e.prototype.widthOfGlyph=function(r){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(r).advance*t},e.prototype.widthOfString=function(r,t,n){var s,o,l,c;for(l=0,o=0,c=(r=""+r).length;0<=c?o<c:o>c;o=0<=c?++o:--o)s=r.charCodeAt(o),l+=this.widthOfGlyph(this.characterToGlyph(s))+n*(1e3/t)||0;return l*(t/1e3)},e.prototype.lineHeight=function(r,t){var n;return t==null&&(t=!1),n=t?this.lineGap:0,(this.ascender+n-this.decender)/1e3*r},e}();var ga,ws=function(){function e(r){this.data=r??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(r){return this.data[this.pos++]=r},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(r){return this.writeByte(r>>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},e.prototype.readInt32=function(){var r;return(r=this.readUInt32())>=2147483648?r-4294967296:r},e.prototype.writeInt32=function(r){return r<0&&(r+=4294967296),this.writeUInt32(r)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(r){return this.writeByte(r>>8&255),this.writeByte(255&r)},e.prototype.readInt16=function(){var r;return(r=this.readUInt16())>=32768?r-65536:r},e.prototype.writeInt16=function(r){return r<0&&(r+=65536),this.writeUInt16(r)},e.prototype.readString=function(r){var t,n;for(n=[],t=0;0<=r?t<r:t>r;t=0<=r?++t:--t)n[t]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(r){var t,n,s;for(s=[],t=0,n=r.length;0<=n?t<n:t>n;t=0<=n?++t:--t)s.push(this.writeByte(r.charCodeAt(t)));return s},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(r){return this.writeInt16(r)},e.prototype.readLongLong=function(){var r,t,n,s,o,l,c,d;return r=this.readByte(),t=this.readByte(),n=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),d=this.readByte(),128&r?-1*(72057594037927940*(255^r)+281474976710656*(255^t)+1099511627776*(255^n)+4294967296*(255^s)+16777216*(255^o)+65536*(255^l)+256*(255^c)+(255^d)+1):72057594037927940*r+281474976710656*t+1099511627776*n+4294967296*s+16777216*o+65536*l+256*c+d},e.prototype.writeLongLong=function(r){var t,n;return t=Math.floor(r/4294967296),n=4294967295&r,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(r){return this.writeInt32(r)},e.prototype.read=function(r){var t,n;for(t=[],n=0;0<=r?n<r:n>r;n=0<=r?++n:--n)t.push(this.readByte());return t},e.prototype.write=function(r){var t,n,s,o;for(o=[],n=0,s=r.length;n<s;n++)t=r[n],o.push(this.writeByte(t));return o},e}(),Px=function(){var e;function r(t){var n,s,o;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},s=0,o=this.tableCount;0<=o?s<o:s>o;s=0<=o?++s:--s)n={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[n.tag]=n}return r.prototype.encode=function(t){var n,s,o,l,c,d,h,u,g,x,m,y,v;for(v in m=Object.keys(t).length,d=Math.log(2),g=16*Math.floor(Math.log(m)/d),l=Math.floor(g/d),u=16*m-g,(s=new ws).writeInt(this.scalarType),s.writeShort(m),s.writeShort(g),s.writeShort(l),s.writeShort(u),o=16*m,h=s.pos+o,c=null,y=[],t)for(x=t[v],s.writeString(v),s.writeInt(e(x)),s.writeInt(h),s.writeInt(x.length),y=y.concat(x),v==="head"&&(c=h),h+=x.length;h%4;)y.push(0),h++;return s.write(y),n=2981146554-e(s.data),s.pos=c+8,s.writeUInt32(n),s.data},e=function(t){var n,s,o,l;for(t=Vh.call(t);t.length%4;)t.push(0);for(o=new ws(t),s=0,n=0,l=t.length;n<l;n=n+=4)s+=o.readUInt32();return 4294967295&s},r}(),Ox={}.hasOwnProperty,La=function(e,r){for(var t in r)Ox.call(r,t)&&(e[t]=r[t]);function n(){this.constructor=e}return n.prototype=r.prototype,e.prototype=new n,e.__super__=r.prototype,e};ga=function(){function e(r){var t;this.file=r,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var Ix=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return La(r,ga),r.prototype.tag="head",r.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},r.prototype.encode=function(t){var n;return(n=new ws).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(t),n.writeShort(this.glyphDataFormat),n.data},r}(),Lf=function(){function e(r,t){var n,s,o,l,c,d,h,u,g,x,m,y,v,j,w,N,_;switch(this.platformID=r.readUInt16(),this.encodingID=r.readShort(),this.offset=t+r.readInt(),g=r.pos,r.pos=this.offset,this.format=r.readUInt16(),this.length=r.readUInt16(),this.language=r.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(d=0;d<256;++d)this.codeMap[d]=r.readByte();break;case 4:for(m=r.readUInt16(),x=m/2,r.pos+=6,o=function(){var C,M;for(M=[],d=C=0;0<=x?C<x:C>x;d=0<=x?++C:--C)M.push(r.readUInt16());return M}(),r.pos+=2,v=function(){var C,M;for(M=[],d=C=0;0<=x?C<x:C>x;d=0<=x?++C:--C)M.push(r.readUInt16());return M}(),h=function(){var C,M;for(M=[],d=C=0;0<=x?C<x:C>x;d=0<=x?++C:--C)M.push(r.readUInt16());return M}(),u=function(){var C,M;for(M=[],d=C=0;0<=x?C<x:C>x;d=0<=x?++C:--C)M.push(r.readUInt16());return M}(),s=(this.length-r.pos+this.offset)/2,c=function(){var C,M;for(M=[],d=C=0;0<=s?C<s:C>s;d=0<=s?++C:--C)M.push(r.readUInt16());return M}(),d=w=0,_=o.length;w<_;d=++w)for(j=o[d],n=N=y=v[d];y<=j?N<=j:N>=j;n=y<=j?++N:--N)u[d]===0?l=n+h[d]:(l=c[u[d]/2+(n-y)-(x-d)]||0)!==0&&(l+=h[d]),this.codeMap[n]=65535&l}r.pos=g}return e.encode=function(r,t){var n,s,o,l,c,d,h,u,g,x,m,y,v,j,w,N,_,C,M,D,L,E,P,H,k,T,W,G,de,J,Z,oe,ae,pe,be,A,O,I,R,X,fe,he,ee,ve,Ce,Ie;switch(G=new ws,l=Object.keys(r).sort(function(Ve,$e){return Ve-$e}),t){case"macroman":for(v=0,j=function(){var Ve=[];for(y=0;y<256;++y)Ve.push(0);return Ve}(),N={0:0},o={},de=0,ae=l.length;de<ae;de++)N[ee=r[s=l[de]]]==null&&(N[ee]=++v),o[s]={old:r[s],new:N[r[s]]},j[s]=N[r[s]];return G.writeUInt16(1),G.writeUInt16(0),G.writeUInt32(12),G.writeUInt16(0),G.writeUInt16(262),G.writeUInt16(0),G.write(j),{charMap:o,subtable:G.data,maxGlyphID:v+1};case"unicode":for(T=[],g=[],_=0,N={},n={},w=h=null,J=0,pe=l.length;J<pe;J++)N[M=r[s=l[J]]]==null&&(N[M]=++_),n[s]={old:M,new:N[M]},c=N[M]-s,w!=null&&c===h||(w&&g.push(w),T.push(s),h=c),w=s;for(w&&g.push(w),g.push(65535),T.push(65535),H=2*(P=T.length),E=2*Math.pow(Math.log(P)/Math.LN2,2),x=Math.log(E/2)/Math.LN2,L=2*P-E,d=[],D=[],m=[],y=Z=0,be=T.length;Z<be;y=++Z){if(k=T[y],u=g[y],k===65535){d.push(0),D.push(0);break}if(k-(W=n[k].new)>=32768)for(d.push(0),D.push(2*(m.length+P-y)),s=oe=k;k<=u?oe<=u:oe>=u;s=k<=u?++oe:--oe)m.push(n[s].new);else d.push(W-k),D.push(0)}for(G.writeUInt16(3),G.writeUInt16(1),G.writeUInt32(12),G.writeUInt16(4),G.writeUInt16(16+8*P+2*m.length),G.writeUInt16(0),G.writeUInt16(H),G.writeUInt16(E),G.writeUInt16(x),G.writeUInt16(L),fe=0,A=g.length;fe<A;fe++)s=g[fe],G.writeUInt16(s);for(G.writeUInt16(0),he=0,O=T.length;he<O;he++)s=T[he],G.writeUInt16(s);for(ve=0,I=d.length;ve<I;ve++)c=d[ve],G.writeUInt16(c);for(Ce=0,R=D.length;Ce<R;Ce++)C=D[Ce],G.writeUInt16(C);for(Ie=0,X=m.length;Ie<X;Ie++)v=m[Ie],G.writeUInt16(v);return{charMap:n,subtable:G.data,maxGlyphID:_+1}}},e}(),qh=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return La(r,ga),r.prototype.tag="cmap",r.prototype.parse=function(t){var n,s,o;for(t.pos=this.offset,this.version=t.readUInt16(),o=t.readUInt16(),this.tables=[],this.unicode=null,s=0;0<=o?s<o:s>o;s=0<=o?++s:--s)n=new Lf(t,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},r.encode=function(t,n){var s,o;return n==null&&(n="macroman"),s=Lf.encode(t,n),(o=new ws).writeUInt16(0),o.writeUInt16(1),s.table=o.data.concat(s.subtable),s},r}(),Dx=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return La(r,ga),r.prototype.tag="hhea",r.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},r}(),Rx=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return La(r,ga),r.prototype.tag="OS/2",r.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var n,s;for(s=[],n=0;n<10;++n)s.push(t.readByte());return s}(),this.charRange=function(){var n,s;for(s=[],n=0;n<4;++n)s.push(t.readInt());return s}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var n,s;for(s=[],n=0;n<2;n=++n)s.push(t.readInt());return s}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},r}(),Mx=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return La(r,ga),r.prototype.tag="post",r.prototype.parse=function(t){var n,s,o;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:break;case 131072:var l;for(s=t.readUInt16(),this.glyphNameIndex=[],l=0;0<=s?l<s:l>s;l=0<=s?++l:--l)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],o=[];t.pos<this.offset+this.length;)n=t.readByte(),o.push(this.names.push(t.readString(n)));return o;case 151552:return s=t.readUInt16(),this.offsets=t.read(s);case 196608:break;case 262144:return this.map=(function(){var c,d,h;for(h=[],l=c=0,d=this.file.maxp.numGlyphs;0<=d?c<d:c>d;l=0<=d?++c:--c)h.push(t.readUInt32());return h}).call(this)}},r}(),Bx=function(e,r){this.raw=e,this.length=e.length,this.platformID=r.platformID,this.encodingID=r.encodingID,this.languageID=r.languageID},Ux=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return La(r,ga),r.prototype.tag="name",r.prototype.parse=function(t){var n,s,o,l,c,d,h,u,g,x,m;for(t.pos=this.offset,t.readShort(),n=t.readShort(),d=t.readShort(),s=[],l=0;0<=n?l<n:l>n;l=0<=n?++l:--l)s.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+d+t.readShort()});for(h={},l=g=0,x=s.length;g<x;l=++g)o=s[l],t.pos=o.offset,u=t.readString(o.length),c=new Bx(u,o),h[m=o.nameID]==null&&(h[m]=[]),h[o.nameID].push(c);this.strings=h,this.copyright=h[0],this.fontFamily=h[1],this.fontSubfamily=h[2],this.uniqueSubfamily=h[3],this.fontName=h[4],this.version=h[5];try{this.postscriptName=h[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=h[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=h[7],this.manufacturer=h[8],this.designer=h[9],this.description=h[10],this.vendorUrl=h[11],this.designerUrl=h[12],this.license=h[13],this.licenseUrl=h[14],this.preferredFamily=h[15],this.preferredSubfamily=h[17],this.compatibleFull=h[18],this.sampleText=h[19]},r}(),Hx=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return La(r,ga),r.prototype.tag="maxp",r.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},r}(),Wx=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return La(r,ga),r.prototype.tag="hmtx",r.prototype.parse=function(t){var n,s,o,l,c,d,h;for(t.pos=this.offset,this.metrics=[],n=0,d=this.file.hhea.numberOfMetrics;0<=d?n<d:n>d;n=0<=d?++n:--n)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(o=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,g;for(g=[],n=u=0;0<=o?u<o:u>o;n=0<=o?++u:--u)g.push(t.readInt16());return g}(),this.widths=(function(){var u,g,x,m;for(m=[],u=0,g=(x=this.metrics).length;u<g;u++)l=x[u],m.push(l.advance);return m}).call(this),s=this.widths[this.widths.length-1],h=[],n=c=0;0<=o?c<o:c>o;n=0<=o?++c:--c)h.push(this.widths.push(s));return h},r.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},r}(),Vh=[].slice,zx=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return La(r,ga),r.prototype.tag="glyf",r.prototype.parse=function(){return this.cache={}},r.prototype.glyphFor=function(t){var n,s,o,l,c,d,h,u,g,x;return t in this.cache?this.cache[t]:(l=this.file.loca,n=this.file.contents,s=l.indexOf(t),(o=l.lengthOf(t))===0?this.cache[t]=null:(n.pos=this.offset+s,c=(d=new ws(n.read(o))).readShort(),u=d.readShort(),x=d.readShort(),h=d.readShort(),g=d.readShort(),this.cache[t]=c===-1?new Vx(d,u,x,h,g):new qx(d,c,u,x,h,g),this.cache[t]))},r.prototype.encode=function(t,n,s){var o,l,c,d,h;for(c=[],l=[],d=0,h=n.length;d<h;d++)o=t[n[d]],l.push(c.length),o&&(c=c.concat(o.encode(s)));return l.push(c.length),{table:c,offsets:l}},r}(),qx=function(){function e(r,t,n,s,o,l){this.raw=r,this.numberOfContours=t,this.xMin=n,this.yMin=s,this.xMax=o,this.yMax=l,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),Vx=function(){function e(r,t,n,s,o){var l,c;for(this.raw=r,this.xMin=t,this.yMin=n,this.xMax=s,this.yMax=o,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],l=this.raw;c=l.readShort(),this.glyphOffsets.push(l.pos),this.glyphIDs.push(l.readUInt16()),32&c;)l.pos+=1&c?4:2,128&c?l.pos+=8:64&c?l.pos+=4:8&c&&(l.pos+=2)}return e.prototype.encode=function(){var r,t,n;for(t=new ws(Vh.call(this.raw.data)),r=0,n=this.glyphIDs.length;r<n;++r)t.pos=this.glyphOffsets[r];return t.data},e}(),Gx=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return La(r,ga),r.prototype.tag="loca",r.prototype.parse=function(t){var n,s;return t.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var o,l;for(l=[],s=0,o=this.length;s<o;s+=2)l.push(2*t.readUInt16());return l}).call(this):(function(){var o,l;for(l=[],s=0,o=this.length;s<o;s+=4)l.push(t.readUInt32());return l}).call(this)},r.prototype.indexOf=function(t){return this.offsets[t]},r.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},r.prototype.encode=function(t,n){for(var s=new Uint32Array(this.offsets.length),o=0,l=0,c=0;c<s.length;++c)if(s[c]=o,l<n.length&&n[l]==c){++l,s[c]=o;var d=this.offsets[c],h=this.offsets[c+1]-d;h>0&&(o+=h)}for(var u=new Array(4*s.length),g=0;g<s.length;++g)u[4*g+3]=255&s[g],u[4*g+2]=(65280&s[g])>>8,u[4*g+1]=(16711680&s[g])>>16,u[4*g]=(4278190080&s[g])>>24;return u},r}(),$x=function(){function e(r){this.font=r,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var r,t,n,s,o;for(t in s=this.font.cmap.tables[0].codeMap,r={},o=this.subset)n=o[t],r[t]=s[n];return r},e.prototype.glyphsFor=function(r){var t,n,s,o,l,c,d;for(s={},l=0,c=r.length;l<c;l++)s[o=r[l]]=this.font.glyf.glyphFor(o);for(o in t=[],s)(n=s[o])!=null&&n.compound&&t.push.apply(t,n.glyphIDs);if(t.length>0)for(o in d=this.glyphsFor(t))n=d[o],s[o]=n;return s},e.prototype.encode=function(r,t){var n,s,o,l,c,d,h,u,g,x,m,y,v,j,w;for(s in n=qh.encode(this.generateCmap(),"unicode"),l=this.glyphsFor(r),m={0:0},w=n.charMap)m[(d=w[s]).old]=d.new;for(y in x=n.maxGlyphID,l)y in m||(m[y]=x++);return u=function(N){var _,C;for(_ in C={},N)C[N[_]]=_;return C}(m),g=Object.keys(u).sort(function(N,_){return N-_}),v=function(){var N,_,C;for(C=[],N=0,_=g.length;N<_;N++)c=g[N],C.push(u[c]);return C}(),o=this.font.glyf.encode(l,v,m),h=this.font.loca.encode(o.offsets,v),j={cmap:this.font.cmap.raw(),glyf:o.table,loca:h,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(j["OS/2"]=this.font.os2.raw()),this.font.directory.encode(j)},e}();xt.API.PDFObject=function(){var e;function r(){}return e=function(t,n){return(Array(n+1).join("0")+t).slice(-n)},r.convert=function(t){var n,s,o,l;if(Array.isArray(t))return"["+function(){var c,d,h;for(h=[],c=0,d=t.length;c<d;c++)n=t[c],h.push(r.convert(n));return h}().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t!=null&&t.isString)return"("+t+")";if(t instanceof Date)return"(D:"+e(t.getUTCFullYear(),4)+e(t.getUTCMonth(),2)+e(t.getUTCDate(),2)+e(t.getUTCHours(),2)+e(t.getUTCMinutes(),2)+e(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(s in o=["<<"],t)l=t[s],o.push("/"+s+" "+r.convert(l));return o.push(">>"),o.join(`
`)}return""+t},r}();const Yx=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:_x,AcroFormAppearance:ct,AcroFormButton:Dr,AcroFormCheckBox:_o,AcroFormChoiceField:Bs,AcroFormComboBox:Hs,AcroFormEditBox:jo,AcroFormListBox:Us,AcroFormPasswordField:Ao,AcroFormPushButton:So,AcroFormRadioButton:Ws,AcroFormTextField:ys,GState:Oo,ShadingPattern:ps,TilingPattern:Ms,default:xt,jsPDF:xt},Symbol.toStringTag,{value:"Module"}));var Xx={exports:{}};const Kx=dm(Yx);/*!
 * 
 *               jsPDF AutoTable plugin v3.8.4
 *
 *               Copyright (c) 2024 Simon Bengtsson, https://github.com/simonbengtsson/jsPDF-AutoTable
 *               Licensed under the MIT License.
 *               http://opensource.org/licenses/mit-license
 *
 */(function(e,r){(function(n,s){e.exports=s(function(){try{return Kx}catch{}}())})(typeof globalThis<"u"?globalThis:typeof c0<"u"?c0:typeof window<"u"?window:typeof self<"u"?self:c0,function(t){return function(){var n={172:function(c,d){var h=this&&this.__extends||function(){var x=function(m,y){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,j){v.__proto__=j}||function(v,j){for(var w in j)Object.prototype.hasOwnProperty.call(j,w)&&(v[w]=j[w])},x(m,y)};return function(m,y){if(typeof y!="function"&&y!==null)throw new TypeError("Class extends value "+String(y)+" is not a constructor or null");x(m,y);function v(){this.constructor=m}m.prototype=y===null?Object.create(y):(v.prototype=y.prototype,new v)}}();Object.defineProperty(d,"__esModule",{value:!0}),d.CellHookData=d.HookData=void 0;var u=function(){function x(m,y,v){this.table=y,this.pageNumber=y.pageNumber,this.pageCount=this.pageNumber,this.settings=y.settings,this.cursor=v,this.doc=m.getDocument()}return x}();d.HookData=u;var g=function(x){h(m,x);function m(y,v,j,w,N,_){var C=x.call(this,y,v,_)||this;return C.cell=j,C.row=w,C.column=N,C.section=w.section,C}return m}(u);d.CellHookData=g},340:function(c,d,h){Object.defineProperty(d,"__esModule",{value:!0});var u=h(4),g=h(136),x=h(744),m=h(776),y=h(664),v=h(972);function j(w){w.API.autoTable=function(){for(var N=[],_=0;_<arguments.length;_++)N[_]=arguments[_];var C;N.length===1?C=N[0]:(console.error("Use of deprecated autoTable initiation"),C=N[2]||{},C.columns=N[0],C.body=N[1]);var M=(0,m.parseInput)(this,C),D=(0,v.createTable)(this,M);return(0,y.drawTable)(this,D),this},w.API.lastAutoTable=!1,w.API.previousAutoTable=!1,w.API.autoTable.previous=!1,w.API.autoTableText=function(N,_,C,M){(0,g.default)(N,_,C,M,this)},w.API.autoTableSetDefaults=function(N){return x.DocHandler.setDefaults(N,this),this},w.autoTableSetDefaults=function(N,_){x.DocHandler.setDefaults(N,_)},w.API.autoTableHtmlToJson=function(N,_){var C;if(_===void 0&&(_=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var M=new x.DocHandler(this),D=(0,u.parseHtml)(M,N,window,_,!1),L=D.head,E=D.body,P=((C=L[0])===null||C===void 0?void 0:C.map(function(H){return H.content}))||[];return{columns:P,rows:E,data:E}},w.API.autoTableEndPosY=function(){console.error("Use of deprecated function: autoTableEndPosY. Use doc.lastAutoTable.finalY instead.");var N=this.lastAutoTable;return N&&N.finalY?N.finalY:0},w.API.autoTableAddPageContent=function(N){return console.error("Use of deprecated function: autoTableAddPageContent. Use jsPDF.autoTableSetDefaults({didDrawPage: () => {}}) instead."),w.API.autoTable.globalDefaults||(w.API.autoTable.globalDefaults={}),w.API.autoTable.globalDefaults.addPageContent=N,this},w.API.autoTableAddPage=function(){return console.error("Use of deprecated function: autoTableAddPage. Use doc.addPage()"),this.addPage(),this}}d.default=j},136:function(c,d){Object.defineProperty(d,"__esModule",{value:!0});function h(u,g,x,m,y){m=m||{};var v=1.15,j=y.internal.scaleFactor,w=y.internal.getFontSize()/j,N=y.getLineHeightFactor?y.getLineHeightFactor():v,_=w*N,C=/\r\n|\r|\n/g,M="",D=1;if((m.valign==="middle"||m.valign==="bottom"||m.halign==="center"||m.halign==="right")&&(M=typeof u=="string"?u.split(C):u,D=M.length||1),x+=w*(2-v),m.valign==="middle"?x-=D/2*_:m.valign==="bottom"&&(x-=D*_),m.halign==="center"||m.halign==="right"){var L=w;if(m.halign==="center"&&(L*=.5),M&&D>=1){for(var E=0;E<M.length;E++)y.text(M[E],g-y.getStringUnitWidth(M[E])*L,x),x+=_;return y}g-=y.getStringUnitWidth(u)*L}return m.halign==="justify"?y.text(u,g,x,{maxWidth:m.maxWidth||100,align:"justify"}):y.text(u,g,x),y}d.default=h},420:function(c,d){Object.defineProperty(d,"__esModule",{value:!0}),d.getPageAvailableWidth=d.parseSpacing=d.getFillStyle=d.addTableBorder=d.getStringWidth=void 0;function h(y,v,j){j.applyStyles(v,!0);var w=Array.isArray(y)?y:[y],N=w.map(function(_){return j.getTextWidth(_)}).reduce(function(_,C){return Math.max(_,C)},0);return N}d.getStringWidth=h;function u(y,v,j,w){var N=v.settings.tableLineWidth,_=v.settings.tableLineColor;y.applyStyles({lineWidth:N,lineColor:_});var C=g(N,!1);C&&y.rect(j.x,j.y,v.getWidth(y.pageSize().width),w.y-j.y,C)}d.addTableBorder=u;function g(y,v){var j=y>0,w=v||v===0;return j&&w?"DF":j?"S":w?"F":null}d.getFillStyle=g;function x(y,v){var j,w,N,_;if(y=y||v,Array.isArray(y)){if(y.length>=4)return{top:y[0],right:y[1],bottom:y[2],left:y[3]};if(y.length===3)return{top:y[0],right:y[1],bottom:y[2],left:y[1]};if(y.length===2)return{top:y[0],right:y[1],bottom:y[0],left:y[1]};y.length===1?y=y[0]:y=v}return typeof y=="object"?(typeof y.vertical=="number"&&(y.top=y.vertical,y.bottom=y.vertical),typeof y.horizontal=="number"&&(y.right=y.horizontal,y.left=y.horizontal),{left:(j=y.left)!==null&&j!==void 0?j:v,top:(w=y.top)!==null&&w!==void 0?w:v,right:(N=y.right)!==null&&N!==void 0?N:v,bottom:(_=y.bottom)!==null&&_!==void 0?_:v}):(typeof y!="number"&&(y=v),{top:y,right:y,bottom:y,left:y})}d.parseSpacing=x;function m(y,v){var j=x(v.settings.margin,0);return y.pageSize().width-(j.left+j.right)}d.getPageAvailableWidth=m},796:function(c,d){var h=this&&this.__extends||function(){var m=function(y,v){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(j,w){j.__proto__=w}||function(j,w){for(var N in w)Object.prototype.hasOwnProperty.call(w,N)&&(j[N]=w[N])},m(y,v)};return function(y,v){if(typeof v!="function"&&v!==null)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");m(y,v);function j(){this.constructor=y}y.prototype=v===null?Object.create(v):(j.prototype=v.prototype,new j)}}();Object.defineProperty(d,"__esModule",{value:!0}),d.getTheme=d.defaultStyles=d.HtmlRowInput=void 0;var u=function(m){h(y,m);function y(v){var j=m.call(this)||this;return j._element=v,j}return y}(Array);d.HtmlRowInput=u;function g(m){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/m,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}d.defaultStyles=g;function x(m){var y={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return y[m]}d.getTheme=x},903:function(c,d,h){Object.defineProperty(d,"__esModule",{value:!0}),d.parseCss=void 0;var u=h(420);function g(j,w,N,_,C){var M={},D=1.3333333333333333,L=m(w,function(ae){return C.getComputedStyle(ae).backgroundColor});L!=null&&(M.fillColor=L);var E=m(w,function(ae){return C.getComputedStyle(ae).color});E!=null&&(M.textColor=E);var P=v(_,N);P&&(M.cellPadding=P);var H="borderTopColor",k=D*N,T=_.borderTopWidth;if(_.borderBottomWidth===T&&_.borderRightWidth===T&&_.borderLeftWidth===T){var W=(parseFloat(T)||0)/k;W&&(M.lineWidth=W)}else M.lineWidth={top:(parseFloat(_.borderTopWidth)||0)/k,right:(parseFloat(_.borderRightWidth)||0)/k,bottom:(parseFloat(_.borderBottomWidth)||0)/k,left:(parseFloat(_.borderLeftWidth)||0)/k},M.lineWidth.top||(M.lineWidth.right?H="borderRightColor":M.lineWidth.bottom?H="borderBottomColor":M.lineWidth.left&&(H="borderLeftColor"));var G=m(w,function(ae){return C.getComputedStyle(ae)[H]});G!=null&&(M.lineColor=G);var de=["left","right","center","justify"];de.indexOf(_.textAlign)!==-1&&(M.halign=_.textAlign),de=["middle","bottom","top"],de.indexOf(_.verticalAlign)!==-1&&(M.valign=_.verticalAlign);var J=parseInt(_.fontSize||"");isNaN(J)||(M.fontSize=J/D);var Z=x(_);Z&&(M.fontStyle=Z);var oe=(_.fontFamily||"").toLowerCase();return j.indexOf(oe)!==-1&&(M.font=oe),M}d.parseCss=g;function x(j){var w="";return(j.fontWeight==="bold"||j.fontWeight==="bolder"||parseInt(j.fontWeight)>=700)&&(w="bold"),(j.fontStyle==="italic"||j.fontStyle==="oblique")&&(w+="italic"),w}function m(j,w){var N=y(j,w);if(!N)return null;var _=N.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!_||!Array.isArray(_))return null;var C=[parseInt(_[1]),parseInt(_[2]),parseInt(_[3])],M=parseInt(_[4]);return M===0||isNaN(C[0])||isNaN(C[1])||isNaN(C[2])?null:C}function y(j,w){var N=w(j);return N==="rgba(0, 0, 0, 0)"||N==="transparent"||N==="initial"||N==="inherit"?j.parentElement==null?null:y(j.parentElement,w):N}function v(j,w){var N=[j.paddingTop,j.paddingRight,j.paddingBottom,j.paddingLeft],_=96/(72/w),C=(parseInt(j.lineHeight)-parseInt(j.fontSize))/w/2,M=N.map(function(L){return parseInt(L||"0")/_}),D=(0,u.parseSpacing)(M,0);return C>D.top&&(D.top=C),C>D.bottom&&(D.bottom=C),D}},744:function(c,d){Object.defineProperty(d,"__esModule",{value:!0}),d.DocHandler=void 0;var h={},u=function(){function g(x){this.jsPDFDocument=x,this.userStyles={textColor:x.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:x.internal.getFontSize(),fontStyle:x.internal.getFont().fontStyle,font:x.internal.getFont().fontName,lineWidth:x.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:x.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return g.setDefaults=function(x,m){m===void 0&&(m=null),m?m.__autoTableDocumentDefaults=x:h=x},g.unifyColor=function(x){return Array.isArray(x)?x:typeof x=="number"?[x,x,x]:typeof x=="string"?[x]:null},g.prototype.applyStyles=function(x,m){var y,v,j;m===void 0&&(m=!1),x.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(x.fontStyle);var w=this.jsPDFDocument.internal.getFont(),N=w.fontStyle,_=w.fontName;if(x.font&&(_=x.font),x.fontStyle){N=x.fontStyle;var C=this.getFontList()[_];C&&C.indexOf(N)===-1&&(this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(C[0]),N=C[0])}if(this.jsPDFDocument.setFont(_,N),x.fontSize&&this.jsPDFDocument.setFontSize(x.fontSize),!m){var M=g.unifyColor(x.fillColor);M&&(y=this.jsPDFDocument).setFillColor.apply(y,M),M=g.unifyColor(x.textColor),M&&(v=this.jsPDFDocument).setTextColor.apply(v,M),M=g.unifyColor(x.lineColor),M&&(j=this.jsPDFDocument).setDrawColor.apply(j,M),typeof x.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(x.lineWidth)}},g.prototype.splitTextToSize=function(x,m,y){return this.jsPDFDocument.splitTextToSize(x,m,y)},g.prototype.rect=function(x,m,y,v,j){return this.jsPDFDocument.rect(x,m,y,v,j)},g.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},g.prototype.getTextWidth=function(x){return this.jsPDFDocument.getTextWidth(x)},g.prototype.getDocument=function(){return this.jsPDFDocument},g.prototype.setPage=function(x){this.jsPDFDocument.setPage(x)},g.prototype.addPage=function(){return this.jsPDFDocument.addPage()},g.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},g.prototype.getGlobalOptions=function(){return h||{}},g.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},g.prototype.pageSize=function(){var x=this.jsPDFDocument.internal.pageSize;return x.width==null&&(x={width:x.getWidth(),height:x.getHeight()}),x},g.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},g.prototype.getLineHeightFactor=function(){var x=this.jsPDFDocument;return x.getLineHeightFactor?x.getLineHeightFactor():1.15},g.prototype.getLineHeight=function(x){return x/this.scaleFactor()*this.getLineHeightFactor()},g.prototype.pageNumber=function(){var x=this.jsPDFDocument.internal.getCurrentPageInfo();return x?x.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},g}();d.DocHandler=u},4:function(c,d,h){Object.defineProperty(d,"__esModule",{value:!0}),d.parseHtml=void 0;var u=h(903),g=h(796);function x(v,j,w,N,_){var C,M;N===void 0&&(N=!1),_===void 0&&(_=!1);var D;typeof j=="string"?D=w.document.querySelector(j):D=j;var L=Object.keys(v.getFontList()),E=v.scaleFactor(),P=[],H=[],k=[];if(!D)return console.error("Html table could not be found with input: ",j),{head:P,body:H,foot:k};for(var T=0;T<D.rows.length;T++){var W=D.rows[T],G=(M=(C=W==null?void 0:W.parentElement)===null||C===void 0?void 0:C.tagName)===null||M===void 0?void 0:M.toLowerCase(),de=m(L,E,w,W,N,_);de&&(G==="thead"?P.push(de):G==="tfoot"?k.push(de):H.push(de))}return{head:P,body:H,foot:k}}d.parseHtml=x;function m(v,j,w,N,_,C){for(var M=new g.HtmlRowInput(N),D=0;D<N.cells.length;D++){var L=N.cells[D],E=w.getComputedStyle(L);if(_||E.display!=="none"){var P=void 0;C&&(P=(0,u.parseCss)(v,L,j,E,w)),M.push({rowSpan:L.rowSpan,colSpan:L.colSpan,styles:P,_element:L,content:y(L)})}}var H=w.getComputedStyle(N);if(M.length>0&&(_||H.display!=="none"))return M}function y(v){var j=v.cloneNode(!0);return j.innerHTML=j.innerHTML.replace(/\n/g,"").replace(/ +/g," "),j.innerHTML=j.innerHTML.split(/<br.*?>/).map(function(w){return w.trim()}).join(`
`),j.innerText||j.textContent||""}},776:function(c,d,h){Object.defineProperty(d,"__esModule",{value:!0}),d.parseInput=void 0;var u=h(4),g=h(356),x=h(420),m=h(744),y=h(792);function v(D,L){var E=new m.DocHandler(D),P=E.getDocumentOptions(),H=E.getGlobalOptions();(0,y.default)(E,H,P,L);var k=(0,g.assign)({},H,P,L),T;typeof window<"u"&&(T=window);var W=j(H,P,L),G=w(H,P,L),de=N(E,k),J=C(E,k,T);return{id:L.tableId,content:J,hooks:G,styles:W,settings:de}}d.parseInput=v;function j(D,L,E){for(var P={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},H=function(G){if(G==="columnStyles"){var de=D[G],J=L[G],Z=E[G];P.columnStyles=(0,g.assign)({},de,J,Z)}else{var oe=[D,L,E],ae=oe.map(function(pe){return pe[G]||{}});P[G]=(0,g.assign)({},ae[0],ae[1],ae[2])}},k=0,T=Object.keys(P);k<T.length;k++){var W=T[k];H(W)}return P}function w(D,L,E){for(var P=[D,L,E],H={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},k=0,T=P;k<T.length;k++){var W=T[k];W.didParseCell&&H.didParseCell.push(W.didParseCell),W.willDrawCell&&H.willDrawCell.push(W.willDrawCell),W.didDrawCell&&H.didDrawCell.push(W.didDrawCell),W.willDrawPage&&H.willDrawPage.push(W.willDrawPage),W.didDrawPage&&H.didDrawPage.push(W.didDrawPage)}return H}function N(D,L){var E,P,H,k,T,W,G,de,J,Z,oe,ae,pe=(0,x.parseSpacing)(L.margin,40/D.scaleFactor()),be=(E=_(D,L.startY))!==null&&E!==void 0?E:pe.top,A;L.showFoot===!0?A="everyPage":L.showFoot===!1?A="never":A=(P=L.showFoot)!==null&&P!==void 0?P:"everyPage";var O;L.showHead===!0?O="everyPage":L.showHead===!1?O="never":O=(H=L.showHead)!==null&&H!==void 0?H:"everyPage";var I=(k=L.useCss)!==null&&k!==void 0?k:!1,R=L.theme||(I?"plain":"striped"),X=!!L.horizontalPageBreak,fe=(T=L.horizontalPageBreakRepeat)!==null&&T!==void 0?T:null;return{includeHiddenHtml:(W=L.includeHiddenHtml)!==null&&W!==void 0?W:!1,useCss:I,theme:R,startY:be,margin:pe,pageBreak:(G=L.pageBreak)!==null&&G!==void 0?G:"auto",rowPageBreak:(de=L.rowPageBreak)!==null&&de!==void 0?de:"auto",tableWidth:(J=L.tableWidth)!==null&&J!==void 0?J:"auto",showHead:O,showFoot:A,tableLineWidth:(Z=L.tableLineWidth)!==null&&Z!==void 0?Z:0,tableLineColor:(oe=L.tableLineColor)!==null&&oe!==void 0?oe:200,horizontalPageBreak:X,horizontalPageBreakRepeat:fe,horizontalPageBreakBehaviour:(ae=L.horizontalPageBreakBehaviour)!==null&&ae!==void 0?ae:"afterAllRows"}}function _(D,L){var E=D.getLastAutoTable(),P=D.scaleFactor(),H=D.pageNumber(),k=!1;if(E&&E.startPageNumber){var T=E.startPageNumber+E.pageNumber-1;k=T===H}return typeof L=="number"?L:(L==null||L===!1)&&k&&(E==null?void 0:E.finalY)!=null?E.finalY+20/P:null}function C(D,L,E){var P=L.head||[],H=L.body||[],k=L.foot||[];if(L.html){var T=L.includeHiddenHtml;if(E){var W=(0,u.parseHtml)(D,L.html,E,T,L.useCss)||{};P=W.head||P,H=W.body||P,k=W.foot||P}else console.error("Cannot parse html in non browser environment")}var G=L.columns||M(P,H,k);return{columns:G,head:P,body:H,foot:k}}function M(D,L,E){var P=D[0]||L[0]||E[0]||[],H=[];return Object.keys(P).filter(function(k){return k!=="_element"}).forEach(function(k){var T=1,W;Array.isArray(P)?W=P[parseInt(k)]:W=P[k],typeof W=="object"&&!Array.isArray(W)&&(T=(W==null?void 0:W.colSpan)||1);for(var G=0;G<T;G++){var de=void 0;Array.isArray(P)?de=H.length:de=k+(G>0?"_".concat(G):"");var J={dataKey:de};H.push(J)}}),H}},792:function(c,d){Object.defineProperty(d,"__esModule",{value:!0});function h(g,x,m,y){for(var v=function(_){_&&typeof _!="object"&&console.error("The options parameter should be of type object, is: "+typeof _),typeof _.extendWidth<"u"&&(_.tableWidth=_.extendWidth?"auto":"wrap",console.error("Use of deprecated option: extendWidth, use tableWidth instead.")),typeof _.margins<"u"&&(typeof _.margin>"u"&&(_.margin=_.margins),console.error("Use of deprecated option: margins, use margin instead.")),_.startY&&typeof _.startY!="number"&&(console.error("Invalid value for startY option",_.startY),delete _.startY),!_.didDrawPage&&(_.afterPageContent||_.beforePageContent||_.afterPageAdd)&&(console.error("The afterPageContent, beforePageContent and afterPageAdd hooks are deprecated. Use didDrawPage instead"),_.didDrawPage=function(k){g.applyStyles(g.userStyles),_.beforePageContent&&_.beforePageContent(k),g.applyStyles(g.userStyles),_.afterPageContent&&_.afterPageContent(k),g.applyStyles(g.userStyles),_.afterPageAdd&&k.pageNumber>1&&k.afterPageAdd(k),g.applyStyles(g.userStyles)}),["createdHeaderCell","drawHeaderRow","drawRow","drawHeaderCell"].forEach(function(k){_[k]&&console.error('The "'.concat(k,'" hook has changed in version 3.0, check the changelog for how to migrate.'))}),[["showFoot","showFooter"],["showHead","showHeader"],["didDrawPage","addPageContent"],["didParseCell","createdCell"],["headStyles","headerStyles"]].forEach(function(k){var T=k[0],W=k[1];_[W]&&(console.error("Use of deprecated option ".concat(W,". Use ").concat(T," instead")),_[T]=_[W])}),[["padding","cellPadding"],["lineHeight","rowHeight"],"fontSize","overflow"].forEach(function(k){var T=typeof k=="string"?k:k[0],W=typeof k=="string"?k:k[1];typeof _[T]<"u"&&(typeof _.styles[W]>"u"&&(_.styles[W]=_[T]),console.error("Use of deprecated option: "+T+", use the style "+W+" instead."))});for(var C=0,M=["styles","bodyStyles","headStyles","footStyles"];C<M.length;C++){var D=M[C];u(_[D]||{})}for(var L=_.columnStyles||{},E=0,P=Object.keys(L);E<P.length;E++){var H=P[E];u(L[H]||{})}},j=0,w=[x,m,y];j<w.length;j++){var N=w[j];v(N)}}d.default=h;function u(g){g.rowHeight?(console.error("Use of deprecated style rowHeight. It is renamed to minCellHeight."),g.minCellHeight||(g.minCellHeight=g.rowHeight)):g.columnWidth&&(console.error("Use of deprecated style columnWidth. It is renamed to cellWidth."),g.cellWidth||(g.cellWidth=g.columnWidth))}},260:function(c,d,h){Object.defineProperty(d,"__esModule",{value:!0}),d.Column=d.Cell=d.Row=d.Table=void 0;var u=h(796),g=h(172),x=h(420),m=function(){function w(N,_){this.pageNumber=1,this.pageCount=1,this.id=N.id,this.settings=N.settings,this.styles=N.styles,this.hooks=N.hooks,this.columns=_.columns,this.head=_.head,this.body=_.body,this.foot=_.foot}return w.prototype.getHeadHeight=function(N){return this.head.reduce(function(_,C){return _+C.getMaxCellHeight(N)},0)},w.prototype.getFootHeight=function(N){return this.foot.reduce(function(_,C){return _+C.getMaxCellHeight(N)},0)},w.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},w.prototype.callCellHooks=function(N,_,C,M,D,L){for(var E=0,P=_;E<P.length;E++){var H=P[E],k=new g.CellHookData(N,this,C,M,D,L),T=H(k)===!1;if(C.text=Array.isArray(C.text)?C.text:[C.text],T)return!1}return!0},w.prototype.callEndPageHooks=function(N,_){N.applyStyles(N.userStyles);for(var C=0,M=this.hooks.didDrawPage;C<M.length;C++){var D=M[C];D(new g.HookData(N,this,_))}},w.prototype.callWillDrawPageHooks=function(N,_){for(var C=0,M=this.hooks.willDrawPage;C<M.length;C++){var D=M[C];D(new g.HookData(N,this,_))}},w.prototype.getWidth=function(N){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var _=this.columns.reduce(function(M,D){return M+D.wrappedWidth},0);return _}else{var C=this.settings.margin;return N-C.left-C.right}},w}();d.Table=m;var y=function(){function w(N,_,C,M,D){D===void 0&&(D=!1),this.height=0,this.raw=N,N instanceof u.HtmlRowInput&&(this.raw=N._element,this.element=N._element),this.index=_,this.section=C,this.cells=M,this.spansMultiplePages=D}return w.prototype.getMaxCellHeight=function(N){var _=this;return N.reduce(function(C,M){var D;return Math.max(C,((D=_.cells[M.index])===null||D===void 0?void 0:D.height)||0)},0)},w.prototype.hasRowSpan=function(N){var _=this;return N.filter(function(C){var M=_.cells[C.index];return M?M.rowSpan>1:!1}).length>0},w.prototype.canEntireRowFit=function(N,_){return this.getMaxCellHeight(_)<=N},w.prototype.getMinimumRowHeight=function(N,_){var C=this;return N.reduce(function(M,D){var L=C.cells[D.index];if(!L)return 0;var E=_.getLineHeight(L.styles.fontSize),P=L.padding("vertical"),H=P+E;return H>M?H:M},0)},w}();d.Row=y;var v=function(){function w(N,_,C){var M,D;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=_,this.section=C,this.raw=N;var L=N;N!=null&&typeof N=="object"&&!Array.isArray(N)?(this.rowSpan=N.rowSpan||1,this.colSpan=N.colSpan||1,L=(D=(M=N.content)!==null&&M!==void 0?M:N.title)!==null&&D!==void 0?D:N,N._element&&(this.raw=N._element)):(this.rowSpan=1,this.colSpan=1);var E=L!=null?""+L:"",P=/\r\n|\r|\n/g;this.text=E.split(P)}return w.prototype.getTextPos=function(){var N;if(this.styles.valign==="top")N=this.y+this.padding("top");else if(this.styles.valign==="bottom")N=this.y+this.height-this.padding("bottom");else{var _=this.height-this.padding("vertical");N=this.y+_/2+this.padding("top")}var C;if(this.styles.halign==="right")C=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var M=this.width-this.padding("horizontal");C=this.x+M/2+this.padding("left")}else C=this.x+this.padding("left");return{x:C,y:N}},w.prototype.getContentHeight=function(N,_){_===void 0&&(_=1.15);var C=Array.isArray(this.text)?this.text.length:1,M=this.styles.fontSize/N*_,D=C*M+this.padding("vertical");return Math.max(D,this.styles.minCellHeight)},w.prototype.padding=function(N){var _=(0,x.parseSpacing)(this.styles.cellPadding,0);return N==="vertical"?_.top+_.bottom:N==="horizontal"?_.left+_.right:_[N]},w}();d.Cell=v;var j=function(){function w(N,_,C){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=N,this.raw=_,this.index=C}return w.prototype.getMaxCustomCellWidth=function(N){for(var _=0,C=0,M=N.allRows();C<M.length;C++){var D=M[C],L=D.cells[this.index];L&&typeof L.styles.cellWidth=="number"&&(_=Math.max(_,L.styles.cellWidth))}return _},w}();d.Column=j},356:function(c,d){Object.defineProperty(d,"__esModule",{value:!0}),d.assign=void 0;function h(u,g,x,m,y){if(u==null)throw new TypeError("Cannot convert undefined or null to object");for(var v=Object(u),j=1;j<arguments.length;j++){var w=arguments[j];if(w!=null)for(var N in w)Object.prototype.hasOwnProperty.call(w,N)&&(v[N]=w[N])}return v}d.assign=h},972:function(c,d,h){Object.defineProperty(d,"__esModule",{value:!0}),d.createTable=void 0;var u=h(744),g=h(260),x=h(324),m=h(796),y=h(356);function v(D,L){var E=new u.DocHandler(D),P=j(L,E.scaleFactor()),H=new g.Table(L,P);return(0,x.calculateWidths)(E,H),E.applyStyles(E.userStyles),H}d.createTable=v;function j(D,L){var E=D.content,P=C(E.columns);if(E.head.length===0){var H=N(P,"head");H&&E.head.push(H)}if(E.foot.length===0){var H=N(P,"foot");H&&E.foot.push(H)}var k=D.settings.theme,T=D.styles;return{columns:P,head:w("head",E.head,P,T,k,L),body:w("body",E.body,P,T,k,L),foot:w("foot",E.foot,P,T,k,L)}}function w(D,L,E,P,H,k){var T={},W=L.map(function(G,de){for(var J=0,Z={},oe=0,ae=0,pe=0,be=E;pe<be.length;pe++){var A=be[pe];if(T[A.index]==null||T[A.index].left===0)if(ae===0){var O=void 0;Array.isArray(G)?O=G[A.index-oe-J]:O=G[A.dataKey];var I={};typeof O=="object"&&!Array.isArray(O)&&(I=(O==null?void 0:O.styles)||{});var R=M(D,A,de,H,P,k,I),X=new g.Cell(O,R,D);Z[A.dataKey]=X,Z[A.index]=X,ae=X.colSpan-1,T[A.index]={left:X.rowSpan-1,times:ae}}else ae--,oe++;else T[A.index].left--,ae=T[A.index].times,J++}return new g.Row(G,de,D,Z)});return W}function N(D,L){var E={};return D.forEach(function(P){if(P.raw!=null){var H=_(L,P.raw);H!=null&&(E[P.dataKey]=H)}}),Object.keys(E).length>0?E:null}function _(D,L){if(D==="head"){if(typeof L=="object")return L.header||L.title||null;if(typeof L=="string"||typeof L=="number")return L}else if(D==="foot"&&typeof L=="object")return L.footer;return null}function C(D){return D.map(function(L,E){var P,H,k;return typeof L=="object"?k=(H=(P=L.dataKey)!==null&&P!==void 0?P:L.key)!==null&&H!==void 0?H:E:k=E,new g.Column(k,L,E)})}function M(D,L,E,P,H,k,T){var W=(0,m.getTheme)(P),G;D==="head"?G=H.headStyles:D==="body"?G=H.bodyStyles:D==="foot"&&(G=H.footStyles);var de=(0,y.assign)({},W.table,W[D],H.styles,G),J=H.columnStyles[L.dataKey]||H.columnStyles[L.index]||{},Z=D==="body"?J:{},oe=D==="body"&&E%2===0?(0,y.assign)({},W.alternateRow,H.alternateRowStyles):{},ae=(0,m.defaultStyles)(k),pe=(0,y.assign)({},ae,de,oe,Z);return(0,y.assign)(pe,T)}},664:function(c,d,h){Object.defineProperty(d,"__esModule",{value:!0}),d.addPage=d.drawTable=void 0;var u=h(420),g=h(260),x=h(744),m=h(356),y=h(136),v=h(224);function j(J,Z){var oe=Z.settings,ae=oe.startY,pe=oe.margin,be={x:pe.left,y:ae},A=Z.getHeadHeight(Z.columns)+Z.getFootHeight(Z.columns),O=ae+pe.bottom+A;if(oe.pageBreak==="avoid"){var I=Z.body,R=I.reduce(function(he,ee){return he+ee.height},0);O+=R}var X=new x.DocHandler(J);(oe.pageBreak==="always"||oe.startY!=null&&O>X.pageSize().height)&&(de(X),be.y=pe.top),Z.callWillDrawPageHooks(X,be);var fe=(0,m.assign)({},be);Z.startPageNumber=X.pageNumber(),oe.horizontalPageBreak?w(X,Z,fe,be):(X.applyStyles(X.userStyles),(oe.showHead==="firstPage"||oe.showHead==="everyPage")&&Z.head.forEach(function(he){return H(X,Z,he,be,Z.columns)}),X.applyStyles(X.userStyles),Z.body.forEach(function(he,ee){var ve=ee===Z.body.length-1;P(X,Z,he,ve,fe,be,Z.columns)}),X.applyStyles(X.userStyles),(oe.showFoot==="lastPage"||oe.showFoot==="everyPage")&&Z.foot.forEach(function(he){return H(X,Z,he,be,Z.columns)})),(0,u.addTableBorder)(X,Z,fe,be),Z.callEndPageHooks(X,be),Z.finalY=be.y,J.lastAutoTable=Z,J.previousAutoTable=Z,J.autoTable&&(J.autoTable.previous=Z),X.applyStyles(X.userStyles)}d.drawTable=j;function w(J,Z,oe,ae){var pe=(0,v.calculateAllColumnsCanFitInPage)(J,Z),be=Z.settings;if(be.horizontalPageBreakBehaviour==="afterAllRows")pe.forEach(function(R,X){J.applyStyles(J.userStyles),X>0?G(J,Z,oe,ae,R.columns,!0):N(J,Z,ae,R.columns),_(J,Z,oe,ae,R.columns),M(J,Z,ae,R.columns)});else for(var A=-1,O=pe[0],I=function(){var R=A;if(O){J.applyStyles(J.userStyles);var X=O.columns;A>=0?G(J,Z,oe,ae,X,!0):N(J,Z,ae,X),R=C(J,Z,A+1,ae,X),M(J,Z,ae,X)}var fe=R-A;pe.slice(1).forEach(function(he){J.applyStyles(J.userStyles),G(J,Z,oe,ae,he.columns,!0),C(J,Z,A+1,ae,he.columns,fe),M(J,Z,ae,he.columns)}),A=R};A<Z.body.length-1;)I()}function N(J,Z,oe,ae){var pe=Z.settings;J.applyStyles(J.userStyles),(pe.showHead==="firstPage"||pe.showHead==="everyPage")&&Z.head.forEach(function(be){return H(J,Z,be,oe,ae)})}function _(J,Z,oe,ae,pe){J.applyStyles(J.userStyles),Z.body.forEach(function(be,A){var O=A===Z.body.length-1;P(J,Z,be,O,oe,ae,pe)})}function C(J,Z,oe,ae,pe,be){J.applyStyles(J.userStyles),be=be??Z.body.length;var A=Math.min(oe+be,Z.body.length),O=-1;return Z.body.slice(oe,A).forEach(function(I,R){var X=oe+R===Z.body.length-1,fe=W(J,Z,X,ae);I.canEntireRowFit(fe,pe)&&(H(J,Z,I,ae,pe),O=oe+R)}),O}function M(J,Z,oe,ae){var pe=Z.settings;J.applyStyles(J.userStyles),(pe.showFoot==="lastPage"||pe.showFoot==="everyPage")&&Z.foot.forEach(function(be){return H(J,Z,be,oe,ae)})}function D(J,Z,oe){var ae=oe.getLineHeight(J.styles.fontSize),pe=J.padding("vertical"),be=Math.floor((Z-pe)/ae);return Math.max(0,be)}function L(J,Z,oe,ae){var pe={};J.spansMultiplePages=!0,J.height=0;for(var be=0,A=0,O=oe.columns;A<O.length;A++){var I=O[A],R=J.cells[I.index];if(R){Array.isArray(R.text)||(R.text=[R.text]);var X=new g.Cell(R.raw,R.styles,R.section);X=(0,m.assign)(X,R),X.text=[];var fe=D(R,Z,ae);R.text.length>fe&&(X.text=R.text.splice(fe,R.text.length));var he=ae.scaleFactor(),ee=ae.getLineHeightFactor();R.contentHeight=R.getContentHeight(he,ee),R.contentHeight>=Z&&(R.contentHeight=Z,X.styles.minCellHeight-=Z),R.contentHeight>J.height&&(J.height=R.contentHeight),X.contentHeight=X.getContentHeight(he,ee),X.contentHeight>be&&(be=X.contentHeight),pe[I.index]=X}}var ve=new g.Row(J.raw,-1,J.section,pe,!0);ve.height=be;for(var Ce=0,Ie=oe.columns;Ce<Ie.length;Ce++){var I=Ie[Ce],X=ve.cells[I.index];X&&(X.height=ve.height);var R=J.cells[I.index];R&&(R.height=J.height)}return ve}function E(J,Z,oe,ae){var pe=J.pageSize().height,be=ae.settings.margin,A=be.top+be.bottom,O=pe-A;Z.section==="body"&&(O-=ae.getHeadHeight(ae.columns)+ae.getFootHeight(ae.columns));var I=Z.getMinimumRowHeight(ae.columns,J),R=I<oe;if(I>O)return console.error("Will not be able to print row ".concat(Z.index," correctly since it's minimum height is larger than page height")),!0;if(!R)return!1;var X=Z.hasRowSpan(ae.columns),fe=Z.getMaxCellHeight(ae.columns)>O;return fe?(X&&console.error("The content of row ".concat(Z.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(X||ae.settings.rowPageBreak==="avoid")}function P(J,Z,oe,ae,pe,be,A){var O=W(J,Z,ae,be);if(oe.canEntireRowFit(O,A))H(J,Z,oe,be,A);else if(E(J,oe,O,Z)){var I=L(oe,O,Z,J);H(J,Z,oe,be,A),G(J,Z,pe,be,A),P(J,Z,I,ae,pe,be,A)}else G(J,Z,pe,be,A),P(J,Z,oe,ae,pe,be,A)}function H(J,Z,oe,ae,pe){ae.x=Z.settings.margin.left;for(var be=0,A=pe;be<A.length;be++){var O=A[be],I=oe.cells[O.index];if(!I){ae.x+=O.width;continue}J.applyStyles(I.styles),I.x=ae.x,I.y=ae.y;var R=Z.callCellHooks(J,Z.hooks.willDrawCell,I,oe,O,ae);if(R===!1){ae.x+=O.width;continue}k(J,I,ae);var X=I.getTextPos();(0,y.default)(I.text,X.x,X.y,{halign:I.styles.halign,valign:I.styles.valign,maxWidth:Math.ceil(I.width-I.padding("left")-I.padding("right"))},J.getDocument()),Z.callCellHooks(J,Z.hooks.didDrawCell,I,oe,O,ae),ae.x+=O.width}ae.y+=oe.height}function k(J,Z,oe){var ae=Z.styles;if(J.getDocument().setFillColor(J.getDocument().getFillColor()),typeof ae.lineWidth=="number"){var pe=(0,u.getFillStyle)(ae.lineWidth,ae.fillColor);pe&&J.rect(Z.x,oe.y,Z.width,Z.height,pe)}else typeof ae.lineWidth=="object"&&(ae.fillColor&&J.rect(Z.x,oe.y,Z.width,Z.height,"F"),T(J,Z,oe,ae.lineWidth))}function T(J,Z,oe,ae){var pe,be,A,O;ae.top&&(pe=oe.x,be=oe.y,A=oe.x+Z.width,O=oe.y,ae.right&&(A+=.5*ae.right),ae.left&&(pe-=.5*ae.left),I(ae.top,pe,be,A,O)),ae.bottom&&(pe=oe.x,be=oe.y+Z.height,A=oe.x+Z.width,O=oe.y+Z.height,ae.right&&(A+=.5*ae.right),ae.left&&(pe-=.5*ae.left),I(ae.bottom,pe,be,A,O)),ae.left&&(pe=oe.x,be=oe.y,A=oe.x,O=oe.y+Z.height,ae.top&&(be-=.5*ae.top),ae.bottom&&(O+=.5*ae.bottom),I(ae.left,pe,be,A,O)),ae.right&&(pe=oe.x+Z.width,be=oe.y,A=oe.x+Z.width,O=oe.y+Z.height,ae.top&&(be-=.5*ae.top),ae.bottom&&(O+=.5*ae.bottom),I(ae.right,pe,be,A,O));function I(R,X,fe,he,ee){J.getDocument().setLineWidth(R),J.getDocument().line(X,fe,he,ee,"S")}}function W(J,Z,oe,ae){var pe=Z.settings.margin.bottom,be=Z.settings.showFoot;return(be==="everyPage"||be==="lastPage"&&oe)&&(pe+=Z.getFootHeight(Z.columns)),J.pageSize().height-ae.y-pe}function G(J,Z,oe,ae,pe,be){pe===void 0&&(pe=[]),be===void 0&&(be=!1),J.applyStyles(J.userStyles),Z.settings.showFoot==="everyPage"&&!be&&Z.foot.forEach(function(O){return H(J,Z,O,ae,pe)}),Z.callEndPageHooks(J,ae);var A=Z.settings.margin;(0,u.addTableBorder)(J,Z,oe,ae),de(J),Z.pageNumber++,Z.pageCount++,ae.x=A.left,ae.y=A.top,oe.y=A.top,Z.callWillDrawPageHooks(J,ae),Z.settings.showHead==="everyPage"&&(Z.head.forEach(function(O){return H(J,Z,O,ae,pe)}),J.applyStyles(J.userStyles))}d.addPage=G;function de(J){var Z=J.pageNumber();J.setPage(Z+1);var oe=J.pageNumber();return oe===Z?(J.addPage(),!0):!1}},224:function(c,d,h){Object.defineProperty(d,"__esModule",{value:!0}),d.calculateAllColumnsCanFitInPage=void 0;var u=h(420);function g(m,y,v){var j;v===void 0&&(v={});var w=(0,u.getPageAvailableWidth)(m,y),N=new Map,_=[],C=[],M=[];y.settings.horizontalPageBreakRepeat,Array.isArray(y.settings.horizontalPageBreakRepeat)?M=y.settings.horizontalPageBreakRepeat:(typeof y.settings.horizontalPageBreakRepeat=="string"||typeof y.settings.horizontalPageBreakRepeat=="number")&&(M=[y.settings.horizontalPageBreakRepeat]),M.forEach(function(P){var H=y.columns.find(function(k){return k.dataKey===P||k.index===P});H&&!N.has(H.index)&&(N.set(H.index,!0),_.push(H.index),C.push(y.columns[H.index]),w-=H.wrappedWidth)});for(var D=!0,L=(j=v==null?void 0:v.start)!==null&&j!==void 0?j:0;L<y.columns.length;){if(N.has(L)){L++;continue}var E=y.columns[L].wrappedWidth;if(D||w>=E)D=!1,_.push(L),C.push(y.columns[L]),w-=E;else break;L++}return{colIndexes:_,columns:C,lastIndex:L-1}}function x(m,y){for(var v=[],j=0;j<y.columns.length;j++){var w=g(m,y,{start:j});w.columns.length&&(v.push(w),j=w.lastIndex)}return v}d.calculateAllColumnsCanFitInPage=x},324:function(c,d,h){Object.defineProperty(d,"__esModule",{value:!0}),d.ellipsize=d.resizeColumns=d.calculateWidths=void 0;var u=h(420);function g(_,C){x(_,C);var M=[],D=0;C.columns.forEach(function(E){var P=E.getMaxCustomCellWidth(C);P?E.width=P:(E.width=E.wrappedWidth,M.push(E)),D+=E.width});var L=C.getWidth(_.pageSize().width)-D;L&&(L=m(M,L,function(E){return Math.max(E.minReadableWidth,E.minWidth)})),L&&(L=m(M,L,function(E){return E.minWidth})),L=Math.abs(L),!C.settings.horizontalPageBreak&&L>.1/_.scaleFactor()&&(L=L<1?L:Math.round(L),console.warn("Of the table content, ".concat(L," units width could not fit page"))),v(C),j(C,_),y(C)}d.calculateWidths=g;function x(_,C){var M=_.scaleFactor(),D=C.settings.horizontalPageBreak,L=(0,u.getPageAvailableWidth)(_,C);C.allRows().forEach(function(E){for(var P=0,H=C.columns;P<H.length;P++){var k=H[P],T=E.cells[k.index];if(T){var W=C.hooks.didParseCell;C.callCellHooks(_,W,T,E,k,null);var G=T.padding("horizontal");T.contentWidth=(0,u.getStringWidth)(T.text,T.styles,_)+G;var de=(0,u.getStringWidth)(T.text.join(" ").split(/[^\S\u00A0]+/),T.styles,_);if(T.minReadableWidth=de+T.padding("horizontal"),typeof T.styles.cellWidth=="number")T.minWidth=T.styles.cellWidth,T.wrappedWidth=T.styles.cellWidth;else if(T.styles.cellWidth==="wrap"||D===!0)T.contentWidth>L?(T.minWidth=L,T.wrappedWidth=L):(T.minWidth=T.contentWidth,T.wrappedWidth=T.contentWidth);else{var J=10/M;T.minWidth=T.styles.minCellWidth||J,T.wrappedWidth=T.contentWidth,T.minWidth>T.wrappedWidth&&(T.wrappedWidth=T.minWidth)}}}}),C.allRows().forEach(function(E){for(var P=0,H=C.columns;P<H.length;P++){var k=H[P],T=E.cells[k.index];if(T&&T.colSpan===1)k.wrappedWidth=Math.max(k.wrappedWidth,T.wrappedWidth),k.minWidth=Math.max(k.minWidth,T.minWidth),k.minReadableWidth=Math.max(k.minReadableWidth,T.minReadableWidth);else{var W=C.styles.columnStyles[k.dataKey]||C.styles.columnStyles[k.index]||{},G=W.cellWidth||W.minCellWidth;G&&typeof G=="number"&&(k.minWidth=G,k.wrappedWidth=G)}T&&(T.colSpan>1&&!k.minWidth&&(k.minWidth=T.minWidth),T.colSpan>1&&!k.wrappedWidth&&(k.wrappedWidth=T.minWidth))}})}function m(_,C,M){for(var D=C,L=_.reduce(function(J,Z){return J+Z.wrappedWidth},0),E=0;E<_.length;E++){var P=_[E],H=P.wrappedWidth/L,k=D*H,T=P.width+k,W=M(P),G=T<W?W:T;C-=G-P.width,P.width=G}if(C=Math.round(C*1e10)/1e10,C){var de=_.filter(function(J){return C<0?J.width>M(J):!0});de.length&&(C=m(de,C,M))}return C}d.resizeColumns=m;function y(_){for(var C={},M=1,D=_.allRows(),L=0;L<D.length;L++)for(var E=D[L],P=0,H=_.columns;P<H.length;P++){var k=H[P],T=C[k.index];if(M>1)M--,delete E.cells[k.index];else if(T)T.cell.height+=E.height,M=T.cell.colSpan,delete E.cells[k.index],T.left--,T.left<=1&&delete C[k.index];else{var W=E.cells[k.index];if(!W)continue;if(W.height=E.height,W.rowSpan>1){var G=D.length-L,de=W.rowSpan>G?G:W.rowSpan;C[k.index]={cell:W,left:de,row:E}}}}}function v(_){for(var C=_.allRows(),M=0;M<C.length;M++)for(var D=C[M],L=null,E=0,P=0,H=0;H<_.columns.length;H++){var k=_.columns[H];if(P-=1,P>1&&_.columns[H+1])E+=k.width,delete D.cells[k.index];else if(L){var T=L;delete D.cells[k.index],L=null,T.width=k.width+E}else{var T=D.cells[k.index];if(!T)continue;if(P=T.colSpan,E=0,T.colSpan>1){L=T,E+=k.width;continue}T.width=k.width+E}}}function j(_,C){for(var M={count:0,height:0},D=0,L=_.allRows();D<L.length;D++){for(var E=L[D],P=0,H=_.columns;P<H.length;P++){var k=H[P],T=E.cells[k.index];if(T){C.applyStyles(T.styles,!0);var W=T.width-T.padding("horizontal");if(T.styles.overflow==="linebreak")T.text=C.splitTextToSize(T.text,W+1/C.scaleFactor(),{fontSize:T.styles.fontSize});else if(T.styles.overflow==="ellipsize")T.text=w(T.text,W,T.styles,C,"...");else if(T.styles.overflow==="hidden")T.text=w(T.text,W,T.styles,C,"");else if(typeof T.styles.overflow=="function"){var G=T.styles.overflow(T.text,W);typeof G=="string"?T.text=[G]:T.text=G}T.contentHeight=T.getContentHeight(C.scaleFactor(),C.getLineHeightFactor());var de=T.contentHeight/T.rowSpan;T.rowSpan>1&&M.count*M.height<de*T.rowSpan?M={height:de,count:T.rowSpan}:M&&M.count>0&&M.height>de&&(de=M.height),de>E.height&&(E.height=de)}}M.count--}}function w(_,C,M,D,L){return _.map(function(E){return N(E,C,M,D,L)})}d.ellipsize=w;function N(_,C,M,D,L){var E=1e4*D.scaleFactor();if(C=Math.ceil(C*E)/E,C>=(0,u.getStringWidth)(_,M,D))return _;for(;C<(0,u.getStringWidth)(_+L,M,D)&&!(_.length<=1);)_=_.substring(0,_.length-1);return _.trim()+L}},964:function(c){if(typeof t>"u"){var d=new Error("Cannot find module 'undefined'");throw d.code="MODULE_NOT_FOUND",d}c.exports=t}},s={};function o(c){var d=s[c];if(d!==void 0)return d.exports;var h=s[c]={exports:{}};return n[c].call(h.exports,h,h.exports,o),h.exports}var l={};return function(){var c=l;Object.defineProperty(c,"__esModule",{value:!0}),c.Cell=c.Column=c.Row=c.Table=c.CellHookData=c.__drawTable=c.__createTable=c.applyPlugin=void 0;var d=o(340),h=o(776),u=o(664),g=o(972),x=o(260);Object.defineProperty(c,"Table",{enumerable:!0,get:function(){return x.Table}});var m=o(172);Object.defineProperty(c,"CellHookData",{enumerable:!0,get:function(){return m.CellHookData}});var y=o(260);Object.defineProperty(c,"Cell",{enumerable:!0,get:function(){return y.Cell}}),Object.defineProperty(c,"Column",{enumerable:!0,get:function(){return y.Column}}),Object.defineProperty(c,"Row",{enumerable:!0,get:function(){return y.Row}});function v(C){(0,d.default)(C)}c.applyPlugin=v;function j(C,M){var D=(0,h.parseInput)(C,M),L=(0,g.createTable)(C,D);(0,u.drawTable)(C,L)}function w(C,M){var D=(0,h.parseInput)(C,M);return(0,g.createTable)(C,D)}c.__createTable=w;function N(C,M){(0,u.drawTable)(C,M)}c.__drawTable=N;try{var _=o(964);_.jsPDF&&(_=_.jsPDF),v(_)}catch{}c.default=j}(),l}()})})(Xx);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var ec={};ec.version="0.18.5";var Gh=1252,Jx=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],$h=function(e){Jx.indexOf(e)!=-1&&(Gh=e)};function Zx(){$h(1252)}var Io=function(e){$h(e)};function Qx(){Io(1200),Zx()}var ql=function(r){return String.fromCharCode(r)},Pf=function(r){return String.fromCharCode(r)},tc,gs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Do(e){for(var r="",t=0,n=0,s=0,o=0,l=0,c=0,d=0,h=0;h<e.length;)t=e.charCodeAt(h++),o=t>>2,n=e.charCodeAt(h++),l=(t&3)<<4|n>>4,s=e.charCodeAt(h++),c=(n&15)<<2|s>>6,d=s&63,isNaN(n)?c=d=64:isNaN(s)&&(d=64),r+=gs.charAt(o)+gs.charAt(l)+gs.charAt(c)+gs.charAt(d);return r}function Ya(e){var r="",t=0,n=0,s=0,o=0,l=0,c=0,d=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<e.length;)o=gs.indexOf(e.charAt(h++)),l=gs.indexOf(e.charAt(h++)),t=o<<2|l>>4,r+=String.fromCharCode(t),c=gs.indexOf(e.charAt(h++)),n=(l&15)<<4|c>>2,c!==64&&(r+=String.fromCharCode(n)),d=gs.indexOf(e.charAt(h++)),s=(c&3)<<6|d,d!==64&&(r+=String.fromCharCode(s));return r}var Ht=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ka=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function qs(e){return Ht?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Of(e){return Ht?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ha=function(r){return Ht?Ka(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function yc(e){if(typeof ArrayBuffer>"u")return ha(e);for(var r=new ArrayBuffer(e.length),t=new Uint8Array(r),n=0;n!=e.length;++n)t[n]=e.charCodeAt(n)&255;return r}function Wo(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function e2(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Yr=Ht?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:Ka(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),s=0;for(r=0,t=0;r<e.length;t+=s,++r)if(s=e[r].length,e[r]instanceof Uint8Array)n.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";n.set(new Uint8Array(e[r]),t)}return n}return[].concat.apply([],e.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function t2(e){for(var r=[],t=0,n=e.length+250,s=qs(e.length+255),o=0;o<e.length;++o){var l=e.charCodeAt(o);if(l<128)s[t++]=l;else if(l<2048)s[t++]=192|l>>6&31,s[t++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var c=e.charCodeAt(++o)&1023;s[t++]=240|l>>8&7,s[t++]=128|l>>2&63,s[t++]=128|c>>6&15|(l&3)<<4,s[t++]=128|c&63}else s[t++]=224|l>>12&15,s[t++]=128|l>>6&63,s[t++]=128|l&63;t>n&&(r.push(s.slice(0,t)),t=0,s=qs(65535),n=65530)}return r.push(s.slice(0,t)),Yr(r)}var ko=/\u0000/g,Vl=/[\u0001-\u0006]/g;function Li(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function ua(e,r){var t=""+e;return t.length>=r?t:mr("0",r-t.length)+t}function ad(e,r){var t=""+e;return t.length>=r?t:mr(" ",r-t.length)+t}function rc(e,r){var t=""+e;return t.length>=r?t:t+mr(" ",r-t.length)}function r2(e,r){var t=""+Math.round(e);return t.length>=r?t:mr("0",r-t.length)+t}function n2(e,r){var t=""+e;return t.length>=r?t:mr("0",r-t.length)+t}var If=Math.pow(2,32);function ji(e,r){if(e>If||e<-If)return r2(e,r);var t=Math.round(e);return n2(t,r)}function nc(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var Df=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],_0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function a2(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "',e}var xr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "'},Rf={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},s2={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ac(e,r,t){for(var n=e<0?-1:1,s=e*n,o=0,l=1,c=0,d=1,h=0,u=0,g=Math.floor(s);h<r&&(g=Math.floor(s),c=g*l+o,u=g*h+d,!(s-g<5e-8));)s=1/(s-g),o=l,l=c,d=h,h=u;if(u>r&&(h>r?(u=d,c=o):(u=h,c=l)),!t)return[0,n*c,u];var x=Math.floor(n*c/u);return[x,n*c-x*u,u]}function Gl(e,r,t){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),o=0,l=[],c={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),r&&r.date1904&&(n+=1462),c.u>.9999&&(c.u=0,++s==86400&&(c.T=s=0,++n,++c.D)),n===60)l=t?[1317,10,29]:[1900,2,29],o=3;else if(n===0)l=t?[1317,8,29]:[1900,1,0],o=6;else{n>60&&--n;var d=new Date(1900,0,1);d.setDate(d.getDate()+n-1),l=[d.getFullYear(),d.getMonth()+1,d.getDate()],o=d.getDay(),n<60&&(o=(o+6)%7),t&&(o=h2(d,l))}return c.y=l[0],c.m=l[1],c.d=l[2],c.S=s%60,s=Math.floor(s/60),c.M=s%60,s=Math.floor(s/60),c.H=s,c.q=o,c}var Yh=new Date(1899,11,31,0,0,0),i2=Yh.getTime(),o2=new Date(1900,2,1,0,0,0);function Xh(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=o2&&(t+=24*60*60*1e3),(t-(i2+(e.getTimezoneOffset()-Yh.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function sd(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function l2(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function c2(e){var r=e<0?12:11,t=sd(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function d2(e){var r=sd(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function f2(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=c2(e):r===10?t=e.toFixed(10).substr(0,12):t=d2(e),sd(l2(t.toUpperCase()))}function Y0(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):f2(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ns(14,Xh(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function h2(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function u2(e,r,t,n){var s="",o=0,l=0,c=t.y,d,h=0;switch(e){case 98:c=t.y+543;case 121:switch(r.length){case 1:case 2:d=c%100,h=2;break;default:d=c%1e4,h=4;break}break;case 109:switch(r.length){case 1:case 2:d=t.m,h=r.length;break;case 3:return _0[t.m-1][1];case 5:return _0[t.m-1][0];default:return _0[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:d=t.d,h=r.length;break;case 3:return Df[t.q][0];default:return Df[t.q][1]}break;case 104:switch(r.length){case 1:case 2:d=1+(t.H+11)%12,h=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:d=t.H,h=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:d=t.M,h=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?ua(t.S,r.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,o=Math.round(l*(t.S+t.u)),o>=60*l&&(o=0),r==="s"?o===0?"0":""+o/l:(s=ua(o,2+n),r==="ss"?s.substr(0,2):"."+s.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":d=t.D*24+t.H;break;case"[m]":case"[mm]":d=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":d=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}h=r.length===3?1:2;break;case 101:d=c,h=1;break}var u=h>0?ua(d,h):"";return u}function vs(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,n=e.substr(0,t);t!=e.length;t+=r)n+=(n.length>0?",":"")+e.substr(t,r);return n}var Kh=/%/g;function m2(e,r,t){var n=r.replace(Kh,""),s=r.length-n.length;return Va(e,n,t*Math.pow(10,2*s))+mr("%",s)}function p2(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Va(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function Jh(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Jh(e,-r);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%s;if(o<0&&(o+=s),t=(r/Math.pow(10,o)).toPrecision(n+1+(s+o)%s),t.indexOf("e")===-1){var l=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+o):t+="E+"+(l-o);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,s)+"."+t.substr(2+s),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,d,h,u){return d+h+u.substr(0,(s+o)%s)+"."+u.substr(o)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Zh=/# (\?+)( ?)\/( ?)(\d+)/;function x2(e,r,t){var n=parseInt(e[4],10),s=Math.round(r*n),o=Math.floor(s/n),l=s-o*n,c=n;return t+(o===0?"":""+o)+" "+(l===0?mr(" ",e[1].length+1+e[4].length):ad(l,e[1].length)+e[2]+"/"+e[3]+ua(c,e[4].length))}function g2(e,r,t){return t+(r===0?"":""+r)+mr(" ",e[1].length+2+e[4].length)}var Qh=/^#*0*\.([0#]+)/,eu=/\).*[0#]/,tu=/\(###\) ###\\?-####/;function hn(e){for(var r="",t,n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function Mf(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function Bf(e,r){var t=e-Math.floor(e),n=Math.pow(10,r);return r<(""+Math.round(t*n)).length?0:Math.round(t*n)}function v2(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function y2(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Xn(e,r,t){if(e.charCodeAt(0)===40&&!r.match(eu)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Xn("n",n,t):"("+Xn("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return p2(e,r,t);if(r.indexOf("%")!==-1)return m2(e,r,t);if(r.indexOf("E")!==-1)return Jh(r,t);if(r.charCodeAt(0)===36)return"$"+Xn(e,r.substr(r.charAt(1)==" "?2:1),t);var s,o,l,c,d=Math.abs(t),h=t<0?"-":"";if(r.match(/^00+$/))return h+ji(d,r.length);if(r.match(/^[#?]+$/))return s=ji(t,0),s==="0"&&(s=""),s.length>r.length?s:hn(r.substr(0,r.length-s.length))+s;if(o=r.match(Zh))return x2(o,d,h);if(r.match(/^#+0+$/))return h+ji(d,r.length-r.indexOf("0"));if(o=r.match(Qh))return s=Mf(t,o[1].length).replace(/^([^\.]+)$/,"$1."+hn(o[1])).replace(/\.$/,"."+hn(o[1])).replace(/\.(\d*)$/,function(y,v){return"."+v+mr("0",hn(o[1]).length-v.length)}),r.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return h+Mf(d,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return h+vs(ji(d,0));if(o=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Xn(e,r,-t):vs(""+(Math.floor(t)+v2(t,o[1].length)))+"."+ua(Bf(t,o[1].length),o[1].length);if(o=r.match(/^#,#*,#0/))return Xn(e,r.replace(/^#,#*,/,""),t);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Li(Xn(e,r.replace(/[\\-]/g,""),t)),l=0,Li(Li(r.replace(/\\/g,"")).replace(/[0#]/g,function(y){return l<s.length?s.charAt(l++):y==="0"?"0":""}));if(r.match(tu))return s=Xn(e,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),c=ac(d,Math.pow(10,l)-1,!1),s=""+h,u=Va("n",o[1],c[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+o[2]+"/"+o[3],u=rc(c[2],l),u.length<o[4].length&&(u=hn(o[4].substr(o[4].length-u.length))+u),s+=u,s;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),c=ac(d,Math.pow(10,l)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?ad(c[1],l)+o[2]+"/"+o[3]+rc(c[2],l):mr(" ",2*l+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return s=ji(t,0),r.length<=s.length?s:hn(r.substr(0,r.length-s.length))+s;if(o=r.match(/^([#0?]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=s.indexOf(".");var g=r.indexOf(".")-l,x=r.length-s.length-g;return hn(r.substr(0,g)+s+r.substr(r.length-x))}if(o=r.match(/^00,000\.([#0]*0)$/))return l=Bf(t,o[1].length),t<0?"-"+Xn(e,r,-t):vs(y2(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?ua(0,3-y.length):"")+y})+"."+ua(l,o[1].length);switch(r){case"###,##0.00":return Xn(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var m=vs(ji(d,0));return m!=="0"?h+m:"";case"###,###.00":return Xn(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Xn(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function b2(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Va(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function w2(e,r,t){var n=r.replace(Kh,""),s=r.length-n.length;return Va(e,n,t*Math.pow(10,2*s))+mr("%",s)}function ru(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+ru(e,-r);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%s;if(o<0&&(o+=s),t=(r/Math.pow(10,o)).toPrecision(n+1+(s+o)%s),!t.match(/[Ee]/)){var l=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+o):t+="E+"+(l-o),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,d,h,u){return d+h+u.substr(0,(s+o)%s)+"."+u.substr(o)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function ka(e,r,t){if(e.charCodeAt(0)===40&&!r.match(eu)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?ka("n",n,t):"("+ka("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return b2(e,r,t);if(r.indexOf("%")!==-1)return w2(e,r,t);if(r.indexOf("E")!==-1)return ru(r,t);if(r.charCodeAt(0)===36)return"$"+ka(e,r.substr(r.charAt(1)==" "?2:1),t);var s,o,l,c,d=Math.abs(t),h=t<0?"-":"";if(r.match(/^00+$/))return h+ua(d,r.length);if(r.match(/^[#?]+$/))return s=""+t,t===0&&(s=""),s.length>r.length?s:hn(r.substr(0,r.length-s.length))+s;if(o=r.match(Zh))return g2(o,d,h);if(r.match(/^#+0+$/))return h+ua(d,r.length-r.indexOf("0"));if(o=r.match(Qh))return s=(""+t).replace(/^([^\.]+)$/,"$1."+hn(o[1])).replace(/\.$/,"."+hn(o[1])),s=s.replace(/\.(\d*)$/,function(y,v){return"."+v+mr("0",hn(o[1]).length-v.length)}),r.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return h+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return h+vs(""+d);if(o=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+ka(e,r,-t):vs(""+t)+"."+mr("0",o[1].length);if(o=r.match(/^#,#*,#0/))return ka(e,r.replace(/^#,#*,/,""),t);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Li(ka(e,r.replace(/[\\-]/g,""),t)),l=0,Li(Li(r.replace(/\\/g,"")).replace(/[0#]/g,function(y){return l<s.length?s.charAt(l++):y==="0"?"0":""}));if(r.match(tu))return s=ka(e,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),c=ac(d,Math.pow(10,l)-1,!1),s=""+h,u=Va("n",o[1],c[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+o[2]+"/"+o[3],u=rc(c[2],l),u.length<o[4].length&&(u=hn(o[4].substr(o[4].length-u.length))+u),s+=u,s;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),c=ac(d,Math.pow(10,l)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?ad(c[1],l)+o[2]+"/"+o[3]+rc(c[2],l):mr(" ",2*l+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return s=""+t,r.length<=s.length?s:hn(r.substr(0,r.length-s.length))+s;if(o=r.match(/^([#0]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=s.indexOf(".");var g=r.indexOf(".")-l,x=r.length-s.length-g;return hn(r.substr(0,g)+s+r.substr(r.length-x))}if(o=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+ka(e,r,-t):vs(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?ua(0,3-y.length):"")+y})+"."+ua(0,o[1].length);switch(r){case"###,###":case"##,###":case"#,###":var m=vs(""+d);return m!=="0"?h+m:"";default:if(r.match(/\.[0#?]*$/))return ka(e,r.slice(0,r.lastIndexOf(".")),t)+hn(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function Va(e,r,t){return(t|0)===t?ka(e,r,t):Xn(e,r,t)}function N2(e){for(var r=[],t=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=e.substr(s,n-s),s=n+1}if(r[r.length]=e.substr(s),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var nu=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function au(e){for(var r=0,t="",n="";r<e.length;)switch(t=e.charAt(r)){case"G":nc(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"ä¸Š":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="ä¸Šåˆ/ä¸‹åˆ")return!0;++r;break;case"[":for(n=t;e.charAt(r++)!=="]"&&r<e.length;)n+=e.charAt(r);if(n.match(nu))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function j2(e,r,t,n){for(var s=[],o="",l=0,c="",d="t",h,u,g,x="H";l<e.length;)switch(c=e.charAt(l)){case"G":if(!nc(e,l))throw new Error("unrecognized character "+c+" in "+e);s[s.length]={t:"G",v:"General"},l+=7;break;case'"':for(o="";(g=e.charCodeAt(++l))!==34&&l<e.length;)o+=String.fromCharCode(g);s[s.length]={t:"t",v:o},++l;break;case"\\":var m=e.charAt(++l),y=m==="("||m===")"?m:"t";s[s.length]={t:y,v:m},++l;break;case"_":s[s.length]={t:"t",v:" "},l+=2;break;case"@":s[s.length]={t:"T",v:r},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(h==null&&(h=Gl(r,t,e.charAt(l+1)==="2"),h==null))return"";s[s.length]={t:"X",v:e.substr(l,2)},d=c,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||h==null&&(h=Gl(r,t),h==null))return"";for(o=c;++l<e.length&&e.charAt(l).toLowerCase()===c;)o+=c;c==="m"&&d.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=x),s[s.length]={t:c,v:o},d=c;break;case"A":case"a":case"ä¸Š":var v={t:c,v:c};if(h==null&&(h=Gl(r,t)),e.substr(l,3).toUpperCase()==="A/P"?(h!=null&&(v.v=h.H>=12?"P":"A"),v.t="T",x="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(h!=null&&(v.v=h.H>=12?"PM":"AM"),v.t="T",l+=5,x="h"):e.substr(l,5).toUpperCase()==="ä¸Šåˆ/ä¸‹åˆ"?(h!=null&&(v.v=h.H>=12?"ä¸‹åˆ":"ä¸Šåˆ"),v.t="T",l+=5,x="h"):(v.t="t",++l),h==null&&v.t==="T")return"";s[s.length]=v,d=c;break;case"[":for(o=c;e.charAt(l++)!=="]"&&l<e.length;)o+=e.charAt(l);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(nu)){if(h==null&&(h=Gl(r,t),h==null))return"";s[s.length]={t:"Z",v:o.toLowerCase()},d=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",au(e)||(s[s.length]={t:"t",v:o}));break;case".":if(h!=null){for(o=c;++l<e.length&&(c=e.charAt(l))==="0";)o+=c;s[s.length]={t:"s",v:o};break}case"0":case"#":for(o=c;++l<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(l))>-1;)o+=c;s[s.length]={t:"n",v:o};break;case"?":for(o=c;e.charAt(++l)===c;)o+=c;s[s.length]={t:c,v:o},d=c;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":s[s.length]={t:n===1?"t":c,v:c},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=c;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)o+=e.charAt(l);s[s.length]={t:"D",v:o};break;case" ":s[s.length]={t:c,v:c},++l;break;case"$":s[s.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=â‚¬acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);s[s.length]={t:"t",v:c},++l;break}var j=0,w=0,N;for(l=s.length-1,d="t";l>=0;--l)switch(s[l].t){case"h":case"H":s[l].t=x,d="h",j<1&&(j=1);break;case"s":(N=s[l].v.match(/\.0+$/))&&(w=Math.max(w,N[0].length-1)),j<3&&(j=3);case"d":case"y":case"M":case"e":d=s[l].t;break;case"m":d==="s"&&(s[l].t="M",j<2&&(j=2));break;case"X":break;case"Z":j<1&&s[l].v.match(/[Hh]/)&&(j=1),j<2&&s[l].v.match(/[Mm]/)&&(j=2),j<3&&s[l].v.match(/[Ss]/)&&(j=3)}switch(j){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var _="",C;for(l=0;l<s.length;++l)switch(s[l].t){case"t":case"T":case" ":case"D":break;case"X":s[l].v="",s[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[l].v=u2(s[l].t.charCodeAt(0),s[l].v,h,w),s[l].t="t";break;case"n":case"?":for(C=l+1;s[C]!=null&&((c=s[C].t)==="?"||c==="D"||(c===" "||c==="t")&&s[C+1]!=null&&(s[C+1].t==="?"||s[C+1].t==="t"&&s[C+1].v==="/")||s[l].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(s[C].v==="/"||s[C].v===" "&&s[C+1]!=null&&s[C+1].t=="?"));)s[l].v+=s[C].v,s[C]={v:"",t:";"},++C;_+=s[l].v,l=C-1;break;case"G":s[l].t="t",s[l].v=Y0(r,t);break}var M="",D,L;if(_.length>0){_.charCodeAt(0)==40?(D=r<0&&_.charCodeAt(0)===45?-r:r,L=Va("n",_,D)):(D=r<0&&n>1?-r:r,L=Va("n",_,D),D<0&&s[0]&&s[0].t=="t"&&(L=L.substr(1),s[0].v="-"+s[0].v)),C=L.length-1;var E=s.length;for(l=0;l<s.length;++l)if(s[l]!=null&&s[l].t!="t"&&s[l].v.indexOf(".")>-1){E=l;break}var P=s.length;if(E===s.length&&L.indexOf("E")===-1){for(l=s.length-1;l>=0;--l)s[l]==null||"n?".indexOf(s[l].t)===-1||(C>=s[l].v.length-1?(C-=s[l].v.length,s[l].v=L.substr(C+1,s[l].v.length)):C<0?s[l].v="":(s[l].v=L.substr(0,C+1),C=-1),s[l].t="t",P=l);C>=0&&P<s.length&&(s[P].v=L.substr(0,C+1)+s[P].v)}else if(E!==s.length&&L.indexOf("E")===-1){for(C=L.indexOf(".")-1,l=E;l>=0;--l)if(!(s[l]==null||"n?".indexOf(s[l].t)===-1)){for(u=s[l].v.indexOf(".")>-1&&l===E?s[l].v.indexOf(".")-1:s[l].v.length-1,M=s[l].v.substr(u+1);u>=0;--u)C>=0&&(s[l].v.charAt(u)==="0"||s[l].v.charAt(u)==="#")&&(M=L.charAt(C--)+M);s[l].v=M,s[l].t="t",P=l}for(C>=0&&P<s.length&&(s[P].v=L.substr(0,C+1)+s[P].v),C=L.indexOf(".")+1,l=E;l<s.length;++l)if(!(s[l]==null||"n?(".indexOf(s[l].t)===-1&&l!==E)){for(u=s[l].v.indexOf(".")>-1&&l===E?s[l].v.indexOf(".")+1:0,M=s[l].v.substr(0,u);u<s[l].v.length;++u)C<L.length&&(M+=L.charAt(C++));s[l].v=M,s[l].t="t",P=l}}}for(l=0;l<s.length;++l)s[l]!=null&&"n?".indexOf(s[l].t)>-1&&(D=n>1&&r<0&&l>0&&s[l-1].v==="-"?-r:r,s[l].v=Va(s[l].t,s[l].v,D),s[l].t="t");var H="";for(l=0;l!==s.length;++l)s[l]!=null&&(H+=s[l].v);return H}var Uf=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Hf(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function S2(e,r){var t=N2(e),n=t.length,s=t[n-1].indexOf("@");if(n<4&&s>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||s>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=s>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=s>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=s>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var o=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,o];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var l=t[0].match(Uf),c=t[1].match(Uf);return Hf(r,l)?[n,t[0]]:Hf(r,c)?[n,t[1]]:[n,t[l!=null&&c!=null?2:1]]}return[n,o]}function Ns(e,r,t){t==null&&(t={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?n=t.dateNF:n=e;break;case"number":e==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:xr)[e],n==null&&(n=t.table&&t.table[Rf[e]]||xr[Rf[e]]),n==null&&(n=s2[e]||"General");break}if(nc(n,0))return Y0(r,t);r instanceof Date&&(r=Xh(r,t.date1904));var s=S2(n,r);if(nc(s[1]))return Y0(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return j2(s[1],r,t,s[0])}function su(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(xr[t]==null){r<0&&(r=t);continue}if(xr[t]==e){r=t;break}}r<0&&(r=391)}return xr[r]=e,r}function bc(e){for(var r=0;r!=392;++r)e[r]!==void 0&&su(e[r],r)}function wc(){xr=a2()}var iu=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function _2(e){var r=typeof e=="number"?xr[e]:e;return r=r.replace(iu,"(\\d+)"),new RegExp("^"+r+"$")}function A2(e,r,t){var n=-1,s=-1,o=-1,l=-1,c=-1,d=-1;(r.match(iu)||[]).forEach(function(g,x){var m=parseInt(t[x+1],10);switch(g.toLowerCase().charAt(0)){case"y":n=m;break;case"d":o=m;break;case"h":l=m;break;case"s":d=m;break;case"m":l>=0?c=m:s=m;break}}),d>=0&&c==-1&&s>=0&&(c=s,s=-1);var h=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var u=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return l==-1&&c==-1&&d==-1?h:n==-1&&s==-1&&o==-1?u:h+"T"+u}var k2=function(){var e={};e.version="1.2.0";function r(){for(var L=0,E=new Array(256),P=0;P!=256;++P)L=P,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,E[P]=L;return typeof Int32Array<"u"?new Int32Array(E):E}var t=r();function n(L){var E=0,P=0,H=0,k=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(H=0;H!=256;++H)k[H]=L[H];for(H=0;H!=256;++H)for(P=L[H],E=256+H;E<4096;E+=256)P=k[E]=P>>>8^L[P&255];var T=[];for(H=1;H!=16;++H)T[H-1]=typeof Int32Array<"u"?k.subarray(H*256,H*256+256):k.slice(H*256,H*256+256);return T}var s=n(t),o=s[0],l=s[1],c=s[2],d=s[3],h=s[4],u=s[5],g=s[6],x=s[7],m=s[8],y=s[9],v=s[10],j=s[11],w=s[12],N=s[13],_=s[14];function C(L,E){for(var P=E^-1,H=0,k=L.length;H<k;)P=P>>>8^t[(P^L.charCodeAt(H++))&255];return~P}function M(L,E){for(var P=E^-1,H=L.length-15,k=0;k<H;)P=_[L[k++]^P&255]^N[L[k++]^P>>8&255]^w[L[k++]^P>>16&255]^j[L[k++]^P>>>24]^v[L[k++]]^y[L[k++]]^m[L[k++]]^x[L[k++]]^g[L[k++]]^u[L[k++]]^h[L[k++]]^d[L[k++]]^c[L[k++]]^l[L[k++]]^o[L[k++]]^t[L[k++]];for(H+=15;k<H;)P=P>>>8^t[(P^L[k++])&255];return~P}function D(L,E){for(var P=E^-1,H=0,k=L.length,T=0,W=0;H<k;)T=L.charCodeAt(H++),T<128?P=P>>>8^t[(P^T)&255]:T<2048?(P=P>>>8^t[(P^(192|T>>6&31))&255],P=P>>>8^t[(P^(128|T&63))&255]):T>=55296&&T<57344?(T=(T&1023)+64,W=L.charCodeAt(H++)&1023,P=P>>>8^t[(P^(240|T>>8&7))&255],P=P>>>8^t[(P^(128|T>>2&63))&255],P=P>>>8^t[(P^(128|W>>6&15|(T&3)<<4))&255],P=P>>>8^t[(P^(128|W&63))&255]):(P=P>>>8^t[(P^(224|T>>12&15))&255],P=P>>>8^t[(P^(128|T>>6&63))&255],P=P>>>8^t[(P^(128|T&63))&255]);return~P}return e.table=t,e.bstr=C,e.buf=M,e.str=D,e}(),Zt=function(){var r={};r.version="1.2.1";function t(q,se){for(var Q=q.split("/"),te=se.split("/"),ne=0,ie=0,Se=Math.min(Q.length,te.length);ne<Se;++ne){if(ie=Q[ne].length-te[ne].length)return ie;if(Q[ne]!=te[ne])return Q[ne]<te[ne]?-1:1}return Q.length-te.length}function n(q){if(q.charAt(q.length-1)=="/")return q.slice(0,-1).indexOf("/")===-1?q:n(q.slice(0,-1));var se=q.lastIndexOf("/");return se===-1?q:q.slice(0,se+1)}function s(q){if(q.charAt(q.length-1)=="/")return s(q.slice(0,-1));var se=q.lastIndexOf("/");return se===-1?q:q.slice(se+1)}function o(q,se){typeof se=="string"&&(se=new Date(se));var Q=se.getHours();Q=Q<<6|se.getMinutes(),Q=Q<<5|se.getSeconds()>>>1,q.write_shift(2,Q);var te=se.getFullYear()-1980;te=te<<4|se.getMonth()+1,te=te<<5|se.getDate(),q.write_shift(2,te)}function l(q){var se=q.read_shift(2)&65535,Q=q.read_shift(2)&65535,te=new Date,ne=Q&31;Q>>>=5;var ie=Q&15;Q>>>=4,te.setMilliseconds(0),te.setFullYear(Q+1980),te.setMonth(ie-1),te.setDate(ne);var Se=se&31;se>>>=5;var Fe=se&63;return se>>>=6,te.setHours(se),te.setMinutes(Fe),te.setSeconds(Se<<1),te}function c(q){On(q,0);for(var se={},Q=0;q.l<=q.length-4;){var te=q.read_shift(2),ne=q.read_shift(2),ie=q.l+ne,Se={};switch(te){case 21589:Q=q.read_shift(1),Q&1&&(Se.mtime=q.read_shift(4)),ne>5&&(Q&2&&(Se.atime=q.read_shift(4)),Q&4&&(Se.ctime=q.read_shift(4))),Se.mtime&&(Se.mt=new Date(Se.mtime*1e3));break}q.l=ie,se[te]=Se}return se}var d;function h(){return d||(d={})}function u(q,se){if(q[0]==80&&q[1]==75)return ir(q,se);if((q[0]|32)==109&&(q[1]|32)==105)return Hn(q,se);if(q.length<512)throw new Error("CFB file size "+q.length+" < 512");var Q=3,te=512,ne=0,ie=0,Se=0,Fe=0,je=0,ke=[],Te=q.slice(0,512);On(Te,0);var qe=g(Te);switch(Q=qe[0],Q){case 3:te=512;break;case 4:te=4096;break;case 0:if(qe[1]==0)return ir(q,se);default:throw new Error("Major Version: Expected 3 or 4 saw "+Q)}te!==512&&(Te=q.slice(0,te),On(Te,28));var Xe=q.slice(0,te);x(Te,Q);var it=Te.read_shift(4,"i");if(Q===3&&it!==0)throw new Error("# Directory Sectors: Expected 0 saw "+it);Te.l+=4,Se=Te.read_shift(4,"i"),Te.l+=4,Te.chk("00100000","Mini Stream Cutoff Size: "),Fe=Te.read_shift(4,"i"),ne=Te.read_shift(4,"i"),je=Te.read_shift(4,"i"),ie=Te.read_shift(4,"i");for(var Ge=-1,st=0;st<109&&(Ge=Te.read_shift(4,"i"),!(Ge<0));++st)ke[st]=Ge;var bt=m(q,te);j(je,ie,bt,te,ke);var zt=N(bt,Se,ke,te);zt[Se].name="!Directory",ne>0&&Fe!==W&&(zt[Fe].name="!MiniFAT"),zt[ke[0]].name="!FAT",zt.fat_addrs=ke,zt.ssz=te;var Kt={},Sr=[],Qn=[],Oa=[];_(Se,zt,bt,Sr,ne,Kt,Qn,Fe),y(Qn,Oa,Sr),Sr.shift();var ya={FileIndex:Qn,FullPaths:Oa};return se&&se.raw&&(ya.raw={header:Xe,sectors:bt}),ya}function g(q){if(q[q.l]==80&&q[q.l+1]==75)return[0,0];q.chk(G,"Header Signature: "),q.l+=16;var se=q.read_shift(2,"u");return[q.read_shift(2,"u"),se]}function x(q,se){var Q=9;switch(q.l+=2,Q=q.read_shift(2)){case 9:if(se!=3)throw new Error("Sector Shift: Expected 9 saw "+Q);break;case 12:if(se!=4)throw new Error("Sector Shift: Expected 12 saw "+Q);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Q)}q.chk("0600","Mini Sector Shift: "),q.chk("000000000000","Reserved: ")}function m(q,se){for(var Q=Math.ceil(q.length/se)-1,te=[],ne=1;ne<Q;++ne)te[ne-1]=q.slice(ne*se,(ne+1)*se);return te[Q-1]=q.slice(Q*se),te}function y(q,se,Q){for(var te=0,ne=0,ie=0,Se=0,Fe=0,je=Q.length,ke=[],Te=[];te<je;++te)ke[te]=Te[te]=te,se[te]=Q[te];for(;Fe<Te.length;++Fe)te=Te[Fe],ne=q[te].L,ie=q[te].R,Se=q[te].C,ke[te]===te&&(ne!==-1&&ke[ne]!==ne&&(ke[te]=ke[ne]),ie!==-1&&ke[ie]!==ie&&(ke[te]=ke[ie])),Se!==-1&&(ke[Se]=te),ne!==-1&&te!=ke[te]&&(ke[ne]=ke[te],Te.lastIndexOf(ne)<Fe&&Te.push(ne)),ie!==-1&&te!=ke[te]&&(ke[ie]=ke[te],Te.lastIndexOf(ie)<Fe&&Te.push(ie));for(te=1;te<je;++te)ke[te]===te&&(ie!==-1&&ke[ie]!==ie?ke[te]=ke[ie]:ne!==-1&&ke[ne]!==ne&&(ke[te]=ke[ne]));for(te=1;te<je;++te)if(q[te].type!==0){if(Fe=te,Fe!=ke[Fe])do Fe=ke[Fe],se[te]=se[Fe]+"/"+se[te];while(Fe!==0&&ke[Fe]!==-1&&Fe!=ke[Fe]);ke[te]=-1}for(se[0]+="/",te=1;te<je;++te)q[te].type!==2&&(se[te]+="/")}function v(q,se,Q){for(var te=q.start,ne=q.size,ie=[],Se=te;Q&&ne>0&&Se>=0;)ie.push(se.slice(Se*T,Se*T+T)),ne-=T,Se=Rs(Q,Se*4);return ie.length===0?Oe(0):Yr(ie).slice(0,q.size)}function j(q,se,Q,te,ne){var ie=W;if(q===W){if(se!==0)throw new Error("DIFAT chain shorter than expected")}else if(q!==-1){var Se=Q[q],Fe=(te>>>2)-1;if(!Se)return;for(var je=0;je<Fe&&(ie=Rs(Se,je*4))!==W;++je)ne.push(ie);j(Rs(Se,te-4),se-1,Q,te,ne)}}function w(q,se,Q,te,ne){var ie=[],Se=[];ne||(ne=[]);var Fe=te-1,je=0,ke=0;for(je=se;je>=0;){ne[je]=!0,ie[ie.length]=je,Se.push(q[je]);var Te=Q[Math.floor(je*4/te)];if(ke=je*4&Fe,te<4+ke)throw new Error("FAT boundary crossed: "+je+" 4 "+te);if(!q[Te])break;je=Rs(q[Te],ke)}return{nodes:ie,data:Xf([Se])}}function N(q,se,Q,te){var ne=q.length,ie=[],Se=[],Fe=[],je=[],ke=te-1,Te=0,qe=0,Xe=0,it=0;for(Te=0;Te<ne;++Te)if(Fe=[],Xe=Te+se,Xe>=ne&&(Xe-=ne),!Se[Xe]){je=[];var Ge=[];for(qe=Xe;qe>=0;){Ge[qe]=!0,Se[qe]=!0,Fe[Fe.length]=qe,je.push(q[qe]);var st=Q[Math.floor(qe*4/te)];if(it=qe*4&ke,te<4+it)throw new Error("FAT boundary crossed: "+qe+" 4 "+te);if(!q[st]||(qe=Rs(q[st],it),Ge[qe]))break}ie[Xe]={nodes:Fe,data:Xf([je])}}return ie}function _(q,se,Q,te,ne,ie,Se,Fe){for(var je=0,ke=te.length?2:0,Te=se[q].data,qe=0,Xe=0,it;qe<Te.length;qe+=128){var Ge=Te.slice(qe,qe+128);On(Ge,64),Xe=Ge.read_shift(2),it=dd(Ge,0,Xe-ke),te.push(it);var st={name:it,type:Ge.read_shift(1),color:Ge.read_shift(1),L:Ge.read_shift(4,"i"),R:Ge.read_shift(4,"i"),C:Ge.read_shift(4,"i"),clsid:Ge.read_shift(16),state:Ge.read_shift(4,"i"),start:0,size:0},bt=Ge.read_shift(2)+Ge.read_shift(2)+Ge.read_shift(2)+Ge.read_shift(2);bt!==0&&(st.ct=C(Ge,Ge.l-8));var zt=Ge.read_shift(2)+Ge.read_shift(2)+Ge.read_shift(2)+Ge.read_shift(2);zt!==0&&(st.mt=C(Ge,Ge.l-8)),st.start=Ge.read_shift(4,"i"),st.size=Ge.read_shift(4,"i"),st.size<0&&st.start<0&&(st.size=st.type=0,st.start=W,st.name=""),st.type===5?(je=st.start,ne>0&&je!==W&&(se[je].name="!StreamData")):st.size>=4096?(st.storage="fat",se[st.start]===void 0&&(se[st.start]=w(Q,st.start,se.fat_addrs,se.ssz)),se[st.start].name=st.name,st.content=se[st.start].data.slice(0,st.size)):(st.storage="minifat",st.size<0?st.size=0:je!==W&&st.start!==W&&se[je]&&(st.content=v(st,se[je].data,(se[Fe]||{}).data))),st.content&&On(st.content,0),ie[it]=st,Se.push(st)}}function C(q,se){return new Date((Dn(q,se+4)/1e7*Math.pow(2,32)+Dn(q,se)/1e7-11644473600)*1e3)}function M(q,se){return h(),u(d.readFileSync(q),se)}function D(q,se){var Q=se&&se.type;switch(Q||Ht&&Buffer.isBuffer(q)&&(Q="buffer"),Q||"base64"){case"file":return M(q,se);case"base64":return u(ha(Ya(q)),se);case"binary":return u(ha(q),se)}return u(q,se)}function L(q,se){var Q=se||{},te=Q.root||"Root Entry";if(q.FullPaths||(q.FullPaths=[]),q.FileIndex||(q.FileIndex=[]),q.FullPaths.length!==q.FileIndex.length)throw new Error("inconsistent CFB structure");q.FullPaths.length===0&&(q.FullPaths[0]=te+"/",q.FileIndex[0]={name:te,type:5}),Q.CLSID&&(q.FileIndex[0].clsid=Q.CLSID),E(q)}function E(q){var se="Sh33tJ5";if(!Zt.find(q,"/"+se)){var Q=Oe(4);Q[0]=55,Q[1]=Q[3]=50,Q[2]=54,q.FileIndex.push({name:se,type:2,content:Q,size:4,L:69,R:69,C:69}),q.FullPaths.push(q.FullPaths[0]+se),P(q)}}function P(q,se){L(q);for(var Q=!1,te=!1,ne=q.FullPaths.length-1;ne>=0;--ne){var ie=q.FileIndex[ne];switch(ie.type){case 0:te?Q=!0:(q.FileIndex.pop(),q.FullPaths.pop());break;case 1:case 2:case 5:te=!0,isNaN(ie.R*ie.L*ie.C)&&(Q=!0),ie.R>-1&&ie.L>-1&&ie.R==ie.L&&(Q=!0);break;default:Q=!0;break}}if(!(!Q&&!se)){var Se=new Date(1987,1,19),Fe=0,je=Object.create?Object.create(null):{},ke=[];for(ne=0;ne<q.FullPaths.length;++ne)je[q.FullPaths[ne]]=!0,q.FileIndex[ne].type!==0&&ke.push([q.FullPaths[ne],q.FileIndex[ne]]);for(ne=0;ne<ke.length;++ne){var Te=n(ke[ne][0]);te=je[Te],te||(ke.push([Te,{name:s(Te).replace("/",""),type:1,clsid:J,ct:Se,mt:Se,content:null}]),je[Te]=!0)}for(ke.sort(function(it,Ge){return t(it[0],Ge[0])}),q.FullPaths=[],q.FileIndex=[],ne=0;ne<ke.length;++ne)q.FullPaths[ne]=ke[ne][0],q.FileIndex[ne]=ke[ne][1];for(ne=0;ne<ke.length;++ne){var qe=q.FileIndex[ne],Xe=q.FullPaths[ne];if(qe.name=s(Xe).replace("/",""),qe.L=qe.R=qe.C=-(qe.color=1),qe.size=qe.content?qe.content.length:0,qe.start=0,qe.clsid=qe.clsid||J,ne===0)qe.C=ke.length>1?1:-1,qe.size=0,qe.type=5;else if(Xe.slice(-1)=="/"){for(Fe=ne+1;Fe<ke.length&&n(q.FullPaths[Fe])!=Xe;++Fe);for(qe.C=Fe>=ke.length?-1:Fe,Fe=ne+1;Fe<ke.length&&n(q.FullPaths[Fe])!=n(Xe);++Fe);qe.R=Fe>=ke.length?-1:Fe,qe.type=1}else n(q.FullPaths[ne+1]||"")==n(Xe)&&(qe.R=ne+1),qe.type=2}}}function H(q,se){var Q=se||{};if(Q.fileType=="mad")return mt(q,Q);switch(P(q),Q.fileType){case"zip":return Zn(q,Q)}var te=function(it){for(var Ge=0,st=0,bt=0;bt<it.FileIndex.length;++bt){var zt=it.FileIndex[bt];if(zt.content){var Kt=zt.content.length;Kt>0&&(Kt<4096?Ge+=Kt+63>>6:st+=Kt+511>>9)}}for(var Sr=it.FullPaths.length+3>>2,Qn=Ge+7>>3,Oa=Ge+127>>7,ya=Qn+st+Sr+Oa,ea=ya+127>>7,ba=ea<=109?0:Math.ceil((ea-109)/127);ya+ea+ba+127>>7>ea;)ba=++ea<=109?0:Math.ceil((ea-109)/127);var Tn=[1,ba,ea,Oa,Sr,st,Ge,0];return it.FileIndex[0].size=Ge<<6,Tn[7]=(it.FileIndex[0].start=Tn[0]+Tn[1]+Tn[2]+Tn[3]+Tn[4]+Tn[5])+(Tn[6]+7>>3),Tn}(q),ne=Oe(te[7]<<9),ie=0,Se=0;{for(ie=0;ie<8;++ie)ne.write_shift(1,de[ie]);for(ie=0;ie<8;++ie)ne.write_shift(2,0);for(ne.write_shift(2,62),ne.write_shift(2,3),ne.write_shift(2,65534),ne.write_shift(2,9),ne.write_shift(2,6),ie=0;ie<3;++ie)ne.write_shift(2,0);for(ne.write_shift(4,0),ne.write_shift(4,te[2]),ne.write_shift(4,te[0]+te[1]+te[2]+te[3]-1),ne.write_shift(4,0),ne.write_shift(4,4096),ne.write_shift(4,te[3]?te[0]+te[1]+te[2]-1:W),ne.write_shift(4,te[3]),ne.write_shift(-4,te[1]?te[0]-1:W),ne.write_shift(4,te[1]),ie=0;ie<109;++ie)ne.write_shift(-4,ie<te[2]?te[1]+ie:-1)}if(te[1])for(Se=0;Se<te[1];++Se){for(;ie<236+Se*127;++ie)ne.write_shift(-4,ie<te[2]?te[1]+ie:-1);ne.write_shift(-4,Se===te[1]-1?W:Se+1)}var Fe=function(it){for(Se+=it;ie<Se-1;++ie)ne.write_shift(-4,ie+1);it&&(++ie,ne.write_shift(-4,W))};for(Se=ie=0,Se+=te[1];ie<Se;++ie)ne.write_shift(-4,Z.DIFSECT);for(Se+=te[2];ie<Se;++ie)ne.write_shift(-4,Z.FATSECT);Fe(te[3]),Fe(te[4]);for(var je=0,ke=0,Te=q.FileIndex[0];je<q.FileIndex.length;++je)Te=q.FileIndex[je],Te.content&&(ke=Te.content.length,!(ke<4096)&&(Te.start=Se,Fe(ke+511>>9)));for(Fe(te[6]+7>>3);ne.l&511;)ne.write_shift(-4,Z.ENDOFCHAIN);for(Se=ie=0,je=0;je<q.FileIndex.length;++je)Te=q.FileIndex[je],Te.content&&(ke=Te.content.length,!(!ke||ke>=4096)&&(Te.start=Se,Fe(ke+63>>6)));for(;ne.l&511;)ne.write_shift(-4,Z.ENDOFCHAIN);for(ie=0;ie<te[4]<<2;++ie){var qe=q.FullPaths[ie];if(!qe||qe.length===0){for(je=0;je<17;++je)ne.write_shift(4,0);for(je=0;je<3;++je)ne.write_shift(4,-1);for(je=0;je<12;++je)ne.write_shift(4,0);continue}Te=q.FileIndex[ie],ie===0&&(Te.start=Te.size?Te.start-1:W);var Xe=ie===0&&Q.root||Te.name;if(ke=2*(Xe.length+1),ne.write_shift(64,Xe,"utf16le"),ne.write_shift(2,ke),ne.write_shift(1,Te.type),ne.write_shift(1,Te.color),ne.write_shift(-4,Te.L),ne.write_shift(-4,Te.R),ne.write_shift(-4,Te.C),Te.clsid)ne.write_shift(16,Te.clsid,"hex");else for(je=0;je<4;++je)ne.write_shift(4,0);ne.write_shift(4,Te.state||0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,Te.start),ne.write_shift(4,Te.size),ne.write_shift(4,0)}for(ie=1;ie<q.FileIndex.length;++ie)if(Te=q.FileIndex[ie],Te.size>=4096)if(ne.l=Te.start+1<<9,Ht&&Buffer.isBuffer(Te.content))Te.content.copy(ne,ne.l,0,Te.size),ne.l+=Te.size+511&-512;else{for(je=0;je<Te.size;++je)ne.write_shift(1,Te.content[je]);for(;je&511;++je)ne.write_shift(1,0)}for(ie=1;ie<q.FileIndex.length;++ie)if(Te=q.FileIndex[ie],Te.size>0&&Te.size<4096)if(Ht&&Buffer.isBuffer(Te.content))Te.content.copy(ne,ne.l,0,Te.size),ne.l+=Te.size+63&-64;else{for(je=0;je<Te.size;++je)ne.write_shift(1,Te.content[je]);for(;je&63;++je)ne.write_shift(1,0)}if(Ht)ne.l=ne.length;else for(;ne.l<ne.length;)ne.write_shift(1,0);return ne}function k(q,se){var Q=q.FullPaths.map(function(je){return je.toUpperCase()}),te=Q.map(function(je){var ke=je.split("/");return ke[ke.length-(je.slice(-1)=="/"?2:1)]}),ne=!1;se.charCodeAt(0)===47?(ne=!0,se=Q[0].slice(0,-1)+se):ne=se.indexOf("/")!==-1;var ie=se.toUpperCase(),Se=ne===!0?Q.indexOf(ie):te.indexOf(ie);if(Se!==-1)return q.FileIndex[Se];var Fe=!ie.match(Vl);for(ie=ie.replace(ko,""),Fe&&(ie=ie.replace(Vl,"!")),Se=0;Se<Q.length;++Se)if((Fe?Q[Se].replace(Vl,"!"):Q[Se]).replace(ko,"")==ie||(Fe?te[Se].replace(Vl,"!"):te[Se]).replace(ko,"")==ie)return q.FileIndex[Se];return null}var T=64,W=-2,G="d0cf11e0a1b11ae1",de=[208,207,17,224,161,177,26,225],J="00000000000000000000000000000000",Z={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:W,FREESECT:-1,HEADER_SIGNATURE:G,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:J,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function oe(q,se,Q){h();var te=H(q,Q);d.writeFileSync(se,te)}function ae(q){for(var se=new Array(q.length),Q=0;Q<q.length;++Q)se[Q]=String.fromCharCode(q[Q]);return se.join("")}function pe(q,se){var Q=H(q,se);switch(se&&se.type||"buffer"){case"file":return h(),d.writeFileSync(se.filename,Q),Q;case"binary":return typeof Q=="string"?Q:ae(Q);case"base64":return Do(typeof Q=="string"?Q:ae(Q));case"buffer":if(Ht)return Buffer.isBuffer(Q)?Q:Ka(Q);case"array":return typeof Q=="string"?ha(Q):Q}return Q}var be;function A(q){try{var se=q.InflateRaw,Q=new se;if(Q._processChunk(new Uint8Array([3,0]),Q._finishFlushFlag),Q.bytesRead)be=q;else throw new Error("zlib does not expose bytesRead")}catch(te){console.error("cannot use native zlib: "+(te.message||te))}}function O(q,se){if(!be)return Dt(q,se);var Q=be.InflateRaw,te=new Q,ne=te._processChunk(q.slice(q.l),te._finishFlushFlag);return q.l+=te.bytesRead,ne}function I(q){return be?be.deflateRawSync(q):Ct(q)}var R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],X=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],fe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function he(q){var se=(q<<1|q<<11)&139536|(q<<5|q<<15)&558144;return(se>>16|se>>8|se)&255}for(var ee=typeof Uint8Array<"u",ve=ee?new Uint8Array(256):[],Ce=0;Ce<256;++Ce)ve[Ce]=he(Ce);function Ie(q,se){var Q=ve[q&255];return se<=8?Q>>>8-se:(Q=Q<<8|ve[q>>8&255],se<=16?Q>>>16-se:(Q=Q<<8|ve[q>>16&255],Q>>>24-se))}function Ve(q,se){var Q=se&7,te=se>>>3;return(q[te]|(Q<=6?0:q[te+1]<<8))>>>Q&3}function $e(q,se){var Q=se&7,te=se>>>3;return(q[te]|(Q<=5?0:q[te+1]<<8))>>>Q&7}function Ee(q,se){var Q=se&7,te=se>>>3;return(q[te]|(Q<=4?0:q[te+1]<<8))>>>Q&15}function le(q,se){var Q=se&7,te=se>>>3;return(q[te]|(Q<=3?0:q[te+1]<<8))>>>Q&31}function Be(q,se){var Q=se&7,te=se>>>3;return(q[te]|(Q<=1?0:q[te+1]<<8))>>>Q&127}function Ze(q,se,Q){var te=se&7,ne=se>>>3,ie=(1<<Q)-1,Se=q[ne]>>>te;return Q<8-te||(Se|=q[ne+1]<<8-te,Q<16-te)||(Se|=q[ne+2]<<16-te,Q<24-te)||(Se|=q[ne+3]<<24-te),Se&ie}function We(q,se,Q){var te=se&7,ne=se>>>3;return te<=5?q[ne]|=(Q&7)<<te:(q[ne]|=Q<<te&255,q[ne+1]=(Q&7)>>8-te),se+3}function Ye(q,se,Q){var te=se&7,ne=se>>>3;return Q=(Q&1)<<te,q[ne]|=Q,se+1}function Qe(q,se,Q){var te=se&7,ne=se>>>3;return Q<<=te,q[ne]|=Q&255,Q>>>=8,q[ne+1]=Q,se+8}function tt(q,se,Q){var te=se&7,ne=se>>>3;return Q<<=te,q[ne]|=Q&255,Q>>>=8,q[ne+1]=Q&255,q[ne+2]=Q>>>8,se+16}function dt(q,se){var Q=q.length,te=2*Q>se?2*Q:se+5,ne=0;if(Q>=se)return q;if(Ht){var ie=Of(te);if(q.copy)q.copy(ie);else for(;ne<q.length;++ne)ie[ne]=q[ne];return ie}else if(ee){var Se=new Uint8Array(te);if(Se.set)Se.set(q);else for(;ne<Q;++ne)Se[ne]=q[ne];return Se}return q.length=te,q}function ht(q){for(var se=new Array(q),Q=0;Q<q;++Q)se[Q]=0;return se}function wt(q,se,Q){var te=1,ne=0,ie=0,Se=0,Fe=0,je=q.length,ke=ee?new Uint16Array(32):ht(32);for(ie=0;ie<32;++ie)ke[ie]=0;for(ie=je;ie<Q;++ie)q[ie]=0;je=q.length;var Te=ee?new Uint16Array(je):ht(je);for(ie=0;ie<je;++ie)ke[ne=q[ie]]++,te<ne&&(te=ne),Te[ie]=0;for(ke[0]=0,ie=1;ie<=te;++ie)ke[ie+16]=Fe=Fe+ke[ie-1]<<1;for(ie=0;ie<je;++ie)Fe=q[ie],Fe!=0&&(Te[ie]=ke[Fe+16]++);var qe=0;for(ie=0;ie<je;++ie)if(qe=q[ie],qe!=0)for(Fe=Ie(Te[ie],te)>>te-qe,Se=(1<<te+4-qe)-1;Se>=0;--Se)se[Fe|Se<<qe]=qe&15|ie<<4;return te}var kt=ee?new Uint16Array(512):ht(512),Ft=ee?new Uint16Array(32):ht(32);if(!ee){for(var Lt=0;Lt<512;++Lt)kt[Lt]=0;for(Lt=0;Lt<32;++Lt)Ft[Lt]=0}(function(){for(var q=[],se=0;se<32;se++)q.push(5);wt(q,Ft,32);var Q=[];for(se=0;se<=143;se++)Q.push(8);for(;se<=255;se++)Q.push(9);for(;se<=279;se++)Q.push(7);for(;se<=287;se++)Q.push(8);wt(Q,kt,288)})();var vt=function(){for(var se=ee?new Uint8Array(32768):[],Q=0,te=0;Q<fe.length-1;++Q)for(;te<fe[Q+1];++te)se[te]=Q;for(;te<32768;++te)se[te]=29;var ne=ee?new Uint8Array(259):[];for(Q=0,te=0;Q<X.length-1;++Q)for(;te<X[Q+1];++te)ne[te]=Q;function ie(Fe,je){for(var ke=0;ke<Fe.length;){var Te=Math.min(65535,Fe.length-ke),qe=ke+Te==Fe.length;for(je.write_shift(1,+qe),je.write_shift(2,Te),je.write_shift(2,~Te&65535);Te-- >0;)je[je.l++]=Fe[ke++]}return je.l}function Se(Fe,je){for(var ke=0,Te=0,qe=ee?new Uint16Array(32768):[];Te<Fe.length;){var Xe=Math.min(65535,Fe.length-Te);if(Xe<10){for(ke=We(je,ke,+(Te+Xe==Fe.length)),ke&7&&(ke+=8-(ke&7)),je.l=ke/8|0,je.write_shift(2,Xe),je.write_shift(2,~Xe&65535);Xe-- >0;)je[je.l++]=Fe[Te++];ke=je.l*8;continue}ke=We(je,ke,+(Te+Xe==Fe.length)+2);for(var it=0;Xe-- >0;){var Ge=Fe[Te];it=(it<<5^Ge)&32767;var st=-1,bt=0;if((st=qe[it])&&(st|=Te&-32768,st>Te&&(st-=32768),st<Te))for(;Fe[st+bt]==Fe[Te+bt]&&bt<250;)++bt;if(bt>2){Ge=ne[bt],Ge<=22?ke=Qe(je,ke,ve[Ge+1]>>1)-1:(Qe(je,ke,3),ke+=5,Qe(je,ke,ve[Ge-23]>>5),ke+=3);var zt=Ge<8?0:Ge-4>>2;zt>0&&(tt(je,ke,bt-X[Ge]),ke+=zt),Ge=se[Te-st],ke=Qe(je,ke,ve[Ge]>>3),ke-=3;var Kt=Ge<4?0:Ge-2>>1;Kt>0&&(tt(je,ke,Te-st-fe[Ge]),ke+=Kt);for(var Sr=0;Sr<bt;++Sr)qe[it]=Te&32767,it=(it<<5^Fe[Te])&32767,++Te;Xe-=bt-1}else Ge<=143?Ge=Ge+48:ke=Ye(je,ke,1),ke=Qe(je,ke,ve[Ge]),qe[it]=Te&32767,++Te}ke=Qe(je,ke,0)-1}return je.l=(ke+7)/8|0,je.l}return function(je,ke){return je.length<8?ie(je,ke):Se(je,ke)}}();function Ct(q){var se=Oe(50+Math.floor(q.length*1.1)),Q=vt(q,se);return se.slice(0,Q)}var at=ee?new Uint16Array(32768):ht(32768),Fr=ee?new Uint16Array(32768):ht(32768),Ot=ee?new Uint16Array(128):ht(128),pn=1,Wt=1;function nr(q,se){var Q=le(q,se)+257;se+=5;var te=le(q,se)+1;se+=5;var ne=Ee(q,se)+4;se+=4;for(var ie=0,Se=ee?new Uint8Array(19):ht(19),Fe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],je=1,ke=ee?new Uint8Array(8):ht(8),Te=ee?new Uint8Array(8):ht(8),qe=Se.length,Xe=0;Xe<ne;++Xe)Se[R[Xe]]=ie=$e(q,se),je<ie&&(je=ie),ke[ie]++,se+=3;var it=0;for(ke[0]=0,Xe=1;Xe<=je;++Xe)Te[Xe]=it=it+ke[Xe-1]<<1;for(Xe=0;Xe<qe;++Xe)(it=Se[Xe])!=0&&(Fe[Xe]=Te[it]++);var Ge=0;for(Xe=0;Xe<qe;++Xe)if(Ge=Se[Xe],Ge!=0){it=ve[Fe[Xe]]>>8-Ge;for(var st=(1<<7-Ge)-1;st>=0;--st)Ot[it|st<<Ge]=Ge&7|Xe<<3}var bt=[];for(je=1;bt.length<Q+te;)switch(it=Ot[Be(q,se)],se+=it&7,it>>>=3){case 16:for(ie=3+Ve(q,se),se+=2,it=bt[bt.length-1];ie-- >0;)bt.push(it);break;case 17:for(ie=3+$e(q,se),se+=3;ie-- >0;)bt.push(0);break;case 18:for(ie=11+Be(q,se),se+=7;ie-- >0;)bt.push(0);break;default:bt.push(it),je<it&&(je=it);break}var zt=bt.slice(0,Q),Kt=bt.slice(Q);for(Xe=Q;Xe<286;++Xe)zt[Xe]=0;for(Xe=te;Xe<30;++Xe)Kt[Xe]=0;return pn=wt(zt,at,286),Wt=wt(Kt,Fr,30),se}function Bn(q,se){if(q[0]==3&&!(q[1]&3))return[qs(se),2];for(var Q=0,te=0,ne=Of(se||1<<18),ie=0,Se=ne.length>>>0,Fe=0,je=0;!(te&1);){if(te=$e(q,Q),Q+=3,te>>>1)te>>1==1?(Fe=9,je=5):(Q=nr(q,Q),Fe=pn,je=Wt);else{Q&7&&(Q+=8-(Q&7));var ke=q[Q>>>3]|q[(Q>>>3)+1]<<8;if(Q+=32,ke>0)for(!se&&Se<ie+ke&&(ne=dt(ne,ie+ke),Se=ne.length);ke-- >0;)ne[ie++]=q[Q>>>3],Q+=8;continue}for(;;){!se&&Se<ie+32767&&(ne=dt(ne,ie+32767),Se=ne.length);var Te=Ze(q,Q,Fe),qe=te>>>1==1?kt[Te]:at[Te];if(Q+=qe&15,qe>>>=4,!(qe>>>8&255))ne[ie++]=qe;else{if(qe==256)break;qe-=257;var Xe=qe<8?0:qe-4>>2;Xe>5&&(Xe=0);var it=ie+X[qe];Xe>0&&(it+=Ze(q,Q,Xe),Q+=Xe),Te=Ze(q,Q,je),qe=te>>>1==1?Ft[Te]:Fr[Te],Q+=qe&15,qe>>>=4;var Ge=qe<4?0:qe-2>>1,st=fe[qe];for(Ge>0&&(st+=Ze(q,Q,Ge),Q+=Ge),!se&&Se<it&&(ne=dt(ne,it+100),Se=ne.length);ie<it;)ne[ie]=ne[ie-st],++ie}}}return se?[ne,Q+7>>>3]:[ne.slice(0,ie),Q+7>>>3]}function Dt(q,se){var Q=q.slice(q.l||0),te=Bn(Q,se);return q.l+=te[1],te[0]}function va(q,se){if(q)typeof console<"u"&&console.error(se);else throw new Error(se)}function ir(q,se){var Q=q;On(Q,0);var te=[],ne=[],ie={FileIndex:te,FullPaths:ne};L(ie,{root:se.root});for(var Se=Q.length-4;(Q[Se]!=80||Q[Se+1]!=75||Q[Se+2]!=5||Q[Se+3]!=6)&&Se>=0;)--Se;Q.l=Se+4,Q.l+=4;var Fe=Q.read_shift(2);Q.l+=6;var je=Q.read_shift(4);for(Q.l=je,Se=0;Se<Fe;++Se){Q.l+=20;var ke=Q.read_shift(4),Te=Q.read_shift(4),qe=Q.read_shift(2),Xe=Q.read_shift(2),it=Q.read_shift(2);Q.l+=8;var Ge=Q.read_shift(4),st=c(Q.slice(Q.l+qe,Q.l+qe+Xe));Q.l+=qe+Xe+it;var bt=Q.l;Q.l=Ge+4,An(Q,ke,Te,ie,st),Q.l=bt}return ie}function An(q,se,Q,te,ne){q.l+=2;var ie=q.read_shift(2),Se=q.read_shift(2),Fe=l(q);if(ie&8257)throw new Error("Unsupported ZIP encryption");for(var je=q.read_shift(4),ke=q.read_shift(4),Te=q.read_shift(4),qe=q.read_shift(2),Xe=q.read_shift(2),it="",Ge=0;Ge<qe;++Ge)it+=String.fromCharCode(q[q.l++]);if(Xe){var st=c(q.slice(q.l,q.l+Xe));(st[21589]||{}).mt&&(Fe=st[21589].mt),((ne||{})[21589]||{}).mt&&(Fe=ne[21589].mt)}q.l+=Xe;var bt=q.slice(q.l,q.l+ke);switch(Se){case 8:bt=O(q,Te);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Se)}var zt=!1;ie&8&&(je=q.read_shift(4),je==134695760&&(je=q.read_shift(4),zt=!0),ke=q.read_shift(4),Te=q.read_shift(4)),ke!=se&&va(zt,"Bad compressed size: "+se+" != "+ke),Te!=Q&&va(zt,"Bad uncompressed size: "+Q+" != "+Te),xn(te,it,bt,{unsafe:!0,mt:Fe})}function Zn(q,se){var Q=se||{},te=[],ne=[],ie=Oe(1),Se=Q.compression?8:0,Fe=0,je=0,ke=0,Te=0,qe=0,Xe=q.FullPaths[0],it=Xe,Ge=q.FileIndex[0],st=[],bt=0;for(je=1;je<q.FullPaths.length;++je)if(it=q.FullPaths[je].slice(Xe.length),Ge=q.FileIndex[je],!(!Ge.size||!Ge.content||it=="Sh33tJ5")){var zt=Te,Kt=Oe(it.length);for(ke=0;ke<it.length;++ke)Kt.write_shift(1,it.charCodeAt(ke)&127);Kt=Kt.slice(0,Kt.l),st[qe]=k2.buf(Ge.content,0);var Sr=Ge.content;Se==8&&(Sr=I(Sr)),ie=Oe(30),ie.write_shift(4,67324752),ie.write_shift(2,20),ie.write_shift(2,Fe),ie.write_shift(2,Se),Ge.mt?o(ie,Ge.mt):ie.write_shift(4,0),ie.write_shift(-4,st[qe]),ie.write_shift(4,Sr.length),ie.write_shift(4,Ge.content.length),ie.write_shift(2,Kt.length),ie.write_shift(2,0),Te+=ie.length,te.push(ie),Te+=Kt.length,te.push(Kt),Te+=Sr.length,te.push(Sr),ie=Oe(46),ie.write_shift(4,33639248),ie.write_shift(2,0),ie.write_shift(2,20),ie.write_shift(2,Fe),ie.write_shift(2,Se),ie.write_shift(4,0),ie.write_shift(-4,st[qe]),ie.write_shift(4,Sr.length),ie.write_shift(4,Ge.content.length),ie.write_shift(2,Kt.length),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(4,0),ie.write_shift(4,zt),bt+=ie.l,ne.push(ie),bt+=Kt.length,ne.push(Kt),++qe}return ie=Oe(22),ie.write_shift(4,101010256),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(2,qe),ie.write_shift(2,qe),ie.write_shift(4,bt),ie.write_shift(4,Te),ie.write_shift(2,0),Yr([Yr(te),Yr(ne),ie])}var Qt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Nt(q,se){if(q.ctype)return q.ctype;var Q=q.name||"",te=Q.match(/\.([^\.]+)$/);return te&&Qt[te[1]]||se&&(te=(Q=se).match(/[\.\\]([^\.\\])+$/),te&&Qt[te[1]])?Qt[te[1]]:"application/octet-stream"}function Mt(q){for(var se=Do(q),Q=[],te=0;te<se.length;te+=76)Q.push(se.slice(te,te+76));return Q.join(`\r
`)+`\r
`}function Pa(q){var se=q.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ke){var Te=ke.charCodeAt(0).toString(16).toUpperCase();return"="+(Te.length==1?"0"+Te:Te)});se=se.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),se.charAt(0)==`
`&&(se="=0D"+se.slice(1)),se=se.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Q=[],te=se.split(`\r
`),ne=0;ne<te.length;++ne){var ie=te[ne];if(ie.length==0){Q.push("");continue}for(var Se=0;Se<ie.length;){var Fe=76,je=ie.slice(Se,Se+Fe);je.charAt(Fe-1)=="="?Fe--:je.charAt(Fe-2)=="="?Fe-=2:je.charAt(Fe-3)=="="&&(Fe-=3),je=ie.slice(Se,Se+Fe),Se+=Fe,Se<ie.length&&(je+="="),Q.push(je)}}return Q.join(`\r
`)}function Lr(q){for(var se=[],Q=0;Q<q.length;++Q){for(var te=q[Q];Q<=q.length&&te.charAt(te.length-1)=="=";)te=te.slice(0,te.length-1)+q[++Q];se.push(te)}for(var ne=0;ne<se.length;++ne)se[ne]=se[ne].replace(/[=][0-9A-Fa-f]{2}/g,function(ie){return String.fromCharCode(parseInt(ie.slice(1),16))});return ha(se.join(`\r
`))}function Un(q,se,Q){for(var te="",ne="",ie="",Se,Fe=0;Fe<10;++Fe){var je=se[Fe];if(!je||je.match(/^\s*$/))break;var ke=je.match(/^(.*?):\s*([^\s].*)$/);if(ke)switch(ke[1].toLowerCase()){case"content-location":te=ke[2].trim();break;case"content-type":ie=ke[2].trim();break;case"content-transfer-encoding":ne=ke[2].trim();break}}switch(++Fe,ne.toLowerCase()){case"base64":Se=ha(Ya(se.slice(Fe).join("")));break;case"quoted-printable":Se=Lr(se.slice(Fe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ne)}var Te=xn(q,te.slice(Q.length),Se,{unsafe:!0});ie&&(Te.ctype=ie)}function Hn(q,se){if(ae(q.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Q=se&&se.root||"",te=(Ht&&Buffer.isBuffer(q)?q.toString("binary"):ae(q)).split(`\r
`),ne=0,ie="";for(ne=0;ne<te.length;++ne)if(ie=te[ne],!!/^Content-Location:/i.test(ie)&&(ie=ie.slice(ie.indexOf("file")),Q||(Q=ie.slice(0,ie.lastIndexOf("/")+1)),ie.slice(0,Q.length)!=Q))for(;Q.length>0&&(Q=Q.slice(0,Q.length-1),Q=Q.slice(0,Q.lastIndexOf("/")+1),ie.slice(0,Q.length)!=Q););var Se=(te[1]||"").match(/boundary="(.*?)"/);if(!Se)throw new Error("MAD cannot find boundary");var Fe="--"+(Se[1]||""),je=[],ke=[],Te={FileIndex:je,FullPaths:ke};L(Te);var qe,Xe=0;for(ne=0;ne<te.length;++ne){var it=te[ne];it!==Fe&&it!==Fe+"--"||(Xe++&&Un(Te,te.slice(qe,ne),Q),qe=ne)}return Te}function mt(q,se){var Q=se||{},te=Q.boundary||"SheetJS";te="------="+te;for(var ne=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+te.slice(2)+'"',"","",""],ie=q.FullPaths[0],Se=ie,Fe=q.FileIndex[0],je=1;je<q.FullPaths.length;++je)if(Se=q.FullPaths[je].slice(ie.length),Fe=q.FileIndex[je],!(!Fe.size||!Fe.content||Se=="Sh33tJ5")){Se=Se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(bt){return"_x"+bt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(bt){return"_u"+bt.charCodeAt(0).toString(16)+"_"});for(var ke=Fe.content,Te=Ht&&Buffer.isBuffer(ke)?ke.toString("binary"):ae(ke),qe=0,Xe=Math.min(1024,Te.length),it=0,Ge=0;Ge<=Xe;++Ge)(it=Te.charCodeAt(Ge))>=32&&it<128&&++qe;var st=qe>=Xe*4/5;ne.push(te),ne.push("Content-Location: "+(Q.root||"file:///C:/SheetJS/")+Se),ne.push("Content-Transfer-Encoding: "+(st?"quoted-printable":"base64")),ne.push("Content-Type: "+Nt(Fe,Se)),ne.push(""),ne.push(st?Pa(Te):Mt(Te))}return ne.push(te+`--\r
`),ne.join(`\r
`)}function kn(q){var se={};return L(se,q),se}function xn(q,se,Q,te){var ne=te&&te.unsafe;ne||L(q);var ie=!ne&&Zt.find(q,se);if(!ie){var Se=q.FullPaths[0];se.slice(0,Se.length)==Se?Se=se:(Se.slice(-1)!="/"&&(Se+="/"),Se=(Se+se).replace("//","/")),ie={name:s(se),type:2},q.FileIndex.push(ie),q.FullPaths.push(Se),ne||Zt.utils.cfb_gc(q)}return ie.content=Q,ie.size=Q?Q.length:0,te&&(te.CLSID&&(ie.clsid=te.CLSID),te.mt&&(ie.mt=te.mt),te.ct&&(ie.ct=te.ct)),ie}function Zr(q,se){L(q);var Q=Zt.find(q,se);if(Q){for(var te=0;te<q.FileIndex.length;++te)if(q.FileIndex[te]==Q)return q.FileIndex.splice(te,1),q.FullPaths.splice(te,1),!0}return!1}function gr(q,se,Q){L(q);var te=Zt.find(q,se);if(te){for(var ne=0;ne<q.FileIndex.length;++ne)if(q.FileIndex[ne]==te)return q.FileIndex[ne].name=s(Q),q.FullPaths[ne]=Q,!0}return!1}function dr(q){P(q,!0)}return r.find=k,r.read=D,r.parse=u,r.write=pe,r.writeFile=oe,r.utils={cfb_new:kn,cfb_add:xn,cfb_del:Zr,cfb_mov:gr,cfb_gc:dr,ReadShift:Co,CheckField:Su,prep_blob:On,bconcat:Yr,use_zlib:A,_deflateRaw:Ct,_inflateRaw:Dt,consts:Z},r}();function T2(e){return typeof e=="string"?yc(e):Array.isArray(e)?e2(e):e}function zo(e,r,t){if(typeof Deno<"u"){if(t&&typeof r=="string")switch(t){case"utf8":r=new TextEncoder(t).encode(r);break;case"binary":r=yc(r);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(e,r)}var n=t=="utf8"?Mo(r):r;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([T2(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=o,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(e);return c.open("w"),c.encoding="binary",Array.isArray(r)&&(r=Wo(r)),c.write(r),c.close(),r}catch(d){if(!d.message||!d.message.match(/onstruct/))throw d}throw new Error("cannot save file "+e)}function Jr(e){for(var r=Object.keys(e),t=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(e,r[n])&&t.push(r[n]);return t}function Wf(e,r){for(var t=[],n=Jr(e),s=0;s!==n.length;++s)t[e[n[s]][r]]==null&&(t[e[n[s]][r]]=n[s]);return t}function id(e){for(var r=[],t=Jr(e),n=0;n!==t.length;++n)r[e[t[n]]]=t[n];return r}function Nc(e){for(var r=[],t=Jr(e),n=0;n!==t.length;++n)r[e[t[n]]]=parseInt(t[n],10);return r}function C2(e){for(var r=[],t=Jr(e),n=0;n!==t.length;++n)r[e[t[n]]]==null&&(r[e[t[n]]]=[]),r[e[t[n]]].push(t[n]);return r}var sc=new Date(1899,11,30,0,0,0);function jn(e,r){var t=e.getTime(),n=sc.getTime()+(e.getTimezoneOffset()-sc.getTimezoneOffset())*6e4;return(t-n)/(24*60*60*1e3)}var ou=new Date,E2=sc.getTime()+(ou.getTimezoneOffset()-sc.getTimezoneOffset())*6e4,zf=ou.getTimezoneOffset();function lu(e){var r=new Date;return r.setTime(e*24*60*60*1e3+E2),r.getTimezoneOffset()!==zf&&r.setTime(r.getTime()+(r.getTimezoneOffset()-zf)*6e4),r}var qf=new Date("2017-02-19T19:06:09.000Z"),cu=isNaN(qf.getFullYear())?new Date("2/19/17"):qf,F2=cu.getFullYear()==2017;function mn(e,r){var t=new Date(e);if(F2)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(cu.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return e.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function jc(e,r){if(Ht&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var t={"â‚¬":"Â€","â€š":"Â‚",Æ’:"Âƒ","â€ž":"Â„","â€¦":"Â…","â€ ":"Â†","â€¡":"Â‡","Ë†":"Âˆ","â€°":"Â‰",Å :"ÂŠ","â€¹":"Â‹",Å’:"ÂŒ",Å½:"ÂŽ","â€˜":"Â‘","â€™":"Â’","â€œ":"Â“","â€":"Â”","â€¢":"Â•","â€“":"Â–","â€”":"Â—","Ëœ":"Â˜","â„¢":"Â™",Å¡:"Âš","â€º":"Â›",Å“:"Âœ",Å¾:"Âž",Å¸:"ÂŸ"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[â‚¬â€šÆ’â€žâ€¦â€ â€¡Ë†â€°Å â€¹Å’Å½â€˜â€™â€œâ€â€¢â€“â€”Ëœâ„¢Å¡â€ºÅ“Å¾Å¸]/g,function(o){return t[o]||o})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function Sn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=Sn(e[t]));return r}function mr(e,r){for(var t="";t.length<r;)t+=e;return t}function Ga(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,o){return t=-t,o}),!isNaN(r=Number(n)))?r/t:r}var L2=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ro(e){var r=new Date(e),t=new Date(NaN),n=r.getYear(),s=r.getMonth(),o=r.getDate();if(isNaN(o))return t;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&L2.indexOf(l)==-1)return t}else if(l.match(/[a-z]/))return t;return n<0||n>8099?t:(s>0||o>1)&&n!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}function Et(e,r,t){if(e.FullPaths){if(typeof t=="string"){var n;return Ht?n=Ka(t):n=t2(t),Zt.utils.cfb_add(e,r,n)}Zt.utils.cfb_add(e,r,t)}else e.file(r,t)}function od(){return Zt.utils.cfb_new()}var Er=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,P2={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ld=id(P2),cd=/[&<>'"]/g,O2=/[\u0000-\u0008\u000b-\u001f]/g;function Yt(e){var r=e+"";return r.replace(cd,function(t){return ld[t]}).replace(O2,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Vf(e){return Yt(e).replace(/ /g,"_x0020_")}var du=/[\u0000-\u001f]/g;function I2(e){var r=e+"";return r.replace(cd,function(t){return ld[t]}).replace(/\n/g,"<br/>").replace(du,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function D2(e){var r=e+"";return r.replace(cd,function(t){return ld[t]}).replace(du,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function R2(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function M2(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function A0(e){for(var r="",t=0,n=0,s=0,o=0,l=0,c=0;t<e.length;){if(n=e.charCodeAt(t++),n<128){r+=String.fromCharCode(n);continue}if(s=e.charCodeAt(t++),n>191&&n<224){l=(n&31)<<6,l|=s&63,r+=String.fromCharCode(l);continue}if(o=e.charCodeAt(t++),n<240){r+=String.fromCharCode((n&15)<<12|(s&63)<<6|o&63);continue}l=e.charCodeAt(t++),c=((n&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536,r+=String.fromCharCode(55296+(c>>>10&1023)),r+=String.fromCharCode(56320+(c&1023))}return r}function Gf(e){var r=qs(2*e.length),t,n,s=1,o=0,l=0,c;for(n=0;n<e.length;n+=s)s=1,(c=e.charCodeAt(n))<128?t=c:c<224?(t=(c&31)*64+(e.charCodeAt(n+1)&63),s=2):c<240?(t=(c&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,t=(c&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),t-=65536,l=55296+(t>>>10&1023),t=56320+(t&1023)),l!==0&&(r[o++]=l&255,r[o++]=l>>>8,l=0),r[o++]=t%256,r[o++]=t>>>8;return r.slice(0,o).toString("ucs2")}function $f(e){return Ka(e,"binary").toString("utf8")}var $l="foo bar bazÃ¢Â˜ÂƒÃ°ÂŸÂÂ£",To=Ht&&($f($l)==A0($l)&&$f||Gf($l)==A0($l)&&Gf)||A0,Mo=Ht?function(e){return Ka(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,n=0,s=0;t<e.length;)switch(n=e.charCodeAt(t++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(t++)-56320+(n<<10),r.push(String.fromCharCode(240+(s>>18&7))),r.push(String.fromCharCode(144+(s>>12&63))),r.push(String.fromCharCode(128+(s>>6&63))),r.push(String.fromCharCode(128+(s&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},B2=function(){var e=[["nbsp"," "],["middot","Â·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),fu=/(^\s|\s$|\n)/;function Xr(e,r){return"<"+e+(r.match(fu)?' xml:space="preserve"':"")+">"+r+"</"+e+">"}function Bo(e){return Jr(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function Ke(e,r,t){return"<"+e+(t!=null?Bo(t):"")+(r!=null?(r.match(fu)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function X0(e,r){try{return e.toISOString().replace(/\.\d*/,"")}catch(t){if(r)throw t}return""}function U2(e,r){switch(typeof e){case"string":var t=Ke("vt:lpwstr",Yt(e));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return Ke((e|0)==e?"vt:i4":"vt:r8",Yt(String(e)));case"boolean":return Ke("vt:bool",e?"true":"false")}if(e instanceof Date)return Ke("vt:filetime",X0(e));throw new Error("Unable to serialize "+e)}var Ur={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Mi=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],In={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function H2(e,r){for(var t=1-2*(e[r+7]>>>7),n=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),s=e[r+6]&15,o=5;o>=0;--o)s=s*256+e[r+o];return n==2047?s==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),t*Math.pow(2,n-52)*s)}function W2(e,r,t){var n=(r<0||1/r==-1/0?1:0)<<7,s=0,o=0,l=n?-r:r;isFinite(l)?l==0?s=o=0:(s=Math.floor(Math.log(l)/Math.LN2),o=l*Math.pow(2,52-s),s<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?s=-1022:(o-=Math.pow(2,52),s+=1023)):(s=2047,o=isNaN(r)?26985:0);for(var c=0;c<=5;++c,o/=256)e[t+c]=o&255;e[t+6]=(s&15)<<4|o&15,e[t+7]=s>>4|n}var Yf=function(e){for(var r=[],t=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,o=e[0][n].length;s<o;s+=t)r.push.apply(r,e[0][n].slice(s,s+t));return r},Xf=Ht?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:Ka(r)})):Yf(e)}:Yf,Kf=function(e,r,t){for(var n=[],s=r;s<t;s+=2)n.push(String.fromCharCode(wo(e,s)));return n.join("").replace(ko,"")},dd=Ht?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(ko,""):Kf(e,r,t)}:Kf,Jf=function(e,r,t){for(var n=[],s=r;s<r+t;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},hu=Ht?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):Jf(e,r,t)}:Jf,Zf=function(e,r,t){for(var n=[],s=r;s<t;s++)n.push(String.fromCharCode(Ei(e,s)));return n.join("")},qo=Ht?function(r,t,n){return Buffer.isBuffer(r)?r.toString("utf8",t,n):Zf(r,t,n)}:Zf,uu=function(e,r){var t=Dn(e,r);return t>0?qo(e,r+4,r+4+t-1):""},mu=uu,pu=function(e,r){var t=Dn(e,r);return t>0?qo(e,r+4,r+4+t-1):""},xu=pu,gu=function(e,r){var t=2*Dn(e,r);return t>0?qo(e,r+4,r+4+t-1):""},vu=gu,yu=function(r,t){var n=Dn(r,t);return n>0?dd(r,t+4,t+4+n):""},bu=yu,wu=function(e,r){var t=Dn(e,r);return t>0?qo(e,r+4,r+4+t):""},Nu=wu,ju=function(e,r){return H2(e,r)},ic=ju,fd=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};Ht&&(mu=function(r,t){if(!Buffer.isBuffer(r))return uu(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},xu=function(r,t){if(!Buffer.isBuffer(r))return pu(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},vu=function(r,t){if(!Buffer.isBuffer(r))return gu(r,t);var n=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n-1)},bu=function(r,t){if(!Buffer.isBuffer(r))return yu(r,t);var n=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n)},Nu=function(r,t){if(!Buffer.isBuffer(r))return wu(r,t);var n=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+n)},ic=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):ju(r,t)},fd=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var Ei=function(e,r){return e[r]},wo=function(e,r){return e[r+1]*256+e[r]},z2=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},Dn=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},Rs=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},q2=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function Co(e,r){var t="",n,s,o=[],l,c,d,h;switch(r){case"dbcs":if(h=this.l,Ht&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(d=0;d<e;++d)t+=String.fromCharCode(wo(this,h)),h+=2;e*=2;break;case"utf8":t=qo(this,this.l,this.l+e);break;case"utf16le":e*=2,t=dd(this,this.l,this.l+e);break;case"wstr":return Co.call(this,e,"dbcs");case"lpstr-ansi":t=mu(this,this.l),e=4+Dn(this,this.l);break;case"lpstr-cp":t=xu(this,this.l),e=4+Dn(this,this.l);break;case"lpwstr":t=vu(this,this.l),e=4+2*Dn(this,this.l);break;case"lpp4":e=4+Dn(this,this.l),t=bu(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Dn(this,this.l),t=Nu(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(l=Ei(this,this.l+e++))!==0;)o.push(ql(l));t=o.join("");break;case"_wstr":for(e=0,t="";(l=wo(this,this.l+e))!==0;)o.push(ql(l)),e+=2;e+=2,t=o.join("");break;case"dbcs-cont":for(t="",h=this.l,d=0;d<e;++d){if(this.lens&&this.lens.indexOf(h)!==-1)return l=Ei(this,h),this.l=h+1,c=Co.call(this,e-d,l?"dbcs-cont":"sbcs-cont"),o.join("")+c;o.push(ql(wo(this,h))),h+=2}t=o.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",h=this.l,d=0;d!=e;++d){if(this.lens&&this.lens.indexOf(h)!==-1)return l=Ei(this,h),this.l=h+1,c=Co.call(this,e-d,l?"dbcs-cont":"sbcs-cont"),o.join("")+c;o.push(ql(Ei(this,h))),h+=1}t=o.join("");break;default:switch(e){case 1:return n=Ei(this,this.l),this.l++,n;case 2:return n=(r==="i"?z2:wo)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||!(this[this.l+3]&128)?(n=(e>0?Rs:q2)(this,this.l),this.l+=4,n):(s=Dn(this,this.l),this.l+=4,s);case 8:case-8:if(r==="f")return e==8?s=ic(this,this.l):s=ic([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:t=hu(this,this.l,e);break}}return this.l+=e,t}var V2=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},G2=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},$2=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function Y2(e,r,t){var n=0,s=0;if(t==="dbcs"){for(s=0;s!=r.length;++s)$2(this,r.charCodeAt(s),this.l+2*s);n=2*r.length}else if(t==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=r.length;++s)this[this.l+s]=r.charCodeAt(s)&255;n=r.length}else if(t==="hex"){for(;s<e;++s)this[this.l++]=parseInt(r.slice(2*s,2*s+2),16)||0;return this}else if(t==="utf16le"){var o=Math.min(this.l+e,this.length);for(s=0;s<Math.min(r.length,e);++s){var l=r.charCodeAt(s);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,V2(this,r,this.l);break;case 8:if(n=8,t==="f"){W2(this,r,this.l);break}case 16:break;case-4:n=4,G2(this,r,this.l);break}return this.l+=n,this}function Su(e,r){var t=hu(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function On(e,r){e.l=r,e.read_shift=Co,e.chk=Su,e.write_shift=Y2}function Fa(e,r){e.l+=r}function Oe(e){var r=qs(e);return On(r,0),r}function Nn(){var e=[],r=Ht?256:2048,t=function(h){var u=Oe(h);return On(u,0),u},n=t(r),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},o=function(h){return n&&h<n.length-n.l?n:(s(),n=t(Math.max(h+1,r)))},l=function(){return s(),Yr(e)},c=function(h){s(),n=h,n.l==null&&(n.l=n.length),o(r)};return{next:o,push:c,end:l,_bufs:e}}function Ue(e,r,t,n){var s=+r,o;if(!isNaN(s)){n||(n=H4[s].p||(t||[]).length||0),o=1+(s>=128?1:0)+1,n>=128&&++o,n>=16384&&++o,n>=2097152&&++o;var l=e.next(o);s<=127?l.write_shift(1,s):(l.write_shift(1,(s&127)+128),l.write_shift(1,s>>7));for(var c=0;c!=4;++c)if(n>=128)l.write_shift(1,(n&127)+128),n>>=7;else{l.write_shift(1,n);break}n>0&&fd(t)&&e.push(t)}}function Eo(e,r,t){var n=Sn(e);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Qf(e,r,t){var n=Sn(e);return n.s=Eo(n.s,r.s,t),n.e=Eo(n.e,r.s,t),n}function Fo(e,r){if(e.cRel&&e.c<0)for(e=Sn(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=Sn(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=Xt(e);return!e.cRel&&e.cRel!=null&&(t=J2(t)),!e.rRel&&e.rRel!=null&&(t=X2(t)),t}function k0(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+on(e.s.c)+":"+(e.e.cRel?"":"$")+on(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Kr(e.s.r)+":"+(e.e.rRel?"":"$")+Kr(e.e.r):Fo(e.s,r.biff)+":"+Fo(e.e,r.biff)}function hd(e){return parseInt(K2(e),10)-1}function Kr(e){return""+(e+1)}function X2(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function K2(e){return e.replace(/\$(\d+)$/,"$1")}function ud(e){for(var r=Z2(e),t=0,n=0;n!==r.length;++n)t=26*t+r.charCodeAt(n)-64;return t-1}function on(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function J2(e){return e.replace(/^([A-Z])/,"$$$1")}function Z2(e){return e.replace(/^\$([A-Z])/,"$1")}function Q2(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Hr(e){for(var r=0,t=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?r=10*r+(s-48):s>=65&&s<=90&&(t=26*t+(s-64))}return{c:t-1,r:r-1}}function Xt(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function Mn(e){var r=e.indexOf(":");return r==-1?{s:Hr(e),e:Hr(e)}:{s:Hr(e.slice(0,r)),e:Hr(e.slice(r+1))}}function Cr(e,r){return typeof r>"u"||typeof r=="number"?Cr(e.s,e.e):(typeof e!="string"&&(e=Xt(e)),typeof r!="string"&&(r=Xt(r)),e==r?e:e+":"+r)}function lr(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,s=0,o=e.length;for(t=0;n<o&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)t=26*t+s;for(r.s.c=--t,t=0;n<o&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)t=10*t+s;if(r.s.r=--t,n===o||s!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,t=0;n!=o&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)t=26*t+s;for(r.e.c=--t,t=0;n!=o&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)t=10*t+s;return r.e.r=--t,r}function eh(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=Ns(e.z,t?jn(r):r)}catch{}try{return e.w=Ns((e.XF||{}).numFmtId||(t?14:0),t?jn(r):r)}catch{return""+r}}function Xa(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?Vo[e.v]||e.v:r==null?eh(e,e.v):eh(e,r))}function Ys(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",n={};return n[t]=e,{SheetNames:[t],Sheets:n}}function _u(e,r,t){var n=t||{},s=e?Array.isArray(e):n.dense,o=e||(s?[]:{}),l=0,c=0;if(o&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var d=typeof n.origin=="string"?Hr(n.origin):n.origin;l=d.r,c=d.c}o["!ref"]||(o["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var u=lr(o["!ref"]);h.s.c=u.s.c,h.s.r=u.s.r,h.e.c=Math.max(h.e.c,u.e.c),h.e.r=Math.max(h.e.r,u.e.r),l==-1&&(h.e.r=l=u.e.r+1)}for(var g=0;g!=r.length;++g)if(r[g]){if(!Array.isArray(r[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=r[g].length;++x)if(!(typeof r[g][x]>"u")){var m={v:r[g][x]},y=l+g,v=c+x;if(h.s.r>y&&(h.s.r=y),h.s.c>v&&(h.s.c=v),h.e.r<y&&(h.e.r=y),h.e.c<v&&(h.e.c=v),r[g][x]&&typeof r[g][x]=="object"&&!Array.isArray(r[g][x])&&!(r[g][x]instanceof Date))m=r[g][x];else if(Array.isArray(m.v)&&(m.f=r[g][x][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||xr[14],n.cellDates?(m.t="d",m.w=Ns(m.z,jn(m.v))):(m.t="n",m.v=jn(m.v),m.w=Ns(m.z,m.v))):m.t="s";if(s)o[y]||(o[y]=[]),o[y][v]&&o[y][v].z&&(m.z=o[y][v].z),o[y][v]=m;else{var j=Xt({c:v,r:y});o[j]&&o[j].z&&(m.z=o[j].z),o[j]=m}}}return h.s.c<1e7&&(o["!ref"]=Cr(h)),o}function Bi(e,r){return _u(null,e,r)}function eg(e){return e.read_shift(4,"i")}function ma(e,r){return r||(r=Oe(4)),r.write_shift(4,e),r}function ln(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function Wr(e,r){var t=!1;return r==null&&(t=!0,r=Oe(4+2*e.length)),r.write_shift(4,e.length),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}function tg(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function rg(e,r){return r||(r=Oe(4)),r.write_shift(2,0),r.write_shift(2,0),r}function md(e,r){var t=e.l,n=e.read_shift(1),s=ln(e),o=[],l={t:s,h:s};if(n&1){for(var c=e.read_shift(4),d=0;d!=c;++d)o.push(tg(e));l.r=o}else l.r=[{ich:0,ifnt:0}];return e.l=t+r,l}function ng(e,r){var t=!1;return r==null&&(t=!0,r=Oe(15+4*e.t.length)),r.write_shift(1,0),Wr(e.t,r),t?r.slice(0,r.l):r}var ag=md;function sg(e,r){var t=!1;return r==null&&(t=!0,r=Oe(23+4*e.t.length)),r.write_shift(1,1),Wr(e.t,r),r.write_shift(4,1),rg({},r),t?r.slice(0,r.l):r}function Jn(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function Xs(e,r){return r==null&&(r=Oe(8)),r.write_shift(-4,e.c),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}function Ks(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}function Js(e,r){return r==null&&(r=Oe(4)),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}var ig=ln,Au=Wr;function pd(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}function oc(e,r){var t=!1;return r==null&&(t=!0,r=Oe(127)),r.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}var og=ln,K0=pd,xd=oc;function ku(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,n=r[0]&2;e.l+=4;var s=n===0?ic([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):Rs(r,0)>>2;return t?s/100:s}function Tu(e,r){r==null&&(r=Oe(4));var t=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,t=1),n)r.write_shift(-4,((t?s:e)<<2)+(t+2));else throw new Error("unsupported RkNumber "+e)}function Cu(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}function lg(e,r){return r||(r=Oe(16)),r.write_shift(4,e.s.r),r.write_shift(4,e.e.r),r.write_shift(4,e.s.c),r.write_shift(4,e.e.c),r}var Zs=Cu,Ui=lg;function Hi(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Vs(e,r){return(r||Oe(8)).write_shift(8,e,"f")}function cg(e){var r={},t=e.read_shift(1),n=t>>>1,s=e.read_shift(1),o=e.read_shift(2,"i"),l=e.read_shift(1),c=e.read_shift(1),d=e.read_shift(1);switch(e.l++,n){case 0:r.auto=1;break;case 1:r.index=s;var h=vg[s];h&&(r.rgb=fh(h));break;case 2:r.rgb=fh([l,c,d]);break;case 3:r.theme=s;break}return o!=0&&(r.tint=o>0?o/32767:o/32768),r}function lc(e,r){if(r||(r=Oe(8)),!e||e.auto)return r.write_shift(4,0),r.write_shift(4,0),r;e.index!=null?(r.write_shift(1,2),r.write_shift(1,e.index)):e.theme!=null?(r.write_shift(1,6),r.write_shift(1,e.theme)):(r.write_shift(1,5),r.write_shift(1,0));var t=e.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),r.write_shift(2,t),!e.rgb||e.theme!=null)r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),r.write_shift(1,parseInt(n.slice(0,2),16)),r.write_shift(1,parseInt(n.slice(2,4),16)),r.write_shift(1,parseInt(n.slice(4,6),16)),r.write_shift(1,255)}return r}function dg(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function fg(e,r){r||(r=Oe(2));var t=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return r.write_shift(1,t),r.write_shift(1,0),r}var Eu=2,Pn=3,Yl=11,cc=19,Xl=64,hg=65,ug=71,mg=4108,pg=4126,$r=80,th={1:{n:"CodePage",t:Eu},2:{n:"Category",t:$r},3:{n:"PresentationFormat",t:$r},4:{n:"ByteCount",t:Pn},5:{n:"LineCount",t:Pn},6:{n:"ParagraphCount",t:Pn},7:{n:"SlideCount",t:Pn},8:{n:"NoteCount",t:Pn},9:{n:"HiddenCount",t:Pn},10:{n:"MultimediaClipCount",t:Pn},11:{n:"ScaleCrop",t:Yl},12:{n:"HeadingPairs",t:mg},13:{n:"TitlesOfParts",t:pg},14:{n:"Manager",t:$r},15:{n:"Company",t:$r},16:{n:"LinksUpToDate",t:Yl},17:{n:"CharacterCount",t:Pn},19:{n:"SharedDoc",t:Yl},22:{n:"HyperlinksChanged",t:Yl},23:{n:"AppVersion",t:Pn,p:"version"},24:{n:"DigSig",t:hg},26:{n:"ContentType",t:$r},27:{n:"ContentStatus",t:$r},28:{n:"Language",t:$r},29:{n:"Version",t:$r},255:{},2147483648:{n:"Locale",t:cc},2147483651:{n:"Behavior",t:cc},1919054434:{}},rh={1:{n:"CodePage",t:Eu},2:{n:"Title",t:$r},3:{n:"Subject",t:$r},4:{n:"Author",t:$r},5:{n:"Keywords",t:$r},6:{n:"Comments",t:$r},7:{n:"Template",t:$r},8:{n:"LastAuthor",t:$r},9:{n:"RevNumber",t:$r},10:{n:"EditTime",t:Xl},11:{n:"LastPrinted",t:Xl},12:{n:"CreatedDate",t:Xl},13:{n:"ModifiedDate",t:Xl},14:{n:"PageCount",t:Pn},15:{n:"WordCount",t:Pn},16:{n:"CharCount",t:Pn},17:{n:"Thumbnail",t:ug},18:{n:"Application",t:$r},19:{n:"DocSecurity",t:Pn},255:{},2147483648:{n:"Locale",t:cc},2147483651:{n:"Behavior",t:cc},1919054434:{}};function xg(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var gg=xg([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),vg=Sn(gg),Vo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},yg={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Kl={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Fu(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Lu(e,r){var t=C2(yg),n=[],s;n[n.length]=Er,n[n.length]=Ke("Types",null,{xmlns:Ur.CT,"xmlns:xsd":Ur.xsd,"xmlns:xsi":Ur.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(d){return Ke("Default",null,{Extension:d[0],ContentType:d[1]})}));var o=function(d){e[d]&&e[d].length>0&&(s=e[d][0],n[n.length]=Ke("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Kl[d][r.bookType]||Kl[d].xlsx}))},l=function(d){(e[d]||[]).forEach(function(h){n[n.length]=Ke("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:Kl[d][r.bookType]||Kl[d].xlsx})})},c=function(d){(e[d]||[]).forEach(function(h){n[n.length]=Ke("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:t[d][0]})})};return o("workbooks"),l("sheets"),l("charts"),c("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),l("metadata"),c("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Bt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Pu(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function Pi(e){var r=[Er,Ke("Relationships",null,{xmlns:Ur.RELS})];return Jr(e["!id"]).forEach(function(t){r[r.length]=Ke("Relationship",null,e["!id"][t])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function $t(e,r,t,n,s,o){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),r<0)for(r=e["!idx"];e["!id"]["rId"+r];++r);if(e["!idx"]=r+1,s.Id="rId"+r,s.Type=n,s.Target=t,[Bt.HLINK,Bt.XPATH,Bt.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+r);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,r}function bg(e){var r=[Er];r.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),r.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<e.length;++t)r.push('  <manifest:file-entry manifest:full-path="'+e[t][0]+'" manifest:media-type="'+e[t][1]+`"/>
`);return r.push("</manifest:manifest>"),r.join("")}function nh(e,r,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+r+`"/>
`,`  </rdf:Description>
`].join("")}function wg(e,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+`"/>
`,`  </rdf:Description>
`].join("")}function Ng(e){var r=[Er];r.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=e.length;++t)r.push(nh(e[t][0],e[t][1])),r.push(wg("",e[t][0]));return r.push(nh("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}function Ou(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+ec.version+"</meta:generator></office:meta></office:document-meta>"}var zs=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function T0(e,r,t,n,s){s[e]!=null||r==null||r===""||(s[e]=r,r=Yt(r),n[n.length]=t?Ke(e,r,t):Xr(e,r))}function Iu(e,r){var t=r||{},n=[Er,Ke("cp:coreProperties",null,{"xmlns:cp":Ur.CORE_PROPS,"xmlns:dc":Ur.dc,"xmlns:dcterms":Ur.dcterms,"xmlns:dcmitype":Ur.dcmitype,"xmlns:xsi":Ur.xsi})],s={};if(!e&&!t.Props)return n.join("");e&&(e.CreatedDate!=null&&T0("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:X0(e.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&T0("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:X0(e.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var o=0;o!=zs.length;++o){var l=zs[o],c=t.Props&&t.Props[l[1]]!=null?t.Props[l[1]]:e?e[l[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&T0(l[0],c,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Oi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Du=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Ru(e){var r=[],t=Ke;return e||(e={}),e.Application="SheetJS",r[r.length]=Er,r[r.length]=Ke("Properties",null,{xmlns:Ur.EXT_PROPS,"xmlns:vt":Ur.vt}),Oi.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=Yt(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(r[r.length]=t(n[0],s))}}),r[r.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=t("TitlesOfParts",t("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Yt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}function Mu(e){var r=[Er,Ke("Properties",null,{xmlns:Ur.CUST_PROPS,"xmlns:vt":Ur.vt})];if(!e)return r.join("");var t=1;return Jr(e).forEach(function(s){++t,r[r.length]=Ke("property",U2(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Yt(s)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var ah={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function jg(e,r){var t=[];return Jr(ah).map(function(n){for(var s=0;s<zs.length;++s)if(zs[s][1]==n)return zs[s];for(s=0;s<Oi.length;++s)if(Oi[s][1]==n)return Oi[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=r&&r.Props&&r.Props[n[1]]!=null?r.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),t.push(Xr(ah[n[1]]||n[1],s))}}),Ke("DocumentProperties",t.join(""),{xmlns:In.o})}function Sg(e,r){var t=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&Jr(e).forEach(function(o){if(Object.prototype.hasOwnProperty.call(e,o)){for(var l=0;l<zs.length;++l)if(o==zs[l][1])return;for(l=0;l<Oi.length;++l)if(o==Oi[l][1])return;for(l=0;l<t.length;++l)if(o==t[l])return;var c=e[o],d="string";typeof c=="number"?(d="float",c=String(c)):c===!0||c===!1?(d="boolean",c=c?"1":"0"):c=String(c),s.push(Ke(Vf(o),c,{"dt:dt":d}))}}),r&&Jr(r).forEach(function(o){if(Object.prototype.hasOwnProperty.call(r,o)&&!(e&&Object.prototype.hasOwnProperty.call(e,o))){var l=r[o],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l instanceof Date?(c="dateTime.tz",l=l.toISOString()):l=String(l),s.push(Ke(Vf(o),l,{"dt:dt":c}))}}),"<"+n+' xmlns="'+In.o+'">'+s.join("")+"</"+n+">"}function _g(e){var r=typeof e=="string"?new Date(Date.parse(e)):e,t=r.getTime()/1e3+11644473600,n=t%Math.pow(2,32),s=(t-n)/Math.pow(2,32);n*=1e7,s*=1e7;var o=n/Math.pow(2,32)|0;o>0&&(n=n%Math.pow(2,32),s+=o);var l=Oe(8);return l.write_shift(4,n),l.write_shift(4,s),l}function sh(e,r){var t=Oe(4),n=Oe(4);switch(t.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,r);break;case 5:n=Oe(8),n.write_shift(8,r,"f");break;case 11:n.write_shift(4,r?1:0);break;case 64:n=_g(r);break;case 31:case 80:for(n=Oe(4+2*(r.length+1)+(r.length%2?0:2)),n.write_shift(4,r.length+1),n.write_shift(0,r,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}return Yr([t,n])}var Bu=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Ag(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function ih(e,r,t){var n=Oe(8),s=[],o=[],l=8,c=0,d=Oe(8),h=Oe(8);if(d.write_shift(4,2),d.write_shift(4,1200),h.write_shift(4,1),o.push(d),s.push(h),l+=8+d.length,!r){h=Oe(8),h.write_shift(4,0),s.unshift(h);var u=[Oe(4)];for(u[0].write_shift(4,e.length),c=0;c<e.length;++c){var g=e[c][0];for(d=Oe(8+2*(g.length+1)+(g.length%2?0:2)),d.write_shift(4,c+2),d.write_shift(4,g.length+1),d.write_shift(0,g,"dbcs");d.l!=d.length;)d.write_shift(1,0);u.push(d)}d=Yr(u),o.unshift(d),l+=8+d.length}for(c=0;c<e.length;++c)if(!(r&&!r[e[c][0]])&&!(Bu.indexOf(e[c][0])>-1||Du.indexOf(e[c][0])>-1)&&e[c][1]!=null){var x=e[c][1],m=0;if(r){m=+r[e[c][0]];var y=t[m];if(y.p=="version"&&typeof x=="string"){var v=x.split(".");x=(+v[0]<<16)+(+v[1]||0)}d=sh(y.t,x)}else{var j=Ag(x);j==-1&&(j=31,x=String(x)),d=sh(j,x)}o.push(d),h=Oe(8),h.write_shift(4,r?m:2+c),s.push(h),l+=8+d.length}var w=8*(o.length+1);for(c=0;c<o.length;++c)s[c].write_shift(4,w),w+=o[c].length;return n.write_shift(4,l),n.write_shift(4,o.length),Yr([n].concat(s).concat(o))}function oh(e,r,t,n,s,o){var l=Oe(s?68:48),c=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,Zt.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,s?2:1),l.write_shift(16,r,"hex"),l.write_shift(4,s?68:48);var d=ih(e,t,n);if(c.push(d),s){var h=ih(s,null,null);l.write_shift(16,o,"hex"),l.write_shift(4,68+d.length),c.push(h)}return Yr(c)}function kg(e,r){r||(r=Oe(e));for(var t=0;t<e;++t)r.write_shift(1,0);return r}function Tg(e,r){return e.read_shift(r)===1}function un(e,r){return r||(r=Oe(2)),r.write_shift(2,+!!e),r}function Uu(e){return e.read_shift(2,"u")}function Kn(e,r){return r||(r=Oe(2)),r.write_shift(2,e),r}function Hu(e,r,t){return t||(t=Oe(2)),t.write_shift(1,r=="e"?+e:+!!e),t.write_shift(1,r=="e"?1:0),t}function Wu(e,r,t){var n=e.read_shift(t&&t.biff>=12?2:1),s="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var o=e.read_shift(1);o&&(s="dbcs-cont")}else t.biff==12&&(s="wstr");t.biff>=2&&t.biff<=5&&(s="cpstr");var l=n?e.read_shift(n,s):"";return l}function Cg(e){var r=e.t||"",t=Oe(3);t.write_shift(2,r.length),t.write_shift(1,1);var n=Oe(2*r.length);n.write_shift(2*r.length,r,"utf16le");var s=[t,n];return Yr(s)}function Eg(e,r,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(r,"sbcs-cont"):n=e.read_shift(r,"dbcs-cont"),n}function Fg(e,r,t){var n=e.read_shift(t&&t.biff==2?1:2);return n===0?(e.l++,""):Eg(e,n,t)}function Lg(e,r,t){if(t.biff>5)return Fg(e,r,t);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function zu(e,r,t){return t||(t=Oe(3+2*e.length)),t.write_shift(2,e.length),t.write_shift(1,1),t.write_shift(31,e,"utf16le"),t}function lh(e,r){r||(r=Oe(6+e.length*2)),r.write_shift(4,1+e.length);for(var t=0;t<e.length;++t)r.write_shift(2,e.charCodeAt(t));return r.write_shift(2,0),r}function Pg(e){var r=Oe(512),t=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),o=s>-1?31:23;switch(n.charAt(0)){case"#":o=28;break;case".":o&=-3;break}r.write_shift(4,2),r.write_shift(4,o);var l=[8,6815827,6619237,4849780,83];for(t=0;t<l.length;++t)r.write_shift(4,l[t]);if(o==28)n=n.slice(1),lh(n,r);else if(o&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<l.length;++t)r.write_shift(1,parseInt(l[t],16));var c=s>-1?n.slice(0,s):n;for(r.write_shift(4,2*(c.length+1)),t=0;t<c.length;++t)r.write_shift(2,c.charCodeAt(t));r.write_shift(2,0),o&8&&lh(s>-1?n.slice(s+1):"",r)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<l.length;++t)r.write_shift(1,parseInt(l[t],16));for(var d=0;n.slice(d*3,d*3+3)=="../"||n.slice(d*3,d*3+3)=="..\\";)++d;for(r.write_shift(2,d),r.write_shift(4,n.length-3*d+1),t=0;t<n.length-3*d;++t)r.write_shift(1,n.charCodeAt(t+3*d)&255);for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),t=0;t<6;++t)r.write_shift(4,0)}return r.slice(0,r.l)}function Gs(e,r,t,n){return n||(n=Oe(6)),n.write_shift(2,e),n.write_shift(2,r),n.write_shift(2,t||0),n}function Og(e,r,t){var n=t.biff>8?4:2,s=e.read_shift(n),o=e.read_shift(n,"i"),l=e.read_shift(n,"i");return[s,o,l]}function Ig(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r},e:{c:s,r:t}}}function qu(e,r){return r||(r=Oe(8)),r.write_shift(2,e.s.r),r.write_shift(2,e.e.r),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c),r}function gd(e,r,t){var n=1536,s=16;switch(t.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var o=Oe(s);return o.write_shift(2,n),o.write_shift(2,r),s>4&&o.write_shift(2,29282),s>6&&o.write_shift(2,1997),s>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function Dg(e,r){var t=!r||r.biff==8,n=Oe(t?112:54);for(n.write_shift(r.biff==8?2:1,7),t&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(t?0:536870912));n.l<n.length;)n.write_shift(1,t?0:32);return n}function Rg(e,r){var t=!r||r.biff>=8?2:1,n=Oe(8+t*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),r.biff>=8&&n.write_shift(1,1),n.write_shift(t*e.name.length,e.name,r.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function Mg(e,r){var t=Oe(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=Cg(e[s]);var o=Yr([t].concat(n));return o.parts=[t.length].concat(n.map(function(l){return l.length})),o}function Bg(){var e=Oe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Ug(e){var r=Oe(18),t=1718;return e&&e.RTL&&(t|=64),r.write_shift(2,t),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}function Hg(e,r){var t=e.name||"Arial",n=r&&r.biff==5,s=n?15+t.length:16+2*t.length,o=Oe(s);return o.write_shift(2,e.sz*20),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,t.length),n||o.write_shift(1,1),o.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le"),o}function Wg(e,r,t,n){var s=Oe(10);return Gs(e,r,n,s),s.write_shift(4,t),s}function zg(e,r,t,n,s){var o=!s||s.biff==8,l=Oe(8+ +o+(1+o)*t.length);return Gs(e,r,n,l),l.write_shift(2,t.length),o&&l.write_shift(1,1),l.write_shift((1+o)*t.length,t,o?"utf16le":"sbcs"),l}function qg(e,r,t,n){var s=t&&t.biff==5;n||(n=Oe(s?3+r.length:5+2*r.length)),n.write_shift(2,e),n.write_shift(s?1:2,r.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*r.length,r,s?"sbcs":"utf16le");var o=n.length>n.l?n.slice(0,n.l):n;return o.l==null&&(o.l=o.length),o}function Vg(e,r){var t=r.biff==8||!r.biff?4:2,n=Oe(2*t+6);return n.write_shift(t,e.s.r),n.write_shift(t,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function ch(e,r,t,n){var s=t&&t.biff==5;n||(n=Oe(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,r<<4));var o=0;return e.numFmtId>0&&s&&(o|=1024),n.write_shift(4,o),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function Gg(e){var r=Oe(8);return r.write_shift(4,0),r.write_shift(2,0),r.write_shift(2,0),r}function $g(e,r,t,n,s,o){var l=Oe(8);return Gs(e,r,n,l),Hu(t,o,l),l}function Yg(e,r,t,n){var s=Oe(14);return Gs(e,r,n,s),Vs(t,s),s}function Xg(e,r,t){if(t.biff<8)return Kg(e,r,t);for(var n=[],s=e.l+r,o=e.read_shift(t.biff>8?4:2);o--!==0;)n.push(Og(e,t.biff>8?12:6,t));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function Kg(e,r,t){e[e.l+1]==3&&e[e.l]++;var n=Wu(e,r,t);return n.charCodeAt(0)==3?n.slice(1):n}function Jg(e){var r=Oe(2+e.length*8);r.write_shift(2,e.length);for(var t=0;t<e.length;++t)qu(e[t],r);return r}function Zg(e){var r=Oe(24),t=Hr(e[0]);r.write_shift(2,t.r),r.write_shift(2,t.r),r.write_shift(2,t.c),r.write_shift(2,t.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)r.write_shift(1,parseInt(n[s],16));return Yr([r,Pg(e[1])])}function Qg(e){var r=e[1].Tooltip,t=Oe(10+2*(r.length+1));t.write_shift(2,2048);var n=Hr(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var s=0;s<r.length;++s)t.write_shift(2,r.charCodeAt(s));return t.write_shift(2,0),t}function ev(e){return e||(e=Oe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function tv(e,r,t){if(!t.cellStyles)return Fa(e,r);var n=t&&t.biff>=12?4:2,s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(n),d=e.read_shift(2);n==2&&(e.l+=2);var h={s,e:o,w:l,ixfe:c,flags:d};return(t.biff>=5||!t.biff)&&(h.level=d>>8&7),h}function rv(e,r){var t=Oe(12);t.write_shift(2,r),t.write_shift(2,r),t.write_shift(2,e.width*256),t.write_shift(2,0);var n=0;return e.hidden&&(n|=1),t.write_shift(1,n),n=e.level||0,t.write_shift(1,n),t.write_shift(2,0),t}function nv(e){for(var r=Oe(2*e),t=0;t<e;++t)r.write_shift(2,t+1);return r}function av(e,r,t){var n=Oe(15);return $o(n,e,r),n.write_shift(8,t,"f"),n}function sv(e,r,t){var n=Oe(9);return $o(n,e,r),n.write_shift(2,t),n}var iv=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=id({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(c,d){var h=[],u=qs(1);switch(d.type){case"base64":u=ha(Ya(c));break;case"binary":u=ha(c);break;case"buffer":case"array":u=c;break}On(u,0);var g=u.read_shift(1),x=!!(g&136),m=!1,y=!1;switch(g){case 2:break;case 3:break;case 48:m=!0,x=!0;break;case 49:m=!0,x=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var v=0,j=521;g==2&&(v=u.read_shift(2)),u.l+=3,g!=2&&(v=u.read_shift(4)),v>1048576&&(v=1e6),g!=2&&(j=u.read_shift(2));var w=u.read_shift(2),N=d.codepage||1252;g!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(N=e[u[u.l]]),u.l+=1,u.l+=2),y&&(u.l+=36);for(var _=[],C={},M=Math.min(u.length,g==2?521:j-10-(m?264:0)),D=y?32:11;u.l<M&&u[u.l]!=13;)switch(C={},C.name=tc.utils.decode(N,u.slice(u.l,u.l+D)).replace(/[\u0000\r\n].*$/g,""),u.l+=D,C.type=String.fromCharCode(u.read_shift(1)),g!=2&&!y&&(C.offset=u.read_shift(4)),C.len=u.read_shift(1),g==2&&(C.offset=u.read_shift(2)),C.dec=u.read_shift(1),C.name.length&&_.push(C),g!=2&&(u.l+=y?13:14),C.type){case"B":(!m||C.len!=8)&&d.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+C.type)}if(u[u.l]!==13&&(u.l=j-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=j;var L=0,E=0;for(h[0]=[],E=0;E!=_.length;++E)h[0][E]=_[E].name;for(;v-- >0;){if(u[u.l]===42){u.l+=w;continue}for(++u.l,h[++L]=[],E=0,E=0;E!=_.length;++E){var P=u.slice(u.l,u.l+_[E].len);u.l+=_[E].len,On(P,0);var H=tc.utils.decode(N,P);switch(_[E].type){case"C":H.trim().length&&(h[L][E]=H.replace(/\s+$/,""));break;case"D":H.length===8?h[L][E]=new Date(+H.slice(0,4),+H.slice(4,6)-1,+H.slice(6,8)):h[L][E]=H;break;case"F":h[L][E]=parseFloat(H.trim());break;case"+":case"I":h[L][E]=y?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(H.trim().toUpperCase()){case"Y":case"T":h[L][E]=!0;break;case"N":case"F":h[L][E]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+H+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));h[L][E]="##MEMO##"+(y?parseInt(H.trim(),10):P.read_shift(4));break;case"N":H=H.replace(/\u0000/g,"").trim(),H&&H!="."&&(h[L][E]=+H||0);break;case"@":h[L][E]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":h[L][E]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":h[L][E]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[L][E]=-P.read_shift(-8,"f");break;case"B":if(m&&_[E].len==8){h[L][E]=P.read_shift(8,"f");break}case"G":case"P":P.l+=_[E].len;break;case"0":if(_[E].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[E].type)}}}if(g!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return d&&d.sheetRows&&(h=h.slice(0,d.sheetRows)),d.DBF=_,h}function n(c,d){var h=d||{};h.dateNF||(h.dateNF="yyyymmdd");var u=Bi(t(c,h),h);return u["!cols"]=h.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete h.DBF,u}function s(c,d){try{return Ys(n(c,d),d)}catch(h){if(d&&d.WTF)throw h}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function l(c,d){var h=d||{};if(+h.codepage>=0&&Io(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var u=Nn(),g=mc(c,{header:1,raw:!0,cellDates:!0}),x=g[0],m=g.slice(1),y=c["!cols"]||[],v=0,j=0,w=0,N=1;for(v=0;v<x.length;++v){if(((y[v]||{}).DBF||{}).name){x[v]=y[v].DBF.name,++w;continue}if(x[v]!=null){if(++w,typeof x[v]=="number"&&(x[v]=x[v].toString(10)),typeof x[v]!="string")throw new Error("DBF Invalid column name "+x[v]+" |"+typeof x[v]+"|");if(x.indexOf(x[v])!==v){for(j=0;j<1024;++j)if(x.indexOf(x[v]+"_"+j)==-1){x[v]+="_"+j;break}}}}var _=lr(c["!ref"]),C=[],M=[],D=[];for(v=0;v<=_.e.c-_.s.c;++v){var L="",E="",P=0,H=[];for(j=0;j<m.length;++j)m[j][v]!=null&&H.push(m[j][v]);if(H.length==0||x[v]==null){C[v]="?";continue}for(j=0;j<H.length;++j){switch(typeof H[j]){case"number":E="B";break;case"string":E="C";break;case"boolean":E="L";break;case"object":E=H[j]instanceof Date?"D":"C";break;default:E="C"}P=Math.max(P,String(H[j]).length),L=L&&L!=E?"C":E}P>250&&(P=250),E=((y[v]||{}).DBF||{}).type,E=="C"&&y[v].DBF.len>P&&(P=y[v].DBF.len),L=="B"&&E=="N"&&(L="N",D[v]=y[v].DBF.dec,P=y[v].DBF.len),M[v]=L=="C"||E=="N"?P:o[L]||0,N+=M[v],C[v]=L}var k=u.next(32);for(k.write_shift(4,318902576),k.write_shift(4,m.length),k.write_shift(2,296+32*w),k.write_shift(2,N),v=0;v<4;++v)k.write_shift(4,0);for(k.write_shift(4,0|(+r[Gh]||3)<<8),v=0,j=0;v<x.length;++v)if(x[v]!=null){var T=u.next(32),W=(x[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);T.write_shift(1,W,"sbcs"),T.write_shift(1,C[v]=="?"?"C":C[v],"sbcs"),T.write_shift(4,j),T.write_shift(1,M[v]||o[C[v]]||0),T.write_shift(1,D[v]||0),T.write_shift(1,2),T.write_shift(4,0),T.write_shift(1,0),T.write_shift(4,0),T.write_shift(4,0),j+=M[v]||o[C[v]]||0}var G=u.next(264);for(G.write_shift(4,13),v=0;v<65;++v)G.write_shift(4,0);for(v=0;v<m.length;++v){var de=u.next(N);for(de.write_shift(1,0),j=0;j<x.length;++j)if(x[j]!=null)switch(C[j]){case"L":de.write_shift(1,m[v][j]==null?63:m[v][j]?84:70);break;case"B":de.write_shift(8,m[v][j]||0,"f");break;case"N":var J="0";for(typeof m[v][j]=="number"&&(J=m[v][j].toFixed(D[j]||0)),w=0;w<M[j]-J.length;++w)de.write_shift(1,32);de.write_shift(1,J,"sbcs");break;case"D":m[v][j]?(de.write_shift(4,("0000"+m[v][j].getFullYear()).slice(-4),"sbcs"),de.write_shift(2,("00"+(m[v][j].getMonth()+1)).slice(-2),"sbcs"),de.write_shift(2,("00"+m[v][j].getDate()).slice(-2),"sbcs")):de.write_shift(8,"00000000","sbcs");break;case"C":var Z=String(m[v][j]!=null?m[v][j]:"").slice(0,M[j]);for(de.write_shift(1,Z,"sbcs"),w=0;w<M[j]-Z.length;++w)de.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:n,from_sheet:l}}(),ov=function(){var e={AA:"Ã€",BA:"Ã",CA:"Ã‚",DA:195,HA:"Ã„",JA:197,AE:"Ãˆ",BE:"Ã‰",CE:"ÃŠ",HE:"Ã‹",AI:"ÃŒ",BI:"Ã",CI:"ÃŽ",HI:"Ã",AO:"Ã’",BO:"Ã“",CO:"Ã”",DO:213,HO:"Ã–",AU:"Ã™",BU:"Ãš",CU:"Ã›",HU:"Ãœ",Aa:"Ã ",Ba:"Ã¡",Ca:"Ã¢",Da:227,Ha:"Ã¤",Ja:229,Ae:"Ã¨",Be:"Ã©",Ce:"Ãª",He:"Ã«",Ai:"Ã¬",Bi:"Ã­",Ci:"Ã®",Hi:"Ã¯",Ao:"Ã²",Bo:"Ã³",Co:"Ã´",Do:245,Ho:"Ã¶",Au:"Ã¹",Bu:"Ãº",Cu:"Ã»",Hu:"Ã¼",KC:"Ã‡",Kc:"Ã§",q:"Ã¦",z:"Å“",a:"Ã†",j:"Å’",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+Jr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(x,m){var y=e[m];return typeof y=="number"?Pf(y):y},n=function(x,m,y){var v=m.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return v==59?x:Pf(v)};e["|"]=254;function s(x,m){switch(m.type){case"base64":return o(Ya(x),m);case"binary":return o(x,m);case"buffer":return o(Ht&&Buffer.isBuffer(x)?x.toString("binary"):Wo(x),m);case"array":return o(jc(x),m)}throw new Error("Unrecognized type "+m.type)}function o(x,m){var y=x.split(/[\n\r]+/),v=-1,j=-1,w=0,N=0,_=[],C=[],M=null,D={},L=[],E=[],P=[],H=0,k;for(+m.codepage>=0&&Io(+m.codepage);w!==y.length;++w){H=0;var T=y[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,t),W=T.replace(/;;/g,"\0").split(";").map(function(R){return R.replace(/\u0000/g,";")}),G=W[0],de;if(T.length>0)switch(G){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":W[1].charAt(0)=="P"&&C.push(T.slice(3).replace(/;;/g,";"));break;case"C":var J=!1,Z=!1,oe=!1,ae=!1,pe=-1,be=-1;for(N=1;N<W.length;++N)switch(W[N].charAt(0)){case"A":break;case"X":j=parseInt(W[N].slice(1))-1,Z=!0;break;case"Y":for(v=parseInt(W[N].slice(1))-1,Z||(j=0),k=_.length;k<=v;++k)_[k]=[];break;case"K":de=W[N].slice(1),de.charAt(0)==='"'?de=de.slice(1,de.length-1):de==="TRUE"?de=!0:de==="FALSE"?de=!1:isNaN(Ga(de))?isNaN(Ro(de).getDate())||(de=mn(de)):(de=Ga(de),M!==null&&au(M)&&(de=lu(de))),J=!0;break;case"E":ae=!0;var A=s5(W[N].slice(1),{r:v,c:j});_[v][j]=[_[v][j],A];break;case"S":oe=!0,_[v][j]=[_[v][j],"S5S"];break;case"G":break;case"R":pe=parseInt(W[N].slice(1))-1;break;case"C":be=parseInt(W[N].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+T)}if(J&&(_[v][j]&&_[v][j].length==2?_[v][j][0]=de:_[v][j]=de,M=null),oe){if(ae)throw new Error("SYLK shared formula cannot have own formula");var O=pe>-1&&_[pe][be];if(!O||!O[1])throw new Error("SYLK shared formula cannot find base");_[v][j][1]=i5(O[1],{r:v-pe,c:j-be})}break;case"F":var I=0;for(N=1;N<W.length;++N)switch(W[N].charAt(0)){case"X":j=parseInt(W[N].slice(1))-1,++I;break;case"Y":for(v=parseInt(W[N].slice(1))-1,k=_.length;k<=v;++k)_[k]=[];break;case"M":H=parseInt(W[N].slice(1))/20;break;case"F":break;case"G":break;case"P":M=C[parseInt(W[N].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=W[N].slice(1).split(" "),k=parseInt(P[0],10);k<=parseInt(P[1],10);++k)H=parseInt(P[2],10),E[k-1]=H===0?{hidden:!0}:{wch:H},vd(E[k-1]);break;case"C":j=parseInt(W[N].slice(1))-1,E[j]||(E[j]={});break;case"R":v=parseInt(W[N].slice(1))-1,L[v]||(L[v]={}),H>0?(L[v].hpt=H,L[v].hpx=Xu(H)):H===0&&(L[v].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+T)}I<1&&(M=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+T)}}return L.length>0&&(D["!rows"]=L),E.length>0&&(D["!cols"]=E),m&&m.sheetRows&&(_=_.slice(0,m.sheetRows)),[_,D]}function l(x,m){var y=s(x,m),v=y[0],j=y[1],w=Bi(v,m);return Jr(j).forEach(function(N){w[N]=j[N]}),w}function c(x,m){return Ys(l(x,m),m)}function d(x,m,y,v){var j="C;Y"+(y+1)+";X"+(v+1)+";K";switch(x.t){case"n":j+=x.v||0,x.f&&!x.F&&(j+=";E"+bd(x.f,{r:y,c:v}));break;case"b":j+=x.v?"TRUE":"FALSE";break;case"e":j+=x.w||x.v;break;case"d":j+='"'+(x.w||x.v)+'"';break;case"s":j+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return j}function h(x,m){m.forEach(function(y,v){var j="F;W"+(v+1)+" "+(v+1)+" ";y.hidden?j+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=dc(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=fc(y.wpx)),typeof y.wch=="number"&&(j+=Math.round(y.wch))),j.charAt(j.length-1)!=" "&&x.push(j)})}function u(x,m){m.forEach(function(y,v){var j="F;";y.hidden?j+="M0;":y.hpt?j+="M"+20*y.hpt+";":y.hpx&&(j+="M"+20*hc(y.hpx)+";"),j.length>2&&x.push(j+"R"+(v+1))})}function g(x,m){var y=["ID;PWXL;N;E"],v=[],j=lr(x["!ref"]),w,N=Array.isArray(x),_=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),x["!cols"]&&h(y,x["!cols"]),x["!rows"]&&u(y,x["!rows"]),y.push("B;Y"+(j.e.r-j.s.r+1)+";X"+(j.e.c-j.s.c+1)+";D"+[j.s.c,j.s.r,j.e.c,j.e.r].join(" "));for(var C=j.s.r;C<=j.e.r;++C)for(var M=j.s.c;M<=j.e.c;++M){var D=Xt({r:C,c:M});w=N?(x[C]||[])[M]:x[D],!(!w||w.v==null&&(!w.f||w.F))&&v.push(d(w,x,C,M))}return y.join(_)+_+v.join(_)+_+"E"+_}return{to_workbook:c,to_sheet:l,from_sheet:g}}(),lv=function(){function e(o,l){switch(l.type){case"base64":return r(Ya(o),l);case"binary":return r(o,l);case"buffer":return r(Ht&&Buffer.isBuffer(o)?o.toString("binary"):Wo(o),l);case"array":return r(jc(o),l)}throw new Error("Unrecognized type "+l.type)}function r(o,l){for(var c=o.split(`
`),d=-1,h=-1,u=0,g=[];u!==c.length;++u){if(c[u].trim()==="BOT"){g[++d]=[],h=0;continue}if(!(d<0)){var x=c[u].trim().split(","),m=x[0],y=x[1];++u;for(var v=c[u]||"";(v.match(/["]/g)||[]).length&1&&u<c.length-1;)v+=`
`+c[++u];switch(v=v.trim(),+m){case-1:if(v==="BOT"){g[++d]=[],h=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?g[d][h]=!0:v==="FALSE"?g[d][h]=!1:isNaN(Ga(y))?isNaN(Ro(y).getDate())?g[d][h]=y:g[d][h]=mn(y):g[d][h]=Ga(y),++h;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),g[d][h++]=v!==""?v:null;break}if(v==="EOD")break}}return l&&l.sheetRows&&(g=g.slice(0,l.sheetRows)),g}function t(o,l){return Bi(e(o,l),l)}function n(o,l){return Ys(t(o,l),l)}var s=function(){var o=function(d,h,u,g,x){d.push(h),d.push(u+","+g),d.push('"'+x.replace(/"/g,'""')+'"')},l=function(d,h,u,g){d.push(h+","+u),d.push(h==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(d){var h=[],u=lr(d["!ref"]),g,x=Array.isArray(d);o(h,"TABLE",0,1,"sheetjs"),o(h,"VECTORS",0,u.e.r-u.s.r+1,""),o(h,"TUPLES",0,u.e.c-u.s.c+1,""),o(h,"DATA",0,0,"");for(var m=u.s.r;m<=u.e.r;++m){l(h,-1,0,"BOT");for(var y=u.s.c;y<=u.e.c;++y){var v=Xt({r:m,c:y});if(g=x?(d[m]||[])[y]:d[v],!g){l(h,1,0,"");continue}switch(g.t){case"n":var j=g.w;!j&&g.v!=null&&(j=g.v),j==null?g.f&&!g.F?l(h,1,0,"="+g.f):l(h,1,0,""):l(h,0,j,"V");break;case"b":l(h,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":l(h,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=Ns(g.z||xr[14],jn(mn(g.v)))),l(h,0,g.w,"V");break;default:l(h,1,0,"")}}}l(h,-1,0,"EOD");var w=`\r
`,N=h.join(w);return N}}();return{to_workbook:n,to_sheet:t,from_sheet:s}}(),Vu=function(){function e(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(g,x){for(var m=g.split(`
`),y=-1,v=-1,j=0,w=[];j!==m.length;++j){var N=m[j].trim().split(":");if(N[0]==="cell"){var _=Hr(N[1]);if(w.length<=_.r)for(y=w.length;y<=_.r;++y)w[y]||(w[y]=[]);switch(y=_.r,v=_.c,N[2]){case"t":w[y][v]=e(N[3]);break;case"v":w[y][v]=+N[3];break;case"vtf":var C=N[N.length-1];case"vtc":switch(N[3]){case"nl":w[y][v]=!!+N[4];break;default:w[y][v]=+N[4];break}N[2]=="vtf"&&(w[y][v]=[w[y][v],C])}}}return x&&x.sheetRows&&(w=w.slice(0,x.sheetRows)),w}function n(g,x){return Bi(t(g,x),x)}function s(g,x){return Ys(n(g,x),x)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function h(g){if(!g||!g["!ref"])return"";for(var x=[],m=[],y,v="",j=Mn(g["!ref"]),w=Array.isArray(g),N=j.s.r;N<=j.e.r;++N)for(var _=j.s.c;_<=j.e.c;++_)if(v=Xt({r:N,c:_}),y=w?(g[N]||[])[_]:g[v],!(!y||y.v==null||y.t==="z")){switch(m=["cell",v,"t"],y.t){case"s":case"str":m.push(r(y.v));break;case"n":y.f?(m[2]="vtf",m[3]="n",m[4]=y.v,m[5]=r(y.f)):(m[2]="v",m[3]=y.v);break;case"b":m[2]="vt"+(y.f?"f":"c"),m[3]="nl",m[4]=y.v?"1":"0",m[5]=r(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var C=jn(mn(y.v));m[2]="vtc",m[3]="nd",m[4]=""+C,m[5]=y.w||Ns(y.z||xr[14],C);break;case"e":continue}x.push(m.join(":"))}return x.push("sheet:c:"+(j.e.c-j.s.c+1)+":r:"+(j.e.r-j.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function u(g){return[o,l,c,l,h(g),d].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:u}}(),cv=function(){function e(u,g,x,m,y){y.raw?g[x][m]=u:u===""||(u==="TRUE"?g[x][m]=!0:u==="FALSE"?g[x][m]=!1:isNaN(Ga(u))?isNaN(Ro(u).getDate())?g[x][m]=u:g[x][m]=mn(u):g[x][m]=Ga(u))}function r(u,g){var x=g||{},m=[];if(!u||u.length===0)return m;for(var y=u.split(/[\r\n]/),v=y.length-1;v>=0&&y[v].length===0;)--v;for(var j=10,w=0,N=0;N<=v;++N)w=y[N].indexOf(" "),w==-1?w=y[N].length:w++,j=Math.max(j,w);for(N=0;N<=v;++N){m[N]=[];var _=0;for(e(y[N].slice(0,j).trim(),m,N,_,x),_=1;_<=(y[N].length-j)/10+1;++_)e(y[N].slice(j+(_-1)*10,j+_*10).trim(),m,N,_,x)}return x.sheetRows&&(m=m.slice(0,x.sheetRows)),m}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(u){for(var g={},x=!1,m=0,y=0;m<u.length;++m)(y=u.charCodeAt(m))==34?x=!x:!x&&y in t&&(g[y]=(g[y]||0)+1);y=[];for(m in g)Object.prototype.hasOwnProperty.call(g,m)&&y.push([g[m],m]);if(!y.length){g=n;for(m in g)Object.prototype.hasOwnProperty.call(g,m)&&y.push([g[m],m])}return y.sort(function(v,j){return v[0]-j[0]||n[v[1]]-n[j[1]]}),t[y.pop()[1]]||44}function o(u,g){var x=g||{},m="",y=x.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(m=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(m=u.charAt(4),u=u.slice(6)):m=s(u.slice(0,1024)):x&&x.FS?m=x.FS:m=s(u.slice(0,1024));var j=0,w=0,N=0,_=0,C=0,M=m.charCodeAt(0),D=!1,L=0,E=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var P=x.dateNF!=null?_2(x.dateNF):null;function H(){var k=u.slice(_,C),T={};if(k.charAt(0)=='"'&&k.charAt(k.length-1)=='"'&&(k=k.slice(1,-1).replace(/""/g,'"')),k.length===0)T.t="z";else if(x.raw)T.t="s",T.v=k;else if(k.trim().length===0)T.t="s",T.v=k;else if(k.charCodeAt(0)==61)k.charCodeAt(1)==34&&k.charCodeAt(k.length-1)==34?(T.t="s",T.v=k.slice(2,-1).replace(/""/g,'"')):o5(k)?(T.t="n",T.f=k.slice(1)):(T.t="s",T.v=k);else if(k=="TRUE")T.t="b",T.v=!0;else if(k=="FALSE")T.t="b",T.v=!1;else if(!isNaN(N=Ga(k)))T.t="n",x.cellText!==!1&&(T.w=k),T.v=N;else if(!isNaN(Ro(k).getDate())||P&&k.match(P)){T.z=x.dateNF||xr[14];var W=0;P&&k.match(P)&&(k=A2(k,x.dateNF,k.match(P)||[]),W=1),x.cellDates?(T.t="d",T.v=mn(k,W)):(T.t="n",T.v=jn(mn(k,W))),x.cellText!==!1&&(T.w=Ns(T.z,T.v instanceof Date?jn(T.v):T.v)),x.cellNF||delete T.z}else T.t="s",T.v=k;if(T.t=="z"||(x.dense?(y[j]||(y[j]=[]),y[j][w]=T):y[Xt({c:w,r:j})]=T),_=C+1,E=u.charCodeAt(_),v.e.c<w&&(v.e.c=w),v.e.r<j&&(v.e.r=j),L==M)++w;else if(w=0,++j,x.sheetRows&&x.sheetRows<=j)return!0}e:for(;C<u.length;++C)switch(L=u.charCodeAt(C)){case 34:E===34&&(D=!D);break;case M:case 10:case 13:if(!D&&H())break e;break}return C-_>0&&H(),y["!ref"]=Cr(v),y}function l(u,g){return!(g&&g.PRN)||g.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?o(u,g):Bi(r(u,g),g)}function c(u,g){var x="",m=g.type=="string"?[0,0,0,0]:ww(u,g);switch(g.type){case"base64":x=Ya(u);break;case"binary":x=u;break;case"buffer":g.codepage==65001?x=u.toString("utf8"):g.codepage&&typeof tc<"u"||(x=Ht&&Buffer.isBuffer(u)?u.toString("binary"):Wo(u));break;case"array":x=jc(u);break;case"string":x=u;break;default:throw new Error("Unrecognized type "+g.type)}return m[0]==239&&m[1]==187&&m[2]==191?x=To(x.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?x=To(x):g.type=="binary"&&typeof tc<"u",x.slice(0,19)=="socialcalc:version:"?Vu.to_sheet(g.type=="string"?x:To(x),g):l(x,g)}function d(u,g){return Ys(c(u,g),g)}function h(u){for(var g=[],x=lr(u["!ref"]),m,y=Array.isArray(u),v=x.s.r;v<=x.e.r;++v){for(var j=[],w=x.s.c;w<=x.e.c;++w){var N=Xt({r:v,c:w});if(m=y?(u[v]||[])[w]:u[N],!m||m.v==null){j.push("          ");continue}for(var _=(m.w||(Xa(m),m.w)||"").slice(0,10);_.length<10;)_+=" ";j.push(_+(w===0?" ":""))}g.push(j.join(""))}return g.join(`
`)}return{to_workbook:d,to_sheet:c,from_sheet:h}}(),dh=function(){function e(A,O,I){if(A){On(A,A.l||0);for(var R=I.Enum||pe;A.l<A.length;){var X=A.read_shift(2),fe=R[X]||R[65535],he=A.read_shift(2),ee=A.l+he,ve=fe.f&&fe.f(A,he,I);if(A.l=ee,O(ve,fe,X))return}}}function r(A,O){switch(O.type){case"base64":return t(ha(Ya(A)),O);case"binary":return t(ha(A),O);case"buffer":case"array":return t(A,O)}throw"Unsupported type "+O.type}function t(A,O){if(!A)return A;var I=O||{},R=I.dense?[]:{},X="Sheet1",fe="",he=0,ee={},ve=[],Ce=[],Ie={s:{r:0,c:0},e:{r:0,c:0}},Ve=I.sheetRows||0;if(A[2]==0&&(A[3]==8||A[3]==9)&&A.length>=16&&A[14]==5&&A[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(A[2]==2)I.Enum=pe,e(A,function(Be,Ze,We){switch(We){case 0:I.vers=Be,Be>=4096&&(I.qpro=!0);break;case 6:Ie=Be;break;case 204:Be&&(fe=Be);break;case 222:fe=Be;break;case 15:case 51:I.qpro||(Be[1].v=Be[1].v.slice(1));case 13:case 14:case 16:We==14&&(Be[2]&112)==112&&(Be[2]&15)>1&&(Be[2]&15)<15&&(Be[1].z=I.dateNF||xr[14],I.cellDates&&(Be[1].t="d",Be[1].v=lu(Be[1].v))),I.qpro&&Be[3]>he&&(R["!ref"]=Cr(Ie),ee[X]=R,ve.push(X),R=I.dense?[]:{},Ie={s:{r:0,c:0},e:{r:0,c:0}},he=Be[3],X=fe||"Sheet"+(he+1),fe="");var Ye=I.dense?(R[Be[0].r]||[])[Be[0].c]:R[Xt(Be[0])];if(Ye){Ye.t=Be[1].t,Ye.v=Be[1].v,Be[1].z!=null&&(Ye.z=Be[1].z),Be[1].f!=null&&(Ye.f=Be[1].f);break}I.dense?(R[Be[0].r]||(R[Be[0].r]=[]),R[Be[0].r][Be[0].c]=Be[1]):R[Xt(Be[0])]=Be[1];break}},I);else if(A[2]==26||A[2]==14)I.Enum=be,A[2]==14&&(I.qpro=!0,A.l=0),e(A,function(Be,Ze,We){switch(We){case 204:X=Be;break;case 22:Be[1].v=Be[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Be[3]>he&&(R["!ref"]=Cr(Ie),ee[X]=R,ve.push(X),R=I.dense?[]:{},Ie={s:{r:0,c:0},e:{r:0,c:0}},he=Be[3],X="Sheet"+(he+1)),Ve>0&&Be[0].r>=Ve)break;I.dense?(R[Be[0].r]||(R[Be[0].r]=[]),R[Be[0].r][Be[0].c]=Be[1]):R[Xt(Be[0])]=Be[1],Ie.e.c<Be[0].c&&(Ie.e.c=Be[0].c),Ie.e.r<Be[0].r&&(Ie.e.r=Be[0].r);break;case 27:Be[14e3]&&(Ce[Be[14e3][0]]=Be[14e3][1]);break;case 1537:Ce[Be[0]]=Be[1],Be[0]==he&&(X=Be[1]);break}},I);else throw new Error("Unrecognized LOTUS BOF "+A[2]);if(R["!ref"]=Cr(Ie),ee[fe||X]=R,ve.push(fe||X),!Ce.length)return{SheetNames:ve,Sheets:ee};for(var $e={},Ee=[],le=0;le<Ce.length;++le)ee[ve[le]]?(Ee.push(Ce[le]||ve[le]),$e[Ce[le]]=ee[Ce[le]]||ee[ve[le]]):(Ee.push(Ce[le]),$e[Ce[le]]={"!ref":"A1"});return{SheetNames:Ee,Sheets:$e}}function n(A,O){var I=O||{};if(+I.codepage>=0&&Io(+I.codepage),I.type=="string")throw new Error("Cannot write WK1 to JS string");var R=Nn(),X=lr(A["!ref"]),fe=Array.isArray(A),he=[];Je(R,0,o(1030)),Je(R,6,d(X));for(var ee=Math.min(X.e.r,8191),ve=X.s.r;ve<=ee;++ve)for(var Ce=Kr(ve),Ie=X.s.c;Ie<=X.e.c;++Ie){ve===X.s.r&&(he[Ie]=on(Ie));var Ve=he[Ie]+Ce,$e=fe?(A[ve]||[])[Ie]:A[Ve];if(!(!$e||$e.t=="z"))if($e.t=="n")($e.v|0)==$e.v&&$e.v>=-32768&&$e.v<=32767?Je(R,13,m(ve,Ie,$e.v)):Je(R,14,v(ve,Ie,$e.v));else{var Ee=Xa($e);Je(R,15,g(ve,Ie,Ee.slice(0,239)))}}return Je(R,1),R.end()}function s(A,O){var I=O||{};if(+I.codepage>=0&&Io(+I.codepage),I.type=="string")throw new Error("Cannot write WK3 to JS string");var R=Nn();Je(R,0,l(A));for(var X=0,fe=0;X<A.SheetNames.length;++X)(A.Sheets[A.SheetNames[X]]||{})["!ref"]&&Je(R,27,ae(A.SheetNames[X],fe++));var he=0;for(X=0;X<A.SheetNames.length;++X){var ee=A.Sheets[A.SheetNames[X]];if(!(!ee||!ee["!ref"])){for(var ve=lr(ee["!ref"]),Ce=Array.isArray(ee),Ie=[],Ve=Math.min(ve.e.r,8191),$e=ve.s.r;$e<=Ve;++$e)for(var Ee=Kr($e),le=ve.s.c;le<=ve.e.c;++le){$e===ve.s.r&&(Ie[le]=on(le));var Be=Ie[le]+Ee,Ze=Ce?(ee[$e]||[])[le]:ee[Be];if(!(!Ze||Ze.t=="z"))if(Ze.t=="n")Je(R,23,H($e,le,he,Ze.v));else{var We=Xa(Ze);Je(R,22,L($e,le,he,We.slice(0,239)))}}++he}}return Je(R,1),R.end()}function o(A){var O=Oe(2);return O.write_shift(2,A),O}function l(A){var O=Oe(26);O.write_shift(2,4096),O.write_shift(2,4),O.write_shift(4,0);for(var I=0,R=0,X=0,fe=0;fe<A.SheetNames.length;++fe){var he=A.SheetNames[fe],ee=A.Sheets[he];if(!(!ee||!ee["!ref"])){++X;var ve=Mn(ee["!ref"]);I<ve.e.r&&(I=ve.e.r),R<ve.e.c&&(R=ve.e.c)}}return I>8191&&(I=8191),O.write_shift(2,I),O.write_shift(1,X),O.write_shift(1,R),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(1,1),O.write_shift(1,2),O.write_shift(4,0),O.write_shift(4,0),O}function c(A,O,I){var R={s:{c:0,r:0},e:{c:0,r:0}};return O==8&&I.qpro?(R.s.c=A.read_shift(1),A.l++,R.s.r=A.read_shift(2),R.e.c=A.read_shift(1),A.l++,R.e.r=A.read_shift(2),R):(R.s.c=A.read_shift(2),R.s.r=A.read_shift(2),O==12&&I.qpro&&(A.l+=2),R.e.c=A.read_shift(2),R.e.r=A.read_shift(2),O==12&&I.qpro&&(A.l+=2),R.s.c==65535&&(R.s.c=R.e.c=R.s.r=R.e.r=0),R)}function d(A){var O=Oe(8);return O.write_shift(2,A.s.c),O.write_shift(2,A.s.r),O.write_shift(2,A.e.c),O.write_shift(2,A.e.r),O}function h(A,O,I){var R=[{c:0,r:0},{t:"n",v:0},0,0];return I.qpro&&I.vers!=20768?(R[0].c=A.read_shift(1),R[3]=A.read_shift(1),R[0].r=A.read_shift(2),A.l+=2):(R[2]=A.read_shift(1),R[0].c=A.read_shift(2),R[0].r=A.read_shift(2)),R}function u(A,O,I){var R=A.l+O,X=h(A,O,I);if(X[1].t="s",I.vers==20768){A.l++;var fe=A.read_shift(1);return X[1].v=A.read_shift(fe,"utf8"),X}return I.qpro&&A.l++,X[1].v=A.read_shift(R-A.l,"cstr"),X}function g(A,O,I){var R=Oe(7+I.length);R.write_shift(1,255),R.write_shift(2,O),R.write_shift(2,A),R.write_shift(1,39);for(var X=0;X<R.length;++X){var fe=I.charCodeAt(X);R.write_shift(1,fe>=128?95:fe)}return R.write_shift(1,0),R}function x(A,O,I){var R=h(A,O,I);return R[1].v=A.read_shift(2,"i"),R}function m(A,O,I){var R=Oe(7);return R.write_shift(1,255),R.write_shift(2,O),R.write_shift(2,A),R.write_shift(2,I,"i"),R}function y(A,O,I){var R=h(A,O,I);return R[1].v=A.read_shift(8,"f"),R}function v(A,O,I){var R=Oe(13);return R.write_shift(1,255),R.write_shift(2,O),R.write_shift(2,A),R.write_shift(8,I,"f"),R}function j(A,O,I){var R=A.l+O,X=h(A,O,I);if(X[1].v=A.read_shift(8,"f"),I.qpro)A.l=R;else{var fe=A.read_shift(2);C(A.slice(A.l,A.l+fe),X),A.l+=fe}return X}function w(A,O,I){var R=O&32768;return O&=-32769,O=(R?A:0)+(O>=8192?O-16384:O),(R?"":"$")+(I?on(O):Kr(O))}var N={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function C(A,O){On(A,0);for(var I=[],R=0,X="",fe="",he="",ee="";A.l<A.length;){var ve=A[A.l++];switch(ve){case 0:I.push(A.read_shift(8,"f"));break;case 1:fe=w(O[0].c,A.read_shift(2),!0),X=w(O[0].r,A.read_shift(2),!1),I.push(fe+X);break;case 2:{var Ce=w(O[0].c,A.read_shift(2),!0),Ie=w(O[0].r,A.read_shift(2),!1);fe=w(O[0].c,A.read_shift(2),!0),X=w(O[0].r,A.read_shift(2),!1),I.push(Ce+Ie+":"+fe+X)}break;case 3:if(A.l<A.length){console.error("WK1 premature formula end");return}break;case 4:I.push("("+I.pop()+")");break;case 5:I.push(A.read_shift(2));break;case 6:{for(var Ve="";ve=A[A.l++];)Ve+=String.fromCharCode(ve);I.push('"'+Ve.replace(/"/g,'""')+'"')}break;case 8:I.push("-"+I.pop());break;case 23:I.push("+"+I.pop());break;case 22:I.push("NOT("+I.pop()+")");break;case 20:case 21:ee=I.pop(),he=I.pop(),I.push(["AND","OR"][ve-20]+"("+he+","+ee+")");break;default:if(ve<32&&_[ve])ee=I.pop(),he=I.pop(),I.push(he+_[ve]+ee);else if(N[ve]){if(R=N[ve][1],R==69&&(R=A[A.l++]),R>I.length){console.error("WK1 bad formula parse 0x"+ve.toString(16)+":|"+I.join("|")+"|");return}var $e=I.slice(-R);I.length-=R,I.push(N[ve][0]+"("+$e.join(",")+")")}else return ve<=7?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=24?console.error("WK1 unsupported op "+ve.toString(16)):ve<=30?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=115?console.error("WK1 unsupported function opcode "+ve.toString(16)):console.error("WK1 unrecognized opcode "+ve.toString(16))}}I.length==1?O[1].f=""+I[0]:console.error("WK1 bad formula parse |"+I.join("|")+"|")}function M(A){var O=[{c:0,r:0},{t:"n",v:0},0];return O[0].r=A.read_shift(2),O[3]=A[A.l++],O[0].c=A[A.l++],O}function D(A,O){var I=M(A);return I[1].t="s",I[1].v=A.read_shift(O-4,"cstr"),I}function L(A,O,I,R){var X=Oe(6+R.length);X.write_shift(2,A),X.write_shift(1,I),X.write_shift(1,O),X.write_shift(1,39);for(var fe=0;fe<R.length;++fe){var he=R.charCodeAt(fe);X.write_shift(1,he>=128?95:he)}return X.write_shift(1,0),X}function E(A,O){var I=M(A);I[1].v=A.read_shift(2);var R=I[1].v>>1;if(I[1].v&1)switch(R&7){case 0:R=(R>>3)*5e3;break;case 1:R=(R>>3)*500;break;case 2:R=(R>>3)/20;break;case 3:R=(R>>3)/200;break;case 4:R=(R>>3)/2e3;break;case 5:R=(R>>3)/2e4;break;case 6:R=(R>>3)/16;break;case 7:R=(R>>3)/64;break}return I[1].v=R,I}function P(A,O){var I=M(A),R=A.read_shift(4),X=A.read_shift(4),fe=A.read_shift(2);if(fe==65535)return R===0&&X===3221225472?(I[1].t="e",I[1].v=15):R===0&&X===3489660928?(I[1].t="e",I[1].v=42):I[1].v=0,I;var he=fe&32768;return fe=(fe&32767)-16446,I[1].v=(1-he*2)*(X*Math.pow(2,fe+32)+R*Math.pow(2,fe)),I}function H(A,O,I,R){var X=Oe(14);if(X.write_shift(2,A),X.write_shift(1,I),X.write_shift(1,O),R==0)return X.write_shift(4,0),X.write_shift(4,0),X.write_shift(2,65535),X;var fe=0,he=0,ee=0,ve=0;return R<0&&(fe=1,R=-R),he=Math.log2(R)|0,R/=Math.pow(2,he-31),ve=R>>>0,ve&2147483648||(R/=2,++he,ve=R>>>0),R-=ve,ve|=2147483648,ve>>>=0,R*=Math.pow(2,32),ee=R>>>0,X.write_shift(4,ee),X.write_shift(4,ve),he+=16383+(fe?32768:0),X.write_shift(2,he),X}function k(A,O){var I=P(A);return A.l+=O-14,I}function T(A,O){var I=M(A),R=A.read_shift(4);return I[1].v=R>>6,I}function W(A,O){var I=M(A),R=A.read_shift(8,"f");return I[1].v=R,I}function G(A,O){var I=W(A);return A.l+=O-10,I}function de(A,O){return A[A.l+O-1]==0?A.read_shift(O,"cstr"):""}function J(A,O){var I=A[A.l++];I>O-1&&(I=O-1);for(var R="";R.length<I;)R+=String.fromCharCode(A[A.l++]);return R}function Z(A,O,I){if(!(!I.qpro||O<21)){var R=A.read_shift(1);A.l+=17,A.l+=1,A.l+=2;var X=A.read_shift(O-21,"cstr");return[R,X]}}function oe(A,O){for(var I={},R=A.l+O;A.l<R;){var X=A.read_shift(2);if(X==14e3){for(I[X]=[0,""],I[X][0]=A.read_shift(2);A[A.l];)I[X][1]+=String.fromCharCode(A[A.l]),A.l++;A.l++}}return I}function ae(A,O){var I=Oe(5+A.length);I.write_shift(2,14e3),I.write_shift(2,O);for(var R=0;R<A.length;++R){var X=A.charCodeAt(R);I[I.l++]=X>127?95:X}return I[I.l++]=0,I}var pe={0:{n:"BOF",f:Uu},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:j},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:de},222:{n:"SHEETNAMELP",f:J},65535:{n:""}},be={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:D},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:E},25:{n:"FORMULA19",f:k},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:oe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:T},38:{n:"??"},39:{n:"NUMBER27",f:W},40:{n:"FORMULA28",f:G},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:de},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Z},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:r}}(),dv=/^\s|\s$|[\t\n\r]/;function Gu(e,r){if(!r.bookSST)return"";var t=[Er];t[t.length]=Ke("sst",null,{xmlns:Mi[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],o="<si>";s.r?o+=s.r:(o+="<t",s.t||(s.t=""),s.t.match(dv)&&(o+=' xml:space="preserve"'),o+=">"+Yt(s.t)+"</t>"),o+="</si>",t[t.length]=o}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function fv(e){return[e.read_shift(4),e.read_shift(4)]}function hv(e,r){return r||(r=Oe(8)),r.write_shift(4,e.Count),r.write_shift(4,e.Unique),r}var uv=ng;function mv(e){var r=Nn();Ue(r,159,hv(e));for(var t=0;t<e.length;++t)Ue(r,19,uv(e[t]));return Ue(r,160),r.end()}function pv(e){for(var r=[],t=e.split(""),n=0;n<t.length;++n)r[n]=t[n].charCodeAt(0);return r}function $u(e){var r=0,t,n=pv(e),s=n.length+1,o,l,c,d,h;for(t=qs(s),t[0]=n.length,o=1;o!=s;++o)t[o]=n[o-1];for(o=s-1;o>=0;--o)l=t[o],c=r&16384?1:0,d=r<<1&32767,h=c|d,r=h^l;return r^52811}var xv=function(){function e(s,o){switch(o.type){case"base64":return r(Ya(s),o);case"binary":return r(s,o);case"buffer":return r(Ht&&Buffer.isBuffer(s)?s.toString("binary"):Wo(s),o);case"array":return r(jc(s),o)}throw new Error("Unrecognized type "+o.type)}function r(s,o){var l=o||{},c=l.dense?[]:{},d=s.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(u,g){Array.isArray(c)&&(c[g]=[]);for(var x=/\\\w+\b/g,m=0,y,v=-1;y=x.exec(u);){switch(y[0]){case"\\cell":var j=u.slice(m,x.lastIndex-y[0].length);if(j[0]==" "&&(j=j.slice(1)),++v,j.length){var w={v:j,t:"s"};Array.isArray(c)?c[g][v]=w:c[Xt({r:g,c:v})]=w}break}m=x.lastIndex}v>h.e.c&&(h.e.c=v)}),c["!ref"]=Cr(h),c}function t(s,o){return Ys(e(s,o),o)}function n(s){for(var o=["{\\rtf1\\ansi"],l=lr(s["!ref"]),c,d=Array.isArray(s),h=l.s.r;h<=l.e.r;++h){o.push("\\trowd\\trautofit1");for(var u=l.s.c;u<=l.e.c;++u)o.push("\\cellx"+(u+1));for(o.push("\\pard\\intbl"),u=l.s.c;u<=l.e.c;++u){var g=Xt({r:h,c:u});c=d?(s[h]||[])[u]:s[g],!(!c||c.v==null&&(!c.f||c.F))&&(o.push(" "+(c.w||(Xa(c),c.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:n}}();function fh(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}var gv=6,$a=gv;function dc(e){return Math.floor((e+Math.round(128/$a)/256)*$a)}function fc(e){return Math.floor((e-5)/$a*100+.5)/100}function J0(e){return Math.round((e*$a+5)/$a*256)/256}function vd(e){e.width?(e.wpx=dc(e.width),e.wch=fc(e.wpx),e.MDW=$a):e.wpx?(e.wch=fc(e.wpx),e.width=J0(e.wch),e.MDW=$a):typeof e.wch=="number"&&(e.width=J0(e.wch),e.wpx=dc(e.width),e.MDW=$a),e.customWidth&&delete e.customWidth}var vv=96,Yu=vv;function hc(e){return e*96/Yu}function Xu(e){return e*Yu/96}function yv(e){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var n=t[0];n<=t[1];++n)e[n]!=null&&(r[r.length]=Ke("numFmt",null,{numFmtId:n,formatCode:Yt(e[n])}))}),r.length===1?"":(r[r.length]="</numFmts>",r[0]=Ke("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function bv(e){var r=[];return r[r.length]=Ke("cellXfs",null),e.forEach(function(t){r[r.length]=Ke("xf",null,t)}),r[r.length]="</cellXfs>",r.length===2?"":(r[0]=Ke("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function Ku(e,r){var t=[Er,Ke("styleSheet",null,{xmlns:Mi[0],"xmlns:vt":Ur.vt})],n;return e.SSF&&(n=yv(e.SSF))!=null&&(t[t.length]=n),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=bv(r.cellXfs))&&(t[t.length]=n),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function wv(e,r){var t=e.read_shift(2),n=ln(e);return[t,n]}function Nv(e,r,t){t||(t=Oe(6+4*r.length)),t.write_shift(2,e),Wr(r,t);var n=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),n}function jv(e,r,t){var n={};n.sz=e.read_shift(2)/20;var s=dg(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var o=e.read_shift(2);switch(o===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(n.underline=l);var c=e.read_shift(1);c>0&&(n.family=c);var d=e.read_shift(1);switch(d>0&&(n.charset=d),e.l++,n.color=cg(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=ln(e),n}function Sv(e,r){r||(r=Oe(25+4*32)),r.write_shift(2,e.sz*20),fg(e,r),r.write_shift(2,e.bold?700:400);var t=0;e.vertAlign=="superscript"?t=1:e.vertAlign=="subscript"&&(t=2),r.write_shift(2,t),r.write_shift(1,e.underline||0),r.write_shift(1,e.family||0),r.write_shift(1,e.charset||0),r.write_shift(1,0),lc(e.color,r);var n=0;return n=2,r.write_shift(1,n),Wr(e.name,r),r.length>r.l?r.slice(0,r.l):r}var _v=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],C0,Av=Fa;function hh(e,r){r||(r=Oe(4*3+8*7+16*1)),C0||(C0=id(_v));var t=C0[e.patternType];t==null&&(t=40),r.write_shift(4,t);var n=0;if(t!=40)for(lc({auto:1},r),lc({auto:1},r);n<12;++n)r.write_shift(4,0);else{for(;n<4;++n)r.write_shift(4,0);for(;n<12;++n)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function kv(e,r){var t=e.l+r,n=e.read_shift(2),s=e.read_shift(2);return e.l=t,{ixfe:n,numFmtId:s}}function Ju(e,r,t){t||(t=Oe(16)),t.write_shift(2,r||0),t.write_shift(2,e.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var n=0;return t.write_shift(1,n),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function bo(e,r){return r||(r=Oe(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var Tv=Fa;function Cv(e,r){return r||(r=Oe(51)),r.write_shift(1,0),bo(null,r),bo(null,r),bo(null,r),bo(null,r),bo(null,r),r.length>r.l?r.slice(0,r.l):r}function Ev(e,r){return r||(r=Oe(12+4*10)),r.write_shift(4,e.xfId),r.write_shift(2,1),r.write_shift(1,0),r.write_shift(1,0),oc(e.name||"",r),r.length>r.l?r.slice(0,r.l):r}function Fv(e,r,t){var n=Oe(2052);return n.write_shift(4,e),oc(r,n),oc(t,n),n.length>n.l?n.slice(0,n.l):n}function Lv(e,r){if(r){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)r[s]!=null&&++t}),t!=0&&(Ue(e,615,ma(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)r[s]!=null&&Ue(e,44,Nv(s,r[s]))}),Ue(e,616))}}function Pv(e){var r=1;Ue(e,611,ma(r)),Ue(e,43,Sv({sz:12,color:{theme:1},name:"Calibri",family:2})),Ue(e,612)}function Ov(e){var r=2;Ue(e,603,ma(r)),Ue(e,45,hh({patternType:"none"})),Ue(e,45,hh({patternType:"gray125"})),Ue(e,604)}function Iv(e){var r=1;Ue(e,613,ma(r)),Ue(e,46,Cv()),Ue(e,614)}function Dv(e){var r=1;Ue(e,626,ma(r)),Ue(e,47,Ju({numFmtId:0},65535)),Ue(e,627)}function Rv(e,r){Ue(e,617,ma(r.length)),r.forEach(function(t){Ue(e,47,Ju(t,0))}),Ue(e,618)}function Mv(e){var r=1;Ue(e,619,ma(r)),Ue(e,48,Ev({xfId:0,name:"Normal"})),Ue(e,620)}function Bv(e){var r=0;Ue(e,505,ma(r)),Ue(e,506)}function Uv(e){var r=0;Ue(e,508,Fv(r,"TableStyleMedium9","PivotStyleMedium4")),Ue(e,509)}function Hv(e,r){var t=Nn();return Ue(t,278),Lv(t,e.SSF),Pv(t),Ov(t),Iv(t),Dv(t),Rv(t,r.cellXfs),Mv(t),Bv(t),Uv(t),Ue(t,279),t.end()}function Zu(e,r){if(r&&r.themeXLSX)return r.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var t=[Er];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',t[t.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',t[t.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',t[t.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜Žé«”"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',t[t.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',t[t.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',t[t.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜Žé«”"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function Wv(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:ln(e)}}function zv(e){var r=Oe(12+2*e.name.length);return r.write_shift(4,e.flags),r.write_shift(4,e.version),Wr(e.name,r),r.slice(0,r.l)}function qv(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function Vv(e){var r=Oe(4+8*e.length);r.write_shift(4,e.length);for(var t=0;t<e.length;++t)r.write_shift(4,e[t][0]),r.write_shift(4,e[t][1]);return r}function Gv(e,r){var t=Oe(8+2*r.length);return t.write_shift(4,e),Wr(r,t),t.slice(0,t.l)}function $v(e){return e.l+=4,e.read_shift(4)!=0}function Yv(e,r){var t=Oe(8);return t.write_shift(4,e),t.write_shift(4,1),t}function Xv(){var e=Nn();return Ue(e,332),Ue(e,334,ma(1)),Ue(e,335,zv({name:"XLDAPR",version:12e4,flags:3496657072})),Ue(e,336),Ue(e,339,Gv(1,"XLDAPR")),Ue(e,52),Ue(e,35,ma(514)),Ue(e,4096,ma(0)),Ue(e,4097,Kn(1)),Ue(e,36),Ue(e,53),Ue(e,340),Ue(e,337,Yv(1)),Ue(e,51,Vv([[1,0]])),Ue(e,338),Ue(e,333),e.end()}function Qu(){var e=[Er];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Kv(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=Xt(t);var n=e.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}var Fi=1024;function e1(e,r){for(var t=[21600,21600],n=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),s=[Ke("xml",null,{"xmlns:v":In.v,"xmlns:o":In.o,"xmlns:x":In.x,"xmlns:mv":In.mv}).replace(/\/>/,">"),Ke("o:shapelayout",Ke("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ke("v:shapetype",[Ke("v:stroke",null,{joinstyle:"miter"}),Ke("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:n})];Fi<e*1e3;)Fi+=1e3;return r.forEach(function(o){var l=Hr(o[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var d=c.type=="gradient"?Ke("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=Ke("v:fill",d,c),u={on:"t",obscured:"t"};++Fi,s=s.concat(["<v:shape"+Bo({id:"_x0000_s"+Fi,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(o[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,Ke("v:shadow",null,u),Ke("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Xr("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),Xr("x:AutoFill","False"),Xr("x:Row",String(l.r)),Xr("x:Column",String(l.c)),o[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function t1(e){var r=[Er,Ke("comments",null,{xmlns:Mi[0]})],t=[];return r.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var o=Yt(s.a);t.indexOf(o)==-1&&(t.push(o),r.push("<author>"+o+"</author>")),s.T&&s.ID&&t.indexOf("tc="+s.ID)==-1&&(t.push("tc="+s.ID),r.push("<author>tc="+s.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),e.forEach(function(n){var s=0,o=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=t.indexOf("tc="+n[1][0].ID):n[1].forEach(function(d){d.a&&(s=t.indexOf(Yt(d.a))),o.push(d.t||"")}),r.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),o.length<=1)r.push(Xr("t",Yt(o[0]||"")));else{for(var l=`Comment:
    `+o[0]+`
`,c=1;c<o.length;++c)l+=`Reply:
    `+o[c]+`
`;r.push(Xr("t",Yt(l)))}r.push("</text></comment>")}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function Jv(e,r,t){var n=[Er,Ke("ThreadedComments",null,{xmlns:Ur.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var o="";(s[1]||[]).forEach(function(l,c){if(!l.T){delete l.ID;return}l.a&&r.indexOf(l.a)==-1&&r.push(l.a);var d={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};c==0?o=d.id:d.parentId=o,l.ID=d.id,l.a&&(d.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(l.a)).slice(-12)+"}"),n.push(Ke("threadedComment",Xr("text",l.t||""),d))})}),n.push("</ThreadedComments>"),n.join("")}function Zv(e){var r=[Er,Ke("personList",null,{xmlns:Ur.TCMNT,"xmlns:x":Mi[0]}).replace(/[\/]>/,">")];return e.forEach(function(t,n){r.push(Ke("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:t,providerId:"None"}))}),r.push("</personList>"),r.join("")}function Qv(e){var r={};r.iauthor=e.read_shift(4);var t=Zs(e);return r.rfx=t.s,r.ref=Xt(t.s),e.l+=16,r}function e5(e,r){return r==null&&(r=Oe(36)),r.write_shift(4,e[1].iauthor),Ui(e[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}var t5=ln;function r5(e){return Wr(e.slice(0,54))}function n5(e){var r=Nn(),t=[];return Ue(r,628),Ue(r,630),e.forEach(function(n){n[1].forEach(function(s){t.indexOf(s.a)>-1||(t.push(s.a.slice(0,54)),Ue(r,632,r5(s.a)))})}),Ue(r,631),Ue(r,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=t.indexOf(s.a);var o={s:Hr(n[0]),e:Hr(n[0])};Ue(r,635,e5([o,s])),s.t&&s.t.length>0&&Ue(r,637,sg(s)),Ue(r,636),delete s.iauthor})}),Ue(r,634),Ue(r,629),r.end()}function a5(e,r){r.FullPaths.forEach(function(t,n){if(n!=0){var s=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Zt.utils.cfb_add(e,s,r.FileIndex[n].content)}})}var r1=["xlsb","xlsm","xlam","biff8","xla"],s5=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(n,s,o,l){var c=!1,d=!1;o.length==0?d=!0:o.charAt(0)=="["&&(d=!0,o=o.slice(1,-1)),l.length==0?c=!0:l.charAt(0)=="["&&(c=!0,l=l.slice(1,-1));var h=o.length>0?parseInt(o,10)|0:0,u=l.length>0?parseInt(l,10)|0:0;return c?u+=r.c:--u,d?h+=r.r:--h,s+(c?"":"$")+on(u)+(d?"":"$")+Kr(h)}return function(s,o){return r=o,s.replace(e,t)}}(),yd=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,bd=function(){return function(r,t){return r.replace(yd,function(n,s,o,l,c,d){var h=ud(l)-(o?0:t.c),u=hd(d)-(c?0:t.r),g=u==0?"":c?u+1:"["+u+"]",x=h==0?"":o?h+1:"["+h+"]";return s+"R"+g+"C"+x})}}();function i5(e,r){return e.replace(yd,function(t,n,s,o,l,c){return n+(s=="$"?s+o:on(ud(o)+r.c))+(l=="$"?l+c:Kr(hd(c)+r.r))})}function o5(e){return e.length!=1}function Tr(e){e.l+=1}function js(e,r){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function n1(e,r,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return a1(e);t.biff==12&&(n=4)}var s=e.read_shift(n),o=e.read_shift(n),l=js(e),c=js(e);return{s:{r:s,c:l[0],cRel:l[1],rRel:l[2]},e:{r:o,c:c[0],cRel:c[1],rRel:c[2]}}}function a1(e){var r=js(e),t=js(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:t[0],c:s,cRel:t[1],rRel:t[2]}}}function l5(e,r,t){if(t.biff<8)return a1(e);var n=e.read_shift(t.biff==12?4:2),s=e.read_shift(t.biff==12?4:2),o=js(e),l=js(e);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function s1(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return c5(e);var n=e.read_shift(t&&t.biff==12?4:2),s=js(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function c5(e){var r=js(e),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function d5(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function f5(e,r,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return h5(e);var s=e.read_shift(n>=12?4:2),o=e.read_shift(2),l=(o&16384)>>14,c=(o&32768)>>15;if(o&=16383,c==1)for(;s>524287;)s-=1048576;if(l==1)for(;o>8191;)o=o-16384;return{r:s,c:o,cRel:l,rRel:c}}function h5(e){var r=e.read_shift(2),t=e.read_shift(1),n=(r&32768)>>15,s=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),s==1&&t>=128&&(t=t-256),{r,c:t,cRel:s,rRel:n}}function u5(e,r,t){var n=(e[e.l++]&96)>>5,s=n1(e,t.biff>=2&&t.biff<=5?6:8,t);return[n,s]}function m5(e,r,t){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}var l=n1(e,o,t);return[n,s,l]}function p5(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function x5(e,r,t){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}return e.l+=o,[n,s]}function g5(e,r,t){var n=(e[e.l++]&96)>>5,s=l5(e,r-1,t);return[n,s]}function v5(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[n]}function uh(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function y5(e,r,t){e.l+=2;for(var n=e.read_shift(t&&t.biff==2?1:2),s=[],o=0;o<=n;++o)s.push(e.read_shift(t&&t.biff==2?1:2));return s}function b5(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function w5(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function N5(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function j5(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[n]}function i1(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function S5(e){return e.read_shift(2),i1(e)}function _5(e){return e.read_shift(2),i1(e)}function A5(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var s=s1(e,0,t);return[n,s]}function k5(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var s=f5(e,0,t);return[n,s]}function T5(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var o=s1(e,0,t);return[n,s,o]}function C5(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(t&&t.biff<=3?1:2);return[Cy[s],c1[s],n]}function E5(e,r,t){var n=e[e.l++],s=e.read_shift(1),o=t&&t.biff<=3?[n==88?-1:0,e.read_shift(1)]:F5(e);return[s,(o[0]===0?c1:Ty)[o[1]]]}function F5(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function L5(e,r,t){e.l+=t&&t.biff==2?3:4}function P5(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(t&&t.biff==2?1:2);return[n,s]}function O5(e){return e.l++,Vo[e.read_shift(1)]}function I5(e){return e.l++,e.read_shift(2)}function D5(e){return e.l++,e.read_shift(1)!==0}function R5(e){return e.l++,Hi(e)}function M5(e,r,t){return e.l++,Wu(e,r-1,t)}function B5(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=Tg(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=Vo[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Hi(e);break;case 2:t[1]=Lg(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function U5(e,r,t){for(var n=e.read_shift(t.biff==12?4:2),s=[],o=0;o!=n;++o)s.push((t.biff==12?Zs:Ig)(e));return s}function H5(e,r,t){var n=0,s=0;t.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--s==0&&(s=256));for(var o=0,l=[];o!=n&&(l[o]=[]);++o)for(var c=0;c!=s;++c)l[o][c]=B5(e,t.biff);return l}function W5(e,r,t){var n=e.read_shift(1)>>>5&3,s=!t||t.biff>=8?4:2,o=e.read_shift(s);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,o]}function z5(e,r,t){if(t.biff==5)return q5(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),o=e.read_shift(4);return[n,s,o]}function q5(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[r,t,n]}function V5(e,r,t){var n=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var s=e.read_shift(t&&t.biff==2?1:2);return[n,s]}function G5(e,r,t){var n=e.read_shift(1)>>>5&3,s=e.read_shift(t&&t.biff==2?1:2);return[n,s]}function $5(e,r,t){var n=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[n]}function Y5(e,r,t){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),o=4;if(t)switch(t.biff){case 5:o=15;break;case 12:o=6;break}return e.l+=o,[n,s]}var X5=Fa,K5=Fa,J5=Fa;function Go(e,r,t){return e.l+=2,[d5(e)]}function wd(e){return e.l+=6,[]}var Z5=Go,Q5=wd,ey=wd,ty=Go;function o1(e){return e.l+=2,[Uu(e),e.read_shift(2)&1]}var ry=Go,ny=o1,ay=wd,sy=Go,iy=Go,oy=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function ly(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),o=e.read_shift(2),l=oy[t>>2&31];return{ixti:r,coltype:t&3,rt:l,idx:n,c:s,C:o}}function cy(e){return e.l+=2,[e.read_shift(4)]}function dy(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function fy(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function hy(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function uy(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function my(e){return e.l+=4,[0,0]}var mh={1:{n:"PtgExp",f:P5},2:{n:"PtgTbl",f:J5},3:{n:"PtgAdd",f:Tr},4:{n:"PtgSub",f:Tr},5:{n:"PtgMul",f:Tr},6:{n:"PtgDiv",f:Tr},7:{n:"PtgPower",f:Tr},8:{n:"PtgConcat",f:Tr},9:{n:"PtgLt",f:Tr},10:{n:"PtgLe",f:Tr},11:{n:"PtgEq",f:Tr},12:{n:"PtgGe",f:Tr},13:{n:"PtgGt",f:Tr},14:{n:"PtgNe",f:Tr},15:{n:"PtgIsect",f:Tr},16:{n:"PtgUnion",f:Tr},17:{n:"PtgRange",f:Tr},18:{n:"PtgUplus",f:Tr},19:{n:"PtgUminus",f:Tr},20:{n:"PtgPercent",f:Tr},21:{n:"PtgParen",f:Tr},22:{n:"PtgMissArg",f:Tr},23:{n:"PtgStr",f:M5},26:{n:"PtgSheet",f:dy},27:{n:"PtgEndSheet",f:fy},28:{n:"PtgErr",f:O5},29:{n:"PtgBool",f:D5},30:{n:"PtgInt",f:I5},31:{n:"PtgNum",f:R5},32:{n:"PtgArray",f:v5},33:{n:"PtgFunc",f:C5},34:{n:"PtgFuncVar",f:E5},35:{n:"PtgName",f:W5},36:{n:"PtgRef",f:A5},37:{n:"PtgArea",f:u5},38:{n:"PtgMemArea",f:V5},39:{n:"PtgMemErr",f:X5},40:{n:"PtgMemNoMem",f:K5},41:{n:"PtgMemFunc",f:G5},42:{n:"PtgRefErr",f:$5},43:{n:"PtgAreaErr",f:p5},44:{n:"PtgRefN",f:k5},45:{n:"PtgAreaN",f:g5},46:{n:"PtgMemAreaN",f:hy},47:{n:"PtgMemNoMemN",f:uy},57:{n:"PtgNameX",f:z5},58:{n:"PtgRef3d",f:T5},59:{n:"PtgArea3d",f:m5},60:{n:"PtgRefErr3d",f:Y5},61:{n:"PtgAreaErr3d",f:x5},255:{}},py={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},xy={1:{n:"PtgElfLel",f:o1},2:{n:"PtgElfRw",f:sy},3:{n:"PtgElfCol",f:Z5},6:{n:"PtgElfRwV",f:iy},7:{n:"PtgElfColV",f:ty},10:{n:"PtgElfRadical",f:ry},11:{n:"PtgElfRadicalS",f:ay},13:{n:"PtgElfColS",f:Q5},15:{n:"PtgElfColSV",f:ey},16:{n:"PtgElfRadicalLel",f:ny},25:{n:"PtgList",f:ly},29:{n:"PtgSxName",f:cy},255:{}},gy={0:{n:"PtgAttrNoop",f:my},1:{n:"PtgAttrSemi",f:j5},2:{n:"PtgAttrIf",f:w5},4:{n:"PtgAttrChoose",f:y5},8:{n:"PtgAttrGoto",f:b5},16:{n:"PtgAttrSum",f:L5},32:{n:"PtgAttrBaxcel",f:uh},33:{n:"PtgAttrBaxcel",f:uh},64:{n:"PtgAttrSpace",f:S5},65:{n:"PtgAttrSpaceSemi",f:_5},128:{n:"PtgAttrIfError",f:N5},255:{}};function vy(e,r,t,n){if(n.biff<8)return Fa(e,r);for(var s=e.l+r,o=[],l=0;l!==t.length;++l)switch(t[l][0]){case"PtgArray":t[l][1]=H5(e,0,n),o.push(t[l][1]);break;case"PtgMemArea":t[l][2]=U5(e,t[l][1],n),o.push(t[l][2]);break;case"PtgExp":n&&n.biff==12&&(t[l][1][1]=e.read_shift(4),o.push(t[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[l][0]}return r=s-e.l,r!==0&&o.push(Fa(e,r)),o}function yy(e,r,t){for(var n=e.l+r,s,o,l=[];n!=e.l;)r=n-e.l,o=e[e.l],s=mh[o]||mh[py[o]],(o===24||o===25)&&(s=(o===24?xy:gy)[e[e.l+1]]),!s||!s.f?Fa(e,r):l.push([s.n,s.f(e,r,t)]);return l}function by(e){for(var r=[],t=0;t<e.length;++t){for(var n=e[t],s=[],o=0;o<n.length;++o){var l=n[o];if(l)switch(l[0]){case 2:s.push('"'+l[1].replace(/"/g,'""')+'"');break;default:s.push(l[1])}else s.push("")}r.push(s.join(","))}return r.join(";")}var wy={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Ny(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function l1(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!n)return"SH33TJSERR1";var s="";if(t.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function ph(e,r,t){var n=l1(e,r,t);return n=="#REF"?n:Ny(n,t)}function Di(e,r,t,n,s){var o=s&&s.biff||8,l={s:{c:0,r:0}},c=[],d,h,u,g=0,x=0,m,y="";if(!e[0]||!e[0][0])return"";for(var v=-1,j="",w=0,N=e[0].length;w<N;++w){var _=e[0][w];switch(_[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=c.pop(),h=c.pop(),v>=0){switch(e[0][v][1][0]){case 0:j=mr(" ",e[0][v][1][1]);break;case 1:j=mr("\r",e[0][v][1][1]);break;default:if(j="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}h=h+j,v=-1}c.push(h+wy[_[0]]+d);break;case"PtgIsect":d=c.pop(),h=c.pop(),c.push(h+" "+d);break;case"PtgUnion":d=c.pop(),h=c.pop(),c.push(h+","+d);break;case"PtgRange":d=c.pop(),h=c.pop(),c.push(h+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Eo(_[1][1],l,s),c.push(Fo(u,o));break;case"PtgRefN":u=t?Eo(_[1][1],t,s):_[1][1],c.push(Fo(u,o));break;case"PtgRef3d":g=_[1][1],u=Eo(_[1][2],l,s),y=ph(n,g,s),c.push(y+"!"+Fo(u,o));break;case"PtgFunc":case"PtgFuncVar":var C=_[1][0],M=_[1][1];C||(C=0),C&=127;var D=C==0?[]:c.slice(-C);c.length-=C,M==="User"&&(M=D.shift()),c.push(M+"("+D.join(",")+")");break;case"PtgBool":c.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(_[1]);break;case"PtgNum":c.push(String(_[1]));break;case"PtgStr":c.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(_[1]);break;case"PtgAreaN":m=Qf(_[1][1],t?{s:t}:l,s),c.push(k0(m,s));break;case"PtgArea":m=Qf(_[1][1],l,s),c.push(k0(m,s));break;case"PtgArea3d":g=_[1][1],m=_[1][2],y=ph(n,g,s),c.push(y+"!"+k0(m,s));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=_[1][2];var L=(n.names||[])[x-1]||(n[0]||[])[x],E=L?L.Name:"SH33TJSNAME"+String(x);E&&E.slice(0,6)=="_xlfn."&&!s.xlfn&&(E=E.slice(6)),c.push(E);break;case"PtgNameX":var P=_[1][1];x=_[1][2];var H;if(s.biff<=5)P<0&&(P=-P),n[P]&&(H=n[P][x]);else{var k="";if(((n[P]||[])[0]||[])[0]==14849||(((n[P]||[])[0]||[])[0]==1025?n[P][x]&&n[P][x].itab>0&&(k=n.SheetNames[n[P][x].itab-1]+"!"):k=n.SheetNames[x-1]+"!"),n[P]&&n[P][x])k+=n[P][x].Name;else if(n[0]&&n[0][x])k+=n[0][x].Name;else{var T=(l1(n,P,s)||"").split(";;");T[x-1]?k=T[x-1]:k+="SH33TJSERRX"}c.push(k);break}H||(H={Name:"SH33TJSERRY"}),c.push(H.Name);break;case"PtgParen":var W="(",G=")";if(v>=0){switch(j="",e[0][v][1][0]){case 2:W=mr(" ",e[0][v][1][1])+W;break;case 3:W=mr("\r",e[0][v][1][1])+W;break;case 4:G=mr(" ",e[0][v][1][1])+G;break;case 5:G=mr("\r",e[0][v][1][1])+G;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}v=-1}c.push(W+c.pop()+G);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":u={c:_[1][1],r:_[1][0]};var de={c:t.c,r:t.r};if(n.sharedf[Xt(u)]){var J=n.sharedf[Xt(u)];c.push(Di(J,l,de,n,s))}else{var Z=!1;for(d=0;d!=n.arrayf.length;++d)if(h=n.arrayf[d],!(u.c<h[0].s.c||u.c>h[0].e.c)&&!(u.r<h[0].s.r||u.r>h[0].e.r)){c.push(Di(h[1],l,de,n,s)),Z=!0;break}Z||c.push(_[1])}break;case"PtgArray":c.push("{"+by(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var oe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&v>=0&&oe.indexOf(e[0][w][0])==-1){_=e[0][v];var ae=!0;switch(_[1][0]){case 4:ae=!1;case 0:j=mr(" ",_[1][1]);break;case 5:ae=!1;case 1:j=mr("\r",_[1][1]);break;default:if(j="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}c.push((ae?j:"")+c.pop()+(ae?"":j)),v=-1}}if(c.length>1&&s.WTF)throw new Error("bad formula stack");return c[0]}function jy(e){if(e==null){var r=Oe(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}else if(typeof e=="number")return Vs(e);return Vs(0)}function Sy(e,r,t,n,s){var o=Gs(r,t,s),l=jy(e.v),c=Oe(6),d=33;c.write_shift(2,d),c.write_shift(4,0);for(var h=Oe(e.bf.length),u=0;u<e.bf.length;++u)h[u]=e.bf[u];var g=Yr([o,l,c,h]);return g}function Sc(e,r,t){var n=e.read_shift(4),s=yy(e,n,t),o=e.read_shift(4),l=o>0?vy(e,o,s,t):null;return[s,l]}var _y=Sc,_c=Sc,Ay=Sc,ky=Sc,Ty={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},c1={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Cy={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Ey(e){var r="of:="+e.replace(yd,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return r.replace(/;/g,"|").replace(/,/g,";")}function Fy(e){return e.replace(/\./,"!")}var Lo=typeof Map<"u";function Nd(e,r,t){var n=0,s=e.length;if(t){if(Lo?t.has(r):Object.prototype.hasOwnProperty.call(t,r)){for(var o=Lo?t.get(r):t[r];n<o.length;++n)if(e[o[n]].t===r)return e.Count++,o[n]}}else for(;n<s;++n)if(e[n].t===r)return e.Count++,n;return e[s]={t:r},e.Count++,e.Unique++,t&&(Lo?(t.has(r)||t.set(r,[]),t.get(r).push(s)):(Object.prototype.hasOwnProperty.call(t,r)||(t[r]=[]),t[r].push(s))),s}function Ac(e,r){var t={min:e+1,max:e+1},n=-1;return r.MDW&&($a=r.MDW),r.width!=null?t.customWidth=1:r.wpx!=null?n=fc(r.wpx):r.wch!=null&&(n=r.wch),n>-1?(t.width=J0(n),t.customWidth=1):r.width!=null&&(t.width=r.width),r.hidden&&(t.hidden=!0),r.level!=null&&(t.outlineLevel=t.level=r.level),t}function d1(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function _s(e,r,t){var n=t.revssf[r.z!=null?r.z:"General"],s=60,o=e.length;if(n==null&&t.ssf){for(;s<392;++s)if(t.ssf[s]==null){su(r.z,s),t.ssf[s]=r.z,t.revssf[r.z]=n=s;break}}for(s=0;s!=o;++s)if(e[s].numFmtId===n)return s;return e[o]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function Ly(e,r,t){if(e&&e["!ref"]){var n=lr(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+t+"): "+e["!ref"])}}function Py(e){if(e.length===0)return"";for(var r='<mergeCells count="'+e.length+'">',t=0;t!=e.length;++t)r+='<mergeCell ref="'+Cr(e[t])+'"/>';return r+"</mergeCells>"}function Oy(e,r,t,n,s){var o=!1,l={},c=null;if(n.bookType!=="xlsx"&&r.vbaraw){var d=r.SheetNames[t];try{r.Workbook&&(d=r.Workbook.Sheets[t].CodeName||d)}catch{}o=!0,l.codeName=Mo(Yt(d))}if(e&&e["!outline"]){var h={summaryBelow:1,summaryRight:1};e["!outline"].above&&(h.summaryBelow=0),e["!outline"].left&&(h.summaryRight=0),c=(c||"")+Ke("outlinePr",null,h)}!o&&!c||(s[s.length]=Ke("sheetPr",c,l))}var Iy=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Dy=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Ry(e){var r={sheet:1};return Iy.forEach(function(t){e[t]!=null&&e[t]&&(r[t]="1")}),Dy.forEach(function(t){e[t]!=null&&!e[t]&&(r[t]="0")}),e.password&&(r.password=$u(e.password).toString(16).toUpperCase()),Ke("sheetProtection",null,r)}function My(e){return d1(e),Ke("pageMargins",null,e)}function By(e,r){for(var t=["<cols>"],n,s=0;s!=r.length;++s)(n=r[s])&&(t[t.length]=Ke("col",null,Ac(s,n)));return t[t.length]="</cols>",t.join("")}function Uy(e,r,t,n){var s=typeof e.ref=="string"?e.ref:Cr(e.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var o=t.Workbook.Names,l=Mn(s);l.s.r==l.e.r&&(l.e.r=Mn(r["!ref"]).e.r,s=Cr(l));for(var c=0;c<o.length;++c){var d=o[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+t.SheetNames[n]+"'!"+s;break}}return c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+s}),Ke("autoFilter",null,{ref:s})}function Hy(e,r,t,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ke("sheetViews",Ke("sheetView",null,s),{})}function Wy(e,r,t,n){if(e.c&&t["!comments"].push([r,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",o=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=Vo[e.v];break;case"d":n&&n.cellDates?s=mn(e.v,-1).toISOString():(e=Sn(e),e.t="n",s=""+(e.v=jn(mn(e.v)))),typeof e.z>"u"&&(e.z=xr[14]);break;default:s=e.v;break}var c=Xr("v",Yt(s)),d={r},h=_s(n.cellXfs,e,n);switch(h!==0&&(d.s=h),e.t){case"n":break;case"d":d.t="d";break;case"b":d.t="b";break;case"e":d.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){c=Xr("v",""+Nd(n.Strings,e.v,n.revStrings)),d.t="s";break}d.t="str";break}if(e.t!=o&&(e.t=o,e.v=l),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,r.length)==r?{t:"array",ref:e.F}:null;c=Ke("f",Yt(e.f),u)+(e.v!=null?c:"")}return e.l&&t["!links"].push([r,e.l]),e.D&&(d.cm=1),Ke("c",c,d)}function zy(e,r,t,n){var s=[],o=[],l=lr(e["!ref"]),c="",d,h="",u=[],g=0,x=0,m=e["!rows"],y=Array.isArray(e),v={r:h},j,w=-1;for(x=l.s.c;x<=l.e.c;++x)u[x]=on(x);for(g=l.s.r;g<=l.e.r;++g){for(o=[],h=Kr(g),x=l.s.c;x<=l.e.c;++x){d=u[x]+h;var N=y?(e[g]||[])[x]:e[d];N!==void 0&&(c=Wy(N,d,e,r))!=null&&o.push(c)}(o.length>0||m&&m[g])&&(v={r:h},m&&m[g]&&(j=m[g],j.hidden&&(v.hidden=1),w=-1,j.hpx?w=hc(j.hpx):j.hpt&&(w=j.hpt),w>-1&&(v.ht=w,v.customHeight=1),j.level&&(v.outlineLevel=j.level)),s[s.length]=Ke("row",o.join(""),v))}if(m)for(;g<m.length;++g)m&&m[g]&&(v={r:g+1},j=m[g],j.hidden&&(v.hidden=1),w=-1,j.hpx?w=hc(j.hpx):j.hpt&&(w=j.hpt),w>-1&&(v.ht=w,v.customHeight=1),j.level&&(v.outlineLevel=j.level),s[s.length]=Ke("row","",v));return s.join("")}function f1(e,r,t,n){var s=[Er,Ke("worksheet",null,{xmlns:Mi[0],"xmlns:r":Ur.r})],o=t.SheetNames[e],l=0,c="",d=t.Sheets[o];d==null&&(d={});var h=d["!ref"]||"A1",u=lr(h);if(u.e.c>16383||u.e.r>1048575){if(r.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),h=Cr(u)}n||(n={}),d["!comments"]=[];var g=[];Oy(d,t,e,r,s),s[s.length]=Ke("dimension",null,{ref:h}),s[s.length]=Hy(d,r,e,t),r.sheetFormat&&(s[s.length]=Ke("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),d["!cols"]!=null&&d["!cols"].length>0&&(s[s.length]=By(d,d["!cols"])),s[l=s.length]="<sheetData/>",d["!links"]=[],d["!ref"]!=null&&(c=zy(d,r),c.length>0&&(s[s.length]=c)),s.length>l+1&&(s[s.length]="</sheetData>",s[l]=s[l].replace("/>",">")),d["!protect"]&&(s[s.length]=Ry(d["!protect"])),d["!autofilter"]!=null&&(s[s.length]=Uy(d["!autofilter"],d,t,e)),d["!merges"]!=null&&d["!merges"].length>0&&(s[s.length]=Py(d["!merges"]));var x=-1,m,y=-1;return d["!links"].length>0&&(s[s.length]="<hyperlinks>",d["!links"].forEach(function(v){v[1].Target&&(m={ref:v[0]},v[1].Target.charAt(0)!="#"&&(y=$t(n,-1,Yt(v[1].Target).replace(/#.*$/,""),Bt.HLINK),m["r:id"]="rId"+y),(x=v[1].Target.indexOf("#"))>-1&&(m.location=Yt(v[1].Target.slice(x+1))),v[1].Tooltip&&(m.tooltip=Yt(v[1].Tooltip)),s[s.length]=Ke("hyperlink",null,m))}),s[s.length]="</hyperlinks>"),delete d["!links"],d["!margins"]!=null&&(s[s.length]=My(d["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&(s[s.length]=Xr("ignoredErrors",Ke("ignoredError",null,{numberStoredAsText:1,sqref:h}))),g.length>0&&(y=$t(n,-1,"../drawings/drawing"+(e+1)+".xml",Bt.DRAW),s[s.length]=Ke("drawing",null,{"r:id":"rId"+y}),d["!drawing"]=g),d["!comments"].length>0&&(y=$t(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Bt.VML),s[s.length]=Ke("legacyDrawing",null,{"r:id":"rId"+y}),d["!legacy"]=y),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function qy(e,r){var t={},n=e.l+r;t.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=n,o&7&&(t.level=o&7),o&16&&(t.hidden=!0),o&32&&(t.hpt=s/20),t}function Vy(e,r,t){var n=Oe(145),s=(t["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var o=320;s.hpx?o=hc(s.hpx)*20:s.hpt&&(o=s.hpt*20),n.write_shift(2,o),n.write_shift(1,0);var l=0;s.level&&(l|=s.level),s.hidden&&(l|=16),(s.hpx||s.hpt)&&(l|=32),n.write_shift(1,l),n.write_shift(1,0);var c=0,d=n.l;n.l+=4;for(var h={r:e,c:0},u=0;u<16;++u)if(!(r.s.c>u+1<<10||r.e.c<u<<10)){for(var g=-1,x=-1,m=u<<10;m<u+1<<10;++m){h.c=m;var y=Array.isArray(t)?(t[h.r]||[])[h.c]:t[Xt(h)];y&&(g<0&&(g=m),x=m)}g<0||(++c,n.write_shift(4,g),n.write_shift(4,x))}var v=n.l;return n.l=d,n.write_shift(4,c),n.l=v,n.length>n.l?n.slice(0,n.l):n}function Gy(e,r,t,n){var s=Vy(n,t,r);(s.length>17||(r["!rows"]||[])[n])&&Ue(e,0,s)}var $y=Zs,Yy=Ui;function Xy(){}function Ky(e,r){var t={},n=e[e.l];return++e.l,t.above=!(n&64),t.left=!(n&128),e.l+=18,t.name=ig(e),t}function Jy(e,r,t){t==null&&(t=Oe(84+4*e.length));var n=192;r&&(r.above&&(n&=-65),r.left&&(n&=-129)),t.write_shift(1,n);for(var s=1;s<3;++s)t.write_shift(1,0);return lc({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),Au(e,t),t.slice(0,t.l)}function Zy(e){var r=Jn(e);return[r]}function Qy(e,r,t){return t==null&&(t=Oe(8)),Xs(r,t)}function eb(e){var r=Ks(e);return[r]}function tb(e,r,t){return t==null&&(t=Oe(4)),Js(r,t)}function rb(e){var r=Jn(e),t=e.read_shift(1);return[r,t,"b"]}function nb(e,r,t){return t==null&&(t=Oe(9)),Xs(r,t),t.write_shift(1,e.v?1:0),t}function ab(e){var r=Ks(e),t=e.read_shift(1);return[r,t,"b"]}function sb(e,r,t){return t==null&&(t=Oe(5)),Js(r,t),t.write_shift(1,e.v?1:0),t}function ib(e){var r=Jn(e),t=e.read_shift(1);return[r,t,"e"]}function ob(e,r,t){return t==null&&(t=Oe(9)),Xs(r,t),t.write_shift(1,e.v),t}function lb(e){var r=Ks(e),t=e.read_shift(1);return[r,t,"e"]}function cb(e,r,t){return t==null&&(t=Oe(8)),Js(r,t),t.write_shift(1,e.v),t.write_shift(2,0),t.write_shift(1,0),t}function db(e){var r=Jn(e),t=e.read_shift(4);return[r,t,"s"]}function fb(e,r,t){return t==null&&(t=Oe(12)),Xs(r,t),t.write_shift(4,r.v),t}function hb(e){var r=Ks(e),t=e.read_shift(4);return[r,t,"s"]}function ub(e,r,t){return t==null&&(t=Oe(8)),Js(r,t),t.write_shift(4,r.v),t}function mb(e){var r=Jn(e),t=Hi(e);return[r,t,"n"]}function pb(e,r,t){return t==null&&(t=Oe(16)),Xs(r,t),Vs(e.v,t),t}function xb(e){var r=Ks(e),t=Hi(e);return[r,t,"n"]}function gb(e,r,t){return t==null&&(t=Oe(12)),Js(r,t),Vs(e.v,t),t}function vb(e){var r=Jn(e),t=ku(e);return[r,t,"n"]}function yb(e,r,t){return t==null&&(t=Oe(12)),Xs(r,t),Tu(e.v,t),t}function bb(e){var r=Ks(e),t=ku(e);return[r,t,"n"]}function wb(e,r,t){return t==null&&(t=Oe(8)),Js(r,t),Tu(e.v,t),t}function Nb(e){var r=Jn(e),t=md(e);return[r,t,"is"]}function jb(e){var r=Jn(e),t=ln(e);return[r,t,"str"]}function Sb(e,r,t){return t==null&&(t=Oe(12+4*e.v.length)),Xs(r,t),Wr(e.v,t),t.length>t.l?t.slice(0,t.l):t}function _b(e){var r=Ks(e),t=ln(e);return[r,t,"str"]}function Ab(e,r,t){return t==null&&(t=Oe(8+4*e.v.length)),Js(r,t),Wr(e.v,t),t.length>t.l?t.slice(0,t.l):t}function kb(e,r,t){var n=e.l+r,s=Jn(e);s.r=t["!row"];var o=e.read_shift(1),l=[s,o,"b"];if(t.cellFormula){e.l+=2;var c=_c(e,n-e.l,t);l[3]=Di(c,null,s,t.supbooks,t)}else e.l=n;return l}function Tb(e,r,t){var n=e.l+r,s=Jn(e);s.r=t["!row"];var o=e.read_shift(1),l=[s,o,"e"];if(t.cellFormula){e.l+=2;var c=_c(e,n-e.l,t);l[3]=Di(c,null,s,t.supbooks,t)}else e.l=n;return l}function Cb(e,r,t){var n=e.l+r,s=Jn(e);s.r=t["!row"];var o=Hi(e),l=[s,o,"n"];if(t.cellFormula){e.l+=2;var c=_c(e,n-e.l,t);l[3]=Di(c,null,s,t.supbooks,t)}else e.l=n;return l}function Eb(e,r,t){var n=e.l+r,s=Jn(e);s.r=t["!row"];var o=ln(e),l=[s,o,"str"];if(t.cellFormula){e.l+=2;var c=_c(e,n-e.l,t);l[3]=Di(c,null,s,t.supbooks,t)}else e.l=n;return l}var Fb=Zs,Lb=Ui;function Pb(e,r){return r==null&&(r=Oe(4)),r.write_shift(4,e),r}function Ob(e,r){var t=e.l+r,n=Zs(e),s=pd(e),o=ln(e),l=ln(e),c=ln(e);e.l=t;var d={rfx:n,relId:s,loc:o,display:c};return l&&(d.Tooltip=l),d}function Ib(e,r){var t=Oe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Ui({s:Hr(e[0]),e:Hr(e[0])},t),xd("rId"+r,t);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return Wr(s||"",t),Wr(e[1].Tooltip||"",t),Wr("",t),t.slice(0,t.l)}function Db(){}function Rb(e,r,t){var n=e.l+r,s=Cu(e),o=e.read_shift(1),l=[s];if(l[2]=o,t.cellFormula){var c=_y(e,n-e.l,t);l[1]=c}else e.l=n;return l}function Mb(e,r,t){var n=e.l+r,s=Zs(e),o=[s];if(t.cellFormula){var l=ky(e,n-e.l,t);o[1]=l,e.l=n}else e.l=n;return o}function Bb(e,r,t){t==null&&(t=Oe(18));var n=Ac(e,r);t.write_shift(-4,e),t.write_shift(-4,e),t.write_shift(4,(n.width||10)*256),t.write_shift(4,0);var s=0;return r.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),r.level&&(s|=r.level<<8),t.write_shift(2,s),t}var h1=["left","right","top","bottom","header","footer"];function Ub(e){var r={};return h1.forEach(function(t){r[t]=Hi(e)}),r}function Hb(e,r){return r==null&&(r=Oe(6*8)),d1(e),h1.forEach(function(t){Vs(e[t],r)}),r}function Wb(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function zb(e,r,t){t==null&&(t=Oe(30));var n=924;return(((r||{}).Views||[])[0]||{}).RTL&&(n|=32),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function qb(e){var r=Oe(24);return r.write_shift(4,4),r.write_shift(4,1),Ui(e,r),r}function Vb(e,r){return r==null&&(r=Oe(16*4+2)),r.write_shift(2,e.password?$u(e.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?r.write_shift(4,e[t[0]]!=null&&!e[t[0]]?1:0):r.write_shift(4,e[t[0]]!=null&&e[t[0]]?0:1)}),r}function Gb(){}function $b(){}function Yb(e,r,t,n,s,o,l){if(r.v===void 0)return!1;var c="";switch(r.t){case"b":c=r.v?"1":"0";break;case"d":r=Sn(r),r.z=r.z||xr[14],r.v=jn(mn(r.v)),r.t="n";break;case"n":case"e":c=""+r.v;break;default:c=r.v;break}var d={r:t,c:n};switch(d.s=_s(s.cellXfs,r,s),r.l&&o["!links"].push([Xt(d),r.l]),r.c&&o["!comments"].push([Xt(d),r.c]),r.t){case"s":case"str":return s.bookSST?(c=Nd(s.Strings,r.v,s.revStrings),d.t="s",d.v=c,l?Ue(e,18,ub(r,d)):Ue(e,7,fb(r,d))):(d.t="str",l?Ue(e,17,Ab(r,d)):Ue(e,6,Sb(r,d))),!0;case"n":return r.v==(r.v|0)&&r.v>-1e3&&r.v<1e3?l?Ue(e,13,wb(r,d)):Ue(e,2,yb(r,d)):l?Ue(e,16,gb(r,d)):Ue(e,5,pb(r,d)),!0;case"b":return d.t="b",l?Ue(e,15,sb(r,d)):Ue(e,4,nb(r,d)),!0;case"e":return d.t="e",l?Ue(e,14,cb(r,d)):Ue(e,3,ob(r,d)),!0}return l?Ue(e,12,tb(r,d)):Ue(e,1,Qy(r,d)),!0}function Xb(e,r,t,n){var s=lr(r["!ref"]||"A1"),o,l="",c=[];Ue(e,145);var d=Array.isArray(r),h=s.e.r;r["!rows"]&&(h=Math.max(s.e.r,r["!rows"].length-1));for(var u=s.s.r;u<=h;++u){l=Kr(u),Gy(e,r,s,u);var g=!1;if(u<=s.e.r)for(var x=s.s.c;x<=s.e.c;++x){u===s.s.r&&(c[x]=on(x)),o=c[x]+l;var m=d?(r[u]||[])[x]:r[o];if(!m){g=!1;continue}g=Yb(e,m,u,x,n,r,g)}}Ue(e,146)}function Kb(e,r){!r||!r["!merges"]||(Ue(e,177,Pb(r["!merges"].length)),r["!merges"].forEach(function(t){Ue(e,176,Lb(t))}),Ue(e,178))}function Jb(e,r){!r||!r["!cols"]||(Ue(e,390),r["!cols"].forEach(function(t,n){t&&Ue(e,60,Bb(n,t))}),Ue(e,391))}function Zb(e,r){!r||!r["!ref"]||(Ue(e,648),Ue(e,649,qb(lr(r["!ref"]))),Ue(e,650))}function Qb(e,r,t){r["!links"].forEach(function(n){if(n[1].Target){var s=$t(t,-1,n[1].Target.replace(/#.*$/,""),Bt.HLINK);Ue(e,494,Ib(n,s))}}),delete r["!links"]}function e4(e,r,t,n){if(r["!comments"].length>0){var s=$t(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Bt.VML);Ue(e,551,xd("rId"+s)),r["!legacy"]=s}}function t4(e,r,t,n){if(r["!autofilter"]){var s=r["!autofilter"],o=typeof s.ref=="string"?s.ref:Cr(s.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var l=t.Workbook.Names,c=Mn(o);c.s.r==c.e.r&&(c.e.r=Mn(r["!ref"]).e.r,o=Cr(c));for(var d=0;d<l.length;++d){var h=l[d];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==n){h.Ref="'"+t.SheetNames[n]+"'!"+o;break}}d==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+o}),Ue(e,161,Ui(lr(o))),Ue(e,162)}}function r4(e,r,t){Ue(e,133),Ue(e,137,zb(r,t)),Ue(e,138),Ue(e,134)}function n4(e,r){r["!protect"]&&Ue(e,535,Vb(r["!protect"]))}function a4(e,r,t,n){var s=Nn(),o=t.SheetNames[e],l=t.Sheets[o]||{},c=o;try{t&&t.Workbook&&(c=t.Workbook.Sheets[e].CodeName||c)}catch{}var d=lr(l["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(r.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],Ue(s,129),(t.vbaraw||l["!outline"])&&Ue(s,147,Jy(c,l["!outline"])),Ue(s,148,Yy(d)),r4(s,l,t.Workbook),Jb(s,l),Xb(s,l,e,r),n4(s,l),t4(s,l,t,e),Kb(s,l),Qb(s,l,n),l["!margins"]&&Ue(s,476,Hb(l["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&Zb(s,l),e4(s,l,e,n),Ue(s,130),s.end()}function s4(e,r){e.l+=10;var t=ln(e);return{name:t}}var i4=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function o4(e){return!e.Workbook||!e.Workbook.WBProps?"false":M2(e.Workbook.WBProps.date1904)?"true":"false"}var l4="][*?/\\".split("");function u1(e,r){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return l4.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function c4(e,r,t){e.forEach(function(n,s){u1(n);for(var o=0;o<s;++o)if(n==e[o])throw new Error("Duplicate Sheet Name: "+n);if(t){var l=r&&r[s]&&r[s].CodeName||n;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function d4(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var r=e.Workbook&&e.Workbook.Sheets||[];c4(e.SheetNames,r,!!e.vbaraw);for(var t=0;t<e.SheetNames.length;++t)Ly(e.Sheets[e.SheetNames[t]],e.SheetNames[t],t)}function m1(e){var r=[Er];r[r.length]=Ke("workbook",null,{xmlns:Mi[0],"xmlns:r":Ur.r});var t=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(i4.forEach(function(c){e.Workbook.WBProps[c[0]]!=null&&e.Workbook.WBProps[c[0]]!=c[1]&&(n[c[0]]=e.Workbook.WBProps[c[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),r[r.length]=Ke("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],o=0;if(s&&s[0]&&s[0].Hidden){for(r[r.length]="<bookViews>",o=0;o!=e.SheetNames.length&&!(!s[o]||!s[o].Hidden);++o);o==e.SheetNames.length&&(o=0),r[r.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",o=0;o!=e.SheetNames.length;++o){var l={name:Yt(e.SheetNames[o].slice(0,31))};if(l.sheetId=""+(o+1),l["r:id"]="rId"+(o+1),s[o])switch(s[o].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}r[r.length]=Ke("sheet",null,l)}return r[r.length]="</sheets>",t&&(r[r.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(c){var d={name:c.Name};c.Comment&&(d.comment=c.Comment),c.Sheet!=null&&(d.localSheetId=""+c.Sheet),c.Hidden&&(d.hidden="1"),c.Ref&&(r[r.length]=Ke("definedName",Yt(c.Ref),d))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function f4(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=K0(e),t.name=ln(e),t}function h4(e,r){return r||(r=Oe(127)),r.write_shift(4,e.Hidden),r.write_shift(4,e.iTabID),xd(e.strRelID,r),Wr(e.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function u4(e,r){var t={},n=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var s=r>8?ln(e):"";return s.length>0&&(t.CodeName=s),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function m4(e,r){r||(r=Oe(72));var t=0;return e&&e.filterPrivacy&&(t|=8),r.write_shift(4,t),r.write_shift(4,0),Au(e&&e.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}function p4(e,r,t){var n=e.l+r;e.l+=4,e.l+=1;var s=e.read_shift(4),o=og(e),l=Ay(e,0,t),c=pd(e);e.l=n;var d={Name:o,Ptg:l};return s<268435455&&(d.Sheet=s),c&&(d.Comment=c),d}function x4(e,r){Ue(e,143);for(var t=0;t!=r.SheetNames.length;++t){var n=r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t]&&r.Workbook.Sheets[t].Hidden||0,s={Hidden:n,iTabID:t+1,strRelID:"rId"+(t+1),name:r.SheetNames[t]};Ue(e,156,h4(s))}Ue(e,144)}function g4(e,r){r||(r=Oe(127));for(var t=0;t!=4;++t)r.write_shift(4,0);return Wr("SheetJS",r),Wr(ec.version,r),Wr(ec.version,r),Wr("7262",r),r.length>r.l?r.slice(0,r.l):r}function v4(e,r){r||(r=Oe(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,e),r.write_shift(4,e);var t=120;return r.write_shift(1,t),r.length>r.l?r.slice(0,r.l):r}function y4(e,r){if(!(!r.Workbook||!r.Workbook.Sheets)){for(var t=r.Workbook.Sheets,n=0,s=-1,o=-1;n<t.length;++n)!t[n]||!t[n].Hidden&&s==-1?s=n:t[n].Hidden==1&&o==-1&&(o=n);o>s||(Ue(e,135),Ue(e,158,v4(s)),Ue(e,136))}}function b4(e,r){var t=Nn();return Ue(t,131),Ue(t,128,g4()),Ue(t,153,m4(e.Workbook&&e.Workbook.WBProps||null)),y4(t,e),x4(t,e),Ue(t,132),t.end()}function w4(e,r,t){return(r.slice(-4)===".bin"?b4:m1)(e)}function N4(e,r,t,n,s){return(r.slice(-4)===".bin"?a4:f1)(e,t,n,s)}function j4(e,r,t){return(r.slice(-4)===".bin"?Hv:Ku)(e,t)}function S4(e,r,t){return(r.slice(-4)===".bin"?mv:Gu)(e,t)}function _4(e,r,t){return(r.slice(-4)===".bin"?n5:t1)(e)}function A4(e){return(e.slice(-4)===".bin"?Xv:Qu)()}function k4(e,r){var t=[];return e.Props&&t.push(jg(e.Props,r)),e.Custprops&&t.push(Sg(e.Props,e.Custprops)),t.join("")}function T4(){return""}function C4(e,r){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(n,s){var o=[];o.push(Ke("NumberFormat",null,{"ss:Format":Yt(xr[n.numFmtId])}));var l={"ss:ID":"s"+(21+s)};t.push(Ke("Style",o.join(""),l))}),Ke("Styles",t.join(""))}function p1(e){return Ke("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+bd(e.Ref,{r:0,c:0})})}function E4(e){if(!((e||{}).Workbook||{}).Names)return"";for(var r=e.Workbook.Names,t=[],n=0;n<r.length;++n){var s=r[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||t.push(p1(s)))}return Ke("Names",t.join(""))}function F4(e,r,t,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,o=[],l=0;l<s.length;++l){var c=s[l];c.Sheet==t&&(c.Name.match(/^_xlfn\./)||o.push(p1(c)))}return o.join("")}function L4(e,r,t,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Ke("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Ke("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Ke("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[t])if(n.Workbook.Sheets[t].Hidden)s.push(Ke("Visible",n.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<t&&!(n.Workbook.Sheets[o]&&!n.Workbook.Sheets[o].Hidden);++o);o==t&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Xr("ProtectContents","True")),e["!protect"].objects&&s.push(Xr("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Xr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Xr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Xr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&s.push("<"+l[1]+"/>")})),s.length==0?"":Ke("WorksheetOptions",s.join(""),{xmlns:In.x})}function P4(e){return e.map(function(r){var t=R2(r.t||""),n=Ke("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ke("Comment",n,{"ss:Author":r.a})}).join("")}function O4(e,r,t,n,s,o,l){if(!e||e.v==null&&e.f==null)return"";var c={};if(e.f&&(c["ss:Formula"]="="+Yt(bd(e.f,l))),e.F&&e.F.slice(0,r.length)==r){var d=Hr(e.F.slice(r.length+1));c["ss:ArrayRange"]="RC:R"+(d.r==l.r?"":"["+(d.r-l.r)+"]")+"C"+(d.c==l.c?"":"["+(d.c-l.c)+"]")}if(e.l&&e.l.Target&&(c["ss:HRef"]=Yt(e.l.Target),e.l.Tooltip&&(c["x:HRefScreenTip"]=Yt(e.l.Tooltip))),t["!merges"])for(var h=t["!merges"],u=0;u!=h.length;++u)h[u].s.c!=l.c||h[u].s.r!=l.r||(h[u].e.c>h[u].s.c&&(c["ss:MergeAcross"]=h[u].e.c-h[u].s.c),h[u].e.r>h[u].s.r&&(c["ss:MergeDown"]=h[u].e.r-h[u].s.r));var g="",x="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":g="Number",x=String(e.v);break;case"b":g="Boolean",x=e.v?"1":"0";break;case"e":g="Error",x=Vo[e.v];break;case"d":g="DateTime",x=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||xr[14]);break;case"s":g="String",x=D2(e.v||"");break}var m=_s(n.cellXfs,e,n);c["ss:StyleID"]="s"+(21+m),c["ss:Index"]=l.c+1;var y=e.v!=null?x:"",v=e.t=="z"?"":'<Data ss:Type="'+g+'">'+y+"</Data>";return(e.c||[]).length>0&&(v+=P4(e.c)),Ke("Cell",v,c)}function I4(e,r){var t='<Row ss:Index="'+(e+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=Xu(r.hpt)),r.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(t+=' ss:Hidden="1"')),t+">"}function D4(e,r,t,n){if(!e["!ref"])return"";var s=lr(e["!ref"]),o=e["!merges"]||[],l=0,c=[];e["!cols"]&&e["!cols"].forEach(function(j,w){vd(j);var N=!!j.width,_=Ac(w,j),C={"ss:Index":w+1};N&&(C["ss:Width"]=dc(_.width)),j.hidden&&(C["ss:Hidden"]="1"),c.push(Ke("Column",null,C))});for(var d=Array.isArray(e),h=s.s.r;h<=s.e.r;++h){for(var u=[I4(h,(e["!rows"]||[])[h])],g=s.s.c;g<=s.e.c;++g){var x=!1;for(l=0;l!=o.length;++l)if(!(o[l].s.c>g)&&!(o[l].s.r>h)&&!(o[l].e.c<g)&&!(o[l].e.r<h)){(o[l].s.c!=g||o[l].s.r!=h)&&(x=!0);break}if(!x){var m={r:h,c:g},y=Xt(m),v=d?(e[h]||[])[g]:e[y];u.push(O4(v,y,e,r,t,n,m))}}u.push("</Row>"),u.length>2&&c.push(u.join(""))}return c.join("")}function R4(e,r,t){var n=[],s=t.SheetNames[e],o=t.Sheets[s],l=o?F4(o,r,e,t):"";return l.length>0&&n.push("<Names>"+l+"</Names>"),l=o?D4(o,r,e,t):"",l.length>0&&n.push("<Table>"+l+"</Table>"),n.push(L4(o,r,e,t)),n.join("")}function M4(e,r){r||(r={}),e.SSF||(e.SSF=Sn(xr)),e.SSF&&(wc(),bc(e.SSF),r.revssf=Nc(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF,r.cellXfs=[],_s(r.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(k4(e,r)),t.push(T4()),t.push(""),t.push("");for(var n=0;n<e.SheetNames.length;++n)t.push(Ke("Worksheet",R4(n,r,e),{"ss:Name":Yt(e.SheetNames[n])}));return t[2]=C4(e,r),t[3]=E4(e),Er+Ke("Workbook",t.join(""),{xmlns:In.ss,"xmlns:o":In.o,"xmlns:x":In.x,"xmlns:ss":In.ss,"xmlns:dt":In.dt,"xmlns:html":In.html})}var E0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function B4(e,r){var t=[],n=[],s=[],o=0,l,c=Wf(th,"n"),d=Wf(rh,"n");if(e.Props)for(l=Jr(e.Props),o=0;o<l.length;++o)(Object.prototype.hasOwnProperty.call(c,l[o])?t:Object.prototype.hasOwnProperty.call(d,l[o])?n:s).push([l[o],e.Props[l[o]]]);if(e.Custprops)for(l=Jr(e.Custprops),o=0;o<l.length;++o)Object.prototype.hasOwnProperty.call(e.Props||{},l[o])||(Object.prototype.hasOwnProperty.call(c,l[o])?t:Object.prototype.hasOwnProperty.call(d,l[o])?n:s).push([l[o],e.Custprops[l[o]]]);var h=[];for(o=0;o<s.length;++o)Bu.indexOf(s[o][0])>-1||Du.indexOf(s[o][0])>-1||s[o][1]!=null&&h.push(s[o]);n.length&&Zt.utils.cfb_add(r,"/SummaryInformation",oh(n,E0.SI,d,rh)),(t.length||h.length)&&Zt.utils.cfb_add(r,"/DocumentSummaryInformation",oh(t,E0.DSI,c,th,h.length?h:null,E0.UDI))}function U4(e,r){var t=r||{},n=Zt.utils.cfb_new({root:"R"}),s="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":s="/Workbook",t.biff=8;break;case"biff5":s="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Zt.utils.cfb_add(n,s,x1(e,t)),t.biff==8&&(e.Props||e.Custprops)&&B4(e,n),t.biff==8&&e.vbaraw&&a5(n,Zt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var H4={0:{f:qy},1:{f:Zy},2:{f:vb},3:{f:ib},4:{f:rb},5:{f:mb},6:{f:jb},7:{f:db},8:{f:Eb},9:{f:Cb},10:{f:kb},11:{f:Tb},12:{f:eb},13:{f:bb},14:{f:lb},15:{f:ab},16:{f:xb},17:{f:_b},18:{f:hb},19:{f:md},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:p4},40:{},42:{},43:{f:jv},44:{f:wv},45:{f:Av},46:{f:Tv},47:{f:kv},48:{},49:{f:eg},50:{},51:{f:qv},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:tv},62:{f:Nb},63:{f:Kv},64:{f:Gb},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Fa,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Wb},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Ky},148:{f:$y,p:16},151:{f:Db},152:{},153:{f:u4},154:{},155:{},156:{f:f4},157:{},158:{},159:{T:1,f:fv},160:{T:-1},161:{T:1,f:Zs},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Fb},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Wv},336:{T:-1},337:{f:$v,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:K0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Xg},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Rb},427:{f:Mb},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Ub},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Xy},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Ob},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:K0},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:t5},633:{T:1},634:{T:-1},635:{T:1,f:Qv},636:{T:-1},637:{f:ag},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:s4},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:$b},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Je(e,r,t,n){var s=r;if(!isNaN(s)){var o=n||(t||[]).length||0,l=e.next(4);l.write_shift(2,s),l.write_shift(2,o),o>0&&fd(t)&&e.push(t)}}function W4(e,r,t,n){var s=(t||[]).length||0;if(s<=8224)return Je(e,r,t,s);var o=r;if(!isNaN(o)){for(var l=t.parts||[],c=0,d=0,h=0;h+(l[c]||8224)<=8224;)h+=l[c]||8224,c++;var u=e.next(4);for(u.write_shift(2,o),u.write_shift(2,h),e.push(t.slice(d,d+h)),d+=h;d<s;){for(u=e.next(4),u.write_shift(2,60),h=0;h+(l[c]||8224)<=8224;)h+=l[c]||8224,c++;u.write_shift(2,h),e.push(t.slice(d,d+h)),d+=h}}}function $o(e,r,t){return e||(e=Oe(7)),e.write_shift(2,r),e.write_shift(2,t),e.write_shift(2,0),e.write_shift(1,0),e}function z4(e,r,t,n){var s=Oe(9);return $o(s,e,r),Hu(t,n||"b",s),s}function q4(e,r,t){var n=Oe(8+2*t.length);return $o(n,e,r),n.write_shift(1,t.length),n.write_shift(t.length,t,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function V4(e,r,t,n){if(r.v!=null)switch(r.t){case"d":case"n":var s=r.t=="d"?jn(mn(r.v)):r.v;s==(s|0)&&s>=0&&s<65536?Je(e,2,sv(t,n,s)):Je(e,3,av(t,n,s));return;case"b":case"e":Je(e,5,z4(t,n,r.v,r.t));return;case"s":case"str":Je(e,4,q4(t,n,(r.v||"").slice(0,255)));return}Je(e,1,$o(null,t,n))}function G4(e,r,t,n){var s=Array.isArray(r),o=lr(r["!ref"]||"A1"),l,c="",d=[];if(o.e.c>255||o.e.r>16383){if(n.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),l=Cr(o)}for(var h=o.s.r;h<=o.e.r;++h){c=Kr(h);for(var u=o.s.c;u<=o.e.c;++u){h===o.s.r&&(d[u]=on(u)),l=d[u]+c;var g=s?(r[h]||[])[u]:r[l];g&&V4(e,g,h,u)}}}function $4(e,r){for(var t=r||{},n=Nn(),s=0,o=0;o<e.SheetNames.length;++o)e.SheetNames[o]==t.sheet&&(s=o);if(s==0&&t.sheet&&e.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return Je(n,t.biff==4?1033:t.biff==3?521:9,gd(e,16,t)),G4(n,e.Sheets[e.SheetNames[s]],s,t),Je(n,10),n.end()}function Y4(e,r,t){Je(e,49,Hg({sz:12,name:"Arial"},t))}function X4(e,r,t){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)r[s]!=null&&Je(e,1054,qg(s,r[s],t))})}function K4(e,r){var t=Oe(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),Je(e,2151,t),t=Oe(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),qu(lr(r["!ref"]||"A1"),t),t.write_shift(4,4),Je(e,2152,t)}function J4(e,r){for(var t=0;t<16;++t)Je(e,224,ch({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(n){Je(e,224,ch(n,0,r))})}function Z4(e,r){for(var t=0;t<r["!links"].length;++t){var n=r["!links"][t];Je(e,440,Zg(n)),n[1].Tooltip&&Je(e,2048,Qg(n))}delete r["!links"]}function Q4(e,r){if(r){var t=0;r.forEach(function(n,s){++t<=256&&n&&Je(e,125,rv(Ac(s,n),s))})}}function ew(e,r,t,n,s){var o=16+_s(s.cellXfs,r,s);if(r.v==null&&!r.bf){Je(e,513,Gs(t,n,o));return}if(r.bf)Je(e,6,Sy(r,t,n,s,o));else switch(r.t){case"d":case"n":var l=r.t=="d"?jn(mn(r.v)):r.v;Je(e,515,Yg(t,n,l,o));break;case"b":case"e":Je(e,517,$g(t,n,r.v,o,s,r.t));break;case"s":case"str":if(s.bookSST){var c=Nd(s.Strings,r.v,s.revStrings);Je(e,253,Wg(t,n,c,o))}else Je(e,516,zg(t,n,(r.v||"").slice(0,255),o,s));break;default:Je(e,513,Gs(t,n,o))}}function tw(e,r,t){var n=Nn(),s=t.SheetNames[e],o=t.Sheets[s]||{},l=(t||{}).Workbook||{},c=(l.Sheets||[])[e]||{},d=Array.isArray(o),h=r.biff==8,u,g="",x=[],m=lr(o["!ref"]||"A1"),y=h?65536:16384;if(m.e.c>255||m.e.r>=y){if(r.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,y-1)}Je(n,2057,gd(t,16,r)),Je(n,13,Kn(1)),Je(n,12,Kn(100)),Je(n,15,un(!0)),Je(n,17,un(!1)),Je(n,16,Vs(.001)),Je(n,95,un(!0)),Je(n,42,un(!1)),Je(n,43,un(!1)),Je(n,130,Kn(1)),Je(n,128,Gg()),Je(n,131,un(!1)),Je(n,132,un(!1)),h&&Q4(n,o["!cols"]),Je(n,512,Vg(m,r)),h&&(o["!links"]=[]);for(var v=m.s.r;v<=m.e.r;++v){g=Kr(v);for(var j=m.s.c;j<=m.e.c;++j){v===m.s.r&&(x[j]=on(j)),u=x[j]+g;var w=d?(o[v]||[])[j]:o[u];w&&(ew(n,w,v,j,r),h&&w.l&&o["!links"].push([u,w.l]))}}var N=c.CodeName||c.name||s;return h&&Je(n,574,Ug((l.Views||[])[0])),h&&(o["!merges"]||[]).length&&Je(n,229,Jg(o["!merges"])),h&&Z4(n,o),Je(n,442,zu(N)),h&&K4(n,o),Je(n,10),n.end()}function rw(e,r,t){var n=Nn(),s=(e||{}).Workbook||{},o=s.Sheets||[],l=s.WBProps||{},c=t.biff==8,d=t.biff==5;if(Je(n,2057,gd(e,5,t)),t.bookType=="xla"&&Je(n,135),Je(n,225,c?Kn(1200):null),Je(n,193,kg(2)),d&&Je(n,191),d&&Je(n,192),Je(n,226),Je(n,92,Dg("SheetJS",t)),Je(n,66,Kn(c?1200:1252)),c&&Je(n,353,Kn(0)),c&&Je(n,448),Je(n,317,nv(e.SheetNames.length)),c&&e.vbaraw&&Je(n,211),c&&e.vbaraw){var h=l.CodeName||"ThisWorkbook";Je(n,442,zu(h))}Je(n,156,Kn(17)),Je(n,25,un(!1)),Je(n,18,un(!1)),Je(n,19,Kn(0)),c&&Je(n,431,un(!1)),c&&Je(n,444,Kn(0)),Je(n,61,Bg()),Je(n,64,un(!1)),Je(n,141,Kn(0)),Je(n,34,un(o4(e)=="true")),Je(n,14,un(!0)),c&&Je(n,439,un(!1)),Je(n,218,Kn(0)),Y4(n,e,t),X4(n,e.SSF,t),J4(n,t),c&&Je(n,352,un(!1));var u=n.end(),g=Nn();c&&Je(g,140,ev()),c&&t.Strings&&W4(g,252,Mg(t.Strings)),Je(g,10);var x=g.end(),m=Nn(),y=0,v=0;for(v=0;v<e.SheetNames.length;++v)y+=(c?12:11)+(c?2:1)*e.SheetNames[v].length;var j=u.length+y+x.length;for(v=0;v<e.SheetNames.length;++v){var w=o[v]||{};Je(m,133,Rg({pos:j,hs:w.Hidden||0,dt:0,name:e.SheetNames[v]},t)),j+=r[v].length}var N=m.end();if(y!=N.length)throw new Error("BS8 "+y+" != "+N.length);var _=[];return u.length&&_.push(u),N.length&&_.push(N),x.length&&_.push(x),Yr(_)}function nw(e,r){var t=r||{},n=[];e&&!e.SSF&&(e.SSF=Sn(xr)),e&&e.SSF&&(wc(),bc(e.SSF),t.revssf=Nc(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,jd(t),t.cellXfs=[],_s(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=tw(s,t,e);return n.unshift(rw(e,n,t)),Yr(n)}function x1(e,r){for(var t=0;t<=e.SheetNames.length;++t){var n=e.Sheets[e.SheetNames[t]];if(!(!n||!n["!ref"])){var s=Mn(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var o=r||{};switch(o.biff||2){case 8:case 5:return nw(e,r);case 4:case 3:case 2:return $4(e,r)}throw new Error("invalid type "+o.bookType+" for BIFF")}function aw(e,r,t,n){for(var s=e["!merges"]||[],o=[],l=r.s.c;l<=r.e.c;++l){for(var c=0,d=0,h=0;h<s.length;++h)if(!(s[h].s.r>t||s[h].s.c>l)&&!(s[h].e.r<t||s[h].e.c<l)){if(s[h].s.r<t||s[h].s.c<l){c=-1;break}c=s[h].e.r-s[h].s.r+1,d=s[h].e.c-s[h].s.c+1;break}if(!(c<0)){var u=Xt({r:t,c:l}),g=n.dense?(e[t]||[])[l]:e[u],x=g&&g.v!=null&&(g.h||I2(g.w||(Xa(g),g.w)||""))||"",m={};c>1&&(m.rowspan=c),d>1&&(m.colspan=d),n.editable?x='<span contenteditable="true">'+x+"</span>":g&&(m["data-t"]=g&&g.t||"z",g.v!=null&&(m["data-v"]=g.v),g.z!=null&&(m["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+g.l.Target+'">'+x+"</a>")),m.id=(n.id||"sjs")+"-"+u,o.push(Ke("td",x,m))}}var y="<tr>";return y+o.join("")+"</tr>"}var sw='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',iw="</body></html>";function ow(e,r,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function g1(e,r){var t=r||{},n=t.header!=null?t.header:sw,s=t.footer!=null?t.footer:iw,o=[n],l=Mn(e["!ref"]);t.dense=Array.isArray(e),o.push(ow(e,l,t));for(var c=l.s.r;c<=l.e.r;++c)o.push(aw(e,l,c,t));return o.push("</table>"+s),o.join("")}function v1(e,r,t){var n=t||{},s=0,o=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?Hr(n.origin):n.origin;s=l.r,o=l.c}var c=r.getElementsByTagName("tr"),d=Math.min(n.sheetRows||1e7,c.length),h={s:{r:0,c:0},e:{r:s,c:o}};if(e["!ref"]){var u=Mn(e["!ref"]);h.s.r=Math.min(h.s.r,u.s.r),h.s.c=Math.min(h.s.c,u.s.c),h.e.r=Math.max(h.e.r,u.e.r),h.e.c=Math.max(h.e.c,u.e.c),s==-1&&(h.e.r=s=u.e.r+1)}var g=[],x=0,m=e["!rows"]||(e["!rows"]=[]),y=0,v=0,j=0,w=0,N=0,_=0;for(e["!cols"]||(e["!cols"]=[]);y<c.length&&v<d;++y){var C=c[y];if(xh(C)){if(n.display)continue;m[v]={hidden:!0}}var M=C.children;for(j=w=0;j<M.length;++j){var D=M[j];if(!(n.display&&xh(D))){var L=D.hasAttribute("data-v")?D.getAttribute("data-v"):D.hasAttribute("v")?D.getAttribute("v"):B2(D.innerHTML),E=D.getAttribute("data-z")||D.getAttribute("z");for(x=0;x<g.length;++x){var P=g[x];P.s.c==w+o&&P.s.r<v+s&&v+s<=P.e.r&&(w=P.e.c+1-o,x=-1)}_=+D.getAttribute("colspan")||1,((N=+D.getAttribute("rowspan")||1)>1||_>1)&&g.push({s:{r:v+s,c:w+o},e:{r:v+s+(N||1)-1,c:w+o+(_||1)-1}});var H={t:"s",v:L},k=D.getAttribute("data-t")||D.getAttribute("t")||"";L!=null&&(L.length==0?H.t=k||"z":n.raw||L.trim().length==0||k=="s"||(L==="TRUE"?H={t:"b",v:!0}:L==="FALSE"?H={t:"b",v:!1}:isNaN(Ga(L))?isNaN(Ro(L).getDate())||(H={t:"d",v:mn(L)},n.cellDates||(H={t:"n",v:jn(H.v)}),H.z=n.dateNF||xr[14]):H={t:"n",v:Ga(L)})),H.z===void 0&&E!=null&&(H.z=E);var T="",W=D.getElementsByTagName("A");if(W&&W.length)for(var G=0;G<W.length&&!(W[G].hasAttribute("href")&&(T=W[G].getAttribute("href"),T.charAt(0)!="#"));++G);T&&T.charAt(0)!="#"&&(H.l={Target:T}),n.dense?(e[v+s]||(e[v+s]=[]),e[v+s][w+o]=H):e[Xt({c:w+o,r:v+s})]=H,h.e.c<w+o&&(h.e.c=w+o),w+=_}}++v}return g.length&&(e["!merges"]=(e["!merges"]||[]).concat(g)),h.e.r=Math.max(h.e.r,v-1+s),e["!ref"]=Cr(h),v>=d&&(e["!fullref"]=Cr((h.e.r=c.length-y+v-1+s,h))),e}function y1(e,r){var t=r||{},n=t.dense?[]:{};return v1(n,e,r)}function lw(e,r){return Ys(y1(e,r),r)}function xh(e){var r="",t=cw(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function cw(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var dw=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+Bo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Er+r}}(),gh=function(){var e=function(o){return Yt(o).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,n=function(o,l,c){var d=[];d.push('      <table:table table:name="'+Yt(l.SheetNames[c])+`" table:style-name="ta1">
`);var h=0,u=0,g=Mn(o["!ref"]||"A1"),x=o["!merges"]||[],m=0,y=Array.isArray(o);if(o["!cols"])for(u=0;u<=g.e.c;++u)d.push("        <table:table-column"+(o["!cols"][u]?' table:style-name="co'+o["!cols"][u].ods+'"':"")+`></table:table-column>
`);var v="",j=o["!rows"]||[];for(h=0;h<g.s.r;++h)v=j[h]?' table:style-name="ro'+j[h].ods+'"':"",d.push("        <table:table-row"+v+`></table:table-row>
`);for(;h<=g.e.r;++h){for(v=j[h]?' table:style-name="ro'+j[h].ods+'"':"",d.push("        <table:table-row"+v+`>
`),u=0;u<g.s.c;++u)d.push(r);for(;u<=g.e.c;++u){var w=!1,N={},_="";for(m=0;m!=x.length;++m)if(!(x[m].s.c>u)&&!(x[m].s.r>h)&&!(x[m].e.c<u)&&!(x[m].e.r<h)){(x[m].s.c!=u||x[m].s.r!=h)&&(w=!0),N["table:number-columns-spanned"]=x[m].e.c-x[m].s.c+1,N["table:number-rows-spanned"]=x[m].e.r-x[m].s.r+1;break}if(w){d.push(t);continue}var C=Xt({r:h,c:u}),M=y?(o[h]||[])[u]:o[C];if(M&&M.f&&(N["table:formula"]=Yt(Ey(M.f)),M.F&&M.F.slice(0,C.length)==C)){var D=Mn(M.F);N["table:number-matrix-columns-spanned"]=D.e.c-D.s.c+1,N["table:number-matrix-rows-spanned"]=D.e.r-D.s.r+1}if(!M){d.push(r);continue}switch(M.t){case"b":_=M.v?"TRUE":"FALSE",N["office:value-type"]="boolean",N["office:boolean-value"]=M.v?"true":"false";break;case"n":_=M.w||String(M.v||0),N["office:value-type"]="float",N["office:value"]=M.v||0;break;case"s":case"str":_=M.v==null?"":M.v,N["office:value-type"]="string";break;case"d":_=M.w||mn(M.v).toISOString(),N["office:value-type"]="date",N["office:date-value"]=mn(M.v).toISOString(),N["table:style-name"]="ce1";break;default:d.push(r);continue}var L=e(_);if(M.l&&M.l.Target){var E=M.l.Target;E=E.charAt(0)=="#"?"#"+Fy(E.slice(1)):E,E.charAt(0)!="#"&&!E.match(/^\w+:/)&&(E="../"+E),L=Ke("text:a",L,{"xlink:href":E.replace(/&/g,"&amp;")})}d.push("          "+Ke("table:table-cell",Ke("text:p",L,{}),N)+`
`)}d.push(`        </table:table-row>
`)}return d.push(`      </table:table>
`),d.join("")},s=function(o,l){o.push(` <office:automatic-styles>
`),o.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),o.push(`   <number:month number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:day number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:year/>
`),o.push(`  </number:date-style>
`);var c=0;l.SheetNames.map(function(h){return l.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var u=0;u<h["!cols"].length;++u)if(h["!cols"][u]){var g=h["!cols"][u];if(g.width==null&&g.wpx==null&&g.wch==null)continue;vd(g),g.ods=c;var x=h["!cols"][u].wpx+"px";o.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),o.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),o.push(`  </style:style>
`),++c}}});var d=0;l.SheetNames.map(function(h){return l.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var u=0;u<h["!rows"].length;++u)if(h["!rows"][u]){h["!rows"][u].ods=d;var g=h["!rows"][u].hpx+"px";o.push('  <style:style style:name="ro'+d+`" style:family="table-row">
`),o.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+g+`"/>
`),o.push(`  </style:style>
`),++d}}}),o.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),o.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),o.push(`  </style:style>
`),o.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),o.push(` </office:automatic-styles>
`)};return function(l,c){var d=[Er],h=Bo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Bo({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(d.push("<office:document"+h+u+`>
`),d.push(Ou().replace(/office:document-meta/g,"office:meta"))):d.push("<office:document-content"+h+`>
`),s(d,l),d.push(`  <office:body>
`),d.push(`    <office:spreadsheet>
`);for(var g=0;g!=l.SheetNames.length;++g)d.push(n(l.Sheets[l.SheetNames[g]],l,g));return d.push(`    </office:spreadsheet>
`),d.push(`  </office:body>
`),c.bookType=="fods"?d.push("</office:document>"):d.push("</office:document-content>"),d.join("")}}();function b1(e,r){if(r.bookType=="fods")return gh(e,r);var t=od(),n="",s=[],o=[];return n="mimetype",Et(t,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Et(t,n,gh(e,r)),s.push([n,"text/xml"]),o.push([n,"ContentFile"]),n="styles.xml",Et(t,n,dw(e,r)),s.push([n,"text/xml"]),o.push([n,"StylesFile"]),n="meta.xml",Et(t,n,Er+Ou()),s.push([n,"text/xml"]),o.push([n,"MetadataFile"]),n="manifest.rdf",Et(t,n,Ng(o)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Et(t,n,bg(s)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function uc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function fw(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):ha(Mo(e))}function hw(e,r){e:for(var t=0;t<=e.length-r.length;++t){for(var n=0;n<r.length;++n)if(e[t+n]!=r[n])continue e;return!0}return!1}function Ss(e){var r=e.reduce(function(s,o){return s+o.length},0),t=new Uint8Array(r),n=0;return e.forEach(function(s){t.set(s,n),n+=s.length}),t}function uw(e,r,t){var n=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,s=t/Math.pow(10,n-6176);e[r+15]|=n>>7,e[r+14]|=(n&127)<<1;for(var o=0;s>=1;++o,s/=256)e[r+o]=s&255;e[r+15]|=t>=0?0:128}function Uo(e,r){var t=r?r[0]:0,n=e[t]&127;e:if(e[t++]>=128&&(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),n}function Gt(e){var r=new Uint8Array(7);r[0]=e&127;var t=1;e:if(e>127){if(r[t-1]|=128,r[t]=e>>7&127,++t,e<=16383||(r[t-1]|=128,r[t]=e>>14&127,++t,e<=2097151)||(r[t-1]|=128,r[t]=e>>21&127,++t,e<=268435455)||(r[t-1]|=128,r[t]=e/256>>>21&127,++t,e<=34359738367)||(r[t-1]|=128,r[t]=e/65536>>>21&127,++t,e<=4398046511103))break e;r[t-1]|=128,r[t]=e/16777216>>>21&127,++t}return r.slice(0,t)}function Ii(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function Ir(e){for(var r=[],t=[0];t[0]<e.length;){var n=t[0],s=Uo(e,t),o=s&7;s=Math.floor(s/8);var l=0,c;if(s==0)break;switch(o){case 0:{for(var d=t[0];e[t[0]++]>=128;);c=e.slice(d,t[0])}break;case 5:l=4,c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 1:l=8,c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 2:l=Uo(e,t),c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(s," at offset ").concat(n))}var h={data:c,type:o};r[s]==null?r[s]=[h]:r[s].push(h)}return r}function Gr(e){var r=[];return e.forEach(function(t,n){t.forEach(function(s){s.data&&(r.push(Gt(n*8+s.type)),s.type==2&&r.push(Gt(s.data.length)),r.push(s.data))})}),Ss(r)}function la(e){for(var r,t=[],n=[0];n[0]<e.length;){var s=Uo(e,n),o=Ir(e.slice(n[0],n[0]+s));n[0]+=s;var l={id:Ii(o[1][0].data),messages:[]};o[2].forEach(function(c){var d=Ir(c.data),h=Ii(d[3][0].data);l.messages.push({meta:d,data:e.slice(n[0],n[0]+h)}),n[0]+=h}),(r=o[3])!=null&&r[0]&&(l.merge=Ii(o[3][0].data)>>>0>0),t.push(l)}return t}function Si(e){var r=[];return e.forEach(function(t){var n=[];n[1]=[{data:Gt(t.id),type:0}],n[2]=[],t.merge!=null&&(n[3]=[{data:Gt(+!!t.merge),type:0}]);var s=[];t.messages.forEach(function(l){s.push(l.data),l.meta[3]=[{type:0,data:Gt(l.data.length)}],n[2].push({data:Gr(l.meta),type:2})});var o=Gr(n);r.push(Gt(o.length)),r.push(o),s.forEach(function(l){return r.push(l)})}),Ss(r)}function mw(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],n=Uo(r,t),s=[];t[0]<r.length;){var o=r[t[0]]&3;if(o==0){var l=r[t[0]++]>>2;if(l<60)++l;else{var c=l-59;l=r[t[0]],c>1&&(l|=r[t[0]+1]<<8),c>2&&(l|=r[t[0]+2]<<16),c>3&&(l|=r[t[0]+3]<<24),l>>>=0,l++,t[0]+=c}s.push(r.slice(t[0],t[0]+l)),t[0]+=l;continue}else{var d=0,h=0;if(o==1?(h=(r[t[0]]>>2&7)+4,d=(r[t[0]++]&224)<<3,d|=r[t[0]++]):(h=(r[t[0]++]>>2)+1,o==2?(d=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(d=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),s=[Ss(s)],d==0)throw new Error("Invalid offset 0");if(d>s[0].length)throw new Error("Invalid offset beyond length");if(h>=d)for(s.push(s[0].slice(-d)),h-=d;h>=s[s.length-1].length;)s.push(s[s.length-1]),h-=s[s.length-1].length;s.push(s[0].slice(-d,-d+h))}}var u=Ss(s);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function ca(e){for(var r=[],t=0;t<e.length;){var n=e[t++],s=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(mw(n,e.slice(t,t+s))),t+=s}if(t!==e.length)throw new Error("data is not a valid framed stream!");return Ss(r)}function _i(e){for(var r=[],t=0;t<e.length;){var n=Math.min(e.length-t,268435455),s=new Uint8Array(4);r.push(s);var o=Gt(n),l=o.length;r.push(o),n<=60?(l++,r.push(new Uint8Array([n-1<<2]))):n<=256?(l+=2,r.push(new Uint8Array([240,n-1&255]))):n<=65536?(l+=3,r.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(l+=4,r.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(l+=5,r.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),r.push(e.slice(t,t+n)),l+=n,s[0]=0,s[1]=l&255,s[2]=l>>8&255,s[3]=l>>16&255,t+=n}return Ss(r)}function F0(e,r){var t=new Uint8Array(32),n=uc(t),s=12,o=0;switch(t[0]=5,e.t){case"n":t[1]=2,uw(t,s,e.v),o|=1,s+=16;break;case"b":t[1]=6,n.setFloat64(s,e.v?1:0,!0),o|=2,s+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[1]=3,n.setUint32(s,r.indexOf(e.v),!0),o|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,o,!0),t.slice(0,s)}function L0(e,r){var t=new Uint8Array(32),n=uc(t),s=12,o=0;switch(t[0]=3,e.t){case"n":t[2]=2,n.setFloat64(s,e.v,!0),o|=32,s+=8;break;case"b":t[2]=6,n.setFloat64(s,e.v?1:0,!0),o|=32,s+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[2]=3,n.setUint32(s,r.indexOf(e.v),!0),o|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,o,!0),t.slice(0,s)}function us(e){var r=Ir(e);return Uo(r[1][0].data)}function pw(e,r,t){var n,s,o,l;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var c=((l=(o=e[8])==null?void 0:o[0])==null?void 0:l.data)&&Ii(e[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var d=0,h=uc(e[7][0].data),u=0,g=[],x=uc(e[4][0].data),m=0,y=[],v=0;v<r.length;++v){if(r[v]==null){h.setUint16(v*2,65535,!0),x.setUint16(v*2,65535);continue}h.setUint16(v*2,u,!0),x.setUint16(v*2,m,!0);var j,w;switch(typeof r[v]){case"string":j=F0({t:"s",v:r[v]},t),w=L0({t:"s",v:r[v]},t);break;case"number":j=F0({t:"n",v:r[v]},t),w=L0({t:"n",v:r[v]},t);break;case"boolean":j=F0({t:"b",v:r[v]},t),w=L0({t:"b",v:r[v]},t);break;default:throw new Error("Unsupported value "+r[v])}g.push(j),u+=j.length,y.push(w),m+=w.length,++d}for(e[2][0].data=Gt(d);v<e[7][0].data.length/2;++v)h.setUint16(v*2,65535,!0),x.setUint16(v*2,65535,!0);return e[6][0].data=Ss(g),e[3][0].data=Ss(y),d}function xw(e,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Mn(t["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Cr(n)));var o=mc(t,{range:n,header:1}),l=["~Sh33tJ5~"];o.forEach(function(O){return O.forEach(function(I){typeof I=="string"&&l.push(I)})});var c={},d=[],h=Zt.read(r.numbers,{type:"base64"});h.FileIndex.map(function(O,I){return[O,h.FullPaths[I]]}).forEach(function(O){var I=O[0],R=O[1];if(I.type==2&&I.name.match(/\.iwa/)){var X=I.content,fe=ca(X),he=la(fe);he.forEach(function(ee){d.push(ee.id),c[ee.id]={deps:[],location:R,type:Ii(ee.messages[0].meta[1][0].data)}})}}),d.sort(function(O,I){return O-I});var u=d.filter(function(O){return O>1}).map(function(O){return[O,Gt(O)]});h.FileIndex.map(function(O,I){return[O,h.FullPaths[I]]}).forEach(function(O){var I=O[0];if(O[1],!!I.name.match(/\.iwa/)){var R=la(ca(I.content));R.forEach(function(X){X.messages.forEach(function(fe){u.forEach(function(he){X.messages.some(function(ee){return Ii(ee.meta[1][0].data)!=11006&&hw(ee.data,he[1])})&&c[he[0]].deps.push(X.id)})})})}});for(var g=Zt.find(h,c[1].location),x=la(ca(g.content)),m,y=0;y<x.length;++y){var v=x[y];v.id==1&&(m=v)}var j=us(Ir(m.messages[0].data)[1][0].data);for(g=Zt.find(h,c[j].location),x=la(ca(g.content)),y=0;y<x.length;++y)v=x[y],v.id==j&&(m=v);for(j=us(Ir(m.messages[0].data)[2][0].data),g=Zt.find(h,c[j].location),x=la(ca(g.content)),y=0;y<x.length;++y)v=x[y],v.id==j&&(m=v);for(j=us(Ir(m.messages[0].data)[2][0].data),g=Zt.find(h,c[j].location),x=la(ca(g.content)),y=0;y<x.length;++y)v=x[y],v.id==j&&(m=v);var w=Ir(m.messages[0].data);{w[6][0].data=Gt(n.e.r+1),w[7][0].data=Gt(n.e.c+1);var N=us(w[46][0].data),_=Zt.find(h,c[N].location),C=la(ca(_.content));{for(var M=0;M<C.length&&C[M].id!=N;++M);if(C[M].id!=N)throw"Bad ColumnRowUIDMapArchive";var D=Ir(C[M].messages[0].data);D[1]=[],D[2]=[],D[3]=[];for(var L=0;L<=n.e.c;++L){var E=[];E[1]=E[2]=[{type:0,data:Gt(L+420690)}],D[1].push({type:2,data:Gr(E)}),D[2].push({type:0,data:Gt(L)}),D[3].push({type:0,data:Gt(L)})}D[4]=[],D[5]=[],D[6]=[];for(var P=0;P<=n.e.r;++P)E=[],E[1]=E[2]=[{type:0,data:Gt(P+726270)}],D[4].push({type:2,data:Gr(E)}),D[5].push({type:0,data:Gt(P)}),D[6].push({type:0,data:Gt(P)});C[M].messages[0].data=Gr(D)}_.content=_i(Si(C)),_.size=_.content.length,delete w[46];var H=Ir(w[4][0].data);{H[7][0].data=Gt(n.e.r+1);var k=Ir(H[1][0].data),T=us(k[2][0].data);_=Zt.find(h,c[T].location),C=la(ca(_.content));{if(C[0].id!=T)throw"Bad HeaderStorageBucket";var W=Ir(C[0].messages[0].data);for(P=0;P<o.length;++P){var G=Ir(W[2][0].data);G[1][0].data=Gt(P),G[4][0].data=Gt(o[P].length),W[2][P]={type:W[2][0].type,data:Gr(G)}}C[0].messages[0].data=Gr(W)}_.content=_i(Si(C)),_.size=_.content.length;var de=us(H[2][0].data);_=Zt.find(h,c[de].location),C=la(ca(_.content));{if(C[0].id!=de)throw"Bad HeaderStorageBucket";for(W=Ir(C[0].messages[0].data),L=0;L<=n.e.c;++L)G=Ir(W[2][0].data),G[1][0].data=Gt(L),G[4][0].data=Gt(n.e.r+1),W[2][L]={type:W[2][0].type,data:Gr(G)};C[0].messages[0].data=Gr(W)}_.content=_i(Si(C)),_.size=_.content.length;var J=us(H[4][0].data);(function(){for(var O=Zt.find(h,c[J].location),I=la(ca(O.content)),R,X=0;X<I.length;++X){var fe=I[X];fe.id==J&&(R=fe)}var he=Ir(R.messages[0].data);{he[3]=[];var ee=[];l.forEach(function(Ie,Ve){ee[1]=[{type:0,data:Gt(Ve)}],ee[2]=[{type:0,data:Gt(1)}],ee[3]=[{type:2,data:fw(Ie)}],he[3].push({type:2,data:Gr(ee)})})}R.messages[0].data=Gr(he);var ve=Si(I),Ce=_i(ve);O.content=Ce,O.size=O.content.length})();var Z=Ir(H[3][0].data);{var oe=Z[1][0];delete Z[2];var ae=Ir(oe.data);{var pe=us(ae[2][0].data);(function(){for(var O=Zt.find(h,c[pe].location),I=la(ca(O.content)),R,X=0;X<I.length;++X){var fe=I[X];fe.id==pe&&(R=fe)}var he=Ir(R.messages[0].data);{delete he[6],delete Z[7];var ee=new Uint8Array(he[5][0].data);he[5]=[];for(var ve=0,Ce=0;Ce<=n.e.r;++Ce){var Ie=Ir(ee);ve+=pw(Ie,o[Ce],l),Ie[1][0].data=Gt(Ce),he[5].push({data:Gr(Ie),type:2})}he[1]=[{type:0,data:Gt(n.e.c+1)}],he[2]=[{type:0,data:Gt(n.e.r+1)}],he[3]=[{type:0,data:Gt(ve)}],he[4]=[{type:0,data:Gt(n.e.r+1)}]}R.messages[0].data=Gr(he);var Ve=Si(I),$e=_i(Ve);O.content=$e,O.size=O.content.length})()}oe.data=Gr(ae)}H[3][0].data=Gr(Z)}w[4][0].data=Gr(H)}m.messages[0].data=Gr(w);var be=Si(x),A=_i(be);return g.content=A,g.size=g.content.length,h}function gw(e){return function(t){for(var n=0;n!=e.length;++n){var s=e[n];t[s[0]]===void 0&&(t[s[0]]=s[1]),s[2]==="n"&&(t[s[0]]=Number(t[s[0]]))}}}function jd(e){gw([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function vw(e,r){return r.bookType=="ods"?b1(e,r):r.bookType=="numbers"?xw(e,r):r.bookType=="xlsb"?yw(e,r):bw(e,r)}function yw(e,r){Fi=1024,e&&!e.SSF&&(e.SSF=Sn(xr)),e&&e.SSF&&(wc(),bc(e.SSF),r.revssf=Nc(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Lo?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t=r.bookType=="xlsb"?"bin":"xml",n=r1.indexOf(r.bookType)>-1,s=Fu();jd(r=r||{});var o=od(),l="",c=0;if(r.cellXfs=[],_s(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",Et(o,l,Iu(e.Props,r)),s.coreprops.push(l),$t(r.rels,2,l,Bt.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&d.push(e.SheetNames[h]);e.Props.SheetNames=d}for(e.Props.Worksheets=e.Props.SheetNames.length,Et(o,l,Ru(e.Props)),s.extprops.push(l),$t(r.rels,3,l,Bt.EXT_PROPS),e.Custprops!==e.Props&&Jr(e.Custprops||{}).length>0&&(l="docProps/custom.xml",Et(o,l,Mu(e.Custprops)),s.custprops.push(l),$t(r.rels,4,l,Bt.CUST_PROPS)),c=1;c<=e.SheetNames.length;++c){var u={"!id":{}},g=e.Sheets[e.SheetNames[c-1]],x=(g||{})["!type"]||"sheet";switch(x){case"chart":default:l="xl/worksheets/sheet"+c+"."+t,Et(o,l,N4(c-1,l,r,e,u)),s.sheets.push(l),$t(r.wbrels,-1,"worksheets/sheet"+c+"."+t,Bt.WS[0])}if(g){var m=g["!comments"],y=!1,v="";m&&m.length>0&&(v="xl/comments"+c+"."+t,Et(o,v,_4(m,v)),s.comments.push(v),$t(u,-1,"../comments"+c+"."+t,Bt.CMNT),y=!0),g["!legacy"]&&y&&Et(o,"xl/drawings/vmlDrawing"+c+".vml",e1(c,g["!comments"])),delete g["!comments"],delete g["!legacy"]}u["!id"].rId1&&Et(o,Pu(l),Pi(u))}return r.Strings!=null&&r.Strings.length>0&&(l="xl/sharedStrings."+t,Et(o,l,S4(r.Strings,l,r)),s.strs.push(l),$t(r.wbrels,-1,"sharedStrings."+t,Bt.SST)),l="xl/workbook."+t,Et(o,l,w4(e,l)),s.workbooks.push(l),$t(r.rels,1,l,Bt.WB),l="xl/theme/theme1.xml",Et(o,l,Zu(e.Themes,r)),s.themes.push(l),$t(r.wbrels,-1,"theme/theme1.xml",Bt.THEME),l="xl/styles."+t,Et(o,l,j4(e,l,r)),s.styles.push(l),$t(r.wbrels,-1,"styles."+t,Bt.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",Et(o,l,e.vbaraw),s.vba.push(l),$t(r.wbrels,-1,"vbaProject.bin",Bt.VBA)),l="xl/metadata."+t,Et(o,l,A4(l)),s.metadata.push(l),$t(r.wbrels,-1,"metadata."+t,Bt.XLMETA),Et(o,"[Content_Types].xml",Lu(s,r)),Et(o,"_rels/.rels",Pi(r.rels)),Et(o,"xl/_rels/workbook."+t+".rels",Pi(r.wbrels)),delete r.revssf,delete r.ssf,o}function bw(e,r){Fi=1024,e&&!e.SSF&&(e.SSF=Sn(xr)),e&&e.SSF&&(wc(),bc(e.SSF),r.revssf=Nc(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Lo?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t="xml",n=r1.indexOf(r.bookType)>-1,s=Fu();jd(r=r||{});var o=od(),l="",c=0;if(r.cellXfs=[],_s(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",Et(o,l,Iu(e.Props,r)),s.coreprops.push(l),$t(r.rels,2,l,Bt.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&d.push(e.SheetNames[h]);e.Props.SheetNames=d}e.Props.Worksheets=e.Props.SheetNames.length,Et(o,l,Ru(e.Props)),s.extprops.push(l),$t(r.rels,3,l,Bt.EXT_PROPS),e.Custprops!==e.Props&&Jr(e.Custprops||{}).length>0&&(l="docProps/custom.xml",Et(o,l,Mu(e.Custprops)),s.custprops.push(l),$t(r.rels,4,l,Bt.CUST_PROPS));var u=["SheetJ5"];for(r.tcid=0,c=1;c<=e.SheetNames.length;++c){var g={"!id":{}},x=e.Sheets[e.SheetNames[c-1]],m=(x||{})["!type"]||"sheet";switch(m){case"chart":default:l="xl/worksheets/sheet"+c+"."+t,Et(o,l,f1(c-1,r,e,g)),s.sheets.push(l),$t(r.wbrels,-1,"worksheets/sheet"+c+"."+t,Bt.WS[0])}if(x){var y=x["!comments"],v=!1,j="";if(y&&y.length>0){var w=!1;y.forEach(function(N){N[1].forEach(function(_){_.T==!0&&(w=!0)})}),w&&(j="xl/threadedComments/threadedComment"+c+"."+t,Et(o,j,Jv(y,u,r)),s.threadedcomments.push(j),$t(g,-1,"../threadedComments/threadedComment"+c+"."+t,Bt.TCMNT)),j="xl/comments"+c+"."+t,Et(o,j,t1(y)),s.comments.push(j),$t(g,-1,"../comments"+c+"."+t,Bt.CMNT),v=!0}x["!legacy"]&&v&&Et(o,"xl/drawings/vmlDrawing"+c+".vml",e1(c,x["!comments"])),delete x["!comments"],delete x["!legacy"]}g["!id"].rId1&&Et(o,Pu(l),Pi(g))}return r.Strings!=null&&r.Strings.length>0&&(l="xl/sharedStrings."+t,Et(o,l,Gu(r.Strings,r)),s.strs.push(l),$t(r.wbrels,-1,"sharedStrings."+t,Bt.SST)),l="xl/workbook."+t,Et(o,l,m1(e)),s.workbooks.push(l),$t(r.rels,1,l,Bt.WB),l="xl/theme/theme1.xml",Et(o,l,Zu(e.Themes,r)),s.themes.push(l),$t(r.wbrels,-1,"theme/theme1.xml",Bt.THEME),l="xl/styles."+t,Et(o,l,Ku(e,r)),s.styles.push(l),$t(r.wbrels,-1,"styles."+t,Bt.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",Et(o,l,e.vbaraw),s.vba.push(l),$t(r.wbrels,-1,"vbaProject.bin",Bt.VBA)),l="xl/metadata."+t,Et(o,l,Qu()),s.metadata.push(l),$t(r.wbrels,-1,"metadata."+t,Bt.XLMETA),u.length>1&&(l="xl/persons/person.xml",Et(o,l,Zv(u)),s.people.push(l),$t(r.wbrels,-1,"persons/person.xml",Bt.PEOPLE)),Et(o,"[Content_Types].xml",Lu(s,r)),Et(o,"_rels/.rels",Pi(r.rels)),Et(o,"xl/_rels/workbook."+t+".rels",Pi(r.wbrels)),delete r.revssf,delete r.ssf,o}function ww(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Ya(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function w1(e,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return zo(r.file,Zt.write(e,{type:Ht?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return Zt.write(e,r)}function Nw(e,r){var t=Sn(r||{}),n=vw(e,t);return jw(n,t)}function jw(e,r){var t={},n=Ht?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(r.compression&&(t.compression="DEFLATE"),r.password)t.type=n;else switch(r.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":t.type=n;break;default:throw new Error("Unrecognized type "+r.type)}var s=e.FullPaths?Zt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!r.compression}):e.generate(t);if(typeof Deno<"u"&&typeof s=="string"){if(r.type=="binary"||r.type=="base64")return s;s=new Uint8Array(yc(s))}return r.password&&typeof encrypt_agile<"u"?w1(encrypt_agile(s,r.password),r):r.type==="file"?zo(r.file,s):r.type=="string"?To(s):s}function Sw(e,r){var t=r||{},n=U4(e,t);return w1(n,t)}function Ta(e,r,t){t||(t="");var n=t+e;switch(r.type){case"base64":return Do(Mo(n));case"binary":return Mo(n);case"string":return e;case"file":return zo(r.file,n,"utf8");case"buffer":return Ht?Ka(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Ta(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function _w(e,r){switch(r.type){case"base64":return Do(e);case"binary":return e;case"string":return e;case"file":return zo(r.file,e,"binary");case"buffer":return Ht?Ka(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function Jl(e,r){switch(r.type){case"string":case"base64":case"binary":for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return r.type=="base64"?Do(t):r.type=="string"?To(t):t;case"file":return zo(r.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+r.type)}}function N1(e,r){Qx(),d4(e);var t=Sn(r||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var n=N1(e,t);return t.type="array",yc(n)}var s=0;if(t.sheet&&(typeof t.sheet=="number"?s=t.sheet:s=e.SheetNames.indexOf(t.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Ta(M4(e,t),t);case"slk":case"sylk":return Ta(ov.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"htm":case"html":return Ta(g1(e.Sheets[e.SheetNames[s]],t),t);case"txt":return _w(j1(e.Sheets[e.SheetNames[s]],t),t);case"csv":return Ta(Sd(e.Sheets[e.SheetNames[s]],t),t,"\uFEFF");case"dif":return Ta(lv.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"dbf":return Jl(iv.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"prn":return Ta(cv.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"rtf":return Ta(xv.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"eth":return Ta(Vu.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"fods":return Ta(b1(e,t),t);case"wk1":return Jl(dh.sheet_to_wk1(e.Sheets[e.SheetNames[s]],t),t);case"wk3":return Jl(dh.book_to_wk3(e,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Jl(x1(e,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),Sw(e,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Nw(e,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function Aw(e){if(!e.bookType){var r={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType=r[e.bookType]||e.bookType}}function kw(e,r,t){var n={};return n.type="file",n.file=r,Aw(n),N1(e,n)}function Tw(e,r,t,n,s,o,l,c){var d=Kr(t),h=c.defval,u=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),g=!0,x=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:t,enumerable:!1})}catch{x.__rowNum__=t}else x.__rowNum__=t;if(!l||e[t])for(var m=r.s.c;m<=r.e.c;++m){var y=l?e[t][m]:e[n[m]+d];if(y===void 0||y.t===void 0){if(h===void 0)continue;o[m]!=null&&(x[o[m]]=h);continue}var v=y.v;switch(y.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(o[m]!=null){if(v==null)if(y.t=="e"&&v===null)x[o[m]]=null;else if(h!==void 0)x[o[m]]=h;else if(u&&v===null)x[o[m]]=null;else continue;else x[o[m]]=u&&(y.t!=="n"||y.t==="n"&&c.rawNumbers!==!1)?v:Xa(y,v,c);v!=null&&(g=!1)}}return{row:x,isempty:g}}function mc(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},n=0,s=1,o=[],l=0,c="",d={s:{r:0,c:0},e:{r:0,c:0}},h=r||{},u=h.range!=null?h.range:e["!ref"];switch(h.header===1?n=1:h.header==="A"?n=2:Array.isArray(h.header)?n=3:h.header==null&&(n=0),typeof u){case"string":d=lr(u);break;case"number":d=lr(e["!ref"]),d.s.r=u;break;default:d=u}n>0&&(s=0);var g=Kr(d.s.r),x=[],m=[],y=0,v=0,j=Array.isArray(e),w=d.s.r,N=0,_={};j&&!e[w]&&(e[w]=[]);var C=h.skipHidden&&e["!cols"]||[],M=h.skipHidden&&e["!rows"]||[];for(N=d.s.c;N<=d.e.c;++N)if(!(C[N]||{}).hidden)switch(x[N]=on(N),t=j?e[w][N]:e[x[N]+g],n){case 1:o[N]=N-d.s.c;break;case 2:o[N]=x[N];break;case 3:o[N]=h.header[N-d.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),c=l=Xa(t,null,h),v=_[l]||0,!v)_[l]=1;else{do c=l+"_"+v++;while(_[c]);_[l]=v,_[c]=1}o[N]=c}for(w=d.s.r+s;w<=d.e.r;++w)if(!(M[w]||{}).hidden){var D=Tw(e,d,w,x,n,o,j,h);(D.isempty===!1||(n===1?h.blankrows!==!1:h.blankrows))&&(m[y++]=D.row)}return m.length=y,m}var vh=/"/g;function Cw(e,r,t,n,s,o,l,c){for(var d=!0,h=[],u="",g=Kr(t),x=r.s.c;x<=r.e.c;++x)if(n[x]){var m=c.dense?(e[t]||[])[x]:e[n[x]+g];if(m==null)u="";else if(m.v!=null){d=!1,u=""+(c.rawNumbers&&m.t=="n"?m.v:Xa(m,null,c));for(var y=0,v=0;y!==u.length;++y)if((v=u.charCodeAt(y))===s||v===o||v===34||c.forceQuotes){u='"'+u.replace(vh,'""')+'"';break}u=="ID"&&(u='"ID"')}else m.f!=null&&!m.F?(d=!1,u="="+m.f,u.indexOf(",")>=0&&(u='"'+u.replace(vh,'""')+'"')):u="";h.push(u)}return c.blankrows===!1&&d?null:h.join(l)}function Sd(e,r){var t=[],n=r??{};if(e==null||e["!ref"]==null)return"";var s=lr(e["!ref"]),o=n.FS!==void 0?n.FS:",",l=o.charCodeAt(0),c=n.RS!==void 0?n.RS:`
`,d=c.charCodeAt(0),h=new RegExp((o=="|"?"\\|":o)+"+$"),u="",g=[];n.dense=Array.isArray(e);for(var x=n.skipHidden&&e["!cols"]||[],m=n.skipHidden&&e["!rows"]||[],y=s.s.c;y<=s.e.c;++y)(x[y]||{}).hidden||(g[y]=on(y));for(var v=0,j=s.s.r;j<=s.e.r;++j)(m[j]||{}).hidden||(u=Cw(e,s,j,g,l,d,o,n),u!=null&&(n.strip&&(u=u.replace(h,"")),(u||n.blankrows!==!1)&&t.push((v++?c:"")+u)));return delete n.dense,t.join("")}function j1(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=Sd(e,r);return t}function Ew(e){var r="",t,n="";if(e==null||e["!ref"]==null)return[];var s=lr(e["!ref"]),o="",l=[],c,d=[],h=Array.isArray(e);for(c=s.s.c;c<=s.e.c;++c)l[c]=on(c);for(var u=s.s.r;u<=s.e.r;++u)for(o=Kr(u),c=s.s.c;c<=s.e.c;++c)if(r=l[c]+o,t=h?(e[u]||[])[c]:e[r],n="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;n=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}d[d.length]=r+"="+n}return d}function S1(e,r,t){var n=t||{},s=+!n.skipHeader,o=e||{},l=0,c=0;if(o&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var d=typeof n.origin=="string"?Hr(n.origin):n.origin;l=d.r,c=d.c}var h,u={s:{c:0,r:0},e:{c,r:l+r.length-1+s}};if(o["!ref"]){var g=lr(o["!ref"]);u.e.c=Math.max(u.e.c,g.e.c),u.e.r=Math.max(u.e.r,g.e.r),l==-1&&(l=g.e.r+1,u.e.r=l+r.length-1+s)}else l==-1&&(l=0,u.e.r=r.length-1+s);var x=n.header||[],m=0;r.forEach(function(v,j){Jr(v).forEach(function(w){(m=x.indexOf(w))==-1&&(x[m=x.length]=w);var N=v[w],_="z",C="",M=Xt({c:c+m,r:l+j+s});h=Ho(o,M),N&&typeof N=="object"&&!(N instanceof Date)?o[M]=N:(typeof N=="number"?_="n":typeof N=="boolean"?_="b":typeof N=="string"?_="s":N instanceof Date?(_="d",n.cellDates||(_="n",N=jn(N)),C=n.dateNF||xr[14]):N===null&&n.nullError&&(_="e",N=0),h?(h.t=_,h.v=N,delete h.w,delete h.R,C&&(h.z=C)):o[M]=h={t:_,v:N},C&&(h.z=C))})}),u.e.c=Math.max(u.e.c,c+x.length-1);var y=Kr(l);if(s)for(m=0;m<x.length;++m)o[on(m+c)+y]={t:"s",v:x[m]};return o["!ref"]=Cr(u),o}function Fw(e,r){return S1(null,e,r)}function Ho(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var n=Hr(r);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?Ho(e,Xt(r)):Ho(e,Xt({r,c:t||0}))}function Lw(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function Pw(){return{SheetNames:[],Sheets:{}}}function Ow(e,r,t,n){var s=1;if(!t)for(;s<=65535&&e.SheetNames.indexOf(t="Sheet"+s)!=-1;++s,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(t)>=0){var o=t.match(/(^.*?)(\d+)$/);s=o&&+o[2]||0;var l=o&&o[1]||t;for(++s;s<=65535&&e.SheetNames.indexOf(t=l+s)!=-1;++s);}if(u1(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function Iw(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=Lw(e,r);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[n].Hidden=t}function Dw(e,r){return e.z=r,e}function _1(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function Rw(e,r,t){return _1(e,"#"+r,t)}function Mw(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function Bw(e,r,t,n){for(var s=typeof r!="string"?r:lr(r),o=typeof r=="string"?r:Cr(r),l=s.s.r;l<=s.e.r;++l)for(var c=s.s.c;c<=s.e.c;++c){var d=Ho(e,l,c);d.t="n",d.F=o,delete d.v,l==s.s.r&&c==s.s.c&&(d.f=t,n&&(d.D=!0))}return e}var Or={encode_col:on,encode_row:Kr,encode_cell:Xt,encode_range:Cr,decode_col:ud,decode_row:hd,split_cell:Q2,decode_cell:Hr,decode_range:Mn,format_cell:Xa,sheet_add_aoa:_u,sheet_add_json:S1,sheet_add_dom:v1,aoa_to_sheet:Bi,json_to_sheet:Fw,table_to_sheet:y1,table_to_book:lw,sheet_to_csv:Sd,sheet_to_txt:j1,sheet_to_json:mc,sheet_to_html:g1,sheet_to_formulae:Ew,sheet_to_row_object_array:mc,sheet_get_cell:Ho,book_new:Pw,book_append_sheet:Ow,book_set_sheet_visibility:Iw,cell_set_number_format:Dw,cell_set_hyperlink:_1,cell_set_internal_link:Rw,cell_add_comment:Mw,sheet_set_array_formula:Bw,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const P0=[{id:"sales",name:"Sales Report",description:"Revenue, orders, and sales performance",icon:"ðŸ“Š",color:"afri-green"},{id:"inventory",name:"Inventory Report",description:"Stock levels, low stock items, and product performance",icon:"ðŸ“¦",color:"blue-600"},{id:"orders",name:"Order Report",description:"Order history, status breakdown, and delivery metrics",icon:"ðŸ“‹",color:"purple-600"},{id:"revenue",name:"Revenue Report",description:"Earnings breakdown, payment status, and financial summary",icon:"ðŸ’°",color:"afri-yellow-dark"}],Uw=[{label:"Today",value:"today"},{label:"Yesterday",value:"yesterday"},{label:"Last 7 Days",value:"week"},{label:"Last 30 Days",value:"month"},{label:"This Month",value:"thisMonth"},{label:"Last Month",value:"lastMonth"},{label:"Custom Range",value:"custom"}];function Hw(){const[e,r]=ue.useState(null),[t,n]=ue.useState("week"),[s,o]=ue.useState(""),[l,c]=ue.useState(""),[d,h]=ue.useState(!1),[u,g]=ue.useState(null),[x,m]=ue.useState(!1),y=async()=>{if(!e){alert("Please select a report type");return}h(!0);try{const{startDate:N,endDate:_}=v();let C;switch(e){case"sales":C=await pr.getSalesReport({startDate:N,endDate:_});break;case"inventory":C=await pr.getInventoryReport();break;case"orders":C=await pr.getOrdersReport({startDate:N,endDate:_});break;case"revenue":C=await pr.getRevenueReport({startDate:N,endDate:_});break;default:throw new Error("Invalid report type")}C.success&&(g(C.data),m(!0))}catch(N){console.error("Error generating report:",N),alert(N.message||"Failed to generate report")}finally{h(!1)}},v=()=>{const N=new Date;let _,C;switch(t){case"today":_=new Date(N.setHours(0,0,0,0)),C=new Date(N.setHours(23,59,59,999));break;case"yesterday":_=new Date(N.setDate(N.getDate()-1)),_.setHours(0,0,0,0),C=new Date(_),C.setHours(23,59,59,999);break;case"week":_=new Date(N.setDate(N.getDate()-7)),C=new Date;break;case"month":_=new Date(N.setDate(N.getDate()-30)),C=new Date;break;case"thisMonth":_=new Date(N.getFullYear(),N.getMonth(),1),C=new Date;break;case"lastMonth":_=new Date(N.getFullYear(),N.getMonth()-1,1),C=new Date(N.getFullYear(),N.getMonth(),0);break;case"custom":_=new Date(s),C=new Date(l);break;default:_=new Date(N.setDate(N.getDate()-7)),C=new Date}return{startDate:_.toISOString(),endDate:C.toISOString()}},j=()=>{var E,P,H,k,T,W;if(!u)return;const N=new xt,_=P0.find(G=>G.id===e);N.setFontSize(20),N.setTextColor(0,178,7),N.text(_.name,14,20),N.setFontSize(10),N.setTextColor(100);const{startDate:C,endDate:M}=v();N.text(`Generated: ${new Date().toLocaleDateString()} | Period: ${new Date(C).toLocaleDateString()} - ${new Date(M).toLocaleDateString()}`,14,28);let D=40;if(e==="sales"){N.setFontSize(14),N.setTextColor(0),N.text("Summary",14,D),D+=10;const G=[["Total Revenue",`Â£${((E=u.totalRevenue)==null?void 0:E.toFixed(2))||"0.00"}`],["Total Orders",u.totalOrders||0],["Average Order Value",`Â£${((P=u.avgOrderValue)==null?void 0:P.toFixed(2))||"0.00"}`],["Total Items Sold",u.totalItemsSold||0]];if(N.autoTable({startY:D,head:[["Metric","Value"]],body:G,theme:"grid",headStyles:{fillColor:[0,178,7]}}),u.topProducts&&u.topProducts.length>0){D=N.lastAutoTable.finalY+15,N.setFontSize(14),N.text("Top Products",14,D),D+=5;const de=u.topProducts.map((J,Z)=>{var oe;return[Z+1,J.name,J.soldQuantity,`Â£${((oe=J.revenue)==null?void 0:oe.toFixed(2))||"0.00"}`]});N.autoTable({startY:D+5,head:[["#","Product","Qty Sold","Revenue"]],body:de,theme:"striped",headStyles:{fillColor:[0,178,7]}})}}else if(e==="inventory"){N.setFontSize(14),N.text("Stock Overview",14,D),D+=10;const G=[["Total Products",u.totalProducts||0],["In Stock",u.inStock||0],["Out of Stock",u.outOfStock||0],["Low Stock",u.lowStock||0]];if(N.autoTable({startY:D,head:[["Category","Count"]],body:G,theme:"grid",headStyles:{fillColor:[0,178,7]}}),u.lowStockItems&&u.lowStockItems.length>0){D=N.lastAutoTable.finalY+15,N.setFontSize(14),N.text("Low Stock Items",14,D),D+=5;const de=u.lowStockItems.map(J=>[J.name,J.currentStock,J.lowStockThreshold,J.status]);N.autoTable({startY:D+5,head:[["Product","Current Stock","Threshold","Status"]],body:de,theme:"striped",headStyles:{fillColor:[255,138,0]}})}}else if(e==="orders"){N.setFontSize(14),N.text("Orders Summary",14,D),D+=10;const G=[["Total Orders",u.totalOrders||0],["Completed",u.completed||0],["Pending",u.pending||0],["Cancelled",u.cancelled||0]];if(N.autoTable({startY:D,head:[["Status","Count"]],body:G,theme:"grid",headStyles:{fillColor:[0,178,7]}}),u.orders&&u.orders.length>0){D=N.lastAutoTable.finalY+15,N.setFontSize(14),N.text("Order Details",14,D),D+=5;const de=u.orders.map(J=>{var Z;return[J.orderNumber,new Date(J.createdAt).toLocaleDateString(),J.status,`Â£${((Z=J.total)==null?void 0:Z.toFixed(2))||"0.00"}`]});N.autoTable({startY:D+5,head:[["Order #","Date","Status","Total"]],body:de,theme:"striped",headStyles:{fillColor:[0,178,7]}})}}else if(e==="revenue"){N.setFontSize(14),N.text("Revenue Summary",14,D),D+=10;const G=[["Total Revenue",`Â£${((H=u.totalRevenue)==null?void 0:H.toFixed(2))||"0.00"}`],["Paid",`Â£${((k=u.paidRevenue)==null?void 0:k.toFixed(2))||"0.00"}`],["Pending",`Â£${((T=u.pendingRevenue)==null?void 0:T.toFixed(2))||"0.00"}`],["Refunded",`Â£${((W=u.refundedRevenue)==null?void 0:W.toFixed(2))||"0.00"}`]];if(N.autoTable({startY:D,head:[["Category","Amount"]],body:G,theme:"grid",headStyles:{fillColor:[0,178,7]}}),u.dailyRevenue&&u.dailyRevenue.length>0){D=N.lastAutoTable.finalY+15,N.setFontSize(14),N.text("Daily Revenue Breakdown",14,D),D+=5;const de=u.dailyRevenue.map(J=>{var Z;return[new Date(J.date).toLocaleDateString(),J.orders,`Â£${((Z=J.revenue)==null?void 0:Z.toFixed(2))||"0.00"}`]});N.autoTable({startY:D+5,head:[["Date","Orders","Revenue"]],body:de,theme:"striped",headStyles:{fillColor:[0,178,7]}})}}const L=N.internal.getNumberOfPages();for(let G=1;G<=L;G++)N.setPage(G),N.setFontSize(8),N.setTextColor(150),N.text(`Afrimercato - ${_.name} | Page ${G} of ${L}`,14,N.internal.pageSize.height-10);N.save(`${e}-report-${new Date().toISOString().split("T")[0]}.pdf`)},w=()=>{var C,M,D,L,E,P;if(!u)return;const N=P0.find(H=>H.id===e),_=Or.book_new();if(e==="sales"){const H=[["Metric","Value"],["Total Revenue",((C=u.totalRevenue)==null?void 0:C.toFixed(2))||"0.00"],["Total Orders",u.totalOrders||0],["Average Order Value",((M=u.avgOrderValue)==null?void 0:M.toFixed(2))||"0.00"],["Total Items Sold",u.totalItemsSold||0]],k=Or.aoa_to_sheet(H);if(Or.book_append_sheet(_,k,"Summary"),u.topProducts&&u.topProducts.length>0){const T=[["Rank","Product","Quantity Sold","Revenue"],...u.topProducts.map((G,de)=>{var J;return[de+1,G.name,G.soldQuantity,((J=G.revenue)==null?void 0:J.toFixed(2))||"0.00"]})],W=Or.aoa_to_sheet(T);Or.book_append_sheet(_,W,"Top Products")}}else if(e==="inventory"){const H=[["Category","Count"],["Total Products",u.totalProducts||0],["In Stock",u.inStock||0],["Out of Stock",u.outOfStock||0],["Low Stock",u.lowStock||0]],k=Or.aoa_to_sheet(H);if(Or.book_append_sheet(_,k,"Overview"),u.lowStockItems&&u.lowStockItems.length>0){const T=[["Product","Current Stock","Threshold","Status"],...u.lowStockItems.map(G=>[G.name,G.currentStock,G.lowStockThreshold,G.status])],W=Or.aoa_to_sheet(T);Or.book_append_sheet(_,W,"Low Stock Items")}if(u.allProducts&&u.allProducts.length>0){const T=[["Name","Category","Stock","Price","Status"],...u.allProducts.map(G=>[G.name,G.category,G.stock,G.price,G.inStock?"In Stock":"Out of Stock"])],W=Or.aoa_to_sheet(T);Or.book_append_sheet(_,W,"All Products")}}else if(e==="orders"){const H=[["Status","Count"],["Total Orders",u.totalOrders||0],["Completed",u.completed||0],["Pending",u.pending||0],["Cancelled",u.cancelled||0]],k=Or.aoa_to_sheet(H);if(Or.book_append_sheet(_,k,"Summary"),u.orders&&u.orders.length>0){const T=[["Order Number","Date","Customer","Status","Items","Total"],...u.orders.map(G=>{var de;return[G.orderNumber,new Date(G.createdAt).toLocaleDateString(),G.customerName||"N/A",G.status,G.itemsCount||0,((de=G.total)==null?void 0:de.toFixed(2))||"0.00"]})],W=Or.aoa_to_sheet(T);Or.book_append_sheet(_,W,"Orders")}}else if(e==="revenue"){const H=[["Category","Amount (Â£)"],["Total Revenue",((D=u.totalRevenue)==null?void 0:D.toFixed(2))||"0.00"],["Paid",((L=u.paidRevenue)==null?void 0:L.toFixed(2))||"0.00"],["Pending",((E=u.pendingRevenue)==null?void 0:E.toFixed(2))||"0.00"],["Refunded",((P=u.refundedRevenue)==null?void 0:P.toFixed(2))||"0.00"]],k=Or.aoa_to_sheet(H);if(Or.book_append_sheet(_,k,"Summary"),u.dailyRevenue&&u.dailyRevenue.length>0){const T=[["Date","Orders","Revenue (Â£)"],...u.dailyRevenue.map(G=>{var de;return[new Date(G.date).toLocaleDateString(),G.orders,((de=G.revenue)==null?void 0:de.toFixed(2))||"0.00"]})],W=Or.aoa_to_sheet(T);Or.book_append_sheet(_,W,"Daily Revenue")}}kw(_,`${N.name.replace(" ","-")}-${new Date().toISOString().split("T")[0]}.xlsx`)};return a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"mb-8",children:[a.jsx("h1",{className:"text-3xl font-bold text-afri-gray-900",children:"Reports"}),a.jsx("p",{className:"text-afri-gray-600 mt-1",children:"Generate and export business reports"})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsx("div",{className:"lg:col-span-1",children:a.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[a.jsx("h2",{className:"text-lg font-semibold text-afri-gray-900 mb-4",children:"Select Report Type"}),a.jsx("div",{className:"space-y-3",children:P0.map(N=>a.jsx("button",{onClick:()=>r(N.id),className:`w-full text-left p-4 rounded-lg border-2 transition ${e===N.id?`border-${N.color} bg-${N.color} bg-opacity-10`:"border-gray-200 hover:border-gray-300"}`,children:a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"text-2xl mr-3",children:N.icon}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-semibold text-afri-gray-900",children:N.name}),a.jsx("p",{className:"text-sm text-afri-gray-600 mt-1",children:N.description})]})]})},N.id))})]})}),a.jsx("div",{className:"lg:col-span-2",children:a.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[a.jsx("h2",{className:"text-lg font-semibold text-afri-gray-900 mb-4",children:"Report Configuration"}),e?a.jsxs("div",{className:"space-y-6",children:[e!=="inventory"&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-afri-gray-700 mb-2",children:"Date Range"}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:Uw.map(N=>a.jsx("button",{onClick:()=>n(N.value),className:`px-4 py-2 rounded-lg font-medium transition ${t===N.value?"bg-afri-green text-white":"bg-afri-gray-50 text-afri-gray-700 hover:bg-afri-gray-100"}`,children:N.label},N.value))}),t==="custom"&&a.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-afri-gray-700 mb-1",children:"Start Date"}),a.jsx("input",{type:"date",value:s,onChange:N=>o(N.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-afri-gray-700 mb-1",children:"End Date"}),a.jsx("input",{type:"date",value:l,onChange:N=>c(N.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent"})]})]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:y,disabled:d,className:"flex-1 bg-afri-green text-white px-6 py-3 rounded-lg font-semibold hover:bg-afri-green-dark transition disabled:opacity-50 disabled:cursor-not-allowed",children:d?a.jsxs("span",{className:"flex items-center justify-center",children:[a.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generating..."]}):"Generate Report"}),u&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:j,className:"bg-red-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-red-700 transition",children:"Export PDF"}),a.jsx("button",{onClick:w,className:"bg-green-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-green-700 transition",children:"Export Excel"})]})]}),x&&u&&a.jsxs("div",{className:"mt-6 border-t pt-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-afri-gray-900 mb-4",children:"Report Preview"}),a.jsx("div",{className:"bg-afri-gray-50 rounded-lg p-6",children:a.jsx("pre",{className:"text-sm text-afri-gray-700 whitespace-pre-wrap",children:JSON.stringify(u,null,2)})})]})]}):a.jsxs("div",{className:"text-center py-12",children:[a.jsx("svg",{className:"w-16 h-16 text-afri-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),a.jsx("p",{className:"text-afri-gray-600",children:"Select a report type to get started"})]})]})})]})]})}function Ww({message:e,type:r="success",duration:t=3e3,onClose:n}){const[s,o]=ue.useState(!0);ue.useEffect(()=>{const d=setTimeout(()=>{o(!1),setTimeout(n,300)},t);return()=>clearTimeout(d)},[t,n]);const l=()=>{switch(r){case"success":return a.jsx("svg",{className:"w-6 h-6 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});case"error":return a.jsx("svg",{className:"w-6 h-6 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})});case"warning":return a.jsx("svg",{className:"w-6 h-6 text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});case"info":return a.jsx("svg",{className:"w-6 h-6 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});default:return null}},c=()=>{switch(r){case"success":return"bg-green-50 border-green-500";case"error":return"bg-red-50 border-red-500";case"warning":return"bg-yellow-50 border-yellow-500";case"info":return"bg-blue-50 border-blue-500";default:return"bg-gray-50 border-gray-500"}};return a.jsx("div",{className:`fixed top-4 right-4 z-50 max-w-md w-full transform transition-all duration-300 ${s?"translate-x-0 opacity-100":"translate-x-full opacity-0"}`,children:a.jsxs("div",{className:`${c()} border-l-4 rounded-lg shadow-lg p-4 flex items-start`,children:[a.jsx("div",{className:"flex-shrink-0",children:l()}),a.jsx("div",{className:"ml-3 flex-1",children:a.jsx("p",{className:"text-sm font-medium text-gray-900",children:e})}),a.jsx("button",{onClick:()=>{o(!1),setTimeout(n,300)},className:"ml-4 flex-shrink-0 text-gray-400 hover:text-gray-500 transition-colors",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})}const zw=()=>{const[e,r]=ue.useState([]),t=ue.useCallback((s,o="success",l=3e3)=>{const c=Date.now(),d={id:c,message:s,type:o,duration:l};r(h=>[...h,d]),setTimeout(()=>{n(c)},l+300)},[]),n=ue.useCallback(s=>{r(o=>o.filter(l=>l.id!==s))},[]);return{toasts:e,showToast:t,removeToast:n,success:(s,o)=>t(s,"success",o),error:(s,o)=>t(s,"error",o),warning:(s,o)=>t(s,"warning",o),info:(s,o)=>t(s,"info",o)}},qw=["fresh-produce","groceries","meat-fish","bakery","beverages","household","beauty-health","other"],Vw=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],Gw=[{code:"GB",name:"United Kingdom",region:"Europe"},{code:"US",name:"United States",region:"North America"},{code:"CA",name:"Canada",region:"North America"},{code:"DE",name:"Germany",region:"Europe"},{code:"FR",name:"France",region:"Europe"},{code:"ES",name:"Spain",region:"Europe"},{code:"IT",name:"Italy",region:"Europe"},{code:"NL",name:"Netherlands",region:"Europe"},{code:"BE",name:"Belgium",region:"Europe"},{code:"IE",name:"Ireland",region:"Europe"}];function $w(){var Z,oe,ae,pe,be,A,O,I,R,X,fe,he;const{toasts:e,success:r,error:t,warning:n,removeToast:s}=zw(),[o,l]=ue.useState("profile"),[c,d]=ue.useState(!0),[h,u]=ue.useState(!1),[g,x]=ue.useState(!1),[m,y]=ue.useState([]),[v,j]=ue.useState(!1),[w,N]=ue.useState({storeName:"",description:"",category:"fresh-produce",phone:"",alternativePhone:"",address:{street:"",city:"",state:"",country:"United Kingdom",postalCode:""},businessHours:{monday:{open:"09:00",close:"18:00",isOpen:!0},tuesday:{open:"09:00",close:"18:00",isOpen:!0},wednesday:{open:"09:00",close:"18:00",isOpen:!0},thursday:{open:"09:00",close:"18:00",isOpen:!0},friday:{open:"09:00",close:"18:00",isOpen:!0},saturday:{open:"09:00",close:"18:00",isOpen:!0},sunday:{open:"09:00",close:"18:00",isOpen:!1}}}),[_,C]=ue.useState({name:"",email:"",phone:""}),[M,D]=ue.useState({currentPassword:"",newPassword:"",confirmPassword:""});ue.useEffect(()=>{L()},[]);const L=async()=>{try{d(!0);const[ee,ve]=await Promise.all([pr.getProfile(),u0.getProfile()]);ee.success&&N(ee.data.vendor),ve.success&&C(ve.data.user)}catch(ee){console.error("Error fetching settings:",ee)}finally{d(!1)}},E=(ee,ve)=>{if(ee.startsWith("address.")){const Ce=ee.split(".")[1];N(Ie=>({...Ie,address:{...Ie.address,[Ce]:ve}}))}else N(Ce=>({...Ce,[ee]:ve}))},P=(ee,ve,Ce)=>{N(Ie=>({...Ie,businessHours:{...Ie.businessHours,[ee]:{...Ie.businessHours[ee],[ve]:Ce}}}))},H=(ee,ve)=>{C(Ce=>({...Ce,[ee]:ve}))},k=(ee,ve)=>{D(Ce=>({...Ce,[ee]:ve}))},T=async()=>{var ve,Ce;const ee=(Ce=(ve=w.address)==null?void 0:ve.postalCode)==null?void 0:Ce.trim();if(!ee){n("Please enter a postcode first");return}try{x(!0);const Ve=await(await fetch(`https://api.postcodes.io/postcodes/${encodeURIComponent(ee)}`)).json();if(Ve.status===200&&Ve.result){const $e=Ve.result;N(Ee=>({...Ee,address:{...Ee.address,city:$e.admin_district||$e.postcode_area||"",state:$e.admin_county||$e.region||""}})),r("Address details filled! Please enter your street address.")}else n("Postcode not found. Please check and try again.")}catch(Ie){console.error("Postcode lookup error:",Ie),t("Failed to lookup postcode. You can still enter address manually.")}finally{x(!1)}},W=async()=>{var ee,ve;try{u(!0),(await pr.updateProfile(w)).success&&r("Vendor profile updated successfully!")}catch(Ce){t(((ve=(ee=Ce.response)==null?void 0:ee.data)==null?void 0:ve.message)||"Failed to update vendor profile")}finally{u(!1)}},G=async()=>{var ee,ve;try{u(!0),(await u0.updateProfile(_)).success&&r("Account updated successfully!")}catch(Ce){t(((ve=(ee=Ce.response)==null?void 0:ee.data)==null?void 0:ve.message)||"Failed to update account")}finally{u(!1)}},de=async()=>{var ee,ve;if(M.newPassword!==M.confirmPassword){n("Passwords do not match!");return}if(M.newPassword.length<6){n("Password must be at least 6 characters!");return}try{u(!0),(await u0.changePassword({currentPassword:M.currentPassword,newPassword:M.newPassword})).success&&(r("Password changed successfully!"),D({currentPassword:"",newPassword:"",confirmPassword:""}))}catch(Ce){t(((ve=(ee=Ce.response)==null?void 0:ee.data)==null?void 0:ve.message)||"Failed to change password")}finally{u(!1)}},J=[{id:"profile",name:"Store Profile",icon:"ðŸª"},{id:"account",name:"Account",icon:"ðŸ‘¤"},{id:"hours",name:"Business Hours",icon:"ðŸ•"},{id:"security",name:"Security",icon:"ðŸ”’"}];return c?a.jsx("div",{className:"flex justify-center items-center h-screen",children:a.jsx("div",{className:"relative",children:a.jsx("div",{className:"w-20 h-20 border-4 border-afri-green border-t-transparent rounded-full animate-spin"})})}):a.jsxs("div",{className:"space-y-6",children:[e.map(ee=>a.jsx(Ww,{message:ee.message,type:ee.type,duration:ee.duration,onClose:()=>s(ee.id)},ee.id)),a.jsxs("div",{children:[a.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-afri-green to-afri-green-dark bg-clip-text text-transparent",children:"Settings"}),a.jsx("p",{className:"text-afri-gray-600 mt-2",children:"Manage your store and account settings"})]}),a.jsx("div",{className:"border-b border-gray-200",children:a.jsx("nav",{className:"-mb-px flex space-x-8",children:J.map(ee=>a.jsxs("button",{onClick:()=>l(ee.id),className:`py-4 px-1 border-b-2 font-medium text-sm transition-all duration-200 flex items-center space-x-2 ${o===ee.id?"border-afri-green text-afri-green":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx("span",{className:"text-xl",children:ee.icon}),a.jsx("span",{children:ee.name})]},ee.id))})}),o==="profile"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 space-y-6 animate-fadeIn",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-afri-gray-900 mb-4",children:"Store Information"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Store Name"}),a.jsx("input",{type:"text",value:w.storeName,onChange:ee=>E("storeName",ee.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Category"}),a.jsx("select",{value:w.category,onChange:ee=>E("category",ee.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all",children:qw.map(ee=>a.jsx("option",{value:ee,children:ee.split("-").map(ve=>ve.charAt(0).toUpperCase()+ve.slice(1)).join(" ")},ee))})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Description"}),a.jsx("textarea",{value:w.description,onChange:ee=>E("description",ee.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Primary Phone"}),a.jsx("input",{type:"tel",value:w.phone,onChange:ee=>E("phone",ee.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Alternative Phone"}),a.jsx("input",{type:"tel",value:w.alternativePhone||"",onChange:ee=>E("alternativePhone",ee.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all"})]})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-afri-gray-900 mb-4",children:"Address"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Street Address"}),a.jsx("input",{type:"text",value:((Z=w.address)==null?void 0:Z.street)||"",onChange:ee=>E("address.street",ee.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"City"}),a.jsx("input",{type:"text",value:((oe=w.address)==null?void 0:oe.city)||"",onChange:ee=>E("address.city",ee.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:((ae=w.address)==null?void 0:ae.country)==="United Kingdom"?"County":"State/County"}),a.jsx("input",{type:"text",value:((pe=w.address)==null?void 0:pe.state)||"",onChange:ee=>E("address.state",ee.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all",placeholder:((be=w.address)==null?void 0:be.country)==="United Kingdom"?"e.g., Greater London":"State or County"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:((A=w.address)==null?void 0:A.country)==="United Kingdom"?"Postcode":"Postal/Zip Code"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"text",value:((O=w.address)==null?void 0:O.postalCode)||"",onChange:ee=>E("address.postalCode",ee.target.value.toUpperCase()),className:"flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all",placeholder:((I=w.address)==null?void 0:I.country)==="United Kingdom"?"e.g., SW1A 1AA":"Postal Code"}),((R=w.address)==null?void 0:R.country)==="United Kingdom"&&a.jsx("button",{type:"button",onClick:T,disabled:g||!((X=w.address)!=null&&X.postalCode),className:"px-4 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center whitespace-nowrap",children:g?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Looking up..."]}):a.jsxs(a.Fragment,{children:[a.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Find Address"]})})]}),((fe=w.address)==null?void 0:fe.country)==="United Kingdom"&&a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:'Enter your postcode and click "Find Address" to auto-fill city and county'})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Country"}),a.jsx("select",{value:((he=w.address)==null?void 0:he.country)||"United Kingdom",onChange:ee=>E("address.country",ee.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all",children:Gw.map(ee=>a.jsx("option",{value:ee.name,children:ee.name},ee.code))})]})]})]}),a.jsx("div",{className:"flex justify-end pt-6 border-t",children:a.jsx("button",{onClick:W,disabled:h,className:"px-8 py-3 bg-gradient-to-r from-afri-green to-afri-green-dark text-white rounded-lg font-semibold shadow-lg hover:shadow-xl transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center",children:h?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save Changes"})})]}),o==="account"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 space-y-6 animate-fadeIn",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-afri-gray-900 mb-4",children:"Account Information"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Full Name"}),a.jsx("input",{type:"text",value:_.name,onChange:ee=>H("name",ee.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Email Address"}),a.jsx("input",{type:"email",value:_.email,onChange:ee=>H("email",ee.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Phone Number"}),a.jsx("input",{type:"tel",value:_.phone||"",onChange:ee=>H("phone",ee.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all"})]})]})]}),a.jsx("div",{className:"flex justify-end pt-6 border-t",children:a.jsx("button",{onClick:G,disabled:h,className:"px-8 py-3 bg-gradient-to-r from-afri-green to-afri-green-dark text-white rounded-lg font-semibold shadow-lg hover:shadow-xl transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center",children:h?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save Changes"})})]}),o==="hours"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 space-y-6 animate-fadeIn",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-afri-gray-900 mb-4",children:"Business Hours"}),a.jsx("div",{className:"space-y-4",children:Vw.map(ee=>{var ve,Ce,Ie,Ve,$e,Ee,le,Be;return a.jsxs("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[a.jsx("div",{className:"w-32",children:a.jsx("span",{className:"font-semibold text-afri-gray-900 capitalize",children:ee})}),a.jsxs("label",{className:"flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:(Ce=(ve=w.businessHours)==null?void 0:ve[ee])==null?void 0:Ce.isOpen,onChange:Ze=>P(ee,"isOpen",Ze.target.checked),className:"h-5 w-5 text-afri-green focus:ring-afri-green border-gray-300 rounded cursor-pointer"}),a.jsx("span",{className:"ml-2 text-sm text-afri-gray-700",children:"Open"})]}),(Ve=(Ie=w.businessHours)==null?void 0:Ie[ee])!=null&&Ve.isOpen?a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"time",value:((Ee=($e=w.businessHours)==null?void 0:$e[ee])==null?void 0:Ee.open)||"09:00",onChange:Ze=>P(ee,"open",Ze.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent"}),a.jsx("span",{className:"text-gray-500",children:"to"}),a.jsx("input",{type:"time",value:((Be=(le=w.businessHours)==null?void 0:le[ee])==null?void 0:Be.close)||"18:00",onChange:Ze=>P(ee,"close",Ze.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent"})]}):a.jsx("span",{className:"text-gray-400 italic ml-4",children:"Closed"})]},ee)})})]}),a.jsx("div",{className:"flex justify-end pt-6 border-t",children:a.jsx("button",{onClick:W,disabled:h,className:"px-8 py-3 bg-gradient-to-r from-afri-green to-afri-green-dark text-white rounded-lg font-semibold shadow-lg hover:shadow-xl transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center",children:h?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save Changes"})})]}),o==="security"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 space-y-6 animate-fadeIn",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-afri-gray-900 mb-4",children:"Change Password"}),a.jsxs("div",{className:"max-w-md space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Current Password"}),a.jsx("input",{type:"password",value:M.currentPassword,onChange:ee=>k("currentPassword",ee.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"New Password"}),a.jsx("input",{type:"password",value:M.newPassword,onChange:ee=>k("newPassword",ee.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all"}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Must be at least 6 characters"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-afri-gray-900 mb-2",children:"Confirm New Password"}),a.jsx("input",{type:"password",value:M.confirmPassword,onChange:ee=>k("confirmPassword",ee.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition-all"})]})]})]}),a.jsx("div",{className:"flex justify-end pt-6 border-t",children:a.jsx("button",{onClick:de,disabled:h,className:"px-8 py-3 bg-gradient-to-r from-afri-green to-afri-green-dark text-white rounded-lg font-semibold shadow-lg hover:shadow-xl transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center",children:h?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Changing..."]}):"Change Password"})})]}),a.jsx("style",{jsx:!0,children:`
        @keyframes fadeIn {
          from {
            opacity: 0;
            transform: translateY(10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .animate-fadeIn {
          animation: fadeIn 0.3s ease-out;
        }
      `})]})}function Yw(){var m,y,v;const[e,r]=ue.useState([]),[t,n]=ue.useState(null),[s,o]=ue.useState(!0),[l,c]=ue.useState(!1);ue.useEffect(()=>{d()},[]);const d=async()=>{try{o(!0);const[j,w]=await Promise.all([Dl.getPlans(),Dl.getMySubscription()]);j.success&&r(j.data.plans),w.success&&n(w.data.subscription)}catch(j){console.error("Error fetching subscription data:",j)}finally{o(!1)}},h=async j=>{var w,N;try{c(!0),(await Dl.subscribe({planId:j})).success&&(alert("Subscription activated successfully!"),d())}catch(_){alert(((N=(w=_.response)==null?void 0:w.data)==null?void 0:N.message)||"Failed to subscribe")}finally{c(!1)}},u=async()=>{var j,w;if(confirm("Are you sure you want to cancel your subscription?"))try{c(!0),(await Dl.cancel()).success&&(alert("Subscription cancelled successfully"),d())}catch(N){alert(((w=(j=N.response)==null?void 0:j.data)==null?void 0:w.message)||"Failed to cancel subscription")}finally{c(!1)}},g=j=>({Free:["Up to 50 products","Basic analytics","Email support","5% transaction fee","Standard listing"],Starter:["Up to 200 products","Advanced analytics","Priority email support","3% transaction fee","Featured listing","Promotional tools"],Professional:["Unlimited products","Advanced analytics & reports","24/7 priority support","2% transaction fee","Premium listing","Marketing tools","Custom branding","API access"],Enterprise:["Everything in Professional","Dedicated account manager","1% transaction fee","White-label solution","Custom integrations","Advanced security","SLA guarantee"]})[j]||[],x=j=>({Free:"from-gray-400 to-gray-500",Starter:"from-blue-500 to-blue-600",Professional:"from-afri-green to-afri-green-dark",Enterprise:"from-purple-600 to-purple-700"})[j]||"from-gray-400 to-gray-500";return s?a.jsx("div",{className:"flex justify-center items-center h-screen",children:a.jsx("div",{className:"relative",children:a.jsx("div",{className:"w-20 h-20 border-4 border-afri-green border-t-transparent rounded-full animate-spin"})})}):a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-afri-green to-afri-green-dark bg-clip-text text-transparent",children:"Subscription Plans"}),a.jsx("p",{className:"text-afri-gray-600 mt-2",children:"Choose the perfect plan for your business"})]}),t&&a.jsx("div",{className:"bg-gradient-to-r from-afri-green to-afri-green-dark rounded-xl shadow-2xl p-6 text-white animate-slideDown",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-2xl font-bold mb-2",children:["Current Plan: ",(m=t.plan)==null?void 0:m.name]}),a.jsx("p",{className:"opacity-90",children:t.status==="active"?a.jsxs(a.Fragment,{children:[(((y=t.plan)==null?void 0:y.interval)==="monthly","Renews")," on"," ",new Date(t.currentPeriodEnd).toLocaleDateString()]}):`Status: ${t.status}`})]}),t.status==="active"&&((v=t.plan)==null?void 0:v.name)!=="Free"&&a.jsx("button",{onClick:u,disabled:l,className:"px-6 py-3 bg-white text-afri-green rounded-lg font-semibold hover:bg-gray-100 transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel Subscription"})]})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:e.map((j,w)=>{var N,_;return a.jsxs("div",{className:`relative bg-white rounded-2xl shadow-xl overflow-hidden transform transition-all duration-300 hover:scale-105 hover:shadow-2xl animate-fadeIn ${((N=t==null?void 0:t.plan)==null?void 0:N._id)===j._id?"ring-4 ring-afri-green":""}`,style:{animationDelay:`${w*100}ms`},children:[j.name==="Professional"&&a.jsx("div",{className:"absolute top-0 right-0 bg-gradient-to-r from-afri-yellow to-afri-yellow-dark text-white px-4 py-1 text-xs font-bold rounded-bl-lg",children:"POPULAR"}),a.jsxs("div",{className:`bg-gradient-to-r ${x(j.name)} text-white p-6`,children:[a.jsx("h3",{className:"text-2xl font-bold mb-2",children:j.name}),a.jsxs("div",{className:"flex items-baseline",children:[a.jsxs("span",{className:"text-4xl font-bold",children:["Â£",j.price]}),a.jsxs("span",{className:"ml-2 opacity-90",children:["/",j.interval]})]})]}),a.jsxs("div",{className:"p-6",children:[a.jsx("ul",{className:"space-y-3 mb-6",children:g(j.name).map((C,M)=>a.jsxs("li",{className:"flex items-start",children:[a.jsx("svg",{className:"w-5 h-5 text-afri-green mr-2 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),a.jsx("span",{className:"text-sm text-afri-gray-700",children:C})]},M))}),((_=t==null?void 0:t.plan)==null?void 0:_._id)===j._id?a.jsx("div",{className:"bg-afri-green text-white text-center py-3 rounded-lg font-semibold",children:"Current Plan"}):a.jsx("button",{onClick:()=>h(j._id),disabled:l||j.price===0,className:`w-full py-3 rounded-lg font-semibold transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none ${j.name==="Professional"?"bg-gradient-to-r from-afri-green to-afri-green-dark text-white shadow-lg hover:shadow-xl":"bg-gray-100 text-afri-gray-900 hover:bg-gray-200"}`,children:l?"Processing...":j.price===0?"Current Plan":"Upgrade Now"})]})]},j._id)})}),a.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 rounded-2xl p-8 mt-12",children:[a.jsx("h2",{className:"text-3xl font-bold text-center text-afri-gray-900 mb-8",children:"Why Upgrade to Premium?"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg transform transition-all hover:scale-105",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center text-3xl mb-4 mx-auto",children:"ðŸ“ˆ"}),a.jsx("h3",{className:"text-xl font-bold text-center text-afri-gray-900 mb-2",children:"Grow Your Sales"}),a.jsx("p",{className:"text-center text-afri-gray-600",children:"Get featured listings and access to promotional tools to boost your visibility and sales."})]}),a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg transform transition-all hover:scale-105",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-afri-green to-afri-green-dark rounded-full flex items-center justify-center text-3xl mb-4 mx-auto",children:"ðŸ“Š"}),a.jsx("h3",{className:"text-xl font-bold text-center text-afri-gray-900 mb-2",children:"Advanced Analytics"}),a.jsx("p",{className:"text-center text-afri-gray-600",children:"Make data-driven decisions with comprehensive reports and insights about your business."})]}),a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg transform transition-all hover:scale-105",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-purple-500 to-purple-600 rounded-full flex items-center justify-center text-3xl mb-4 mx-auto",children:"ðŸŽ¨"}),a.jsx("h3",{className:"text-xl font-bold text-center text-afri-gray-900 mb-2",children:"Custom Branding"}),a.jsx("p",{className:"text-center text-afri-gray-600",children:"Stand out with custom branding options and create a unique shopping experience."})]})]})]}),a.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[a.jsx("h2",{className:"text-3xl font-bold text-center text-afri-gray-900 mb-8",children:"Frequently Asked Questions"}),a.jsxs("div",{className:"space-y-4 max-w-3xl mx-auto",children:[a.jsxs("details",{className:"group",children:[a.jsxs("summary",{className:"flex items-center justify-between cursor-pointer p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[a.jsx("span",{className:"font-semibold text-afri-gray-900",children:"Can I change my plan anytime?"}),a.jsx("svg",{className:"w-5 h-5 transition-transform group-open:rotate-180",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),a.jsx("p",{className:"p-4 text-afri-gray-600",children:"Yes! You can upgrade or downgrade your plan at any time. Changes will be reflected in your next billing cycle."})]}),a.jsxs("details",{className:"group",children:[a.jsxs("summary",{className:"flex items-center justify-between cursor-pointer p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[a.jsx("span",{className:"font-semibold text-afri-gray-900",children:"What payment methods do you accept?"}),a.jsx("svg",{className:"w-5 h-5 transition-transform group-open:rotate-180",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),a.jsx("p",{className:"p-4 text-afri-gray-600",children:"We accept all major credit cards, debit cards, and bank transfers. All payments are processed securely through our payment gateway."})]}),a.jsxs("details",{className:"group",children:[a.jsxs("summary",{className:"flex items-center justify-between cursor-pointer p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[a.jsx("span",{className:"font-semibold text-afri-gray-900",children:"Is there a contract or commitment?"}),a.jsx("svg",{className:"w-5 h-5 transition-transform group-open:rotate-180",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),a.jsx("p",{className:"p-4 text-afri-gray-600",children:"No long-term contracts! All plans are month-to-month and you can cancel at any time without penalty."})]}),a.jsxs("details",{className:"group",children:[a.jsxs("summary",{className:"flex items-center justify-between cursor-pointer p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[a.jsx("span",{className:"font-semibold text-afri-gray-900",children:"What happens if I cancel?"}),a.jsx("svg",{className:"w-5 h-5 transition-transform group-open:rotate-180",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),a.jsx("p",{className:"p-4 text-afri-gray-600",children:"Your subscription will remain active until the end of your current billing period. After that, you'll be automatically moved to the Free plan."})]})]})]}),a.jsx("style",{jsx:!0,children:`
        @keyframes fadeIn {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        @keyframes slideDown {
          from {
            opacity: 0;
            transform: translateY(-20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .animate-fadeIn {
          animation: fadeIn 0.5s ease-out forwards;
        }

        .animate-slideDown {
          animation: slideDown 0.4s ease-out;
        }
      `})]})}function Xw({title:e,titleId:r,...t},n){return ue.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?ue.createElement("title",{id:r},e):null,ue.createElement("path",{d:"M5.85 3.5a.75.75 0 0 0-1.117-1 9.719 9.719 0 0 0-2.348 4.876.75.75 0 0 0 1.479.248A8.219 8.219 0 0 1 5.85 3.5ZM19.267 2.5a.75.75 0 1 0-1.118 1 8.22 8.22 0 0 1 1.987 4.124.75.75 0 0 0 1.48-.248A9.72 9.72 0 0 0 19.266 2.5Z"}),ue.createElement("path",{fillRule:"evenodd",d:"M12 2.25A6.75 6.75 0 0 0 5.25 9v.75a8.217 8.217 0 0 1-2.119 5.52.75.75 0 0 0 .298 1.206c1.544.57 3.16.99 4.831 1.243a3.75 3.75 0 1 0 7.48 0 24.583 24.583 0 0 0 4.83-1.244.75.75 0 0 0 .298-1.205 8.217 8.217 0 0 1-2.118-5.52V9A6.75 6.75 0 0 0 12 2.25ZM9.75 18c0-.034 0-.067.002-.1a25.05 25.05 0 0 0 4.496 0l.002.1a2.25 2.25 0 1 1-4.5 0Z",clipRule:"evenodd"}))}const Kw=ue.forwardRef(Xw);function Jw({title:e,titleId:r,...t},n){return ue.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?ue.createElement("title",{id:r},e):null,ue.createElement("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm13.36-1.814a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z",clipRule:"evenodd"}))}const Zw=ue.forwardRef(Jw);function Qw({title:e,titleId:r,...t},n){return ue.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?ue.createElement("title",{id:r},e):null,ue.createElement("path",{fillRule:"evenodd",d:"M7.72 12.53a.75.75 0 0 1 0-1.06l7.5-7.5a.75.75 0 1 1 1.06 1.06L9.31 12l6.97 6.97a.75.75 0 1 1-1.06 1.06l-7.5-7.5Z",clipRule:"evenodd"}))}const e3=ue.forwardRef(Qw);function t3({title:e,titleId:r,...t},n){return ue.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?ue.createElement("title",{id:r},e):null,ue.createElement("path",{fillRule:"evenodd",d:"M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z",clipRule:"evenodd"}))}const r3=ue.forwardRef(t3);function n3({title:e,titleId:r,...t},n){return ue.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?ue.createElement("title",{id:r},e):null,ue.createElement("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25ZM12.75 6a.75.75 0 0 0-1.5 0v6c0 .414.336.75.75.75h4.5a.75.75 0 0 0 0-1.5h-3.75V6Z",clipRule:"evenodd"}))}const _d=ue.forwardRef(n3);function a3({title:e,titleId:r,...t},n){return ue.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?ue.createElement("title",{id:r},e):null,ue.createElement("path",{fillRule:"evenodd",d:"M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z",clipRule:"evenodd"}))}const Ad=ue.forwardRef(a3);function s3({title:e,titleId:r,...t},n){return ue.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?ue.createElement("title",{id:r},e):null,ue.createElement("path",{fillRule:"evenodd",d:"m11.54 22.351.07.04.028.016a.76.76 0 0 0 .723 0l.028-.015.071-.041a16.975 16.975 0 0 0 1.144-.742 19.58 19.58 0 0 0 2.683-2.282c1.944-1.99 3.963-4.98 3.963-8.827a8.25 8.25 0 0 0-16.5 0c0 3.846 2.02 6.837 3.963 8.827a19.58 19.58 0 0 0 2.682 2.282 16.975 16.975 0 0 0 1.145.742ZM12 13.5a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z",clipRule:"evenodd"}))}const pc=ue.forwardRef(s3);function i3({title:e,titleId:r,...t},n){return ue.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?ue.createElement("title",{id:r},e):null,ue.createElement("path",{fillRule:"evenodd",d:"M12.516 2.17a.75.75 0 0 0-1.032 0 11.209 11.209 0 0 1-7.877 3.08.75.75 0 0 0-.722.515A12.74 12.74 0 0 0 2.25 9.75c0 5.942 4.064 10.933 9.563 12.348a.749.749 0 0 0 .374 0c5.499-1.415 9.563-6.406 9.563-12.348 0-1.39-.223-2.73-.635-3.985a.75.75 0 0 0-.722-.516l-.143.001c-2.996 0-5.717-1.17-7.734-3.08Zm3.094 8.016a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z",clipRule:"evenodd"}))}const yh=ue.forwardRef(i3);function o3({title:e,titleId:r,...t},n){return ue.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?ue.createElement("title",{id:r},e):null,ue.createElement("path",{fillRule:"evenodd",d:"M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z",clipRule:"evenodd"}))}const kd=ue.forwardRef(o3);function l3({title:e,titleId:r,...t},n){return ue.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?ue.createElement("title",{id:r},e):null,ue.createElement("path",{d:"M3.375 4.5C2.339 4.5 1.5 5.34 1.5 6.375V13.5h12V6.375c0-1.036-.84-1.875-1.875-1.875h-8.25ZM13.5 15h-12v2.625c0 1.035.84 1.875 1.875 1.875h.375a3 3 0 1 1 6 0h3a.75.75 0 0 0 .75-.75V15Z"}),ue.createElement("path",{d:"M8.25 19.5a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0ZM15.75 6.75a.75.75 0 0 0-.75.75v11.25c0 .087.015.17.042.248a3 3 0 0 1 5.958.464c.853-.175 1.522-.935 1.464-1.883a18.659 18.659 0 0 0-3.732-10.104 1.837 1.837 0 0 0-1.47-.725H15.75Z"}),ue.createElement("path",{d:"M19.5 19.5a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0Z"}))}const c3=ue.forwardRef(l3);function d3(){const e=pa(),[r,t]=ue.useState(""),[n,s]=ue.useState(!1),o=[{id:1,name:"Green Valley Farms",category:"Fresh Produce",image:"https://images.unsplash.com/photo-1542838132-92c53300491e?w=600",rating:4.8,deliveryTime:"20-30 min",minOrder:"Â£10",tags:["Vegetables","Fruits","Organic"]},{id:2,name:"African Spice Market",category:"African Groceries",image:"https://images.unsplash.com/photo-1488459716781-31db52582fe9?w=600",rating:4.9,deliveryTime:"25-35 min",minOrder:"Â£15",tags:["Spices","Grains","Authentic"]},{id:3,name:"Fresh Meat & Fish",category:"Butcher & Seafood",image:"https://images.unsplash.com/photo-1607623814075-e51df1bdc82f?w=600",rating:4.7,deliveryTime:"30-40 min",minOrder:"Â£20",tags:["Halal","Fresh Fish","Quality"]},{id:4,name:"Daily Dairy",category:"Dairy & Bakery",image:"https://images.unsplash.com/photo-1563636619-e9143da7973b?w=600",rating:4.6,deliveryTime:"15-25 min",minOrder:"Â£8",tags:["Milk","Cheese","Bread"]},{id:5,name:"Tropical Fruits Hub",category:"Exotic Fruits",image:"https://images.unsplash.com/photo-1619566636858-adf3ef46400b?w=600",rating:4.8,deliveryTime:"20-30 min",minOrder:"Â£12",tags:["Plantain","Mango","Yam"]},{id:6,name:"Lagos Kitchen Store",category:"Nigerian Foods",image:"https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=600",rating:4.9,deliveryTime:"25-35 min",minOrder:"Â£15",tags:["Nigerian","Palm Oil","Cassava"]}],l=c=>{c.preventDefault(),r.trim()&&e(`/stores?location=${encodeURIComponent(r)}`)};return a.jsxs("div",{className:"min-h-screen bg-white",children:[a.jsx("nav",{className:"bg-white border-b border-gray-200 sticky top-0 z-50 shadow-sm",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:[a.jsxs("div",{className:"flex justify-between items-center h-16",children:[a.jsxs(ft,{to:"/",className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-green-600 to-yellow-500 rounded-lg flex items-center justify-center",children:a.jsx("span",{className:"text-white font-bold text-lg",children:"ðŸ›’"})}),a.jsxs("span",{className:"text-xl font-bold text-gray-900",children:["Afri",a.jsx("span",{className:"text-green-600",children:"Mercato"})]})]}),a.jsxs("div",{className:"hidden md:flex items-center space-x-6",children:[a.jsx("a",{href:"#stores",className:"text-gray-600 hover:text-green-600",children:"Browse Stores"}),a.jsx("a",{href:"#how-it-works",className:"text-gray-600 hover:text-green-600",children:"How It Works"}),a.jsx(ft,{to:"/partner",className:"text-gray-600 hover:text-green-600",children:"Partner With Us"}),a.jsx(ft,{to:"/login",className:"text-green-600 hover:text-green-700 font-medium",children:"Sign In"}),a.jsx(ft,{to:"/register?role=customer",className:"bg-green-600 hover:bg-green-700 text-white px-5 py-2 rounded-lg font-medium",children:"Sign Up"})]}),a.jsx("button",{onClick:()=>s(!n),className:"md:hidden p-2",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:n?"M6 18L18 6M6 6l12 12":"M4 6h16M4 12h16M4 18h16"})})})]}),n&&a.jsxs("div",{className:"md:hidden py-4 border-t",children:[a.jsx("a",{href:"#stores",className:"block py-2 text-gray-600",children:"Browse Stores"}),a.jsx("a",{href:"#how-it-works",className:"block py-2 text-gray-600",children:"How It Works"}),a.jsx(ft,{to:"/partner",className:"block py-2 text-gray-600",children:"Partner With Us"}),a.jsx(ft,{to:"/login",className:"block py-2 text-green-600 font-medium",children:"Sign In"}),a.jsx(ft,{to:"/register?role=customer",className:"block mt-2 bg-green-600 text-white px-4 py-2 rounded-lg text-center font-medium",children:"Sign Up"})]})]})}),a.jsxs("section",{className:"relative bg-gradient-to-br from-green-600 via-green-700 to-yellow-500 overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 opacity-10",children:a.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.4'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}})}),a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 py-16 sm:py-24 relative",children:a.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 items-center",children:[a.jsxs("div",{className:"text-center lg:text-left",children:[a.jsxs(nt.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-4xl sm:text-5xl lg:text-6xl font-bold text-white mb-6 leading-tight",children:["African Online Store",a.jsx("br",{}),a.jsx("span",{className:"text-yellow-300",children:"In the United Kingdom"})]}),a.jsx(nt.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"text-lg sm:text-xl text-white/95 mb-8 max-w-2xl mx-auto lg:mx-0",children:"Use existing infrastructure of African products you depend on delivered to your doorstep. Open stores, fresh products delivered to you whenever convenient."}),a.jsxs(nt.form,{onSubmit:l,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-2xl shadow-2xl p-3 flex flex-col sm:flex-row gap-3 max-w-2xl mx-auto lg:mx-0",children:[a.jsxs("div",{className:"flex-1 flex items-center gap-3 bg-gray-50 rounded-xl px-4 py-3",children:[a.jsx(pc,{className:"w-6 h-6 text-green-600 flex-shrink-0"}),a.jsx("input",{type:"text",value:r,onChange:c=>t(c.target.value),placeholder:"Enter your location (e.g., London, Manchester)",className:"flex-1 bg-transparent border-none outline-none text-gray-900 placeholder-gray-500"})]}),a.jsxs("button",{type:"submit",className:"bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white px-8 py-3 rounded-xl font-bold shadow-lg flex items-center justify-center gap-2 transition-all",children:[a.jsx(Ad,{className:"w-5 h-5"}),"Find Store"]})]}),a.jsxs(nt.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"mt-6 text-white/90 flex items-center justify-center lg:justify-start gap-2",children:[a.jsx("span",{className:"text-2xl",children:"ðŸ‘¥"}),a.jsxs("span",{className:"font-semibold",children:["Trusted by: ",a.jsx("span",{className:"text-yellow-300",children:"4,320+ Vendors"})]})]})]}),a.jsx(nt.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2},className:"hidden lg:block",children:a.jsx("img",{src:"https://images.unsplash.com/photo-1567393537607-1e1a6df6763a?w=800",alt:"Happy customer with groceries",className:"rounded-3xl shadow-2xl w-full object-cover"})})]})})]}),a.jsx("section",{className:"py-8 bg-gray-50 border-b",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4",children:a.jsx("div",{className:"flex gap-4 overflow-x-auto pb-2 scrollbar-hide",children:[{icon:"ðŸ¥¬",name:"Vegetables",color:"bg-green-100 text-green-700"},{icon:"ðŸŒ",name:"Fruits",color:"bg-yellow-100 text-yellow-700"},{icon:"ðŸ¥©",name:"Meat & Fish",color:"bg-red-100 text-red-700"},{icon:"ðŸ¥›",name:"Dairy",color:"bg-blue-100 text-blue-700"},{icon:"ðŸŒ¶ï¸",name:"Spices",color:"bg-orange-100 text-orange-700"},{icon:"ðŸŒ¾",name:"Grains",color:"bg-amber-100 text-amber-700"}].map((c,d)=>a.jsxs("button",{className:`${c.color} px-6 py-3 rounded-xl font-semibold whitespace-nowrap flex items-center gap-2 hover:scale-105 transition-transform`,children:[a.jsx("span",{className:"text-2xl",children:c.icon}),c.name]},d))})})}),a.jsx("section",{id:"stores",className:"py-16",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-8",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-2",children:"Browse Nearby"}),a.jsx("p",{className:"text-gray-600",children:"Popular stores in your area"})]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsx("button",{className:"px-4 py-2 bg-green-600 text-white rounded-lg font-semibold",children:"Top Stores"}),a.jsx("button",{className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg font-semibold hover:bg-gray-200",children:"Featured Stores"})]})]}),a.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-6",children:o.map(c=>a.jsxs(nt.div,{whileHover:{y:-5},className:"bg-white rounded-2xl shadow-lg hover:shadow-xl border border-gray-100 overflow-hidden cursor-pointer transition-all",onClick:()=>e(`/store/${c.id}`),children:[a.jsxs("div",{className:"relative h-48",children:[a.jsx("img",{src:c.image,alt:c.name,className:"w-full h-full object-cover"}),a.jsxs("div",{className:"absolute top-3 right-3 bg-white px-3 py-1 rounded-full shadow-md flex items-center gap-1",children:[a.jsx(kd,{className:"w-4 h-4 text-yellow-500"}),a.jsx("span",{className:"font-bold text-gray-900",children:c.rating})]})]}),a.jsxs("div",{className:"p-5",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:c.name}),a.jsx("p",{className:"text-sm text-gray-600 mb-3",children:c.category}),a.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:c.tags.slice(0,3).map((d,h)=>a.jsx("span",{className:"bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-xs font-medium",children:d},h))}),a.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 pt-3 border-t",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(_d,{className:"w-4 h-4"}),a.jsx("span",{children:c.deliveryTime})]}),a.jsxs("div",{className:"font-semibold text-gray-900",children:["Min. ",c.minOrder]})]})]})]},c.id))}),a.jsx("div",{className:"text-center mt-10",children:a.jsx("button",{className:"bg-green-600 hover:bg-green-700 text-white px-8 py-3 rounded-xl font-bold shadow-lg",children:"View All Stores"})})]})}),a.jsx("section",{id:"how-it-works",className:"py-16 bg-gradient-to-br from-green-50 to-yellow-50",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[a.jsxs("div",{className:"text-center mb-12",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-2",children:"How It Works"}),a.jsx("p",{className:"text-lg text-gray-600",children:"Get fresh African groceries delivered in 3 simple steps"})]}),a.jsx("div",{className:"grid sm:grid-cols-3 gap-8",children:[{num:1,icon:"ðŸ”",title:"Find Stores Near You",desc:"Enter your location and browse stores in your area"},{num:2,icon:"ðŸ›’",title:"Add to Cart",desc:"Choose products from multiple vendors in one order"},{num:3,icon:"ðŸšš",title:"Fast Delivery",desc:"Get your groceries delivered same-day"}].map(c=>a.jsxs(nt.div,{className:"text-center",whileHover:{y:-5},children:[a.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-green-500 to-green-700 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg",children:a.jsx("span",{className:"text-4xl",children:c.icon})}),a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:c.title}),a.jsx("p",{className:"text-gray-600",children:c.desc})]},c.num))})]})}),a.jsx("section",{className:"bg-gradient-to-r from-yellow-400 via-yellow-500 to-green-600 py-16",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-4 text-center",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-4",children:"Are You a Food Vendor?"}),a.jsx("p",{className:"text-lg text-gray-800 mb-8",children:"Join 4,320+ vendors already selling on AfriMercato. Reach thousands of customers and grow your business online."}),a.jsx(ft,{to:"/partner",className:"inline-block bg-gray-900 text-white hover:bg-gray-800 px-10 py-4 rounded-xl font-bold shadow-2xl text-lg",children:"Partner With Us â†’"})]})}),a.jsx("footer",{className:"bg-gray-900 text-gray-300 py-12",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-8",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-bold mb-4",children:"AfriMercato"}),a.jsx("p",{className:"text-sm",children:"African groceries delivered to your door across the UK."})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-bold mb-4",children:"For Customers"}),a.jsxs("ul",{className:"space-y-2 text-sm",children:[a.jsx("li",{children:a.jsx("a",{href:"#stores",className:"hover:text-yellow-400",children:"Browse Stores"})}),a.jsx("li",{children:a.jsx("a",{href:"#how-it-works",className:"hover:text-yellow-400",children:"How It Works"})}),a.jsx("li",{children:a.jsx(ft,{to:"/register?role=customer",className:"hover:text-yellow-400",children:"Sign Up"})})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-bold mb-4",children:"For Partners"}),a.jsxs("ul",{className:"space-y-2 text-sm",children:[a.jsx("li",{children:a.jsx(ft,{to:"/partner",className:"hover:text-yellow-400",children:"Become a Vendor"})}),a.jsx("li",{children:a.jsx(ft,{to:"/register?role=rider",className:"hover:text-yellow-400",children:"Become a Rider"})}),a.jsx("li",{children:a.jsx(ft,{to:"/register?role=picker",className:"hover:text-yellow-400",children:"Become a Picker"})})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-bold mb-4",children:"Company"}),a.jsxs("ul",{className:"space-y-2 text-sm",children:[a.jsx("li",{children:a.jsx("a",{href:"#",className:"hover:text-yellow-400",children:"About Us"})}),a.jsx("li",{children:a.jsx("a",{href:"#",className:"hover:text-yellow-400",children:"Contact"})}),a.jsx("li",{children:a.jsx("a",{href:"#",className:"hover:text-yellow-400",children:"Privacy Policy"})})]})]})]}),a.jsx("div",{className:"border-t border-gray-800 mt-8 pt-8 text-center text-sm",children:a.jsx("p",{children:"Â© 2025 AfriMercato. All rights reserved."})})]})})]})}const _a=[{id:1,image:"https://images.unsplash.com/photo-1542838132-92c53300491e?w=1600&q=80",title:"Fresh African Vegetables",subtitle:"Delivered to your doorstep in 20-40 minutes",cta:"Shop Now",gradient:"from-green-600/90 to-emerald-700/90"},{id:2,image:"https://images.unsplash.com/photo-1619566636858-adf3ef46400b?w=1600&q=80",title:"Exotic Tropical Fruits",subtitle:"Plantain, Yam, Cassava & More - Always Fresh",cta:"Discover",gradient:"from-yellow-600/90 to-orange-700/90"},{id:3,image:"https://images.unsplash.com/photo-1488459716781-31db52582fe9?w=1600&q=80",title:"Authentic Spices & Grains",subtitle:"Bringing Africa to UK with premium quality",cta:"Explore",gradient:"from-red-600/90 to-pink-700/90"},{id:4,image:"https://images.unsplash.com/photo-1607623814075-e51df1bdc82f?w=1600&q=80",title:"Fresh Meat & Fish",subtitle:"Halal certified, quality guaranteed",cta:"Order Now",gradient:"from-blue-600/90 to-purple-700/90"}];function f3({onSearch:e}){const[r,t]=ue.useState(0),[n,s]=ue.useState(!0);ue.useEffect(()=>{if(!n)return;const d=setInterval(()=>{t(h=>(h+1)%_a.length)},5e3);return()=>clearInterval(d)},[n]);const o=()=>{t(d=>(d+1)%_a.length),s(!1),setTimeout(()=>s(!0),1e4)},l=()=>{t(d=>(d-1+_a.length)%_a.length),s(!1),setTimeout(()=>s(!0),1e4)},c=d=>{t(d),s(!1),setTimeout(()=>s(!0),1e4)};return a.jsxs("div",{className:"relative h-[500px] sm:h-[600px] lg:h-[700px] overflow-hidden",children:[a.jsx(Zl,{mode:"wait",children:a.jsxs(nt.div,{initial:{opacity:0,scale:1.1},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.7,ease:"easeInOut"},className:"absolute inset-0",children:[a.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:`url(${_a[r].image})`},children:a.jsx("div",{className:`absolute inset-0 bg-gradient-to-r ${_a[r].gradient}`})}),a.jsx("div",{className:"relative h-full flex items-center justify-center",children:a.jsxs("div",{className:"text-center px-4 sm:px-6 max-w-4xl",children:[a.jsx(nt.h1,{initial:{y:30,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.6},className:"text-4xl sm:text-5xl lg:text-7xl font-bold text-white mb-4 sm:mb-6 drop-shadow-2xl",children:_a[r].title}),a.jsx(nt.p,{initial:{y:30,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4,duration:.6},className:"text-lg sm:text-xl lg:text-2xl text-white/95 mb-6 sm:mb-8 drop-shadow-lg",children:_a[r].subtitle}),a.jsxs(nt.button,{initial:{y:30,opacity:0},animate:{y:0,opacity:1},transition:{delay:.6,duration:.6},onClick:e,whileHover:{scale:1.05,boxShadow:"0 20px 40px rgba(0,0,0,0.3)"},whileTap:{scale:.95},className:"bg-white text-gray-900 px-8 sm:px-12 py-3 sm:py-4 rounded-full font-bold text-base sm:text-lg shadow-2xl hover:bg-yellow-400 transition-all",children:[_a[r].cta," â†’"]})]})})]},r)}),a.jsx("button",{onClick:l,className:"absolute left-4 top-1/2 -translate-y-1/2 bg-white/20 backdrop-blur-sm hover:bg-white/30 text-white p-2 sm:p-3 rounded-full transition-all z-10 shadow-lg","aria-label":"Previous slide",children:a.jsx(e3,{className:"w-6 h-6 sm:w-8 sm:h-8"})}),a.jsx("button",{onClick:o,className:"absolute right-4 top-1/2 -translate-y-1/2 bg-white/20 backdrop-blur-sm hover:bg-white/30 text-white p-2 sm:p-3 rounded-full transition-all z-10 shadow-lg","aria-label":"Next slide",children:a.jsx(r3,{className:"w-6 h-6 sm:w-8 sm:h-8"})}),a.jsx("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 flex gap-2 sm:gap-3 z-10",children:_a.map((d,h)=>a.jsx("button",{onClick:()=>c(h),className:`transition-all rounded-full ${h===r?"bg-white w-8 sm:w-12 h-2 sm:h-3":"bg-white/50 w-2 sm:w-3 h-2 sm:h-3 hover:bg-white/75"}`,"aria-label":`Go to slide ${h+1}`},h))}),n&&a.jsxs("div",{className:"absolute top-4 right-4 bg-black/30 backdrop-blur-sm text-white px-3 py-1 rounded-full text-xs sm:text-sm flex items-center gap-2",children:[a.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),"Auto"]})]})}function h3(){const e=pa(),[r,t]=ue.useState(""),[n,s]=ue.useState(!1),[o,l]=ue.useState(0),c=ue.useRef(null),d=()=>{var m;(m=c.current)==null||m.scrollIntoView({behavior:"smooth",block:"center"})},h=[{icon:a.jsx(Zw,{className:"w-8 h-8 text-green-600"}),title:"Real-Time Stock Updates",description:'See exact stock levels before you order. No more "out of stock" surprises at delivery.',painPointSolved:"28% of UK shoppers face out-of-stock issues",color:"from-green-500 to-emerald-600"},{icon:a.jsx(c3,{className:"w-8 h-8 text-blue-600"}),title:"Live Delivery Tracking",description:"GPS tracking + minute-by-minute ETA updates. Know exactly when your order arrives.",painPointSolved:"20% complain about late/failed deliveries",color:"from-blue-500 to-cyan-600"},{icon:a.jsx(yh,{className:"w-8 h-8 text-purple-600"}),title:"Quality Guarantee",description:"Fresh produce guarantee. Damaged/expired items? Instant refund or replacement.",painPointSolved:"Top complaint: wilted veg & expired products",color:"from-purple-500 to-pink-600"},{icon:a.jsx(Kw,{className:"w-8 h-8 text-orange-600"}),title:"Smart Substitutions",description:"AI-powered alternatives you'll actually want. Approve substitutions before delivery.",painPointSolved:"Major issue: poor substitutions",color:"from-orange-500 to-red-600"}],u=[{id:1,name:"Green Valley Farms",category:"Fresh Produce",image:"https://images.unsplash.com/photo-1542838132-92c53300491e?w=600",rating:4.8,deliveryTime:"20-30 min",minOrder:"Â£10",tags:["Vegetables","Fruits","Organic"],inStock:98,freshGuarantee:!0},{id:2,name:"African Spice Market",category:"African Groceries",image:"https://images.unsplash.com/photo-1488459716781-31db52582fe9?w=600",rating:4.9,deliveryTime:"25-35 min",minOrder:"Â£15",tags:["Spices","Grains","Authentic"],inStock:95,freshGuarantee:!0},{id:3,name:"Fresh Meat & Fish",category:"Butcher & Seafood",image:"https://images.unsplash.com/photo-1607623814075-e51df1bdc82f?w=600",rating:4.7,deliveryTime:"30-40 min",minOrder:"Â£20",tags:["Halal","Fresh Fish","Quality"],inStock:92,freshGuarantee:!0}],g=[{text:"Finally! Real-time stock updates mean no more missing items in my delivery. This is what UK grocery shopping needed!",author:"Sarah M.",location:"London",avatar:"ðŸ‘©ðŸ½"},{text:"The live delivery tracking is incredible. I can see my rider's exact location and the ETA updates every minute. No more waiting around!",author:"James O.",location:"Manchester",avatar:"ðŸ‘¨ðŸ¾"},{text:"Their smart substitution system actually works! I approve alternatives before delivery. No more random replacements I don't want.",author:"Amina K.",location:"Birmingham",avatar:"ðŸ‘©ðŸ¿"}];ue.useEffect(()=>{const m=setInterval(()=>{l(y=>(y+1)%g.length)},5e3);return()=>clearInterval(m)},[]);const x=m=>{m.preventDefault(),r.trim()&&e(`/stores?location=${encodeURIComponent(r)}`)};return a.jsxs("div",{className:"min-h-screen bg-white",children:[a.jsx("nav",{className:"bg-white border-b border-gray-200 sticky top-0 z-50 shadow-sm",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:[a.jsxs("div",{className:"flex justify-between items-center h-16",children:[a.jsxs(ft,{to:"/",className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-green-600 to-yellow-500 rounded-lg flex items-center justify-center",children:a.jsx("span",{className:"text-white font-bold text-lg",children:"ðŸ›’"})}),a.jsxs("span",{className:"text-lg sm:text-xl font-bold text-gray-900",children:["Afri",a.jsx("span",{className:"text-green-600",children:"Mercato"})]})]}),a.jsxs("div",{className:"hidden md:flex items-center space-x-6",children:[a.jsx("a",{href:"#features",className:"text-gray-600 hover:text-green-600 font-medium",children:"Features"}),a.jsx("a",{href:"#stores",className:"text-gray-600 hover:text-green-600 font-medium",children:"Stores"}),a.jsx(ft,{to:"/partner",className:"text-gray-600 hover:text-green-600 font-medium",children:"Partner"}),a.jsx(ft,{to:"/login",className:"text-green-600 hover:text-green-700 font-semibold",children:"Sign In"}),a.jsx(ft,{to:"/register?role=customer",className:"bg-green-600 hover:bg-green-700 text-white px-5 py-2.5 rounded-lg font-semibold shadow-md",children:"Sign Up Free"})]}),a.jsx("button",{onClick:()=>s(!n),className:"md:hidden p-2 rounded-lg hover:bg-gray-100","aria-label":"Toggle menu",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:n?"M6 18L18 6M6 6l12 12":"M4 6h16M4 12h16M4 18h16"})})})]}),a.jsx(Zl,{children:n&&a.jsxs(nt.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"md:hidden py-4 border-t",children:[a.jsx("a",{href:"#features",className:"block py-3 text-gray-700 font-medium text-lg",onClick:()=>s(!1),children:"Features"}),a.jsx("a",{href:"#stores",className:"block py-3 text-gray-700 font-medium text-lg",onClick:()=>s(!1),children:"Stores"}),a.jsx(ft,{to:"/partner",className:"block py-3 text-gray-700 font-medium text-lg",onClick:()=>s(!1),children:"Partner"}),a.jsx(ft,{to:"/login",className:"block py-3 text-green-600 font-semibold text-lg",onClick:()=>s(!1),children:"Sign In"}),a.jsx(ft,{to:"/register?role=customer",className:"block mt-3 bg-green-600 text-white px-4 py-3 rounded-lg text-center font-semibold text-lg shadow-md",onClick:()=>s(!1),children:"Sign Up Free"})]})})]})}),a.jsx(f3,{onSearch:d}),a.jsx("section",{ref:c,className:"relative bg-gradient-to-br from-green-50 to-yellow-50 py-12 sm:py-16",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:a.jsxs("div",{className:"text-center max-w-3xl mx-auto",children:[a.jsx(nt.h2,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-900 mb-3 sm:mb-4",children:"Find African Stores Near You"}),a.jsxs(nt.p,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:.1},className:"text-base sm:text-lg text-gray-600 mb-6 sm:mb-8 px-4",children:["ðŸŽ¯ Real-time stock â€¢ ðŸ“ Live GPS tracking â€¢ âœ¨ Quality guaranteed",a.jsx("br",{className:"hidden sm:block"}),a.jsx("span",{className:"font-semibold text-green-700",children:"Finally, grocery delivery done right in the UK"})]}),a.jsxs(nt.form,{onSubmit:x,initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:.2},className:"bg-white rounded-2xl shadow-2xl p-3 flex flex-col sm:flex-row gap-3 max-w-2xl mx-auto",children:[a.jsxs("div",{className:"flex-1 flex items-center gap-3 bg-gray-50 rounded-xl px-4 py-4 sm:py-3",children:[a.jsx(pc,{className:"w-6 h-6 text-green-600 flex-shrink-0"}),a.jsx("input",{type:"text",value:r,onChange:m=>t(m.target.value),placeholder:"Enter your postcode or area",className:"flex-1 bg-transparent border-none outline-none text-gray-900 placeholder-gray-500 text-base"})]}),a.jsxs("button",{type:"submit",className:"bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white px-6 sm:px-8 py-4 sm:py-3 rounded-xl font-bold shadow-lg flex items-center justify-center gap-2 transition-all text-base sm:text-lg",children:[a.jsx(Ad,{className:"w-5 h-5"}),a.jsx("span",{children:"Find Stores"})]})]}),a.jsxs(nt.div,{initial:{opacity:0},whileInView:{opacity:1},viewport:{once:!0},transition:{delay:.3},className:"mt-6 text-gray-700 flex flex-col sm:flex-row items-center justify-center gap-2 text-sm sm:text-base",children:[a.jsx("span",{className:"text-2xl",children:"ðŸ‘¥"}),a.jsxs("span",{className:"font-semibold",children:["Join ",a.jsx("span",{className:"text-green-600",children:"4,320+ vendors"})," and ",a.jsx("span",{className:"text-green-600",children:"12,000+ happy customers"})]})]})]})})}),a.jsx("section",{id:"features",className:"py-12 sm:py-16 bg-gray-50",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:[a.jsxs("div",{className:"text-center mb-10 sm:mb-12",children:[a.jsx("h2",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-900 mb-3 sm:mb-4",children:"Why We're Better Than Other UK Grocery Apps"}),a.jsx("p",{className:"text-base sm:text-lg text-gray-600 max-w-2xl mx-auto px-4",children:"We researched the top complaints about UK online grocery shopping and built solutions"})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 sm:gap-8",children:h.map((m,y)=>a.jsxs(nt.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:y*.1},className:"bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all border border-gray-100",children:[a.jsx("div",{className:`w-16 h-16 bg-gradient-to-br ${m.color} rounded-xl flex items-center justify-center mb-4 shadow-md`,children:m.icon}),a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:m.title}),a.jsx("p",{className:"text-gray-600 mb-4 text-sm sm:text-base",children:m.description}),a.jsx("div",{className:"bg-green-50 border-l-4 border-green-500 p-3 rounded",children:a.jsxs("p",{className:"text-xs sm:text-sm text-green-800 font-semibold",children:["âœ“ Solves: ",m.painPointSolved]})})]},y))})]})}),a.jsx("section",{id:"stores",className:"py-12 sm:py-16 bg-white",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8 gap-4",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-900 mb-2",children:"Top Rated Stores"}),a.jsx("p",{className:"text-sm sm:text-base text-gray-600",children:"All showing real-time stock availability"})]}),a.jsxs("div",{className:"flex gap-3 w-full sm:w-auto",children:[a.jsx("button",{className:"flex-1 sm:flex-none px-4 py-2 bg-green-600 text-white rounded-lg font-semibold text-sm sm:text-base",children:"Near You"}),a.jsx("button",{className:"flex-1 sm:flex-none px-4 py-2 bg-gray-100 text-gray-700 rounded-lg font-semibold hover:bg-gray-200 text-sm sm:text-base",children:"Featured"})]})]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5 sm:gap-6",children:u.map(m=>a.jsxs(nt.div,{whileHover:{y:-5},whileTap:{scale:.98},className:"bg-white rounded-2xl shadow-lg hover:shadow-xl border border-gray-100 overflow-hidden cursor-pointer transition-all",onClick:()=>e(`/store/${m.id}`),children:[a.jsxs("div",{className:"relative h-44 sm:h-48",children:[a.jsx("img",{src:m.image,alt:m.name,className:"w-full h-full object-cover"}),a.jsxs("div",{className:"absolute top-3 right-3 bg-white px-3 py-1 rounded-full shadow-md flex items-center gap-1",children:[a.jsx(kd,{className:"w-4 h-4 text-yellow-500"}),a.jsx("span",{className:"font-bold text-gray-900 text-sm",children:m.rating})]}),a.jsxs("div",{className:"absolute top-3 left-3 bg-green-600 text-white px-3 py-1 rounded-full shadow-md flex items-center gap-1 text-xs font-semibold",children:[a.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),m.inStock,"% in stock"]})]}),a.jsxs("div",{className:"p-5",children:[a.jsx("h3",{className:"text-lg sm:text-xl font-bold text-gray-900 mb-1",children:m.name}),a.jsx("p",{className:"text-sm text-gray-600 mb-3",children:m.category}),a.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:m.tags.map((y,v)=>a.jsx("span",{className:"bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-xs font-medium",children:y},v))}),m.freshGuarantee&&a.jsxs("div",{className:"mb-3 flex items-center gap-2 text-green-600",children:[a.jsx(yh,{className:"w-5 h-5"}),a.jsx("span",{className:"text-sm font-semibold",children:"Fresh Quality Guaranteed"})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 pt-3 border-t",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(_d,{className:"w-4 h-4"}),a.jsx("span",{children:m.deliveryTime})]}),a.jsxs("div",{className:"font-semibold text-gray-900",children:["Min. ",m.minOrder]})]})]})]},m.id))}),a.jsx("div",{className:"text-center mt-8 sm:mt-10",children:a.jsx("button",{onClick:()=>e("/stores"),className:"w-full sm:w-auto bg-green-600 hover:bg-green-700 text-white px-8 py-4 rounded-xl font-bold shadow-lg text-base sm:text-lg",children:"View All Stores â†’"})})]})}),a.jsx("section",{className:"py-12 sm:py-16 bg-gradient-to-br from-green-50 to-yellow-50",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6",children:[a.jsxs("div",{className:"text-center mb-8 sm:mb-12",children:[a.jsx("h2",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-900 mb-3",children:"What Our Customers Say"}),a.jsx("p",{className:"text-sm sm:text-base text-gray-600",children:"Real feedback from real customers"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Zl,{mode:"wait",children:a.jsxs(nt.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"bg-white rounded-2xl shadow-xl p-6 sm:p-8 border border-gray-100",children:[a.jsx("div",{className:"text-5xl sm:text-6xl mb-4",children:g[o].avatar}),a.jsxs("p",{className:"text-base sm:text-lg text-gray-700 mb-4 sm:mb-6 italic",children:['"',g[o].text,'"']}),a.jsxs("div",{children:[a.jsx("p",{className:"font-bold text-gray-900 text-base sm:text-lg",children:g[o].author}),a.jsx("p",{className:"text-sm text-gray-600",children:g[o].location})]})]},o)}),a.jsx("div",{className:"flex justify-center gap-2 mt-6",children:g.map((m,y)=>a.jsx("button",{onClick:()=>l(y),className:`w-3 h-3 rounded-full transition-all ${y===o?"bg-green-600 w-8":"bg-gray-300"}`,"aria-label":`View testimonial ${y+1}`},y))})]})]})}),a.jsx("section",{className:"py-12 sm:py-16 bg-white",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:[a.jsxs("div",{className:"text-center mb-10 sm:mb-12",children:[a.jsx("h2",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-900 mb-3",children:"How It Works"}),a.jsx("p",{className:"text-base sm:text-lg text-gray-600",children:"Fresh groceries in 3 simple steps"})]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-8",children:[{num:1,icon:"ðŸ”",title:"Find & Browse",desc:"Search stores near you. See real-time stock levels before adding to cart."},{num:2,icon:"ðŸ›’",title:"Order & Approve",desc:"Add items to cart. Approve smart substitutions if items run out."},{num:3,icon:"ðŸšš",title:"Track & Receive",desc:"Watch live GPS tracking. Get minute-by-minute ETA updates."}].map(m=>a.jsxs(nt.div,{className:"text-center",initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:m.num*.1},children:[a.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-green-500 to-green-700 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg",children:a.jsx("span",{className:"text-4xl",children:m.icon})}),a.jsx("div",{className:"inline-block bg-green-600 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold mb-3",children:m.num}),a.jsx("h3",{className:"text-lg sm:text-xl font-bold text-gray-900 mb-2",children:m.title}),a.jsx("p",{className:"text-sm sm:text-base text-gray-600 max-w-xs mx-auto",children:m.desc})]},m.num))})]})}),a.jsx("section",{className:"bg-gradient-to-r from-yellow-400 via-yellow-500 to-green-600 py-12 sm:py-16",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 text-center",children:[a.jsx("h2",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-900 mb-4",children:"Are You a Vendor?"}),a.jsx("p",{className:"text-base sm:text-lg text-gray-800 mb-6 sm:mb-8 px-4",children:"Join 4,320+ vendors selling on AfriMercato. Reach thousands of customers across the UK."}),a.jsx(ft,{to:"/partner",className:"inline-block bg-gray-900 text-white hover:bg-gray-800 px-8 sm:px-10 py-4 rounded-xl font-bold shadow-2xl text-base sm:text-lg w-full sm:w-auto",children:"Partner With Us â†’"})]})}),a.jsx("footer",{className:"bg-gray-900 text-gray-300 py-10 sm:py-12",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:[a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-6 sm:gap-8",children:[a.jsxs("div",{className:"col-span-2 sm:col-span-1",children:[a.jsx("h4",{className:"text-white font-bold mb-4 text-lg",children:"AfriMercato"}),a.jsx("p",{className:"text-sm",children:"Fresh African groceries delivered across the UK with real-time tracking."})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-bold mb-4",children:"Customers"}),a.jsxs("ul",{className:"space-y-2 text-sm",children:[a.jsx("li",{children:a.jsx("a",{href:"#features",className:"hover:text-yellow-400",children:"Features"})}),a.jsx("li",{children:a.jsx("a",{href:"#stores",className:"hover:text-yellow-400",children:"Stores"})}),a.jsx("li",{children:a.jsx(ft,{to:"/register?role=customer",className:"hover:text-yellow-400",children:"Sign Up"})})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-bold mb-4",children:"Partners"}),a.jsxs("ul",{className:"space-y-2 text-sm",children:[a.jsx("li",{children:a.jsx(ft,{to:"/partner",className:"hover:text-yellow-400",children:"Become Vendor"})}),a.jsx("li",{children:a.jsx(ft,{to:"/register?role=rider",className:"hover:text-yellow-400",children:"Become Rider"})})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-bold mb-4",children:"Company"}),a.jsxs("ul",{className:"space-y-2 text-sm",children:[a.jsx("li",{children:a.jsx("a",{href:"#",className:"hover:text-yellow-400",children:"About"})}),a.jsx("li",{children:a.jsx("a",{href:"#",className:"hover:text-yellow-400",children:"Contact"})}),a.jsx("li",{children:a.jsx("a",{href:"#",className:"hover:text-yellow-400",children:"Privacy"})})]})]})]}),a.jsx("div",{className:"border-t border-gray-800 mt-8 pt-8 text-center text-sm",children:a.jsx("p",{children:"Â© 2025 AfriMercato. All rights reserved. Built for 75% mobile users ðŸ“±"})})]})})]})}function u3({title:e,titleId:r,...t},n){return ue.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?ue.createElement("title",{id:r},e):null,ue.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const m3=ue.forwardRef(u3);function p3({title:e,titleId:r,...t},n){return ue.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?ue.createElement("title",{id:r},e):null,ue.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const bh=ue.forwardRef(p3);function x3({title:e,titleId:r,...t},n){return ue.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?ue.createElement("title",{id:r},e):null,ue.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 1.5H8.25A2.25 2.25 0 0 0 6 3.75v16.5a2.25 2.25 0 0 0 2.25 2.25h7.5A2.25 2.25 0 0 0 18 20.25V3.75a2.25 2.25 0 0 0-2.25-2.25H13.5m-3 0V3h3V1.5m-3 0h3m-3 18.75h3"}))}const g3=ue.forwardRef(x3);function v3({title:e,titleId:r,...t},n){return ue.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?ue.createElement("title",{id:r},e):null,ue.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 10.5V6a3.75 3.75 0 1 0-7.5 0v4.5m11.356-1.993 1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 0 1-1.12-1.243l1.264-12A1.125 1.125 0 0 1 5.513 7.5h12.974c.576 0 1.059.435 1.119 1.007ZM8.625 10.5a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm7.5 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const y3=ue.forwardRef(v3);function b3({title:e,titleId:r,...t},n){return ue.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?ue.createElement("title",{id:r},e):null,ue.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 18.75a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 0 1-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h1.125c.621 0 1.129-.504 1.09-1.124a17.902 17.902 0 0 0-3.213-9.193 2.056 2.056 0 0 0-1.58-.86H14.25M16.5 18.75h-2.25m0-11.177v-.958c0-.568-.422-1.048-.987-1.106a48.554 48.554 0 0 0-10.026 0 1.106 1.106 0 0 0-.987 1.106v7.635m12-6.677v6.677m0 4.5v-4.5m0 0h-12"}))}const w3=ue.forwardRef(b3);function N3({title:e,titleId:r,...t},n){return ue.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?ue.createElement("title",{id:r},e):null,ue.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"}))}const j3=ue.forwardRef(N3);function S3(){const e=[{icon:y3,title:"Reach Thousands of Customers",description:"Get your products in front of 4,320+ active shoppers looking for African groceries."},{icon:m3,title:"Grow Your Business Online",description:"Track sales, manage inventory, and grow your revenue with our easy-to-use vendor dashboard."},{icon:g3,title:"Easy Store Management",description:"Manage your store from anywhere with our mobile-friendly vendor dashboard."},{icon:w3,title:"We Handle Delivery",description:"Focus on preparing quality products. Our riders handle pickup and delivery to customers."},{icon:j3,title:"Dedicated Support",description:"24/7 support to help you succeed. We're here to answer questions and solve problems."},{icon:bh,title:"Verified & Trusted",description:"Join a trusted marketplace where quality vendors are verified and customer trust is high."}],r=[{number:1,title:"Submit Application",description:"Fill out the vendor application form with your business details and documents.",color:"from-green-500 to-green-600"},{number:2,title:"Verification Process",description:"Our team reviews your application and verifies your business credentials (1-3 business days).",color:"from-yellow-500 to-yellow-600"},{number:3,title:"Set Up Your Store",description:"Once approved, set up your store profile, add products, and configure delivery settings.",color:"from-green-600 to-green-700"},{number:4,title:"Start Selling",description:"Go live and start receiving orders from customers in your area!",color:"from-yellow-600 to-yellow-700"}],t=["Valid business registration or tax ID","Proof of address (business location)","Food safety/handling certification (for food vendors)","Bank account for receiving payments","High-quality photos of your products","Commitment to quality and customer service"],n=[{q:"How much does it cost to join?",a:"Joining AfriMercato is free! We charge a small commission (12-15%) on each sale to cover platform costs, payment processing, and support."},{q:"How long does verification take?",a:"Verification typically takes 1-3 business days. We'll review your documents and get back to you via email."},{q:"What products can I sell?",a:"You can sell fresh produce, meats, dairy, African foods, spices, grains, and packaged goods. All products must meet UK food safety standards."},{q:"How do I receive payments?",a:"Payments are processed through Paystack and deposited directly to your bank account weekly."},{q:"Can I manage multiple stores?",a:"Yes! You can manage multiple store locations from a single vendor account."}];return a.jsxs("div",{className:"min-h-screen bg-white",children:[a.jsx("nav",{className:"bg-white border-b border-gray-200 sticky top-0 z-50 shadow-sm",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:a.jsxs("div",{className:"flex justify-between items-center h-16",children:[a.jsxs(ft,{to:"/",className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-green-600 to-yellow-500 rounded-lg flex items-center justify-center",children:a.jsx("span",{className:"text-white font-bold text-lg",children:"ðŸ›’"})}),a.jsxs("span",{className:"text-xl font-bold text-gray-900",children:["Afri",a.jsx("span",{className:"text-green-600",children:"Hub"})]})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(ft,{to:"/",className:"text-gray-600 hover:text-green-600",children:"Home"}),a.jsx(ft,{to:"/login",className:"text-green-600 hover:text-green-700 font-medium",children:"Vendor Sign In"})]})]})})}),a.jsx("section",{className:"bg-gradient-to-br from-green-600 via-green-700 to-yellow-500 py-20",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 text-center",children:[a.jsx(nt.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-4xl sm:text-5xl lg:text-6xl font-bold text-white mb-6",children:"Grow Your Food Business with AfriMercato"}),a.jsx(nt.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"text-xl text-white/95 mb-8 max-w-3xl mx-auto",children:"Join 4,320+ vendors already selling African groceries and reaching thousands of customers across the UK."}),a.jsxs(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"flex flex-col sm:flex-row gap-4 justify-center",children:[a.jsx(ft,{to:"/register?role=vendor",className:"bg-yellow-400 text-gray-900 hover:bg-yellow-300 px-10 py-4 rounded-xl font-bold text-lg shadow-2xl inline-flex items-center justify-center gap-2",children:"Apply Now â†’"}),a.jsx("a",{href:"#how-it-works",className:"bg-white/10 backdrop-blur text-white hover:bg-white/20 px-10 py-4 rounded-xl font-bold text-lg border-2 border-white/30 inline-flex items-center justify-center",children:"Learn More"})]}),a.jsx("div",{className:"grid grid-cols-3 gap-8 max-w-3xl mx-auto mt-16",children:[{value:"4,320+",label:"Active Vendors"},{value:"Â£2.5M+",label:"Monthly Sales"},{value:"98%",label:"Satisfaction Rate"}].map((s,o)=>a.jsxs(nt.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:.3+o*.1},className:"text-center",children:[a.jsx("div",{className:"text-3xl sm:text-4xl font-bold text-white mb-2",children:s.value}),a.jsx("div",{className:"text-sm text-white/80",children:s.label})]},o))})]})}),a.jsx("section",{className:"py-20 bg-gray-50",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[a.jsxs("div",{className:"text-center mb-12",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-4",children:"Why Sell on AfriMercato?"}),a.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Everything you need to run a successful online grocery business"})]}),a.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-8",children:e.map((s,o)=>a.jsxs(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:o*.1},className:"bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all",children:[a.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-green-500 to-green-700 rounded-xl flex items-center justify-center mb-4",children:a.jsx(s.icon,{className:"w-8 h-8 text-white"})}),a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:s.title}),a.jsx("p",{className:"text-gray-600",children:s.description})]},o))})]})}),a.jsx("section",{id:"how-it-works",className:"py-20",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[a.jsxs("div",{className:"text-center mb-12",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-4",children:"How to Get Started"}),a.jsx("p",{className:"text-lg text-gray-600",children:"Simple 4-step process to start selling"})]}),a.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-8",children:r.map((s,o)=>a.jsxs(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:o*.1},className:"text-center",children:[a.jsx("div",{className:`w-20 h-20 bg-gradient-to-br ${s.color} rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg`,children:a.jsx("span",{className:"text-3xl font-bold text-white",children:s.number})}),a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:s.title}),a.jsx("p",{className:"text-gray-600 text-sm",children:s.description})]},o))})]})}),a.jsx("section",{className:"py-20 bg-gray-50",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[a.jsxs("div",{className:"text-center mb-12",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-4",children:"What You'll Need"}),a.jsx("p",{className:"text-lg text-gray-600",children:"Requirements for vendor verification"})]}),a.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:a.jsx("ul",{className:"space-y-4",children:t.map((s,o)=>a.jsxs("li",{className:"flex items-start gap-3",children:[a.jsx(bh,{className:"w-6 h-6 text-green-600 flex-shrink-0 mt-0.5"}),a.jsx("span",{className:"text-gray-700",children:s})]},o))})})]})}),a.jsx("section",{className:"py-20",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[a.jsx("div",{className:"text-center mb-12",children:a.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-4",children:"Frequently Asked Questions"})}),a.jsx("div",{className:"space-y-6",children:n.map((s,o)=>a.jsxs(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:o*.1},className:"bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition-all",children:[a.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:s.q}),a.jsx("p",{className:"text-gray-600",children:s.a})]},o))})]})}),a.jsx("section",{className:"bg-gradient-to-r from-green-600 via-green-700 to-yellow-500 py-20",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-4 text-center",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-white mb-6",children:"Ready to Start Selling?"}),a.jsx("p",{className:"text-xl text-white/95 mb-8",children:"Join thousands of vendors growing their business on AfriMercato"}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[a.jsx(ft,{to:"/register?role=vendor",className:"bg-yellow-400 text-gray-900 hover:bg-yellow-300 px-10 py-4 rounded-xl font-bold text-lg shadow-2xl inline-flex items-center justify-center gap-2",children:"Apply as Vendor â†’"}),a.jsx(ft,{to:"/login",className:"bg-white text-green-700 hover:bg-gray-100 px-10 py-4 rounded-xl font-bold text-lg shadow-2xl inline-flex items-center justify-center",children:"Already a Vendor? Sign In"})]})]})}),a.jsx("footer",{className:"bg-gray-900 text-gray-300 py-12",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-8",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-bold mb-4",children:"AfriMercato"}),a.jsx("p",{className:"text-sm",children:"African groceries delivered to your door across the UK."})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-bold mb-4",children:"For Customers"}),a.jsxs("ul",{className:"space-y-2 text-sm",children:[a.jsx("li",{children:a.jsx(ft,{to:"/",className:"hover:text-yellow-400",children:"Browse Stores"})}),a.jsx("li",{children:a.jsx(ft,{to:"/#how-it-works",className:"hover:text-yellow-400",children:"How It Works"})})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-bold mb-4",children:"For Partners"}),a.jsxs("ul",{className:"space-y-2 text-sm",children:[a.jsx("li",{children:a.jsx(ft,{to:"/partner",className:"hover:text-yellow-400",children:"Become a Vendor"})}),a.jsx("li",{children:a.jsx(ft,{to:"/register?role=rider",className:"hover:text-yellow-400",children:"Become a Rider"})})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-bold mb-4",children:"Company"}),a.jsxs("ul",{className:"space-y-2 text-sm",children:[a.jsx("li",{children:a.jsx("a",{href:"#",className:"hover:text-yellow-400",children:"About"})}),a.jsx("li",{children:a.jsx("a",{href:"#",className:"hover:text-yellow-400",children:"Contact"})})]})]})]}),a.jsx("div",{className:"border-t border-gray-800 mt-8 pt-8 text-center text-sm",children:a.jsx("p",{children:"Â© 2025 AfriMercato. All rights reserved."})})]})})]})}function _3(){const[e]=fm(),r=e.get("location")||"",t=pa(),[n,s]=ue.useState([]),[o,l]=ue.useState(!0),[c,d]=ue.useState(r);ue.useEffect(()=>{h()},[r]);const h=async()=>{var x;try{l(!0);const m=await $m(r,50);m.success&&((x=m.data)!=null&&x.vendors)&&m.data.vendors.length>0?s(m.data.vendors):s(u(r))}catch(m){console.log("Using sample stores:",m.message),s(u(r))}finally{l(!1)}},u=x=>{const m=[{id:1,name:"Green Valley Farms",category:"Fresh Produce",image:"https://images.unsplash.com/photo-1542838132-92c53300491e?w=600",rating:4.8,deliveryTime:"20-30 min",minOrder:"Â£10",tags:["Vegetables","Fruits","Organic"],location:"London",address:"123 High Street, London E1 6AN"},{id:2,name:"African Spice Market",category:"African Groceries",image:"https://images.unsplash.com/photo-1488459716781-31db52582fe9?w=600",rating:4.9,deliveryTime:"25-35 min",minOrder:"Â£15",tags:["Spices","Grains","Authentic"],location:"London",address:"45 Peckham High St, London SE15"},{id:3,name:"Lagos Kitchen Store",category:"Nigerian Foods",image:"https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=600",rating:4.9,deliveryTime:"25-35 min",minOrder:"Â£15",tags:["Nigerian","Palm Oil","Cassava"],location:"London",address:"78 Brixton Road, London SW9"},{id:4,name:"Tropical Fruits Hub",category:"Exotic Fruits",image:"https://images.unsplash.com/photo-1619566636858-adf3ef46400b?w=600",rating:4.8,deliveryTime:"20-30 min",minOrder:"Â£12",tags:["Plantain","Mango","Yam"],location:"London",address:"12 Ridley Road Market, London E8"},{id:5,name:"Hackney Fresh Foods",category:"Fresh Produce",image:"https://images.unsplash.com/photo-1542838132-92c53300491e?w=600",rating:4.7,deliveryTime:"20-30 min",minOrder:"Â£10",tags:["Vegetables","Fruits"],location:"London",address:"Hackney Market, London E8 5RT"},{id:6,name:"Manchester African Market",category:"African Groceries",image:"https://images.unsplash.com/photo-1488459716781-31db52582fe9?w=600",rating:4.6,deliveryTime:"30-40 min",minOrder:"Â£12",tags:["African","Spices","Grains"],location:"Manchester",address:"34 Cheetham Hill Road, Manchester M8"},{id:7,name:"Moss Side Grocers",category:"Fresh Produce",image:"https://images.unsplash.com/photo-1542838132-92c53300491e?w=600",rating:4.5,deliveryTime:"25-35 min",minOrder:"Â£10",tags:["Vegetables","Fruits"],location:"Manchester",address:"56 Great Western Street, Manchester M14"},{id:8,name:"Afro-Caribbean Store MCR",category:"Caribbean Foods",image:"https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=600",rating:4.7,deliveryTime:"30-40 min",minOrder:"Â£15",tags:["Caribbean","Plantain","Rice"],location:"Manchester",address:"89 Princess Road, Manchester M14"},{id:9,name:"Handsworth African Foods",category:"African Groceries",image:"https://images.unsplash.com/photo-1488459716781-31db52582fe9?w=600",rating:4.8,deliveryTime:"20-30 min",minOrder:"Â£10",tags:["African","Fresh","Halal"],location:"Birmingham",address:"23 Soho Road, Birmingham B21"},{id:10,name:"Birmingham Tropical Market",category:"Tropical Foods",image:"https://images.unsplash.com/photo-1619566636858-adf3ef46400b?w=600",rating:4.6,deliveryTime:"25-35 min",minOrder:"Â£12",tags:["Plantain","Yam","Cassava"],location:"Birmingham",address:"45 Stratford Road, Birmingham B11"},{id:11,name:"Bristol African Store",category:"African Groceries",image:"https://images.unsplash.com/photo-1488459716781-31db52582fe9?w=600",rating:4.7,deliveryTime:"30-40 min",minOrder:"Â£12",tags:["African","Caribbean","Fresh"],location:"Bristol",address:"12 Stapleton Road, Bristol BS5"},{id:12,name:"St Pauls Fresh Market",category:"Fresh Produce",image:"https://images.unsplash.com/photo-1542838132-92c53300491e?w=600",rating:4.5,deliveryTime:"25-35 min",minOrder:"Â£10",tags:["Vegetables","Fruits"],location:"Bristol",address:"34 Grosvenor Road, Bristol BS2"},{id:13,name:"Leeds African Groceries",category:"African Foods",image:"https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=600",rating:4.6,deliveryTime:"30-40 min",minOrder:"Â£12",tags:["African","Spices","Grains"],location:"Leeds",address:"67 Harehills Lane, Leeds LS8"},{id:14,name:"Chapeltown Fresh Foods",category:"Fresh Produce",image:"https://images.unsplash.com/photo-1542838132-92c53300491e?w=600",rating:4.5,deliveryTime:"25-35 min",minOrder:"Â£10",tags:["Vegetables","Fruits"],location:"Leeds",address:"89 Chapeltown Road, Leeds LS7"},{id:15,name:"Liverpool African Market",category:"African Groceries",image:"https://images.unsplash.com/photo-1488459716781-31db52582fe9?w=600",rating:4.7,deliveryTime:"30-40 min",minOrder:"Â£15",tags:["African","Caribbean","Halal"],location:"Liverpool",address:"45 Granby Street, Liverpool L8"},{id:16,name:"Toxteth Tropical Foods",category:"Tropical Foods",image:"https://images.unsplash.com/photo-1619566636858-adf3ef46400b?w=600",rating:4.6,deliveryTime:"25-35 min",minOrder:"Â£12",tags:["Plantain","Yam"],location:"Liverpool",address:"23 Upper Parliament Street, Liverpool L8"}];if(x){const y=m.filter(v=>v.location.toLowerCase().includes(x.toLowerCase())||v.address.toLowerCase().includes(x.toLowerCase()));return y.length>0?y:m.slice(0,6)}return m},g=x=>{x.preventDefault(),c.trim()&&t(`/stores?location=${encodeURIComponent(c)}`)};return a.jsxs("div",{className:"min-h-screen bg-white",children:[a.jsx("nav",{className:"bg-white border-b border-gray-200 sticky top-0 z-50 shadow-sm",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:a.jsxs("div",{className:"flex justify-between items-center h-16",children:[a.jsxs(ft,{to:"/",className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-green-600 to-yellow-500 rounded-lg flex items-center justify-center",children:a.jsx("span",{className:"text-white font-bold text-lg",children:"ðŸ›’"})}),a.jsxs("span",{className:"text-xl font-bold text-gray-900",children:["Afri",a.jsx("span",{className:"text-green-600",children:"Hub"})]})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(ft,{to:"/",className:"text-gray-600 hover:text-green-600",children:"Home"}),a.jsx(ft,{to:"/partner",className:"text-gray-600 hover:text-green-600",children:"Partner With Us"}),a.jsx(ft,{to:"/login",className:"text-green-600 hover:text-green-700 font-medium",children:"Sign In"})]})]})})}),a.jsx("section",{className:"bg-gradient-to-br from-green-600 to-green-700 py-12",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[a.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-white mb-4 text-center",children:"Find African Stores Near You"}),a.jsxs("form",{onSubmit:g,className:"max-w-2xl mx-auto bg-white rounded-2xl shadow-2xl p-3 flex flex-col sm:flex-row gap-3",children:[a.jsxs("div",{className:"flex-1 flex items-center gap-3 bg-gray-50 rounded-xl px-4 py-3",children:[a.jsx(pc,{className:"w-6 h-6 text-green-600 flex-shrink-0"}),a.jsx("input",{type:"text",value:c,onChange:x=>d(x.target.value),placeholder:"Enter location (London, Manchester, Birmingham...)",className:"flex-1 bg-transparent border-none outline-none text-gray-900 placeholder-gray-500"})]}),a.jsxs("button",{type:"submit",className:"bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white px-8 py-3 rounded-xl font-bold shadow-lg flex items-center justify-center gap-2",children:[a.jsx(Ad,{className:"w-5 h-5"}),"Search"]})]})]})}),a.jsx("section",{className:"py-12",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:[a.jsxs("div",{className:"mb-8",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:r?`Stores in ${r}`:"All Stores"}),a.jsx("p",{className:"text-gray-600",children:o?"Searching...":`${n.length} stores found`})]}),o&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),a.jsx("p",{className:"text-gray-600 mt-4",children:"Finding stores..."})]}),!o&&n.length===0&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"text-6xl mb-4",children:"ðŸ˜”"}),a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"No stores found in this area"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"Try searching for London, Manchester, or Birmingham"}),a.jsx(ft,{to:"/",className:"text-green-600 hover:text-green-700 font-semibold",children:"â† Back to Home"})]}),!o&&n.length>0&&a.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(x=>{var m;return a.jsxs(nt.div,{whileHover:{y:-5},className:"bg-white rounded-2xl shadow-lg hover:shadow-xl border border-gray-100 overflow-hidden cursor-pointer transition-all",onClick:()=>t(`/store/${x.id}`),children:[a.jsxs("div",{className:"relative h-48",children:[a.jsx("img",{src:x.image,alt:x.name,className:"w-full h-full object-cover"}),a.jsxs("div",{className:"absolute top-3 right-3 bg-white px-3 py-1 rounded-full shadow-md flex items-center gap-1",children:[a.jsx(kd,{className:"w-4 h-4 text-yellow-500"}),a.jsx("span",{className:"font-bold text-gray-900",children:x.rating})]})]}),a.jsxs("div",{className:"p-5",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:x.name}),a.jsx("p",{className:"text-sm text-gray-600 mb-1",children:x.category}),a.jsxs("p",{className:"text-xs text-gray-500 mb-3 flex items-center gap-1",children:[a.jsx(pc,{className:"w-3 h-3"}),x.address||x.location]}),a.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:(m=x.tags)==null?void 0:m.slice(0,3).map((y,v)=>a.jsx("span",{className:"bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-xs font-medium",children:y},v))}),a.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 pt-3 border-t",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(_d,{className:"w-4 h-4"}),a.jsx("span",{children:x.deliveryTime})]}),a.jsxs("div",{className:"font-semibold text-gray-900",children:["Min. ",x.minOrder]})]})]})]},x.id)})})]})})]})}function A3(){const{vendorId:e}=Z0(),r=pa(),[t,n]=ue.useState(null),[s,o]=ue.useState([]),[l,c]=ue.useState(["All"]),[d,h]=ue.useState("All"),[u,g]=ue.useState(!0),[x,m]=ue.useState(null),[y,v]=ue.useState([]),[j,w]=ue.useState(!1),[N,_]=ue.useState("");ue.useEffect(()=>{C()},[e]);const C=async()=>{var k;try{g(!0),m(null);const T=await Ym(e);n(T.data||T);const W=await Xm(e),G=((k=W.data)==null?void 0:k.products)||W.products||[];o(G);const de=["All",...new Set(G.map(J=>J.category).filter(Boolean))];c(de)}catch(T){console.error("Error fetching vendor:",T),m(T.message||"Failed to load store")}finally{g(!1)}},M=k=>{const T=y.find(W=>W._id===k._id);v(T?y.map(W=>W._id===k._id?{...W,quantity:W.quantity+1}:W):[...y,{...k,quantity:1}]),w(!0)},D=(k,T)=>{T<=0?L(k):v(y.map(W=>W._id===k?{...W,quantity:T}:W))},L=k=>{v(y.filter(T=>T._id!==k))},E=y.reduce((k,T)=>k+T.price*T.quantity,0),P=y.reduce((k,T)=>k+T.quantity,0),H=s.filter(k=>{const T=d==="All"||k.category===d,W=k.name.toLowerCase().includes(N.toLowerCase());return T&&W&&k.inStock});return u?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-4 border-b-4 border-[#FFB300] mx-auto"}),a.jsx("p",{className:"text-gray-600 mt-4",children:"Loading store..."})]})}):x||!t?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-2xl mb-4",children:"ðŸ˜”"}),a.jsx("p",{className:"text-gray-600 mb-4",children:x||"Store not found"}),a.jsx("button",{onClick:()=>r("/stores"),className:"bg-[#FFB300] text-white px-6 py-2 rounded-lg hover:bg-[#FFA726] transition",children:"Browse All Stores"})]})}):a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("header",{className:"bg-white border-b sticky top-0 z-40 shadow-sm",children:a.jsx("div",{className:"container mx-auto px-6 py-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("button",{onClick:()=>r(-1),className:"text-gray-600 hover:text-gray-900",children:"â¬…ï¸ Go Back"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-2xl",children:"ðŸ›’"}),a.jsx("span",{className:"text-xl font-bold text-gray-900",children:"AfriMercato"})]})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("button",{onClick:()=>r("/login"),className:"text-gray-600 hover:text-gray-900",children:"ðŸ‘¤ Account"}),a.jsxs("button",{onClick:()=>w(!j),className:"relative bg-[#FFB300] text-white px-4 py-2 rounded-lg hover:bg-[#FFA726] transition",children:["ðŸ›’ Cart",P>0&&a.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold",children:P})]})]})]})})}),a.jsx("div",{className:"bg-gradient-to-r from-[#E0F7F4] to-[#FFF4E0] py-12",children:a.jsx("div",{className:"container mx-auto px-6",children:a.jsxs("div",{className:"grid md:grid-cols-2 gap-8 items-center",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-5xl font-bold text-gray-900 mb-2",children:t.storeName||t.businessName}),a.jsx("p",{className:"text-2xl text-gray-600 mb-4",children:"Got You."}),a.jsx("p",{className:"text-lg text-[#00897B] font-semibold mb-6",children:"Save up to 60% off on your first order"}),a.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-600",children:[a.jsx("span",{children:"ðŸ›ï¸ Shopping Method: In-Shopping, Delivery"}),a.jsx("span",{children:"âš¡ Deliveries in 20-30 mins"}),a.jsxs("span",{children:["ðŸ“ž ",t.phone||"+44 - 2071 - 234567"]})]})]}),a.jsx("div",{className:"hidden md:block",children:a.jsx("img",{src:Ap(t),alt:t.storeName||t.businessName,className:"rounded-2xl shadow-xl w-full h-64 object-cover"})})]})})}),a.jsx("div",{className:"bg-white border-b sticky top-16 z-30",children:a.jsx("div",{className:"container mx-auto px-6 py-4",children:a.jsxs("div",{className:"flex items-center justify-between gap-4",children:[a.jsx("div",{className:"flex gap-4 overflow-x-auto",children:l.map(k=>a.jsx("button",{onClick:()=>h(k),className:`px-4 py-2 font-semibold whitespace-nowrap transition ${d===k?"text-[#FFB300] border-b-2 border-[#FFB300]":"text-gray-600 hover:text-gray-900"}`,children:k},k))}),a.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg px-4 py-2 min-w-[200px]",children:[a.jsx("span",{children:"ðŸ”"}),a.jsx("input",{type:"text",placeholder:"Search products...",value:N,onChange:k=>_(k.target.value),className:"bg-transparent outline-none flex-1"})]})]})})}),a.jsxs("div",{className:"container mx-auto px-6 py-8",children:[a.jsxs("div",{className:"mb-12",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:d==="All"?"All Products":d}),H.length===0?a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-gray-600",children:"No products found"})}):a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:H.map(k=>a.jsx(k3,{product:k,onAddToCart:()=>M(k)},k._id))})]}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mb-12",children:[a.jsxs("div",{className:"bg-gradient-to-r from-[#00897B] to-[#00695C] text-white p-6 rounded-xl",children:[a.jsx("h3",{className:"text-xl font-bold mb-2",children:"Free delivery"}),a.jsx("p",{className:"mb-4",children:"over Â£50"}),a.jsx("button",{className:"bg-white text-[#00897B] px-4 py-2 rounded-lg font-semibold hover:bg-gray-100 transition",children:"Shop Now â†’"})]}),a.jsxs("div",{className:"bg-gradient-to-r from-[#FFB300] to-[#FFA726] text-white p-6 rounded-xl",children:[a.jsx("h3",{className:"text-xl font-bold mb-2",children:"60% off"}),a.jsx("p",{className:"mb-4",children:"Organic Food"}),a.jsx("button",{className:"bg-white text-[#FFB300] px-4 py-2 rounded-lg font-semibold hover:bg-gray-100 transition",children:"Order Now â†’"})]}),a.jsxs("div",{className:"bg-gradient-to-r from-[#00897B] to-[#00695C] text-white p-6 rounded-xl",children:[a.jsx("h3",{className:"text-xl font-bold mb-2",children:"Free delivery"}),a.jsx("p",{className:"mb-4",children:"Shop Â£50 get..."}),a.jsx("button",{className:"bg-white text-[#00897B] px-4 py-2 rounded-lg font-semibold hover:bg-gray-100 transition",children:"Shop Now â†’"})]})]})]}),j&&a.jsxs("div",{className:"fixed inset-0 z-50 flex",children:[a.jsx("div",{onClick:()=>w(!1),className:"flex-1 bg-black/50"}),a.jsx("div",{className:"w-full max-w-md bg-white shadow-2xl overflow-y-auto",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Shopping Cart"}),a.jsx("button",{onClick:()=>w(!1),className:"text-gray-400 hover:text-gray-600 text-2xl",children:"âœ•"})]}),y.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("p",{className:"text-2xl mb-2",children:"ðŸ›’"}),a.jsx("p",{className:"text-gray-600",children:"Your cart is empty"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"space-y-4 mb-6",children:y.map(k=>a.jsxs("div",{className:"flex gap-4 border-b pb-4",children:[a.jsx("img",{src:ed(k),alt:k.name,className:"w-20 h-20 object-cover rounded-lg",onError:T=>{T.target.src="https://images.unsplash.com/photo-1542838132-92c53300491e?w=200&q=80"}}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:k.name}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Â£",k.price.toFixed(2)]}),a.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.jsx("button",{onClick:()=>D(k._id,k.quantity-1),className:"w-6 h-6 bg-gray-200 rounded hover:bg-gray-300 transition",children:"-"}),a.jsx("span",{className:"font-semibold",children:k.quantity}),a.jsx("button",{onClick:()=>D(k._id,k.quantity+1),className:"w-6 h-6 bg-gray-200 rounded hover:bg-gray-300 transition",children:"+"}),a.jsx("button",{onClick:()=>L(k._id),className:"ml-auto text-red-500 hover:text-red-700",children:"ðŸ—‘ï¸"})]})]})]},k._id))}),a.jsxs("div",{className:"border-t pt-4 mb-6",children:[a.jsxs("div",{className:"flex justify-between mb-2",children:[a.jsx("span",{className:"text-gray-600",children:"Subtotal:"}),a.jsxs("span",{className:"font-semibold",children:["Â£",E.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between mb-2",children:[a.jsx("span",{className:"text-gray-600",children:"Delivery:"}),a.jsxs("span",{className:"font-semibold",children:["Â£",E>=50?"0.00":"5.00"]})]}),a.jsxs("div",{className:"flex justify-between text-xl font-bold border-t pt-2",children:[a.jsx("span",{children:"Total:"}),a.jsxs("span",{children:["Â£",(E+(E>=50?0:5)).toFixed(2)]})]})]}),a.jsx("button",{onClick:()=>{localStorage.setItem("cart",JSON.stringify(y)),r("/checkout")},className:"w-full bg-gradient-to-r from-[#FFB300] to-[#FFA726] text-white py-4 rounded-lg font-bold text-lg hover:shadow-lg transition",children:"Proceed to Checkout"})]})]})})]}),a.jsx("footer",{className:"bg-[#1A1A1A] text-white py-8",children:a.jsx("div",{className:"container mx-auto px-6 text-center",children:a.jsx("p",{className:"text-gray-400",children:"Â© 2025 AfriMercato. All rights reserved."})})})]})}function k3({product:e,onAddToCart:r}){const[t,n]=ue.useState(!1),s=()=>{r(),n(!0),setTimeout(()=>n(!1),1e3)};return a.jsxs("div",{className:"bg-white rounded-xl shadow-md hover:shadow-xl transition overflow-hidden group",children:[a.jsxs("div",{className:"relative h-40 bg-gray-100 overflow-hidden",children:[a.jsx("img",{src:ed(e),alt:e.name,className:"w-full h-full object-cover group-hover:scale-110 transition duration-300",onError:o=>{o.target.src="https://images.unsplash.com/photo-1542838132-92c53300491e?w=400&q=80"}}),e.discount>0&&a.jsxs("span",{className:"absolute top-2 right-2 bg-red-500 text-white px-2 py-1 rounded-full text-xs font-bold",children:["-",e.discount,"%"]})]}),a.jsxs("div",{className:"p-4",children:[a.jsx("p",{className:"text-xs text-gray-500 mb-1",children:e.category}),a.jsx("h3",{className:"font-semibold text-gray-900 mb-2 truncate",children:e.name}),a.jsx("div",{className:"flex items-center gap-1 mb-2",children:[...Array(5)].map((o,l)=>a.jsx("span",{className:l<4?"text-yellow-400 text-sm":"text-gray-300 text-sm",children:"â­"},l))}),a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.discount>0&&a.jsxs("span",{className:"text-sm text-gray-400 line-through",children:["Â£",(e.price/(1-e.discount/100)).toFixed(2)]}),a.jsxs("span",{className:"text-lg font-bold text-[#00B207]",children:["Â£",e.price.toFixed(2)]})]}),a.jsx("button",{onClick:s,className:`w-full py-2 rounded-lg font-semibold transition ${t?"bg-green-500 text-white":"bg-gradient-to-r from-[#FFB300] to-[#FFA726] text-white hover:shadow-lg"}`,children:t?"âœ“ Added!":"ðŸ›’ Add"})]})]})}function T3(){const e=pa(),[r,t]=ue.useState(!0),[n,s]=ue.useState({activeOrders:0,totalOrders:0,wishlistItems:0,rewardPoints:0}),[o,l]=ue.useState([]),[c,d]=ue.useState([]);ue.useEffect(()=>{h()},[]);const h=async()=>{try{t(!0);const[x,m,y]=await Promise.all([h0.getDashboardStats(),h0.getRecentOrders({limit:5}),h0.getRecommendedProducts({limit:4})]);x.success&&s(x.data),m.success&&l(m.data.orders||m.data||[]),y.success&&d(y.data.products||y.data||[])}catch(x){console.error("Dashboard error:",x)}finally{t(!1)}},u=x=>({pending:"bg-yellow-100 text-yellow-800",confirmed:"bg-blue-100 text-blue-800",preparing:"bg-orange-100 text-orange-800","out-for-delivery":"bg-purple-100 text-purple-800",delivered:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"})[x]||"bg-gray-100 text-gray-800",g=[{icon:"ðŸ›ï¸",title:"Browse Products",description:"Explore our fresh products",action:()=>e("/products"),color:"from-blue-500 to-blue-600"},{icon:"ðŸ“",title:"Find Vendors",description:"Discover local stores",action:()=>e("/vendors"),color:"from-green-500 to-green-600"},{icon:"ðŸ“¦",title:"Track Orders",description:"Check delivery status",action:()=>e("/orders"),color:"from-purple-500 to-purple-600"},{icon:"â¤ï¸",title:"Wishlist",description:"View saved items",action:()=>e("/wishlist"),color:"from-red-500 to-red-600"}];return r?a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-afri-green mx-auto mb-4"}),a.jsx("p",{className:"text-afri-gray-600",children:"Loading your dashboard..."})]})}):a.jsxs("div",{className:"min-h-screen bg-gray-50 pb-12",children:[a.jsx("div",{className:"bg-gradient-to-r from-afri-green to-afri-green-dark text-white py-8 animate-slideDown",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Welcome Back! ðŸ‘‹"}),a.jsx("p",{className:"text-afri-green-light",children:"Here's what's happening with your orders"})]})}),a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 -mt-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 transform hover:scale-105 transition-all duration-300 animate-fadeIn",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-yellow-400 to-yellow-500 rounded-lg flex items-center justify-center text-2xl shadow-lg",children:"ðŸ“¦"}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.activeOrders}),a.jsx("p",{className:"text-sm text-gray-500",children:"Active Orders"})]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-gradient-to-r from-yellow-400 to-yellow-500 h-2 rounded-full",style:{width:"70%"}})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 transform hover:scale-105 transition-all duration-300 animate-fadeIn",style:{animationDelay:"100ms"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-400 to-blue-500 rounded-lg flex items-center justify-center text-2xl shadow-lg",children:"ðŸ“Š"}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.totalOrders}),a.jsx("p",{className:"text-sm text-gray-500",children:"Total Orders"})]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-gradient-to-r from-blue-400 to-blue-500 h-2 rounded-full",style:{width:"100%"}})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 transform hover:scale-105 transition-all duration-300 animate-fadeIn",style:{animationDelay:"200ms"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-red-400 to-red-500 rounded-lg flex items-center justify-center text-2xl shadow-lg",children:"â¤ï¸"}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.wishlistItems}),a.jsx("p",{className:"text-sm text-gray-500",children:"Wishlist Items"})]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-gradient-to-r from-red-400 to-red-500 h-2 rounded-full",style:{width:"85%"}})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 transform hover:scale-105 transition-all duration-300 animate-fadeIn",style:{animationDelay:"300ms"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-400 to-purple-500 rounded-lg flex items-center justify-center text-2xl shadow-lg",children:"â­"}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.rewardPoints}),a.jsx("p",{className:"text-sm text-gray-500",children:"Reward Points"})]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-gradient-to-r from-purple-400 to-purple-500 h-2 rounded-full",style:{width:"60%"}})})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-8 animate-slideUp",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Quick Actions"}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:g.map((x,m)=>a.jsxs("button",{onClick:x.action,className:"flex flex-col items-center p-6 bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl hover:shadow-xl transition-all duration-300 transform hover:scale-105 group",children:[a.jsx("div",{className:`w-16 h-16 bg-gradient-to-r ${x.color} rounded-full flex items-center justify-center text-3xl mb-3 shadow-lg group-hover:scale-110 transition-transform`,children:x.icon}),a.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:x.title}),a.jsx("p",{className:"text-sm text-gray-500 text-center",children:x.description})]},m))})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[a.jsxs("div",{className:"lg:col-span-2 bg-white rounded-xl shadow-lg p-6 animate-fadeIn",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Recent Orders"}),a.jsx("button",{onClick:()=>e("/orders"),className:"text-afri-green hover:text-afri-green-dark font-semibold text-sm",children:"View All â†’"})]}),o.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“¦"}),a.jsx("p",{className:"text-gray-500 mb-4",children:"No orders yet"}),a.jsx("button",{onClick:()=>e("/products"),className:"px-6 py-2 bg-gradient-to-r from-afri-green to-afri-green-dark text-white rounded-lg font-semibold hover:shadow-lg transition-all",children:"Start Shopping"})]}):a.jsx("div",{className:"space-y-4",children:o.map((x,m)=>{var y,v,j,w;return a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>e(`/orders/${x._id}`),children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"w-12 h-12 bg-gradient-to-br from-afri-green to-afri-green-dark rounded-lg flex items-center justify-center text-white font-bold",children:["#",((y=x.orderNumber)==null?void 0:y.slice(-4))||"N/A"]}),a.jsxs("div",{children:[a.jsxs("p",{className:"font-semibold text-gray-900",children:[((v=x.items)==null?void 0:v.length)||0," items"]}),a.jsx("p",{className:"text-sm text-gray-500",children:new Date(x.createdAt).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"font-bold text-gray-900",children:["Â£",((j=x.totalAmount)==null?void 0:j.toFixed(2))||"0.00"]}),a.jsx("span",{className:`text-xs px-3 py-1 rounded-full font-semibold ${u(x.status)}`,children:((w=x.status)==null?void 0:w.replace(/-/g," ").replace(/\b\w/g,N=>N.toUpperCase()))||"Pending"})]})]},x._id||m)})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 animate-fadeIn",style:{animationDelay:"200ms"},children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Recommended for You"}),c.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"text-5xl mb-3",children:"ðŸ›ï¸"}),a.jsx("p",{className:"text-gray-500 text-sm",children:"No recommendations yet"})]}):a.jsx("div",{className:"space-y-4",children:c.map((x,m)=>{var y;return a.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>e(`/products/${x._id}`),children:[a.jsx("img",{src:ed(x),alt:x.name,className:"w-16 h-16 rounded-lg object-cover"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-gray-900 text-sm line-clamp-1",children:x.name}),a.jsx("p",{className:"text-xs text-gray-500",children:x.unit||"per item"}),a.jsxs("p",{className:"text-afri-green font-bold mt-1",children:["Â£",((y=x.price)==null?void 0:y.toFixed(2))||"0.00"]})]})]},x._id||m)})}),a.jsx("button",{onClick:()=>e("/products"),className:"w-full mt-4 py-2 bg-gradient-to-r from-afri-green to-afri-green-dark text-white rounded-lg font-semibold hover:shadow-lg transition-all",children:"Browse All Products"})]})]})]}),a.jsx("style",{jsx:!0,children:`
        @keyframes slideDown {
          from {
            opacity: 0;
            transform: translateY(-20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        @keyframes slideUp {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        @keyframes fadeIn {
          from {
            opacity: 0;
          }
          to {
            opacity: 1;
          }
        }

        .animate-slideDown {
          animation: slideDown 0.5s ease-out;
        }

        .animate-slideUp {
          animation: slideUp 0.6s ease-out;
        }

        .animate-fadeIn {
          animation: fadeIn 0.6s ease-out;
        }

        .line-clamp-1 {
          overflow: hidden;
          display: -webkit-box;
          -webkit-line-clamp: 1;
          -webkit-box-orient: vertical;
        }
      `})]})}const C3="https://afrimercato-backend-production-0329.up.railway.app";function E3(){const e=pa(),{isAuthenticated:r}=Ri(),[t,n]=ue.useState([]),[s,o]=ue.useState(1),[l,c]=ue.useState(!1),[d,h]=ue.useState({fullName:"",phone:"",street:"",city:"",postcode:"",instructions:""}),[u,g]=ue.useState({method:"card",saveCard:!1});ue.useEffect(()=>{const w=JSON.parse(localStorage.getItem("cart")||"[]");n(w),w.length===0&&e("/stores"),r||(localStorage.setItem("checkout_redirect","true"),e("/login"))},[r,e]);const x=t.reduce((w,N)=>w+N.price*N.quantity,0),m=x>=50?0:5,y=x+m,v=w=>{w.preventDefault(),o(2)},j=async w=>{w.preventDefault(),c(!0);try{const N={items:t.map(M=>({product:M._id,name:M.name,price:M.price,quantity:M.quantity,unit:M.unit||"piece"})),deliveryAddress:d,payment:{method:u.method,status:"pending"},pricing:{subtotal:x,deliveryFee:m,total:y}},C=await(await fetch(`${C3}/api/checkout/payment/initialize`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("afrimercato_token")}`},body:JSON.stringify(N)})).json();C.success?(localStorage.removeItem("cart"),e(`/order-confirmation/${C.data.order._id}`)):alert("Order failed: "+C.message)}catch(N){console.error("Order error:",N),alert("Failed to place order. Please try again.")}finally{c(!1)}};return t.length===0?null:a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("header",{className:"bg-white border-b sticky top-0 z-40 shadow-sm",children:a.jsx("div",{className:"container mx-auto px-6 py-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-2xl",children:"ðŸ›’"}),a.jsx("span",{className:"text-xl font-bold text-gray-900",children:"AfriMercato Checkout"})]}),a.jsx("button",{onClick:()=>e(-1),className:"text-gray-600 hover:text-gray-900",children:"â¬…ï¸ Back"})]})})}),a.jsx("div",{className:"container mx-auto px-6 py-8",children:a.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[a.jsxs("div",{className:"lg:col-span-2",children:[a.jsxs("div",{className:"flex items-center justify-between mb-8",children:[a.jsxs("div",{className:`flex items-center ${s>=1?"text-green-600":"text-gray-400"}`,children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${s>=1?"bg-green-600 text-white":"bg-gray-200"}`,children:s>1?"âœ“":"1"}),a.jsx("span",{className:"ml-2 font-semibold",children:"Delivery"})]}),a.jsx("div",{className:"flex-1 h-1 bg-gray-200 mx-4"}),a.jsxs("div",{className:`flex items-center ${s>=2?"text-green-600":"text-gray-400"}`,children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${s>=2?"bg-green-600 text-white":"bg-gray-200"}`,children:s>2?"âœ“":"2"}),a.jsx("span",{className:"ml-2 font-semibold",children:"Payment"})]}),a.jsx("div",{className:"flex-1 h-1 bg-gray-200 mx-4"}),a.jsxs("div",{className:`flex items-center ${s>=3?"text-green-600":"text-gray-400"}`,children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${s>=3?"bg-green-600 text-white":"bg-gray-200"}`,children:"3"}),a.jsx("span",{className:"ml-2 font-semibold",children:"Confirm"})]})]}),s===1&&a.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Delivery Address"}),a.jsxs("form",{onSubmit:v,children:[a.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Full Name *"}),a.jsx("input",{type:"text",required:!0,value:d.fullName,onChange:w=>h({...d,fullName:w.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"John Doe"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Phone Number *"}),a.jsx("input",{type:"tel",required:!0,value:d.phone,onChange:w=>h({...d,phone:w.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"+44 7700 900000"})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Street Address *"}),a.jsx("input",{type:"text",required:!0,value:d.street,onChange:w=>h({...d,street:w.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"123 High Street"})]}),a.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"City *"}),a.jsx("input",{type:"text",required:!0,value:d.city,onChange:w=>h({...d,city:w.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"London"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Postcode *"}),a.jsx("input",{type:"text",required:!0,value:d.postcode,onChange:w=>h({...d,postcode:w.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"SW1A 1AA"})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Delivery Instructions (Optional)"}),a.jsx("textarea",{value:d.instructions,onChange:w=>h({...d,instructions:w.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",rows:"3",placeholder:"e.g., Leave at door, Ring doorbell, etc."})]}),a.jsx("button",{type:"submit",className:"w-full bg-gradient-to-r from-green-600 to-green-700 text-white py-3 rounded-lg font-bold text-lg hover:shadow-lg transition",children:"Continue to Payment â†’"})]})]}),s===2&&a.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Payment Method"}),a.jsxs("form",{onSubmit:()=>o(3),children:[a.jsxs("div",{className:"space-y-4 mb-6",children:[a.jsx("div",{onClick:()=>g({...u,method:"card"}),className:`border-2 rounded-lg p-4 cursor-pointer transition ${u.method==="card"?"border-green-600 bg-green-50":"border-gray-200"}`,children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{type:"radio",checked:u.method==="card",onChange:()=>g({...u,method:"card"}),className:"mr-3"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold text-gray-900",children:"ðŸ’³ Card Payment"}),a.jsx("div",{className:"text-sm text-gray-600",children:"Pay securely with Paystack"})]})]})}),a.jsx("div",{onClick:()=>g({...u,method:"cash"}),className:`border-2 rounded-lg p-4 cursor-pointer transition ${u.method==="cash"?"border-green-600 bg-green-50":"border-gray-200"}`,children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{type:"radio",checked:u.method==="cash",onChange:()=>g({...u,method:"cash"}),className:"mr-3"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold text-gray-900",children:"ðŸ’µ Cash on Delivery"}),a.jsx("div",{className:"text-sm text-gray-600",children:"Pay when you receive your order"})]})]})})]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsx("button",{type:"button",onClick:()=>o(1),className:"flex-1 bg-gray-200 text-gray-700 py-3 rounded-lg font-bold hover:bg-gray-300 transition",children:"â† Back"}),a.jsx("button",{type:"button",onClick:()=>o(3),className:"flex-1 bg-gradient-to-r from-green-600 to-green-700 text-white py-3 rounded-lg font-bold hover:shadow-lg transition",children:"Review Order â†’"})]})]})]}),s===3&&a.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Review & Confirm"}),a.jsxs("div",{className:"mb-6 pb-6 border-b",children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Delivery Address"}),a.jsxs("p",{className:"text-gray-700",children:[d.fullName,a.jsx("br",{}),d.phone,a.jsx("br",{}),d.street,a.jsx("br",{}),d.city,", ",d.postcode]}),d.instructions&&a.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[a.jsx("strong",{children:"Instructions:"})," ",d.instructions]}),a.jsx("button",{onClick:()=>o(1),className:"text-green-600 text-sm font-semibold mt-2 hover:underline",children:"Edit"})]}),a.jsxs("div",{className:"mb-6 pb-6 border-b",children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Payment Method"}),a.jsx("p",{className:"text-gray-700",children:u.method==="card"?"ðŸ’³ Card Payment (Paystack)":"ðŸ’µ Cash on Delivery"}),a.jsx("button",{onClick:()=>o(2),className:"text-green-600 text-sm font-semibold mt-2 hover:underline",children:"Edit"})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Order Items"}),t.map(w=>a.jsxs("div",{className:"flex justify-between py-2",children:[a.jsxs("span",{className:"text-gray-700",children:[w.name," x ",w.quantity]}),a.jsxs("span",{className:"font-semibold",children:["Â£",(w.price*w.quantity).toFixed(2)]})]},w._id))]}),a.jsx("form",{onSubmit:j,children:a.jsxs("div",{className:"flex gap-4",children:[a.jsx("button",{type:"button",onClick:()=>o(2),className:"flex-1 bg-gray-200 text-gray-700 py-3 rounded-lg font-bold hover:bg-gray-300 transition",children:"â† Back"}),a.jsx("button",{type:"submit",disabled:l,className:"flex-1 bg-gradient-to-r from-green-600 to-green-700 text-white py-3 rounded-lg font-bold hover:shadow-lg transition disabled:opacity-50",children:l?"Placing Order...":`Place Order (Â£${y.toFixed(2)})`})]})})]})]}),a.jsx("div",{className:"lg:col-span-1",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 sticky top-24",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Order Summary"}),a.jsx("div",{className:"space-y-3 mb-4 max-h-60 overflow-y-auto",children:t.map(w=>{var N,_;return a.jsxs("div",{className:"flex gap-3",children:[a.jsx("img",{src:((_=(N=w.images)==null?void 0:N[0])==null?void 0:_.url)||"https://images.unsplash.com/photo-1542838132-92c53300491e?w=200&q=80",alt:w.name,className:"w-16 h-16 object-cover rounded",onError:C=>{C.target.src="https://images.unsplash.com/photo-1542838132-92c53300491e?w=200&q=80"}}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-sm text-gray-900",children:w.name}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Qty: ",w.quantity]}),a.jsxs("p",{className:"text-sm font-bold text-green-600",children:["Â£",w.price.toFixed(2)]})]})]},w._id)})}),a.jsxs("div",{className:"border-t pt-4 space-y-2",children:[a.jsxs("div",{className:"flex justify-between text-gray-700",children:[a.jsx("span",{children:"Subtotal"}),a.jsxs("span",{children:["Â£",x.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between text-gray-700",children:[a.jsx("span",{children:"Delivery Fee"}),a.jsx("span",{children:m===0?"FREE":`Â£${m.toFixed(2)}`})]}),x>=50&&a.jsx("p",{className:"text-xs text-green-600",children:"ðŸŽ‰ Free delivery on orders over Â£50"}),a.jsxs("div",{className:"flex justify-between text-xl font-bold text-gray-900 border-t pt-2",children:[a.jsx("span",{children:"Total"}),a.jsxs("span",{children:["Â£",y.toFixed(2)]})]})]}),a.jsx("div",{className:"mt-6 bg-green-50 rounded-lg p-3 text-center",children:a.jsx("p",{className:"text-xs text-green-800",children:"ðŸ”’ Secure checkout powered by Paystack"})})]})})]})})]})}const F3="https://afrimercato-backend-production-0329.up.railway.app";function L3(){var o,l,c,d,h,u,g,x,m,y,v,j,w,N,_,C,M;const{orderId:e}=Z0();pa();const[r,t]=ue.useState(null),[n,s]=ue.useState(!0);return ue.useEffect(()=>{(async()=>{try{const E=await(await fetch(`${F3}/api/orders/${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("afrimercato_token")}`}})).json();E.success&&t(E.data)}catch(L){console.error("Error fetching order:",L)}finally{s(!1)}})()},[e]),n?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-4 border-b-4 border-green-600 mx-auto"}),a.jsx("p",{className:"text-gray-600 mt-4",children:"Loading order..."})]})}):r?a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("header",{className:"bg-white border-b shadow-sm",children:a.jsx("div",{className:"container mx-auto px-6 py-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-2xl",children:"ðŸ›’"}),a.jsx("span",{className:"text-xl font-bold text-gray-900",children:"AfriMercato"})]}),a.jsx(ft,{to:"/stores",className:"text-gray-600 hover:text-gray-900",children:"Continue Shopping"})]})})}),a.jsxs("div",{className:"container mx-auto px-6 py-12",children:[a.jsxs("div",{className:"max-w-2xl mx-auto text-center mb-8",children:[a.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx("span",{className:"text-4xl",children:"âœ“"})}),a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Order Placed Successfully!"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Thank you for your order. We've received your order and will start preparing it shortly."}),a.jsxs("p",{className:"text-sm text-gray-500",children:["Order Number: ",a.jsx("span",{className:"font-bold text-gray-900",children:r.orderNumber})]})]}),a.jsxs("div",{className:"max-w-2xl mx-auto",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mb-6",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Order Details"}),a.jsxs("div",{className:"mb-6 pb-6 border-b",children:[a.jsx("h3",{className:"font-semibold text-gray-700 mb-2",children:"Delivery Address"}),a.jsxs("p",{className:"text-gray-600",children:[(o=r.deliveryAddress)==null?void 0:o.fullName,a.jsx("br",{}),(l=r.deliveryAddress)==null?void 0:l.phone,a.jsx("br",{}),(c=r.deliveryAddress)==null?void 0:c.street,a.jsx("br",{}),(d=r.deliveryAddress)==null?void 0:d.city,", ",(h=r.deliveryAddress)==null?void 0:h.postalCode]})]}),a.jsxs("div",{className:"mb-6 pb-6 border-b",children:[a.jsx("h3",{className:"font-semibold text-gray-700 mb-3",children:"Order Items"}),a.jsx("div",{className:"space-y-3",children:(u=r.items)==null?void 0:u.map((D,L)=>a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-900",children:D.name}),a.jsxs("p",{className:"text-sm text-gray-500",children:["Qty: ",D.quantity]})]}),a.jsxs("p",{className:"font-semibold text-gray-900",children:["Â£",(D.price*D.quantity).toFixed(2)]})]},L))})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between text-gray-700",children:[a.jsx("span",{children:"Subtotal"}),a.jsxs("span",{children:["Â£",(x=(g=r.pricing)==null?void 0:g.subtotal)==null?void 0:x.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between text-gray-700",children:[a.jsx("span",{children:"Delivery Fee"}),a.jsxs("span",{children:["Â£",(y=(m=r.pricing)==null?void 0:m.deliveryFee)==null?void 0:y.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between text-xl font-bold text-gray-900 border-t pt-2",children:[a.jsx("span",{children:"Total"}),a.jsxs("span",{children:["Â£",(j=(v=r.pricing)==null?void 0:v.total)==null?void 0:j.toFixed(2)]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mb-6",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Order Status"}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-2xl",children:"ðŸ“¦"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-900 capitalize",children:(w=r.status)==null?void 0:w.replace("-"," ")}),a.jsx("p",{className:"text-sm text-gray-600",children:"Your order is being prepared"})]})]}),a.jsx(ft,{to:`/track-order/${r._id}`,className:"mt-4 block w-full text-center bg-green-600 text-white py-3 rounded-lg font-semibold hover:bg-green-700 transition",children:"Track Your Order"})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mb-6",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Payment"}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-gray-700",children:((N=r.payment)==null?void 0:N.method)==="card"?"ðŸ’³ Card Payment":"ðŸ’µ Cash on Delivery"}),a.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-semibold ${((_=r.payment)==null?void 0:_.status)==="paid"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:(M=(C=r.payment)==null?void 0:C.status)==null?void 0:M.toUpperCase()})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsx(ft,{to:"/stores",className:"bg-gray-200 text-gray-700 py-3 rounded-lg font-semibold text-center hover:bg-gray-300 transition",children:"Continue Shopping"}),a.jsx(ft,{to:"/my-dashboard",className:"bg-green-600 text-white py-3 rounded-lg font-semibold text-center hover:bg-green-700 transition",children:"View All Orders"})]})]}),a.jsxs("div",{className:"max-w-2xl mx-auto mt-8 bg-blue-50 rounded-xl p-6",children:[a.jsx("h3",{className:"font-bold text-gray-900 mb-3",children:"What happens next?"}),a.jsxs("ul",{className:"space-y-2 text-sm text-gray-700",children:[a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx("span",{children:"1ï¸âƒ£"}),a.jsx("span",{children:"Your order will be picked and packed by our team"})]}),a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx("span",{children:"2ï¸âƒ£"}),a.jsx("span",{children:"A rider will be assigned to deliver your order"})]}),a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx("span",{children:"3ï¸âƒ£"}),a.jsx("span",{children:"You'll receive real-time updates on delivery status"})]}),a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx("span",{children:"4ï¸âƒ£"}),a.jsx("span",{children:"Estimated delivery time: 20-40 minutes"})]})]})]})]})]}):a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-2xl mb-4",children:"ðŸ˜”"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Order not found"}),a.jsx(ft,{to:"/stores",className:"text-green-600 hover:underline",children:"Continue Shopping"})]})})}const P3="https://afrimercato-backend-production-0329.up.railway.app";function O3(){var h,u,g,x,m,y,v,j,w,N;const{orderId:e}=Z0(),[r,t]=ue.useState(null),[n,s]=ue.useState(null),[o,l]=ue.useState(!0);ue.useEffect(()=>{const _=async()=>{try{const D=await(await fetch(`${P3}/api/orders/${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("afrimercato_token")}`}})).json();D.success&&t(D.data)}catch(M){console.error("Error fetching order:",M)}finally{l(!1)}};_();const C=setInterval(_,1e4);return()=>clearInterval(C)},[e]);const c=_=>({pending:1,confirmed:2,picking:3,ready_for_pickup:4,"out-for-delivery":5,delivered:6})[_]||1;if(o)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-4 border-b-4 border-green-600 mx-auto"}),a.jsx("p",{className:"text-gray-600 mt-4",children:"Loading tracking info..."})]})});if(!r)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-2xl mb-4",children:"ðŸ˜”"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Order not found"}),a.jsx(ft,{to:"/stores",className:"text-green-600 hover:underline",children:"Continue Shopping"})]})});const d=c(r.status);return a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("header",{className:"bg-white border-b shadow-sm",children:a.jsx("div",{className:"container mx-auto px-6 py-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-2xl",children:"ðŸ›’"}),a.jsx("span",{className:"text-xl font-bold text-gray-900",children:"AfriMercato"})]}),a.jsx(ft,{to:"/my-dashboard",className:"text-gray-600 hover:text-gray-900",children:"My Orders"})]})})}),a.jsx("div",{className:"container mx-auto px-6 py-8",children:a.jsxs("div",{className:"max-w-4xl mx-auto",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mb-6",children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-1",children:"Track Your Order"}),a.jsxs("p",{className:"text-gray-600",children:["Order #",r.orderNumber]})]}),a.jsx("div",{className:`px-4 py-2 rounded-full text-sm font-semibold ${r.status==="delivered"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:(h=r.status)==null?void 0:h.replace("-"," ").toUpperCase()})]}),r.status!=="delivered"&&a.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:"text-3xl",children:"ðŸšš"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-900",children:"Estimated Delivery Time"}),a.jsx("p",{className:"text-sm text-gray-600",children:"20-40 minutes from now"})]})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mb-6",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Order Progress"}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${d>=1?"bg-green-600 text-white":"bg-gray-200 text-gray-500"}`,children:d>1?"âœ“":"1"}),d>1&&a.jsx("div",{className:"w-1 h-16 bg-green-600 mt-2"}),d===1&&a.jsx("div",{className:"w-1 h-16 bg-gray-200 mt-2"})]}),a.jsxs("div",{className:"flex-1 pb-6",children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:"Order Placed"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Your order has been received"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(r.createdAt).toLocaleString()})]})]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${d>=2?"bg-green-600 text-white":"bg-gray-200 text-gray-500"}`,children:d>2?"âœ“":"2"}),d>2&&a.jsx("div",{className:"w-1 h-16 bg-green-600 mt-2"}),d<=2&&a.jsx("div",{className:"w-1 h-16 bg-gray-200 mt-2"})]}),a.jsxs("div",{className:"flex-1 pb-6",children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:"Order Confirmed"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Store is preparing your order"})]})]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${d>=3?"bg-green-600 text-white":"bg-gray-200 text-gray-500"}`,children:d>3?"âœ“":"3"}),d>3&&a.jsx("div",{className:"w-1 h-16 bg-green-600 mt-2"}),d<=3&&a.jsx("div",{className:"w-1 h-16 bg-gray-200 mt-2"})]}),a.jsxs("div",{className:"flex-1 pb-6",children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:"Picking Items"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Items are being picked from shelves"})]})]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${d>=4?"bg-green-600 text-white":"bg-gray-200 text-gray-500"}`,children:d>4?"âœ“":"4"}),d>4&&a.jsx("div",{className:"w-1 h-16 bg-green-600 mt-2"}),d<=4&&a.jsx("div",{className:"w-1 h-16 bg-gray-200 mt-2"})]}),a.jsxs("div",{className:"flex-1 pb-6",children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:"Ready for Pickup"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Packed and waiting for rider"})]})]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${d>=5?"bg-green-600 text-white":"bg-gray-200 text-gray-500"}`,children:d>5?"âœ“":"5"}),d>5&&a.jsx("div",{className:"w-1 h-16 bg-green-600 mt-2"}),d<=5&&a.jsx("div",{className:"w-1 h-16 bg-gray-200 mt-2"})]}),a.jsxs("div",{className:"flex-1 pb-6",children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:"Out for Delivery"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Rider is on the way"}),n&&a.jsx("div",{className:"mt-2 bg-blue-50 rounded p-2",children:a.jsx("p",{className:"text-xs text-blue-700",children:"ðŸ“ Rider location updating in real-time"})})]})]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsx("div",{className:"flex flex-col items-center",children:a.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${d>=6?"bg-green-600 text-white":"bg-gray-200 text-gray-500"}`,children:d>=6?"âœ“":"6"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:"Delivered"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Order delivered successfully"})]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mb-6",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Order Items"}),a.jsx("div",{className:"space-y-3",children:(u=r.items)==null?void 0:u.map((_,C)=>a.jsxs("div",{className:"flex justify-between items-center pb-3 border-b last:border-b-0",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-900",children:_.name}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Quantity: ",_.quantity]})]}),a.jsxs("p",{className:"font-semibold text-gray-900",children:["Â£",(_.price*_.quantity).toFixed(2)]})]},C))}),a.jsxs("div",{className:"flex justify-between text-xl font-bold text-gray-900 border-t mt-4 pt-4",children:[a.jsx("span",{children:"Total"}),a.jsxs("span",{children:["Â£",(x=(g=r.pricing)==null?void 0:g.total)==null?void 0:x.toFixed(2)]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mb-6",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Delivery Address"}),a.jsxs("p",{className:"text-gray-700",children:[(m=r.deliveryAddress)==null?void 0:m.fullName,a.jsx("br",{}),(y=r.deliveryAddress)==null?void 0:y.phone,a.jsx("br",{}),(v=r.deliveryAddress)==null?void 0:v.street,a.jsx("br",{}),(j=r.deliveryAddress)==null?void 0:j.city,", ",(w=r.deliveryAddress)==null?void 0:w.postalCode]}),((N=r.deliveryAddress)==null?void 0:N.instructions)&&a.jsx("div",{className:"mt-3 bg-yellow-50 rounded p-3",children:a.jsxs("p",{className:"text-sm text-gray-700",children:[a.jsx("strong",{children:"Instructions:"})," ",r.deliveryAddress.instructions]})})]}),r.status==="delivered"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Rate Your Experience"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"How was your delivery experience?"}),a.jsx("button",{className:"w-full bg-green-600 text-white py-3 rounded-lg font-semibold hover:bg-green-700 transition",children:"Leave a Review"})]})]})})]})}function I3(){const[e,r]=ue.useState(!1),[t,n]=ue.useState([]),[s,o]=ue.useState(0),[l,c]=ue.useState(!1),d=ue.useRef(null);ue.useEffect(()=>{h();const v=setInterval(()=>{h()},3e4);return()=>clearInterval(v)},[]),ue.useEffect(()=>{e&&u()},[e]),ue.useEffect(()=>{const v=j=>{d.current&&!d.current.contains(j.target)&&r(!1)};return document.addEventListener("mousedown",v),()=>document.removeEventListener("mousedown",v)},[]);const h=async()=>{try{const v=await Rl.getUnreadCount();v.success&&o(v.data.count)}catch(v){console.error("Error fetching unread count:",v)}},u=async()=>{try{c(!0);const v=await Rl.getNotifications({limit:10});v.success&&n(v.data.notifications)}catch(v){console.error("Error fetching notifications:",v)}finally{c(!1)}},g=async v=>{try{v.isRead||(await Rl.markAsRead(v._id),o(j=>Math.max(0,j-1)),n(j=>j.map(w=>w._id===v._id?{...w,isRead:!0}:w))),v.actionUrl&&(window.location.href=v.actionUrl)}catch(j){console.error("Error marking notification as read:",j)}},x=async()=>{try{await Rl.markAllAsRead(),o(0),n(v=>v.map(j=>({...j,isRead:!0})))}catch(v){console.error("Error marking all as read:",v)}},m=v=>({order_placed:"ðŸ›’",order_confirmed:"âœ…",order_shipped:"ðŸ“¦",order_delivered:"ðŸŽ‰",order_cancelled:"âŒ",payment_received:"ðŸ’°",low_stock:"âš ï¸",product_review:"â­",rider_assigned:"ðŸš´",system_alert:"ðŸ””",promotion:"ðŸŽ"})[v]||"ðŸ””",y=v=>{const j={urgent:"text-red-600 bg-red-50",high:"text-orange-600 bg-orange-50",normal:"text-blue-600 bg-blue-50",low:"text-gray-600 bg-gray-50"};return j[v]||j.normal};return a.jsxs("div",{className:"relative",ref:d,children:[a.jsxs("button",{onClick:()=>r(!e),className:"relative p-2 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100 transition-colors",children:[a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),s>0&&a.jsx("span",{className:"absolute top-0 right-0 flex items-center justify-center h-5 w-5 text-xs font-bold text-white bg-red-500 rounded-full animate-pulse",children:s>9?"9+":s})]}),e&&a.jsxs("div",{className:"absolute right-0 mt-2 w-96 bg-white rounded-xl shadow-2xl border border-gray-200 z-50 transform transition-all duration-200 ease-out animate-slideDown",children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200",children:[a.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Notifications"}),s>0&&a.jsx("button",{onClick:x,className:"text-sm text-afri-green hover:text-afri-green-dark font-medium transition-colors",children:"Mark all read"})]}),a.jsx("div",{className:"max-h-96 overflow-y-auto",children:l?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-afri-green"})}):t.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"text-5xl mb-2",children:"ðŸ””"}),a.jsx("p",{className:"text-gray-500",children:"No notifications yet"})]}):a.jsx("div",{children:t.map(v=>a.jsxs("div",{onClick:()=>g(v),className:`px-4 py-3 border-b border-gray-100 cursor-pointer transition-colors ${v.isRead?"bg-white hover:bg-gray-50":"bg-blue-50 hover:bg-blue-100"}`,children:[a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx("div",{className:`flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center text-xl ${y(v.priority)}`,children:v.icon||m(v.type)}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate",children:v.title}),a.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 mt-1",children:v.message}),a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:v.timeAgo})]}),!v.isRead&&a.jsx("div",{className:"flex-shrink-0 w-2 h-2 bg-afri-green rounded-full"})]}),v.priority==="urgent"&&a.jsx("div",{className:"mt-2 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"ðŸš¨ Urgent"})]},v._id))})}),t.length>0&&a.jsx("div",{className:"px-4 py-3 border-t border-gray-200 bg-gray-50 rounded-b-xl",children:a.jsx("button",{onClick:()=>{r(!1),window.location.href="/notifications"},className:"w-full text-center text-sm text-afri-green hover:text-afri-green-dark font-medium transition-colors",children:"View all notifications"})})]})]})}function Ai({children:e}){var u;const r=hm(),t=pa(),{user:n,logout:s}=Ri(),[o,l]=ue.useState(!1),c=[{name:"Dashboard",path:"/dashboard",icon:"ðŸ“Š"},{name:"Products",path:"/products",icon:"ðŸ“¦"},{name:"Orders",path:"/orders",icon:"ðŸ›’"},{name:"Reports",path:"/reports",icon:"ðŸ“ˆ"},{name:"Subscription",path:"/subscription",icon:"ðŸ’³"},{name:"Settings",path:"/settings",icon:"âš™ï¸"}],d=()=>{s(),t("/login")},h=g=>r.pathname===g;return a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[o&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden",onClick:()=>l(!1)}),a.jsx("div",{className:`fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-xl transform transition-transform duration-300 ease-in-out lg:translate-x-0 ${o?"translate-x-0":"-translate-x-full"}`,children:a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"flex items-center justify-between h-16 px-6 bg-gradient-to-r from-afri-green to-afri-green-dark",children:[a.jsx(ft,{to:"/dashboard",className:"flex items-center",children:a.jsx("span",{className:"text-2xl font-bold text-white",children:"Afrimercato"})}),a.jsx("button",{onClick:()=>l(!1),className:"lg:hidden text-white hover:text-afri-yellow",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:"w-10 h-10 rounded-full bg-afri-green text-white flex items-center justify-center font-bold",children:((u=n==null?void 0:n.name)==null?void 0:u.charAt(0).toUpperCase())||"V"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate",children:(n==null?void 0:n.name)||"Vendor"}),a.jsx("p",{className:"text-xs text-gray-500 truncate",children:(n==null?void 0:n.email)||""})]})]})}),a.jsx("nav",{className:"flex-1 px-4 py-4 space-y-1 overflow-y-auto",children:c.map(g=>a.jsxs(ft,{to:g.path,className:`flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${h(g.path)?"bg-afri-green text-white":"text-gray-700 hover:bg-gray-100"}`,children:[a.jsx("span",{className:"text-xl",children:g.icon}),a.jsx("span",{className:"font-medium",children:g.name})]},g.name))}),a.jsx("div",{className:"p-4 border-t border-gray-200",children:a.jsxs("button",{onClick:d,className:"w-full flex items-center space-x-3 px-4 py-3 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[a.jsx("span",{className:"text-xl",children:"ðŸšª"}),a.jsx("span",{className:"font-medium",children:"Logout"})]})})]})}),a.jsxs("div",{className:"lg:ml-64",children:[a.jsx("div",{className:"sticky top-0 z-30 bg-white shadow-sm",children:a.jsxs("div",{className:"flex items-center justify-between h-16 px-4 sm:px-6 lg:px-8",children:[a.jsx("button",{onClick:()=>l(!0),className:"lg:hidden text-gray-500 hover:text-gray-700",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),a.jsx("div",{className:"flex-1 lg:flex-none"}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx(I3,{}),a.jsx("div",{className:"hidden lg:flex items-center space-x-2 text-sm",children:a.jsx("span",{className:"font-medium text-gray-700",children:n==null?void 0:n.name})})]})]})}),a.jsx("main",{className:"p-4 sm:p-6 lg:p-8",children:e})]})]})}function ms(){const{user:e}=Ri();switch((e==null?void 0:e.role)||(e==null?void 0:e.primaryRole)||"customer"){case"vendor":return a.jsx(fa,{to:"/dashboard",replace:!0});case"rider":return a.jsx(fa,{to:"/rider/dashboard",replace:!0});case"picker":return a.jsx(fa,{to:"/picker/dashboard",replace:!0});case"customer":default:return a.jsx(fa,{to:"/",replace:!0})}}function D3(){const{isAuthenticated:e,user:r,loading:t}=Ri();return t?a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-afri-green to-afri-green-dark",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-white mx-auto"}),a.jsx("p",{className:"text-white mt-4 text-lg font-semibold",children:"Loading Afrimercato..."})]})}):a.jsxs(um,{children:[a.jsx(Vr,{path:"/",element:a.jsx(h3,{})}),a.jsx(Vr,{path:"/old-home",element:a.jsx(d3,{})})," ",a.jsx(Vr,{path:"/partner",element:a.jsx(S3,{})}),a.jsx(Vr,{path:"/stores",element:a.jsx(_3,{})}),a.jsx(Vr,{path:"/store/:vendorId",element:a.jsx(A3,{})}),a.jsx(Vr,{path:"/my-dashboard",element:e?a.jsx(T3,{}):a.jsx(fa,{to:"/login"})}),a.jsx(Vr,{path:"/checkout",element:a.jsx(E3,{})}),a.jsx(Vr,{path:"/order-confirmation/:orderId",element:a.jsx(L3,{})}),a.jsx(Vr,{path:"/track-order/:orderId",element:a.jsx(O3,{})}),a.jsx(Vr,{path:"/login",element:e?a.jsx(ms,{}):a.jsx(jp,{})}),a.jsx(Vr,{path:"/register",element:e?a.jsx(ms,{}):a.jsx(kp,{})}),a.jsx(Vr,{path:"/dashboard",element:e?(r==null?void 0:r.role)==="vendor"?a.jsx(Ai,{children:a.jsx(Fp,{})}):a.jsx(ms,{}):a.jsx(fa,{to:"/login"})}),a.jsx(Vr,{path:"/products",element:e?(r==null?void 0:r.role)==="vendor"?a.jsx(Ai,{children:a.jsx(Rp,{})}):a.jsx(ms,{}):a.jsx(fa,{to:"/login"})}),a.jsx(Vr,{path:"/orders",element:e?(r==null?void 0:r.role)==="vendor"?a.jsx(Ai,{children:a.jsx($p,{})}):a.jsx(ms,{}):a.jsx(fa,{to:"/login"})}),a.jsx(Vr,{path:"/reports",element:e?(r==null?void 0:r.role)==="vendor"?a.jsx(Ai,{children:a.jsx(Hw,{})}):a.jsx(ms,{}):a.jsx(fa,{to:"/login"})}),a.jsx(Vr,{path:"/subscription",element:e?(r==null?void 0:r.role)==="vendor"?a.jsx(Ai,{children:a.jsx(Yw,{})}):a.jsx(ms,{}):a.jsx(fa,{to:"/login"})}),a.jsx(Vr,{path:"/settings",element:e?(r==null?void 0:r.role)==="vendor"?a.jsx(Ai,{children:a.jsx($w,{})}):a.jsx(ms,{}):a.jsx(fa,{to:"/login"})})]})}function R3(){return a.jsx(Np,{children:a.jsx(D3,{})})}class M3 extends wh.Component{constructor(r){super(r),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0}}componentDidCatch(r,t){this.setState({error:r,errorInfo:t}),console.error("ErrorBoundary caught an error:",r,t)}render(){return this.state.hasError?a.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center px-4",children:a.jsxs("div",{className:"max-w-lg w-full bg-white rounded-lg shadow-xl p-8",children:[a.jsx("div",{className:"flex items-center justify-center w-16 h-16 bg-red-100 rounded-full mx-auto mb-4",children:a.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),a.jsx("h1",{className:"text-2xl font-bold text-center text-gray-900 mb-4",children:"Oops! Something went wrong"}),a.jsx("p",{className:"text-gray-600 text-center mb-6",children:"We're sorry for the inconvenience. Please try refreshing the page."}),a.jsxs("div",{className:"flex justify-center space-x-4",children:[a.jsx("button",{onClick:()=>window.location.reload(),className:"bg-green-600 text-white px-6 py-2 rounded-lg font-medium hover:bg-green-700",children:"Refresh Page"}),a.jsx("a",{href:"/",className:"bg-gray-200 text-gray-800 px-6 py-2 rounded-lg font-medium hover:bg-gray-300",children:"Go Home"})]}),!1]})}):this.props.children}}O0.createRoot(document.getElementById("root")).render(a.jsx(wh.StrictMode,{children:a.jsxs(mm,{children:["  ",a.jsx(M3,{children:a.jsx(R3,{})})]})}));
