const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.es-lLa2plLs.js","assets/vendor-ZJRs3bXl.js","assets/date-BBj9wtMm.js","assets/charts-Doxf4Lew.js"])))=>i.map(i=>d[i]);
import{j as s,_ as tr,d as J1}from"./date-BBj9wtMm.js";import{b as Z1,r as Te,u as Cs,L as St,a as Q1,c as a0,d as e2,e as t2,f as r2,h as n2,i as $n,N as oi,R as nu,H as a2}from"./vendor-ZJRs3bXl.js";import{m as Ct}from"./ui-CnF6O82h.js";import{R as xo,A as au,C as $l,X as Yl,Y as _0,T as vo,b as iu,P as i2,c as s2,d as o2,B as su,e as ou}from"./charts-Doxf4Lew.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=t(a);fetch(a.href,i)}})();var A0={},qf=Z1;A0.createRoot=qf.createRoot,A0.hydrateRoot=qf.hydrateRoot;const z0="http://localhost:5000/api";console.log("ðŸ”— API Base URL:",z0);let Ol=!1,j0=[];const zf=(e,r=null)=>{j0.forEach(t=>{e?t.reject(e):t.resolve(r)}),j0=[]},l2=async()=>{var r;const e=localStorage.getItem("afrimercato_refresh_token");if(!e)throw new Error("No refresh token available");try{const t=await fetch(`${z0}/auth/refresh-token`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:e})});if(!t.ok)throw new Error("Failed to refresh token");const n=await t.json();if(n.success&&((r=n.data)!=null&&r.token))return localStorage.setItem("afrimercato_token",n.data.token),n.data.token;throw new Error("Invalid refresh response")}catch(t){throw localStorage.removeItem("afrimercato_token"),localStorage.removeItem("afrimercato_refresh_token"),t}},Mt=async(e,r={},t=!1)=>{try{const n=`${z0}${e}`,a={headers:{"Content-Type":"application/json",...r.headers},credentials:"include",...r},i=localStorage.getItem("afrimercato_token");i&&(a.headers.Authorization=`Bearer ${i}`);const o=await fetch(n,a);if(!o.ok){const c=await o.json().catch(()=>({}));if(o.status===401&&!t&&(c.errorCode==="TOKEN_EXPIRED"||c.errorCode==="INVALID_TOKEN")){if(Ol)return new Promise((h,u)=>{j0.push({resolve:h,reject:u})}).then(h=>Mt(e,r,!0)).catch(h=>{throw h});Ol=!0;try{const h=await l2();return zf(null,h),Ol=!1,Mt(e,r,!0)}catch(h){throw zf(h,null),Ol=!1,window.location.href="/login",new Error("Session expired. Please log in again.")}}throw o.status===401?(localStorage.removeItem("afrimercato_token"),localStorage.removeItem("afrimercato_refresh_token"),new Error("Session expired. Please log in again.")):new Error(c.message||`HTTP error! status: ${o.status}`)}return await o.json()}catch(n){throw console.error(`âŒ API Error (${e}):`,n),n}},c2=async e=>{var t;const r=await Mt("/auth/login",{method:"POST",body:JSON.stringify(e)});return r.success&&((t=r.data)!=null&&t.token)&&(localStorage.setItem("afrimercato_token",r.data.token),r.data.refreshToken&&localStorage.setItem("afrimercato_refresh_token",r.data.refreshToken)),r},f2=async e=>{var t;const r=await Mt("/auth/register",{method:"POST",body:JSON.stringify(e)});return r.success&&((t=r.data)!=null&&t.token)&&(localStorage.setItem("afrimercato_token",r.data.token),r.data.refreshToken&&localStorage.setItem("afrimercato_refresh_token",r.data.refreshToken)),r},h2=async()=>{try{await Mt("/auth/logout",{method:"POST"})}finally{localStorage.removeItem("afrimercato_token"),localStorage.removeItem("afrimercato_refresh_token"),window.location.href="/login"}},u2=async()=>Mt("/auth/refresh",{method:"POST"}),d2=async()=>Mt("/vendor/profile"),p2=async e=>Mt("/vendor/profile",{method:"PUT",body:JSON.stringify(e)}),m2=async e=>Mt("/vendor/profile",{method:"POST",body:JSON.stringify(e)}),g2=async(e={})=>{const r=new URLSearchParams(e).toString();return Mt(`/vendor/products?${r}`)},x2=async e=>Mt("/vendor/products",{method:"POST",body:JSON.stringify(e)}),v2=async(e,r)=>Mt(`/vendor/products/${e}`,{method:"PUT",body:JSON.stringify(r)}),y2=async e=>Mt(`/vendor/products/${e}`,{method:"DELETE"}),w2=async(e={})=>{const r=new URLSearchParams(e).toString();return Mt(`/vendor/orders?${r}`)},b2=async e=>Mt(`/vendor/orders/${e}`),N2=async(e,r)=>Mt(`/vendor/orders/${e}/status`,{method:"PUT",body:JSON.stringify(r)}),S2=async()=>Mt("/vendor/dashboard/stats"),_2=async(e="7d")=>Mt(`/vendor/dashboard/chart-data?timeRange=${e}`),A2=async(e={})=>{const r=new URLSearchParams(e).toString();return Mt(`/vendor/reports/sales?${r}`)},j2=async()=>Mt("/vendor/reports/inventory"),T2=async(e={})=>{const r=new URLSearchParams(e).toString();return Mt(`/vendor/reports/orders?${r}`)},k2=async(e={})=>{const r=new URLSearchParams(e).toString();return Mt(`/vendor/reports/revenue?${r}`)},E2=async()=>Mt("/subscription/plans"),F2=async e=>Mt("/subscription/subscribe",{method:"POST",body:JSON.stringify(e)}),L2=async()=>Mt("/subscription/my-subscription"),C2=async()=>Mt("/subscription/cancel",{method:"POST"}),P2=async(e,r=50)=>{const t=new URLSearchParams({location:e,radius:r});return Mt(`/location/search-vendors?${t}`)},O2=async e=>Mt(`/vendors/${e}`),I2=async e=>Mt(`/vendors/${e}/products`),D2=async()=>Mt("/products/featured"),R2=async(e={})=>{const r=new URLSearchParams(e).toString();return Mt(`/products?${r}`)},M2=async e=>Mt(`/products/${e}`),B2=()=>!!localStorage.getItem("afrimercato_token"),U2=()=>localStorage.getItem("afrimercato_token"),H2=e=>{localStorage.setItem("afrimercato_token",e)},W2=()=>{localStorage.removeItem("afrimercato_token"),localStorage.removeItem("afrimercato_refresh_token")},Vf={login:c2,register:f2,logout:h2,refreshToken:u2,isAuthenticated:B2,getAuthToken:U2,setAuthToken:H2,clearAuthToken:W2},Ir={getProfile:d2,updateProfile:p2,createProfile:m2,getProducts:g2,createProduct:x2,updateProduct:v2,deleteProduct:y2,getOrders:w2,getOrder:b2,updateOrderStatus:N2,getDashboardStats:S2,getChartData:_2,getSalesReport:A2,getInventoryReport:j2,getOrdersReport:T2,getRevenueReport:k2},Fo={getFeatured:D2,getAll:R2,getById:M2},i0={getPlans:E2,subscribe:F2,getMySubscription:L2,cancel:C2},lu=Te.createContext(),Uo=()=>{const e=Te.useContext(lu);if(!e)throw new Error("useAuth must be used within AuthProvider");return e},q2=({children:e})=>{const[r,t]=Te.useState(null),[n,a]=Te.useState(!0),[i,o]=Te.useState(!1);Te.useEffect(()=>{l()},[]);const l=async()=>{localStorage.getItem("afrimercato_token")&&o(!0),a(!1)},g={user:r,isAuthenticated:i,loading:n,login:async(m,d)=>{try{const y=await Vf.login({email:m,password:d});if(y.success){const{token:x,user:b}=y.data;return localStorage.setItem("afrimercato_token",x),t(b),o(!0),{success:!0,user:b}}}catch(y){return{success:!1,message:y.message||"Login failed"}}},register:async m=>{try{const d=await Vf.register(m);if(d.success){const{token:y,user:x}=d.data;return localStorage.setItem("afrimercato_token",y),t(x),o(!0),{success:!0}}}catch(d){return{success:!1,message:d.message||"Registration failed"}}},logout:()=>{localStorage.removeItem("afrimercato_token"),t(null),o(!1)},checkAuth:l};return s.jsx(lu.Provider,{value:g,children:e})};function z2(){const e=Cs(),{login:r}=Uo(),[t,n]=Te.useState({email:"",password:""}),[a,i]=Te.useState(""),[o,l]=Te.useState(!1),[c,h]=Te.useState(!1),u=m=>{n({...t,[m.target.name]:m.target.value}),i("")},g=async m=>{var y,x;m.preventDefault(),i(""),l(!0);const d=await r(t.email,t.password);if(d.success)switch(((y=d.user)==null?void 0:y.role)||((x=d.user)==null?void 0:x.primaryRole)||"customer"){case"vendor":e("/dashboard");break;case"rider":e("/rider/dashboard");break;case"picker":e("/picker/dashboard");break;case"customer":default:e("/");break}else i(d.message||"Login failed. Please try again.");l(!1)};return s.jsxs("div",{className:"min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8 overflow-hidden relative bg-gradient-to-br from-afri-green to-afri-green-dark",style:{backgroundSize:"400% 400%",animation:"gradient 15s ease infinite"},children:[s.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:s.jsx("div",{className:"absolute inset-0",style:{background:"radial-gradient(circle at center, rgba(255,255,255,0.1) 0%, transparent 60%)",animation:"pulse 4s ease-in-out infinite"}})}),s.jsxs(Ct.div,{className:"max-w-md w-full relative",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[s.jsxs(Ct.div,{className:"text-center mb-8",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5},children:[s.jsx(Ct.h1,{className:"text-5xl font-bold text-white mb-2",initial:{y:-20},animate:{y:0},transition:{type:"spring",stiffness:300,damping:20},children:"Afrimercato"}),s.jsx(Ct.p,{className:"text-afri-yellow text-lg",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:"Fresh African Groceries"})]}),s.jsxs(Ct.div,{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl p-8",initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.4,delay:.3},children:[s.jsx(Ct.h2,{className:"text-3xl font-bold text-gray-900 mb-2",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{duration:.4,delay:.4},children:"Welcome Back"}),s.jsx(Ct.p,{className:"text-gray-600 mb-6",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{duration:.4,delay:.5},children:"Sign in to your account"}),a&&s.jsx(Ct.div,{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-6 rounded",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3},children:s.jsx("p",{className:"text-red-700 text-sm",children:a})}),s.jsxs("form",{onSubmit:g,className:"space-y-6",children:[s.jsxs(Ct.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.6},children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),s.jsx(Ct.input,{whileFocus:{scale:1.01},transition:{type:"spring",stiffness:300,damping:20},id:"email",name:"email",type:"email",required:!0,value:t.email,onChange:u,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"vendor@example.com"})]}),s.jsxs(Ct.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.7},children:[s.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(Ct.input,{whileFocus:{scale:1.01},transition:{type:"spring",stiffness:300,damping:20},id:"password",name:"password",type:c?"text":"password",required:!0,value:t.password,onChange:u,className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"}),s.jsx("button",{type:"button",onClick:()=>h(!c),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700 focus:outline-none",children:c?s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):s.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),s.jsxs(Ct.div,{className:"flex items-center justify-between",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.8},children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(Ct.input,{whileHover:{scale:1.1},transition:{type:"spring",stiffness:400,damping:10},id:"remember",name:"remember",type:"checkbox",className:"h-4 w-4 text-afri-green focus:ring-afri-green border-gray-300 rounded"}),s.jsx("label",{htmlFor:"remember",className:"ml-2 block text-sm text-gray-700",children:"Remember me"})]}),s.jsx(Ct.div,{whileHover:{scale:1.05},children:s.jsx(St,{to:"/forgot-password",className:"text-sm text-afri-green hover:text-afri-green-dark font-medium",children:"Forgot password?"})})]}),s.jsx(Ct.button,{type:"submit",disabled:o,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-white bg-gradient-to-r from-afri-green to-afri-green-dark hover:from-afri-green-dark hover:to-afri-green focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-afri-green font-semibold text-lg transition disabled:opacity-50 disabled:cursor-not-allowed",whileHover:{scale:1.02},whileTap:{scale:.98},initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.9},children:o?s.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):"Sign In"})]}),s.jsxs(Ct.div,{className:"mt-6",initial:{opacity:0},animate:{opacity:1},transition:{delay:1},children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-0 flex items-center",children:s.jsx("div",{className:"w-full border-t border-gray-300"})}),s.jsx("div",{className:"relative flex justify-center text-sm",children:s.jsx("span",{className:"px-4 bg-white text-gray-500",children:"New to Afrimercato?"})})]}),s.jsx(Ct.div,{className:"mt-6 text-center",whileHover:{scale:1.05},children:s.jsxs(St,{to:"/register",className:"text-afri-green hover:text-afri-green-dark font-semibold text-base inline-flex items-center",children:["Create an account",s.jsx(Ct.span,{animate:{x:[0,5,0]},transition:{repeat:1/0,duration:1.5},className:"ml-2",children:"â†’"})]})})]})]}),s.jsx(Ct.p,{className:"mt-8 text-center text-sm text-white",initial:{opacity:0},animate:{opacity:1},transition:{delay:1.1},children:"Â© 2025 Afrimercato. Fresh African Groceries Delivered."})]}),s.jsx("style",{jsx:!0,children:`
        @keyframes gradient {
          0% { background-position: 0% 50% }
          50% { background-position: 100% 50% }
          100% { background-position: 0% 50% }
        }
        @keyframes pulse {
          0% { opacity: 0.4 }
          50% { opacity: 0.6 }
          100% { opacity: 0.4 }
        }
      `})]})}function V2(){const e=Cs(),{register:r}=Uo(),[t,n]=Te.useState({name:"",email:"",password:"",confirmPassword:"",role:"customer"}),[a,i]=Te.useState(""),[o,l]=Te.useState(!1),[c,h]=Te.useState(!1),[u,g]=Te.useState(!1),m=y=>{n({...t,[y.target.name]:y.target.value}),i("")},d=async y=>{if(y.preventDefault(),i(""),t.password!==t.confirmPassword){i("Passwords do not match");return}if(t.password.length<6){i("Password must be at least 6 characters");return}l(!0);const x=await r(t);if(x.success)switch(t.role){case"vendor":e("/dashboard");break;case"rider":e("/rider/dashboard");break;case"picker":e("/picker/dashboard");break;case"customer":default:e("/");break}else i(x.message);l(!1)};return s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-afri-green to-afri-green-dark py-12 px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"max-w-md w-full",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("h1",{className:"text-5xl font-bold text-white mb-2",children:"Afrimercato"}),s.jsxs("p",{className:"text-afri-yellow text-lg",children:[t.role==="vendor"&&"Start Selling Today",t.role==="customer"&&"Join Our Community",t.role==="rider"&&"Become a Delivery Partner",t.role==="picker"&&"Join Our Fulfillment Team"]})]}),s.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8",children:[s.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Create Account"}),s.jsxs("p",{className:"text-gray-600 mb-6",children:[t.role==="vendor"&&"Join thousands of vendors on Afrimercato",t.role==="customer"&&"Start shopping for fresh African groceries",t.role==="rider"&&"Deliver groceries and earn on your schedule",t.role==="picker"&&"Help fulfill orders from local stores"]}),a&&s.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-6 rounded",children:s.jsx("p",{className:"text-red-700 text-sm",children:a})}),s.jsxs("form",{onSubmit:d,className:"space-y-5",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 mb-2",children:"I want to register as"}),s.jsxs("select",{id:"role",name:"role",required:!0,value:t.role,onChange:m,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition bg-white",children:[s.jsx("option",{value:"customer",children:"Customer - Shop for groceries"}),s.jsx("option",{value:"vendor",children:"Vendor - Sell products"}),s.jsx("option",{value:"rider",children:"Rider - Deliver orders"}),s.jsx("option",{value:"picker",children:"Picker - Fulfill orders"})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name"}),s.jsx("input",{id:"name",name:"name",type:"text",required:!0,value:t.name,onChange:m,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"John Doe"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),s.jsx("input",{id:"email",name:"email",type:"email",required:!0,value:t.email,onChange:m,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"vendor@example.com"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{id:"password",name:"password",type:c?"text":"password",required:!0,value:t.password,onChange:m,className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"}),s.jsx("button",{type:"button",onClick:()=>h(!c),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700 focus:outline-none",children:c?s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.542 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):s.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"At least 6 characters"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:u?"text":"password",required:!0,value:t.confirmPassword,onChange:m,className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent transition",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"}),s.jsx("button",{type:"button",onClick:()=>g(!u),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700 focus:outline-none",children:u?s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.542 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):s.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),s.jsxs("div",{className:"flex items-start",children:[s.jsx("input",{id:"terms",name:"terms",type:"checkbox",required:!0,className:"h-4 w-4 mt-1 text-afri-green focus:ring-afri-green border-gray-300 rounded"}),s.jsxs("label",{htmlFor:"terms",className:"ml-2 block text-sm text-gray-700",children:["I agree to the"," ",s.jsx(St,{to:"/terms",className:"text-afri-green hover:text-afri-green-dark font-medium",children:"Terms of Service"})," ","and"," ",s.jsx(St,{to:"/privacy",className:"text-afri-green hover:text-afri-green-dark font-medium",children:"Privacy Policy"})]})]}),s.jsx("button",{type:"submit",disabled:o,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-white bg-gradient-to-r from-afri-green to-afri-green-dark hover:from-afri-green-dark hover:to-afri-green focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-afri-green font-semibold text-lg transition disabled:opacity-50 disabled:cursor-not-allowed",children:o?s.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):"Create Account"})]}),s.jsxs("div",{className:"mt-6",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-0 flex items-center",children:s.jsx("div",{className:"w-full border-t border-gray-300"})}),s.jsx("div",{className:"relative flex justify-center text-sm",children:s.jsx("span",{className:"px-4 bg-white text-gray-500",children:"Already have an account?"})})]}),s.jsx("div",{className:"mt-6 text-center",children:s.jsx(St,{to:"/login",className:"text-afri-green hover:text-afri-green-dark font-semibold text-base",children:"Sign in here â†’"})})]})]}),s.jsx("p",{className:"mt-8 text-center text-sm text-white",children:"Â© 2025 Afrimercato. Fresh African Groceries Delivered."})]})})}const G2="http://localhost:5000/api",Gf=async e=>{const r=localStorage.getItem("afrimercato_token"),t=await fetch(`${G2}${e}`,{headers:{"Content-Type":"application/json",...r&&{Authorization:`Bearer ${r}`}}});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return await t.json()},$2={getDetailedAnalytics:async(e,r)=>(await Gf(`/vendor/analytics/detailed?startDate=${e}&endDate=${r}`)).data,getSalesForecast:async(e=7)=>(await Gf(`/vendor/analytics/forecast?days=${e}`)).data},Y2="modulepreload",X2=function(e){return"/afrimercato-frontend/"+e},$f={},T0=function(r,t,n){let a=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(t.map(c=>{if(c=X2(c),c in $f)return;$f[c]=!0;const h=c.endsWith(".css"),u=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const g=document.createElement("link");if(g.rel=h?"stylesheet":Y2,h||(g.as="script"),g.crossOrigin="",g.href=c,l&&g.setAttribute("nonce",l),document.head.appendChild(g),h)return new Promise((m,d)=>{g.addEventListener("load",m),g.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return a.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return r().catch(i)})};var nn=Uint8Array,In=Uint16Array,V0=Int32Array,hc=new nn([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),uc=new nn([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),k0=new nn([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),cu=function(e,r){for(var t=new In(31),n=0;n<31;++n)t[n]=r+=1<<e[n-1];for(var a=new V0(t[30]),n=1;n<30;++n)for(var i=t[n];i<t[n+1];++i)a[i]=i-t[n]<<5|n;return{b:t,r:a}},fu=cu(hc,2),hu=fu.b,E0=fu.r;hu[28]=258,E0[258]=28;var uu=cu(uc,0),K2=uu.b,Yf=uu.r,F0=new In(32768);for(var sr=0;sr<32768;++sr){var li=(sr&43690)>>1|(sr&21845)<<1;li=(li&52428)>>2|(li&13107)<<2,li=(li&61680)>>4|(li&3855)<<4,F0[sr]=((li&65280)>>8|(li&255)<<8)>>1}var ja=function(e,r,t){for(var n=e.length,a=0,i=new In(r);a<n;++a)e[a]&&++i[e[a]-1];var o=new In(r);for(a=1;a<r;++a)o[a]=o[a-1]+i[a-1]<<1;var l;if(t){l=new In(1<<r);var c=15-r;for(a=0;a<n;++a)if(e[a])for(var h=a<<4|e[a],u=r-e[a],g=o[e[a]-1]++<<u,m=g|(1<<u)-1;g<=m;++g)l[F0[g]>>c]=h}else for(l=new In(n),a=0;a<n;++a)e[a]&&(l[a]=F0[o[e[a]-1]++]>>15-e[a]);return l},gi=new nn(288);for(var sr=0;sr<144;++sr)gi[sr]=8;for(var sr=144;sr<256;++sr)gi[sr]=9;for(var sr=256;sr<280;++sr)gi[sr]=7;for(var sr=280;sr<288;++sr)gi[sr]=8;var Lo=new nn(32);for(var sr=0;sr<32;++sr)Lo[sr]=5;var J2=ja(gi,9,0),Z2=ja(gi,9,1),Q2=ja(Lo,5,0),ep=ja(Lo,5,1),s0=function(e){for(var r=e[0],t=1;t<e.length;++t)e[t]>r&&(r=e[t]);return r},ia=function(e,r,t){var n=r/8|0;return(e[n]|e[n+1]<<8)>>(r&7)&t},o0=function(e,r){var t=r/8|0;return(e[t]|e[t+1]<<8|e[t+2]<<16)>>(r&7)},G0=function(e){return(e+7)/8|0},du=function(e,r,t){return(t==null||t>e.length)&&(t=e.length),new nn(e.subarray(r,t))},tp=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ca=function(e,r,t){var n=new Error(r||tp[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,ca),!t)throw n;return n},rp=function(e,r,t,n){var a=e.length,i=0;if(!a||r.f&&!r.l)return t||new nn(0);var o=!t,l=o||r.i!=2,c=r.i;o&&(t=new nn(a*3));var h=function(Pe){var Re=t.length;if(Pe>Re){var ze=new nn(Math.max(Re*2,Pe));ze.set(t),t=ze}},u=r.f||0,g=r.p||0,m=r.b||0,d=r.l,y=r.d,x=r.m,b=r.n,N=a*8;do{if(!d){u=ia(e,g,1);var w=ia(e,g+1,3);if(g+=3,w)if(w==1)d=Z2,y=ep,x=9,b=5;else if(w==2){var V=ia(e,g,31)+257,F=ia(e,g+10,15)+4,C=V+ia(e,g+5,31)+1;g+=14;for(var R=new nn(C),G=new nn(19),j=0;j<F;++j)G[k0[j]]=ia(e,g+j*3,7);g+=F*3;for(var T=s0(G),B=(1<<T)-1,M=ja(G,T,1),j=0;j<C;){var le=M[ia(e,g,B)];g+=le&15;var A=le>>4;if(A<16)R[j++]=A;else{var J=0,z=0;for(A==16?(z=3+ia(e,g,3),g+=2,J=R[j-1]):A==17?(z=3+ia(e,g,7),g+=3):A==18&&(z=11+ia(e,g,127),g+=7);z--;)R[j++]=J}}var ae=R.subarray(0,V),te=R.subarray(V);x=s0(ae),b=s0(te),d=ja(ae,x,1),y=ja(te,b,1)}else ca(1);else{var A=G0(g)+4,E=e[A-4]|e[A-3]<<8,W=A+E;if(W>a){c&&ca(0);break}l&&h(m+E),t.set(e.subarray(A,W),m),r.b=m+=E,r.p=g=W*8,r.f=u;continue}if(g>N){c&&ca(0);break}}l&&h(m+131072);for(var de=(1<<x)-1,xe=(1<<b)-1,_=g;;_=g){var J=d[o0(e,g)&de],L=J>>4;if(g+=J&15,g>N){c&&ca(0);break}if(J||ca(2),L<256)t[m++]=L;else if(L==256){_=g,d=null;break}else{var P=L-254;if(L>264){var j=L-257,O=hc[j];P=ia(e,g,(1<<O)-1)+hu[j],g+=O}var X=y[o0(e,g)&xe],ce=X>>4;X||ca(3),g+=X&15;var te=K2[ce];if(ce>3){var O=uc[ce];te+=o0(e,g)&(1<<O)-1,g+=O}if(g>N){c&&ca(0);break}l&&h(m+131072);var fe=m+P;if(m<te){var he=i-te,we=Math.min(te,fe);for(he+m<0&&ca(3);m<we;++m)t[m]=n[he+m]}for(;m<fe;++m)t[m]=t[m-te]}}r.l=d,r.p=_,r.b=m,r.f=u,d&&(u=1,r.m=x,r.d=y,r.n=b)}while(!u);return m!=t.length&&o?du(t,0,m):t.subarray(0,m)},Ua=function(e,r,t){t<<=r&7;var n=r/8|0;e[n]|=t,e[n+1]|=t>>8},uo=function(e,r,t){t<<=r&7;var n=r/8|0;e[n]|=t,e[n+1]|=t>>8,e[n+2]|=t>>16},l0=function(e,r){for(var t=[],n=0;n<e.length;++n)e[n]&&t.push({s:n,f:e[n]});var a=t.length,i=t.slice();if(!a)return{t:mu,l:0};if(a==1){var o=new nn(t[0].s+1);return o[t[0].s]=1,{t:o,l:1}}t.sort(function(W,V){return W.f-V.f}),t.push({s:-1,f:25001});var l=t[0],c=t[1],h=0,u=1,g=2;for(t[0]={s:-1,f:l.f+c.f,l,r:c};u!=a-1;)l=t[t[h].f<t[g].f?h++:g++],c=t[h!=u&&t[h].f<t[g].f?h++:g++],t[u++]={s:-1,f:l.f+c.f,l,r:c};for(var m=i[0].s,n=1;n<a;++n)i[n].s>m&&(m=i[n].s);var d=new In(m+1),y=L0(t[u-1],d,0);if(y>r){var n=0,x=0,b=y-r,N=1<<b;for(i.sort(function(V,F){return d[F.s]-d[V.s]||V.f-F.f});n<a;++n){var w=i[n].s;if(d[w]>r)x+=N-(1<<y-d[w]),d[w]=r;else break}for(x>>=b;x>0;){var A=i[n].s;d[A]<r?x-=1<<r-d[A]++-1:++n}for(;n>=0&&x;--n){var E=i[n].s;d[E]==r&&(--d[E],++x)}y=r}return{t:new nn(d),l:y}},L0=function(e,r,t){return e.s==-1?Math.max(L0(e.l,r,t+1),L0(e.r,r,t+1)):r[e.s]=t},Xf=function(e){for(var r=e.length;r&&!e[--r];);for(var t=new In(++r),n=0,a=e[0],i=1,o=function(c){t[n++]=c},l=1;l<=r;++l)if(e[l]==a&&l!=r)++i;else{if(!a&&i>2){for(;i>138;i-=138)o(32754);i>2&&(o(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(o(a),--i;i>6;i-=6)o(8304);i>2&&(o(i-3<<5|8208),i=0)}for(;i--;)o(a);i=1,a=e[l]}return{c:t.subarray(0,n),n:r}},po=function(e,r){for(var t=0,n=0;n<r.length;++n)t+=e[n]*r[n];return t},pu=function(e,r,t){var n=t.length,a=G0(r+2);e[a]=n&255,e[a+1]=n>>8,e[a+2]=e[a]^255,e[a+3]=e[a+1]^255;for(var i=0;i<n;++i)e[a+i+4]=t[i];return(a+4+n)*8},Kf=function(e,r,t,n,a,i,o,l,c,h,u){Ua(r,u++,t),++a[256];for(var g=l0(a,15),m=g.t,d=g.l,y=l0(i,15),x=y.t,b=y.l,N=Xf(m),w=N.c,A=N.n,E=Xf(x),W=E.c,V=E.n,F=new In(19),C=0;C<w.length;++C)++F[w[C]&31];for(var C=0;C<W.length;++C)++F[W[C]&31];for(var R=l0(F,7),G=R.t,j=R.l,T=19;T>4&&!G[k0[T-1]];--T);var B=h+5<<3,M=po(a,gi)+po(i,Lo)+o,le=po(a,m)+po(i,x)+o+14+3*T+po(F,G)+2*F[16]+3*F[17]+7*F[18];if(c>=0&&B<=M&&B<=le)return pu(r,u,e.subarray(c,c+h));var J,z,ae,te;if(Ua(r,u,1+(le<M)),u+=2,le<M){J=ja(m,d,0),z=m,ae=ja(x,b,0),te=x;var de=ja(G,j,0);Ua(r,u,A-257),Ua(r,u+5,V-1),Ua(r,u+10,T-4),u+=14;for(var C=0;C<T;++C)Ua(r,u+3*C,G[k0[C]]);u+=3*T;for(var xe=[w,W],_=0;_<2;++_)for(var L=xe[_],C=0;C<L.length;++C){var P=L[C]&31;Ua(r,u,de[P]),u+=G[P],P>15&&(Ua(r,u,L[C]>>5&127),u+=L[C]>>12)}}else J=J2,z=gi,ae=Q2,te=Lo;for(var C=0;C<l;++C){var O=n[C];if(O>255){var P=O>>18&31;uo(r,u,J[P+257]),u+=z[P+257],P>7&&(Ua(r,u,O>>23&31),u+=hc[P]);var X=O&31;uo(r,u,ae[X]),u+=te[X],X>3&&(uo(r,u,O>>5&8191),u+=uc[X])}else uo(r,u,J[O]),u+=z[O]}return uo(r,u,J[256]),u+z[256]},np=new V0([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),mu=new nn(0),ap=function(e,r,t,n,a,i){var o=i.z||e.length,l=new nn(n+o+5*(1+Math.ceil(o/7e3))+a),c=l.subarray(n,l.length-a),h=i.l,u=(i.r||0)&7;if(r){u&&(c[0]=i.r>>3);for(var g=np[r-1],m=g>>13,d=g&8191,y=(1<<t)-1,x=i.p||new In(32768),b=i.h||new In(y+1),N=Math.ceil(t/3),w=2*N,A=function(Ke){return(e[Ke]^e[Ke+1]<<N^e[Ke+2]<<w)&y},E=new V0(25e3),W=new In(288),V=new In(32),F=0,C=0,R=i.i||0,G=0,j=i.w||0,T=0;R+2<o;++R){var B=A(R),M=R&32767,le=b[B];if(x[M]=le,b[B]=M,j<=R){var J=o-R;if((F>7e3||G>24576)&&(J>423||!h)){u=Kf(e,c,0,E,W,V,C,G,T,R-T,u),G=F=C=0,T=R;for(var z=0;z<286;++z)W[z]=0;for(var z=0;z<30;++z)V[z]=0}var ae=2,te=0,de=d,xe=M-le&32767;if(J>2&&B==A(R-xe))for(var _=Math.min(m,J)-1,L=Math.min(32767,R),P=Math.min(258,J);xe<=L&&--de&&M!=le;){if(e[R+ae]==e[R+ae-xe]){for(var O=0;O<P&&e[R+O]==e[R+O-xe];++O);if(O>ae){if(ae=O,te=xe,O>_)break;for(var X=Math.min(xe,O-2),ce=0,z=0;z<X;++z){var fe=R-xe+z&32767,he=x[fe],we=fe-he&32767;we>ce&&(ce=we,le=fe)}}}M=le,le=x[M],xe+=M-le&32767}if(te){E[G++]=268435456|E0[ae]<<18|Yf[te];var Pe=E0[ae]&31,Re=Yf[te]&31;C+=hc[Pe]+uc[Re],++W[257+Pe],++V[Re],j=R+ae,++F}else E[G++]=e[R],++W[e[R]]}}for(R=Math.max(R,j);R<o;++R)E[G++]=e[R],++W[e[R]];u=Kf(e,c,h,E,W,V,C,G,T,R-T,u),h||(i.r=u&7|c[u/8|0]<<3,u-=7,i.h=b,i.p=x,i.i=R,i.w=j)}else{for(var R=i.w||0;R<o+h;R+=65535){var ze=R+65535;ze>=o&&(c[u/8|0]=h,ze=o),u=pu(c,u+1,e.subarray(R,ze))}i.i=o}return du(l,0,n+G0(u)+a)},gu=function(){var e=1,r=0;return{p:function(t){for(var n=e,a=r,i=t.length|0,o=0;o!=i;){for(var l=Math.min(o+2655,i);o<l;++o)a+=n+=t[o];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}e=n,r=a},d:function(){return e%=65521,r%=65521,(e&255)<<24|(e&65280)<<8|(r&255)<<8|r>>8}}},ip=function(e,r,t,n,a){if(!a&&(a={l:1},r.dictionary)){var i=r.dictionary.subarray(-32768),o=new nn(i.length+e.length);o.set(i),o.set(e,i.length),e=o,a.w=i.length}return ap(e,r.level==null?6:r.level,r.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+r.mem,t,n,a)},xu=function(e,r,t){for(;t;++r)e[r]=t,t>>>=8},sp=function(e,r){var t=r.level,n=t==0?0:t<6?1:t==9?3:2;if(e[0]=120,e[1]=n<<6|(r.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,r.dictionary){var a=gu();a.p(r.dictionary),xu(e,2,a.d())}},op=function(e,r){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&ca(6,"invalid zlib data"),(e[1]>>5&1)==1&&ca(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function C0(e,r){r||(r={});var t=gu();t.p(e);var n=ip(e,r,r.dictionary?6:2,4);return sp(n,r),xu(n,n.length-4,t.d()),n}function lp(e,r){return rp(e.subarray(op(e),-4),{i:2},r,r)}var cp=typeof TextDecoder<"u"&&new TextDecoder,fp=0;try{cp.decode(mu,{stream:!0}),fp=1}catch{}var mt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function c0(){mt.console&&typeof mt.console.log=="function"&&mt.console.log.apply(mt.console,arguments)}var er={log:c0,warn:function(e){mt.console&&(typeof mt.console.warn=="function"?mt.console.warn.apply(mt.console,arguments):c0.call(null,arguments))},error:function(e){mt.console&&(typeof mt.console.error=="function"?mt.console.error.apply(mt.console,arguments):c0(e))}};function f0(e,r,t){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){Ci(n.response,r,t)},n.onerror=function(){er.error("could not download file")},n.send()}function Jf(e){var r=new XMLHttpRequest;r.open("HEAD",e,!1);try{r.send()}catch{}return r.status>=200&&r.status<=299}function Il(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(r)}}var yo,P0,Ci=mt.saveAs||((typeof window>"u"?"undefined":tr(window))!=="object"||window!==mt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,r,t){var n=mt.URL||mt.webkitURL,a=document.createElement("a");r=r||e.name||"download",a.download=r,a.rel="noopener",typeof e=="string"?(a.href=e,a.origin!==location.origin?Jf(a.href)?f0(e,r,t):Il(a,a.target="_blank"):Il(a)):(a.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){Il(a)},0))}:"msSaveOrOpenBlob"in navigator?function(e,r,t){if(r=r||e.name||"download",typeof e=="string")if(Jf(e))f0(e,r,t);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){Il(n)})}else navigator.msSaveOrOpenBlob(function(a,i){return i===void 0?i={autoBom:!1}:tr(i)!=="object"&&(er.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}(e,t),r)}:function(e,r,t,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return f0(e,r,t);var a=e.type==="application/octet-stream",i=/constructor/i.test(mt.HTMLElement)||mt.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||a&&i)&&(typeof FileReader>"u"?"undefined":tr(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var u=l.result;u=o?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=u:location=u,n=null},l.readAsDataURL(e)}else{var c=mt.URL||mt.webkitURL,h=c.createObjectURL(e);n?n.location=h:location.href=h,n=null,setTimeout(function(){c.revokeObjectURL(h)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function vu(e){var r;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<t.length;n++){var a=t[n].re,i=t[n].process,o=a.exec(e);o&&(r=i(o),this.r=r[0],this.g=r[1],this.b=r[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),h=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),h.length==1&&(h="0"+h),"#"+l+c+h}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function h0(e,r){var t=e[0],n=e[1],a=e[2],i=e[3];t=Qr(t,n,a,i,r[0],7,-680876936),i=Qr(i,t,n,a,r[1],12,-389564586),a=Qr(a,i,t,n,r[2],17,606105819),n=Qr(n,a,i,t,r[3],22,-1044525330),t=Qr(t,n,a,i,r[4],7,-176418897),i=Qr(i,t,n,a,r[5],12,1200080426),a=Qr(a,i,t,n,r[6],17,-1473231341),n=Qr(n,a,i,t,r[7],22,-45705983),t=Qr(t,n,a,i,r[8],7,1770035416),i=Qr(i,t,n,a,r[9],12,-1958414417),a=Qr(a,i,t,n,r[10],17,-42063),n=Qr(n,a,i,t,r[11],22,-1990404162),t=Qr(t,n,a,i,r[12],7,1804603682),i=Qr(i,t,n,a,r[13],12,-40341101),a=Qr(a,i,t,n,r[14],17,-1502002290),t=en(t,n=Qr(n,a,i,t,r[15],22,1236535329),a,i,r[1],5,-165796510),i=en(i,t,n,a,r[6],9,-1069501632),a=en(a,i,t,n,r[11],14,643717713),n=en(n,a,i,t,r[0],20,-373897302),t=en(t,n,a,i,r[5],5,-701558691),i=en(i,t,n,a,r[10],9,38016083),a=en(a,i,t,n,r[15],14,-660478335),n=en(n,a,i,t,r[4],20,-405537848),t=en(t,n,a,i,r[9],5,568446438),i=en(i,t,n,a,r[14],9,-1019803690),a=en(a,i,t,n,r[3],14,-187363961),n=en(n,a,i,t,r[8],20,1163531501),t=en(t,n,a,i,r[13],5,-1444681467),i=en(i,t,n,a,r[2],9,-51403784),a=en(a,i,t,n,r[7],14,1735328473),t=tn(t,n=en(n,a,i,t,r[12],20,-1926607734),a,i,r[5],4,-378558),i=tn(i,t,n,a,r[8],11,-2022574463),a=tn(a,i,t,n,r[11],16,1839030562),n=tn(n,a,i,t,r[14],23,-35309556),t=tn(t,n,a,i,r[1],4,-1530992060),i=tn(i,t,n,a,r[4],11,1272893353),a=tn(a,i,t,n,r[7],16,-155497632),n=tn(n,a,i,t,r[10],23,-1094730640),t=tn(t,n,a,i,r[13],4,681279174),i=tn(i,t,n,a,r[0],11,-358537222),a=tn(a,i,t,n,r[3],16,-722521979),n=tn(n,a,i,t,r[6],23,76029189),t=tn(t,n,a,i,r[9],4,-640364487),i=tn(i,t,n,a,r[12],11,-421815835),a=tn(a,i,t,n,r[15],16,530742520),t=rn(t,n=tn(n,a,i,t,r[2],23,-995338651),a,i,r[0],6,-198630844),i=rn(i,t,n,a,r[7],10,1126891415),a=rn(a,i,t,n,r[14],15,-1416354905),n=rn(n,a,i,t,r[5],21,-57434055),t=rn(t,n,a,i,r[12],6,1700485571),i=rn(i,t,n,a,r[3],10,-1894986606),a=rn(a,i,t,n,r[10],15,-1051523),n=rn(n,a,i,t,r[1],21,-2054922799),t=rn(t,n,a,i,r[8],6,1873313359),i=rn(i,t,n,a,r[15],10,-30611744),a=rn(a,i,t,n,r[6],15,-1560198380),n=rn(n,a,i,t,r[13],21,1309151649),t=rn(t,n,a,i,r[4],6,-145523070),i=rn(i,t,n,a,r[11],10,-1120210379),a=rn(a,i,t,n,r[2],15,718787259),n=rn(n,a,i,t,r[9],21,-343485551),e[0]=ui(t,e[0]),e[1]=ui(n,e[1]),e[2]=ui(a,e[2]),e[3]=ui(i,e[3])}function dc(e,r,t,n,a,i){return r=ui(ui(r,e),ui(n,i)),ui(r<<a|r>>>32-a,t)}function Qr(e,r,t,n,a,i,o){return dc(r&t|~r&n,e,r,a,i,o)}function en(e,r,t,n,a,i,o){return dc(r&n|t&~n,e,r,a,i,o)}function tn(e,r,t,n,a,i,o){return dc(r^t^n,e,r,a,i,o)}function rn(e,r,t,n,a,i,o){return dc(t^(r|~n),e,r,a,i,o)}function yu(e){var r,t=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=e.length;r+=64)h0(n,hp(e.substring(r-64,r)));e=e.substring(r-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<e.length;r++)a[r>>2]|=e.charCodeAt(r)<<(r%4<<3);if(a[r>>2]|=128<<(r%4<<3),r>55)for(h0(n,a),r=0;r<16;r++)a[r]=0;return a[14]=8*t,h0(n,a),n}function hp(e){var r,t=[];for(r=0;r<64;r+=4)t[r>>2]=e.charCodeAt(r)+(e.charCodeAt(r+1)<<8)+(e.charCodeAt(r+2)<<16)+(e.charCodeAt(r+3)<<24);return t}yo=mt.atob.bind(mt),P0=mt.btoa.bind(mt);var Zf="0123456789abcdef".split("");function up(e){for(var r="",t=0;t<4;t++)r+=Zf[e>>8*t+4&15]+Zf[e>>8*t&15];return r}function dp(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function O0(e){return yu(e).map(dp).join("")}var pp=function(e){for(var r=0;r<e.length;r++)e[r]=up(e[r]);return e.join("")}(yu("hello"))!="5d41402abc4b2a76b9719d911017c592";function ui(e,r){if(pp){var t=(65535&e)+(65535&r);return(e>>16)+(r>>16)+(t>>16)<<16|65535&t}return e+r&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function I0(e,r){var t,n,a,i;if(e!==t){for(var o=(a=e,i=1+(256/e.length>>0),new Array(i+1).join(a)),l=[],c=0;c<256;c++)l[c]=c;var h=0;for(c=0;c<256;c++){var u=l[c];h=(h+u+o.charCodeAt(c))%256,l[c]=l[h],l[h]=u}t=e,n=l}else l=n;var g=r.length,m=0,d=0,y="";for(c=0;c<g;c++)d=(d+(u=l[m=(m+1)%256]))%256,l[m]=l[d],l[d]=u,o=l[(l[m]+l[d])%256],y+=String.fromCharCode(r.charCodeAt(c)^o);return y}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var Qf={print:4,modify:8,copy:16,"annot-forms":32};function Ss(e,r,t,n){this.v=1,this.r=2;var a=192;e.forEach(function(l){if(Qf.perm!==void 0)throw new Error("Invalid permission: "+l);a+=Qf[l]}),this.padding="(Â¿N^NuÂŠAd\0NVÃ¿Ãº\b..\0Â¶Ãh>Â€/\fÂ©Ã¾dSiz";var i=(r+this.padding).substr(0,32),o=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,o),this.P=-(1+(255^a)),this.encryptionKey=O0(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=I0(this.encryptionKey,this.padding)}function _s(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var r="",t=e.length,n=0;n<t;n++){var a=e.charCodeAt(n);a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?r+="#"+("0"+a.toString(16)).slice(-2):r+=e[n]}return r}function eh(e){if(tr(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var r={};this.subscribe=function(t,n,a){if(a=a||!1,typeof t!="string"||typeof n!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");r.hasOwnProperty(t)||(r[t]={});var i=Math.random().toString(35);return r[t][i]=[n,!!a],i},this.unsubscribe=function(t){for(var n in r)if(r[n][t])return delete r[n][t],Object.keys(r[n]).length===0&&delete r[n],!0;return!1},this.publish=function(t){if(r.hasOwnProperty(t)){var n=Array.prototype.slice.call(arguments,1),a=[];for(var i in r[t]){var o=r[t][i];try{o[0].apply(e,n)}catch(l){mt.console&&er.error("jsPDF PubSub Error",l.message,l)}o[1]&&a.push(i)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return r}}function Co(e){if(!(this instanceof Co))return new Co(e);var r="opacity,stroke-opacity".split(",");for(var t in e)e.hasOwnProperty(t)&&r.indexOf(t)>=0&&(this[t]=e[t]);this.id="",this.objectNumber=-1}function wu(e,r){this.gState=e,this.matrix=r,this.id="",this.objectNumber=-1}function hi(e,r,t,n,a){if(!(this instanceof hi))return new hi(e,r,t,n,a);this.type=e==="axial"?2:3,this.coords=r,this.colors=t,wu.call(this,n,a)}function Oi(e,r,t,n,a){if(!(this instanceof Oi))return new Oi(e,r,t,n,a);this.boundingBox=e,this.xStep=r,this.yStep=t,this.stream="",this.cloneIndex=0,wu.call(this,n,a)}function ht(e){var r,t=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],a=arguments[2],i=arguments[3],o=[],l=1,c=16,h="S",u=null;tr(e=e||{})==="object"&&(t=e.orientation,n=e.unit||n,a=e.format||a,i=e.compress||e.compressPdf||i,(u=e.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),l=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(r=e.precision),e.floatPrecision!==void 0&&(c=e.floatPrecision),h=e.defaultPathOperation||"S"),o=e.filters||(i===!0?["FlateEncode"]:o),n=n||"mm",t=(""+(t||"P")).toLowerCase();var g=e.putOnlyUsedFonts||!1,m={},d={internal:{},__private__:{}};d.__private__.PubSub=eh;var y="1.3",x=d.__private__.getPdfVersion=function(){return y};d.__private__.setPdfVersion=function(v){y=v};var b={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};d.__private__.getPageFormats=function(){return b};var N=d.__private__.getPageFormat=function(v){return b[v]};a=a||"a4";var w={COMPAT:"compat",ADVANCED:"advanced"},A=w.COMPAT;function E(){this.saveGraphicsState(),oe(new ut(tt,0,0,-tt,0,Xa()*tt).toString()+" cm"),this.setFontSize(this.getFontSize()/tt),h="n",A=w.ADVANCED}function W(){this.restoreGraphicsState(),h="S",A=w.COMPAT}var V=d.__private__.combineFontStyleAndFontWeight=function(v,D){if(v=="bold"&&D=="normal"||v=="bold"&&D==400||v=="normal"&&D=="italic"||v=="bold"&&D=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return D&&(v=D==400||D==="normal"?v==="italic"?"italic":"normal":D!=700&&D!=="bold"||v!=="normal"?(D==700?"bold":D)+""+v:"bold"),v};d.advancedAPI=function(v){var D=A===w.COMPAT;return D&&E.call(this),typeof v!="function"||(v(this),D&&W.call(this)),this},d.compatAPI=function(v){var D=A===w.ADVANCED;return D&&W.call(this),typeof v!="function"||(v(this),D&&E.call(this)),this},d.isAdvancedAPI=function(){return A===w.ADVANCED};var F,C=function(v){if(A!==w.ADVANCED)throw new Error(v+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},R=d.roundToPrecision=d.__private__.roundToPrecision=function(v,D){var se=r||D;if(isNaN(v)||isNaN(se))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return v.toFixed(se).replace(/0+$/,"")};F=d.hpf=d.__private__.hpf=typeof c=="number"?function(v){if(isNaN(v))throw new Error("Invalid argument passed to jsPDF.hpf");return R(v,c)}:c==="smart"?function(v){if(isNaN(v))throw new Error("Invalid argument passed to jsPDF.hpf");return R(v,v>-1&&v<1?16:5)}:function(v){if(isNaN(v))throw new Error("Invalid argument passed to jsPDF.hpf");return R(v,16)};var G=d.f2=d.__private__.f2=function(v){if(isNaN(v))throw new Error("Invalid argument passed to jsPDF.f2");return R(v,2)},j=d.__private__.f3=function(v){if(isNaN(v))throw new Error("Invalid argument passed to jsPDF.f3");return R(v,3)},T=d.scale=d.__private__.scale=function(v){if(isNaN(v))throw new Error("Invalid argument passed to jsPDF.scale");return A===w.COMPAT?v*tt:A===w.ADVANCED?v:void 0},B=function(v){return A===w.COMPAT?Xa()-v:A===w.ADVANCED?v:void 0},M=function(v){return T(B(v))};d.__private__.setPrecision=d.setPrecision=function(v){typeof parseInt(v,10)=="number"&&(r=parseInt(v,10))};var le,J="00000000000000000000000000000000",z=d.__private__.getFileId=function(){return J},ae=d.__private__.setFileId=function(v){return J=v!==void 0&&/^[a-fA-F0-9]{32}$/.test(v)?v.toUpperCase():J.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(Jr=new Ss(u.userPermissions,u.userPassword,u.ownerPassword,J)),J};d.setFileId=function(v){return ae(v),this},d.getFileId=function(){return z()};var te=d.__private__.convertDateToPDFDate=function(v){var D=v.getTimezoneOffset(),se=D<0?"+":"-",ue=Math.floor(Math.abs(D/60)),ye=Math.abs(D%60),Le=[se,P(ue),"'",P(ye),"'"].join("");return["D:",v.getFullYear(),P(v.getMonth()+1),P(v.getDate()),P(v.getHours()),P(v.getMinutes()),P(v.getSeconds()),Le].join("")},de=d.__private__.convertPDFDateToDate=function(v){var D=parseInt(v.substr(2,4),10),se=parseInt(v.substr(6,2),10)-1,ue=parseInt(v.substr(8,2),10),ye=parseInt(v.substr(10,2),10),Le=parseInt(v.substr(12,2),10),We=parseInt(v.substr(14,2),10);return new Date(D,se,ue,ye,Le,We,0)},xe=d.__private__.setCreationDate=function(v){var D;if(v===void 0&&(v=new Date),v instanceof Date)D=te(v);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(v))throw new Error("Invalid argument passed to jsPDF.setCreationDate");D=v}return le=D},_=d.__private__.getCreationDate=function(v){var D=le;return v==="jsDate"&&(D=de(le)),D};d.setCreationDate=function(v){return xe(v),this},d.getCreationDate=function(v){return _(v)};var L,P=d.__private__.padd2=function(v){return("0"+parseInt(v)).slice(-2)},O=d.__private__.padd2Hex=function(v){return("00"+(v=v.toString())).substr(v.length)},X=0,ce=[],fe=[],he=0,we=[],Pe=[],Re=!1,ze=fe,Ke=function(){X=0,he=0,fe=[],ce=[],we=[],Z=fr(),Q=fr()};d.__private__.setCustomOutputDestination=function(v){Re=!0,ze=v};var ke=function(v){Re||(ze=v)};d.__private__.resetCustomOutputDestination=function(){Re=!1,ze=fe};var oe=d.__private__.out=function(v){return v=v.toString(),he+=v.length+1,ze.push(v),ze},Me=d.__private__.write=function(v){return oe(arguments.length===1?v.toString():Array.prototype.join.call(arguments," "))},at=d.__private__.getArrayBuffer=function(v){for(var D=v.length,se=new ArrayBuffer(D),ue=new Uint8Array(se);D--;)ue[D]=v.charCodeAt(D);return se},He=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];d.__private__.getStandardFonts=function(){return He};var Ge=e.fontSize||16;d.__private__.setFontSize=d.setFontSize=function(v){return Ge=A===w.ADVANCED?v/tt:v,this};var Je,Qe=d.__private__.getFontSize=d.getFontSize=function(){return A===w.COMPAT?Ge:Ge*tt},lt=e.R2L||!1;d.__private__.setR2L=d.setR2L=function(v){return lt=v,this},d.__private__.getR2L=d.getR2L=function(){return lt};var ct,xt=d.__private__.setZoomMode=function(v){var D=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(v))Je=v;else if(isNaN(v)){if(D.indexOf(v)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+v+'" is not recognized.');Je=v}else Je=parseInt(v,10)};d.__private__.getZoomMode=function(){return Je};var _t,kt=d.__private__.setPageMode=function(v){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(v)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+v+'" is not recognized.');ct=v};d.__private__.getPageMode=function(){return ct};var Et=d.__private__.setLayoutMode=function(v){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(v)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+v+'" is not recognized.');_t=v};d.__private__.getLayoutMode=function(){return _t},d.__private__.setDisplayMode=d.setDisplayMode=function(v,D,se){return xt(v),Et(D),kt(se),this};var pt={title:"",subject:"",author:"",keywords:"",creator:""};d.__private__.getDocumentProperty=function(v){if(Object.keys(pt).indexOf(v)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return pt[v]},d.__private__.getDocumentProperties=function(){return pt},d.__private__.setDocumentProperties=d.setProperties=d.setDocumentProperties=function(v){for(var D in pt)pt.hasOwnProperty(D)&&v[D]&&(pt[D]=v[D]);return this},d.__private__.setDocumentProperty=function(v,D){if(Object.keys(pt).indexOf(v)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return pt[v]=D};var jt,tt,Fr,Lt,dn,Ht={},rr={},Rn=[],Ot={},ma={},ir={},_n={},Jn=null,Zt=0,vt=[],Dt=new eh(d),Ea=e.hotfixes||[],Lr={},Mn={},Bn=[],ut=function v(D,se,ue,ye,Le,We){if(!(this instanceof v))return new v(D,se,ue,ye,Le,We);isNaN(D)&&(D=1),isNaN(se)&&(se=0),isNaN(ue)&&(ue=0),isNaN(ye)&&(ye=1),isNaN(Le)&&(Le=0),isNaN(We)&&(We=0),this._matrix=[D,se,ue,ye,Le,We]};Object.defineProperty(ut.prototype,"sx",{get:function(){return this._matrix[0]},set:function(v){this._matrix[0]=v}}),Object.defineProperty(ut.prototype,"shy",{get:function(){return this._matrix[1]},set:function(v){this._matrix[1]=v}}),Object.defineProperty(ut.prototype,"shx",{get:function(){return this._matrix[2]},set:function(v){this._matrix[2]=v}}),Object.defineProperty(ut.prototype,"sy",{get:function(){return this._matrix[3]},set:function(v){this._matrix[3]=v}}),Object.defineProperty(ut.prototype,"tx",{get:function(){return this._matrix[4]},set:function(v){this._matrix[4]=v}}),Object.defineProperty(ut.prototype,"ty",{get:function(){return this._matrix[5]},set:function(v){this._matrix[5]=v}}),Object.defineProperty(ut.prototype,"a",{get:function(){return this._matrix[0]},set:function(v){this._matrix[0]=v}}),Object.defineProperty(ut.prototype,"b",{get:function(){return this._matrix[1]},set:function(v){this._matrix[1]=v}}),Object.defineProperty(ut.prototype,"c",{get:function(){return this._matrix[2]},set:function(v){this._matrix[2]=v}}),Object.defineProperty(ut.prototype,"d",{get:function(){return this._matrix[3]},set:function(v){this._matrix[3]=v}}),Object.defineProperty(ut.prototype,"e",{get:function(){return this._matrix[4]},set:function(v){this._matrix[4]=v}}),Object.defineProperty(ut.prototype,"f",{get:function(){return this._matrix[5]},set:function(v){this._matrix[5]=v}}),Object.defineProperty(ut.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(ut.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(ut.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(ut.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),ut.prototype.join=function(v){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(F).join(v)},ut.prototype.multiply=function(v){var D=v.sx*this.sx+v.shy*this.shx,se=v.sx*this.shy+v.shy*this.sy,ue=v.shx*this.sx+v.sy*this.shx,ye=v.shx*this.shy+v.sy*this.sy,Le=v.tx*this.sx+v.ty*this.shx+this.tx,We=v.tx*this.shy+v.ty*this.sy+this.ty;return new ut(D,se,ue,ye,Le,We)},ut.prototype.decompose=function(){var v=this.sx,D=this.shy,se=this.shx,ue=this.sy,ye=this.tx,Le=this.ty,We=Math.sqrt(v*v+D*D),it=(v/=We)*se+(D/=We)*ue;se-=v*it,ue-=D*it;var ft=Math.sqrt(se*se+ue*ue);return it/=ft,v*(ue/=ft)<D*(se/=ft)&&(v=-v,D=-D,it=-it,We=-We),{scale:new ut(We,0,0,ft,0,0),translate:new ut(1,0,0,1,ye,Le),rotate:new ut(v,D,-D,v,0,0),skew:new ut(1,0,it,1,0,0)}},ut.prototype.toString=function(v){return this.join(" ")},ut.prototype.inversed=function(){var v=this.sx,D=this.shy,se=this.shx,ue=this.sy,ye=this.tx,Le=this.ty,We=1/(v*ue-D*se),it=ue*We,ft=-D*We,Nt=-se*We,wt=v*We;return new ut(it,ft,Nt,wt,-it*ye-Nt*Le,-ft*ye-wt*Le)},ut.prototype.applyToPoint=function(v){var D=v.x*this.sx+v.y*this.shx+this.tx,se=v.x*this.shy+v.y*this.sy+this.ty;return new ts(D,se)},ut.prototype.applyToRectangle=function(v){var D=this.applyToPoint(v),se=this.applyToPoint(new ts(v.x+v.w,v.y+v.h));return new Gs(D.x,D.y,se.x-D.x,se.y-D.y)},ut.prototype.clone=function(){var v=this.sx,D=this.shy,se=this.shx,ue=this.sy,ye=this.tx,Le=this.ty;return new ut(v,D,se,ue,ye,Le)},d.Matrix=ut;var An=d.matrixMult=function(v,D){return D.multiply(v)},pn=new ut(1,0,0,1,0,0);d.unitMatrix=d.identityMatrix=pn;var Kr=function(v,D){if(!ma[v]){var se=(D instanceof hi?"Sh":"P")+(Object.keys(Ot).length+1).toString(10);D.id=se,ma[v]=se,Ot[se]=D,Dt.publish("addPattern",D)}};d.ShadingPattern=hi,d.TilingPattern=Oi,d.addShadingPattern=function(v,D){return C("addShadingPattern()"),Kr(v,D),this},d.beginTilingPattern=function(v){C("beginTilingPattern()"),ll(v.boundingBox[0],v.boundingBox[1],v.boundingBox[2]-v.boundingBox[0],v.boundingBox[3]-v.boundingBox[1],v.matrix)},d.endTilingPattern=function(v,D){C("endTilingPattern()"),D.stream=Pe[L].join(`
`),Kr(v,D),Dt.publish("endTilingPattern",D),Bn.pop().restore()};var gr=d.__private__.newObject=function(){var v=fr();return H(v,!0),v},fr=d.__private__.newObjectDeferred=function(){return X++,ce[X]=function(){return he},X},H=function(v,D){return D=typeof D=="boolean"&&D,ce[v]=he,D&&oe(v+" 0 obj"),v},ne=d.__private__.newAdditionalObject=function(){var v={objId:fr(),content:""};return we.push(v),v},Z=fr(),Q=fr(),re=d.__private__.decodeColorString=function(v){var D=v.split(" ");if(D.length!==2||D[1]!=="g"&&D[1]!=="G")D.length===5&&(D[4]==="k"||D[4]==="K")&&(D=[(1-D[0])*(1-D[3]),(1-D[1])*(1-D[3]),(1-D[2])*(1-D[3]),"r"]);else{var se=parseFloat(D[0]);D=[se,se,se,"r"]}for(var ue="#",ye=0;ye<3;ye++)ue+=("0"+Math.floor(255*parseFloat(D[ye])).toString(16)).slice(-2);return ue},ie=d.__private__.encodeColorString=function(v){var D;typeof v=="string"&&(v={ch1:v});var se=v.ch1,ue=v.ch2,ye=v.ch3,Le=v.ch4,We=v.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof se=="string"&&se.charAt(0)!=="#"){var it=new vu(se);if(it.ok)se=it.toHex();else if(!/^\d*\.?\d*$/.test(se))throw new Error('Invalid color "'+se+'" passed to jsPDF.encodeColorString.')}if(typeof se=="string"&&/^#[0-9A-Fa-f]{3}$/.test(se)&&(se="#"+se[1]+se[1]+se[2]+se[2]+se[3]+se[3]),typeof se=="string"&&/^#[0-9A-Fa-f]{6}$/.test(se)){var ft=parseInt(se.substr(1),16);se=ft>>16&255,ue=ft>>8&255,ye=255&ft}if(ue===void 0||Le===void 0&&se===ue&&ue===ye)if(typeof se=="string")D=se+" "+We[0];else switch(v.precision){case 2:D=G(se/255)+" "+We[0];break;case 3:default:D=j(se/255)+" "+We[0]}else if(Le===void 0||tr(Le)==="object"){if(Le&&!isNaN(Le.a)&&Le.a===0)return D=["1.","1.","1.",We[1]].join(" ");if(typeof se=="string")D=[se,ue,ye,We[1]].join(" ");else switch(v.precision){case 2:D=[G(se/255),G(ue/255),G(ye/255),We[1]].join(" ");break;default:case 3:D=[j(se/255),j(ue/255),j(ye/255),We[1]].join(" ")}}else if(typeof se=="string")D=[se,ue,ye,Le,We[2]].join(" ");else switch(v.precision){case 2:D=[G(se),G(ue),G(ye),G(Le),We[2]].join(" ");break;case 3:default:D=[j(se),j(ue),j(ye),j(Le),We[2]].join(" ")}return D},Ne=d.__private__.getFilters=function(){return o},Ee=d.__private__.putStream=function(v){var D=(v=v||{}).data||"",se=v.filters||Ne(),ue=v.alreadyAppliedFilters||[],ye=v.addLength1||!1,Le=D.length,We=v.objectId,it=function(Zr){return Zr};if(u!==null&&We===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(it=Jr.encryptor(We,0));var ft={};se===!0&&(se=["FlateEncode"]);var Nt=v.additionalKeyValues||[],wt=(ft=ht.API.processDataByFilters!==void 0?ht.API.processDataByFilters(D,se):{data:D,reverseChain:[]}).reverseChain+(Array.isArray(ue)?ue.join(" "):ue.toString());if(ft.data.length!==0&&(Nt.push({key:"Length",value:ft.data.length}),ye===!0&&Nt.push({key:"Length1",value:Le})),wt.length!=0)if(wt.split("/").length-1==1)Nt.push({key:"Filter",value:wt});else{Nt.push({key:"Filter",value:"["+wt+"]"});for(var Pt=0;Pt<Nt.length;Pt+=1)if(Nt[Pt].key==="DecodeParms"){for(var cr=[],hr=0;hr<ft.reverseChain.split("/").length-1;hr+=1)cr.push("null");cr.push(Nt[Pt].value),Nt[Pt].value="["+cr.join(" ")+"]"}}oe("<<");for(var _r=0;_r<Nt.length;_r++)oe("/"+Nt[_r].key+" "+Nt[_r].value);oe(">>"),ft.data.length!==0&&(oe("stream"),oe(it(ft.data)),oe("endstream"))},be=d.__private__.putPage=function(v){var D=v.number,se=v.data,ue=v.objId,ye=v.contentsObjId;H(ue,!0),oe("<</Type /Page"),oe("/Parent "+v.rootDictionaryObjId+" 0 R"),oe("/Resources "+v.resourceDictionaryObjId+" 0 R"),oe("/MediaBox ["+parseFloat(F(v.mediaBox.bottomLeftX))+" "+parseFloat(F(v.mediaBox.bottomLeftY))+" "+F(v.mediaBox.topRightX)+" "+F(v.mediaBox.topRightY)+"]"),v.cropBox!==null&&oe("/CropBox ["+F(v.cropBox.bottomLeftX)+" "+F(v.cropBox.bottomLeftY)+" "+F(v.cropBox.topRightX)+" "+F(v.cropBox.topRightY)+"]"),v.bleedBox!==null&&oe("/BleedBox ["+F(v.bleedBox.bottomLeftX)+" "+F(v.bleedBox.bottomLeftY)+" "+F(v.bleedBox.topRightX)+" "+F(v.bleedBox.topRightY)+"]"),v.trimBox!==null&&oe("/TrimBox ["+F(v.trimBox.bottomLeftX)+" "+F(v.trimBox.bottomLeftY)+" "+F(v.trimBox.topRightX)+" "+F(v.trimBox.topRightY)+"]"),v.artBox!==null&&oe("/ArtBox ["+F(v.artBox.bottomLeftX)+" "+F(v.artBox.bottomLeftY)+" "+F(v.artBox.topRightX)+" "+F(v.artBox.topRightY)+"]"),typeof v.userUnit=="number"&&v.userUnit!==1&&oe("/UserUnit "+v.userUnit),Dt.publish("putPage",{objId:ue,pageContext:vt[D],pageNumber:D,page:se}),oe("/Contents "+ye+" 0 R"),oe(">>"),oe("endobj");var Le=se.join(`
`);return A===w.ADVANCED&&(Le+=`
Q`),H(ye,!0),Ee({data:Le,filters:Ne(),objectId:ye}),oe("endobj"),ue},Ae=d.__private__.putPages=function(){var v,D,se=[];for(v=1;v<=Zt;v++)vt[v].objId=fr(),vt[v].contentsObjId=fr();for(v=1;v<=Zt;v++)se.push(be({number:v,data:Pe[v],objId:vt[v].objId,contentsObjId:vt[v].contentsObjId,mediaBox:vt[v].mediaBox,cropBox:vt[v].cropBox,bleedBox:vt[v].bleedBox,trimBox:vt[v].trimBox,artBox:vt[v].artBox,userUnit:vt[v].userUnit,rootDictionaryObjId:Z,resourceDictionaryObjId:Q}));H(Z,!0),oe("<</Type /Pages");var ue="/Kids [";for(D=0;D<Zt;D++)ue+=se[D]+" 0 R ";oe(ue+"]"),oe("/Count "+Zt),oe(">>"),oe("endobj"),Dt.publish("postPutPages")},je=function(v){Dt.publish("putFont",{font:v,out:oe,newObject:gr,putStream:Ee}),v.isAlreadyPutted!==!0&&(v.objectNumber=gr(),oe("<<"),oe("/Type /Font"),oe("/BaseFont /"+_s(v.postScriptName)),oe("/Subtype /Type1"),typeof v.encoding=="string"&&oe("/Encoding /"+v.encoding),oe("/FirstChar 32"),oe("/LastChar 255"),oe(">>"),oe("endobj"))},qe=function(){for(var v in Ht)Ht.hasOwnProperty(v)&&(g===!1||g===!0&&m.hasOwnProperty(v))&&je(Ht[v])},$e=function(v){v.objectNumber=gr();var D=[];D.push({key:"Type",value:"/XObject"}),D.push({key:"Subtype",value:"/Form"}),D.push({key:"BBox",value:"["+[F(v.x),F(v.y),F(v.x+v.width),F(v.y+v.height)].join(" ")+"]"}),D.push({key:"Matrix",value:"["+v.matrix.toString()+"]"});var se=v.pages[1].join(`
`);Ee({data:se,additionalKeyValues:D,objectId:v.objectNumber}),oe("endobj")},nt=function(){for(var v in Lr)Lr.hasOwnProperty(v)&&$e(Lr[v])},Ve=function(v,D){var se,ue=[],ye=1/(D-1);for(se=0;se<1;se+=ye)ue.push(se);if(ue.push(1),v[0].offset!=0){var Le={offset:0,color:v[0].color};v.unshift(Le)}if(v[v.length-1].offset!=1){var We={offset:1,color:v[v.length-1].color};v.push(We)}for(var it="",ft=0,Nt=0;Nt<ue.length;Nt++){for(se=ue[Nt];se>v[ft+1].offset;)ft++;var wt=v[ft].offset,Pt=(se-wt)/(v[ft+1].offset-wt),cr=v[ft].color,hr=v[ft+1].color;it+=O(Math.round((1-Pt)*cr[0]+Pt*hr[0]).toString(16))+O(Math.round((1-Pt)*cr[1]+Pt*hr[1]).toString(16))+O(Math.round((1-Pt)*cr[2]+Pt*hr[2]).toString(16))}return it.trim()},rt=function(v,D){D||(D=21);var se=gr(),ue=Ve(v.colors,D),ye=[];ye.push({key:"FunctionType",value:"0"}),ye.push({key:"Domain",value:"[0.0 1.0]"}),ye.push({key:"Size",value:"["+D+"]"}),ye.push({key:"BitsPerSample",value:"8"}),ye.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ye.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ee({data:ue,additionalKeyValues:ye,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:se}),oe("endobj"),v.objectNumber=gr(),oe("<< /ShadingType "+v.type),oe("/ColorSpace /DeviceRGB");var Le="/Coords ["+F(parseFloat(v.coords[0]))+" "+F(parseFloat(v.coords[1]))+" ";v.type===2?Le+=F(parseFloat(v.coords[2]))+" "+F(parseFloat(v.coords[3])):Le+=F(parseFloat(v.coords[2]))+" "+F(parseFloat(v.coords[3]))+" "+F(parseFloat(v.coords[4]))+" "+F(parseFloat(v.coords[5])),oe(Le+="]"),v.matrix&&oe("/Matrix ["+v.matrix.toString()+"]"),oe("/Function "+se+" 0 R"),oe("/Extend [true true]"),oe(">>"),oe("endobj")},gt=function(v,D){var se=fr(),ue=gr();D.push({resourcesOid:se,objectOid:ue}),v.objectNumber=ue;var ye=[];ye.push({key:"Type",value:"/Pattern"}),ye.push({key:"PatternType",value:"1"}),ye.push({key:"PaintType",value:"1"}),ye.push({key:"TilingType",value:"1"}),ye.push({key:"BBox",value:"["+v.boundingBox.map(F).join(" ")+"]"}),ye.push({key:"XStep",value:F(v.xStep)}),ye.push({key:"YStep",value:F(v.yStep)}),ye.push({key:"Resources",value:se+" 0 R"}),v.matrix&&ye.push({key:"Matrix",value:"["+v.matrix.toString()+"]"}),Ee({data:v.stream,additionalKeyValues:ye,objectId:v.objectNumber}),oe("endobj")},Wt=function(v){var D;for(D in Ot)Ot.hasOwnProperty(D)&&(Ot[D]instanceof hi?rt(Ot[D]):Ot[D]instanceof Oi&&gt(Ot[D],v))},Xt=function(v){for(var D in v.objectNumber=gr(),oe("<<"),v)switch(D){case"opacity":oe("/ca "+G(v[D]));break;case"stroke-opacity":oe("/CA "+G(v[D]))}oe(">>"),oe("endobj")},Sr=function(){var v;for(v in ir)ir.hasOwnProperty(v)&&Xt(ir[v])},Zn=function(){for(var v in oe("/XObject <<"),Lr)Lr.hasOwnProperty(v)&&Lr[v].objectNumber>=0&&oe("/"+v+" "+Lr[v].objectNumber+" 0 R");Dt.publish("putXobjectDict"),oe(">>")},Fa=function(){Jr.oid=gr(),oe("<<"),oe("/Filter /Standard"),oe("/V "+Jr.v),oe("/R "+Jr.r),oe("/U <"+Jr.toHexString(Jr.U)+">"),oe("/O <"+Jr.toHexString(Jr.O)+">"),oe("/P "+Jr.P),oe(">>"),oe("endobj")},ga=function(){for(var v in oe("/Font <<"),Ht)Ht.hasOwnProperty(v)&&(g===!1||g===!0&&m.hasOwnProperty(v))&&oe("/"+v+" "+Ht[v].objectNumber+" 0 R");oe(">>")},Qn=function(){if(Object.keys(Ot).length>0){for(var v in oe("/Shading <<"),Ot)Ot.hasOwnProperty(v)&&Ot[v]instanceof hi&&Ot[v].objectNumber>=0&&oe("/"+v+" "+Ot[v].objectNumber+" 0 R");Dt.publish("putShadingPatternDict"),oe(">>")}},xa=function(v){if(Object.keys(Ot).length>0){for(var D in oe("/Pattern <<"),Ot)Ot.hasOwnProperty(D)&&Ot[D]instanceof d.TilingPattern&&Ot[D].objectNumber>=0&&Ot[D].objectNumber<v&&oe("/"+D+" "+Ot[D].objectNumber+" 0 R");Dt.publish("putTilingPatternDict"),oe(">>")}},jn=function(){if(Object.keys(ir).length>0){var v;for(v in oe("/ExtGState <<"),ir)ir.hasOwnProperty(v)&&ir[v].objectNumber>=0&&oe("/"+v+" "+ir[v].objectNumber+" 0 R");Dt.publish("putGStateDict"),oe(">>")}},xr=function(v){H(v.resourcesOid,!0),oe("<<"),oe("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),ga(),Qn(),xa(v.objectOid),jn(),Zn(),oe(">>"),oe("endobj")},$o=function(){var v=[];qe(),Sr(),nt(),Wt(v),Dt.publish("putResources"),v.forEach(xr),xr({resourcesOid:Q,objectOid:Number.MAX_SAFE_INTEGER}),Dt.publish("postPutResources")},Yo=function(){Dt.publish("putAdditionalObjects");for(var v=0;v<we.length;v++){var D=we[v];H(D.objId,!0),oe(D.content),oe("endobj")}Dt.publish("postPutAdditionalObjects")},Xo=function(v){rr[v.fontName]=rr[v.fontName]||{},rr[v.fontName][v.fontStyle]=v.id},Rs=function(v,D,se,ue,ye){var Le={id:"F"+(Object.keys(Ht).length+1).toString(10),postScriptName:v,fontName:D,fontStyle:se,encoding:ue,isStandardFont:ye||!1,metadata:{}};return Dt.publish("addFont",{font:Le,instance:this}),Ht[Le.id]=Le,Xo(Le),Le.id},Nc=function(v){for(var D=0,se=He.length;D<se;D++){var ue=Rs.call(this,v[D][0],v[D][1],v[D][2],He[D][3],!0);g===!1&&(m[ue]=!0);var ye=v[D][0].split("-");Xo({id:ue,fontName:ye[0],fontStyle:ye[1]||""})}Dt.publish("addFonts",{fonts:Ht,dictionary:rr})},ea=function(v){return v.foo=function(){try{return v.apply(this,arguments)}catch(ue){var D=ue.stack||"";~D.indexOf(" at ")&&(D=D.split(" at ")[1]);var se="Error in function "+D.split(`
`)[0].split("<")[0]+": "+ue.message;if(!mt.console)throw new Error(se);mt.console.error(se,ue),mt.alert&&alert(se)}},v.foo.bar=v,v.foo},Xi=function(v,D){var se,ue,ye,Le,We,it,ft,Nt,wt;if(ye=(D=D||{}).sourceEncoding||"Unicode",We=D.outputEncoding,(D.autoencode||We)&&Ht[jt].metadata&&Ht[jt].metadata[ye]&&Ht[jt].metadata[ye].encoding&&(Le=Ht[jt].metadata[ye].encoding,!We&&Ht[jt].encoding&&(We=Ht[jt].encoding),!We&&Le.codePages&&(We=Le.codePages[0]),typeof We=="string"&&(We=Le[We]),We)){for(ft=!1,it=[],se=0,ue=v.length;se<ue;se++)(Nt=We[v.charCodeAt(se)])?it.push(String.fromCharCode(Nt)):it.push(v[se]),it[se].charCodeAt(0)>>8&&(ft=!0);v=it.join("")}for(se=v.length;ft===void 0&&se!==0;)v.charCodeAt(se-1)>>8&&(ft=!0),se--;if(!ft)return v;for(it=D.noBOM?[]:[254,255],se=0,ue=v.length;se<ue;se++){if((wt=(Nt=v.charCodeAt(se))>>8)>>8)throw new Error("Character at position "+se+" of string '"+v+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");it.push(wt),it.push(Nt-(wt<<8))}return String.fromCharCode.apply(void 0,it)},mn=d.__private__.pdfEscape=d.pdfEscape=function(v,D){return Xi(v,D).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Ms=d.__private__.beginPage=function(v){Pe[++Zt]=[],vt[Zt]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(v[0]),topRightY:Number(v[1])}},Jo(Zt),ke(Pe[L])},Ko=function(v,D){var se,ue,ye;switch(t=D||t,typeof v=="string"&&(se=N(v.toLowerCase()),Array.isArray(se)&&(ue=se[0],ye=se[1])),Array.isArray(v)&&(ue=v[0]*tt,ye=v[1]*tt),isNaN(ue)&&(ue=a[0],ye=a[1]),(ue>14400||ye>14400)&&(er.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),ue=Math.min(14400,ue),ye=Math.min(14400,ye)),a=[ue,ye],t.substr(0,1)){case"l":ye>ue&&(a=[ye,ue]);break;case"p":ue>ye&&(a=[ye,ue])}Ms(a),nl(Ws),oe(ta),zs!==0&&oe(zs+" J"),Vs!==0&&oe(Vs+" j"),Dt.publish("addPage",{pageNumber:Zt})},Sc=function(v){v>0&&v<=Zt&&(Pe.splice(v,1),vt.splice(v,1),Zt--,L>Zt&&(L=Zt),this.setPage(L))},Jo=function(v){v>0&&v<=Zt&&(L=v)},_c=d.__private__.getNumberOfPages=d.getNumberOfPages=function(){return Pe.length-1},Zo=function(v,D,se){var ue,ye=void 0;return se=se||{},v=v!==void 0?v:Ht[jt].fontName,D=D!==void 0?D:Ht[jt].fontStyle,ue=v.toLowerCase(),rr[ue]!==void 0&&rr[ue][D]!==void 0?ye=rr[ue][D]:rr[v]!==void 0&&rr[v][D]!==void 0?ye=rr[v][D]:se.disableWarning===!1&&er.warn("Unable to look up font label for font '"+v+"', '"+D+"'. Refer to getFontList() for available fonts."),ye||se.noFallback||(ye=rr.times[D])==null&&(ye=rr.times.normal),ye},Ac=d.__private__.putInfo=function(){var v=gr(),D=function(ue){return ue};for(var se in u!==null&&(D=Jr.encryptor(v,0)),oe("<<"),oe("/Producer ("+mn(D("jsPDF "+ht.version))+")"),pt)pt.hasOwnProperty(se)&&pt[se]&&oe("/"+se.substr(0,1).toUpperCase()+se.substr(1)+" ("+mn(D(pt[se]))+")");oe("/CreationDate ("+mn(D(le))+")"),oe(">>"),oe("endobj")},Bs=d.__private__.putCatalog=function(v){var D=(v=v||{}).rootDictionaryObjId||Z;switch(gr(),oe("<<"),oe("/Type /Catalog"),oe("/Pages "+D+" 0 R"),Je||(Je="fullwidth"),Je){case"fullwidth":oe("/OpenAction [3 0 R /FitH null]");break;case"fullheight":oe("/OpenAction [3 0 R /FitV null]");break;case"fullpage":oe("/OpenAction [3 0 R /Fit]");break;case"original":oe("/OpenAction [3 0 R /XYZ null null 1]");break;default:var se=""+Je;se.substr(se.length-1)==="%"&&(Je=parseInt(Je)/100),typeof Je=="number"&&oe("/OpenAction [3 0 R /XYZ null null "+G(Je)+"]")}switch(_t||(_t="continuous"),_t){case"continuous":oe("/PageLayout /OneColumn");break;case"single":oe("/PageLayout /SinglePage");break;case"two":case"twoleft":oe("/PageLayout /TwoColumnLeft");break;case"tworight":oe("/PageLayout /TwoColumnRight")}ct&&oe("/PageMode /"+ct),Dt.publish("putCatalog"),oe(">>"),oe("endobj")},jc=d.__private__.putTrailer=function(){oe("trailer"),oe("<<"),oe("/Size "+(X+1)),oe("/Root "+X+" 0 R"),oe("/Info "+(X-1)+" 0 R"),u!==null&&oe("/Encrypt "+Jr.oid+" 0 R"),oe("/ID [ <"+J+"> <"+J+"> ]"),oe(">>")},Tc=d.__private__.putHeader=function(){oe("%PDF-"+y),oe("%ÂºÃŸÂ¬Ã ")},kc=d.__private__.putXRef=function(){var v="0000000000";oe("xref"),oe("0 "+(X+1)),oe("0000000000 65535 f ");for(var D=1;D<=X;D++)typeof ce[D]=="function"?oe((v+ce[D]()).slice(-10)+" 00000 n "):ce[D]!==void 0?oe((v+ce[D]).slice(-10)+" 00000 n "):oe("0000000000 00000 n ")},La=d.__private__.buildDocument=function(){Ke(),ke(fe),Dt.publish("buildDocument"),Tc(),Ae(),Yo(),$o(),u!==null&&Fa(),Ac(),Bs();var v=he;return kc(),jc(),oe("startxref"),oe(""+v),oe("%%EOF"),ke(Pe[L]),fe.join(`
`)},Ki=d.__private__.getBlob=function(v){return new Blob([at(v)],{type:"application/pdf"})},Ji=d.output=d.__private__.output=ea(function(v,D){switch(typeof(D=D||{})=="string"?D={filename:D}:D.filename=D.filename||"generated.pdf",v){case void 0:return La();case"save":d.save(D.filename);break;case"arraybuffer":return at(La());case"blob":return Ki(La());case"bloburi":case"bloburl":if(mt.URL!==void 0&&typeof mt.URL.createObjectURL=="function")return mt.URL&&mt.URL.createObjectURL(Ki(La()))||void 0;er.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var se="",ue=La();try{se=P0(ue)}catch{se=P0(unescape(encodeURIComponent(ue)))}return"data:application/pdf;filename="+D.filename+";base64,"+se;case"pdfobjectnewwindow":if(Object.prototype.toString.call(mt)==="[object Window]"){var ye="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Le=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';D.pdfObjectUrl&&(ye=D.pdfObjectUrl,Le="");var We='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ye+'"'+Le+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(D)+");<\/script></body></html>",it=mt.open();return it!==null&&it.document.write(We),it}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(mt)==="[object Window]"){var ft='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(D.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+D.filename+'" width="500px" height="400px" /></body></html>',Nt=mt.open();if(Nt!==null){Nt.document.write(ft);var wt=this;Nt.document.documentElement.querySelector("#pdfViewer").onload=function(){Nt.document.title=D.filename,Nt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(wt.output("bloburl"))}}return Nt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(mt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Pt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",D)+'"></iframe></body></html>',cr=mt.open();if(cr!==null&&(cr.document.write(Pt),cr.document.title=D.filename),cr||typeof safari>"u")return cr;break;case"datauri":case"dataurl":return mt.document.location.href=this.output("datauristring",D);default:return null}}),Qo=function(v){return Array.isArray(Ea)===!0&&Ea.indexOf(v)>-1};switch(n){case"pt":tt=1;break;case"mm":tt=72/25.4;break;case"cm":tt=72/2.54;break;case"in":tt=72;break;case"px":tt=Qo("px_scaling")==1?.75:96/72;break;case"pc":case"em":tt=12;break;case"ex":tt=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);tt=n}var Jr=null;xe(),ae();var Ec=function(v){return u!==null?Jr.encryptor(v,0):function(D){return D}},el=d.__private__.getPageInfo=d.getPageInfo=function(v){if(isNaN(v)||v%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:vt[v].objId,pageNumber:v,pageContext:vt[v]}},yt=d.__private__.getPageInfoByObjId=function(v){if(isNaN(v)||v%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var D in vt)if(vt[D].objId===v)break;return el(D)},Fc=d.__private__.getCurrentPageInfo=d.getCurrentPageInfo=function(){return{objId:vt[L].objId,pageNumber:L,pageContext:vt[L]}};d.addPage=function(){return Ko.apply(this,arguments),this},d.setPage=function(){return Jo.apply(this,arguments),ke.call(this,Pe[L]),this},d.insertPage=function(v){return this.addPage(),this.movePage(L,v),this},d.movePage=function(v,D){var se,ue;if(v>D){se=Pe[v],ue=vt[v];for(var ye=v;ye>D;ye--)Pe[ye]=Pe[ye-1],vt[ye]=vt[ye-1];Pe[D]=se,vt[D]=ue,this.setPage(D)}else if(v<D){se=Pe[v],ue=vt[v];for(var Le=v;Le<D;Le++)Pe[Le]=Pe[Le+1],vt[Le]=vt[Le+1];Pe[D]=se,vt[D]=ue,this.setPage(D)}return this},d.deletePage=function(){return Sc.apply(this,arguments),this},d.__private__.text=d.text=function(v,D,se,ue,ye){var Le,We,it,ft,Nt,wt,Pt,cr,hr,_r=(ue=ue||{}).scope||this;if(typeof v=="number"&&typeof D=="number"&&(typeof se=="string"||Array.isArray(se))){var Zr=se;se=D,D=v,v=Zr}if(arguments[3]instanceof ut?(C("The transform parameter of text() with a Matrix value"),hr=ye):(it=arguments[4],ft=arguments[5],tr(Pt=arguments[3])==="object"&&Pt!==null||(typeof it=="string"&&(ft=it,it=null),typeof Pt=="string"&&(ft=Pt,Pt=null),typeof Pt=="number"&&(it=Pt,Pt=null),ue={flags:Pt,angle:it,align:ft})),isNaN(D)||isNaN(se)||v==null)throw new Error("Invalid arguments passed to jsPDF.text");if(v.length===0)return _r;var Dr="",ra=!1,Tn=typeof ue.lineHeightFactor=="number"?ue.lineHeightFactor:Si,wa=_r.internal.scaleFactor;function cl(nr){return nr=nr.split("	").join(Array(ue.TabLen||9).join(" ")),mn(nr,Pt)}function Ks(nr){for(var ar,yr=nr.concat(),Cr=[],Da=yr.length;Da--;)typeof(ar=yr.shift())=="string"?Cr.push(ar):Array.isArray(nr)&&(ar.length===1||ar[1]===void 0&&ar[2]===void 0)?Cr.push(ar[0]):Cr.push([ar[0],ar[1],ar[2]]);return Cr}function Js(nr,ar){var yr;if(typeof nr=="string")yr=ar(nr)[0];else if(Array.isArray(nr)){for(var Cr,Da,io=nr.concat(),us=[],pl=io.length;pl--;)typeof(Cr=io.shift())=="string"?us.push(ar(Cr)[0]):Array.isArray(Cr)&&typeof Cr[0]=="string"&&(Da=ar(Cr[0],Cr[1],Cr[2]),us.push([Da[0],Da[1],Da[2]]));yr=us}return yr}var ns=!1,Zs=!0;if(typeof v=="string")ns=!0;else if(Array.isArray(v)){var Qs=v.concat();We=[];for(var as,Wr=Qs.length;Wr--;)(typeof(as=Qs.shift())!="string"||Array.isArray(as)&&typeof as[0]!="string")&&(Zs=!1);ns=Zs}if(ns===!1)throw new Error('Type of text must be string or Array. "'+v+'" is not recognized.');typeof v=="string"&&(v=v.match(/[\r?\n]/)?v.split(/\r\n|\r|\n/g):[v]);var is=Ge/_r.internal.scaleFactor,ss=is*(Tn-1);switch(ue.baseline){case"bottom":se-=ss;break;case"top":se+=is-ss;break;case"hanging":se+=is-2*ss;break;case"middle":se+=is/2-ss}if((wt=ue.maxWidth||0)>0&&(typeof v=="string"?v=_r.splitTextToSize(v,wt):Object.prototype.toString.call(v)==="[object Array]"&&(v=v.reduce(function(nr,ar){return nr.concat(_r.splitTextToSize(ar,wt))},[]))),Le={text:v,x:D,y:se,options:ue,mutex:{pdfEscape:mn,activeFontKey:jt,fonts:Ht,activeFontSize:Ge}},Dt.publish("preProcessText",Le),v=Le.text,it=(ue=Le.options).angle,!(hr instanceof ut)&&it&&typeof it=="number"){it*=Math.PI/180,ue.rotationDirection===0&&(it=-it),A===w.ADVANCED&&(it=-it);var os=Math.cos(it),eo=Math.sin(it);hr=new ut(os,eo,-eo,os,0,0)}else it&&it instanceof ut&&(hr=it);A!==w.ADVANCED||hr||(hr=pn),(Nt=ue.charSpace||es)!==void 0&&(Dr+=F(T(Nt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(cr=ue.horizontalScale)!==void 0&&(Dr+=F(100*cr)+` Tz
`),ue.lang;var gn=-1,Uc=ue.renderingMode!==void 0?ue.renderingMode:ue.stroke,to=_r.internal.getCurrentPageInfo().pageContext;switch(Uc){case 0:case!1:case"fill":gn=0;break;case 1:case!0:case"stroke":gn=1;break;case 2:case"fillThenStroke":gn=2;break;case 3:case"invisible":gn=3;break;case 4:case"fillAndAddForClipping":gn=4;break;case 5:case"strokeAndAddPathForClipping":gn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":gn=6;break;case 7:case"addToPathForClipping":gn=7}var fl=to.usedRenderingMode!==void 0?to.usedRenderingMode:-1;gn!==-1?Dr+=gn+` Tr
`:fl!==-1&&(Dr+=`0 Tr
`),gn!==-1&&(to.usedRenderingMode=gn),ft=ue.align||"left";var Un,ls=Ge*Tn,hl=_r.internal.pageSize.getWidth(),ul=Ht[jt];Nt=ue.charSpace||es,wt=ue.maxWidth||0,Pt=Object.assign({autoencode:!0,noBOM:!0},ue.flags);var Ka=[],ji=function(nr){return _r.getStringUnitWidth(nr,{font:ul,charSpace:Nt,fontSize:Ge,doKerning:!1})*Ge/wa};if(Object.prototype.toString.call(v)==="[object Array]"){var xn;We=Ks(v),ft!=="left"&&(Un=We.map(ji));var on,Ja=0;if(ft==="right"){D-=Un[0],v=[],Wr=We.length;for(var Pa=0;Pa<Wr;Pa++)Pa===0?(on=ya(D),xn=Ca(se)):(on=T(Ja-Un[Pa]),xn=-ls),v.push([We[Pa],on,xn]),Ja=Un[Pa]}else if(ft==="center"){D-=Un[0]/2,v=[],Wr=We.length;for(var Oa=0;Oa<Wr;Oa++)Oa===0?(on=ya(D),xn=Ca(se)):(on=T((Ja-Un[Oa])/2),xn=-ls),v.push([We[Oa],on,xn]),Ja=Un[Oa]}else if(ft==="left"){v=[],Wr=We.length;for(var cs=0;cs<Wr;cs++)v.push(We[cs])}else if(ft==="justify"&&ul.encoding==="Identity-H"){v=[],Wr=We.length,wt=wt!==0?wt:hl;for(var Ia=0,vr=0;vr<Wr;vr++)if(xn=vr===0?Ca(se):-ls,on=vr===0?ya(D):Ia,vr<Wr-1){var ro=T((wt-Un[vr])/(We[vr].split(" ").length-1)),ln=We[vr].split(" ");v.push([ln[0]+" ",on,xn]),Ia=0;for(var Hn=1;Hn<ln.length;Hn++){var fs=(ji(ln[Hn-1]+" "+ln[Hn])-ji(ln[Hn]))*wa+ro;Hn==ln.length-1?v.push([ln[Hn],fs,0]):v.push([ln[Hn]+" ",fs,0]),Ia-=fs}}else v.push([We[vr],on,xn]);v.push(["",Ia,0])}else{if(ft!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(v=[],Wr=We.length,wt=wt!==0?wt:hl,vr=0;vr<Wr;vr++)xn=vr===0?Ca(se):-ls,on=vr===0?ya(D):0,vr<Wr-1?Ka.push(F(T((wt-Un[vr])/(We[vr].split(" ").length-1)))):Ka.push(0),v.push([We[vr],on,xn])}}var dl=typeof ue.R2L=="boolean"?ue.R2L:lt;dl===!0&&(v=Js(v,function(nr,ar,yr){return[nr.split("").reverse().join(""),ar,yr]})),Le={text:v,x:D,y:se,options:ue,mutex:{pdfEscape:mn,activeFontKey:jt,fonts:Ht,activeFontSize:Ge}},Dt.publish("postProcessText",Le),v=Le.text,ra=Le.mutex.isHex||!1;var no=Ht[jt].encoding;no!=="WinAnsiEncoding"&&no!=="StandardEncoding"||(v=Js(v,function(nr,ar,yr){return[cl(nr),ar,yr]})),We=Ks(v),v=[];for(var Ti,ki,Za,Ei=0,hs=1,Fi=Array.isArray(We[0])?hs:Ei,Qa="",ao=function(nr,ar,yr){var Cr="";return yr instanceof ut?(yr=typeof ue.angle=="number"?An(yr,new ut(1,0,0,1,nr,ar)):An(new ut(1,0,0,1,nr,ar),yr),A===w.ADVANCED&&(yr=An(new ut(1,0,0,-1,0,0),yr)),Cr=yr.join(" ")+` Tm
`):Cr=F(nr)+" "+F(ar)+` Td
`,Cr},Wn=0;Wn<We.length;Wn++){switch(Qa="",Fi){case hs:Za=(ra?"<":"(")+We[Wn][0]+(ra?">":")"),Ti=parseFloat(We[Wn][1]),ki=parseFloat(We[Wn][2]);break;case Ei:Za=(ra?"<":"(")+We[Wn]+(ra?">":")"),Ti=ya(D),ki=Ca(se)}Ka!==void 0&&Ka[Wn]!==void 0&&(Qa=Ka[Wn]+` Tw
`),Wn===0?v.push(Qa+ao(Ti,ki,hr)+Za):Fi===Ei?v.push(Qa+Za):Fi===hs&&v.push(Qa+ao(Ti,ki,hr)+Za)}v=Fi===Ei?v.join(` Tj
T* `):v.join(` Tj
`),v+=` Tj
`;var qn=`BT
/`;return qn+=jt+" "+Ge+` Tf
`,qn+=F(Ge*Tn)+` TL
`,qn+=_i+`
`,qn+=Dr,qn+=v,oe(qn+="ET"),m[jt]=!0,_r};var Lc=d.__private__.clip=d.clip=function(v){return oe(v==="evenodd"?"W*":"W"),this};d.clipEvenOdd=function(){return Lc("evenodd")},d.__private__.discardPath=d.discardPath=function(){return oe("n"),this};var va=d.__private__.isValidStyle=function(v){var D=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(v)!==-1&&(D=!0),D};d.__private__.setDefaultPathOperation=d.setDefaultPathOperation=function(v){return va(v)&&(h=v),this};var tl=d.__private__.getStyle=d.getStyle=function(v){var D=h;switch(v){case"D":case"S":D="S";break;case"F":D="f";break;case"FD":case"DF":D="B";break;case"f":case"f*":case"B":case"B*":D=v}return D},rl=d.close=function(){return oe("h"),this};d.stroke=function(){return oe("S"),this},d.fill=function(v){return Zi("f",v),this},d.fillEvenOdd=function(v){return Zi("f*",v),this},d.fillStroke=function(v){return Zi("B",v),this},d.fillStrokeEvenOdd=function(v){return Zi("B*",v),this};var Zi=function(v,D){tr(D)==="object"?Pc(D,v):oe(v)},Us=function(v){v===null||A===w.ADVANCED&&v===void 0||(v=tl(v),oe(v))};function Cc(v,D,se,ue,ye){var Le=new Oi(D||this.boundingBox,se||this.xStep,ue||this.yStep,this.gState,ye||this.matrix);Le.stream=this.stream;var We=v+"$$"+this.cloneIndex+++"$$";return Kr(We,Le),Le}var Pc=function(v,D){var se=ma[v.key],ue=Ot[se];if(ue instanceof hi)oe("q"),oe(Oc(D)),ue.gState&&d.setGState(ue.gState),oe(v.matrix.toString()+" cm"),oe("/"+se+" sh"),oe("Q");else if(ue instanceof Oi){var ye=new ut(1,0,0,-1,0,Xa());v.matrix&&(ye=ye.multiply(v.matrix||pn),se=Cc.call(ue,v.key,v.boundingBox,v.xStep,v.yStep,ye).id),oe("q"),oe("/Pattern cs"),oe("/"+se+" scn"),ue.gState&&d.setGState(ue.gState),oe(D),oe("Q")}},Oc=function(v){switch(v){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Hs=d.moveTo=function(v,D){return oe(F(T(v))+" "+F(M(D))+" m"),this},Ni=d.lineTo=function(v,D){return oe(F(T(v))+" "+F(M(D))+" l"),this},$a=d.curveTo=function(v,D,se,ue,ye,Le){return oe([F(T(v)),F(M(D)),F(T(se)),F(M(ue)),F(T(ye)),F(M(Le)),"c"].join(" ")),this};d.__private__.line=d.line=function(v,D,se,ue,ye){if(isNaN(v)||isNaN(D)||isNaN(se)||isNaN(ue)||!va(ye))throw new Error("Invalid arguments passed to jsPDF.line");return A===w.COMPAT?this.lines([[se-v,ue-D]],v,D,[1,1],ye||"S"):this.lines([[se-v,ue-D]],v,D,[1,1]).stroke()},d.__private__.lines=d.lines=function(v,D,se,ue,ye,Le){var We,it,ft,Nt,wt,Pt,cr,hr,_r,Zr,Dr,ra;if(typeof v=="number"&&(ra=se,se=D,D=v,v=ra),ue=ue||[1,1],Le=Le||!1,isNaN(D)||isNaN(se)||!Array.isArray(v)||!Array.isArray(ue)||!va(ye)||typeof Le!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Hs(D,se),We=ue[0],it=ue[1],Nt=v.length,Zr=D,Dr=se,ft=0;ft<Nt;ft++)(wt=v[ft]).length===2?(Zr=wt[0]*We+Zr,Dr=wt[1]*it+Dr,Ni(Zr,Dr)):(Pt=wt[0]*We+Zr,cr=wt[1]*it+Dr,hr=wt[2]*We+Zr,_r=wt[3]*it+Dr,Zr=wt[4]*We+Zr,Dr=wt[5]*it+Dr,$a(Pt,cr,hr,_r,Zr,Dr));return Le&&rl(),Us(ye),this},d.path=function(v){for(var D=0;D<v.length;D++){var se=v[D],ue=se.c;switch(se.op){case"m":Hs(ue[0],ue[1]);break;case"l":Ni(ue[0],ue[1]);break;case"c":$a.apply(this,ue);break;case"h":rl()}}return this},d.__private__.rect=d.rect=function(v,D,se,ue,ye){if(isNaN(v)||isNaN(D)||isNaN(se)||isNaN(ue)||!va(ye))throw new Error("Invalid arguments passed to jsPDF.rect");return A===w.COMPAT&&(ue=-ue),oe([F(T(v)),F(M(D)),F(T(se)),F(T(ue)),"re"].join(" ")),Us(ye),this},d.__private__.triangle=d.triangle=function(v,D,se,ue,ye,Le,We){if(isNaN(v)||isNaN(D)||isNaN(se)||isNaN(ue)||isNaN(ye)||isNaN(Le)||!va(We))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[se-v,ue-D],[ye-se,Le-ue],[v-ye,D-Le]],v,D,[1,1],We,!0),this},d.__private__.roundedRect=d.roundedRect=function(v,D,se,ue,ye,Le,We){if(isNaN(v)||isNaN(D)||isNaN(se)||isNaN(ue)||isNaN(ye)||isNaN(Le)||!va(We))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var it=4/3*(Math.SQRT2-1);return ye=Math.min(ye,.5*se),Le=Math.min(Le,.5*ue),this.lines([[se-2*ye,0],[ye*it,0,ye,Le-Le*it,ye,Le],[0,ue-2*Le],[0,Le*it,-ye*it,Le,-ye,Le],[2*ye-se,0],[-ye*it,0,-ye,-Le*it,-ye,-Le],[0,2*Le-ue],[0,-Le*it,ye*it,-Le,ye,-Le]],v+ye,D,[1,1],We,!0),this},d.__private__.ellipse=d.ellipse=function(v,D,se,ue,ye){if(isNaN(v)||isNaN(D)||isNaN(se)||isNaN(ue)||!va(ye))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Le=4/3*(Math.SQRT2-1)*se,We=4/3*(Math.SQRT2-1)*ue;return Hs(v+se,D),$a(v+se,D-We,v+Le,D-ue,v,D-ue),$a(v-Le,D-ue,v-se,D-We,v-se,D),$a(v-se,D+We,v-Le,D+ue,v,D+ue),$a(v+Le,D+ue,v+se,D+We,v+se,D),Us(ye),this},d.__private__.circle=d.circle=function(v,D,se,ue){if(isNaN(v)||isNaN(D)||isNaN(se)||!va(ue))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(v,D,se,se,ue)},d.setFont=function(v,D,se){return se&&(D=V(D,se)),jt=Zo(v,D,{disableWarning:!1}),this};var Ic=d.__private__.getFont=d.getFont=function(){return Ht[Zo.apply(d,arguments)]};d.__private__.getFontList=d.getFontList=function(){var v,D,se={};for(v in rr)if(rr.hasOwnProperty(v))for(D in se[v]=[],rr[v])rr[v].hasOwnProperty(D)&&se[v].push(D);return se},d.addFont=function(v,D,se,ue,ye){var Le=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Le.indexOf(arguments[3])!==-1?ye=arguments[3]:arguments[3]&&Le.indexOf(arguments[3])==-1&&(se=V(se,ue)),ye=ye||"Identity-H",Rs.call(this,v,D,se,ye)};var Si,Ws=e.lineWidth||.200025,Qi=d.__private__.getLineWidth=d.getLineWidth=function(){return Ws},nl=d.__private__.setLineWidth=d.setLineWidth=function(v){return Ws=v,oe(F(T(v))+" w"),this};d.__private__.setLineDash=ht.API.setLineDash=ht.API.setLineDashPattern=function(v,D){if(v=v||[],D=D||0,isNaN(D)||!Array.isArray(v))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return v=v.map(function(se){return F(T(se))}).join(" "),D=F(T(D)),oe("["+v+"] "+D+" d"),this};var al=d.__private__.getLineHeight=d.getLineHeight=function(){return Ge*Si};d.__private__.getLineHeight=d.getLineHeight=function(){return Ge*Si};var il=d.__private__.setLineHeightFactor=d.setLineHeightFactor=function(v){return typeof(v=v||1.15)=="number"&&(Si=v),this},sl=d.__private__.getLineHeightFactor=d.getLineHeightFactor=function(){return Si};il(e.lineHeight);var ya=d.__private__.getHorizontalCoordinate=function(v){return T(v)},Ca=d.__private__.getVerticalCoordinate=function(v){return A===w.ADVANCED?v:vt[L].mediaBox.topRightY-vt[L].mediaBox.bottomLeftY-T(v)},Dc=d.__private__.getHorizontalCoordinateString=d.getHorizontalCoordinateString=function(v){return F(ya(v))},Ya=d.__private__.getVerticalCoordinateString=d.getVerticalCoordinateString=function(v){return F(Ca(v))},ta=e.strokeColor||"0 G";d.__private__.getStrokeColor=d.getDrawColor=function(){return re(ta)},d.__private__.setStrokeColor=d.setDrawColor=function(v,D,se,ue){return ta=ie({ch1:v,ch2:D,ch3:se,ch4:ue,pdfColorType:"draw",precision:2}),oe(ta),this};var qs=e.fillColor||"0 g";d.__private__.getFillColor=d.getFillColor=function(){return re(qs)},d.__private__.setFillColor=d.setFillColor=function(v,D,se,ue){return qs=ie({ch1:v,ch2:D,ch3:se,ch4:ue,pdfColorType:"fill",precision:2}),oe(qs),this};var _i=e.textColor||"0 g",Rc=d.__private__.getTextColor=d.getTextColor=function(){return re(_i)};d.__private__.setTextColor=d.setTextColor=function(v,D,se,ue){return _i=ie({ch1:v,ch2:D,ch3:se,ch4:ue,pdfColorType:"text",precision:3}),this};var es=e.charSpace,Mc=d.__private__.getCharSpace=d.getCharSpace=function(){return parseFloat(es||0)};d.__private__.setCharSpace=d.setCharSpace=function(v){if(isNaN(v))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return es=v,this};var zs=0;d.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},d.__private__.setLineCap=d.setLineCap=function(v){var D=d.CapJoinStyles[v];if(D===void 0)throw new Error("Line cap style of '"+v+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return zs=D,oe(D+" J"),this};var Vs=0;d.__private__.setLineJoin=d.setLineJoin=function(v){var D=d.CapJoinStyles[v];if(D===void 0)throw new Error("Line join style of '"+v+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Vs=D,oe(D+" j"),this},d.__private__.setLineMiterLimit=d.__private__.setMiterLimit=d.setLineMiterLimit=d.setMiterLimit=function(v){if(v=v||0,isNaN(v))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return oe(F(T(v))+" M"),this},d.GState=Co,d.setGState=function(v){(v=typeof v=="string"?ir[_n[v]]:ol(null,v)).equals(Jn)||(oe("/"+v.id+" gs"),Jn=v)};var ol=function(v,D){if(!v||!_n[v]){var se=!1;for(var ue in ir)if(ir.hasOwnProperty(ue)&&ir[ue].equals(D)){se=!0;break}if(se)D=ir[ue];else{var ye="GS"+(Object.keys(ir).length+1).toString(10);ir[ye]=D,D.id=ye}return v&&(_n[v]=D.id),Dt.publish("addGState",D),D}};d.addGState=function(v,D){return ol(v,D),this},d.saveGraphicsState=function(){return oe("q"),Rn.push({key:jt,size:Ge,color:_i}),this},d.restoreGraphicsState=function(){oe("Q");var v=Rn.pop();return jt=v.key,Ge=v.size,_i=v.color,Jn=null,this},d.setCurrentTransformationMatrix=function(v){return oe(v.toString()+" cm"),this},d.comment=function(v){return oe("#"+v),this};var ts=function(v,D){var se=v||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return se},set:function(Le){isNaN(Le)||(se=parseFloat(Le))}});var ue=D||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return ue},set:function(Le){isNaN(Le)||(ue=parseFloat(Le))}});var ye="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ye},set:function(Le){ye=Le.toString()}}),this},Gs=function(v,D,se,ue){ts.call(this,v,D),this.type="rect";var ye=se||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ye},set:function(We){isNaN(We)||(ye=parseFloat(We))}});var Le=ue||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Le},set:function(We){isNaN(We)||(Le=parseFloat(We))}}),this},$s=function(){this.page=Zt,this.currentPage=L,this.pages=Pe.slice(0),this.pagesContext=vt.slice(0),this.x=Fr,this.y=Lt,this.matrix=dn,this.width=Ai(L),this.height=Xa(L),this.outputDestination=ze,this.id="",this.objectNumber=-1};$s.prototype.restore=function(){Zt=this.page,L=this.currentPage,vt=this.pagesContext,Pe=this.pages,Fr=this.x,Lt=this.y,dn=this.matrix,Ys(L,this.width),Xs(L,this.height),ze=this.outputDestination};var ll=function(v,D,se,ue,ye){Bn.push(new $s),Zt=L=0,Pe=[],Fr=v,Lt=D,dn=ye,Ms([se,ue])},Bc=function(v){if(Mn[v])Bn.pop().restore();else{var D=new $s,se="Xo"+(Object.keys(Lr).length+1).toString(10);D.id=se,Mn[v]=se,Lr[se]=D,Dt.publish("addFormObject",D),Bn.pop().restore()}};for(var rs in d.beginFormObject=function(v,D,se,ue,ye){return ll(v,D,se,ue,ye),this},d.endFormObject=function(v){return Bc(v),this},d.doFormObject=function(v,D){var se=Lr[Mn[v]];return oe("q"),oe(D.toString()+" cm"),oe("/"+se.id+" Do"),oe("Q"),this},d.getFormObject=function(v){var D=Lr[Mn[v]];return{x:D.x,y:D.y,width:D.width,height:D.height,matrix:D.matrix}},d.save=function(v,D){return v=v||"generated.pdf",(D=D||{}).returnPromise=D.returnPromise||!1,D.returnPromise===!1?(Ci(Ki(La()),v),typeof Ci.unload=="function"&&mt.setTimeout&&setTimeout(Ci.unload,911),this):new Promise(function(se,ue){try{var ye=Ci(Ki(La()),v);typeof Ci.unload=="function"&&mt.setTimeout&&setTimeout(Ci.unload,911),se(ye)}catch(Le){ue(Le.message)}})},ht.API)ht.API.hasOwnProperty(rs)&&(rs==="events"&&ht.API.events.length?function(v,D){var se,ue,ye;for(ye=D.length-1;ye!==-1;ye--)se=D[ye][0],ue=D[ye][1],v.subscribe.apply(v,[se].concat(typeof ue=="function"?[ue]:ue))}(Dt,ht.API.events):d[rs]=ht.API[rs]);var Ai=d.getPageWidth=function(v){return(vt[v=v||L].mediaBox.topRightX-vt[v].mediaBox.bottomLeftX)/tt},Ys=d.setPageWidth=function(v,D){vt[v].mediaBox.topRightX=D*tt+vt[v].mediaBox.bottomLeftX},Xa=d.getPageHeight=function(v){return(vt[v=v||L].mediaBox.topRightY-vt[v].mediaBox.bottomLeftY)/tt},Xs=d.setPageHeight=function(v,D){vt[v].mediaBox.topRightY=D*tt+vt[v].mediaBox.bottomLeftY};return d.internal={pdfEscape:mn,getStyle:tl,getFont:Ic,getFontSize:Qe,getCharSpace:Mc,getTextColor:Rc,getLineHeight:al,getLineHeightFactor:sl,getLineWidth:Qi,write:Me,getHorizontalCoordinate:ya,getVerticalCoordinate:Ca,getCoordinateString:Dc,getVerticalCoordinateString:Ya,collections:{},newObject:gr,newAdditionalObject:ne,newObjectDeferred:fr,newObjectDeferredBegin:H,getFilters:Ne,putStream:Ee,events:Dt,scaleFactor:tt,pageSize:{getWidth:function(){return Ai(L)},setWidth:function(v){Ys(L,v)},getHeight:function(){return Xa(L)},setHeight:function(v){Xs(L,v)}},encryptionOptions:u,encryption:Jr,getEncryptor:Ec,output:Ji,getNumberOfPages:_c,pages:Pe,out:oe,f2:G,f3:j,getPageInfo:el,getPageInfoByObjId:yt,getCurrentPageInfo:Fc,getPDFVersion:x,Point:ts,Rectangle:Gs,Matrix:ut,hasHotfix:Qo},Object.defineProperty(d.internal.pageSize,"width",{get:function(){return Ai(L)},set:function(v){Ys(L,v)},enumerable:!0,configurable:!0}),Object.defineProperty(d.internal.pageSize,"height",{get:function(){return Xa(L)},set:function(v){Xs(L,v)},enumerable:!0,configurable:!0}),Nc.call(d,He),jt="F1",Ko(a,t),Dt.publish("initialized"),d}Ss.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},Ss.prototype.toHexString=function(e){return e.split("").map(function(r){return("0"+(255&r.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Ss.prototype.hexToBytes=function(e){for(var r=[],t=0;t<e.length;t+=2)r.push(String.fromCharCode(parseInt(e.substr(t,2),16)));return r.join("")},Ss.prototype.processOwnerPassword=function(e,r){return I0(O0(r).substr(0,5),e)},Ss.prototype.encryptor=function(e,r){var t=O0(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&r,r>>8&255)).substr(0,10);return function(n){return I0(t,n)}},Co.prototype.equals=function(e){var r,t="id,objectNumber,equals";if(!e||tr(e)!==tr(this))return!1;var n=0;for(r in this)if(!(t.indexOf(r)>=0)){if(this.hasOwnProperty(r)&&!e.hasOwnProperty(r)||this[r]!==e[r])return!1;n++}for(r in e)e.hasOwnProperty(r)&&t.indexOf(r)<0&&n--;return n===0},ht.API={events:[]},ht.version="2.5.2";var dr=ht.API,$0=1,qi=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},xs=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},bt=function(e){return e.toFixed(2)},ci=function(e){return e.toFixed(5)};dr.__acroform__={};var Sn=function(e,r){e.prototype=Object.create(r.prototype),e.prototype.constructor=e},th=function(e){return e*$0},Na=function(e){var r=new Nu,t=ot.internal.getHeight(e)||0,n=ot.internal.getWidth(e)||0;return r.BBox=[0,0,Number(bt(n)),Number(bt(t))],r},mp=dr.__acroform__.setBit=function(e,r){if(e=e||0,r=r||0,isNaN(e)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<r},gp=dr.__acroform__.clearBit=function(e,r){if(e=e||0,r=r||0,isNaN(e)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<r)},xp=dr.__acroform__.getBit=function(e,r){if(isNaN(e)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<r?1:0},wr=dr.__acroform__.getBitForPdf=function(e,r){if(isNaN(e)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return xp(e,r-1)},br=dr.__acroform__.setBitForPdf=function(e,r){if(isNaN(e)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return mp(e,r-1)},Nr=dr.__acroform__.clearBitForPdf=function(e,r){if(isNaN(e)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return gp(e,r-1)},vp=dr.__acroform__.calculateCoordinates=function(e,r){var t=r.internal.getHorizontalCoordinate,n=r.internal.getVerticalCoordinate,a=e[0],i=e[1],o=e[2],l=e[3],c={};return c.lowerLeft_X=t(a)||0,c.lowerLeft_Y=n(i+l)||0,c.upperRight_X=t(a+o)||0,c.upperRight_Y=n(i)||0,[Number(bt(c.lowerLeft_X)),Number(bt(c.lowerLeft_Y)),Number(bt(c.upperRight_X)),Number(bt(c.upperRight_Y))]},yp=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var r=[],t=e._V||e.DV,n=D0(e,t),a=e.scope.internal.getFont(e.fontName,e.fontStyle).id;r.push("/Tx BMC"),r.push("q"),r.push("BT"),r.push(e.scope.__private__.encodeColorString(e.color)),r.push("/"+a+" "+bt(n.fontSize)+" Tf"),r.push("1 0 0 1 0 0 Tm"),r.push(n.text),r.push("ET"),r.push("Q"),r.push("EMC");var i=Na(e);return i.scope=e.scope,i.stream=r.join(`
`),i}},D0=function(e,r){var t=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},a=(r=(r=r.substr(0,1)=="("?r.substr(1):r).substr(r.length-1)==")"?r.substr(0,r.length-1):r).split(" ");a=e.multiline?a.map(function(j){return j.split(`
`)}):a.map(function(j){return[j]});var i=t,o=ot.internal.getHeight(e)||0;o=o<0?-o:o;var l=ot.internal.getWidth(e)||0;l=l<0?-l:l;var c=function(j,T,B){if(j+1<a.length){var M=T+" "+a[j+1][0];return Dl(M,e,B).width<=l-4}return!1};i++;e:for(;i>0;){r="",i--;var h,u,g=Dl("3",e,i).height,m=e.multiline?o-i:(o-g)/2,d=m+=2,y=0,x=0,b=0;if(i<=0){r=`(...) Tj
`,r+="% Width of Text: "+Dl(r,e,i=12).width+", FieldWidth:"+l+`
`;break}for(var N="",w=0,A=0;A<a.length;A++)if(a.hasOwnProperty(A)){var E=!1;if(a[A].length!==1&&b!==a[A].length-1){if((g+2)*(w+2)+2>o)continue e;N+=a[A][b],E=!0,x=A,A--}else{N=(N+=a[A][b]+" ").substr(N.length-1)==" "?N.substr(0,N.length-1):N;var W=parseInt(A),V=c(W,N,i),F=A>=a.length-1;if(V&&!F){N+=" ",b=0;continue}if(V||F){if(F)x=W;else if(e.multiline&&(g+2)*(w+2)+2>o)continue e}else{if(!e.multiline||(g+2)*(w+2)+2>o)continue e;x=W}}for(var C="",R=y;R<=x;R++){var G=a[R];if(e.multiline){if(R===x){C+=G[b]+" ",b=(b+1)%G.length;continue}if(R===y){C+=G[G.length-1]+" ";continue}}C+=G[0]+" "}switch(C=C.substr(C.length-1)==" "?C.substr(0,C.length-1):C,u=Dl(C,e,i).width,e.textAlign){case"right":h=l-u-2;break;case"center":h=(l-u)/2;break;case"left":default:h=2}r+=bt(h)+" "+bt(d)+` Td
`,r+="("+qi(C)+`) Tj
`,r+=-bt(h)+` 0 Td
`,d=-(i+2),u=0,y=E?x:x+1,w++,N=""}break}return n.text=r,n.fontSize=i,n},Dl=function(e,r,t){var n=r.scope.internal.getFont(r.fontName,r.fontStyle),a=r.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:r.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:a}},wp={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},bp=function(e,r){var t={type:"reference",object:e};r.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===t.type&&n.object===t.object})===void 0&&r.internal.getPageInfo(e.page).pageContext.annotations.push(t)},Np=function(e,r){for(var t in e)if(e.hasOwnProperty(t)){var n=t,a=e[t];r.internal.newObjectDeferredBegin(a.objId,!0),tr(a)==="object"&&typeof a.putStream=="function"&&a.putStream(),delete e[n]}},Sp=function(e,r){if(r.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(da.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(wp)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");$0=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new Su,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in n)if(n.hasOwnProperty(a)){var i=n[a];i.objId=void 0,i.hasAnnotation&&bp(i,t)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(t){(function(n,a){var i=!n;for(var o in n||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var l=n[o],c=[],h=l.Rect;if(l.Rect&&(l.Rect=vp(l.Rect,a)),a.internal.newObjectDeferredBegin(l.objId,!0),l.DA=ot.createDefaultAppearanceStream(l),tr(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=h,l.hasAppearanceStream&&!l.appearanceStreamContent){var u=yp(l);c.push({key:"AP",value:"<</N "+u+">>"}),a.internal.acroformPlugin.xForms.push(u)}if(l.appearanceStreamContent){var g="";for(var m in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(m)){var d=l.appearanceStreamContent[m];if(g+="/"+m+" ",g+="<<",Object.keys(d).length>=1||Array.isArray(d)){for(var o in d)if(d.hasOwnProperty(o)){var y=d[o];typeof y=="function"&&(y=y.call(a,l)),g+="/"+o+" "+y+" ",a.internal.acroformPlugin.xForms.indexOf(y)>=0||a.internal.acroformPlugin.xForms.push(y)}}else typeof(y=d)=="function"&&(y=y.call(a,l)),g+="/"+o+" "+y,a.internal.acroformPlugin.xForms.indexOf(y)>=0||a.internal.acroformPlugin.xForms.push(y);g+=">>"}c.push({key:"AP",value:`<<
`+g+">>"})}a.internal.putStream({additionalKeyValues:c,objectId:l.objId}),a.internal.out("endobj")}i&&Np(a.internal.acroformPlugin.xForms,a)})(t,e)}),e.internal.acroformPlugin.isInitialized=!0}},bu=dr.__acroform__.arrayToPdfArray=function(e,r,t){var n=function(o){return o};if(Array.isArray(e)){for(var a="[",i=0;i<e.length;i++)switch(i!==0&&(a+=" "),tr(e[i])){case"boolean":case"number":case"object":a+=e[i].toString();break;case"string":e[i].substr(0,1)!=="/"?(r!==void 0&&t&&(n=t.internal.getEncryptor(r)),a+="("+qi(n(e[i].toString()))+")"):a+=e[i].toString()}return a+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},u0=function(e,r,t){var n=function(a){return a};return r!==void 0&&t&&(n=t.internal.getEncryptor(r)),(e=e||"").toString(),e="("+qi(n(e))+")"},Aa=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Aa.prototype.toString=function(){return this.objId+" 0 R"},Aa.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Aa.prototype.getKeyValueListForStream=function(){var e=[],r=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var t in r)if(Object.getOwnPropertyDescriptor(this,r[t]).configurable===!1){var n=r[t],a=this[n];a&&(Array.isArray(a)?e.push({key:n,value:bu(a,this.objId,this.scope)}):a instanceof Aa?(a.scope=this.scope,e.push({key:n,value:a.objId+" 0 R"})):typeof a!="function"&&e.push({key:n,value:a}))}return e};var Nu=function(){Aa.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,r=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){e=t.trim()},get:function(){return e||null}})};Sn(Nu,Aa);var Su=function(){Aa.call(this);var e,r=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return r.length>0?r:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return r}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var t=function(n){return n};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+qi(t(e))+")"}},set:function(t){e=t}})};Sn(Su,Aa);var da=function e(){Aa.call(this);var r=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return r},set:function(N){if(isNaN(N))throw new Error('Invalid value "'+N+'" for attribute F supplied.');r=N}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!wr(r,3)},set:function(N){N?this.F=br(r,3):this.F=Nr(r,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(N){if(isNaN(N))throw new Error('Invalid value "'+N+'" for attribute Ff supplied.');t=N}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(N){n=N!==void 0?N:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(N){n[0]=N}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(N){n[1]=N}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(N){n[2]=N}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(N){n[3]=N}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(N){switch(N){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=N;break;default:throw new Error('Invalid value "'+N+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof Xl)return;i="FieldObject"+e.FieldNum++}var N=function(w){return w};return this.scope&&(N=this.scope.internal.getEncryptor(this.objId)),"("+qi(N(i))+")"},set:function(N){i=N.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(N){i=N}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(N){o=N}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(N){l=N}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(N){c=N}});var h=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return h===void 0?50/$0:h},set:function(N){h=N}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(N){u=N}});var g="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!g||this instanceof Xl||this instanceof mi))return u0(g,this.objId,this.scope)},set:function(N){N=N.toString(),g=N}});var m=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof Or?m:u0(m,this.objId,this.scope)},set:function(N){N=N.toString(),m=this instanceof Or?N:N.substr(0,1)==="("?xs(N.substr(1,N.length-2)):xs(N)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Or?xs(m.substr(1,m.length-1)):m},set:function(N){N=N.toString(),m=this instanceof Or?"/"+N:N}});var d=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(d)return d},set:function(N){this.V=N}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(d)return this instanceof Or?d:u0(d,this.objId,this.scope)},set:function(N){N=N.toString(),d=this instanceof Or?N:N.substr(0,1)==="("?xs(N.substr(1,N.length-2)):xs(N)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Or?xs(d.substr(1,d.length-1)):d},set:function(N){N=N.toString(),d=this instanceof Or?"/"+N:N}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var y,x=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return x},set:function(N){N=!!N,x=N}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(y)return y},set:function(N){y=N}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,1)},set:function(N){N?this.Ff=br(this.Ff,1):this.Ff=Nr(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,2)},set:function(N){N?this.Ff=br(this.Ff,2):this.Ff=Nr(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,3)},set:function(N){N?this.Ff=br(this.Ff,3):this.Ff=Nr(this.Ff,3)}});var b=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(b!==null)return b},set:function(N){if([0,1,2].indexOf(N)===-1)throw new Error('Invalid value "'+N+'" for attribute Q supplied.');b=N}}),Object.defineProperty(this,"textAlign",{get:function(){var N;switch(b){case 0:default:N="left";break;case 1:N="center";break;case 2:N="right"}return N},configurable:!0,enumerable:!0,set:function(N){switch(N){case"right":case 2:b=2;break;case"center":case 1:b=1;break;case"left":case 0:default:b=0}}})};Sn(da,Aa);var Ii=function(){da.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){e=t}});var r=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return bu(r,this.objId,this.scope)},set:function(t){var n,a;a=[],typeof(n=t)=="string"&&(a=function(i,o,l){l||(l=1);for(var c,h=[];c=o.exec(i);)h.push(c[l]);return h}(n,/\((.*?)\)/g)),r=a}}),this.getOptions=function(){return r},this.setOptions=function(t){r=t,this.sort&&r.sort()},this.addOption=function(t){t=(t=t||"").toString(),r.push(t),this.sort&&r.sort()},this.removeOption=function(t,n){for(n=n||!1,t=(t=t||"").toString();r.indexOf(t)!==-1&&(r.splice(r.indexOf(t),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,18)},set:function(t){t?this.Ff=br(this.Ff,18):this.Ff=Nr(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=br(this.Ff,19):this.Ff=Nr(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,20)},set:function(t){t?(this.Ff=br(this.Ff,20),r.sort()):this.Ff=Nr(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,22)},set:function(t){t?this.Ff=br(this.Ff,22):this.Ff=Nr(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,23)},set:function(t){t?this.Ff=br(this.Ff,23):this.Ff=Nr(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,27)},set:function(t){t?this.Ff=br(this.Ff,27):this.Ff=Nr(this.Ff,27)}}),this.hasAppearanceStream=!1};Sn(Ii,da);var Di=function(){Ii.call(this),this.fontName="helvetica",this.combo=!1};Sn(Di,Ii);var Ri=function(){Di.call(this),this.combo=!0};Sn(Ri,Di);var wo=function(){Ri.call(this),this.edit=!0};Sn(wo,Ri);var Or=function(){da.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,15)},set:function(t){t?this.Ff=br(this.Ff,15):this.Ff=Nr(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,16)},set:function(t){t?this.Ff=br(this.Ff,16):this.Ff=Nr(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,17)},set:function(t){t?this.Ff=br(this.Ff,17):this.Ff=Nr(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,26)},set:function(t){t?this.Ff=br(this.Ff,26):this.Ff=Nr(this.Ff,26)}});var e,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(i){return i};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(r).length!==0){var n,a=[];for(n in a.push("<<"),r)a.push("/"+n+" ("+qi(t(r[n]))+")");return a.push(">>"),a.join(`
`)}},set:function(t){tr(t)==="object"&&(r=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(t){typeof t=="string"&&(r.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(t){e="/"+t}})};Sn(Or,da);var bo=function(){Or.call(this),this.pushButton=!0};Sn(bo,Or);var Mi=function(){Or.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r!==void 0?r:[]}})};Sn(Mi,Or);var Xl=function(){var e,r;da.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(a){e=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return r},set:function(a){r=a}});var t,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(l){return l};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var i,o=[];for(i in o.push("<<"),n)o.push("/"+i+" ("+qi(a(n[i]))+")");return o.push(">>"),o.join(`
`)},set:function(a){tr(a)==="object"&&(n=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(a){typeof a=="string"&&(n.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(a){t=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(a){t="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=ot.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Sn(Xl,da),Mi.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var r in this.Kids)if(this.Kids.hasOwnProperty(r)){var t=this.Kids[r];t.appearanceStreamContent=e.createAppearanceStream(t.optionName),t.caption=e.getCA()}},Mi.prototype.createOption=function(e){var r=new Xl;return r.Parent=this,r.optionName=e,this.Kids.push(r),_p.call(this.scope,r),r};var No=function(){Or.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=ot.CheckBox.createAppearanceStream()};Sn(No,Or);var mi=function(){da.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,13)},set:function(r){r?this.Ff=br(this.Ff,13):this.Ff=Nr(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,21)},set:function(r){r?this.Ff=br(this.Ff,21):this.Ff=Nr(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,23)},set:function(r){r?this.Ff=br(this.Ff,23):this.Ff=Nr(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,24)},set:function(r){r?this.Ff=br(this.Ff,24):this.Ff=Nr(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,25)},set:function(r){r?this.Ff=br(this.Ff,25):this.Ff=Nr(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,26)},set:function(r){r?this.Ff=br(this.Ff,26):this.Ff=Nr(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){Number.isInteger(r)&&(e=r)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Sn(mi,da);var So=function(){mi.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!wr(this.Ff,14)},set:function(e){e?this.Ff=br(this.Ff,14):this.Ff=Nr(this.Ff,14)}}),this.password=!0};Sn(So,mi);var ot={CheckBox:{createAppearanceStream:function(){return{N:{On:ot.CheckBox.YesNormal},D:{On:ot.CheckBox.YesPushDown,Off:ot.CheckBox.OffPushDown}}},YesPushDown:function(e){var r=Na(e);r.scope=e.scope;var t=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),i=D0(e,e.caption);return t.push("0.749023 g"),t.push("0 0 "+bt(ot.internal.getWidth(e))+" "+bt(ot.internal.getHeight(e))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+n+" "+bt(i.fontSize)+" Tf "+a),t.push("BT"),t.push(i.text),t.push("ET"),t.push("Q"),t.push("EMC"),r.stream=t.join(`
`),r},YesNormal:function(e){var r=Na(e);r.scope=e.scope;var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),a=[],i=ot.internal.getHeight(e),o=ot.internal.getWidth(e),l=D0(e,e.caption);return a.push("1 g"),a.push("0 0 "+bt(o)+" "+bt(i)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+bt(o-1)+" "+bt(i-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+t+" "+bt(l.fontSize)+" Tf "+n),a.push(l.text),a.push("ET"),a.push("Q"),r.stream=a.join(`
`),r},OffPushDown:function(e){var r=Na(e);r.scope=e.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+bt(ot.internal.getWidth(e))+" "+bt(ot.internal.getHeight(e))+" re"),t.push("f"),r.stream=t.join(`
`),r}},RadioButton:{Circle:{createAppearanceStream:function(e){var r={D:{Off:ot.RadioButton.Circle.OffPushDown},N:{}};return r.N[e]=ot.RadioButton.Circle.YesNormal,r.D[e]=ot.RadioButton.Circle.YesPushDown,r},getCA:function(){return"l"},YesNormal:function(e){var r=Na(e);r.scope=e.scope;var t=[],n=ot.internal.getWidth(e)<=ot.internal.getHeight(e)?ot.internal.getWidth(e)/4:ot.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=ot.internal.Bezier_C,i=Number((n*a).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+ci(ot.internal.getWidth(e)/2)+" "+ci(ot.internal.getHeight(e)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),t.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),t.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),t.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),t.push("f"),t.push("Q"),r.stream=t.join(`
`),r},YesPushDown:function(e){var r=Na(e);r.scope=e.scope;var t=[],n=ot.internal.getWidth(e)<=ot.internal.getHeight(e)?ot.internal.getWidth(e)/4:ot.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*ot.internal.Bezier_C).toFixed(5)),o=Number((n*ot.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+ci(ot.internal.getWidth(e)/2)+" "+ci(ot.internal.getHeight(e)/2)+" cm"),t.push(a+" 0 m"),t.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),t.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),t.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),t.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+ci(ot.internal.getWidth(e)/2)+" "+ci(ot.internal.getHeight(e)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),t.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),t.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),t.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),t.push("f"),t.push("Q"),r.stream=t.join(`
`),r},OffPushDown:function(e){var r=Na(e);r.scope=e.scope;var t=[],n=ot.internal.getWidth(e)<=ot.internal.getHeight(e)?ot.internal.getWidth(e)/4:ot.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*ot.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+ci(ot.internal.getWidth(e)/2)+" "+ci(ot.internal.getHeight(e)/2)+" cm"),t.push(a+" 0 m"),t.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),t.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),t.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),t.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),t.push("f"),t.push("Q"),r.stream=t.join(`
`),r}},Cross:{createAppearanceStream:function(e){var r={D:{Off:ot.RadioButton.Cross.OffPushDown},N:{}};return r.N[e]=ot.RadioButton.Cross.YesNormal,r.D[e]=ot.RadioButton.Cross.YesPushDown,r},getCA:function(){return"8"},YesNormal:function(e){var r=Na(e);r.scope=e.scope;var t=[],n=ot.internal.calculateCross(e);return t.push("q"),t.push("1 1 "+bt(ot.internal.getWidth(e)-2)+" "+bt(ot.internal.getHeight(e)-2)+" re"),t.push("W"),t.push("n"),t.push(bt(n.x1.x)+" "+bt(n.x1.y)+" m"),t.push(bt(n.x2.x)+" "+bt(n.x2.y)+" l"),t.push(bt(n.x4.x)+" "+bt(n.x4.y)+" m"),t.push(bt(n.x3.x)+" "+bt(n.x3.y)+" l"),t.push("s"),t.push("Q"),r.stream=t.join(`
`),r},YesPushDown:function(e){var r=Na(e);r.scope=e.scope;var t=ot.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+bt(ot.internal.getWidth(e))+" "+bt(ot.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+bt(ot.internal.getWidth(e)-2)+" "+bt(ot.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(bt(t.x1.x)+" "+bt(t.x1.y)+" m"),n.push(bt(t.x2.x)+" "+bt(t.x2.y)+" l"),n.push(bt(t.x4.x)+" "+bt(t.x4.y)+" m"),n.push(bt(t.x3.x)+" "+bt(t.x3.y)+" l"),n.push("s"),n.push("Q"),r.stream=n.join(`
`),r},OffPushDown:function(e){var r=Na(e);r.scope=e.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+bt(ot.internal.getWidth(e))+" "+bt(ot.internal.getHeight(e))+" re"),t.push("f"),r.stream=t.join(`
`),r}}},createDefaultAppearanceStream:function(e){var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,t=e.scope.__private__.encodeColorString(e.color);return"/"+r+" "+e.fontSize+" Tf "+t}};ot.internal={Bezier_C:.551915024494,calculateCross:function(e){var r=ot.internal.getWidth(e),t=ot.internal.getHeight(e),n=Math.min(r,t);return{x1:{x:(r-n)/2,y:(t-n)/2+n},x2:{x:(r-n)/2+n,y:(t-n)/2},x3:{x:(r-n)/2,y:(t-n)/2},x4:{x:(r-n)/2+n,y:(t-n)/2+n}}}},ot.internal.getWidth=function(e){var r=0;return tr(e)==="object"&&(r=th(e.Rect[2])),r},ot.internal.getHeight=function(e){var r=0;return tr(e)==="object"&&(r=th(e.Rect[3])),r};var _p=dr.addField=function(e){if(Sp(this,e),!(e instanceof da))throw new Error("Invalid argument passed to jsPDF.addField.");var r;return(r=e).scope.internal.acroformPlugin.printedOut&&(r.scope.internal.acroformPlugin.printedOut=!1,r.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),r.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(r),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};dr.AcroFormChoiceField=Ii,dr.AcroFormListBox=Di,dr.AcroFormComboBox=Ri,dr.AcroFormEditBox=wo,dr.AcroFormButton=Or,dr.AcroFormPushButton=bo,dr.AcroFormRadioButton=Mi,dr.AcroFormCheckBox=No,dr.AcroFormTextField=mi,dr.AcroFormPasswordField=So,dr.AcroFormAppearance=ot,dr.AcroForm={ChoiceField:Ii,ListBox:Di,ComboBox:Ri,EditBox:wo,Button:Or,PushButton:bo,RadioButton:Mi,CheckBox:No,TextField:mi,PasswordField:So,Appearance:ot},ht.AcroForm={ChoiceField:Ii,ListBox:Di,ComboBox:Ri,EditBox:wo,Button:Or,PushButton:bo,RadioButton:Mi,CheckBox:No,TextField:mi,PasswordField:So,Appearance:ot};var Ap=ht.AcroForm;function _u(e){return e.reduce(function(r,t,n){return r[t]=n,r},{})}(function(e){e.__addimage__={};var r="UNKNOWN",t={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=e.__addimage__.getImageFileTypeByImageData=function(j,T){var B,M,le,J,z,ae=r;if((T=T||r)==="RGBA"||j.data!==void 0&&j.data instanceof Uint8ClampedArray&&"height"in j&&"width"in j)return"RGBA";if(V(j))for(z in t)for(le=t[z],B=0;B<le.length;B+=1){for(J=!0,M=0;M<le[B].length;M+=1)if(le[B][M]!==void 0&&le[B][M]!==j[M]){J=!1;break}if(J===!0){ae=z;break}}else for(z in t)for(le=t[z],B=0;B<le.length;B+=1){for(J=!0,M=0;M<le[B].length;M+=1)if(le[B][M]!==void 0&&le[B][M]!==j.charCodeAt(M)){J=!1;break}if(J===!0){ae=z;break}}return ae===r&&T!==r&&(ae=T),ae},a=function j(T){for(var B=this.internal.write,M=this.internal.putStream,le=(0,this.internal.getFilters)();le.indexOf("FlateEncode")!==-1;)le.splice(le.indexOf("FlateEncode"),1);T.objectId=this.internal.newObject();var J=[];if(J.push({key:"Type",value:"/XObject"}),J.push({key:"Subtype",value:"/Image"}),J.push({key:"Width",value:T.width}),J.push({key:"Height",value:T.height}),T.colorSpace===b.INDEXED?J.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(T.palette.length/3-1)+" "+("sMask"in T&&T.sMask!==void 0?T.objectId+2:T.objectId+1)+" 0 R]"}):(J.push({key:"ColorSpace",value:"/"+T.colorSpace}),T.colorSpace===b.DEVICE_CMYK&&J.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),J.push({key:"BitsPerComponent",value:T.bitsPerComponent}),"decodeParameters"in T&&T.decodeParameters!==void 0&&J.push({key:"DecodeParms",value:"<<"+T.decodeParameters+">>"}),"transparency"in T&&Array.isArray(T.transparency)){for(var z="",ae=0,te=T.transparency.length;ae<te;ae++)z+=T.transparency[ae]+" "+T.transparency[ae]+" ";J.push({key:"Mask",value:"["+z+"]"})}T.sMask!==void 0&&J.push({key:"SMask",value:T.objectId+1+" 0 R"});var de=T.filter!==void 0?["/"+T.filter]:void 0;if(M({data:T.data,additionalKeyValues:J,alreadyAppliedFilters:de,objectId:T.objectId}),B("endobj"),"sMask"in T&&T.sMask!==void 0){var xe="/Predictor "+T.predictor+" /Colors 1 /BitsPerComponent "+T.bitsPerComponent+" /Columns "+T.width,_={width:T.width,height:T.height,colorSpace:"DeviceGray",bitsPerComponent:T.bitsPerComponent,decodeParameters:xe,data:T.sMask};"filter"in T&&(_.filter=T.filter),j.call(this,_)}if(T.colorSpace===b.INDEXED){var L=this.internal.newObject();M({data:C(new Uint8Array(T.palette)),objectId:L}),B("endobj")}},i=function(){var j=this.internal.collections.addImage_images;for(var T in j)a.call(this,j[T])},o=function(){var j,T=this.internal.collections.addImage_images,B=this.internal.write;for(var M in T)B("/I"+(j=T[M]).index,j.objectId,"0","R")},l=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",o))},c=function(){var j=this.internal.collections.addImage_images;return l.call(this),j},h=function(){return Object.keys(this.internal.collections.addImage_images).length},u=function(j){return typeof e["process"+j.toUpperCase()]=="function"},g=function(j){return tr(j)==="object"&&j.nodeType===1},m=function(j,T){if(j.nodeName==="IMG"&&j.hasAttribute("src")){var B=""+j.getAttribute("src");if(B.indexOf("data:image/")===0)return yo(unescape(B).split("base64,").pop());var M=e.loadFile(B,!0);if(M!==void 0)return M}if(j.nodeName==="CANVAS"){if(j.width===0||j.height===0)throw new Error("Given canvas must have data. Canvas width: "+j.width+", height: "+j.height);var le;switch(T){case"PNG":le="image/png";break;case"WEBP":le="image/webp";break;case"JPEG":case"JPG":default:le="image/jpeg"}return yo(j.toDataURL(le,1).split("base64,").pop())}},d=function(j){var T=this.internal.collections.addImage_images;if(T){for(var B in T)if(j===T[B].alias)return T[B]}},y=function(j,T,B){return j||T||(j=-96,T=-96),j<0&&(j=-1*B.width*72/j/this.internal.scaleFactor),T<0&&(T=-1*B.height*72/T/this.internal.scaleFactor),j===0&&(j=T*B.width/B.height),T===0&&(T=j*B.height/B.width),[j,T]},x=function(j,T,B,M,le,J){var z=y.call(this,B,M,le),ae=this.internal.getCoordinateString,te=this.internal.getVerticalCoordinateString,de=c.call(this);if(B=z[0],M=z[1],de[le.index]=le,J){J*=Math.PI/180;var xe=Math.cos(J),_=Math.sin(J),L=function(O){return O.toFixed(4)},P=[L(xe),L(_),L(-1*_),L(xe),0,0,"cm"]}this.internal.write("q"),J?(this.internal.write([1,"0","0",1,ae(j),te(T+M),"cm"].join(" ")),this.internal.write(P.join(" ")),this.internal.write([ae(B),"0","0",ae(M),"0","0","cm"].join(" "))):this.internal.write([ae(B),"0","0",ae(M),ae(j),te(T+M),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+le.index+" Do"),this.internal.write("Q")},b=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var N=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},w=e.__addimage__.sHashCode=function(j){var T,B,M=0;if(typeof j=="string")for(B=j.length,T=0;T<B;T++)M=(M<<5)-M+j.charCodeAt(T),M|=0;else if(V(j))for(B=j.byteLength/2,T=0;T<B;T++)M=(M<<5)-M+j[T],M|=0;return M},A=e.__addimage__.validateStringAsBase64=function(j){(j=j||"").toString().trim();var T=!0;return j.length===0&&(T=!1),j.length%4!=0&&(T=!1),/^[A-Za-z0-9+/]+$/.test(j.substr(0,j.length-2))===!1&&(T=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(j.substr(-2))===!1&&(T=!1),T},E=e.__addimage__.extractImageFromDataUrl=function(j){var T=(j=j||"").split("base64,"),B=null;if(T.length===2){var M=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(T[0]);Array.isArray(M)&&(B={mimeType:M[1],charset:M[2],data:T[1]})}return B},W=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(j){return W()&&j instanceof ArrayBuffer};var V=e.__addimage__.isArrayBufferView=function(j){return W()&&typeof Uint32Array<"u"&&(j instanceof Int8Array||j instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&j instanceof Uint8ClampedArray||j instanceof Int16Array||j instanceof Uint16Array||j instanceof Int32Array||j instanceof Uint32Array||j instanceof Float32Array||j instanceof Float64Array)},F=e.__addimage__.binaryStringToUint8Array=function(j){for(var T=j.length,B=new Uint8Array(T),M=0;M<T;M++)B[M]=j.charCodeAt(M);return B},C=e.__addimage__.arrayBufferToBinaryString=function(j){for(var T="",B=V(j)?j:new Uint8Array(j),M=0;M<B.length;M+=8192)T+=String.fromCharCode.apply(null,B.subarray(M,M+8192));return T};e.addImage=function(){var j,T,B,M,le,J,z,ae,te;if(typeof arguments[1]=="number"?(T=r,B=arguments[1],M=arguments[2],le=arguments[3],J=arguments[4],z=arguments[5],ae=arguments[6],te=arguments[7]):(T=arguments[1],B=arguments[2],M=arguments[3],le=arguments[4],J=arguments[5],z=arguments[6],ae=arguments[7],te=arguments[8]),tr(j=arguments[0])==="object"&&!g(j)&&"imageData"in j){var de=j;j=de.imageData,T=de.format||T||r,B=de.x||B||0,M=de.y||M||0,le=de.w||de.width||le,J=de.h||de.height||J,z=de.alias||z,ae=de.compression||ae,te=de.rotation||de.angle||te}var xe=this.internal.getFilters();if(ae===void 0&&xe.indexOf("FlateEncode")!==-1&&(ae="SLOW"),isNaN(B)||isNaN(M))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var _=R.call(this,j,T,z,ae);return x.call(this,B,M,le,J,_,te),this};var R=function(j,T,B,M){var le,J,z;if(typeof j=="string"&&n(j)===r){j=unescape(j);var ae=G(j,!1);(ae!==""||(ae=e.loadFile(j,!0))!==void 0)&&(j=ae)}if(g(j)&&(j=m(j,T)),T=n(j,T),!u(T))throw new Error("addImage does not support files of type '"+T+"', please ensure that a plugin for '"+T+"' support is added.");if(((z=B)==null||z.length===0)&&(B=function(te){return typeof te=="string"||V(te)?w(te):V(te.data)?w(te.data):null}(j)),(le=d.call(this,B))||(W()&&(j instanceof Uint8Array||T==="RGBA"||(J=j,j=F(j))),le=this["process"+T.toUpperCase()](j,h.call(this),B,function(te){return te&&typeof te=="string"&&(te=te.toUpperCase()),te in e.image_compression?te:N.NONE}(M),J)),!le)throw new Error("An unknown error occurred whilst processing the image.");return le},G=e.__addimage__.convertBase64ToBinaryString=function(j,T){var B;T=typeof T!="boolean"||T;var M,le="";if(typeof j=="string"){M=(B=E(j))!==null?B.data:j;try{le=yo(M)}catch(J){if(T)throw A(M)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+J.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return le};e.getImageProperties=function(j){var T,B,M="";if(g(j)&&(j=m(j)),typeof j=="string"&&n(j)===r&&((M=G(j,!1))===""&&(M=e.loadFile(j)||""),j=M),B=n(j),!u(B))throw new Error("addImage does not support files of type '"+B+"', please ensure that a plugin for '"+B+"' support is added.");if(!W()||j instanceof Uint8Array||(j=F(j)),!(T=this["process"+B.toUpperCase()](j)))throw new Error("An unknown error occurred whilst processing the image");return T.fileType=B,T}})(ht.API),function(e){var r=function(t){if(t!==void 0&&t!="")return!0};ht.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(t){for(var n,a,i,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(t.objId),h=t.pageContext.annotations,u=!1,g=0;g<h.length&&!u;g++)switch((n=h[g]).type){case"link":(r(n.options.url)||r(n.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var m=0;m<h.length;m++){n=h[m];var d=this.internal.pdfEscape,y=this.internal.getEncryptor(t.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var x=this.internal.newAdditionalObject(),b=this.internal.newAdditionalObject(),N=this.internal.getEncryptor(x.objId),w=n.title||"Note";i="<</Type /Annot /Subtype /Text "+(a="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+d(N(n.contents))+")",i+=" /Popup "+b.objId+" 0 R",i+=" /P "+c.objId+" 0 R",i+=" /T ("+d(N(w))+") >>",x.content=i;var A=x.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+o(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+A,n.open&&(i+=" /Open true"),i+=" >>",b.content=i,this.internal.write(x.objId,"0 R",b.objId,"0 R");break;case"freetext":a="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var E=n.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+d(y(n.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+E+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(n.options.name){var W=this.annotations._nameMap[n.options.name];n.options.pageNumber=W.page,n.options.top=W.y}else n.options.top||(n.options.top=0);if(a="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",i="",n.options.url)i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+d(y(n.options.url))+") >>";else if(n.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,i+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var V=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),i+=" /XYZ "+n.options.left+" "+V+" "+n.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),e.createAnnotation=function(t){var n=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":n.pageContext.annotations.push(t)}},e.link=function(t,n,a,i,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,h=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(t),y:h(n),w:c(t+a),h:h(n+i)},options:o,type:"link"})},e.textWithLink=function(t,n,a,i){var o,l,c=this.getTextWidth(t),h=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){l=i.maxWidth;var u=this.splitTextToSize(t,l).length;o=Math.ceil(h*u)}else l=c,o=h;return this.text(t,n,a,i),a+=.2*h,i.align==="center"&&(n-=c/2),i.align==="right"&&(n-=c),this.link(n,a-h,l,o,i),c},e.getTextWidth=function(t){var n=this.internal.getFontSize();return this.getStringUnitWidth(t)*n/this.internal.scaleFactor}}(ht.API),function(e){var r={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];e.__arabicParser__={};var i=e.__arabicParser__.isInArabicSubstitutionA=function(x){return r[x.charCodeAt(0)]!==void 0},o=e.__arabicParser__.isArabicLetter=function(x){return typeof x=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(x)},l=e.__arabicParser__.isArabicEndLetter=function(x){return o(x)&&i(x)&&r[x.charCodeAt(0)].length<=2},c=e.__arabicParser__.isArabicAlfLetter=function(x){return o(x)&&a.indexOf(x.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(x){return o(x)&&i(x)&&r[x.charCodeAt(0)].length>=1};var h=e.__arabicParser__.arabicLetterHasFinalForm=function(x){return o(x)&&i(x)&&r[x.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(x){return o(x)&&i(x)&&r[x.charCodeAt(0)].length>=3};var u=e.__arabicParser__.arabicLetterHasMedialForm=function(x){return o(x)&&i(x)&&r[x.charCodeAt(0)].length==4},g=e.__arabicParser__.resolveLigatures=function(x){var b=0,N=t,w="",A=0;for(b=0;b<x.length;b+=1)N[x.charCodeAt(b)]!==void 0?(A++,typeof(N=N[x.charCodeAt(b)])=="number"&&(w+=String.fromCharCode(N),N=t,A=0),b===x.length-1&&(N=t,w+=x.charAt(b-(A-1)),b-=A-1,A=0)):(N=t,w+=x.charAt(b-A),b-=A,A=0);return w};e.__arabicParser__.isArabicDiacritic=function(x){return x!==void 0&&n[x.charCodeAt(0)]!==void 0};var m=e.__arabicParser__.getCorrectForm=function(x,b,N){return o(x)?i(x)===!1?-1:!h(x)||!o(b)&&!o(N)||!o(N)&&l(b)||l(x)&&!o(b)||l(x)&&c(b)||l(x)&&l(b)?0:u(x)&&o(b)&&!l(b)&&o(N)&&h(N)?3:l(x)||!o(N)?1:2:-1},d=function(x){var b=0,N=0,w=0,A="",E="",W="",V=(x=x||"").split("\\s+"),F=[];for(b=0;b<V.length;b+=1){for(F.push(""),N=0;N<V[b].length;N+=1)A=V[b][N],E=V[b][N-1],W=V[b][N+1],o(A)?(w=m(A,E,W),F[b]+=w!==-1?String.fromCharCode(r[A.charCodeAt(0)][w]):A):F[b]+=A;F[b]=g(F[b])}return F.join(" ")},y=e.__arabicParser__.processArabic=e.processArabic=function(){var x,b=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,N=[];if(Array.isArray(b)){var w=0;for(N=[],w=0;w<b.length;w+=1)Array.isArray(b[w])?N.push([d(b[w][0]),b[w][1],b[w][2]]):N.push([d(b[w])]);x=N}else x=d(b);return typeof arguments[0]=="string"?x:(arguments[0].text=x,arguments[0])};e.events.push(["preProcessText",y])}(ht.API),ht.API.autoPrint=function(e){var r;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){r=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+r+" 0 R")})}return this},function(e){var r=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(l){t=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(l){a=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(l){i=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};r.prototype.getContext=function(t,n){var a;if((t=t||"2d")!=="2d")return null;for(a in n)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=n[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},r.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new r,this.canvas.pdf=this}])}(ht.API),function(e){var r={left:0,top:0,bottom:0,right:0},t=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},r),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(x){c=x}});var h=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return h},set:function(x){h=x}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(x){u=x}});var g=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return g},set:function(x){g=x}});var m=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return m},set:function(x){m=x}});var d=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return d},set:function(x){d=x}});var y=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return y},set:function(x){y=x}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},e.getTextDimensions=function(c,h){n.call(this);var u=(h=h||{}).fontSize||this.getFontSize(),g=h.font||this.getFont(),m=h.scaleFactor||this.internal.scaleFactor,d=0,y=0,x=0,b=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var N=h.maxWidth;N>0?typeof c=="string"?c=this.splitTextToSize(c,N):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(A,E){return A.concat(b.splitTextToSize(E,N))},[])):c=Array.isArray(c)?c:[c];for(var w=0;w<c.length;w++)d<(x=this.getStringUnitWidth(c[w],{font:g})*u)&&(d=x);return d!==0&&(y=c.length),{w:d/=m,h:Math.max((y*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/m,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||r;return this.internal.__cell__.lastCell=new i(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=e.cell=function(){var c;c=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var h=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,g=this.internal.__cell__.margins||r,m=this.internal.__cell__.tableHeaderRow,d=this.internal.__cell__.printHeaders;return h.lineNumber!==void 0&&(h.lineNumber===c.lineNumber?(c.x=(h.x||0)+(h.width||0),c.y=h.y||0):h.y+h.height+c.height+g.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=g.top,d&&m&&(this.printHeaderRow(c.lineNumber,!0),c.y+=m[0].height)):c.y=h.y+h.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,t===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-u,c.y+u,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+u,{align:"center",baseline:"top",maxWidth:c.width-u-u}):this.text(c.text,c.x+u,c.y+u,{align:"left",baseline:"top",maxWidth:c.width-u-u})),this.internal.__cell__.lastCell=c,this};e.table=function(c,h,u,g,m){if(n.call(this),!u)throw new Error("No data for PDF table.");var d,y,x,b,N=[],w=[],A=[],E={},W={},V=[],F=[],C=(m=m||{}).autoSize||!1,R=m.printHeaders!==!1,G=m.css&&m.css["font-size"]!==void 0?16*m.css["font-size"]:m.fontSize||12,j=m.margins||Object.assign({width:this.getPageWidth()},r),T=typeof m.padding=="number"?m.padding:3,B=m.headerBackgroundColor||"#c8c8c8",M=m.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=R,this.internal.__cell__.margins=j,this.internal.__cell__.table_font_size=G,this.internal.__cell__.padding=T,this.internal.__cell__.headerBackgroundColor=B,this.internal.__cell__.headerTextColor=M,this.setFontSize(G),g==null)w=N=Object.keys(u[0]),A=N.map(function(){return"left"});else if(Array.isArray(g)&&tr(g[0])==="object")for(N=g.map(function(de){return de.name}),w=g.map(function(de){return de.prompt||de.name||""}),A=g.map(function(de){return de.align||"left"}),d=0;d<g.length;d+=1)W[g[d].name]=g[d].width*(19.049976/25.4);else Array.isArray(g)&&typeof g[0]=="string"&&(w=N=g,A=N.map(function(){return"left"}));if(C||Array.isArray(g)&&typeof g[0]=="string")for(d=0;d<N.length;d+=1){for(E[b=N[d]]=u.map(function(de){return de[b]}),this.setFont(void 0,"bold"),V.push(this.getTextDimensions(w[d],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),y=E[b],this.setFont(void 0,"normal"),x=0;x<y.length;x+=1)V.push(this.getTextDimensions(y[x],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);W[b]=Math.max.apply(null,V)+T+T,V=[]}if(R){var le={};for(d=0;d<N.length;d+=1)le[N[d]]={},le[N[d]].text=w[d],le[N[d]].align=A[d];var J=l.call(this,le,W);F=N.map(function(de){return new i(c,h,W[de],J,le[de].text,void 0,le[de].align)}),this.setTableHeaderRow(F),this.printHeaderRow(1,!1)}var z=g.reduce(function(de,xe){return de[xe.name]=xe.align,de},{});for(d=0;d<u.length;d+=1){"rowStart"in m&&m.rowStart instanceof Function&&m.rowStart({row:d,data:u[d]},this);var ae=l.call(this,u[d],W);for(x=0;x<N.length;x+=1){var te=u[d][N[x]];"cellStart"in m&&m.cellStart instanceof Function&&m.cellStart({row:d,col:x,data:te},this),o.call(this,new i(c,h,W[N[x]],ae,te,d+2,z[N[x]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=h,this};var l=function(c,h){var u=this.internal.__cell__.padding,g=this.internal.__cell__.table_font_size,m=this.internal.scaleFactor;return Object.keys(c).map(function(d){var y=c[d];return this.splitTextToSize(y.hasOwnProperty("text")?y.text:y,h[d]-u-u)},this).map(function(d){return this.getLineHeightFactor()*d.length*g/m+u+u},this).reduce(function(d,y){return Math.max(d,y)},0)};e.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},e.printHeaderRow=function(c,h){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var g=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(g[0],g[1],g[2],g[3],void 0,-1)}this.setFont(void 0,"bold");for(var m=[],d=0;d<this.internal.__cell__.tableHeaderRow.length;d+=1){u=this.internal.__cell__.tableHeaderRow[d].clone(),h&&(u.y=this.internal.__cell__.margins.top||0,m.push(u)),u.lineNumber=c;var y=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,u),this.setTextColor(y)}m.length>0&&this.setTableHeaderRow(m),this.setFont(void 0,"normal"),t=!1}}(ht.API);var Au={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},ju=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],R0=_u(ju),Tu=[100,200,300,400,500,600,700,800,900],jp=_u(Tu);function M0(e){var r=e.family.replace(/"|'/g,"").toLowerCase(),t=function(i){return Au[i=i||"normal"]?i:"normal"}(e.style),n=function(i){if(!i)return 400;if(typeof i=="number")return i>=100&&i<=900&&i%100==0?i:400;if(/^\d00$/.test(i))return parseInt(i);switch(i){case"bold":return 700;case"normal":default:return 400}}(e.weight),a=function(i){return typeof R0[i=i||"normal"]=="number"?i:"normal"}(e.stretch);return{family:r,style:t,weight:n,stretch:a,src:e.src||[],ref:e.ref||{name:r,style:[a,t,n].join(" ")}}}function rh(e,r,t,n){var a;for(a=t;a>=0&&a<r.length;a+=n)if(e[r[a]])return e[r[a]];for(a=t;a>=0&&a<r.length;a-=n)if(e[r[a]])return e[r[a]]}var Tp={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},nh={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function ah(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function kp(e,r,t){for(var n=(t=t||{}).defaultFontFamily||"times",a=Object.assign({},Tp,t.genericFontFamilies||{}),i=null,o=null,l=0;l<r.length;++l)if(a[(i=M0(r[l])).family]&&(i.family=a[i.family]),e.hasOwnProperty(i.family)){o=e[i.family];break}if(!(o=o||e[n]))throw new Error("Could not find a font-family for the rule '"+ah(i)+"' and default family '"+n+"'.");if(o=function(c,h){if(h[c])return h[c];var u=R0[c],g=u<=R0.normal?-1:1,m=rh(h,ju,u,g);if(!m)throw new Error("Could not find a matching font-stretch value for "+c);return m}(i.stretch,o),o=function(c,h){if(h[c])return h[c];for(var u=Au[c],g=0;g<u.length;++g)if(h[u[g]])return h[u[g]];throw new Error("Could not find a matching font-style for "+c)}(i.style,o),!(o=function(c,h){if(h[c])return h[c];if(c===400&&h[500])return h[500];if(c===500&&h[400])return h[400];var u=jp[c],g=rh(h,Tu,u,c<400?-1:1);if(!g)throw new Error("Could not find a matching font-weight for value "+c);return g}(i.weight,o)))throw new Error("Failed to resolve a font for the rule '"+ah(i)+"'.");return o}function ih(e){return e.trimLeft()}function Ep(e,r){for(var t=0;t<e.length;){if(e.charAt(t)===r)return[e.substring(0,t),e.substring(t+1)];t+=1}return null}function Fp(e){var r=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return r===null?null:[r[0],e.substring(r[0].length)]}var Rl,sh,oh,d0=["times"];(function(e){var r,t,n,a,i,o,l,c,h,u=function(_){return _=_||{},this.isStrokeTransparent=_.isStrokeTransparent||!1,this.strokeOpacity=_.strokeOpacity||1,this.strokeStyle=_.strokeStyle||"#000000",this.fillStyle=_.fillStyle||"#000000",this.isFillTransparent=_.isFillTransparent||!1,this.fillOpacity=_.fillOpacity||1,this.font=_.font||"10px sans-serif",this.textBaseline=_.textBaseline||"alphabetic",this.textAlign=_.textAlign||"left",this.lineWidth=_.lineWidth||1,this.lineJoin=_.lineJoin||"miter",this.lineCap=_.lineCap||"butt",this.path=_.path||[],this.transform=_.transform!==void 0?_.transform.clone():new c,this.globalCompositeOperation=_.globalCompositeOperation||"normal",this.globalAlpha=_.globalAlpha||1,this.clip_path=_.clip_path||[],this.currentPoint=_.currentPoint||new o,this.miterLimit=_.miterLimit||10,this.lastPoint=_.lastPoint||new o,this.lineDashOffset=_.lineDashOffset||0,this.lineDash=_.lineDash||[],this.margin=_.margin||[0,0,0,0],this.prevPageLastElemOffset=_.prevPageLastElemOffset||0,this.ignoreClearRect=typeof _.ignoreClearRect!="boolean"||_.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new g(this),r=this.internal.f2,t=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,h=new u}]);var g=function(_){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var L=_;Object.defineProperty(this,"pdf",{get:function(){return L}});var P=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return P},set:function(ke){P=!!ke}});var O=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return O},set:function(ke){O=!!ke}});var X=0;Object.defineProperty(this,"posX",{get:function(){return X},set:function(ke){isNaN(ke)||(X=ke)}});var ce=0;Object.defineProperty(this,"posY",{get:function(){return ce},set:function(ke){isNaN(ke)||(ce=ke)}}),Object.defineProperty(this,"margin",{get:function(){return h.margin},set:function(ke){var oe;typeof ke=="number"?oe=[ke,ke,ke,ke]:((oe=new Array(4))[0]=ke[0],oe[1]=ke.length>=2?ke[1]:oe[0],oe[2]=ke.length>=3?ke[2]:oe[0],oe[3]=ke.length>=4?ke[3]:oe[1]),h.margin=oe}});var fe=!1;Object.defineProperty(this,"autoPaging",{get:function(){return fe},set:function(ke){fe=ke}});var he=0;Object.defineProperty(this,"lastBreak",{get:function(){return he},set:function(ke){he=ke}});var we=[];Object.defineProperty(this,"pageBreaks",{get:function(){return we},set:function(ke){we=ke}}),Object.defineProperty(this,"ctx",{get:function(){return h},set:function(ke){ke instanceof u&&(h=ke)}}),Object.defineProperty(this,"path",{get:function(){return h.path},set:function(ke){h.path=ke}});var Pe=[];Object.defineProperty(this,"ctxStack",{get:function(){return Pe},set:function(ke){Pe=ke}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ke){var oe;oe=m(ke),this.ctx.fillStyle=oe.style,this.ctx.isFillTransparent=oe.a===0,this.ctx.fillOpacity=oe.a,this.pdf.setFillColor(oe.r,oe.g,oe.b,{a:oe.a}),this.pdf.setTextColor(oe.r,oe.g,oe.b,{a:oe.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ke){var oe=m(ke);this.ctx.strokeStyle=oe.style,this.ctx.isStrokeTransparent=oe.a===0,this.ctx.strokeOpacity=oe.a,oe.a===0?this.pdf.setDrawColor(255,255,255):(oe.a,this.pdf.setDrawColor(oe.r,oe.g,oe.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ke){["butt","round","square"].indexOf(ke)!==-1&&(this.ctx.lineCap=ke,this.pdf.setLineCap(ke))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ke){isNaN(ke)||(this.ctx.lineWidth=ke,this.pdf.setLineWidth(ke))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ke){["bevel","round","miter"].indexOf(ke)!==-1&&(this.ctx.lineJoin=ke,this.pdf.setLineJoin(ke))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ke){isNaN(ke)||(this.ctx.miterLimit=ke,this.pdf.setMiterLimit(ke))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ke){this.ctx.textBaseline=ke}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ke){["right","end","center","left","start"].indexOf(ke)!==-1&&(this.ctx.textAlign=ke)}});var Re=null;function ze(ke,oe){if(Re===null){var Me=function(at){var He=[];return Object.keys(at).forEach(function(Ge){at[Ge].forEach(function(Je){var Qe=null;switch(Je){case"bold":Qe={family:Ge,weight:"bold"};break;case"italic":Qe={family:Ge,style:"italic"};break;case"bolditalic":Qe={family:Ge,weight:"bold",style:"italic"};break;case"":case"normal":Qe={family:Ge}}Qe!==null&&(Qe.ref={name:Ge,style:Je},He.push(Qe))})}),He}(ke.getFontList());Re=function(at){for(var He={},Ge=0;Ge<at.length;++Ge){var Je=M0(at[Ge]),Qe=Je.family,lt=Je.stretch,ct=Je.style,xt=Je.weight;He[Qe]=He[Qe]||{},He[Qe][lt]=He[Qe][lt]||{},He[Qe][lt][ct]=He[Qe][lt][ct]||{},He[Qe][lt][ct][xt]=Je}return He}(Me.concat(oe))}return Re}var Ke=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ke},set:function(ke){Re=null,Ke=ke}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ke){var oe;if(this.ctx.font=ke,(oe=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(ke))!==null){var Me=oe[1],at=(oe[2],oe[3]),He=oe[4],Ge=(oe[5],oe[6]),Je=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(He)[2];He=Math.floor(Je==="px"?parseFloat(He)*this.pdf.internal.scaleFactor:Je==="em"?parseFloat(He)*this.pdf.getFontSize():parseFloat(He)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(He);var Qe=function(pt){var jt,tt,Fr=[],Lt=pt.trim();if(Lt==="")return d0;if(Lt in nh)return[nh[Lt]];for(;Lt!=="";){switch(tt=null,jt=(Lt=ih(Lt)).charAt(0)){case'"':case"'":tt=Ep(Lt.substring(1),jt);break;default:tt=Fp(Lt)}if(tt===null||(Fr.push(tt[0]),(Lt=ih(tt[1]))!==""&&Lt.charAt(0)!==","))return d0;Lt=Lt.replace(/^,/,"")}return Fr}(Ge);if(this.fontFaces){var lt=kp(ze(this.pdf,this.fontFaces),Qe.map(function(pt){return{family:pt,stretch:"normal",weight:at,style:Me}}));this.pdf.setFont(lt.ref.name,lt.ref.style)}else{var ct="";(at==="bold"||parseInt(at,10)>=700||Me==="bold")&&(ct="bold"),Me==="italic"&&(ct+="italic"),ct.length===0&&(ct="normal");for(var xt="",_t={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},kt=0;kt<Qe.length;kt++){if(this.pdf.internal.getFont(Qe[kt],ct,{noFallback:!0,disableWarning:!0})!==void 0){xt=Qe[kt];break}if(ct==="bolditalic"&&this.pdf.internal.getFont(Qe[kt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)xt=Qe[kt],ct="bold";else if(this.pdf.internal.getFont(Qe[kt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){xt=Qe[kt],ct="normal";break}}if(xt===""){for(var Et=0;Et<Qe.length;Et++)if(_t[Qe[Et]]){xt=_t[Qe[Et]];break}}xt=xt===""?"Times":xt,this.pdf.setFont(xt,ct)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ke){this.ctx.globalCompositeOperation=ke}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ke){this.ctx.globalAlpha=ke}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ke){this.ctx.lineDashOffset=ke,xe.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ke){this.ctx.lineDash=ke,xe.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ke){this.ctx.ignoreClearRect=!!ke}})};g.prototype.setLineDash=function(_){this.lineDash=_},g.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},g.prototype.fill=function(){E.call(this,"fill",!1)},g.prototype.stroke=function(){E.call(this,"stroke",!1)},g.prototype.beginPath=function(){this.path=[{type:"begin"}]},g.prototype.moveTo=function(_,L){if(isNaN(_)||isNaN(L))throw er.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var P=this.ctx.transform.applyToPoint(new o(_,L));this.path.push({type:"mt",x:P.x,y:P.y}),this.ctx.lastPoint=new o(_,L)},g.prototype.closePath=function(){var _=new o(0,0),L=0;for(L=this.path.length-1;L!==-1;L--)if(this.path[L].type==="begin"&&tr(this.path[L+1])==="object"&&typeof this.path[L+1].x=="number"){_=new o(this.path[L+1].x,this.path[L+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(_.x,_.y)},g.prototype.lineTo=function(_,L){if(isNaN(_)||isNaN(L))throw er.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var P=this.ctx.transform.applyToPoint(new o(_,L));this.path.push({type:"lt",x:P.x,y:P.y}),this.ctx.lastPoint=new o(P.x,P.y)},g.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),E.call(this,null,!0)},g.prototype.quadraticCurveTo=function(_,L,P,O){if(isNaN(P)||isNaN(O)||isNaN(_)||isNaN(L))throw er.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var X=this.ctx.transform.applyToPoint(new o(P,O)),ce=this.ctx.transform.applyToPoint(new o(_,L));this.path.push({type:"qct",x1:ce.x,y1:ce.y,x:X.x,y:X.y}),this.ctx.lastPoint=new o(X.x,X.y)},g.prototype.bezierCurveTo=function(_,L,P,O,X,ce){if(isNaN(X)||isNaN(ce)||isNaN(_)||isNaN(L)||isNaN(P)||isNaN(O))throw er.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var fe=this.ctx.transform.applyToPoint(new o(X,ce)),he=this.ctx.transform.applyToPoint(new o(_,L)),we=this.ctx.transform.applyToPoint(new o(P,O));this.path.push({type:"bct",x1:he.x,y1:he.y,x2:we.x,y2:we.y,x:fe.x,y:fe.y}),this.ctx.lastPoint=new o(fe.x,fe.y)},g.prototype.arc=function(_,L,P,O,X,ce){if(isNaN(_)||isNaN(L)||isNaN(P)||isNaN(O)||isNaN(X))throw er.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ce=!!ce,!this.ctx.transform.isIdentity){var fe=this.ctx.transform.applyToPoint(new o(_,L));_=fe.x,L=fe.y;var he=this.ctx.transform.applyToPoint(new o(0,P)),we=this.ctx.transform.applyToPoint(new o(0,0));P=Math.sqrt(Math.pow(he.x-we.x,2)+Math.pow(he.y-we.y,2))}Math.abs(X-O)>=2*Math.PI&&(O=0,X=2*Math.PI),this.path.push({type:"arc",x:_,y:L,radius:P,startAngle:O,endAngle:X,counterclockwise:ce})},g.prototype.arcTo=function(_,L,P,O,X){throw new Error("arcTo not implemented.")},g.prototype.rect=function(_,L,P,O){if(isNaN(_)||isNaN(L)||isNaN(P)||isNaN(O))throw er.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(_,L),this.lineTo(_+P,L),this.lineTo(_+P,L+O),this.lineTo(_,L+O),this.lineTo(_,L),this.lineTo(_+P,L),this.lineTo(_,L)},g.prototype.fillRect=function(_,L,P,O){if(isNaN(_)||isNaN(L)||isNaN(P)||isNaN(O))throw er.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!d.call(this)){var X={};this.lineCap!=="butt"&&(X.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(X.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(_,L,P,O),this.fill(),X.hasOwnProperty("lineCap")&&(this.lineCap=X.lineCap),X.hasOwnProperty("lineJoin")&&(this.lineJoin=X.lineJoin)}},g.prototype.strokeRect=function(_,L,P,O){if(isNaN(_)||isNaN(L)||isNaN(P)||isNaN(O))throw er.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");y.call(this)||(this.beginPath(),this.rect(_,L,P,O),this.stroke())},g.prototype.clearRect=function(_,L,P,O){if(isNaN(_)||isNaN(L)||isNaN(P)||isNaN(O))throw er.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(_,L,P,O))},g.prototype.save=function(_){_=typeof _!="boolean"||_;for(var L=this.pdf.internal.getCurrentPageInfo().pageNumber,P=0;P<this.pdf.internal.getNumberOfPages();P++)this.pdf.setPage(P+1),this.pdf.internal.out("q");if(this.pdf.setPage(L),_){this.ctx.fontSize=this.pdf.internal.getFontSize();var O=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=O}},g.prototype.restore=function(_){_=typeof _!="boolean"||_;for(var L=this.pdf.internal.getCurrentPageInfo().pageNumber,P=0;P<this.pdf.internal.getNumberOfPages();P++)this.pdf.setPage(P+1),this.pdf.internal.out("Q");this.pdf.setPage(L),_&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},g.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var m=function(_){var L,P,O,X;if(_.isCanvasGradient===!0&&(_=_.getColor()),!_)return{r:0,g:0,b:0,a:0,style:_};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(_))L=0,P=0,O=0,X=0;else{var ce=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(_);if(ce!==null)L=parseInt(ce[1]),P=parseInt(ce[2]),O=parseInt(ce[3]),X=1;else if((ce=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(_))!==null)L=parseInt(ce[1]),P=parseInt(ce[2]),O=parseInt(ce[3]),X=parseFloat(ce[4]);else{if(X=1,typeof _=="string"&&_.charAt(0)!=="#"){var fe=new vu(_);_=fe.ok?fe.toHex():"#000000"}_.length===4?(L=_.substring(1,2),L+=L,P=_.substring(2,3),P+=P,O=_.substring(3,4),O+=O):(L=_.substring(1,3),P=_.substring(3,5),O=_.substring(5,7)),L=parseInt(L,16),P=parseInt(P,16),O=parseInt(O,16)}}return{r:L,g:P,b:O,a:X,style:_}},d=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},y=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};g.prototype.fillText=function(_,L,P,O){if(isNaN(L)||isNaN(P)||typeof _!="string")throw er.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(O=isNaN(O)?void 0:O,!d.call(this)){var X=ae(this.ctx.transform.rotation),ce=this.ctx.transform.scaleX;T.call(this,{text:_,x:L,y:P,scale:ce,angle:X,align:this.textAlign,maxWidth:O})}},g.prototype.strokeText=function(_,L,P,O){if(isNaN(L)||isNaN(P)||typeof _!="string")throw er.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!y.call(this)){O=isNaN(O)?void 0:O;var X=ae(this.ctx.transform.rotation),ce=this.ctx.transform.scaleX;T.call(this,{text:_,x:L,y:P,scale:ce,renderingMode:"stroke",angle:X,align:this.textAlign,maxWidth:O})}},g.prototype.measureText=function(_){if(typeof _!="string")throw er.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var L=this.pdf,P=this.pdf.internal.scaleFactor,O=L.internal.getFontSize(),X=L.getStringUnitWidth(_)*O/L.internal.scaleFactor,ce=function(fe){var he=(fe=fe||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return he}}),this};return new ce({width:X*=Math.round(96*P/72*1e4)/1e4})},g.prototype.scale=function(_,L){if(isNaN(_)||isNaN(L))throw er.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var P=new c(_,0,0,L,0,0);this.ctx.transform=this.ctx.transform.multiply(P)},g.prototype.rotate=function(_){if(isNaN(_))throw er.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var L=new c(Math.cos(_),Math.sin(_),-Math.sin(_),Math.cos(_),0,0);this.ctx.transform=this.ctx.transform.multiply(L)},g.prototype.translate=function(_,L){if(isNaN(_)||isNaN(L))throw er.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var P=new c(1,0,0,1,_,L);this.ctx.transform=this.ctx.transform.multiply(P)},g.prototype.transform=function(_,L,P,O,X,ce){if(isNaN(_)||isNaN(L)||isNaN(P)||isNaN(O)||isNaN(X)||isNaN(ce))throw er.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var fe=new c(_,L,P,O,X,ce);this.ctx.transform=this.ctx.transform.multiply(fe)},g.prototype.setTransform=function(_,L,P,O,X,ce){_=isNaN(_)?1:_,L=isNaN(L)?0:L,P=isNaN(P)?0:P,O=isNaN(O)?1:O,X=isNaN(X)?0:X,ce=isNaN(ce)?0:ce,this.ctx.transform=new c(_,L,P,O,X,ce)};var x=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};g.prototype.drawImage=function(_,L,P,O,X,ce,fe,he,we){var Pe=this.pdf.getImageProperties(_),Re=1,ze=1,Ke=1,ke=1;O!==void 0&&he!==void 0&&(Ke=he/O,ke=we/X,Re=Pe.width/O*he/O,ze=Pe.height/X*we/X),ce===void 0&&(ce=L,fe=P,L=0,P=0),O!==void 0&&he===void 0&&(he=O,we=X),O===void 0&&he===void 0&&(he=Pe.width,we=Pe.height);for(var oe,Me=this.ctx.transform.decompose(),at=ae(Me.rotate.shx),He=new c,Ge=(He=(He=(He=He.multiply(Me.translate)).multiply(Me.skew)).multiply(Me.scale)).applyToRectangle(new l(ce-L*Ke,fe-P*ke,O*Re,X*ze)),Je=b.call(this,Ge),Qe=[],lt=0;lt<Je.length;lt+=1)Qe.indexOf(Je[lt])===-1&&Qe.push(Je[lt]);if(A(Qe),this.autoPaging)for(var ct=Qe[0],xt=Qe[Qe.length-1],_t=ct;_t<xt+1;_t++){this.pdf.setPage(_t);var kt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Et=_t===1?this.posY+this.margin[0]:this.margin[0],pt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],jt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],tt=_t===1?0:pt+(_t-2)*jt;if(this.ctx.clip_path.length!==0){var Fr=this.path;oe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(oe,this.posX+this.margin[3],-tt+Et+this.ctx.prevPageLastElemOffset),W.call(this,"fill",!0),this.path=Fr}var Lt=JSON.parse(JSON.stringify(Ge));Lt=w([Lt],this.posX+this.margin[3],-tt+Et+this.ctx.prevPageLastElemOffset)[0];var dn=(_t>ct||_t<xt)&&x.call(this);dn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],kt,jt,null).clip().discardPath()),this.pdf.addImage(_,"JPEG",Lt.x,Lt.y,Lt.w,Lt.h,null,null,at),dn&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(_,"JPEG",Ge.x,Ge.y,Ge.w,Ge.h,null,null,at)};var b=function(_,L,P){var O=[];L=L||this.pdf.internal.pageSize.width,P=P||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var X=this.posY+this.ctx.prevPageLastElemOffset;switch(_.type){default:case"mt":case"lt":O.push(Math.floor((_.y+X)/P)+1);break;case"arc":O.push(Math.floor((_.y+X-_.radius)/P)+1),O.push(Math.floor((_.y+X+_.radius)/P)+1);break;case"qct":var ce=te(this.ctx.lastPoint.x,this.ctx.lastPoint.y,_.x1,_.y1,_.x,_.y);O.push(Math.floor((ce.y+X)/P)+1),O.push(Math.floor((ce.y+ce.h+X)/P)+1);break;case"bct":var fe=de(this.ctx.lastPoint.x,this.ctx.lastPoint.y,_.x1,_.y1,_.x2,_.y2,_.x,_.y);O.push(Math.floor((fe.y+X)/P)+1),O.push(Math.floor((fe.y+fe.h+X)/P)+1);break;case"rect":O.push(Math.floor((_.y+X)/P)+1),O.push(Math.floor((_.y+_.h+X)/P)+1)}for(var he=0;he<O.length;he+=1)for(;this.pdf.internal.getNumberOfPages()<O[he];)N.call(this);return O},N=function(){var _=this.fillStyle,L=this.strokeStyle,P=this.font,O=this.lineCap,X=this.lineWidth,ce=this.lineJoin;this.pdf.addPage(),this.fillStyle=_,this.strokeStyle=L,this.font=P,this.lineCap=O,this.lineWidth=X,this.lineJoin=ce},w=function(_,L,P){for(var O=0;O<_.length;O++)switch(_[O].type){case"bct":_[O].x2+=L,_[O].y2+=P;case"qct":_[O].x1+=L,_[O].y1+=P;case"mt":case"lt":case"arc":default:_[O].x+=L,_[O].y+=P}return _},A=function(_){return _.sort(function(L,P){return L-P})},E=function(_,L){for(var P,O,X=this.fillStyle,ce=this.strokeStyle,fe=this.lineCap,he=this.lineWidth,we=Math.abs(he*this.ctx.transform.scaleX),Pe=this.lineJoin,Re=JSON.parse(JSON.stringify(this.path)),ze=JSON.parse(JSON.stringify(this.path)),Ke=[],ke=0;ke<ze.length;ke++)if(ze[ke].x!==void 0)for(var oe=b.call(this,ze[ke]),Me=0;Me<oe.length;Me+=1)Ke.indexOf(oe[Me])===-1&&Ke.push(oe[Me]);for(var at=0;at<Ke.length;at++)for(;this.pdf.internal.getNumberOfPages()<Ke[at];)N.call(this);if(A(Ke),this.autoPaging)for(var He=Ke[0],Ge=Ke[Ke.length-1],Je=He;Je<Ge+1;Je++){this.pdf.setPage(Je),this.fillStyle=X,this.strokeStyle=ce,this.lineCap=fe,this.lineWidth=we,this.lineJoin=Pe;var Qe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],lt=Je===1?this.posY+this.margin[0]:this.margin[0],ct=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],xt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],_t=Je===1?0:ct+(Je-2)*xt;if(this.ctx.clip_path.length!==0){var kt=this.path;P=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(P,this.posX+this.margin[3],-_t+lt+this.ctx.prevPageLastElemOffset),W.call(this,_,!0),this.path=kt}if(O=JSON.parse(JSON.stringify(Re)),this.path=w(O,this.posX+this.margin[3],-_t+lt+this.ctx.prevPageLastElemOffset),L===!1||Je===0){var Et=(Je>He||Je<Ge)&&x.call(this);Et&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Qe,xt,null).clip().discardPath()),W.call(this,_,L),Et&&this.pdf.restoreGraphicsState()}this.lineWidth=he}else this.lineWidth=we,W.call(this,_,L),this.lineWidth=he;this.path=Re},W=function(_,L){if((_!=="stroke"||L||!y.call(this))&&(_==="stroke"||L||!d.call(this))){for(var P,O,X=[],ce=this.path,fe=0;fe<ce.length;fe++){var he=ce[fe];switch(he.type){case"begin":X.push({begin:!0});break;case"close":X.push({close:!0});break;case"mt":X.push({start:he,deltas:[],abs:[]});break;case"lt":var we=X.length;if(ce[fe-1]&&!isNaN(ce[fe-1].x)&&(P=[he.x-ce[fe-1].x,he.y-ce[fe-1].y],we>0)){for(;we>=0;we--)if(X[we-1].close!==!0&&X[we-1].begin!==!0){X[we-1].deltas.push(P),X[we-1].abs.push(he);break}}break;case"bct":P=[he.x1-ce[fe-1].x,he.y1-ce[fe-1].y,he.x2-ce[fe-1].x,he.y2-ce[fe-1].y,he.x-ce[fe-1].x,he.y-ce[fe-1].y],X[X.length-1].deltas.push(P);break;case"qct":var Pe=ce[fe-1].x+2/3*(he.x1-ce[fe-1].x),Re=ce[fe-1].y+2/3*(he.y1-ce[fe-1].y),ze=he.x+2/3*(he.x1-he.x),Ke=he.y+2/3*(he.y1-he.y),ke=he.x,oe=he.y;P=[Pe-ce[fe-1].x,Re-ce[fe-1].y,ze-ce[fe-1].x,Ke-ce[fe-1].y,ke-ce[fe-1].x,oe-ce[fe-1].y],X[X.length-1].deltas.push(P);break;case"arc":X.push({deltas:[],abs:[],arc:!0}),Array.isArray(X[X.length-1].abs)&&X[X.length-1].abs.push(he)}}O=L?null:_==="stroke"?"stroke":"fill";for(var Me=!1,at=0;at<X.length;at++)if(X[at].arc)for(var He=X[at].abs,Ge=0;Ge<He.length;Ge++){var Je=He[Ge];Je.type==="arc"?C.call(this,Je.x,Je.y,Je.radius,Je.startAngle,Je.endAngle,Je.counterclockwise,void 0,L,!Me):B.call(this,Je.x,Je.y),Me=!0}else if(X[at].close===!0)this.pdf.internal.out("h"),Me=!1;else if(X[at].begin!==!0){var Qe=X[at].start.x,lt=X[at].start.y;M.call(this,X[at].deltas,Qe,lt),Me=!0}O&&R.call(this,O),L&&G.call(this)}},V=function(_){var L=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,P=L*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return _-P;case"top":return _+L-P;case"hanging":return _+L-2*P;case"middle":return _+L/2-P;case"ideographic":return _;case"alphabetic":default:return _}},F=function(_){return _+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};g.prototype.createLinearGradient=function(){var _=function(){};return _.colorStops=[],_.addColorStop=function(L,P){this.colorStops.push([L,P])},_.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},_.isCanvasGradient=!0,_},g.prototype.createPattern=function(){return this.createLinearGradient()},g.prototype.createRadialGradient=function(){return this.createLinearGradient()};var C=function(_,L,P,O,X,ce,fe,he,we){for(var Pe=J.call(this,P,O,X,ce),Re=0;Re<Pe.length;Re++){var ze=Pe[Re];Re===0&&(we?j.call(this,ze.x1+_,ze.y1+L):B.call(this,ze.x1+_,ze.y1+L)),le.call(this,_,L,ze.x2,ze.y2,ze.x3,ze.y3,ze.x4,ze.y4)}he?G.call(this):R.call(this,fe)},R=function(_){switch(_){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},G=function(){this.pdf.clip(),this.pdf.discardPath()},j=function(_,L){this.pdf.internal.out(t(_)+" "+n(L)+" m")},T=function(_){var L;switch(_.align){case"right":case"end":L="right";break;case"center":L="center";break;case"left":case"start":default:L="left"}var P=this.pdf.getTextDimensions(_.text),O=V.call(this,_.y),X=F.call(this,O)-P.h,ce=this.ctx.transform.applyToPoint(new o(_.x,O)),fe=this.ctx.transform.decompose(),he=new c;he=(he=(he=he.multiply(fe.translate)).multiply(fe.skew)).multiply(fe.scale);for(var we,Pe,Re,ze=this.ctx.transform.applyToRectangle(new l(_.x,O,P.w,P.h)),Ke=he.applyToRectangle(new l(_.x,X,P.w,P.h)),ke=b.call(this,Ke),oe=[],Me=0;Me<ke.length;Me+=1)oe.indexOf(ke[Me])===-1&&oe.push(ke[Me]);if(A(oe),this.autoPaging)for(var at=oe[0],He=oe[oe.length-1],Ge=at;Ge<He+1;Ge++){this.pdf.setPage(Ge);var Je=Ge===1?this.posY+this.margin[0]:this.margin[0],Qe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],lt=this.pdf.internal.pageSize.height-this.margin[2],ct=lt-this.margin[0],xt=this.pdf.internal.pageSize.width-this.margin[1],_t=xt-this.margin[3],kt=Ge===1?0:Qe+(Ge-2)*ct;if(this.ctx.clip_path.length!==0){var Et=this.path;we=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(we,this.posX+this.margin[3],-1*kt+Je),W.call(this,"fill",!0),this.path=Et}var pt=w([JSON.parse(JSON.stringify(Ke))],this.posX+this.margin[3],-kt+Je+this.ctx.prevPageLastElemOffset)[0];_.scale>=.01&&(Pe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Pe*_.scale),Re=this.lineWidth,this.lineWidth=Re*_.scale);var jt=this.autoPaging!=="text";if(jt||pt.y+pt.h<=lt){if(jt||pt.y>=Je&&pt.x<=xt){var tt=jt?_.text:this.pdf.splitTextToSize(_.text,_.maxWidth||xt-pt.x)[0],Fr=w([JSON.parse(JSON.stringify(ze))],this.posX+this.margin[3],-kt+Je+this.ctx.prevPageLastElemOffset)[0],Lt=jt&&(Ge>at||Ge<He)&&x.call(this);Lt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],_t,ct,null).clip().discardPath()),this.pdf.text(tt,Fr.x,Fr.y,{angle:_.angle,align:L,renderingMode:_.renderingMode}),Lt&&this.pdf.restoreGraphicsState()}}else pt.y<lt&&(this.ctx.prevPageLastElemOffset+=lt-pt.y);_.scale>=.01&&(this.pdf.setFontSize(Pe),this.lineWidth=Re)}else _.scale>=.01&&(Pe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Pe*_.scale),Re=this.lineWidth,this.lineWidth=Re*_.scale),this.pdf.text(_.text,ce.x+this.posX,ce.y+this.posY,{angle:_.angle,align:L,renderingMode:_.renderingMode,maxWidth:_.maxWidth}),_.scale>=.01&&(this.pdf.setFontSize(Pe),this.lineWidth=Re)},B=function(_,L,P,O){P=P||0,O=O||0,this.pdf.internal.out(t(_+P)+" "+n(L+O)+" l")},M=function(_,L,P){return this.pdf.lines(_,L,P,null,null)},le=function(_,L,P,O,X,ce,fe,he){this.pdf.internal.out([r(a(P+_)),r(i(O+L)),r(a(X+_)),r(i(ce+L)),r(a(fe+_)),r(i(he+L)),"c"].join(" "))},J=function(_,L,P,O){for(var X=2*Math.PI,ce=Math.PI/2;L>P;)L-=X;var fe=Math.abs(P-L);fe<X&&O&&(fe=X-fe);for(var he=[],we=O?-1:1,Pe=L;fe>1e-5;){var Re=Pe+we*Math.min(fe,ce);he.push(z.call(this,_,Pe,Re)),fe-=Math.abs(Re-Pe),Pe=Re}return he},z=function(_,L,P){var O=(P-L)/2,X=_*Math.cos(O),ce=_*Math.sin(O),fe=X,he=-ce,we=fe*fe+he*he,Pe=we+fe*X+he*ce,Re=4/3*(Math.sqrt(2*we*Pe)-Pe)/(fe*ce-he*X),ze=fe-Re*he,Ke=he+Re*fe,ke=ze,oe=-Ke,Me=O+L,at=Math.cos(Me),He=Math.sin(Me);return{x1:_*Math.cos(L),y1:_*Math.sin(L),x2:ze*at-Ke*He,y2:ze*He+Ke*at,x3:ke*at-oe*He,y3:ke*He+oe*at,x4:_*Math.cos(P),y4:_*Math.sin(P)}},ae=function(_){return 180*_/Math.PI},te=function(_,L,P,O,X,ce){var fe=_+.5*(P-_),he=L+.5*(O-L),we=X+.5*(P-X),Pe=ce+.5*(O-ce),Re=Math.min(_,X,fe,we),ze=Math.max(_,X,fe,we),Ke=Math.min(L,ce,he,Pe),ke=Math.max(L,ce,he,Pe);return new l(Re,Ke,ze-Re,ke-Ke)},de=function(_,L,P,O,X,ce,fe,he){var we,Pe,Re,ze,Ke,ke,oe,Me,at,He,Ge,Je,Qe,lt,ct=P-_,xt=O-L,_t=X-P,kt=ce-O,Et=fe-X,pt=he-ce;for(Pe=0;Pe<41;Pe++)at=(oe=(Re=_+(we=Pe/40)*ct)+we*((Ke=P+we*_t)-Re))+we*(Ke+we*(X+we*Et-Ke)-oe),He=(Me=(ze=L+we*xt)+we*((ke=O+we*kt)-ze))+we*(ke+we*(ce+we*pt-ke)-Me),Pe==0?(Ge=at,Je=He,Qe=at,lt=He):(Ge=Math.min(Ge,at),Je=Math.min(Je,He),Qe=Math.max(Qe,at),lt=Math.max(lt,He));return new l(Math.round(Ge),Math.round(Je),Math.round(Qe-Ge),Math.round(lt-Je))},xe=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var _,L,P=(_=this.ctx.lineDash,L=this.ctx.lineDashOffset,JSON.stringify({lineDash:_,lineDashOffset:L}));this.prevLineDash!==P&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=P)}}})(ht.API),function(e){var r=function(i){var o,l,c,h,u,g,m,d,y,x;for(l=[],c=0,h=(i+=o="\0\0\0\0".slice(i.length%4||4)).length;h>c;c+=4)(u=(i.charCodeAt(c)<<24)+(i.charCodeAt(c+1)<<16)+(i.charCodeAt(c+2)<<8)+i.charCodeAt(c+3))!==0?(g=(u=((u=((u=((u=(u-(x=u%85))/85)-(y=u%85))/85)-(d=u%85))/85)-(m=u%85))/85)%85,l.push(g+33,m+33,d+33,y+33,x+33)):l.push(122);return function(b,N){for(var w=N;w>0;w--)b.pop()}(l,o.length),String.fromCharCode.apply(String,l)+"~>"},t=function(i){var o,l,c,h,u,g=String,m="length",d=255,y="charCodeAt",x="slice",b="replace";for(i[x](-2),i=i[x](0,-2)[b](/\s/g,"")[b]("z","!!!!!"),c=[],h=0,u=(i+=o="uuuuu"[x](i[m]%5||5))[m];u>h;h+=5)l=52200625*(i[y](h)-33)+614125*(i[y](h+1)-33)+7225*(i[y](h+2)-33)+85*(i[y](h+3)-33)+(i[y](h+4)-33),c.push(d&l>>24,d&l>>16,d&l>>8,d&l);return function(N,w){for(var A=w;A>0;A--)N.pop()}(c,o[m]),g.fromCharCode.apply(g,c)},n=function(i){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),o.test(i)===!1)return"";for(var l="",c=0;c<i.length;c+=2)l+=String.fromCharCode("0x"+(i[c]+i[c+1]));return l},a=function(i){for(var o=new Uint8Array(i.length),l=i.length;l--;)o[l]=i.charCodeAt(l);return i=(o=C0(o)).reduce(function(c,h){return c+String.fromCharCode(h)},"")};e.processDataByFilters=function(i,o){var l=0,c=i||"",h=[];for(typeof(o=o||[])=="string"&&(o=[o]),l=0;l<o.length;l+=1)switch(o[l]){case"ASCII85Decode":case"/ASCII85Decode":c=t(c),h.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=r(c),h.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=n(c),h.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=c.split("").map(function(u){return("0"+u.charCodeAt().toString(16)).slice(-2)}).join("")+">",h.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=a(c),h.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[l]+'" is not implemented')}return{data:c,reverseChain:h.reverse().join(" ")}}}(ht.API),function(e){e.loadFile=function(r,t,n){return function(a,i,o){i=i!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,h,u){var g=new XMLHttpRequest,m=0,d=function(y){var x=y.length,b=[],N=String.fromCharCode;for(m=0;m<x;m+=1)b.push(N(255&y.charCodeAt(m)));return b.join("")};if(g.open("GET",c,!h),g.overrideMimeType("text/plain; charset=x-user-defined"),h===!1&&(g.onload=function(){g.status===200?u(d(this.responseText)):u(void 0)}),g.send(null),h&&g.status===200)return d(g.responseText)}(a,i,o)}catch{}return l}(r,t,n)},e.loadImageFile=e.loadFile}(ht.API),function(e){function r(){return(mt.html2canvas?Promise.resolve(mt.html2canvas):T0(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function t(){return(mt.DOMPurify?Promise.resolve(mt.DOMPurify):T0(()=>import("./purify.es-C_uT9hQ1.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var n=function(o){var l=tr(o);return l==="undefined"?"undefined":l==="string"||o instanceof String?"string":l==="number"||o instanceof Number?"number":l==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":l==="object"?"object":"unknown"},a=function(o,l){var c=document.createElement(o);for(var h in l.className&&(c.className=l.className),l.innerHTML&&l.dompurify&&(c.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)c.style[h]=l.style[h];return c},i=function o(l){var c=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),h=o.convert(Promise.resolve(),c);return h=(h=h.setProgress(1,o,1,[o])).set(l)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(o,l){return o.__proto__=l||i.prototype,o},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(o,l){return this.then(function(){switch(l=l||function(c){switch(n(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(o)){case"string":return this.then(t).then(function(c){return this.set({src:a("div",{innerHTML:o,dompurify:c})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},i.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=function c(h,u){for(var g=h.nodeType===3?document.createTextNode(h.nodeValue):h.cloneNode(!1),m=h.firstChild;m;m=m.nextSibling)u!==!0&&m.nodeType===1&&m.nodeName==="SCRIPT"||g.appendChild(c(m,u));return h.nodeType===1&&(h.nodeName==="CANVAS"?(g.width=h.width,g.height=h.height,g.getContext("2d").drawImage(h,0,0)):h.nodeName!=="TEXTAREA"&&h.nodeName!=="SELECT"||(g.value=h.value),g.addEventListener("load",function(){g.scrollTop=h.scrollTop,g.scrollLeft=h.scrollLeft},!0)),g}(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(r).then(function(l){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,l(this.prop.container,c)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(r).then(function(l){var c=this.opt.jsPDF,h=this.opt.fontFaces,u=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,g=Object.assign({async:!0,allowTaint:!0,scale:u,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete g.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=h,h)for(var m=0;m<h.length;++m){var d=h[m],y=d.src.find(function(x){return x.format==="truetype"});y&&c.addFont(y.url,d.ref.name,d.ref.style)}return g.windowHeight=g.windowHeight||0,g.windowHeight=g.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):g.windowHeight,c.context2d.save(!0),l(this.prop.container,g)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(o,l,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(o,l):this.outputPdf(o,l)},i.prototype.outputPdf=function(o,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,l)})},i.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},i.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(o){if(n(o)!=="object")return this;var l=Object.keys(o||{}).map(function(c){if(c in i.template.prop)return function(){this.prop[c]=o[c]};switch(c){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[c]=o[c]}}},this);return this.then(function(){return this.thenList(l)})},i.prototype.get=function(o,l){return this.then(function(){var c=o in i.template.prop?this.prop[o]:this.opt[o];return l?l(c):c})},i.prototype.setMargin=function(o){return this.then(function(){switch(n(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},i.prototype.setPageSize=function(o){function l(c,h){return Math.floor(c*h/72*96)}return this.then(function(){(o=o||ht.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:l(o.inner.width,o.k),height:l(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},i.prototype.setProgress=function(o,l,c,h){return o!=null&&(this.progress.val=o),l!=null&&(this.progress.state=l),c!=null&&(this.progress.n=c),h!=null&&(this.progress.stack=h),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(o,l,c,h){return this.setProgress(o?this.progress.val+o:null,l||null,c?this.progress.n+c:null,h?this.progress.stack.concat(h):null)},i.prototype.then=function(o,l){var c=this;return this.thenCore(o,l,function(h,u){return c.updateProgress(null,null,1,[h]),Promise.prototype.then.call(this,function(g){return c.updateProgress(null,h),g}).then(h,u).then(function(g){return c.updateProgress(1),g})})},i.prototype.thenCore=function(o,l,c){c=c||Promise.prototype.then,o&&(o=o.bind(this)),l&&(l=l.bind(this));var h=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:i.convert(Object.assign({},this),Promise.prototype),u=c.call(h,o,l);return i.convert(u,this.__proto__)},i.prototype.thenExternal=function(o,l){return Promise.prototype.then.call(this,o,l)},i.prototype.thenList=function(o){var l=this;return o.forEach(function(c){l=l.thenCore(c)}),l},i.prototype.catch=function(o){o&&(o=o.bind(this));var l=Promise.prototype.catch.call(this,o);return i.convert(l,this)},i.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},i.prototype.error=function(o){return this.then(function(){throw new Error(o)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,ht.getPageSize=function(o,l,c){if(tr(o)==="object"){var h=o;o=h.orientation,l=h.unit||l,c=h.format||c}l=l||"mm",c=c||"a4",o=(""+(o||"P")).toLowerCase();var u,g=(""+c).toLowerCase(),m={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":u=1;break;case"mm":u=72/25.4;break;case"cm":u=72/2.54;break;case"in":u=72;break;case"px":u=.75;break;case"pc":case"em":u=12;break;case"ex":u=6;break;default:throw"Invalid unit: "+l}var d,y=0,x=0;if(m.hasOwnProperty(g))y=m[g][1]/u,x=m[g][0]/u;else try{y=c[1],x=c[0]}catch{throw new Error("Invalid format: "+c)}if(o==="p"||o==="portrait")o="p",x>y&&(d=x,x=y,y=d);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",y>x&&(d=x,x=y,y=d)}return{width:x,height:y,unit:l,k:u,orientation:o}},e.html=function(o,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(M0):null;var c=new i(l);return l.worker?c:c.from(o).doCallback()}}(ht.API),ht.API.addJS=function(e){return oh=e,this.internal.events.subscribe("postPutResources",function(){Rl=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Rl+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),sh=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+oh+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Rl!==void 0&&sh!==void 0&&this.internal.out("/Names <</JavaScript "+Rl+" 0 R>>")}),this},function(e){var r;e.events.push(["postPutResources",function(){var t=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=t.outline.render().split(/\r\n/),i=0;i<a.length;i++){var o=a[i],l=n.exec(o);if(l!=null){var c=l[1];t.internal.newObjectDeferredBegin(c,!1)}t.internal.write(o)}if(this.outline.createNamedDestinations){var h=this.internal.pages.length,u=[];for(i=0;i<h;i++){var g=t.internal.newObject();u.push(g);var m=t.internal.getPageInfo(i+1);t.internal.write("<< /D["+m.objId+" 0 R /XYZ null null null]>> endobj")}var d=t.internal.newObject();for(t.internal.write("<< /Names [ "),i=0;i<u.length;i++)t.internal.write("(page_"+(i+1)+")"+u[i]+" 0 R");t.internal.write(" ] >>","endobj"),r=t.internal.newObject(),t.internal.write("<< /Dests "+d+" 0 R"),t.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+r+" 0 R"))}]),e.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(n,a,i){var o={title:a,options:i,children:[]};return n==null&&(n=this.root),n.children.push(o),o},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(n){n.id=t.internal.newObjectDeferred();for(var a=0;a<n.children.length;a++)this.genIds_r(n.children[a])},t.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},t.outline.renderItems=function(n){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<n.children.length;i++){var o=n.children[i];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),i>0&&this.line("/Prev "+this.makeRef(n.children[i-1])),i<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[i+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=t.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var h=0;h<n.children.length;h++)this.renderItems(n.children[h])},t.outline.line=function(n){this.ctx.val+=n+`\r
`},t.outline.makeRef=function(n){return n.id+" 0 R"},t.outline.makeString=function(n){return"("+t.internal.pdfEscape(n)+")"},t.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(n,a){for(var i=0;i<a.children.length;i++)n.count++,this.count_r(n,a.children[i]);return n.count}}])}(ht.API),function(e){var r=[192,193,194,195,196,197,198,199];e.processJPEG=function(t,n,a,i,o,l){var c,h=this.decode.DCT_DECODE,u=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=o||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,(c=function(g){for(var m,d=256*g.charCodeAt(4)+g.charCodeAt(5),y=g.length,x={width:0,height:0,numcomponents:1},b=4;b<y;b+=2){if(b+=d,r.indexOf(g.charCodeAt(b+1))!==-1){m=256*g.charCodeAt(b+5)+g.charCodeAt(b+6),x={width:256*g.charCodeAt(b+7)+g.charCodeAt(b+8),height:m,numcomponents:g.charCodeAt(b+9)};break}d=256*g.charCodeAt(b+2)+g.charCodeAt(b+3)}return x}(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t)).numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}u={data:t,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:h,index:n,alias:a}}return u}}(ht.API);var vs,Ml,lh,ch,fh,Lp=function(){var e,r,t;function n(i){var o,l,c,h,u,g,m,d,y,x,b,N,w,A;for(this.data=i,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},g=null;;){switch(o=this.readUInt32(),y=(function(){var E,W;for(W=[],E=0;E<4;++E)W.push(String.fromCharCode(this.data[this.pos++]));return W}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(o);break;case"fcTL":g&&this.animation.frames.push(g),this.pos+=4,g={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},u=this.readUInt16(),h=this.readUInt16()||100,g.delay=1e3*u/h,g.disposeOp=this.data[this.pos++],g.blendOp=this.data[this.pos++],g.data=[];break;case"IDAT":case"fdAT":for(y==="fdAT"&&(this.pos+=4,o-=4),i=(g!=null?g.data:void 0)||this.imgData,N=0;0<=o?N<o:N>o;0<=o?++N:--N)i.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(c=this.palette.length/3,this.transparency.indexed=this.read(o),this.transparency.indexed.length>c)throw new Error("More transparent colors than palette size");if((x=c-this.transparency.indexed.length)>0)for(w=0;0<=x?w<x:w>x;0<=x?++w:--w)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(o)[0];break;case 2:this.transparency.rgb=this.read(o)}break;case"tEXt":m=(b=this.read(o)).indexOf(0),d=String.fromCharCode.apply(String,b.slice(0,m)),this.text[d]=String.fromCharCode.apply(String,b.slice(m+1));break;case"IEND":return g&&this.animation.frames.push(g),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(A=this.colorType)===4||A===6,l=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*l,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=o}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(i){var o,l;for(l=[],o=0;0<=i?o<i:o>i;0<=i?++o:--o)l.push(this.data[this.pos++]);return l},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(i){var o=this.pixelBitlength/8,l=new Uint8Array(this.width*this.height*o),c=0,h=this;if(i==null&&(i=this.imgData),i.length===0)return new Uint8Array(0);function u(g,m,d,y){var x,b,N,w,A,E,W,V,F,C,R,G,j,T,B,M,le,J,z,ae,te,de=Math.ceil((h.width-g)/d),xe=Math.ceil((h.height-m)/y),_=h.width==de&&h.height==xe;for(T=o*de,G=_?l:new Uint8Array(T*xe),E=i.length,j=0,b=0;j<xe&&c<E;){switch(i[c++]){case 0:for(w=le=0;le<T;w=le+=1)G[b++]=i[c++];break;case 1:for(w=J=0;J<T;w=J+=1)x=i[c++],A=w<o?0:G[b-o],G[b++]=(x+A)%256;break;case 2:for(w=z=0;z<T;w=z+=1)x=i[c++],N=(w-w%o)/o,B=j&&G[(j-1)*T+N*o+w%o],G[b++]=(B+x)%256;break;case 3:for(w=ae=0;ae<T;w=ae+=1)x=i[c++],N=(w-w%o)/o,A=w<o?0:G[b-o],B=j&&G[(j-1)*T+N*o+w%o],G[b++]=(x+Math.floor((A+B)/2))%256;break;case 4:for(w=te=0;te<T;w=te+=1)x=i[c++],N=(w-w%o)/o,A=w<o?0:G[b-o],j===0?B=M=0:(B=G[(j-1)*T+N*o+w%o],M=N&&G[(j-1)*T+(N-1)*o+w%o]),W=A+B-M,V=Math.abs(W-A),C=Math.abs(W-B),R=Math.abs(W-M),F=V<=C&&V<=R?A:C<=R?B:M,G[b++]=(x+F)%256;break;default:throw new Error("Invalid filter algorithm: "+i[c-1])}if(!_){var L=((m+j*y)*h.width+g)*o,P=j*T;for(w=0;w<de;w+=1){for(var O=0;O<o;O+=1)l[L++]=G[P++];L+=(d-1)*o}}j++}}return i=lp(i),h.interlaceMethod==1?(u(0,0,8,8),u(4,0,8,8),u(0,4,4,8),u(2,0,4,4),u(0,2,2,4),u(1,0,2,2),u(0,1,1,2)):u(0,0,1,1),l},n.prototype.decodePalette=function(){var i,o,l,c,h,u,g,m,d;for(l=this.palette,u=this.transparency.indexed||[],h=new Uint8Array((u.length||0)+l.length),c=0,i=0,o=g=0,m=l.length;g<m;o=g+=3)h[c++]=l[o],h[c++]=l[o+1],h[c++]=l[o+2],h[c++]=(d=u[i++])!=null?d:255;return h},n.prototype.copyToImageData=function(i,o){var l,c,h,u,g,m,d,y,x,b,N;if(c=this.colors,x=null,l=this.hasAlphaChannel,this.palette.length&&(x=(N=this._decodedPalette)!=null?N:this._decodedPalette=this.decodePalette(),c=4,l=!0),y=(h=i.data||i).length,g=x||o,u=m=0,c===1)for(;u<y;)d=x?4*o[u/4]:m,b=g[d++],h[u++]=b,h[u++]=b,h[u++]=b,h[u++]=l?g[d++]:255,m=d;else for(;u<y;)d=x?4*o[u/4]:m,h[u++]=g[d++],h[u++]=g[d++],h[u++]=g[d++],h[u++]=l?g[d++]:255,m=d},n.prototype.decode=function(){var i;return i=new Uint8Array(this.width*this.height*4),this.copyToImageData(i,this.decodePixels()),i};var a=function(){if(Object.prototype.toString.call(mt)==="[object Window]"){try{r=mt.document.createElement("canvas"),t=r.getContext("2d")}catch{return!1}return!0}return!1};return a(),e=function(i){var o;if(a()===!0)return t.width=i.width,t.height=i.height,t.clearRect(0,0,i.width,i.height),t.putImageData(i,0,0),(o=new Image).src=r.toDataURL(),o;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(i){var o,l,c,h,u,g,m,d;if(this.animation){for(d=[],l=u=0,g=(m=this.animation.frames).length;u<g;l=++u)o=m[l],c=i.createImageData(o.width,o.height),h=this.decodePixels(new Uint8Array(o.data)),this.copyToImageData(c,h),o.imageData=c,d.push(o.image=e(c));return d}},n.prototype.renderFrame=function(i,o){var l,c,h;return l=(c=this.animation.frames)[o],h=c[o-1],o===0&&i.clearRect(0,0,this.width,this.height),(h!=null?h.disposeOp:void 0)===1?i.clearRect(h.xOffset,h.yOffset,h.width,h.height):(h!=null?h.disposeOp:void 0)===2&&i.putImageData(h.imageData,h.xOffset,h.yOffset),l.blendOp===0&&i.clearRect(l.xOffset,l.yOffset,l.width,l.height),i.drawImage(l.image,l.xOffset,l.yOffset)},n.prototype.animate=function(i){var o,l,c,h,u,g,m=this;return l=0,g=this.animation,h=g.numFrames,c=g.frames,u=g.numPlays,(o=function(){var d,y;if(d=l++%h,y=c[d],m.renderFrame(i,d),h>1&&l/h<u)return m.animation._timeout=setTimeout(o,y.delay)})()},n.prototype.stopAnimation=function(){var i;return clearTimeout((i=this.animation)!=null?i._timeout:void 0)},n.prototype.render=function(i){var o,l;return i._png&&i._png.stopAnimation(),i._png=this,i.width=this.width,i.height=this.height,o=i.getContext("2d"),this.animation?(this.decodeFrames(o),this.animate(o)):(l=o.createImageData(this.width,this.height),this.copyToImageData(l,this.decodePixels()),o.putImageData(l,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function Cp(e){var r=0;if(e[r++]!==71||e[r++]!==73||e[r++]!==70||e[r++]!==56||(e[r++]+1&253)!=56||e[r++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=e[r++]|e[r++]<<8,n=e[r++]|e[r++]<<8,a=e[r++],i=a>>7,o=1<<(7&a)+1;e[r++],e[r++];var l=null,c=null;i&&(l=r,c=o,r+=3*o);var h=!0,u=[],g=0,m=null,d=0,y=null;for(this.width=t,this.height=n;h&&r<e.length;)switch(e[r++]){case 33:switch(e[r++]){case 255:if(e[r]!==11||e[r+1]==78&&e[r+2]==69&&e[r+3]==84&&e[r+4]==83&&e[r+5]==67&&e[r+6]==65&&e[r+7]==80&&e[r+8]==69&&e[r+9]==50&&e[r+10]==46&&e[r+11]==48&&e[r+12]==3&&e[r+13]==1&&e[r+16]==0)r+=14,y=e[r++]|e[r++]<<8,r++;else for(r+=12;;){if(!((j=e[r++])>=0))throw Error("Invalid block size");if(j===0)break;r+=j}break;case 249:if(e[r++]!==4||e[r+4]!==0)throw new Error("Invalid graphics extension block.");var x=e[r++];g=e[r++]|e[r++]<<8,m=e[r++],!(1&x)&&(m=null),d=x>>2&7,r++;break;case 254:for(;;){if(!((j=e[r++])>=0))throw Error("Invalid block size");if(j===0)break;r+=j}break;default:throw new Error("Unknown graphic control label: 0x"+e[r-1].toString(16))}break;case 44:var b=e[r++]|e[r++]<<8,N=e[r++]|e[r++]<<8,w=e[r++]|e[r++]<<8,A=e[r++]|e[r++]<<8,E=e[r++],W=E>>6&1,V=1<<(7&E)+1,F=l,C=c,R=!1;E>>7&&(R=!0,F=r,C=V,r+=3*V);var G=r;for(r++;;){var j;if(!((j=e[r++])>=0))throw Error("Invalid block size");if(j===0)break;r+=j}u.push({x:b,y:N,width:w,height:A,has_local_palette:R,palette_offset:F,palette_size:C,data_offset:G,data_length:r-G,transparent_index:m,interlaced:!!W,delay:g,disposal:d});break;case 59:h=!1;break;default:throw new Error("Unknown gif block: 0x"+e[r-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return y},this.frameInfo=function(T){if(T<0||T>=u.length)throw new Error("Frame index out of range.");return u[T]},this.decodeAndBlitFrameBGRA=function(T,B){var M=this.frameInfo(T),le=M.width*M.height,J=new Uint8Array(le);hh(e,M.data_offset,J,le);var z=M.palette_offset,ae=M.transparent_index;ae===null&&(ae=256);var te=M.width,de=t-te,xe=te,_=4*(M.y*t+M.x),L=4*((M.y+M.height)*t+M.x),P=_,O=4*de;M.interlaced===!0&&(O+=4*t*7);for(var X=8,ce=0,fe=J.length;ce<fe;++ce){var he=J[ce];if(xe===0&&(xe=te,(P+=O)>=L&&(O=4*de+4*t*(X-1),P=_+(te+de)*(X<<1),X>>=1)),he===ae)P+=4;else{var we=e[z+3*he],Pe=e[z+3*he+1],Re=e[z+3*he+2];B[P++]=Re,B[P++]=Pe,B[P++]=we,B[P++]=255}--xe}},this.decodeAndBlitFrameRGBA=function(T,B){var M=this.frameInfo(T),le=M.width*M.height,J=new Uint8Array(le);hh(e,M.data_offset,J,le);var z=M.palette_offset,ae=M.transparent_index;ae===null&&(ae=256);var te=M.width,de=t-te,xe=te,_=4*(M.y*t+M.x),L=4*((M.y+M.height)*t+M.x),P=_,O=4*de;M.interlaced===!0&&(O+=4*t*7);for(var X=8,ce=0,fe=J.length;ce<fe;++ce){var he=J[ce];if(xe===0&&(xe=te,(P+=O)>=L&&(O=4*de+4*t*(X-1),P=_+(te+de)*(X<<1),X>>=1)),he===ae)P+=4;else{var we=e[z+3*he],Pe=e[z+3*he+1],Re=e[z+3*he+2];B[P++]=we,B[P++]=Pe,B[P++]=Re,B[P++]=255}--xe}}}function hh(e,r,t,n){for(var a=e[r++],i=1<<a,o=i+1,l=o+1,c=a+1,h=(1<<c)-1,u=0,g=0,m=0,d=e[r++],y=new Int32Array(4096),x=null;;){for(;u<16&&d!==0;)g|=e[r++]<<u,u+=8,d===1?d=e[r++]:--d;if(u<c)break;var b=g&h;if(g>>=c,u-=c,b!==i){if(b===o)break;for(var N=b<l?b:x,w=0,A=N;A>i;)A=y[A]>>8,++w;var E=A;if(m+w+(N!==b?1:0)>n)return void er.log("Warning, gif stream longer than expected.");t[m++]=E;var W=m+=w;for(N!==b&&(t[m++]=E),A=N;w--;)A=y[A],t[--W]=255&A,A>>=8;x!==null&&l<4096&&(y[l++]=x<<8|E,l>=h+1&&c<12&&(++c,h=h<<1|1)),x=b}else l=o+1,h=(1<<(c=a+1))-1,x=null}return m!==n&&er.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function p0(e){var r,t,n,a,i,o=Math.floor,l=new Array(64),c=new Array(64),h=new Array(64),u=new Array(64),g=new Array(65535),m=new Array(65535),d=new Array(64),y=new Array(64),x=[],b=0,N=7,w=new Array(64),A=new Array(64),E=new Array(64),W=new Array(256),V=new Array(2048),F=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],C=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],R=[0,1,2,3,4,5,6,7,8,9,10,11],G=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],j=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],T=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],B=[0,1,2,3,4,5,6,7,8,9,10,11],M=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],le=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function J(_,L){for(var P=0,O=0,X=new Array,ce=1;ce<=16;ce++){for(var fe=1;fe<=_[ce];fe++)X[L[O]]=[],X[L[O]][0]=P,X[L[O]][1]=ce,O++,P++;P*=2}return X}function z(_){for(var L=_[0],P=_[1]-1;P>=0;)L&1<<P&&(b|=1<<N),P--,--N<0&&(b==255?(ae(255),ae(0)):ae(b),N=7,b=0)}function ae(_){x.push(_)}function te(_){ae(_>>8&255),ae(255&_)}function de(_,L,P,O,X){for(var ce,fe=X[0],he=X[240],we=function(He,Ge){var Je,Qe,lt,ct,xt,_t,kt,Et,pt,jt,tt=0;for(pt=0;pt<8;++pt){Je=He[tt],Qe=He[tt+1],lt=He[tt+2],ct=He[tt+3],xt=He[tt+4],_t=He[tt+5],kt=He[tt+6];var Fr=Je+(Et=He[tt+7]),Lt=Je-Et,dn=Qe+kt,Ht=Qe-kt,rr=lt+_t,Rn=lt-_t,Ot=ct+xt,ma=ct-xt,ir=Fr+Ot,_n=Fr-Ot,Jn=dn+rr,Zt=dn-rr;He[tt]=ir+Jn,He[tt+4]=ir-Jn;var vt=.707106781*(Zt+_n);He[tt+2]=_n+vt,He[tt+6]=_n-vt;var Dt=.382683433*((ir=ma+Rn)-(Zt=Ht+Lt)),Ea=.5411961*ir+Dt,Lr=1.306562965*Zt+Dt,Mn=.707106781*(Jn=Rn+Ht),Bn=Lt+Mn,ut=Lt-Mn;He[tt+5]=ut+Ea,He[tt+3]=ut-Ea,He[tt+1]=Bn+Lr,He[tt+7]=Bn-Lr,tt+=8}for(tt=0,pt=0;pt<8;++pt){Je=He[tt],Qe=He[tt+8],lt=He[tt+16],ct=He[tt+24],xt=He[tt+32],_t=He[tt+40],kt=He[tt+48];var An=Je+(Et=He[tt+56]),pn=Je-Et,Kr=Qe+kt,gr=Qe-kt,fr=lt+_t,H=lt-_t,ne=ct+xt,Z=ct-xt,Q=An+ne,re=An-ne,ie=Kr+fr,Ne=Kr-fr;He[tt]=Q+ie,He[tt+32]=Q-ie;var Ee=.707106781*(Ne+re);He[tt+16]=re+Ee,He[tt+48]=re-Ee;var be=.382683433*((Q=Z+H)-(Ne=gr+pn)),Ae=.5411961*Q+be,je=1.306562965*Ne+be,qe=.707106781*(ie=H+gr),$e=pn+qe,nt=pn-qe;He[tt+40]=nt+Ae,He[tt+24]=nt-Ae,He[tt+8]=$e+je,He[tt+56]=$e-je,tt++}for(pt=0;pt<64;++pt)jt=He[pt]*Ge[pt],d[pt]=jt>0?jt+.5|0:jt-.5|0;return d}(_,L),Pe=0;Pe<64;++Pe)y[F[Pe]]=we[Pe];var Re=y[0]-P;P=y[0],Re==0?z(O[0]):(z(O[m[ce=32767+Re]]),z(g[ce]));for(var ze=63;ze>0&&y[ze]==0;)ze--;if(ze==0)return z(fe),P;for(var Ke,ke=1;ke<=ze;){for(var oe=ke;y[ke]==0&&ke<=ze;)++ke;var Me=ke-oe;if(Me>=16){Ke=Me>>4;for(var at=1;at<=Ke;++at)z(he);Me&=15}ce=32767+y[ke],z(X[(Me<<4)+m[ce]]),z(g[ce]),ke++}return ze!=63&&z(fe),P}function xe(_){_=Math.min(Math.max(_,1),100),i!=_&&(function(L){for(var P=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],O=0;O<64;O++){var X=o((P[O]*L+50)/100);X=Math.min(Math.max(X,1),255),l[F[O]]=X}for(var ce=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],fe=0;fe<64;fe++){var he=o((ce[fe]*L+50)/100);he=Math.min(Math.max(he,1),255),c[F[fe]]=he}for(var we=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Pe=0,Re=0;Re<8;Re++)for(var ze=0;ze<8;ze++)h[Pe]=1/(l[F[Pe]]*we[Re]*we[ze]*8),u[Pe]=1/(c[F[Pe]]*we[Re]*we[ze]*8),Pe++}(_<50?Math.floor(5e3/_):Math.floor(200-2*_)),i=_)}this.encode=function(_,L){L&&xe(L),x=new Array,b=0,N=7,te(65496),te(65504),te(16),ae(74),ae(70),ae(73),ae(70),ae(0),ae(1),ae(1),ae(0),te(1),te(1),ae(0),ae(0),function(){te(65499),te(132),ae(0);for(var Qe=0;Qe<64;Qe++)ae(l[Qe]);ae(1);for(var lt=0;lt<64;lt++)ae(c[lt])}(),function(Qe,lt){te(65472),te(17),ae(8),te(lt),te(Qe),ae(3),ae(1),ae(17),ae(0),ae(2),ae(17),ae(1),ae(3),ae(17),ae(1)}(_.width,_.height),function(){te(65476),te(418),ae(0);for(var Qe=0;Qe<16;Qe++)ae(C[Qe+1]);for(var lt=0;lt<=11;lt++)ae(R[lt]);ae(16);for(var ct=0;ct<16;ct++)ae(G[ct+1]);for(var xt=0;xt<=161;xt++)ae(j[xt]);ae(1);for(var _t=0;_t<16;_t++)ae(T[_t+1]);for(var kt=0;kt<=11;kt++)ae(B[kt]);ae(17);for(var Et=0;Et<16;Et++)ae(M[Et+1]);for(var pt=0;pt<=161;pt++)ae(le[pt])}(),te(65498),te(12),ae(3),ae(1),ae(0),ae(2),ae(17),ae(3),ae(17),ae(0),ae(63),ae(0);var P=0,O=0,X=0;b=0,N=7,this.encode.displayName="_encode_";for(var ce,fe,he,we,Pe,Re,ze,Ke,ke,oe=_.data,Me=_.width,at=_.height,He=4*Me,Ge=0;Ge<at;){for(ce=0;ce<He;){for(Pe=He*Ge+ce,ze=-1,Ke=0,ke=0;ke<64;ke++)Re=Pe+(Ke=ke>>3)*He+(ze=4*(7&ke)),Ge+Ke>=at&&(Re-=He*(Ge+1+Ke-at)),ce+ze>=He&&(Re-=ce+ze-He+4),fe=oe[Re++],he=oe[Re++],we=oe[Re++],w[ke]=(V[fe]+V[he+256>>0]+V[we+512>>0]>>16)-128,A[ke]=(V[fe+768>>0]+V[he+1024>>0]+V[we+1280>>0]>>16)-128,E[ke]=(V[fe+1280>>0]+V[he+1536>>0]+V[we+1792>>0]>>16)-128;P=de(w,h,P,r,n),O=de(A,u,O,t,a),X=de(E,u,X,t,a),ce+=32}Ge+=8}if(N>=0){var Je=[];Je[1]=N+1,Je[0]=(1<<N+1)-1,z(Je)}return te(65497),new Uint8Array(x)},e=e||50,function(){for(var _=String.fromCharCode,L=0;L<256;L++)W[L]=_(L)}(),r=J(C,R),t=J(T,B),n=J(G,j),a=J(M,le),function(){for(var _=1,L=2,P=1;P<=15;P++){for(var O=_;O<L;O++)m[32767+O]=P,g[32767+O]=[],g[32767+O][1]=P,g[32767+O][0]=O;for(var X=-(L-1);X<=-_;X++)m[32767+X]=P,g[32767+X]=[],g[32767+X][1]=P,g[32767+X][0]=L-1+X;_<<=1,L<<=1}}(),function(){for(var _=0;_<256;_++)V[_]=19595*_,V[_+256>>0]=38470*_,V[_+512>>0]=7471*_+32768,V[_+768>>0]=-11059*_,V[_+1024>>0]=-21709*_,V[_+1280>>0]=32768*_+8421375,V[_+1536>>0]=-27439*_,V[_+1792>>0]=-5329*_}(),xe(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function sa(e,r){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!r,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function uh(e){function r(C){if(!C)throw Error("assert :P")}function t(C,R,G){for(var j=0;4>j;j++)if(C[R+j]!=G.charCodeAt(j))return!0;return!1}function n(C,R,G,j,T){for(var B=0;B<T;B++)C[R+B]=G[j+B]}function a(C,R,G,j){for(var T=0;T<j;T++)C[R+T]=G}function i(C){return new Int32Array(C)}function o(C,R){for(var G=[],j=0;j<C;j++)G.push(new R);return G}function l(C,R){var G=[];return function j(T,B,M){for(var le=M[B],J=0;J<le&&(T.push(M.length>B+1?[]:new R),!(M.length<B+1));J++)j(T[J],B+1,M)}(G,0,C),G}var c=function(){var C=this;function R(f,p){for(var S=1<<p-1>>>0;f&S;)S>>>=1;return S?(f&S-1)+S:f}function G(f,p,S,k,I){r(!(k%S));do f[p+(k-=S)]=I;while(0<k)}function j(f,p,S,k,I){if(r(2328>=I),512>=I)var U=i(512);else if((U=i(I))==null)return 0;return function(q,Y,K,ee,pe,Se){var _e,ve,De=Y,Fe=1<<K,me=i(16),ge=i(16);for(r(pe!=0),r(ee!=null),r(q!=null),r(0<K),ve=0;ve<pe;++ve){if(15<ee[ve])return 0;++me[ee[ve]]}if(me[0]==pe)return 0;for(ge[1]=0,_e=1;15>_e;++_e){if(me[_e]>1<<_e)return 0;ge[_e+1]=ge[_e]+me[_e]}for(ve=0;ve<pe;++ve)_e=ee[ve],0<ee[ve]&&(Se[ge[_e]++]=ve);if(ge[15]==1)return(ee=new T).g=0,ee.value=Se[0],G(q,De,1,Fe,ee),Fe;var Oe,Ue=-1,Ie=Fe-1,st=0,Ze=1,dt=1,et=1<<K;for(ve=0,_e=1,pe=2;_e<=K;++_e,pe<<=1){if(Ze+=dt<<=1,0>(dt-=me[_e]))return 0;for(;0<me[_e];--me[_e])(ee=new T).g=_e,ee.value=Se[ve++],G(q,De+st,pe,et,ee),st=R(st,_e)}for(_e=K+1,pe=2;15>=_e;++_e,pe<<=1){if(Ze+=dt<<=1,0>(dt-=me[_e]))return 0;for(;0<me[_e];--me[_e]){if(ee=new T,(st&Ie)!=Ue){for(De+=et,Oe=1<<(Ue=_e)-K;15>Ue&&!(0>=(Oe-=me[Ue]));)++Ue,Oe<<=1;Fe+=et=1<<(Oe=Ue-K),q[Y+(Ue=st&Ie)].g=Oe+K,q[Y+Ue].value=De-Y-Ue}ee.g=_e-K,ee.value=Se[ve++],G(q,De+(st>>K),pe,et,ee),st=R(st,_e)}}return Ze!=2*ge[15]-1?0:Fe}(f,p,S,k,I,U)}function T(){this.value=this.g=0}function B(){this.value=this.g=0}function M(){this.G=o(5,T),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Wr,B)}function le(f,p,S,k){r(f!=null),r(p!=null),r(2147483648>k),f.Ca=254,f.I=0,f.b=-8,f.Ka=0,f.oa=p,f.pa=S,f.Jd=p,f.Yc=S+k,f.Zc=4<=k?S+k-4+1:S,ce(f)}function J(f,p){for(var S=0;0<p--;)S|=he(f,128)<<p;return S}function z(f,p){var S=J(f,p);return fe(f)?-S:S}function ae(f,p,S,k){var I,U=0;for(r(f!=null),r(p!=null),r(4294967288>k),f.Sb=k,f.Ra=0,f.u=0,f.h=0,4<k&&(k=4),I=0;I<k;++I)U+=p[S+I]<<8*I;f.Ra=U,f.bb=k,f.oa=p,f.pa=S}function te(f){for(;8<=f.u&&f.bb<f.Sb;)f.Ra>>>=8,f.Ra+=f.oa[f.pa+f.bb]<<os-8>>>0,++f.bb,f.u-=8;P(f)&&(f.h=1,f.u=0)}function de(f,p){if(r(0<=p),!f.h&&p<=ss){var S=L(f)&is[p];return f.u+=p,te(f),S}return f.h=1,f.u=0}function xe(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function _(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function L(f){return f.Ra>>>(f.u&os-1)>>>0}function P(f){return r(f.bb<=f.Sb),f.h||f.bb==f.Sb&&f.u>os}function O(f,p){f.u=p,f.h=P(f)}function X(f){f.u>=eo&&(r(f.u>=eo),te(f))}function ce(f){r(f!=null&&f.oa!=null),f.pa<f.Zc?(f.I=(f.oa[f.pa++]|f.I<<8)>>>0,f.b+=8):(r(f!=null&&f.oa!=null),f.pa<f.Yc?(f.b+=8,f.I=f.oa[f.pa++]|f.I<<8):f.Ka?f.b=0:(f.I<<=8,f.b+=8,f.Ka=1))}function fe(f){return J(f,1)}function he(f,p){var S=f.Ca;0>f.b&&ce(f);var k=f.b,I=S*p>>>8,U=(f.I>>>k>I)+0;for(U?(S-=I,f.I-=I+1<<k>>>0):S=I+1,k=S,I=0;256<=k;)I+=8,k>>=8;return k=7^I+gn[k],f.b-=k,f.Ca=(S<<k)-1,U}function we(f,p,S){f[p+0]=S>>24&255,f[p+1]=S>>16&255,f[p+2]=S>>8&255,f[p+3]=S>>0&255}function Pe(f,p){return f[p+0]<<0|f[p+1]<<8}function Re(f,p){return Pe(f,p)|f[p+2]<<16}function ze(f,p){return Pe(f,p)|Pe(f,p+2)<<16}function Ke(f,p){var S=1<<p;return r(f!=null),r(0<p),f.X=i(S),f.X==null?0:(f.Mb=32-p,f.Xa=p,1)}function ke(f,p){r(f!=null),r(p!=null),r(f.Xa==p.Xa),n(p.X,0,f.X,0,1<<p.Xa)}function oe(){this.X=[],this.Xa=this.Mb=0}function Me(f,p,S,k){r(S!=null),r(k!=null);var I=S[0],U=k[0];return I==0&&(I=(f*U+p/2)/p),U==0&&(U=(p*I+f/2)/f),0>=I||0>=U?0:(S[0]=I,k[0]=U,1)}function at(f,p){return f+(1<<p)-1>>>p}function He(f,p){return((4278255360&f)+(4278255360&p)>>>0&4278255360)+((16711935&f)+(16711935&p)>>>0&16711935)>>>0}function Ge(f,p){C[p]=function(S,k,I,U,q,Y,K){var ee;for(ee=0;ee<q;++ee){var pe=C[f](Y[K+ee-1],I,U+ee);Y[K+ee]=He(S[k+ee],pe)}}}function Je(){this.ud=this.hd=this.jd=0}function Qe(f,p){return((4278124286&(f^p))>>>1)+(f&p)>>>0}function lt(f){return 0<=f&&256>f?f:0>f?0:255<f?255:void 0}function ct(f,p){return lt(f+(f-p+.5>>1))}function xt(f,p,S){return Math.abs(p-S)-Math.abs(f-S)}function _t(f,p,S,k,I,U,q){for(k=U[q-1],S=0;S<I;++S)U[q+S]=k=He(f[p+S],k)}function kt(f,p,S,k,I){var U;for(U=0;U<S;++U){var q=f[p+U],Y=q>>8&255,K=16711935&(K=(K=16711935&q)+((Y<<16)+Y));k[I+U]=(4278255360&q)+K>>>0}}function Et(f,p){p.jd=f>>0&255,p.hd=f>>8&255,p.ud=f>>16&255}function pt(f,p,S,k,I,U){var q;for(q=0;q<k;++q){var Y=p[S+q],K=Y>>>8,ee=Y,pe=255&(pe=(pe=Y>>>16)+((f.jd<<24>>24)*(K<<24>>24)>>>5));ee=255&(ee=(ee=ee+((f.hd<<24>>24)*(K<<24>>24)>>>5))+((f.ud<<24>>24)*(pe<<24>>24)>>>5)),I[U+q]=(4278255360&Y)+(pe<<16)+ee}}function jt(f,p,S,k,I){C[p]=function(U,q,Y,K,ee,pe,Se,_e,ve){for(K=Se;K<_e;++K)for(Se=0;Se<ve;++Se)ee[pe++]=I(Y[k(U[q++])])},C[f]=function(U,q,Y,K,ee,pe,Se){var _e=8>>U.b,ve=U.Ea,De=U.K[0],Fe=U.w;if(8>_e)for(U=(1<<U.b)-1,Fe=(1<<_e)-1;q<Y;++q){var me,ge=0;for(me=0;me<ve;++me)me&U||(ge=k(K[ee++])),pe[Se++]=I(De[ge&Fe]),ge>>=_e}else C["VP8LMapColor"+S](K,ee,De,Fe,pe,Se,q,Y,ve)}}function tt(f,p,S,k,I){for(S=p+S;p<S;){var U=f[p++];k[I++]=U>>16&255,k[I++]=U>>8&255,k[I++]=U>>0&255}}function Fr(f,p,S,k,I){for(S=p+S;p<S;){var U=f[p++];k[I++]=U>>16&255,k[I++]=U>>8&255,k[I++]=U>>0&255,k[I++]=U>>24&255}}function Lt(f,p,S,k,I){for(S=p+S;p<S;){var U=(q=f[p++])>>16&240|q>>12&15,q=q>>0&240|q>>28&15;k[I++]=U,k[I++]=q}}function dn(f,p,S,k,I){for(S=p+S;p<S;){var U=(q=f[p++])>>16&248|q>>13&7,q=q>>5&224|q>>3&31;k[I++]=U,k[I++]=q}}function Ht(f,p,S,k,I){for(S=p+S;p<S;){var U=f[p++];k[I++]=U>>0&255,k[I++]=U>>8&255,k[I++]=U>>16&255}}function rr(f,p,S,k,I,U){if(U==0)for(S=p+S;p<S;)we(k,((U=f[p++])[0]>>24|U[1]>>8&65280|U[2]<<8&16711680|U[3]<<24)>>>0),I+=32;else n(k,I,f,p,S)}function Rn(f,p){C[p][0]=C[f+"0"],C[p][1]=C[f+"1"],C[p][2]=C[f+"2"],C[p][3]=C[f+"3"],C[p][4]=C[f+"4"],C[p][5]=C[f+"5"],C[p][6]=C[f+"6"],C[p][7]=C[f+"7"],C[p][8]=C[f+"8"],C[p][9]=C[f+"9"],C[p][10]=C[f+"10"],C[p][11]=C[f+"11"],C[p][12]=C[f+"12"],C[p][13]=C[f+"13"],C[p][14]=C[f+"0"],C[p][15]=C[f+"0"]}function Ot(f){return f==qc||f==zc||f==wl||f==Vc}function ma(){this.eb=[],this.size=this.A=this.fb=0}function ir(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function _n(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ma,this.f.kb=new ir,this.sd=null}function Jn(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Zt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function vt(f){return alert("todo:WebPSamplerProcessPlane"),f.T}function Dt(f,p){var S=f.T,k=p.ba.f.RGBA,I=k.eb,U=k.fb+f.ka*k.A,q=Vn[p.ba.S],Y=f.y,K=f.O,ee=f.f,pe=f.N,Se=f.ea,_e=f.W,ve=p.cc,De=p.dc,Fe=p.Mc,me=p.Nc,ge=f.ka,Oe=f.ka+f.T,Ue=f.U,Ie=Ue+1>>1;for(ge==0?q(Y,K,null,null,ee,pe,Se,_e,ee,pe,Se,_e,I,U,null,null,Ue):(q(p.ec,p.fc,Y,K,ve,De,Fe,me,ee,pe,Se,_e,I,U-k.A,I,U,Ue),++S);ge+2<Oe;ge+=2)ve=ee,De=pe,Fe=Se,me=_e,pe+=f.Rc,_e+=f.Rc,U+=2*k.A,q(Y,(K+=2*f.fa)-f.fa,Y,K,ve,De,Fe,me,ee,pe,Se,_e,I,U-k.A,I,U,Ue);return K+=f.fa,f.j+Oe<f.o?(n(p.ec,p.fc,Y,K,Ue),n(p.cc,p.dc,ee,pe,Ie),n(p.Mc,p.Nc,Se,_e,Ie),S--):1&Oe||q(Y,K,null,null,ee,pe,Se,_e,ee,pe,Se,_e,I,U+k.A,null,null,Ue),S}function Ea(f,p,S){var k=f.F,I=[f.J];if(k!=null){var U=f.U,q=p.ba.S,Y=q==yl||q==wl;p=p.ba.f.RGBA;var K=[0],ee=f.ka;K[0]=f.T,f.Kb&&(ee==0?--K[0]:(--ee,I[0]-=f.width),f.j+f.ka+f.T==f.o&&(K[0]=f.o-f.j-ee));var pe=p.eb;ee=p.fb+ee*p.A,f=ar(k,I[0],f.width,U,K,pe,ee+(Y?0:3),p.A),r(S==K),f&&Ot(q)&&qn(pe,ee,Y,U,K,p.A)}return 0}function Lr(f){var p=f.ma,S=p.ba.S,k=11>S,I=S==xl||S==vl||S==yl||S==Wc||S==12||Ot(S);if(p.memory=null,p.Ib=null,p.Jb=null,p.Nd=null,!Zs(p.Oa,f,I?11:12))return 0;if(I&&Ot(S)&&We(),f.da)alert("todo:use_scaling");else{if(k){if(p.Ib=vt,f.Kb){if(S=f.U+1>>1,p.memory=i(f.U+2*S),p.memory==null)return 0;p.ec=p.memory,p.fc=0,p.cc=p.ec,p.dc=p.fc+f.U,p.Mc=p.cc,p.Nc=p.dc+S,p.Ib=Dt,We()}}else alert("todo:EmitYUV");I&&(p.Jb=Ea,k&&ye())}if(k&&!Af){for(f=0;256>f;++f)C1[f]=89858*(f-128)+Nl>>bl,I1[f]=-22014*(f-128)+Nl,O1[f]=-45773*(f-128),P1[f]=113618*(f-128)+Nl>>bl;for(f=oo;f<Yc;++f)p=76283*(f-16)+Nl>>bl,D1[f-oo]=Tn(p,255),R1[f-oo]=Tn(p+8>>4,15);Af=1}return 1}function Mn(f){var p=f.ma,S=f.U,k=f.T;return r(!(1&f.ka)),0>=S||0>=k?0:(S=p.Ib(f,p),p.Jb!=null&&p.Jb(f,p,S),p.Dc+=S,1)}function Bn(f){f.ma.memory=null}function ut(f,p,S,k){return de(f,8)!=47?0:(p[0]=de(f,14)+1,S[0]=de(f,14)+1,k[0]=de(f,1),de(f,3)!=0?0:!f.h)}function An(f,p){if(4>f)return f+1;var S=f-2>>1;return(2+(1&f)<<S)+de(p,S)+1}function pn(f,p){return 120<p?p-120:1<=(S=((S=v1[p-1])>>4)*f+(8-(15&S)))?S:1;var S}function Kr(f,p,S){var k=L(S),I=f[p+=255&k].g-8;return 0<I&&(O(S,S.u+8),k=L(S),p+=f[p].value,p+=k&(1<<I)-1),O(S,S.u+f[p].g),f[p].value}function gr(f,p,S){return S.g+=f.g,S.value+=f.value<<p>>>0,r(8>=S.g),f.g}function fr(f,p,S){var k=f.xc;return r((p=k==0?0:f.vc[f.md*(S>>k)+(p>>k)])<f.Wb),f.Ya[p]}function H(f,p,S,k){var I=f.ab,U=f.c*p,q=f.C;p=q+p;var Y=S,K=k;for(k=f.Ta,S=f.Ua;0<I--;){var ee=f.gc[I],pe=q,Se=p,_e=Y,ve=K,De=(K=k,Y=S,ee.Ea);switch(r(pe<Se),r(Se<=ee.nc),ee.hc){case 2:fl(_e,ve,(Se-pe)*De,K,Y);break;case 0:var Fe=pe,me=Se,ge=K,Oe=Y,Ue=(et=ee).Ea;Fe==0&&(Uc(_e,ve,null,null,1,ge,Oe),_t(_e,ve+1,0,0,Ue-1,ge,Oe+1),ve+=Ue,Oe+=Ue,++Fe);for(var Ie=1<<et.b,st=Ie-1,Ze=at(Ue,et.b),dt=et.K,et=et.w+(Fe>>et.b)*Ze;Fe<me;){var Bt=dt,qt=et,It=1;for(to(_e,ve,ge,Oe-Ue,1,ge,Oe);It<Ue;){var Ft=(It&~st)+Ie;Ft>Ue&&(Ft=Ue),(0,Ka[Bt[qt++]>>8&15])(_e,ve+ +It,ge,Oe+It-Ue,Ft-It,ge,Oe+It),It=Ft}ve+=Ue,Oe+=Ue,++Fe&st||(et+=Ze)}Se!=ee.nc&&n(K,Y-De,K,Y+(Se-pe-1)*De,De);break;case 1:for(De=_e,me=ve,Ue=(_e=ee.Ea)-(Oe=_e&~(ge=(ve=1<<ee.b)-1)),Fe=at(_e,ee.b),Ie=ee.K,ee=ee.w+(pe>>ee.b)*Fe;pe<Se;){for(st=Ie,Ze=ee,dt=new Je,et=me+Oe,Bt=me+_e;me<et;)Et(st[Ze++],dt),ji(dt,De,me,ve,K,Y),me+=ve,Y+=ve;me<Bt&&(Et(st[Ze++],dt),ji(dt,De,me,Ue,K,Y),me+=Ue,Y+=Ue),++pe&ge||(ee+=Fe)}break;case 3:if(_e==K&&ve==Y&&0<ee.b){for(me=K,_e=De=Y+(Se-pe)*De-(Oe=(Se-pe)*at(ee.Ea,ee.b)),ve=K,ge=Y,Fe=[],Oe=(Ue=Oe)-1;0<=Oe;--Oe)Fe[Oe]=ve[ge+Oe];for(Oe=Ue-1;0<=Oe;--Oe)me[_e+Oe]=Fe[Oe];Un(ee,pe,Se,K,De,K,Y)}else Un(ee,pe,Se,_e,ve,K,Y)}Y=k,K=S}K!=S&&n(k,S,Y,K,U)}function ne(f,p){var S=f.V,k=f.Ba+f.c*f.C,I=p-f.C;if(r(p<=f.l.o),r(16>=I),0<I){var U=f.l,q=f.Ta,Y=f.Ua,K=U.width;if(H(f,I,S,k),I=Y=[Y],r((S=f.C)<(k=p)),r(U.v<U.va),k>U.o&&(k=U.o),S<U.j){var ee=U.j-S;S=U.j,I[0]+=ee*K}if(S>=k?S=0:(I[0]+=4*U.v,U.ka=S-U.j,U.U=U.va-U.v,U.T=k-S,S=1),S){if(Y=Y[0],11>(S=f.ca).S){var pe=S.f.RGBA,Se=(k=S.S,I=U.U,U=U.T,ee=pe.eb,pe.A),_e=U;for(pe=pe.fb+f.Ma*pe.A;0<_e--;){var ve=q,De=Y,Fe=I,me=ee,ge=pe;switch(k){case gl:xn(ve,De,Fe,me,ge);break;case xl:on(ve,De,Fe,me,ge);break;case qc:on(ve,De,Fe,me,ge),qn(me,ge,0,Fe,1,0);break;case gf:Oa(ve,De,Fe,me,ge);break;case vl:rr(ve,De,Fe,me,ge,1);break;case zc:rr(ve,De,Fe,me,ge,1),qn(me,ge,0,Fe,1,0);break;case yl:rr(ve,De,Fe,me,ge,0);break;case wl:rr(ve,De,Fe,me,ge,0),qn(me,ge,1,Fe,1,0);break;case Wc:Ja(ve,De,Fe,me,ge);break;case Vc:Ja(ve,De,Fe,me,ge),nr(me,ge,Fe,1,0);break;case xf:Pa(ve,De,Fe,me,ge);break;default:r(0)}Y+=K,pe+=Se}f.Ma+=U}else alert("todo:EmitRescaledRowsYUVA");r(f.Ma<=S.height)}}f.C=p,r(f.C<=f.i)}function Z(f){var p;if(0<f.ua)return 0;for(p=0;p<f.Wb;++p){var S=f.Ya[p].G,k=f.Ya[p].H;if(0<S[1][k[1]+0].g||0<S[2][k[2]+0].g||0<S[3][k[3]+0].g)return 0}return 1}function Q(f,p,S,k,I,U){if(f.Z!=0){var q=f.qd,Y=f.rd;for(r(ti[f.Z]!=null);p<S;++p)ti[f.Z](q,Y,k,I,k,I,U),q=k,Y=I,I+=U;f.qd=q,f.rd=Y}}function re(f,p){var S=f.l.ma,k=S.Z==0||S.Z==1?f.l.j:f.C;if(k=f.C<k?k:f.C,r(p<=f.l.o),p>k){var I=f.l.width,U=S.ca,q=S.tb+I*k,Y=f.V,K=f.Ba+f.c*k,ee=f.gc;r(f.ab==1),r(ee[0].hc==3),hl(ee[0],k,p,Y,K,U,q),Q(S,k,p,U,q,I)}f.C=f.Ma=p}function ie(f,p,S,k,I,U,q){var Y=f.$/k,K=f.$%k,ee=f.m,pe=f.s,Se=S+f.$,_e=Se;I=S+k*I;var ve=S+k*U,De=280+pe.ua,Fe=f.Pb?Y:16777216,me=0<pe.ua?pe.Wa:null,ge=pe.wc,Oe=Se<ve?fr(pe,K,Y):null;r(f.C<U),r(ve<=I);var Ue=!1;e:for(;;){for(;Ue||Se<ve;){var Ie=0;if(Y>=Fe){var st=Se-S;r((Fe=f).Pb),Fe.wd=Fe.m,Fe.xd=st,0<Fe.s.ua&&ke(Fe.s.Wa,Fe.s.vb),Fe=Y+w1}if(K&ge||(Oe=fr(pe,K,Y)),r(Oe!=null),Oe.Qb&&(p[Se]=Oe.qb,Ue=!0),!Ue)if(X(ee),Oe.jc){Ie=ee,st=p;var Ze=Se,dt=Oe.pd[L(Ie)&Wr-1];r(Oe.jc),256>dt.g?(O(Ie,Ie.u+dt.g),st[Ze]=dt.value,Ie=0):(O(Ie,Ie.u+dt.g-256),r(256<=dt.value),Ie=dt.value),Ie==0&&(Ue=!0)}else Ie=Kr(Oe.G[0],Oe.H[0],ee);if(ee.h)break;if(Ue||256>Ie){if(!Ue)if(Oe.nd)p[Se]=(Oe.qb|Ie<<8)>>>0;else{if(X(ee),Ue=Kr(Oe.G[1],Oe.H[1],ee),X(ee),st=Kr(Oe.G[2],Oe.H[2],ee),Ze=Kr(Oe.G[3],Oe.H[3],ee),ee.h)break;p[Se]=(Ze<<24|Ue<<16|Ie<<8|st)>>>0}if(Ue=!1,++Se,++K>=k&&(K=0,++Y,q!=null&&Y<=U&&!(Y%16)&&q(f,Y),me!=null))for(;_e<Se;)Ie=p[_e++],me.X[(506832829*Ie&4294967295)>>>me.Mb]=Ie}else if(280>Ie){if(Ie=An(Ie-256,ee),st=Kr(Oe.G[4],Oe.H[4],ee),X(ee),st=pn(k,st=An(st,ee)),ee.h)break;if(Se-S<st||I-Se<Ie)break e;for(Ze=0;Ze<Ie;++Ze)p[Se+Ze]=p[Se+Ze-st];for(Se+=Ie,K+=Ie;K>=k;)K-=k,++Y,q!=null&&Y<=U&&!(Y%16)&&q(f,Y);if(r(Se<=I),K&ge&&(Oe=fr(pe,K,Y)),me!=null)for(;_e<Se;)Ie=p[_e++],me.X[(506832829*Ie&4294967295)>>>me.Mb]=Ie}else{if(!(Ie<De))break e;for(Ue=Ie-280,r(me!=null);_e<Se;)Ie=p[_e++],me.X[(506832829*Ie&4294967295)>>>me.Mb]=Ie;Ie=Se,r(!(Ue>>>(st=me).Xa)),p[Ie]=st.X[Ue],Ue=!0}Ue||r(ee.h==P(ee))}if(f.Pb&&ee.h&&Se<I)r(f.m.h),f.a=5,f.m=f.wd,f.$=f.xd,0<f.s.ua&&ke(f.s.vb,f.s.Wa);else{if(ee.h)break e;q!=null&&q(f,Y>U?U:Y),f.a=0,f.$=Se-S}return 1}return f.a=3,0}function Ne(f){r(f!=null),f.vc=null,f.yc=null,f.Ya=null;var p=f.Wa;p!=null&&(p.X=null),f.vb=null,r(f!=null)}function Ee(){var f=new Bc;return f==null?null:(f.a=0,f.xb=wf,Rn("Predictor","VP8LPredictors"),Rn("Predictor","VP8LPredictors_C"),Rn("PredictorAdd","VP8LPredictorsAdd"),Rn("PredictorAdd","VP8LPredictorsAdd_C"),fl=kt,ji=pt,xn=tt,on=Fr,Ja=Lt,Pa=dn,Oa=Ht,C.VP8LMapColor32b=ls,C.VP8LMapColor8b=ul,f)}function be(f,p,S,k,I){var U=1,q=[f],Y=[p],K=k.m,ee=k.s,pe=null,Se=0;e:for(;;){if(S)for(;U&&de(K,1);){var _e=q,ve=Y,De=k,Fe=1,me=De.m,ge=De.gc[De.ab],Oe=de(me,2);if(De.Oc&1<<Oe)U=0;else{switch(De.Oc|=1<<Oe,ge.hc=Oe,ge.Ea=_e[0],ge.nc=ve[0],ge.K=[null],++De.ab,r(4>=De.ab),Oe){case 0:case 1:ge.b=de(me,3)+2,Fe=be(at(ge.Ea,ge.b),at(ge.nc,ge.b),0,De,ge.K),ge.K=ge.K[0];break;case 3:var Ue,Ie=de(me,8)+1,st=16<Ie?0:4<Ie?1:2<Ie?2:3;if(_e[0]=at(ge.Ea,st),ge.b=st,Ue=Fe=be(Ie,1,0,De,ge.K)){var Ze,dt=Ie,et=ge,Bt=1<<(8>>et.b),qt=i(Bt);if(qt==null)Ue=0;else{var It=et.K[0],Ft=et.w;for(qt[0]=et.K[0][0],Ze=1;Ze<1*dt;++Ze)qt[Ze]=He(It[Ft+Ze],qt[Ze-1]);for(;Ze<4*Bt;++Ze)qt[Ze]=0;et.K[0]=null,et.K[0]=qt,Ue=1}}Fe=Ue;break;case 2:break;default:r(0)}U=Fe}}if(q=q[0],Y=Y[0],U&&de(K,1)&&!(U=1<=(Se=de(K,4))&&11>=Se)){k.a=3;break e}var Qt;if(Qt=U)t:{var Kt,At,Ar,vn=k,jr=q,yn=Y,zt=Se,En=S,Fn=vn.m,Rr=vn.s,qr=[null],cn=1,Gn=0,ba=y1[zt];r:for(;;){if(En&&de(Fn,1)){var Mr=de(Fn,3)+2,Ma=at(jr,Mr),Li=at(yn,Mr),ds=Ma*Li;if(!be(Ma,Li,0,vn,qr))break r;for(qr=qr[0],Rr.xc=Mr,Kt=0;Kt<ds;++Kt){var ri=qr[Kt]>>8&65535;qr[Kt]=ri,ri>=cn&&(cn=ri+1)}}if(Fn.h)break r;for(At=0;5>At;++At){var ur=vf[At];!At&&0<zt&&(ur+=1<<zt),Gn<ur&&(Gn=ur)}var Xc=o(cn*ba,T),kf=cn,Ef=o(kf,M);if(Ef==null)var _l=null;else r(65536>=kf),_l=Ef;var lo=i(Gn);if(_l==null||lo==null||Xc==null){vn.a=1;break r}var Al=Xc;for(Kt=Ar=0;Kt<cn;++Kt){var aa=_l[Kt],ps=aa.G,ms=aa.H,Ff=0,jl=1,Lf=0;for(At=0;5>At;++At){ur=vf[At],ps[At]=Al,ms[At]=Ar,!At&&0<zt&&(ur+=1<<zt);a:{var Tl,Kc=ur,kl=vn,co=lo,U1=Al,H1=Ar,Jc=0,ni=kl.m,W1=de(ni,1);if(a(co,0,0,Kc),W1){var q1=de(ni,1)+1,z1=de(ni,1),Cf=de(ni,z1==0?1:8);co[Cf]=1,q1==2&&(co[Cf=de(ni,8)]=1);var El=1}else{var Pf=i(19),Of=de(ni,4)+4;if(19<Of){kl.a=3;var Fl=0;break a}for(Tl=0;Tl<Of;++Tl)Pf[x1[Tl]]=de(ni,3);var Zc=void 0,fo=void 0,If=kl,V1=Pf,Ll=Kc,Df=co,Qc=0,ai=If.m,Rf=8,Mf=o(128,T);n:for(;j(Mf,0,7,V1,19);){if(de(ai,1)){var G1=2+2*de(ai,3);if((Zc=2+de(ai,G1))>Ll)break n}else Zc=Ll;for(fo=0;fo<Ll&&Zc--;){X(ai);var Bf=Mf[0+(127&L(ai))];O(ai,ai.u+Bf.g);var gs=Bf.value;if(16>gs)Df[fo++]=gs,gs!=0&&(Rf=gs);else{var $1=gs==16,Uf=gs-16,Y1=m1[Uf],Hf=de(ai,p1[Uf])+Y1;if(fo+Hf>Ll)break n;for(var X1=$1?Rf:0;0<Hf--;)Df[fo++]=X1}}Qc=1;break n}Qc||(If.a=3),El=Qc}(El=El&&!ni.h)&&(Jc=j(U1,H1,8,co,Kc)),El&&Jc!=0?Fl=Jc:(kl.a=3,Fl=0)}if(Fl==0)break r;if(jl&&g1[At]==1&&(jl=Al[Ar].g==0),Ff+=Al[Ar].g,Ar+=Fl,3>=At){var ho,e0=lo[0];for(ho=1;ho<ur;++ho)lo[ho]>e0&&(e0=lo[ho]);Lf+=e0}}if(aa.nd=jl,aa.Qb=0,jl&&(aa.qb=(ps[3][ms[3]+0].value<<24|ps[1][ms[1]+0].value<<16|ps[2][ms[2]+0].value)>>>0,Ff==0&&256>ps[0][ms[0]+0].value&&(aa.Qb=1,aa.qb+=ps[0][ms[0]+0].value<<8)),aa.jc=!aa.Qb&&6>Lf,aa.jc){var Cl,Ba=aa;for(Cl=0;Cl<Wr;++Cl){var ii=Cl,si=Ba.pd[ii],Pl=Ba.G[0][Ba.H[0]+ii];256<=Pl.value?(si.g=Pl.g+256,si.value=Pl.value):(si.g=0,si.value=0,ii>>=gr(Pl,8,si),ii>>=gr(Ba.G[1][Ba.H[1]+ii],16,si),ii>>=gr(Ba.G[2][Ba.H[2]+ii],0,si),gr(Ba.G[3][Ba.H[3]+ii],24,si))}}}Rr.vc=qr,Rr.Wb=cn,Rr.Ya=_l,Rr.yc=Xc,Qt=1;break t}Qt=0}if(!(U=Qt)){k.a=3;break e}if(0<Se){if(ee.ua=1<<Se,!Ke(ee.Wa,Se)){k.a=1,U=0;break e}}else ee.ua=0;var t0=k,Wf=q,K1=Y,r0=t0.s,n0=r0.xc;if(t0.c=Wf,t0.i=K1,r0.md=at(Wf,n0),r0.wc=n0==0?-1:(1<<n0)-1,S){k.xb=T1;break e}if((pe=i(q*Y))==null){k.a=1,U=0;break e}U=(U=ie(k,pe,0,q,Y,Y,null))&&!K.h;break e}return U?(I!=null?I[0]=pe:(r(pe==null),r(S)),k.$=0,S||Ne(ee)):Ne(ee),U}function Ae(f,p){var S=f.c*f.i,k=S+p+16*p;return r(f.c<=p),f.V=i(k),f.V==null?(f.Ta=null,f.Ua=0,f.a=1,0):(f.Ta=f.V,f.Ua=f.Ba+S+p,1)}function je(f,p){var S=f.C,k=p-S,I=f.V,U=f.Ba+f.c*S;for(r(p<=f.l.o);0<k;){var q=16<k?16:k,Y=f.l.ma,K=f.l.width,ee=K*q,pe=Y.ca,Se=Y.tb+K*S,_e=f.Ta,ve=f.Ua;H(f,q,I,U),yr(_e,ve,pe,Se,ee),Q(Y,S,S+q,pe,Se,K),k-=q,I+=q*f.c,S+=q}r(S==p),f.C=f.Ma=p}function qe(){this.ub=this.yd=this.td=this.Rb=0}function $e(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function nt(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function Ve(){this.Yb=function(){var f=[];return function p(S,k,I){for(var U=I[k],q=0;q<U&&(S.push(I.length>k+1?[]:0),!(I.length<k+1));q++)p(S[q],k+1,I)}(f,0,[3,11]),f}()}function rt(){this.jb=i(3),this.Wc=l([4,8],Ve),this.Xc=l([4,17],Ve)}function gt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function Wt(){this.ld=this.La=this.dd=this.tc=0}function Xt(){this.Na=this.la=0}function Sr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Zn(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Fa(){this.uc=this.M=this.Nb=0,this.wa=Array(new Wt),this.Y=0,this.ya=Array(new Zn),this.aa=0,this.l=new xa}function ga(){this.y=i(16),this.f=i(8),this.ea=i(8)}function Qn(){this.cb=this.a=0,this.sc="",this.m=new xe,this.Od=new qe,this.Kc=new $e,this.ed=new gt,this.Qa=new nt,this.Ic=this.$c=this.Aa=0,this.D=new Fa,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,xe),this.ia=0,this.pb=o(4,Sr),this.Pa=new rt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new ga),this.Hd=0,this.rb=Array(new Xt),this.sb=0,this.wa=Array(new Wt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Zn),this.L=this.aa=0,this.gd=l([4,2],Wt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function xa(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function jn(){var f=new Qn;return f!=null&&(f.a=0,f.sc="OK",f.cb=0,f.Xb=0,so||(so=Xo)),f}function xr(f,p,S){return f.a==0&&(f.a=p,f.sc=S,f.cb=0),0}function $o(f,p,S){return 3<=S&&f[p+0]==157&&f[p+1]==1&&f[p+2]==42}function Yo(f,p){if(f==null)return 0;if(f.a=0,f.sc="OK",p==null)return xr(f,2,"null VP8Io passed to VP8GetHeaders()");var S=p.data,k=p.w,I=p.ha;if(4>I)return xr(f,7,"Truncated header.");var U=S[k+0]|S[k+1]<<8|S[k+2]<<16,q=f.Od;if(q.Rb=!(1&U),q.td=U>>1&7,q.yd=U>>4&1,q.ub=U>>5,3<q.td)return xr(f,3,"Incorrect keyframe parameters.");if(!q.yd)return xr(f,4,"Frame not displayable.");k+=3,I-=3;var Y=f.Kc;if(q.Rb){if(7>I)return xr(f,7,"cannot parse picture header");if(!$o(S,k,I))return xr(f,3,"Bad code word");Y.c=16383&(S[k+4]<<8|S[k+3]),Y.Td=S[k+4]>>6,Y.i=16383&(S[k+6]<<8|S[k+5]),Y.Ud=S[k+6]>>6,k+=7,I-=7,f.za=Y.c+15>>4,f.Ub=Y.i+15>>4,p.width=Y.c,p.height=Y.i,p.Da=0,p.j=0,p.v=0,p.va=p.width,p.o=p.height,p.da=0,p.ib=p.width,p.hb=p.height,p.U=p.width,p.T=p.height,a((U=f.Pa).jb,0,255,U.jb.length),r((U=f.Qa)!=null),U.Cb=0,U.Bb=0,U.Fb=1,a(U.Zb,0,0,U.Zb.length),a(U.Lb,0,0,U.Lb)}if(q.ub>I)return xr(f,7,"bad partition length");le(U=f.m,S,k,q.ub),k+=q.ub,I-=q.ub,q.Rb&&(Y.Ld=fe(U),Y.Kd=fe(U)),Y=f.Qa;var K,ee=f.Pa;if(r(U!=null),r(Y!=null),Y.Cb=fe(U),Y.Cb){if(Y.Bb=fe(U),fe(U)){for(Y.Fb=fe(U),K=0;4>K;++K)Y.Zb[K]=fe(U)?z(U,7):0;for(K=0;4>K;++K)Y.Lb[K]=fe(U)?z(U,6):0}if(Y.Bb)for(K=0;3>K;++K)ee.jb[K]=fe(U)?J(U,8):255}else Y.Bb=0;if(U.Ka)return xr(f,3,"cannot parse segment header");if((Y=f.ed).zd=fe(U),Y.Tb=J(U,6),Y.wb=J(U,3),Y.Pc=fe(U),Y.Pc&&fe(U)){for(ee=0;4>ee;++ee)fe(U)&&(Y.vd[ee]=z(U,6));for(ee=0;4>ee;++ee)fe(U)&&(Y.od[ee]=z(U,6))}if(f.L=Y.Tb==0?0:Y.zd?1:2,U.Ka)return xr(f,3,"cannot parse filter header");var pe=I;if(I=K=k,k=K+pe,Y=pe,f.Xb=(1<<J(f.m,2))-1,pe<3*(ee=f.Xb))S=7;else{for(K+=3*ee,Y-=3*ee,pe=0;pe<ee;++pe){var Se=S[I+0]|S[I+1]<<8|S[I+2]<<16;Se>Y&&(Se=Y),le(f.Jc[+pe],S,K,Se),K+=Se,Y-=Se,I+=3}le(f.Jc[+ee],S,K,Y),S=K<k?0:5}if(S!=0)return xr(f,S,"cannot parse partitions");for(S=J(K=f.m,7),I=fe(K)?z(K,4):0,k=fe(K)?z(K,4):0,Y=fe(K)?z(K,4):0,ee=fe(K)?z(K,4):0,K=fe(K)?z(K,4):0,pe=f.Qa,Se=0;4>Se;++Se){if(pe.Cb){var _e=pe.Zb[Se];pe.Fb||(_e+=S)}else{if(0<Se){f.pb[Se]=f.pb[0];continue}_e=S}var ve=f.pb[Se];ve.Sc[0]=Gc[Tn(_e+I,127)],ve.Sc[1]=$c[Tn(_e+0,127)],ve.Eb[0]=2*Gc[Tn(_e+k,127)],ve.Eb[1]=101581*$c[Tn(_e+Y,127)]>>16,8>ve.Eb[1]&&(ve.Eb[1]=8),ve.Qc[0]=Gc[Tn(_e+ee,117)],ve.Qc[1]=$c[Tn(_e+K,127)],ve.lc=_e+K}if(!q.Rb)return xr(f,4,"Not a key frame.");for(fe(U),q=f.Pa,S=0;4>S;++S){for(I=0;8>I;++I)for(k=0;3>k;++k)for(Y=0;11>Y;++Y)ee=he(U,A1[S][I][k][Y])?J(U,8):S1[S][I][k][Y],q.Wc[S][I].Yb[k][Y]=ee;for(I=0;17>I;++I)q.Xc[S][I]=q.Wc[S][j1[I]]}return f.kc=fe(U),f.kc&&(f.Bd=J(U,8)),f.cb=1}function Xo(f,p,S,k,I,U,q){var Y=p[I].Yb[S];for(S=0;16>I;++I){if(!he(f,Y[S+0]))return I;for(;!he(f,Y[S+1]);)if(Y=p[++I].Yb[0],S=0,I==16)return 16;var K=p[I+1].Yb;if(he(f,Y[S+2])){var ee=f,pe=0;if(he(ee,(_e=Y)[(Se=S)+3]))if(he(ee,_e[Se+6])){for(Y=0,Se=2*(pe=he(ee,_e[Se+8]))+(_e=he(ee,_e[Se+9+pe])),pe=0,_e=b1[Se];_e[Y];++Y)pe+=pe+he(ee,_e[Y]);pe+=3+(8<<Se)}else he(ee,_e[Se+7])?(pe=7+2*he(ee,165),pe+=he(ee,145)):pe=5+he(ee,159);else pe=he(ee,_e[Se+4])?3+he(ee,_e[Se+5]):2;Y=K[2]}else pe=1,Y=K[1];K=q+N1[I],0>(ee=f).b&&ce(ee);var Se,_e=ee.b,ve=(Se=ee.Ca>>1)-(ee.I>>_e)>>31;--ee.b,ee.Ca+=ve,ee.Ca|=1,ee.I-=(Se+1&ve)<<_e,U[K]=((pe^ve)-ve)*k[(0<I)+0]}return 16}function Rs(f){var p=f.rb[f.sb-1];p.la=0,p.Na=0,a(f.zc,0,0,f.zc.length),f.ja=0}function Nc(f,p){if(f==null)return 0;if(p==null)return xr(f,2,"NULL VP8Io parameter in VP8Decode().");if(!f.cb&&!Yo(f,p))return 0;if(r(f.cb),p.ac==null||p.ac(p)){p.ob&&(f.L=0);var S=Sl[f.L];if(f.L==2?(f.yb=0,f.zb=0):(f.yb=p.v-S>>4,f.zb=p.j-S>>4,0>f.yb&&(f.yb=0),0>f.zb&&(f.zb=0)),f.Va=p.o+15+S>>4,f.Hb=p.va+15+S>>4,f.Hb>f.za&&(f.Hb=f.za),f.Va>f.Ub&&(f.Va=f.Ub),0<f.L){var k=f.ed;for(S=0;4>S;++S){var I;if(f.Qa.Cb){var U=f.Qa.Lb[S];f.Qa.Fb||(U+=k.Tb)}else U=k.Tb;for(I=0;1>=I;++I){var q=f.gd[S][I],Y=U;if(k.Pc&&(Y+=k.vd[0],I&&(Y+=k.od[0])),0<(Y=0>Y?0:63<Y?63:Y)){var K=Y;0<k.wb&&(K=4<k.wb?K>>2:K>>1)>9-k.wb&&(K=9-k.wb),1>K&&(K=1),q.dd=K,q.tc=2*Y+K,q.ld=40<=Y?2:15<=Y?1:0}else q.tc=0;q.La=I}}}S=0}else xr(f,6,"Frame setup failed"),S=f.a;if(S=S==0){if(S){f.$c=0,0<f.Aa||(f.Ic=B1);e:{S=f.Ic,k=4*(K=f.za);var ee=32*K,pe=K+1,Se=0<f.L?K*(0<f.Aa?2:1):0,_e=(f.Aa==2?2:1)*K;if((q=k+832+(I=3*(16*S+Sl[f.L])/2*ee)+(U=f.Fa!=null&&0<f.Fa.length?f.Kc.c*f.Kc.i:0))!=q)S=0;else{if(q>f.Vb){if(f.Vb=0,f.Ec=i(q),f.Fc=0,f.Ec==null){S=xr(f,1,"no memory during frame initialization.");break e}f.Vb=q}q=f.Ec,Y=f.Fc,f.Ac=q,f.Bc=Y,Y+=k,f.Gd=o(ee,ga),f.Hd=0,f.rb=o(pe+1,Xt),f.sb=1,f.wa=Se?o(Se,Wt):null,f.Y=0,f.D.Nb=0,f.D.wa=f.wa,f.D.Y=f.Y,0<f.Aa&&(f.D.Y+=K),r(!0),f.oc=q,f.pc=Y,Y+=832,f.ya=o(_e,Zn),f.aa=0,f.D.ya=f.ya,f.D.aa=f.aa,f.Aa==2&&(f.D.aa+=K),f.R=16*K,f.B=8*K,K=(ee=Sl[f.L])*f.R,ee=ee/2*f.B,f.sa=q,f.ta=Y+K,f.qa=f.sa,f.ra=f.ta+16*S*f.R+ee,f.Ha=f.qa,f.Ia=f.ra+8*S*f.B+ee,f.$c=0,Y+=I,f.mb=U?q:null,f.nb=U?Y:null,r(Y+U<=f.Fc+f.Vb),Rs(f),a(f.Ac,f.Bc,0,k),S=1}}if(S){if(p.ka=0,p.y=f.sa,p.O=f.ta,p.f=f.qa,p.N=f.ra,p.ea=f.Ha,p.Vd=f.Ia,p.fa=f.R,p.Rc=f.B,p.F=null,p.J=0,!pl){for(S=-255;255>=S;++S)Cr[255+S]=0>S?-S:S;for(S=-1020;1020>=S;++S)Da[1020+S]=-128>S?-128:127<S?127:S;for(S=-112;112>=S;++S)io[112+S]=-16>S?-16:15<S?15:S;for(S=-255;510>=S;++S)us[255+S]=0>S?0:255<S?255:S;pl=1}cs=Ac,Ia=Sc,ro=Jo,ln=_c,Hn=Zo,vr=Ko,fs=qs,dl=_i,no=Mc,Ti=zs,ki=Rc,Za=es,Ei=Vs,hs=ol,Fi=sl,Qa=ya,ao=Ca,Wn=Dc,na[0]=va,na[1]=jc,na[2]=Fc,na[3]=Lc,na[4]=tl,na[5]=Zi,na[6]=rl,na[7]=Us,na[8]=Pc,na[9]=Cc,ei[0]=Qo,ei[1]=kc,ei[2]=La,ei[3]=Ki,ei[4]=Jr,ei[5]=Ec,ei[6]=el,Ra[0]=$a,Ra[1]=Tc,Ra[2]=Oc,Ra[3]=Hs,Ra[4]=Si,Ra[5]=Ic,Ra[6]=Ws,S=1}else S=0}S&&(S=function(ve,De){for(ve.M=0;ve.M<ve.Va;++ve.M){var Fe,me=ve.Jc[ve.M&ve.Xb],ge=ve.m,Oe=ve;for(Fe=0;Fe<Oe.za;++Fe){var Ue=ge,Ie=Oe,st=Ie.Ac,Ze=Ie.Bc+4*Fe,dt=Ie.zc,et=Ie.ya[Ie.aa+Fe];if(Ie.Qa.Bb?et.$b=he(Ue,Ie.Pa.jb[0])?2+he(Ue,Ie.Pa.jb[2]):he(Ue,Ie.Pa.jb[1]):et.$b=0,Ie.kc&&(et.Ad=he(Ue,Ie.Bd)),et.Za=!he(Ue,145)+0,et.Za){var Bt=et.Ob,qt=0;for(Ie=0;4>Ie;++Ie){var It,Ft=dt[0+Ie];for(It=0;4>It;++It){Ft=_1[st[Ze+It]][Ft];for(var Qt=yf[he(Ue,Ft[0])];0<Qt;)Qt=yf[2*Qt+he(Ue,Ft[Qt])];Ft=-Qt,st[Ze+It]=Ft}n(Bt,qt,st,Ze,4),qt+=4,dt[0+Ie]=Ft}}else Ft=he(Ue,156)?he(Ue,128)?1:3:he(Ue,163)?2:0,et.Ob[0]=Ft,a(st,Ze,Ft,4),a(dt,0,Ft,4);et.Dd=he(Ue,142)?he(Ue,114)?he(Ue,183)?1:3:2:0}if(Oe.m.Ka)return xr(ve,7,"Premature end-of-partition0 encountered.");for(;ve.ja<ve.za;++ve.ja){if(Oe=me,Ue=(ge=ve).rb[ge.sb-1],st=ge.rb[ge.sb+ge.ja],Fe=ge.ya[ge.aa+ge.ja],Ze=ge.kc?Fe.Ad:0)Ue.la=st.la=0,Fe.Za||(Ue.Na=st.Na=0),Fe.Hc=0,Fe.Gc=0,Fe.ia=0;else{var Kt,At;if(Ue=st,st=Oe,Ze=ge.Pa.Xc,dt=ge.ya[ge.aa+ge.ja],et=ge.pb[dt.$b],Ie=dt.ad,Bt=0,qt=ge.rb[ge.sb-1],Ft=It=0,a(Ie,Bt,0,384),dt.Za)var Ar=0,vn=Ze[3];else{Qt=i(16);var jr=Ue.Na+qt.Na;if(jr=so(st,Ze[1],jr,et.Eb,0,Qt,0),Ue.Na=qt.Na=(0<jr)+0,1<jr)cs(Qt,0,Ie,Bt);else{var yn=Qt[0]+3>>3;for(Qt=0;256>Qt;Qt+=16)Ie[Bt+Qt]=yn}Ar=1,vn=Ze[0]}var zt=15&Ue.la,En=15&qt.la;for(Qt=0;4>Qt;++Qt){var Fn=1&En;for(yn=At=0;4>yn;++yn)zt=zt>>1|(Fn=(jr=so(st,vn,jr=Fn+(1&zt),et.Sc,Ar,Ie,Bt))>Ar)<<7,At=At<<2|(3<jr?3:1<jr?2:Ie[Bt+0]!=0),Bt+=16;zt>>=4,En=En>>1|Fn<<7,It=(It<<8|At)>>>0}for(vn=zt,Ar=En>>4,Kt=0;4>Kt;Kt+=2){for(At=0,zt=Ue.la>>4+Kt,En=qt.la>>4+Kt,Qt=0;2>Qt;++Qt){for(Fn=1&En,yn=0;2>yn;++yn)jr=Fn+(1&zt),zt=zt>>1|(Fn=0<(jr=so(st,Ze[2],jr,et.Qc,0,Ie,Bt)))<<3,At=At<<2|(3<jr?3:1<jr?2:Ie[Bt+0]!=0),Bt+=16;zt>>=2,En=En>>1|Fn<<5}Ft|=At<<4*Kt,vn|=zt<<4<<Kt,Ar|=(240&En)<<Kt}Ue.la=vn,qt.la=Ar,dt.Hc=It,dt.Gc=Ft,dt.ia=43690&Ft?0:et.ia,Ze=!(It|Ft)}if(0<ge.L&&(ge.wa[ge.Y+ge.ja]=ge.gd[Fe.$b][Fe.Za],ge.wa[ge.Y+ge.ja].La|=!Ze),Oe.Ka)return xr(ve,7,"Premature end-of-file encountered.")}if(Rs(ve),ge=De,Oe=1,Fe=(me=ve).D,Ue=0<me.L&&me.M>=me.zb&&me.M<=me.Va,me.Aa==0)e:{if(Fe.M=me.M,Fe.uc=Ue,Js(me,Fe),Oe=1,Fe=(At=me.D).Nb,Ue=(Ft=Sl[me.L])*me.R,st=Ft/2*me.B,Qt=16*Fe*me.R,yn=8*Fe*me.B,Ze=me.sa,dt=me.ta-Ue+Qt,et=me.qa,Ie=me.ra-st+yn,Bt=me.Ha,qt=me.Ia-st+yn,En=(zt=At.M)==0,It=zt>=me.Va-1,me.Aa==2&&Js(me,At),At.uc)for(Fn=(jr=me).D.M,r(jr.D.uc),At=jr.yb;At<jr.Hb;++At){Ar=At,vn=Fn;var Rr=(qr=(ur=jr).D).Nb;Kt=ur.R;var qr=qr.wa[qr.Y+Ar],cn=ur.sa,Gn=ur.ta+16*Rr*Kt+16*Ar,ba=qr.dd,Mr=qr.tc;if(Mr!=0)if(r(3<=Mr),ur.L==1)0<Ar&&Qa(cn,Gn,Kt,Mr+4),qr.La&&Wn(cn,Gn,Kt,Mr),0<vn&&Fi(cn,Gn,Kt,Mr+4),qr.La&&ao(cn,Gn,Kt,Mr);else{var Ma=ur.B,Li=ur.qa,ds=ur.ra+8*Rr*Ma+8*Ar,ri=ur.Ha,ur=ur.Ia+8*Rr*Ma+8*Ar;Rr=qr.ld,0<Ar&&(dl(cn,Gn,Kt,Mr+4,ba,Rr),Ti(Li,ds,ri,ur,Ma,Mr+4,ba,Rr)),qr.La&&(Za(cn,Gn,Kt,Mr,ba,Rr),hs(Li,ds,ri,ur,Ma,Mr,ba,Rr)),0<vn&&(fs(cn,Gn,Kt,Mr+4,ba,Rr),no(Li,ds,ri,ur,Ma,Mr+4,ba,Rr)),qr.La&&(ki(cn,Gn,Kt,Mr,ba,Rr),Ei(Li,ds,ri,ur,Ma,Mr,ba,Rr))}}if(me.ia&&alert("todo:DitherRow"),ge.put!=null){if(At=16*zt,zt=16*(zt+1),En?(ge.y=me.sa,ge.O=me.ta+Qt,ge.f=me.qa,ge.N=me.ra+yn,ge.ea=me.Ha,ge.W=me.Ia+yn):(At-=Ft,ge.y=Ze,ge.O=dt,ge.f=et,ge.N=Ie,ge.ea=Bt,ge.W=qt),It||(zt-=Ft),zt>ge.o&&(zt=ge.o),ge.F=null,ge.J=null,me.Fa!=null&&0<me.Fa.length&&At<zt&&(ge.J=Xs(me,ge,At,zt-At),ge.F=me.mb,ge.F==null&&ge.F.length==0)){Oe=xr(me,3,"Could not decode alpha data.");break e}At<ge.j&&(Ft=ge.j-At,At=ge.j,r(!(1&Ft)),ge.O+=me.R*Ft,ge.N+=me.B*(Ft>>1),ge.W+=me.B*(Ft>>1),ge.F!=null&&(ge.J+=ge.width*Ft)),At<zt&&(ge.O+=ge.v,ge.N+=ge.v>>1,ge.W+=ge.v>>1,ge.F!=null&&(ge.J+=ge.v),ge.ka=At-ge.j,ge.U=ge.va-ge.v,ge.T=zt-At,Oe=ge.put(ge))}Fe+1!=me.Ic||It||(n(me.sa,me.ta-Ue,Ze,dt+16*me.R,Ue),n(me.qa,me.ra-st,et,Ie+8*me.B,st),n(me.Ha,me.Ia-st,Bt,qt+8*me.B,st))}if(!Oe)return xr(ve,6,"Output aborted.")}return 1}(f,p)),p.bc!=null&&p.bc(p),S&=1}return S?(f.cb=0,S):0}function ea(f,p,S,k,I){I=f[p+S+32*k]+(I>>3),f[p+S+32*k]=-256&I?0>I?0:255:I}function Xi(f,p,S,k,I,U){ea(f,p,0,S,k+I),ea(f,p,1,S,k+U),ea(f,p,2,S,k-U),ea(f,p,3,S,k-I)}function mn(f){return(20091*f>>16)+f}function Ms(f,p,S,k){var I,U=0,q=i(16);for(I=0;4>I;++I){var Y=f[p+0]+f[p+8],K=f[p+0]-f[p+8],ee=(35468*f[p+4]>>16)-mn(f[p+12]),pe=mn(f[p+4])+(35468*f[p+12]>>16);q[U+0]=Y+pe,q[U+1]=K+ee,q[U+2]=K-ee,q[U+3]=Y-pe,U+=4,p++}for(I=U=0;4>I;++I)Y=(f=q[U+0]+4)+q[U+8],K=f-q[U+8],ee=(35468*q[U+4]>>16)-mn(q[U+12]),ea(S,k,0,0,Y+(pe=mn(q[U+4])+(35468*q[U+12]>>16))),ea(S,k,1,0,K+ee),ea(S,k,2,0,K-ee),ea(S,k,3,0,Y-pe),U++,k+=32}function Ko(f,p,S,k){var I=f[p+0]+4,U=35468*f[p+4]>>16,q=mn(f[p+4]),Y=35468*f[p+1]>>16;Xi(S,k,0,I+q,f=mn(f[p+1]),Y),Xi(S,k,1,I+U,f,Y),Xi(S,k,2,I-U,f,Y),Xi(S,k,3,I-q,f,Y)}function Sc(f,p,S,k,I){Ms(f,p,S,k),I&&Ms(f,p+16,S,k+4)}function Jo(f,p,S,k){Ia(f,p+0,S,k,1),Ia(f,p+32,S,k+128,1)}function _c(f,p,S,k){var I;for(f=f[p+0]+4,I=0;4>I;++I)for(p=0;4>p;++p)ea(S,k,p,I,f)}function Zo(f,p,S,k){f[p+0]&&ln(f,p+0,S,k),f[p+16]&&ln(f,p+16,S,k+4),f[p+32]&&ln(f,p+32,S,k+128),f[p+48]&&ln(f,p+48,S,k+128+4)}function Ac(f,p,S,k){var I,U=i(16);for(I=0;4>I;++I){var q=f[p+0+I]+f[p+12+I],Y=f[p+4+I]+f[p+8+I],K=f[p+4+I]-f[p+8+I],ee=f[p+0+I]-f[p+12+I];U[0+I]=q+Y,U[8+I]=q-Y,U[4+I]=ee+K,U[12+I]=ee-K}for(I=0;4>I;++I)q=(f=U[0+4*I]+3)+U[3+4*I],Y=U[1+4*I]+U[2+4*I],K=U[1+4*I]-U[2+4*I],ee=f-U[3+4*I],S[k+0]=q+Y>>3,S[k+16]=ee+K>>3,S[k+32]=q-Y>>3,S[k+48]=ee-K>>3,k+=64}function Bs(f,p,S){var k,I=p-32,U=kn,q=255-f[I-1];for(k=0;k<S;++k){var Y,K=U,ee=q+f[p-1];for(Y=0;Y<S;++Y)f[p+Y]=K[ee+f[I+Y]];p+=32}}function jc(f,p){Bs(f,p,4)}function Tc(f,p){Bs(f,p,8)}function kc(f,p){Bs(f,p,16)}function La(f,p){var S;for(S=0;16>S;++S)n(f,p+32*S,f,p-32,16)}function Ki(f,p){var S;for(S=16;0<S;--S)a(f,p,f[p-1],16),p+=32}function Ji(f,p,S){var k;for(k=0;16>k;++k)a(p,S+32*k,f,16)}function Qo(f,p){var S,k=16;for(S=0;16>S;++S)k+=f[p-1+32*S]+f[p+S-32];Ji(k>>5,f,p)}function Jr(f,p){var S,k=8;for(S=0;16>S;++S)k+=f[p-1+32*S];Ji(k>>4,f,p)}function Ec(f,p){var S,k=8;for(S=0;16>S;++S)k+=f[p+S-32];Ji(k>>4,f,p)}function el(f,p){Ji(128,f,p)}function yt(f,p,S){return f+2*p+S+2>>2}function Fc(f,p){var S,k=p-32;for(k=new Uint8Array([yt(f[k-1],f[k+0],f[k+1]),yt(f[k+0],f[k+1],f[k+2]),yt(f[k+1],f[k+2],f[k+3]),yt(f[k+2],f[k+3],f[k+4])]),S=0;4>S;++S)n(f,p+32*S,k,0,k.length)}function Lc(f,p){var S=f[p-1],k=f[p-1+32],I=f[p-1+64],U=f[p-1+96];we(f,p+0,16843009*yt(f[p-1-32],S,k)),we(f,p+32,16843009*yt(S,k,I)),we(f,p+64,16843009*yt(k,I,U)),we(f,p+96,16843009*yt(I,U,U))}function va(f,p){var S,k=4;for(S=0;4>S;++S)k+=f[p+S-32]+f[p-1+32*S];for(k>>=3,S=0;4>S;++S)a(f,p+32*S,k,4)}function tl(f,p){var S=f[p-1+0],k=f[p-1+32],I=f[p-1+64],U=f[p-1-32],q=f[p+0-32],Y=f[p+1-32],K=f[p+2-32],ee=f[p+3-32];f[p+0+96]=yt(k,I,f[p-1+96]),f[p+1+96]=f[p+0+64]=yt(S,k,I),f[p+2+96]=f[p+1+64]=f[p+0+32]=yt(U,S,k),f[p+3+96]=f[p+2+64]=f[p+1+32]=f[p+0+0]=yt(q,U,S),f[p+3+64]=f[p+2+32]=f[p+1+0]=yt(Y,q,U),f[p+3+32]=f[p+2+0]=yt(K,Y,q),f[p+3+0]=yt(ee,K,Y)}function rl(f,p){var S=f[p+1-32],k=f[p+2-32],I=f[p+3-32],U=f[p+4-32],q=f[p+5-32],Y=f[p+6-32],K=f[p+7-32];f[p+0+0]=yt(f[p+0-32],S,k),f[p+1+0]=f[p+0+32]=yt(S,k,I),f[p+2+0]=f[p+1+32]=f[p+0+64]=yt(k,I,U),f[p+3+0]=f[p+2+32]=f[p+1+64]=f[p+0+96]=yt(I,U,q),f[p+3+32]=f[p+2+64]=f[p+1+96]=yt(U,q,Y),f[p+3+64]=f[p+2+96]=yt(q,Y,K),f[p+3+96]=yt(Y,K,K)}function Zi(f,p){var S=f[p-1+0],k=f[p-1+32],I=f[p-1+64],U=f[p-1-32],q=f[p+0-32],Y=f[p+1-32],K=f[p+2-32],ee=f[p+3-32];f[p+0+0]=f[p+1+64]=U+q+1>>1,f[p+1+0]=f[p+2+64]=q+Y+1>>1,f[p+2+0]=f[p+3+64]=Y+K+1>>1,f[p+3+0]=K+ee+1>>1,f[p+0+96]=yt(I,k,S),f[p+0+64]=yt(k,S,U),f[p+0+32]=f[p+1+96]=yt(S,U,q),f[p+1+32]=f[p+2+96]=yt(U,q,Y),f[p+2+32]=f[p+3+96]=yt(q,Y,K),f[p+3+32]=yt(Y,K,ee)}function Us(f,p){var S=f[p+0-32],k=f[p+1-32],I=f[p+2-32],U=f[p+3-32],q=f[p+4-32],Y=f[p+5-32],K=f[p+6-32],ee=f[p+7-32];f[p+0+0]=S+k+1>>1,f[p+1+0]=f[p+0+64]=k+I+1>>1,f[p+2+0]=f[p+1+64]=I+U+1>>1,f[p+3+0]=f[p+2+64]=U+q+1>>1,f[p+0+32]=yt(S,k,I),f[p+1+32]=f[p+0+96]=yt(k,I,U),f[p+2+32]=f[p+1+96]=yt(I,U,q),f[p+3+32]=f[p+2+96]=yt(U,q,Y),f[p+3+64]=yt(q,Y,K),f[p+3+96]=yt(Y,K,ee)}function Cc(f,p){var S=f[p-1+0],k=f[p-1+32],I=f[p-1+64],U=f[p-1+96];f[p+0+0]=S+k+1>>1,f[p+2+0]=f[p+0+32]=k+I+1>>1,f[p+2+32]=f[p+0+64]=I+U+1>>1,f[p+1+0]=yt(S,k,I),f[p+3+0]=f[p+1+32]=yt(k,I,U),f[p+3+32]=f[p+1+64]=yt(I,U,U),f[p+3+64]=f[p+2+64]=f[p+0+96]=f[p+1+96]=f[p+2+96]=f[p+3+96]=U}function Pc(f,p){var S=f[p-1+0],k=f[p-1+32],I=f[p-1+64],U=f[p-1+96],q=f[p-1-32],Y=f[p+0-32],K=f[p+1-32],ee=f[p+2-32];f[p+0+0]=f[p+2+32]=S+q+1>>1,f[p+0+32]=f[p+2+64]=k+S+1>>1,f[p+0+64]=f[p+2+96]=I+k+1>>1,f[p+0+96]=U+I+1>>1,f[p+3+0]=yt(Y,K,ee),f[p+2+0]=yt(q,Y,K),f[p+1+0]=f[p+3+32]=yt(S,q,Y),f[p+1+32]=f[p+3+64]=yt(k,S,q),f[p+1+64]=f[p+3+96]=yt(I,k,S),f[p+1+96]=yt(U,I,k)}function Oc(f,p){var S;for(S=0;8>S;++S)n(f,p+32*S,f,p-32,8)}function Hs(f,p){var S;for(S=0;8>S;++S)a(f,p,f[p-1],8),p+=32}function Ni(f,p,S){var k;for(k=0;8>k;++k)a(p,S+32*k,f,8)}function $a(f,p){var S,k=8;for(S=0;8>S;++S)k+=f[p+S-32]+f[p-1+32*S];Ni(k>>4,f,p)}function Ic(f,p){var S,k=4;for(S=0;8>S;++S)k+=f[p+S-32];Ni(k>>3,f,p)}function Si(f,p){var S,k=4;for(S=0;8>S;++S)k+=f[p-1+32*S];Ni(k>>3,f,p)}function Ws(f,p){Ni(128,f,p)}function Qi(f,p,S){var k=f[p-S],I=f[p+0],U=3*(I-k)+Hc[1020+f[p-2*S]-f[p+S]],q=ml[112+(U+4>>3)];f[p-S]=kn[255+k+ml[112+(U+3>>3)]],f[p+0]=kn[255+I-q]}function nl(f,p,S,k){var I=f[p+0],U=f[p+S];return zn[255+f[p-2*S]-f[p-S]]>k||zn[255+U-I]>k}function al(f,p,S,k){return 4*zn[255+f[p-S]-f[p+0]]+zn[255+f[p-2*S]-f[p+S]]<=k}function il(f,p,S,k,I){var U=f[p-3*S],q=f[p-2*S],Y=f[p-S],K=f[p+0],ee=f[p+S],pe=f[p+2*S],Se=f[p+3*S];return 4*zn[255+Y-K]+zn[255+q-ee]>k?0:zn[255+f[p-4*S]-U]<=I&&zn[255+U-q]<=I&&zn[255+q-Y]<=I&&zn[255+Se-pe]<=I&&zn[255+pe-ee]<=I&&zn[255+ee-K]<=I}function sl(f,p,S,k){var I=2*k+1;for(k=0;16>k;++k)al(f,p+k,S,I)&&Qi(f,p+k,S)}function ya(f,p,S,k){var I=2*k+1;for(k=0;16>k;++k)al(f,p+k*S,1,I)&&Qi(f,p+k*S,1)}function Ca(f,p,S,k){var I;for(I=3;0<I;--I)sl(f,p+=4*S,S,k)}function Dc(f,p,S,k){var I;for(I=3;0<I;--I)ya(f,p+=4,S,k)}function Ya(f,p,S,k,I,U,q,Y){for(U=2*U+1;0<I--;){if(il(f,p,S,U,q))if(nl(f,p,S,Y))Qi(f,p,S);else{var K=f,ee=p,pe=S,Se=K[ee-2*pe],_e=K[ee-pe],ve=K[ee+0],De=K[ee+pe],Fe=K[ee+2*pe],me=27*(Oe=Hc[1020+3*(ve-_e)+Hc[1020+Se-De]])+63>>7,ge=18*Oe+63>>7,Oe=9*Oe+63>>7;K[ee-3*pe]=kn[255+K[ee-3*pe]+Oe],K[ee-2*pe]=kn[255+Se+ge],K[ee-pe]=kn[255+_e+me],K[ee+0]=kn[255+ve-me],K[ee+pe]=kn[255+De-ge],K[ee+2*pe]=kn[255+Fe-Oe]}p+=k}}function ta(f,p,S,k,I,U,q,Y){for(U=2*U+1;0<I--;){if(il(f,p,S,U,q))if(nl(f,p,S,Y))Qi(f,p,S);else{var K=f,ee=p,pe=S,Se=K[ee-pe],_e=K[ee+0],ve=K[ee+pe],De=ml[112+((Fe=3*(_e-Se))+4>>3)],Fe=ml[112+(Fe+3>>3)],me=De+1>>1;K[ee-2*pe]=kn[255+K[ee-2*pe]+me],K[ee-pe]=kn[255+Se+Fe],K[ee+0]=kn[255+_e-De],K[ee+pe]=kn[255+ve-me]}p+=k}}function qs(f,p,S,k,I,U){Ya(f,p,S,1,16,k,I,U)}function _i(f,p,S,k,I,U){Ya(f,p,1,S,16,k,I,U)}function Rc(f,p,S,k,I,U){var q;for(q=3;0<q;--q)ta(f,p+=4*S,S,1,16,k,I,U)}function es(f,p,S,k,I,U){var q;for(q=3;0<q;--q)ta(f,p+=4,1,S,16,k,I,U)}function Mc(f,p,S,k,I,U,q,Y){Ya(f,p,I,1,8,U,q,Y),Ya(S,k,I,1,8,U,q,Y)}function zs(f,p,S,k,I,U,q,Y){Ya(f,p,1,I,8,U,q,Y),Ya(S,k,1,I,8,U,q,Y)}function Vs(f,p,S,k,I,U,q,Y){ta(f,p+4*I,I,1,8,U,q,Y),ta(S,k+4*I,I,1,8,U,q,Y)}function ol(f,p,S,k,I,U,q,Y){ta(f,p+4,1,I,8,U,q,Y),ta(S,k+4,1,I,8,U,q,Y)}function ts(){this.ba=new _n,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Zt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Gs(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function $s(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function ll(){this.ua=0,this.Wa=new oe,this.vb=new oe,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new M,this.yc=new T}function Bc(){this.xb=this.a=0,this.l=new xa,this.ca=new _n,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new _,this.Pb=0,this.wd=new _,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new ll,this.ab=0,this.gc=o(4,$s),this.Oc=0}function rs(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new xa,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Ai(f,p,S,k,I,U,q){for(f=f==null?0:f[p+0],p=0;p<q;++p)I[U+p]=f+S[k+p]&255,f=I[U+p]}function Ys(f,p,S,k,I,U,q){var Y;if(f==null)Ai(null,null,S,k,I,U,q);else for(Y=0;Y<q;++Y)I[U+Y]=f[p+Y]+S[k+Y]&255}function Xa(f,p,S,k,I,U,q){if(f==null)Ai(null,null,S,k,I,U,q);else{var Y,K=f[p+0],ee=K,pe=K;for(Y=0;Y<q;++Y)ee=pe+(K=f[p+Y])-ee,pe=S[k+Y]+(-256&ee?0>ee?0:255:ee)&255,ee=K,I[U+Y]=pe}}function Xs(f,p,S,k){var I=p.width,U=p.o;if(r(f!=null&&p!=null),0>S||0>=k||S+k>U)return null;if(!f.Cc){if(f.ga==null){var q;if(f.ga=new rs,(q=f.ga==null)||(q=p.width*p.o,r(f.Gb.length==0),f.Gb=i(q),f.Uc=0,f.Gb==null?q=0:(f.mb=f.Gb,f.nb=f.Uc,f.rc=null,q=1),q=!q),!q){q=f.ga;var Y=f.Fa,K=f.P,ee=f.qc,pe=f.mb,Se=f.nb,_e=K+1,ve=ee-1,De=q.l;if(r(Y!=null&&pe!=null&&p!=null),ti[0]=null,ti[1]=Ai,ti[2]=Ys,ti[3]=Xa,q.ca=pe,q.tb=Se,q.c=p.width,q.i=p.height,r(0<q.c&&0<q.i),1>=ee)p=0;else if(q.$a=Y[K+0]>>0&3,q.Z=Y[K+0]>>2&3,q.Lc=Y[K+0]>>4&3,K=Y[K+0]>>6&3,0>q.$a||1<q.$a||4<=q.Z||1<q.Lc||K)p=0;else if(De.put=Mn,De.ac=Lr,De.bc=Bn,De.ma=q,De.width=p.width,De.height=p.height,De.Da=p.Da,De.v=p.v,De.va=p.va,De.j=p.j,De.o=p.o,q.$a)e:{r(q.$a==1),p=Ee();t:for(;;){if(p==null){p=0;break e}if(r(q!=null),q.mc=p,p.c=q.c,p.i=q.i,p.l=q.l,p.l.ma=q,p.l.width=q.c,p.l.height=q.i,p.a=0,ae(p.m,Y,_e,ve),!be(q.c,q.i,1,p,null)||(p.ab==1&&p.gc[0].hc==3&&Z(p.s)?(q.ic=1,Y=p.c*p.i,p.Ta=null,p.Ua=0,p.V=i(Y),p.Ba=0,p.V==null?(p.a=1,p=0):p=1):(q.ic=0,p=Ae(p,q.c)),!p))break t;p=1;break e}q.mc=null,p=0}else p=ve>=q.c*q.i;q=!p}if(q)return null;f.ga.Lc!=1?f.Ga=0:k=U-S}r(f.ga!=null),r(S+k<=U);e:{if(p=(Y=f.ga).c,U=Y.l.o,Y.$a==0){if(_e=f.rc,ve=f.Vc,De=f.Fa,K=f.P+1+S*p,ee=f.mb,pe=f.nb+S*p,r(K<=f.P+f.qc),Y.Z!=0)for(r(ti[Y.Z]!=null),q=0;q<k;++q)ti[Y.Z](_e,ve,De,K,ee,pe,p),_e=ee,ve=pe,pe+=p,K+=p;else for(q=0;q<k;++q)n(ee,pe,De,K,p),_e=ee,ve=pe,pe+=p,K+=p;f.rc=_e,f.Vc=ve}else{if(r(Y.mc!=null),p=S+k,r((q=Y.mc)!=null),r(p<=q.i),q.C>=p)p=1;else if(Y.ic||ye(),Y.ic){Y=q.V,_e=q.Ba,ve=q.c;var Fe=q.i,me=(De=1,K=q.$/ve,ee=q.$%ve,pe=q.m,Se=q.s,q.$),ge=ve*Fe,Oe=ve*p,Ue=Se.wc,Ie=me<Oe?fr(Se,ee,K):null;r(me<=ge),r(p<=Fe),r(Z(Se));t:for(;;){for(;!pe.h&&me<Oe;){if(ee&Ue||(Ie=fr(Se,ee,K)),r(Ie!=null),X(pe),256>(Fe=Kr(Ie.G[0],Ie.H[0],pe)))Y[_e+me]=Fe,++me,++ee>=ve&&(ee=0,++K<=p&&!(K%16)&&re(q,K));else{if(!(280>Fe)){De=0;break t}Fe=An(Fe-256,pe);var st,Ze=Kr(Ie.G[4],Ie.H[4],pe);if(X(pe),!(me>=(Ze=pn(ve,Ze=An(Ze,pe)))&&ge-me>=Fe)){De=0;break t}for(st=0;st<Fe;++st)Y[_e+me+st]=Y[_e+me+st-Ze];for(me+=Fe,ee+=Fe;ee>=ve;)ee-=ve,++K<=p&&!(K%16)&&re(q,K);me<Oe&&ee&Ue&&(Ie=fr(Se,ee,K))}r(pe.h==P(pe))}re(q,K>p?p:K);break t}!De||pe.h&&me<ge?(De=0,q.a=pe.h?5:3):q.$=me,p=De}else p=ie(q,q.V,q.Ba,q.c,q.i,p,je);if(!p){k=0;break e}}S+k>=U&&(f.Cc=1),k=1}if(!k)return null;if(f.Cc&&((k=f.ga)!=null&&(k.mc=null),f.ga=null,0<f.Ga))return alert("todo:WebPDequantizeLevels"),null}return f.nb+S*I}function v(f,p,S,k,I,U){for(;0<I--;){var q,Y=f,K=p+(S?1:0),ee=f,pe=p+(S?0:3);for(q=0;q<k;++q){var Se=ee[pe+4*q];Se!=255&&(Se*=32897,Y[K+4*q+0]=Y[K+4*q+0]*Se>>23,Y[K+4*q+1]=Y[K+4*q+1]*Se>>23,Y[K+4*q+2]=Y[K+4*q+2]*Se>>23)}p+=U}}function D(f,p,S,k,I){for(;0<k--;){var U;for(U=0;U<S;++U){var q=f[p+2*U+0],Y=15&(ee=f[p+2*U+1]),K=4369*Y,ee=(240&ee|ee>>4)*K>>16;f[p+2*U+0]=(240&q|q>>4)*K>>16&240|(15&q|q<<4)*K>>16>>4&15,f[p+2*U+1]=240&ee|Y}p+=I}}function se(f,p,S,k,I,U,q,Y){var K,ee,pe=255;for(ee=0;ee<I;++ee){for(K=0;K<k;++K){var Se=f[p+K];U[q+4*K]=Se,pe&=Se}p+=S,q+=Y}return pe!=255}function ue(f,p,S,k,I){var U;for(U=0;U<I;++U)S[k+U]=f[p+U]>>8}function ye(){qn=v,nr=D,ar=se,yr=ue}function Le(f,p,S){C[f]=function(k,I,U,q,Y,K,ee,pe,Se,_e,ve,De,Fe,me,ge,Oe,Ue){var Ie,st=Ue-1>>1,Ze=Y[K+0]|ee[pe+0]<<16,dt=Se[_e+0]|ve[De+0]<<16;r(k!=null);var et=3*Ze+dt+131074>>2;for(p(k[I+0],255&et,et>>16,Fe,me),U!=null&&(et=3*dt+Ze+131074>>2,p(U[q+0],255&et,et>>16,ge,Oe)),Ie=1;Ie<=st;++Ie){var Bt=Y[K+Ie]|ee[pe+Ie]<<16,qt=Se[_e+Ie]|ve[De+Ie]<<16,It=Ze+Bt+dt+qt+524296,Ft=It+2*(Bt+dt)>>3;et=Ft+Ze>>1,Ze=(It=It+2*(Ze+qt)>>3)+Bt>>1,p(k[I+2*Ie-1],255&et,et>>16,Fe,me+(2*Ie-1)*S),p(k[I+2*Ie-0],255&Ze,Ze>>16,Fe,me+(2*Ie-0)*S),U!=null&&(et=It+dt>>1,Ze=Ft+qt>>1,p(U[q+2*Ie-1],255&et,et>>16,ge,Oe+(2*Ie-1)*S),p(U[q+2*Ie+0],255&Ze,Ze>>16,ge,Oe+(2*Ie+0)*S)),Ze=Bt,dt=qt}1&Ue||(et=3*Ze+dt+131074>>2,p(k[I+Ue-1],255&et,et>>16,Fe,me+(Ue-1)*S),U!=null&&(et=3*dt+Ze+131074>>2,p(U[q+Ue-1],255&et,et>>16,ge,Oe+(Ue-1)*S)))}}function We(){Vn[gl]=k1,Vn[xl]=bf,Vn[gf]=E1,Vn[vl]=Nf,Vn[yl]=Sf,Vn[Wc]=_f,Vn[xf]=F1,Vn[qc]=bf,Vn[zc]=Nf,Vn[wl]=Sf,Vn[Vc]=_f}function it(f){return f&-16384?0>f?0:255:f>>L1}function ft(f,p){return it((19077*f>>8)+(26149*p>>8)-14234)}function Nt(f,p,S){return it((19077*f>>8)-(6419*p>>8)-(13320*S>>8)+8708)}function wt(f,p){return it((19077*f>>8)+(33050*p>>8)-17685)}function Pt(f,p,S,k,I){k[I+0]=ft(f,S),k[I+1]=Nt(f,p,S),k[I+2]=wt(f,p)}function cr(f,p,S,k,I){k[I+0]=wt(f,p),k[I+1]=Nt(f,p,S),k[I+2]=ft(f,S)}function hr(f,p,S,k,I){var U=Nt(f,p,S);p=U<<3&224|wt(f,p)>>3,k[I+0]=248&ft(f,S)|U>>5,k[I+1]=p}function _r(f,p,S,k,I){var U=240&wt(f,p)|15;k[I+0]=240&ft(f,S)|Nt(f,p,S)>>4,k[I+1]=U}function Zr(f,p,S,k,I){k[I+0]=255,Pt(f,p,S,k,I+1)}function Dr(f,p,S,k,I){cr(f,p,S,k,I),k[I+3]=255}function ra(f,p,S,k,I){Pt(f,p,S,k,I),k[I+3]=255}function Tn(f,p){return 0>f?0:f>p?p:f}function wa(f,p,S){C[f]=function(k,I,U,q,Y,K,ee,pe,Se){for(var _e=pe+(-2&Se)*S;pe!=_e;)p(k[I+0],U[q+0],Y[K+0],ee,pe),p(k[I+1],U[q+0],Y[K+0],ee,pe+S),I+=2,++q,++K,pe+=2*S;1&Se&&p(k[I+0],U[q+0],Y[K+0],ee,pe)}}function cl(f,p,S){return S==0?f==0?p==0?6:5:p==0?4:0:S}function Ks(f,p,S,k,I){switch(f>>>30){case 3:Ia(p,S,k,I,0);break;case 2:vr(p,S,k,I);break;case 1:ln(p,S,k,I)}}function Js(f,p){var S,k,I=p.M,U=p.Nb,q=f.oc,Y=f.pc+40,K=f.oc,ee=f.pc+584,pe=f.oc,Se=f.pc+600;for(S=0;16>S;++S)q[Y+32*S-1]=129;for(S=0;8>S;++S)K[ee+32*S-1]=129,pe[Se+32*S-1]=129;for(0<I?q[Y-1-32]=K[ee-1-32]=pe[Se-1-32]=129:(a(q,Y-32-1,127,21),a(K,ee-32-1,127,9),a(pe,Se-32-1,127,9)),k=0;k<f.za;++k){var _e=p.ya[p.aa+k];if(0<k){for(S=-1;16>S;++S)n(q,Y+32*S-4,q,Y+32*S+12,4);for(S=-1;8>S;++S)n(K,ee+32*S-4,K,ee+32*S+4,4),n(pe,Se+32*S-4,pe,Se+32*S+4,4)}var ve=f.Gd,De=f.Hd+k,Fe=_e.ad,me=_e.Hc;if(0<I&&(n(q,Y-32,ve[De].y,0,16),n(K,ee-32,ve[De].f,0,8),n(pe,Se-32,ve[De].ea,0,8)),_e.Za){var ge=q,Oe=Y-32+16;for(0<I&&(k>=f.za-1?a(ge,Oe,ve[De].y[15],4):n(ge,Oe,ve[De+1].y,0,4)),S=0;4>S;S++)ge[Oe+128+S]=ge[Oe+256+S]=ge[Oe+384+S]=ge[Oe+0+S];for(S=0;16>S;++S,me<<=2)ge=q,Oe=Y+jf[S],na[_e.Ob[S]](ge,Oe),Ks(me,Fe,16*+S,ge,Oe)}else if(ge=cl(k,I,_e.Ob[0]),ei[ge](q,Y),me!=0)for(S=0;16>S;++S,me<<=2)Ks(me,Fe,16*+S,q,Y+jf[S]);for(S=_e.Gc,ge=cl(k,I,_e.Dd),Ra[ge](K,ee),Ra[ge](pe,Se),me=Fe,ge=K,Oe=ee,255&(_e=S>>0)&&(170&_e?ro(me,256,ge,Oe):Hn(me,256,ge,Oe)),_e=pe,me=Se,255&(S>>=8)&&(170&S?ro(Fe,320,_e,me):Hn(Fe,320,_e,me)),I<f.Ub-1&&(n(ve[De].y,0,q,Y+480,16),n(ve[De].f,0,K,ee+224,8),n(ve[De].ea,0,pe,Se+224,8)),S=8*U*f.B,ve=f.sa,De=f.ta+16*k+16*U*f.R,Fe=f.qa,_e=f.ra+8*k+S,me=f.Ha,ge=f.Ia+8*k+S,S=0;16>S;++S)n(ve,De+S*f.R,q,Y+32*S,16);for(S=0;8>S;++S)n(Fe,_e+S*f.B,K,ee+32*S,8),n(me,ge+S*f.B,pe,Se+32*S,8)}}function ns(f,p,S,k,I,U,q,Y,K){var ee=[0],pe=[0],Se=0,_e=K!=null?K.kd:0,ve=K??new Gs;if(f==null||12>S)return 7;ve.data=f,ve.w=p,ve.ha=S,p=[p],S=[S],ve.gb=[ve.gb];e:{var De=p,Fe=S,me=ve.gb;if(r(f!=null),r(Fe!=null),r(me!=null),me[0]=0,12<=Fe[0]&&!t(f,De[0],"RIFF")){if(t(f,De[0]+8,"WEBP")){me=3;break e}var ge=ze(f,De[0]+4);if(12>ge||4294967286<ge){me=3;break e}if(_e&&ge>Fe[0]-8){me=7;break e}me[0]=ge,De[0]+=12,Fe[0]-=12}me=0}if(me!=0)return me;for(ge=0<ve.gb[0],S=S[0];;){e:{var Oe=f;Fe=p,me=S;var Ue=ee,Ie=pe,st=De=[0];if((et=Se=[Se])[0]=0,8>me[0])me=7;else{if(!t(Oe,Fe[0],"VP8X")){if(ze(Oe,Fe[0]+4)!=10){me=3;break e}if(18>me[0]){me=7;break e}var Ze=ze(Oe,Fe[0]+8),dt=1+Re(Oe,Fe[0]+12);if(2147483648<=dt*(Oe=1+Re(Oe,Fe[0]+15))){me=3;break e}st!=null&&(st[0]=Ze),Ue!=null&&(Ue[0]=dt),Ie!=null&&(Ie[0]=Oe),Fe[0]+=18,me[0]-=18,et[0]=1}me=0}}if(Se=Se[0],De=De[0],me!=0)return me;if(Fe=!!(2&De),!ge&&Se)return 3;if(U!=null&&(U[0]=!!(16&De)),q!=null&&(q[0]=Fe),Y!=null&&(Y[0]=0),q=ee[0],De=pe[0],Se&&Fe&&K==null){me=0;break}if(4>S){me=7;break}if(ge&&Se||!ge&&!Se&&!t(f,p[0],"ALPH")){S=[S],ve.na=[ve.na],ve.P=[ve.P],ve.Sa=[ve.Sa];e:{Ze=f,me=p,ge=S;var et=ve.gb;Ue=ve.na,Ie=ve.P,st=ve.Sa,dt=22,r(Ze!=null),r(ge!=null),Oe=me[0];var Bt=ge[0];for(r(Ue!=null),r(st!=null),Ue[0]=null,Ie[0]=null,st[0]=0;;){if(me[0]=Oe,ge[0]=Bt,8>Bt){me=7;break e}var qt=ze(Ze,Oe+4);if(4294967286<qt){me=3;break e}var It=8+qt+1&-2;if(dt+=It,0<et&&dt>et){me=3;break e}if(!t(Ze,Oe,"VP8 ")||!t(Ze,Oe,"VP8L")){me=0;break e}if(Bt[0]<It){me=7;break e}t(Ze,Oe,"ALPH")||(Ue[0]=Ze,Ie[0]=Oe+8,st[0]=qt),Oe+=It,Bt-=It}}if(S=S[0],ve.na=ve.na[0],ve.P=ve.P[0],ve.Sa=ve.Sa[0],me!=0)break}S=[S],ve.Ja=[ve.Ja],ve.xa=[ve.xa];e:if(et=f,me=p,ge=S,Ue=ve.gb[0],Ie=ve.Ja,st=ve.xa,Ze=me[0],Oe=!t(et,Ze,"VP8 "),dt=!t(et,Ze,"VP8L"),r(et!=null),r(ge!=null),r(Ie!=null),r(st!=null),8>ge[0])me=7;else{if(Oe||dt){if(et=ze(et,Ze+4),12<=Ue&&et>Ue-12){me=3;break e}if(_e&&et>ge[0]-8){me=7;break e}Ie[0]=et,me[0]+=8,ge[0]-=8,st[0]=dt}else st[0]=5<=ge[0]&&et[Ze+0]==47&&!(et[Ze+4]>>5),Ie[0]=ge[0];me=0}if(S=S[0],ve.Ja=ve.Ja[0],ve.xa=ve.xa[0],p=p[0],me!=0)break;if(4294967286<ve.Ja)return 3;if(Y==null||Fe||(Y[0]=ve.xa?2:1),q=[q],De=[De],ve.xa){if(5>S){me=7;break}Y=q,_e=De,Fe=U,f==null||5>S?f=0:5<=S&&f[p+0]==47&&!(f[p+4]>>5)?(ge=[0],et=[0],Ue=[0],ae(Ie=new _,f,p,S),ut(Ie,ge,et,Ue)?(Y!=null&&(Y[0]=ge[0]),_e!=null&&(_e[0]=et[0]),Fe!=null&&(Fe[0]=Ue[0]),f=1):f=0):f=0}else{if(10>S){me=7;break}Y=De,f==null||10>S||!$o(f,p+3,S-3)?f=0:(_e=f[p+0]|f[p+1]<<8|f[p+2]<<16,Fe=16383&(f[p+7]<<8|f[p+6]),f=16383&(f[p+9]<<8|f[p+8]),1&_e||3<(_e>>1&7)||!(_e>>4&1)||_e>>5>=ve.Ja||!Fe||!f?f=0:(q&&(q[0]=Fe),Y&&(Y[0]=f),f=1))}if(!f||(q=q[0],De=De[0],Se&&(ee[0]!=q||pe[0]!=De)))return 3;K!=null&&(K[0]=ve,K.offset=p-K.w,r(4294967286>p-K.w),r(K.offset==K.ha-S));break}return me==0||me==7&&Se&&K==null?(U!=null&&(U[0]|=ve.na!=null&&0<ve.na.length),k!=null&&(k[0]=q),I!=null&&(I[0]=De),0):me}function Zs(f,p,S){var k=p.width,I=p.height,U=0,q=0,Y=k,K=I;if(p.Da=f!=null&&0<f.Da,p.Da&&(Y=f.cd,K=f.bd,U=f.v,q=f.j,11>S||(U&=-2,q&=-2),0>U||0>q||0>=Y||0>=K||U+Y>k||q+K>I))return 0;if(p.v=U,p.j=q,p.va=U+Y,p.o=q+K,p.U=Y,p.T=K,p.da=f!=null&&0<f.da,p.da){if(!Me(Y,K,S=[f.ib],U=[f.hb]))return 0;p.ib=S[0],p.hb=U[0]}return p.ob=f!=null&&f.ob,p.Kb=f==null||!f.Sd,p.da&&(p.ob=p.ib<3*k/4&&p.hb<3*I/4,p.Kb=0),1}function Qs(f){if(f==null)return 2;if(11>f.S){var p=f.f.RGBA;p.fb+=(f.height-1)*p.A,p.A=-p.A}else p=f.f.kb,f=f.height,p.O+=(f-1)*p.fa,p.fa=-p.fa,p.N+=(f-1>>1)*p.Ab,p.Ab=-p.Ab,p.W+=(f-1>>1)*p.Db,p.Db=-p.Db,p.F!=null&&(p.J+=(f-1)*p.lb,p.lb=-p.lb);return 0}function as(f,p,S,k){if(k==null||0>=f||0>=p)return 2;if(S!=null){if(S.Da){var I=S.cd,U=S.bd,q=-2&S.v,Y=-2&S.j;if(0>q||0>Y||0>=I||0>=U||q+I>f||Y+U>p)return 2;f=I,p=U}if(S.da){if(!Me(f,p,I=[S.ib],U=[S.hb]))return 2;f=I[0],p=U[0]}}k.width=f,k.height=p;e:{var K=k.width,ee=k.height;if(f=k.S,0>=K||0>=ee||!(f>=gl&&13>f))f=2;else{if(0>=k.Rd&&k.sd==null){q=U=I=p=0;var pe=(Y=K*Tf[f])*ee;if(11>f||(U=(ee+1)/2*(p=(K+1)/2),f==12&&(q=(I=K)*ee)),(ee=i(pe+2*U+q))==null){f=1;break e}k.sd=ee,11>f?((K=k.f.RGBA).eb=ee,K.fb=0,K.A=Y,K.size=pe):((K=k.f.kb).y=ee,K.O=0,K.fa=Y,K.Fd=pe,K.f=ee,K.N=0+pe,K.Ab=p,K.Cd=U,K.ea=ee,K.W=0+pe+U,K.Db=p,K.Ed=U,f==12&&(K.F=ee,K.J=0+pe+2*U),K.Tc=q,K.lb=I)}if(p=1,I=k.S,U=k.width,q=k.height,I>=gl&&13>I)if(11>I)f=k.f.RGBA,p&=(Y=Math.abs(f.A))*(q-1)+U<=f.size,p&=Y>=U*Tf[I],p&=f.eb!=null;else{f=k.f.kb,Y=(U+1)/2,pe=(q+1)/2,K=Math.abs(f.fa),ee=Math.abs(f.Ab);var Se=Math.abs(f.Db),_e=Math.abs(f.lb),ve=_e*(q-1)+U;p&=K*(q-1)+U<=f.Fd,p&=ee*(pe-1)+Y<=f.Cd,p=(p&=Se*(pe-1)+Y<=f.Ed)&K>=U&ee>=Y&Se>=Y,p&=f.y!=null,p&=f.f!=null,p&=f.ea!=null,I==12&&(p&=_e>=U,p&=ve<=f.Tc,p&=f.F!=null)}else p=0;f=p?0:2}}return f!=0||S!=null&&S.fd&&(f=Qs(k)),f}var Wr=64,is=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ss=24,os=32,eo=8,gn=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ge("Predictor0","PredictorAdd0"),C.Predictor0=function(){return 4278190080},C.Predictor1=function(f){return f},C.Predictor2=function(f,p,S){return p[S+0]},C.Predictor3=function(f,p,S){return p[S+1]},C.Predictor4=function(f,p,S){return p[S-1]},C.Predictor5=function(f,p,S){return Qe(Qe(f,p[S+1]),p[S+0])},C.Predictor6=function(f,p,S){return Qe(f,p[S-1])},C.Predictor7=function(f,p,S){return Qe(f,p[S+0])},C.Predictor8=function(f,p,S){return Qe(p[S-1],p[S+0])},C.Predictor9=function(f,p,S){return Qe(p[S+0],p[S+1])},C.Predictor10=function(f,p,S){return Qe(Qe(f,p[S-1]),Qe(p[S+0],p[S+1]))},C.Predictor11=function(f,p,S){var k=p[S+0];return 0>=xt(k>>24&255,f>>24&255,(p=p[S-1])>>24&255)+xt(k>>16&255,f>>16&255,p>>16&255)+xt(k>>8&255,f>>8&255,p>>8&255)+xt(255&k,255&f,255&p)?k:f},C.Predictor12=function(f,p,S){var k=p[S+0];return(lt((f>>24&255)+(k>>24&255)-((p=p[S-1])>>24&255))<<24|lt((f>>16&255)+(k>>16&255)-(p>>16&255))<<16|lt((f>>8&255)+(k>>8&255)-(p>>8&255))<<8|lt((255&f)+(255&k)-(255&p)))>>>0},C.Predictor13=function(f,p,S){var k=p[S-1];return(ct((f=Qe(f,p[S+0]))>>24&255,k>>24&255)<<24|ct(f>>16&255,k>>16&255)<<16|ct(f>>8&255,k>>8&255)<<8|ct(f>>0&255,k>>0&255))>>>0};var Uc=C.PredictorAdd0;C.PredictorAdd1=_t,Ge("Predictor2","PredictorAdd2"),Ge("Predictor3","PredictorAdd3"),Ge("Predictor4","PredictorAdd4"),Ge("Predictor5","PredictorAdd5"),Ge("Predictor6","PredictorAdd6"),Ge("Predictor7","PredictorAdd7"),Ge("Predictor8","PredictorAdd8"),Ge("Predictor9","PredictorAdd9"),Ge("Predictor10","PredictorAdd10"),Ge("Predictor11","PredictorAdd11"),Ge("Predictor12","PredictorAdd12"),Ge("Predictor13","PredictorAdd13");var to=C.PredictorAdd2;jt("ColorIndexInverseTransform","MapARGB","32b",function(f){return f>>8&255},function(f){return f}),jt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(f){return f},function(f){return f>>8&255});var fl,Un=C.ColorIndexInverseTransform,ls=C.MapARGB,hl=C.VP8LColorIndexInverseTransformAlpha,ul=C.MapAlpha,Ka=C.VP8LPredictorsAdd=[];Ka.length=16,(C.VP8LPredictors=[]).length=16,(C.VP8LPredictorsAdd_C=[]).length=16,(C.VP8LPredictors_C=[]).length=16;var ji,xn,on,Ja,Pa,Oa,cs,Ia,vr,ro,ln,Hn,fs,dl,no,Ti,ki,Za,Ei,hs,Fi,Qa,ao,Wn,qn,nr,ar,yr,Cr=i(511),Da=i(2041),io=i(225),us=i(767),pl=0,Hc=Da,ml=io,kn=us,zn=Cr,gl=0,xl=1,gf=2,vl=3,yl=4,Wc=5,xf=6,qc=7,zc=8,wl=9,Vc=10,p1=[2,3,7],m1=[3,3,11],vf=[280,256,256,256,40],g1=[0,1,1,1,0],x1=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],v1=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],y1=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],w1=8,Gc=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],$c=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],so=null,b1=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],N1=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],yf=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],S1=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],_1=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],A1=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],j1=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ei=[],na=[],Ra=[],T1=1,wf=2,ti=[],Vn=[];Le("UpsampleRgbLinePair",Pt,3),Le("UpsampleBgrLinePair",cr,3),Le("UpsampleRgbaLinePair",ra,4),Le("UpsampleBgraLinePair",Dr,4),Le("UpsampleArgbLinePair",Zr,4),Le("UpsampleRgba4444LinePair",_r,2),Le("UpsampleRgb565LinePair",hr,2);var k1=C.UpsampleRgbLinePair,E1=C.UpsampleBgrLinePair,bf=C.UpsampleRgbaLinePair,Nf=C.UpsampleBgraLinePair,Sf=C.UpsampleArgbLinePair,_f=C.UpsampleRgba4444LinePair,F1=C.UpsampleRgb565LinePair,bl=16,Nl=1<<bl-1,oo=-227,Yc=482,L1=6,Af=0,C1=i(256),P1=i(256),O1=i(256),I1=i(256),D1=i(Yc-oo),R1=i(Yc-oo);wa("YuvToRgbRow",Pt,3),wa("YuvToBgrRow",cr,3),wa("YuvToRgbaRow",ra,4),wa("YuvToBgraRow",Dr,4),wa("YuvToArgbRow",Zr,4),wa("YuvToRgba4444Row",_r,2),wa("YuvToRgb565Row",hr,2);var jf=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Sl=[0,2,8],M1=[8,7,6,4,4,2,2,2,1,1,1,1],B1=1;this.WebPDecodeRGBA=function(f,p,S,k,I){var U=xl,q=new ts,Y=new _n;q.ba=Y,Y.S=U,Y.width=[Y.width],Y.height=[Y.height];var K=Y.width,ee=Y.height,pe=new Jn;if(pe==null||f==null)var Se=2;else r(pe!=null),Se=ns(f,p,S,pe.width,pe.height,pe.Pd,pe.Qd,pe.format,null);if(Se!=0?K=0:(K!=null&&(K[0]=pe.width[0]),ee!=null&&(ee[0]=pe.height[0]),K=1),K){Y.width=Y.width[0],Y.height=Y.height[0],k!=null&&(k[0]=Y.width),I!=null&&(I[0]=Y.height);e:{if(k=new xa,(I=new Gs).data=f,I.w=p,I.ha=S,I.kd=1,p=[0],r(I!=null),((f=ns(I.data,I.w,I.ha,null,null,null,p,null,I))==0||f==7)&&p[0]&&(f=4),(p=f)==0){if(r(q!=null),k.data=I.data,k.w=I.w+I.offset,k.ha=I.ha-I.offset,k.put=Mn,k.ac=Lr,k.bc=Bn,k.ma=q,I.xa){if((f=Ee())==null){q=1;break e}if(function(_e,ve){var De=[0],Fe=[0],me=[0];t:for(;;){if(_e==null)return 0;if(ve==null)return _e.a=2,0;if(_e.l=ve,_e.a=0,ae(_e.m,ve.data,ve.w,ve.ha),!ut(_e.m,De,Fe,me)){_e.a=3;break t}if(_e.xb=wf,ve.width=De[0],ve.height=Fe[0],!be(De[0],Fe[0],1,_e,null))break t;return 1}return r(_e.a!=0),0}(f,k)){if(k=(p=as(k.width,k.height,q.Oa,q.ba))==0){t:{k=f;r:for(;;){if(k==null){k=0;break t}if(r(k.s.yc!=null),r(k.s.Ya!=null),r(0<k.s.Wb),r((S=k.l)!=null),r((I=S.ma)!=null),k.xb!=0){if(k.ca=I.ba,k.tb=I.tb,r(k.ca!=null),!Zs(I.Oa,S,vl)){k.a=2;break r}if(!Ae(k,S.width)||S.da)break r;if((S.da||Ot(k.ca.S))&&ye(),11>k.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),k.ca.f.kb.F!=null&&ye()),k.Pb&&0<k.s.ua&&k.s.vb.X==null&&!Ke(k.s.vb,k.s.Wa.Xa)){k.a=1;break r}k.xb=0}if(!ie(k,k.V,k.Ba,k.c,k.i,S.o,ne))break r;I.Dc=k.Ma,k=1;break t}r(k.a!=0),k=0}k=!k}k&&(p=f.a)}else p=f.a}else{if((f=new jn)==null){q=1;break e}if(f.Fa=I.na,f.P=I.P,f.qc=I.Sa,Yo(f,k)){if((p=as(k.width,k.height,q.Oa,q.ba))==0){if(f.Aa=0,S=q.Oa,r((I=f)!=null),S!=null){if(0<(K=0>(K=S.Md)?0:100<K?255:255*K/100)){for(ee=pe=0;4>ee;++ee)12>(Se=I.pb[ee]).lc&&(Se.ia=K*M1[0>Se.lc?0:Se.lc]>>3),pe|=Se.ia;pe&&(alert("todo:VP8InitRandom"),I.ia=1)}I.Ga=S.Id,100<I.Ga?I.Ga=100:0>I.Ga&&(I.Ga=0)}Nc(f,k)||(p=f.a)}}else p=f.a}p==0&&q.Oa!=null&&q.Oa.fd&&(p=Qs(q.ba))}q=p}U=q!=0?null:11>U?Y.f.RGBA.eb:Y.f.kb.y}else U=null;return U};var Tf=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function h(C,R){for(var G="",j=0;j<4;j++)G+=String.fromCharCode(C[R++]);return G}function u(C,R){return(C[R+0]<<0|C[R+1]<<8|C[R+2]<<16)>>>0}function g(C,R){return(C[R+0]<<0|C[R+1]<<8|C[R+2]<<16|C[R+3]<<24)>>>0}new c;var m=[0],d=[0],y=[],x=new c,b=e,N=function(C,R){var G={},j=0,T=!1,B=0,M=0;if(G.frames=[],!function(L,P,O,X){for(var ce=0;ce<X;ce++)if(L[P+ce]!=O.charCodeAt(ce))return!0;return!1}(C,R,"RIFF",4)){var le,J;for(g(C,R+=4),R+=8;R<C.length;){var z=h(C,R),ae=g(C,R+=4);R+=4;var te=ae+(1&ae);switch(z){case"VP8 ":case"VP8L":G.frames[j]===void 0&&(G.frames[j]={}),(_=G.frames[j]).src_off=T?M:R-8,_.src_size=B+ae+8,j++,T&&(T=!1,B=0,M=0);break;case"VP8X":(_=G.header={}).feature_flags=C[R];var de=R+4;_.canvas_width=1+u(C,de),de+=3,_.canvas_height=1+u(C,de),de+=3;break;case"ALPH":T=!0,B=te+8,M=R-8;break;case"ANIM":(_=G.header).bgcolor=g(C,R),de=R+4,_.loop_count=(le=C)[(J=de)+0]<<0|le[J+1]<<8,de+=2;break;case"ANMF":var xe,_;(_=G.frames[j]={}).offset_x=2*u(C,R),R+=3,_.offset_y=2*u(C,R),R+=3,_.width=1+u(C,R),R+=3,_.height=1+u(C,R),R+=3,_.duration=u(C,R),R+=3,xe=C[R++],_.dispose=1&xe,_.blend=xe>>1&1}z!="ANMF"&&(R+=te)}return G}}(b,0);N.response=b,N.rgbaoutput=!0,N.dataurl=!1;var w=N.header?N.header:null,A=N.frames?N.frames:null;if(w){w.loop_counter=w.loop_count,m=[w.canvas_height],d=[w.canvas_width];for(var E=0;E<A.length&&A[E].blend!=0;E++);}var W=A[0],V=x.WebPDecodeRGBA(b,W.src_off,W.src_size,d,m);W.rgba=V,W.imgwidth=d[0],W.imgheight=m[0];for(var F=0;F<d[0]*m[0]*4;F++)y[F]=V[F];return this.width=d,this.height=m,this.data=y,this}(function(e){var r=function(){return typeof C0=="function"},t=function(m,d,y,x){var b=4,N=o;switch(x){case e.image_compression.FAST:b=1,N=i;break;case e.image_compression.MEDIUM:b=6,N=l;break;case e.image_compression.SLOW:b=9,N=c}m=n(m,d,y,N);var w=C0(m,{level:b});return e.__addimage__.arrayBufferToBinaryString(w)},n=function(m,d,y,x){for(var b,N,w,A=m.length/d,E=new Uint8Array(m.length+A),W=u(),V=0;V<A;V+=1){if(w=V*d,b=m.subarray(w,w+d),x)E.set(x(b,y,N),w+V);else{for(var F,C=W.length,R=[];F<C;F+=1)R[F]=W[F](b,y,N);var G=g(R.concat());E.set(R[G],w+V)}N=b}return E},a=function(m){var d=Array.apply([],m);return d.unshift(0),d},i=function(m,d){var y,x=[],b=m.length;x[0]=1;for(var N=0;N<b;N+=1)y=m[N-d]||0,x[N+1]=m[N]-y+256&255;return x},o=function(m,d,y){var x,b=[],N=m.length;b[0]=2;for(var w=0;w<N;w+=1)x=y&&y[w]||0,b[w+1]=m[w]-x+256&255;return b},l=function(m,d,y){var x,b,N=[],w=m.length;N[0]=3;for(var A=0;A<w;A+=1)x=m[A-d]||0,b=y&&y[A]||0,N[A+1]=m[A]+256-(x+b>>>1)&255;return N},c=function(m,d,y){var x,b,N,w,A=[],E=m.length;A[0]=4;for(var W=0;W<E;W+=1)x=m[W-d]||0,b=y&&y[W]||0,N=y&&y[W-d]||0,w=h(x,b,N),A[W+1]=m[W]-w+256&255;return A},h=function(m,d,y){if(m===d&&d===y)return m;var x=Math.abs(d-y),b=Math.abs(m-y),N=Math.abs(m+d-y-y);return x<=b&&x<=N?m:b<=N?d:y},u=function(){return[a,i,o,l,c]},g=function(m){var d=m.map(function(y){return y.reduce(function(x,b){return x+Math.abs(b)},0)});return d.indexOf(Math.min.apply(null,d))};e.processPNG=function(m,d,y,x){var b,N,w,A,E,W,V,F,C,R,G,j,T,B,M,le=this.decode.FLATE_DECODE,J="";if(this.__addimage__.isArrayBuffer(m)&&(m=new Uint8Array(m)),this.__addimage__.isArrayBufferView(m)){if(m=(w=new Lp(m)).imgData,N=w.bits,b=w.colorSpace,E=w.colors,[4,6].indexOf(w.colorType)!==-1){if(w.bits===8){C=(F=w.pixelBitlength==32?new Uint32Array(w.decodePixels().buffer):w.pixelBitlength==16?new Uint16Array(w.decodePixels().buffer):new Uint8Array(w.decodePixels().buffer)).length,G=new Uint8Array(C*w.colors),R=new Uint8Array(C);var z,ae=w.pixelBitlength-w.bits;for(B=0,M=0;B<C;B++){for(T=F[B],z=0;z<ae;)G[M++]=T>>>z&255,z+=w.bits;R[B]=T>>>z&255}}if(w.bits===16){C=(F=new Uint32Array(w.decodePixels().buffer)).length,G=new Uint8Array(C*(32/w.pixelBitlength)*w.colors),R=new Uint8Array(C*(32/w.pixelBitlength)),j=w.colors>1,B=0,M=0;for(var te=0;B<C;)T=F[B++],G[M++]=T>>>0&255,j&&(G[M++]=T>>>16&255,T=F[B++],G[M++]=T>>>0&255),R[te++]=T>>>16&255;N=8}x!==e.image_compression.NONE&&r()?(m=t(G,w.width*w.colors,w.colors,x),V=t(R,w.width,1,x)):(m=G,V=R,le=void 0)}if(w.colorType===3&&(b=this.color_spaces.INDEXED,W=w.palette,w.transparency.indexed)){var de=w.transparency.indexed,xe=0;for(B=0,C=de.length;B<C;++B)xe+=de[B];if((xe/=255)===C-1&&de.indexOf(0)!==-1)A=[de.indexOf(0)];else if(xe!==C){for(F=w.decodePixels(),R=new Uint8Array(F.length),B=0,C=F.length;B<C;B++)R[B]=de[F[B]];V=t(R,w.width,1)}}var _=function(L){var P;switch(L){case e.image_compression.FAST:P=11;break;case e.image_compression.MEDIUM:P=13;break;case e.image_compression.SLOW:P=14;break;default:P=12}return P}(x);return le===this.decode.FLATE_DECODE&&(J="/Predictor "+_+" "),J+="/Colors "+E+" /BitsPerComponent "+N+" /Columns "+w.width,(this.__addimage__.isArrayBuffer(m)||this.__addimage__.isArrayBufferView(m))&&(m=this.__addimage__.arrayBufferToBinaryString(m)),(V&&this.__addimage__.isArrayBuffer(V)||this.__addimage__.isArrayBufferView(V))&&(V=this.__addimage__.arrayBufferToBinaryString(V)),{alias:y,data:m,index:d,filter:le,decodeParameters:J,transparency:A,palette:W,sMask:V,predictor:_,width:w.width,height:w.height,bitsPerComponent:N,colorSpace:b}}}})(ht.API),function(e){e.processGIF89A=function(r,t,n,a){var i=new Cp(r),o=i.width,l=i.height,c=[];i.decodeAndBlitFrameRGBA(0,c);var h={data:c,width:o,height:l},u=new p0(100).encode(h,100);return e.processJPEG.call(this,u,t,n,a)},e.processGIF87A=e.processGIF89A}(ht.API),sa.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var r=0;r<e;r++){var t=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[r]={red:a,green:n,blue:t,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},sa.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,r=this.width*this.height*4;this.data=new Uint8Array(r),this[e]()}catch(t){er.log("bit decode error:"+t)}},sa.prototype.bit1=function(){var e,r=Math.ceil(this.width/8),t=r%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,a=0;a<r;a++)for(var i=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*a*4,l=0;l<8&&8*a+l<this.width;l++){var c=this.palette[i>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}t!==0&&(this.pos+=4-t)}},sa.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),r=e%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,a=0;a<e;a++){var i=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*a*4,l=i>>4,c=15&i,h=this.palette[l];if(this.data[o]=h.blue,this.data[o+1]=h.green,this.data[o+2]=h.red,this.data[o+3]=255,2*a+1>=this.width)break;h=this.palette[c],this.data[o+4]=h.blue,this.data[o+4+1]=h.green,this.data[o+4+2]=h.red,this.data[o+4+3]=255}r!==0&&(this.pos+=4-r)}},sa.prototype.bit8=function(){for(var e=this.width%4,r=this.height-1;r>=0;r--){for(var t=this.bottom_up?r:this.height-1-r,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),i=t*this.width*4+4*n;if(a<this.palette.length){var o=this.palette[a];this.data[i]=o.red,this.data[i+1]=o.green,this.data[i+2]=o.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}e!==0&&(this.pos+=4-e)}},sa.prototype.bit15=function(){for(var e=this.width%3,r=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,a=0;a<this.width;a++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&r)/r*255|0,l=(i>>5&r)/r*255|0,c=(i>>10&r)/r*255|0,h=i>>15?255:0,u=n*this.width*4+4*a;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=o,this.data[u+3]=h}this.pos+=e}},sa.prototype.bit16=function(){for(var e=this.width%3,r=parseInt("11111",2),t=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&r)/r*255|0,c=(o>>5&t)/t*255|0,h=(o>>11)/r*255|0,u=a*this.width*4+4*i;this.data[u]=h,this.data[u+1]=c,this.data[u+2]=l,this.data[u+3]=255}this.pos+=e}},sa.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+4*t;this.data[o]=i,this.data[o+1]=a,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},sa.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var r=this.bottom_up?e:this.height-1-e,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=r*this.width*4+4*t;this.data[l]=i,this.data[l+1]=a,this.data[l+2]=n,this.data[l+3]=o}},sa.prototype.getData=function(){return this.data},function(e){e.processBMP=function(r,t,n,a){var i=new sa(r,!1),o=i.width,l=i.height,c={data:i.getData(),width:o,height:l},h=new p0(100).encode(c,100);return e.processJPEG.call(this,h,t,n,a)}}(ht.API),uh.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(r,t,n,a){var i=new uh(r),o=i.width,l=i.height,c={data:i.getData(),width:o,height:l},h=new p0(100).encode(c,100);return e.processJPEG.call(this,h,t,n,a)}}(ht.API),ht.API.processRGBA=function(e,r,t){for(var n=e.data,a=n.length,i=new Uint8Array(a/4*3),o=new Uint8Array(a/4),l=0,c=0,h=0;h<a;h+=4){var u=n[h],g=n[h+1],m=n[h+2],d=n[h+3];i[l++]=u,i[l++]=g,i[l++]=m,o[c++]=d}var y=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:y,index:r,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},ht.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},vs=ht.API,Ml=vs.getCharWidthsArray=function(e,r){var t,n,a=(r=r||{}).font||this.internal.getFont(),i=r.fontSize||this.internal.getFontSize(),o=r.charSpace||this.internal.getCharSpace(),l=r.widths?r.widths:a.metadata.Unicode.widths,c=l.fof?l.fof:1,h=r.kerning?r.kerning:a.metadata.Unicode.kerning,u=h.fof?h.fof:1,g=r.doKerning!==!1,m=0,d=e.length,y=0,x=l[0]||c,b=[];for(t=0;t<d;t++)n=e.charCodeAt(t),typeof a.metadata.widthOfString=="function"?b.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(n))+o*(1e3/i)||0)/1e3):(m=g&&tr(h[n])==="object"&&!isNaN(parseInt(h[n][y],10))?h[n][y]/u:0,b.push((l[n]||x)/c+m)),y=n;return b},lh=vs.getStringUnitWidth=function(e,r){var t=(r=r||{}).fontSize||this.internal.getFontSize(),n=r.font||this.internal.getFont(),a=r.charSpace||this.internal.getCharSpace();return vs.processArabic&&(e=vs.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,t,a)/t:Ml.apply(this,arguments).reduce(function(i,o){return i+o},0)},ch=function(e,r,t,n){for(var a=[],i=0,o=e.length,l=0;i!==o&&l+r[i]<t;)l+=r[i],i++;a.push(e.slice(0,i));var c=i;for(l=0;i!==o;)l+r[i]>n&&(a.push(e.slice(c,i)),l=0,c=i),l+=r[i],i++;return c!==i&&a.push(e.slice(c,i)),a},fh=function(e,r,t){t||(t={});var n,a,i,o,l,c,h,u=[],g=[u],m=t.textIndent||0,d=0,y=0,x=e.split(" "),b=Ml.apply(this,[" ",t])[0];if(c=t.lineIndent===-1?x[0].length+2:t.lineIndent||0){var N=Array(c).join(" "),w=[];x.map(function(E){(E=E.split(/\s*\n/)).length>1?w=w.concat(E.map(function(W,V){return(V&&W.length?`
`:"")+W})):w.push(E[0])}),x=w,c=lh.apply(this,[N,t])}for(i=0,o=x.length;i<o;i++){var A=0;if(n=x[i],c&&n[0]==`
`&&(n=n.substr(1),A=1),m+d+(y=(a=Ml.apply(this,[n,t])).reduce(function(E,W){return E+W},0))>r||A){if(y>r){for(l=ch.apply(this,[n,a,r-(m+d),r]),u.push(l.shift()),u=[l.pop()];l.length;)g.push([l.shift()]);y=a.slice(n.length-(u[0]?u[0].length:0)).reduce(function(E,W){return E+W},0)}else u=[n];g.push(u),m=y+c,d=b}else u.push(n),m+=d+y,d=b}return h=c?function(E,W){return(W?N:"")+E.join(" ")}:function(E){return E.join(" ")},g.map(h)},vs.splitTextToSize=function(e,r,t){var n,a=(t=t||{}).fontSize||this.internal.getFontSize(),i=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var g=this.internal.getFont(u.fontName,u.fontStyle);return g.metadata.Unicode?{widths:g.metadata.Unicode.widths||{0:1},kerning:g.metadata.Unicode.kerning||{}}:{font:g.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var o=1*this.internal.scaleFactor*r/a;i.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/a:0,i.lineIndent=t.lineIndent;var l,c,h=[];for(l=0,c=n.length;l<c;l++)h=h.concat(fh.apply(this,[n[l],o,i]));return h},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var r="klmnopqrstuvwxyz",t={},n={},a=0;a<r.length;a++)t[r[a]]="0123456789abcdef"[a],n["0123456789abcdef"[a]]=r[a];var i=function(g){return"0x"+parseInt(g,10).toString(16)},o=e.__fontmetrics__.compress=function(g){var m,d,y,x,b=["{"];for(var N in g){if(m=g[N],isNaN(parseInt(N,10))?d="'"+N+"'":(N=parseInt(N,10),d=(d=i(N).slice(2)).slice(0,-1)+n[d.slice(-1)]),typeof m=="number")m<0?(y=i(m).slice(3),x="-"):(y=i(m).slice(2),x=""),y=x+y.slice(0,-1)+n[y.slice(-1)];else{if(tr(m)!=="object")throw new Error("Don't know what to do with value type "+tr(m)+".");y=o(m)}b.push(d+y)}return b.push("}"),b.join("")},l=e.__fontmetrics__.uncompress=function(g){if(typeof g!="string")throw new Error("Invalid argument passed to uncompress.");for(var m,d,y,x,b={},N=1,w=b,A=[],E="",W="",V=g.length-1,F=1;F<V;F+=1)(x=g[F])=="'"?m?(y=m.join(""),m=void 0):m=[]:m?m.push(x):x=="{"?(A.push([w,y]),w={},y=void 0):x=="}"?((d=A.pop())[0][d[1]]=w,y=void 0,w=d[0]):x=="-"?N=-1:y===void 0?t.hasOwnProperty(x)?(E+=t[x],y=parseInt(E,16)*N,N=1,E=""):E+=x:t.hasOwnProperty(x)?(W+=t[x],w[y]=parseInt(W,16)*N,N=1,y=void 0,W=""):W+=x;return b},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},h={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},u={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(g){var m=g.font,d=u.Unicode[m.postScriptName];d&&(m.metadata.Unicode={},m.metadata.Unicode.widths=d.widths,m.metadata.Unicode.kerning=d.kerning);var y=h.Unicode[m.postScriptName];y&&(m.metadata.Unicode.encoding=y,m.encoding=y.codePages[0])}])}(ht.API),function(e){var r=function(t){for(var n=t.length,a=new Uint8Array(n),i=0;i<n;i++)a[i]=t.charCodeAt(i);return a};e.API.events.push(["addFont",function(t){var n=void 0,a=t.font,i=t.instance;if(!a.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(n=i.existsFileInVFS(a.postScriptName)===!1?i.loadFile(a.postScriptName):i.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?r(l):r(yo(l)),o.metadata=e.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(a,n)}}])}(ht),function(e){function r(){return(mt.canvg?Promise.resolve(mt.canvg):T0(()=>import("./index.es-lLa2plLs.js"),__vite__mapDeps([0,1,2,3]))).catch(function(t){return Promise.reject(new Error("Could not load canvg: "+t))}).then(function(t){return t.default?t.default:t})}ht.API.addSvgAsImage=function(t,n,a,i,o,l,c,h){if(isNaN(n)||isNaN(a))throw er.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(o))throw er.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=i,u.height=o;var g=u.getContext("2d");g.fillStyle="#fff",g.fillRect(0,0,u.width,u.height);var m={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},d=this;return r().then(function(y){return y.fromString(g,t,m)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(y){return y.render(m)}).then(function(){d.addImage(u.toDataURL("image/jpeg",1),n,a,i,o,c,h)})}}(),ht.API.putTotalPages=function(e){var r,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(r=new RegExp(e,"g"),t=this.internal.getNumberOfPages()):(r=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(r,t);return this},ht.API.viewerPreferences=function(e,r){var t;e=e||{},r=r||!1;var n,a,i,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],h=0,u=0,g=0;function m(y,x){var b,N=!1;for(b=0;b<y.length;b+=1)y[b]===x&&(N=!0);return N}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,e==="reset"||r===!0){var d=l.length;for(g=0;g<d;g+=1)t[l[g]].value=t[l[g]].defaultValue,t[l[g]].explicitSet=!1}if(tr(e)==="object"){for(a in e)if(i=e[a],m(l,a)&&i!==void 0){if(t[a].type==="boolean"&&typeof i=="boolean")t[a].value=i;else if(t[a].type==="name"&&m(t[a].valueSet,i))t[a].value=i;else if(t[a].type==="integer"&&Number.isInteger(i))t[a].value=i;else if(t[a].type==="array"){for(h=0;h<i.length;h+=1)if(n=!0,i[h].length===1&&typeof i[h][0]=="number")c.push(String(i[h]-1));else if(i[h].length>1){for(u=0;u<i[h].length;u+=1)typeof i[h][u]!="number"&&(n=!1);n===!0&&c.push([i[h][0]-1,i[h][1]-1].join(" "))}t[a].value="["+c.join(" ")+"]"}else t[a].value=t[a].defaultValue;t[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var y,x=[];for(y in t)t[y].explicitSet===!0&&(t[y].type==="name"?x.push("/"+y+" /"+t[y].value):x.push("/"+y+" "+t[y].value));x.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+x.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},function(e){var r=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(n)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),h=i.length+o.length+l.length+a.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+h+" >>"),this.internal.write("stream"),this.internal.write(a+i+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,a){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",r)),this}}(ht.API),function(e){var r=e.API,t=r.pdfEscape16=function(i,o){for(var l,c=o.metadata.Unicode.widths,h=["","0","00","000","0000"],u=[""],g=0,m=i.length;g<m;++g){if(l=o.metadata.characterToGlyph(i.charCodeAt(g)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=i.charCodeAt(g),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return u.join("");l=l.toString(16),u.push(h[4-l.length],l)}return u.join("")},n=function(i){var o,l,c,h,u,g,m;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],g=0,m=(l=Object.keys(i).sort(function(d,y){return d-y})).length;g<m;g++)o=l[g],c.length>=100&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),i[o]!==void 0&&i[o]!==null&&typeof i[o].toString=="function"&&(h=("0000"+i[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+h+">"));return c.length&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),u+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};r.events.push(["putFont",function(i){(function(o){var l=o.font,c=o.out,h=o.newObject,u=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="Identity-H"){for(var g=l.metadata.Unicode.widths,m=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),d="",y=0;y<m.length;y++)d+=String.fromCharCode(m[y]);var x=h();u({data:d,addLength1:!0,objectId:x}),c("endobj");var b=h();u({data:n(l.metadata.toUnicode),addLength1:!0,objectId:b}),c("endobj");var N=h();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+_s(l.fontName)),c("/FontFile2 "+x+" 0 R"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var w=h();c("<<"),c("/Type /Font"),c("/BaseFont /"+_s(l.fontName)),c("/FontDescriptor "+N+" 0 R"),c("/W "+e.API.PDFObject.convert(g)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=h(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+b+" 0 R"),c("/BaseFont /"+_s(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+w+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]),r.events.push(["putFont",function(i){(function(o){var l=o.font,c=o.out,h=o.newObject,u=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var g=l.metadata.rawData,m="",d=0;d<g.length;d++)m+=String.fromCharCode(g[d]);var y=h();u({data:m,addLength1:!0,objectId:y}),c("endobj");var x=h();u({data:n(l.metadata.toUnicode),addLength1:!0,objectId:x}),c("endobj");var b=h();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+y+" 0 R"),c("/Flags 96"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+_s(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=h();for(var N=0;N<l.metadata.hmtx.widths.length;N++)l.metadata.hmtx.widths[N]=parseInt(l.metadata.hmtx.widths[N]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+x+" 0 R/BaseFont/"+_s(l.fontName)+"/FontDescriptor "+b+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]);var a=function(i){var o,l=i.text||"",c=i.x,h=i.y,u=i.options||{},g=i.mutex||{},m=g.pdfEscape,d=g.activeFontKey,y=g.fonts,x=d,b="",N=0,w="",A=y[x].encoding;if(y[x].encoding!=="Identity-H")return{text:l,x:c,y:h,options:u,mutex:g};for(w=l,x=d,Array.isArray(l)&&(w=l[0]),N=0;N<w.length;N+=1)y[x].metadata.hasOwnProperty("cmap")&&(o=y[x].metadata.cmap.unicode.codeMap[w[N].charCodeAt(0)]),o||w[N].charCodeAt(0)<256&&y[x].metadata.hasOwnProperty("Unicode")?b+=w[N]:b+="";var E="";return parseInt(x.slice(1))<14||A==="WinAnsiEncoding"?E=m(b,x).split("").map(function(W){return W.charCodeAt(0).toString(16)}).join(""):A==="Identity-H"&&(E=t(b,y[x])),g.isHex=!0,{text:E,x:c,y:h,options:u,mutex:g}};r.events.push(["postProcessText",function(i){var o=i.text||"",l=[],c={text:o,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(o)){var h=0;for(h=0;h<o.length;h+=1)Array.isArray(o[h])&&o[h].length===3?l.push([a(Object.assign({},c,{text:o[h][0]})).text,o[h][1],o[h][2]]):l.push(a(Object.assign({},c,{text:o[h]})).text);i.text=l}else i.text=a(Object.assign({},c,{text:o})).text}])}(ht),function(e){var r=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(t){return r.call(this),this.internal.vFS[t]!==void 0},e.addFileToVFS=function(t,n){return r.call(this),this.internal.vFS[t]=n,this},e.getFileFromVFS=function(t){return r.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}}(ht.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var a,i,o,l,c,h,u,g=r,m=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],d=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],y={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},x={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},b=["(",")","(","<",">","<","[","]","[","{","}","{","Â«","Â»","Â«","â€¹","â€º","â€¹","â…","â†","â…","â½","â¾","â½","â‚","â‚Ž","â‚","â‰¤","â‰¥","â‰¤","âŒ©","âŒª","âŒ©","ï¹™","ï¹š","ï¹™","ï¹›","ï¹œ","ï¹›","ï¹","ï¹ž","ï¹","ï¹¤","ï¹¥","ï¹¤"],N=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),w=!1,A=0;this.__bidiEngine__={};var E=function(j){var T=j.charCodeAt(),B=T>>8,M=x[B];return M!==void 0?g[256*M+(255&T)]:B===252||B===253?"AL":N.test(B)?"L":B===8?"R":"N"},W=function(j){for(var T,B=0;B<j.length;B++){if((T=E(j.charAt(B)))==="L")return!1;if(T==="R")return!0}return!1},V=function(j,T,B,M){var le,J,z,ae,te=T[M];switch(te){case"L":case"R":w=!1;break;case"N":case"AN":break;case"EN":w&&(te="AN");break;case"AL":w=!0,te="R";break;case"WS":te="N";break;case"CS":M<1||M+1>=T.length||(le=B[M-1])!=="EN"&&le!=="AN"||(J=T[M+1])!=="EN"&&J!=="AN"?te="N":w&&(J="AN"),te=J===le?J:"N";break;case"ES":te=(le=M>0?B[M-1]:"B")==="EN"&&M+1<T.length&&T[M+1]==="EN"?"EN":"N";break;case"ET":if(M>0&&B[M-1]==="EN"){te="EN";break}if(w){te="N";break}for(z=M+1,ae=T.length;z<ae&&T[z]==="ET";)z++;te=z<ae&&T[z]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(ae=T.length,z=M+1;z<ae&&T[z]==="NSM";)z++;if(z<ae){var de=j[M],xe=de>=1425&&de<=2303||de===64286;if(le=T[z],xe&&(le==="R"||le==="AL")){te="R";break}}}te=M<1||(le=T[M-1])==="B"?"N":B[M-1];break;case"B":w=!1,a=!0,te=A;break;case"S":i=!0,te="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":w=!1;break;case"BN":te="N"}return te},F=function(j,T,B){var M=j.split("");return B&&C(M,B,{hiLevel:A}),M.reverse(),T&&T.reverse(),M.join("")},C=function(j,T,B){var M,le,J,z,ae,te=-1,de=j.length,xe=0,_=[],L=A?d:m,P=[];for(w=!1,a=!1,i=!1,le=0;le<de;le++)P[le]=E(j[le]);for(J=0;J<de;J++){if(ae=xe,_[J]=V(j,P,_,J),M=240&(xe=L[ae][y[_[J]]]),xe&=15,T[J]=z=L[xe][5],M>0)if(M===16){for(le=te;le<J;le++)T[le]=1;te=-1}else te=-1;if(L[xe][6])te===-1&&(te=J);else if(te>-1){for(le=te;le<J;le++)T[le]=z;te=-1}P[J]==="B"&&(T[J]=0),B.hiLevel|=z}i&&function(O,X,ce){for(var fe=0;fe<ce;fe++)if(O[fe]==="S"){X[fe]=A;for(var he=fe-1;he>=0&&O[he]==="WS";he--)X[he]=A}}(P,T,de)},R=function(j,T,B,M,le){if(!(le.hiLevel<j)){if(j===1&&A===1&&!a)return T.reverse(),void(B&&B.reverse());for(var J,z,ae,te,de=T.length,xe=0;xe<de;){if(M[xe]>=j){for(ae=xe+1;ae<de&&M[ae]>=j;)ae++;for(te=xe,z=ae-1;te<z;te++,z--)J=T[te],T[te]=T[z],T[z]=J,B&&(J=B[te],B[te]=B[z],B[z]=J);xe=ae}xe++}}},G=function(j,T,B){var M=j.split(""),le={hiLevel:A};return B||(B=[]),C(M,B,le),function(J,z,ae){if(ae.hiLevel!==0&&u)for(var te,de=0;de<J.length;de++)z[de]===1&&(te=b.indexOf(J[de]))>=0&&(J[de]=b[te+1])}(M,B,le),R(2,M,T,B,le),R(1,M,T,B,le),M.join("")};return this.__bidiEngine__.doBidiReorder=function(j,T,B){if(function(le,J){if(J)for(var z=0;z<le.length;z++)J[z]=z;l===void 0&&(l=W(le)),h===void 0&&(h=W(le))}(j,T),o||!c||h)if(o&&c&&l^h)A=l?1:0,j=F(j,T,B);else if(!o&&c&&h)A=l?1:0,j=G(j,T,B),j=F(j,T);else if(!o||l||c||h){if(o&&!c&&l^h)j=F(j,T),l?(A=0,j=G(j,T,B)):(A=1,j=G(j,T,B),j=F(j,T));else if(o&&l&&!c&&h)A=1,j=G(j,T,B),j=F(j,T);else if(!o&&!c&&l^h){var M=u;l?(A=1,j=G(j,T,B),A=0,u=!1,j=G(j,T,B),u=M):(A=0,j=G(j,T,B),j=F(j,T),A=1,u=!1,j=G(j,T,B),u=M,j=F(j,T))}}else A=0,j=G(j,T,B);else A=l?1:0,j=G(j,T,B);return j},this.__bidiEngine__.setOptions=function(j){j&&(o=j.isInputVisual,c=j.isOutputVisual,l=j.isInputRtl,h=j.isOutputRtl,u=j.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var r=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var a=n.text,i=(n.x,n.y,n.options||{}),o=(n.mutex,i.lang,[]);if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,t.setOptions(i),Object.prototype.toString.call(a)==="[object Array]"){var l=0;for(o=[],l=0;l<a.length;l+=1)Object.prototype.toString.call(a[l])==="[object Array]"?o.push([t.doBidiReorder(a[l][0]),a[l][1],a[l][2]]):o.push([t.doBidiReorder(a[l])]);n.text=o}else n.text=t.doBidiReorder(a);t.setOptions({isInputVisual:!0})}])}(ht),ht.API.TTFFont=function(){function e(r){var t;if(this.rawData=r,t=this.contents=new xi(r),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new $p(this),this.registerTTF()}return e.open=function(r){return new e(r)},e.prototype.parse=function(){return this.directory=new Pp(this.contents),this.head=new Ip(this),this.name=new Up(this),this.cmap=new ku(this),this.toUnicode={},this.hhea=new Dp(this),this.maxp=new Hp(this),this.hmtx=new Wp(this),this.post=new Mp(this),this.os2=new Rp(this),this.loca=new Gp(this),this.glyf=new qp(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var r,t,n,a,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,h;for(h=[],o=0,l=(c=this.bbox).length;o<l;o++)r=c[o],h.push(Math.round(r*this.scaleFactor));return h}).call(this),this.stemV=0,this.post.exists?(n=255&(a=this.post.italic_angle),32768&(t=a>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(r){var t;return((t=this.cmap.unicode)!=null?t.codeMap[r]:void 0)||0},e.prototype.widthOfGlyph=function(r){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(r).advance*t},e.prototype.widthOfString=function(r,t,n){var a,i,o,l;for(o=0,i=0,l=(r=""+r).length;0<=l?i<l:i>l;i=0<=l?++i:--i)a=r.charCodeAt(i),o+=this.widthOfGlyph(this.characterToGlyph(a))+n*(1e3/t)||0;return o*(t/1e3)},e.prototype.lineHeight=function(r,t){var n;return t==null&&(t=!1),n=t?this.lineGap:0,(this.ascender+n-this.decender)/1e3*r},e}();var pa,xi=function(){function e(r){this.data=r??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(r){return this.data[this.pos++]=r},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(r){return this.writeByte(r>>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},e.prototype.readInt32=function(){var r;return(r=this.readUInt32())>=2147483648?r-4294967296:r},e.prototype.writeInt32=function(r){return r<0&&(r+=4294967296),this.writeUInt32(r)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(r){return this.writeByte(r>>8&255),this.writeByte(255&r)},e.prototype.readInt16=function(){var r;return(r=this.readUInt16())>=32768?r-65536:r},e.prototype.writeInt16=function(r){return r<0&&(r+=65536),this.writeUInt16(r)},e.prototype.readString=function(r){var t,n;for(n=[],t=0;0<=r?t<r:t>r;t=0<=r?++t:--t)n[t]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(r){var t,n,a;for(a=[],t=0,n=r.length;0<=n?t<n:t>n;t=0<=n?++t:--t)a.push(this.writeByte(r.charCodeAt(t)));return a},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(r){return this.writeInt16(r)},e.prototype.readLongLong=function(){var r,t,n,a,i,o,l,c;return r=this.readByte(),t=this.readByte(),n=this.readByte(),a=this.readByte(),i=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&r?-1*(72057594037927940*(255^r)+281474976710656*(255^t)+1099511627776*(255^n)+4294967296*(255^a)+16777216*(255^i)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*r+281474976710656*t+1099511627776*n+4294967296*a+16777216*i+65536*o+256*l+c},e.prototype.writeLongLong=function(r){var t,n;return t=Math.floor(r/4294967296),n=4294967295&r,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(r){return this.writeInt32(r)},e.prototype.read=function(r){var t,n;for(t=[],n=0;0<=r?n<r:n>r;n=0<=r?++n:--n)t.push(this.readByte());return t},e.prototype.write=function(r){var t,n,a,i;for(i=[],n=0,a=r.length;n<a;n++)t=r[n],i.push(this.writeByte(t));return i},e}(),Pp=function(){var e;function r(t){var n,a,i;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},a=0,i=this.tableCount;0<=i?a<i:a>i;a=0<=i?++a:--a)n={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[n.tag]=n}return r.prototype.encode=function(t){var n,a,i,o,l,c,h,u,g,m,d,y,x;for(x in d=Object.keys(t).length,c=Math.log(2),g=16*Math.floor(Math.log(d)/c),o=Math.floor(g/c),u=16*d-g,(a=new xi).writeInt(this.scalarType),a.writeShort(d),a.writeShort(g),a.writeShort(o),a.writeShort(u),i=16*d,h=a.pos+i,l=null,y=[],t)for(m=t[x],a.writeString(x),a.writeInt(e(m)),a.writeInt(h),a.writeInt(m.length),y=y.concat(m),x==="head"&&(l=h),h+=m.length;h%4;)y.push(0),h++;return a.write(y),n=2981146554-e(a.data),a.pos=l+8,a.writeUInt32(n),a.data},e=function(t){var n,a,i,o;for(t=Eu.call(t);t.length%4;)t.push(0);for(i=new xi(t),a=0,n=0,o=t.length;n<o;n=n+=4)a+=i.readUInt32();return 4294967295&a},r}(),Op={}.hasOwnProperty,ka=function(e,r){for(var t in r)Op.call(r,t)&&(e[t]=r[t]);function n(){this.constructor=e}return n.prototype=r.prototype,e.prototype=new n,e.__super__=r.prototype,e};pa=function(){function e(r){var t;this.file=r,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var Ip=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return ka(r,pa),r.prototype.tag="head",r.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},r.prototype.encode=function(t){var n;return(n=new xi).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(t),n.writeShort(this.glyphDataFormat),n.data},r}(),dh=function(){function e(r,t){var n,a,i,o,l,c,h,u,g,m,d,y,x,b,N,w,A;switch(this.platformID=r.readUInt16(),this.encodingID=r.readShort(),this.offset=t+r.readInt(),g=r.pos,r.pos=this.offset,this.format=r.readUInt16(),this.length=r.readUInt16(),this.language=r.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=r.readByte();break;case 4:for(d=r.readUInt16(),m=d/2,r.pos+=6,i=function(){var E,W;for(W=[],c=E=0;0<=m?E<m:E>m;c=0<=m?++E:--E)W.push(r.readUInt16());return W}(),r.pos+=2,x=function(){var E,W;for(W=[],c=E=0;0<=m?E<m:E>m;c=0<=m?++E:--E)W.push(r.readUInt16());return W}(),h=function(){var E,W;for(W=[],c=E=0;0<=m?E<m:E>m;c=0<=m?++E:--E)W.push(r.readUInt16());return W}(),u=function(){var E,W;for(W=[],c=E=0;0<=m?E<m:E>m;c=0<=m?++E:--E)W.push(r.readUInt16());return W}(),a=(this.length-r.pos+this.offset)/2,l=function(){var E,W;for(W=[],c=E=0;0<=a?E<a:E>a;c=0<=a?++E:--E)W.push(r.readUInt16());return W}(),c=N=0,A=i.length;N<A;c=++N)for(b=i[c],n=w=y=x[c];y<=b?w<=b:w>=b;n=y<=b?++w:--w)u[c]===0?o=n+h[c]:(o=l[u[c]/2+(n-y)-(m-c)]||0)!==0&&(o+=h[c]),this.codeMap[n]=65535&o}r.pos=g}return e.encode=function(r,t){var n,a,i,o,l,c,h,u,g,m,d,y,x,b,N,w,A,E,W,V,F,C,R,G,j,T,B,M,le,J,z,ae,te,de,xe,_,L,P,O,X,ce,fe,he,we,Pe,Re;switch(M=new xi,o=Object.keys(r).sort(function(ze,Ke){return ze-Ke}),t){case"macroman":for(x=0,b=function(){var ze=[];for(y=0;y<256;++y)ze.push(0);return ze}(),w={0:0},i={},le=0,te=o.length;le<te;le++)w[he=r[a=o[le]]]==null&&(w[he]=++x),i[a]={old:r[a],new:w[r[a]]},b[a]=w[r[a]];return M.writeUInt16(1),M.writeUInt16(0),M.writeUInt32(12),M.writeUInt16(0),M.writeUInt16(262),M.writeUInt16(0),M.write(b),{charMap:i,subtable:M.data,maxGlyphID:x+1};case"unicode":for(T=[],g=[],A=0,w={},n={},N=h=null,J=0,de=o.length;J<de;J++)w[W=r[a=o[J]]]==null&&(w[W]=++A),n[a]={old:W,new:w[W]},l=w[W]-a,N!=null&&l===h||(N&&g.push(N),T.push(a),h=l),N=a;for(N&&g.push(N),g.push(65535),T.push(65535),G=2*(R=T.length),C=2*Math.pow(Math.log(R)/Math.LN2,2),m=Math.log(C/2)/Math.LN2,F=2*R-C,c=[],V=[],d=[],y=z=0,xe=T.length;z<xe;y=++z){if(j=T[y],u=g[y],j===65535){c.push(0),V.push(0);break}if(j-(B=n[j].new)>=32768)for(c.push(0),V.push(2*(d.length+R-y)),a=ae=j;j<=u?ae<=u:ae>=u;a=j<=u?++ae:--ae)d.push(n[a].new);else c.push(B-j),V.push(0)}for(M.writeUInt16(3),M.writeUInt16(1),M.writeUInt32(12),M.writeUInt16(4),M.writeUInt16(16+8*R+2*d.length),M.writeUInt16(0),M.writeUInt16(G),M.writeUInt16(C),M.writeUInt16(m),M.writeUInt16(F),ce=0,_=g.length;ce<_;ce++)a=g[ce],M.writeUInt16(a);for(M.writeUInt16(0),fe=0,L=T.length;fe<L;fe++)a=T[fe],M.writeUInt16(a);for(we=0,P=c.length;we<P;we++)l=c[we],M.writeUInt16(l);for(Pe=0,O=V.length;Pe<O;Pe++)E=V[Pe],M.writeUInt16(E);for(Re=0,X=d.length;Re<X;Re++)x=d[Re],M.writeUInt16(x);return{charMap:n,subtable:M.data,maxGlyphID:A+1}}},e}(),ku=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return ka(r,pa),r.prototype.tag="cmap",r.prototype.parse=function(t){var n,a,i;for(t.pos=this.offset,this.version=t.readUInt16(),i=t.readUInt16(),this.tables=[],this.unicode=null,a=0;0<=i?a<i:a>i;a=0<=i?++a:--a)n=new dh(t,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},r.encode=function(t,n){var a,i;return n==null&&(n="macroman"),a=dh.encode(t,n),(i=new xi).writeUInt16(0),i.writeUInt16(1),a.table=i.data.concat(a.subtable),a},r}(),Dp=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return ka(r,pa),r.prototype.tag="hhea",r.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},r}(),Rp=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return ka(r,pa),r.prototype.tag="OS/2",r.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var n,a;for(a=[],n=0;n<10;++n)a.push(t.readByte());return a}(),this.charRange=function(){var n,a;for(a=[],n=0;n<4;++n)a.push(t.readInt());return a}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var n,a;for(a=[],n=0;n<2;n=++n)a.push(t.readInt());return a}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},r}(),Mp=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return ka(r,pa),r.prototype.tag="post",r.prototype.parse=function(t){var n,a,i;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:break;case 131072:var o;for(a=t.readUInt16(),this.glyphNameIndex=[],o=0;0<=a?o<a:o>a;o=0<=a?++o:--o)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],i=[];t.pos<this.offset+this.length;)n=t.readByte(),i.push(this.names.push(t.readString(n)));return i;case 151552:return a=t.readUInt16(),this.offsets=t.read(a);case 196608:break;case 262144:return this.map=(function(){var l,c,h;for(h=[],o=l=0,c=this.file.maxp.numGlyphs;0<=c?l<c:l>c;o=0<=c?++l:--l)h.push(t.readUInt32());return h}).call(this)}},r}(),Bp=function(e,r){this.raw=e,this.length=e.length,this.platformID=r.platformID,this.encodingID=r.encodingID,this.languageID=r.languageID},Up=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return ka(r,pa),r.prototype.tag="name",r.prototype.parse=function(t){var n,a,i,o,l,c,h,u,g,m,d;for(t.pos=this.offset,t.readShort(),n=t.readShort(),c=t.readShort(),a=[],o=0;0<=n?o<n:o>n;o=0<=n?++o:--o)a.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+c+t.readShort()});for(h={},o=g=0,m=a.length;g<m;o=++g)i=a[o],t.pos=i.offset,u=t.readString(i.length),l=new Bp(u,i),h[d=i.nameID]==null&&(h[d]=[]),h[i.nameID].push(l);this.strings=h,this.copyright=h[0],this.fontFamily=h[1],this.fontSubfamily=h[2],this.uniqueSubfamily=h[3],this.fontName=h[4],this.version=h[5];try{this.postscriptName=h[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=h[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=h[7],this.manufacturer=h[8],this.designer=h[9],this.description=h[10],this.vendorUrl=h[11],this.designerUrl=h[12],this.license=h[13],this.licenseUrl=h[14],this.preferredFamily=h[15],this.preferredSubfamily=h[17],this.compatibleFull=h[18],this.sampleText=h[19]},r}(),Hp=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return ka(r,pa),r.prototype.tag="maxp",r.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},r}(),Wp=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return ka(r,pa),r.prototype.tag="hmtx",r.prototype.parse=function(t){var n,a,i,o,l,c,h;for(t.pos=this.offset,this.metrics=[],n=0,c=this.file.hhea.numberOfMetrics;0<=c?n<c:n>c;n=0<=c?++n:--n)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,g;for(g=[],n=u=0;0<=i?u<i:u>i;n=0<=i?++u:--u)g.push(t.readInt16());return g}(),this.widths=(function(){var u,g,m,d;for(d=[],u=0,g=(m=this.metrics).length;u<g;u++)o=m[u],d.push(o.advance);return d}).call(this),a=this.widths[this.widths.length-1],h=[],n=l=0;0<=i?l<i:l>i;n=0<=i?++l:--l)h.push(this.widths.push(a));return h},r.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},r}(),Eu=[].slice,qp=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return ka(r,pa),r.prototype.tag="glyf",r.prototype.parse=function(){return this.cache={}},r.prototype.glyphFor=function(t){var n,a,i,o,l,c,h,u,g,m;return t in this.cache?this.cache[t]:(o=this.file.loca,n=this.file.contents,a=o.indexOf(t),(i=o.lengthOf(t))===0?this.cache[t]=null:(n.pos=this.offset+a,l=(c=new xi(n.read(i))).readShort(),u=c.readShort(),m=c.readShort(),h=c.readShort(),g=c.readShort(),this.cache[t]=l===-1?new Vp(c,u,m,h,g):new zp(c,l,u,m,h,g),this.cache[t]))},r.prototype.encode=function(t,n,a){var i,o,l,c,h;for(l=[],o=[],c=0,h=n.length;c<h;c++)i=t[n[c]],o.push(l.length),i&&(l=l.concat(i.encode(a)));return o.push(l.length),{table:l,offsets:o}},r}(),zp=function(){function e(r,t,n,a,i,o){this.raw=r,this.numberOfContours=t,this.xMin=n,this.yMin=a,this.xMax=i,this.yMax=o,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),Vp=function(){function e(r,t,n,a,i){var o,l;for(this.raw=r,this.xMin=t,this.yMin=n,this.xMax=a,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return e.prototype.encode=function(){var r,t,n;for(t=new xi(Eu.call(this.raw.data)),r=0,n=this.glyphIDs.length;r<n;++r)t.pos=this.glyphOffsets[r];return t.data},e}(),Gp=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return ka(r,pa),r.prototype.tag="loca",r.prototype.parse=function(t){var n,a;return t.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var i,o;for(o=[],a=0,i=this.length;a<i;a+=2)o.push(2*t.readUInt16());return o}).call(this):(function(){var i,o;for(o=[],a=0,i=this.length;a<i;a+=4)o.push(t.readUInt32());return o}).call(this)},r.prototype.indexOf=function(t){return this.offsets[t]},r.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},r.prototype.encode=function(t,n){for(var a=new Uint32Array(this.offsets.length),i=0,o=0,l=0;l<a.length;++l)if(a[l]=i,o<n.length&&n[o]==l){++o,a[l]=i;var c=this.offsets[l],h=this.offsets[l+1]-c;h>0&&(i+=h)}for(var u=new Array(4*a.length),g=0;g<a.length;++g)u[4*g+3]=255&a[g],u[4*g+2]=(65280&a[g])>>8,u[4*g+1]=(16711680&a[g])>>16,u[4*g]=(4278190080&a[g])>>24;return u},r}(),$p=function(){function e(r){this.font=r,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var r,t,n,a,i;for(t in a=this.font.cmap.tables[0].codeMap,r={},i=this.subset)n=i[t],r[t]=a[n];return r},e.prototype.glyphsFor=function(r){var t,n,a,i,o,l,c;for(a={},o=0,l=r.length;o<l;o++)a[i=r[o]]=this.font.glyf.glyphFor(i);for(i in t=[],a)(n=a[i])!=null&&n.compound&&t.push.apply(t,n.glyphIDs);if(t.length>0)for(i in c=this.glyphsFor(t))n=c[i],a[i]=n;return a},e.prototype.encode=function(r,t){var n,a,i,o,l,c,h,u,g,m,d,y,x,b,N;for(a in n=ku.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(r),d={0:0},N=n.charMap)d[(c=N[a]).old]=c.new;for(y in m=n.maxGlyphID,o)y in d||(d[y]=m++);return u=function(w){var A,E;for(A in E={},w)E[w[A]]=A;return E}(d),g=Object.keys(u).sort(function(w,A){return w-A}),x=function(){var w,A,E;for(E=[],w=0,A=g.length;w<A;w++)l=g[w],E.push(u[l]);return E}(),i=this.font.glyf.encode(o,x,d),h=this.font.loca.encode(i.offsets,x),b={cmap:this.font.cmap.raw(),glyf:i.table,loca:h,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(b["OS/2"]=this.font.os2.raw()),this.font.directory.encode(b)},e}();ht.API.PDFObject=function(){var e;function r(){}return e=function(t,n){return(Array(n+1).join("0")+t).slice(-n)},r.convert=function(t){var n,a,i,o;if(Array.isArray(t))return"["+function(){var l,c,h;for(h=[],l=0,c=t.length;l<c;l++)n=t[l],h.push(r.convert(n));return h}().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t!=null&&t.isString)return"("+t+")";if(t instanceof Date)return"(D:"+e(t.getUTCFullYear(),4)+e(t.getUTCMonth(),2)+e(t.getUTCDate(),2)+e(t.getUTCHours(),2)+e(t.getUTCMinutes(),2)+e(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(a in i=["<<"],t)o=t[a],i.push("/"+a+" "+r.convert(o));return i.push(">>"),i.join(`
`)}return""+t},r}();const Yp=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:Ap,AcroFormAppearance:ot,AcroFormButton:Or,AcroFormCheckBox:No,AcroFormChoiceField:Ii,AcroFormComboBox:Ri,AcroFormEditBox:wo,AcroFormListBox:Di,AcroFormPasswordField:So,AcroFormPushButton:bo,AcroFormRadioButton:Mi,AcroFormTextField:mi,GState:Co,ShadingPattern:hi,TilingPattern:Oi,default:ht,jsPDF:ht},Symbol.toStringTag,{value:"Module"}));var Xp={exports:{}};const Kp=Q1(Yp);/*!
 * 
 *               jsPDF AutoTable plugin v3.8.4
 *
 *               Copyright (c) 2024 Simon Bengtsson, https://github.com/simonbengtsson/jsPDF-AutoTable
 *               Licensed under the MIT License.
 *               http://opensource.org/licenses/mit-license
 *
 */(function(e,r){(function(n,a){e.exports=a(function(){try{return Kp}catch{}}())})(typeof globalThis<"u"?globalThis:typeof a0<"u"?a0:typeof window<"u"?window:typeof self<"u"?self:a0,function(t){return function(){var n={172:function(l,c){var h=this&&this.__extends||function(){var m=function(d,y){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,b){x.__proto__=b}||function(x,b){for(var N in b)Object.prototype.hasOwnProperty.call(b,N)&&(x[N]=b[N])},m(d,y)};return function(d,y){if(typeof y!="function"&&y!==null)throw new TypeError("Class extends value "+String(y)+" is not a constructor or null");m(d,y);function x(){this.constructor=d}d.prototype=y===null?Object.create(y):(x.prototype=y.prototype,new x)}}();Object.defineProperty(c,"__esModule",{value:!0}),c.CellHookData=c.HookData=void 0;var u=function(){function m(d,y,x){this.table=y,this.pageNumber=y.pageNumber,this.pageCount=this.pageNumber,this.settings=y.settings,this.cursor=x,this.doc=d.getDocument()}return m}();c.HookData=u;var g=function(m){h(d,m);function d(y,x,b,N,w,A){var E=m.call(this,y,x,A)||this;return E.cell=b,E.row=N,E.column=w,E.section=N.section,E}return d}(u);c.CellHookData=g},340:function(l,c,h){Object.defineProperty(c,"__esModule",{value:!0});var u=h(4),g=h(136),m=h(744),d=h(776),y=h(664),x=h(972);function b(N){N.API.autoTable=function(){for(var w=[],A=0;A<arguments.length;A++)w[A]=arguments[A];var E;w.length===1?E=w[0]:(console.error("Use of deprecated autoTable initiation"),E=w[2]||{},E.columns=w[0],E.body=w[1]);var W=(0,d.parseInput)(this,E),V=(0,x.createTable)(this,W);return(0,y.drawTable)(this,V),this},N.API.lastAutoTable=!1,N.API.previousAutoTable=!1,N.API.autoTable.previous=!1,N.API.autoTableText=function(w,A,E,W){(0,g.default)(w,A,E,W,this)},N.API.autoTableSetDefaults=function(w){return m.DocHandler.setDefaults(w,this),this},N.autoTableSetDefaults=function(w,A){m.DocHandler.setDefaults(w,A)},N.API.autoTableHtmlToJson=function(w,A){var E;if(A===void 0&&(A=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var W=new m.DocHandler(this),V=(0,u.parseHtml)(W,w,window,A,!1),F=V.head,C=V.body,R=((E=F[0])===null||E===void 0?void 0:E.map(function(G){return G.content}))||[];return{columns:R,rows:C,data:C}},N.API.autoTableEndPosY=function(){console.error("Use of deprecated function: autoTableEndPosY. Use doc.lastAutoTable.finalY instead.");var w=this.lastAutoTable;return w&&w.finalY?w.finalY:0},N.API.autoTableAddPageContent=function(w){return console.error("Use of deprecated function: autoTableAddPageContent. Use jsPDF.autoTableSetDefaults({didDrawPage: () => {}}) instead."),N.API.autoTable.globalDefaults||(N.API.autoTable.globalDefaults={}),N.API.autoTable.globalDefaults.addPageContent=w,this},N.API.autoTableAddPage=function(){return console.error("Use of deprecated function: autoTableAddPage. Use doc.addPage()"),this.addPage(),this}}c.default=b},136:function(l,c){Object.defineProperty(c,"__esModule",{value:!0});function h(u,g,m,d,y){d=d||{};var x=1.15,b=y.internal.scaleFactor,N=y.internal.getFontSize()/b,w=y.getLineHeightFactor?y.getLineHeightFactor():x,A=N*w,E=/\r\n|\r|\n/g,W="",V=1;if((d.valign==="middle"||d.valign==="bottom"||d.halign==="center"||d.halign==="right")&&(W=typeof u=="string"?u.split(E):u,V=W.length||1),m+=N*(2-x),d.valign==="middle"?m-=V/2*A:d.valign==="bottom"&&(m-=V*A),d.halign==="center"||d.halign==="right"){var F=N;if(d.halign==="center"&&(F*=.5),W&&V>=1){for(var C=0;C<W.length;C++)y.text(W[C],g-y.getStringUnitWidth(W[C])*F,m),m+=A;return y}g-=y.getStringUnitWidth(u)*F}return d.halign==="justify"?y.text(u,g,m,{maxWidth:d.maxWidth||100,align:"justify"}):y.text(u,g,m),y}c.default=h},420:function(l,c){Object.defineProperty(c,"__esModule",{value:!0}),c.getPageAvailableWidth=c.parseSpacing=c.getFillStyle=c.addTableBorder=c.getStringWidth=void 0;function h(y,x,b){b.applyStyles(x,!0);var N=Array.isArray(y)?y:[y],w=N.map(function(A){return b.getTextWidth(A)}).reduce(function(A,E){return Math.max(A,E)},0);return w}c.getStringWidth=h;function u(y,x,b,N){var w=x.settings.tableLineWidth,A=x.settings.tableLineColor;y.applyStyles({lineWidth:w,lineColor:A});var E=g(w,!1);E&&y.rect(b.x,b.y,x.getWidth(y.pageSize().width),N.y-b.y,E)}c.addTableBorder=u;function g(y,x){var b=y>0,N=x||x===0;return b&&N?"DF":b?"S":N?"F":null}c.getFillStyle=g;function m(y,x){var b,N,w,A;if(y=y||x,Array.isArray(y)){if(y.length>=4)return{top:y[0],right:y[1],bottom:y[2],left:y[3]};if(y.length===3)return{top:y[0],right:y[1],bottom:y[2],left:y[1]};if(y.length===2)return{top:y[0],right:y[1],bottom:y[0],left:y[1]};y.length===1?y=y[0]:y=x}return typeof y=="object"?(typeof y.vertical=="number"&&(y.top=y.vertical,y.bottom=y.vertical),typeof y.horizontal=="number"&&(y.right=y.horizontal,y.left=y.horizontal),{left:(b=y.left)!==null&&b!==void 0?b:x,top:(N=y.top)!==null&&N!==void 0?N:x,right:(w=y.right)!==null&&w!==void 0?w:x,bottom:(A=y.bottom)!==null&&A!==void 0?A:x}):(typeof y!="number"&&(y=x),{top:y,right:y,bottom:y,left:y})}c.parseSpacing=m;function d(y,x){var b=m(x.settings.margin,0);return y.pageSize().width-(b.left+b.right)}c.getPageAvailableWidth=d},796:function(l,c){var h=this&&this.__extends||function(){var d=function(y,x){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,N){b.__proto__=N}||function(b,N){for(var w in N)Object.prototype.hasOwnProperty.call(N,w)&&(b[w]=N[w])},d(y,x)};return function(y,x){if(typeof x!="function"&&x!==null)throw new TypeError("Class extends value "+String(x)+" is not a constructor or null");d(y,x);function b(){this.constructor=y}y.prototype=x===null?Object.create(x):(b.prototype=x.prototype,new b)}}();Object.defineProperty(c,"__esModule",{value:!0}),c.getTheme=c.defaultStyles=c.HtmlRowInput=void 0;var u=function(d){h(y,d);function y(x){var b=d.call(this)||this;return b._element=x,b}return y}(Array);c.HtmlRowInput=u;function g(d){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/d,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}c.defaultStyles=g;function m(d){var y={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return y[d]}c.getTheme=m},903:function(l,c,h){Object.defineProperty(c,"__esModule",{value:!0}),c.parseCss=void 0;var u=h(420);function g(b,N,w,A,E){var W={},V=1.3333333333333333,F=d(N,function(te){return E.getComputedStyle(te).backgroundColor});F!=null&&(W.fillColor=F);var C=d(N,function(te){return E.getComputedStyle(te).color});C!=null&&(W.textColor=C);var R=x(A,w);R&&(W.cellPadding=R);var G="borderTopColor",j=V*w,T=A.borderTopWidth;if(A.borderBottomWidth===T&&A.borderRightWidth===T&&A.borderLeftWidth===T){var B=(parseFloat(T)||0)/j;B&&(W.lineWidth=B)}else W.lineWidth={top:(parseFloat(A.borderTopWidth)||0)/j,right:(parseFloat(A.borderRightWidth)||0)/j,bottom:(parseFloat(A.borderBottomWidth)||0)/j,left:(parseFloat(A.borderLeftWidth)||0)/j},W.lineWidth.top||(W.lineWidth.right?G="borderRightColor":W.lineWidth.bottom?G="borderBottomColor":W.lineWidth.left&&(G="borderLeftColor"));var M=d(N,function(te){return E.getComputedStyle(te)[G]});M!=null&&(W.lineColor=M);var le=["left","right","center","justify"];le.indexOf(A.textAlign)!==-1&&(W.halign=A.textAlign),le=["middle","bottom","top"],le.indexOf(A.verticalAlign)!==-1&&(W.valign=A.verticalAlign);var J=parseInt(A.fontSize||"");isNaN(J)||(W.fontSize=J/V);var z=m(A);z&&(W.fontStyle=z);var ae=(A.fontFamily||"").toLowerCase();return b.indexOf(ae)!==-1&&(W.font=ae),W}c.parseCss=g;function m(b){var N="";return(b.fontWeight==="bold"||b.fontWeight==="bolder"||parseInt(b.fontWeight)>=700)&&(N="bold"),(b.fontStyle==="italic"||b.fontStyle==="oblique")&&(N+="italic"),N}function d(b,N){var w=y(b,N);if(!w)return null;var A=w.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!A||!Array.isArray(A))return null;var E=[parseInt(A[1]),parseInt(A[2]),parseInt(A[3])],W=parseInt(A[4]);return W===0||isNaN(E[0])||isNaN(E[1])||isNaN(E[2])?null:E}function y(b,N){var w=N(b);return w==="rgba(0, 0, 0, 0)"||w==="transparent"||w==="initial"||w==="inherit"?b.parentElement==null?null:y(b.parentElement,N):w}function x(b,N){var w=[b.paddingTop,b.paddingRight,b.paddingBottom,b.paddingLeft],A=96/(72/N),E=(parseInt(b.lineHeight)-parseInt(b.fontSize))/N/2,W=w.map(function(F){return parseInt(F||"0")/A}),V=(0,u.parseSpacing)(W,0);return E>V.top&&(V.top=E),E>V.bottom&&(V.bottom=E),V}},744:function(l,c){Object.defineProperty(c,"__esModule",{value:!0}),c.DocHandler=void 0;var h={},u=function(){function g(m){this.jsPDFDocument=m,this.userStyles={textColor:m.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:m.internal.getFontSize(),fontStyle:m.internal.getFont().fontStyle,font:m.internal.getFont().fontName,lineWidth:m.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:m.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return g.setDefaults=function(m,d){d===void 0&&(d=null),d?d.__autoTableDocumentDefaults=m:h=m},g.unifyColor=function(m){return Array.isArray(m)?m:typeof m=="number"?[m,m,m]:typeof m=="string"?[m]:null},g.prototype.applyStyles=function(m,d){var y,x,b;d===void 0&&(d=!1),m.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(m.fontStyle);var N=this.jsPDFDocument.internal.getFont(),w=N.fontStyle,A=N.fontName;if(m.font&&(A=m.font),m.fontStyle){w=m.fontStyle;var E=this.getFontList()[A];E&&E.indexOf(w)===-1&&(this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(E[0]),w=E[0])}if(this.jsPDFDocument.setFont(A,w),m.fontSize&&this.jsPDFDocument.setFontSize(m.fontSize),!d){var W=g.unifyColor(m.fillColor);W&&(y=this.jsPDFDocument).setFillColor.apply(y,W),W=g.unifyColor(m.textColor),W&&(x=this.jsPDFDocument).setTextColor.apply(x,W),W=g.unifyColor(m.lineColor),W&&(b=this.jsPDFDocument).setDrawColor.apply(b,W),typeof m.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(m.lineWidth)}},g.prototype.splitTextToSize=function(m,d,y){return this.jsPDFDocument.splitTextToSize(m,d,y)},g.prototype.rect=function(m,d,y,x,b){return this.jsPDFDocument.rect(m,d,y,x,b)},g.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},g.prototype.getTextWidth=function(m){return this.jsPDFDocument.getTextWidth(m)},g.prototype.getDocument=function(){return this.jsPDFDocument},g.prototype.setPage=function(m){this.jsPDFDocument.setPage(m)},g.prototype.addPage=function(){return this.jsPDFDocument.addPage()},g.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},g.prototype.getGlobalOptions=function(){return h||{}},g.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},g.prototype.pageSize=function(){var m=this.jsPDFDocument.internal.pageSize;return m.width==null&&(m={width:m.getWidth(),height:m.getHeight()}),m},g.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},g.prototype.getLineHeightFactor=function(){var m=this.jsPDFDocument;return m.getLineHeightFactor?m.getLineHeightFactor():1.15},g.prototype.getLineHeight=function(m){return m/this.scaleFactor()*this.getLineHeightFactor()},g.prototype.pageNumber=function(){var m=this.jsPDFDocument.internal.getCurrentPageInfo();return m?m.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},g}();c.DocHandler=u},4:function(l,c,h){Object.defineProperty(c,"__esModule",{value:!0}),c.parseHtml=void 0;var u=h(903),g=h(796);function m(x,b,N,w,A){var E,W;w===void 0&&(w=!1),A===void 0&&(A=!1);var V;typeof b=="string"?V=N.document.querySelector(b):V=b;var F=Object.keys(x.getFontList()),C=x.scaleFactor(),R=[],G=[],j=[];if(!V)return console.error("Html table could not be found with input: ",b),{head:R,body:G,foot:j};for(var T=0;T<V.rows.length;T++){var B=V.rows[T],M=(W=(E=B==null?void 0:B.parentElement)===null||E===void 0?void 0:E.tagName)===null||W===void 0?void 0:W.toLowerCase(),le=d(F,C,N,B,w,A);le&&(M==="thead"?R.push(le):M==="tfoot"?j.push(le):G.push(le))}return{head:R,body:G,foot:j}}c.parseHtml=m;function d(x,b,N,w,A,E){for(var W=new g.HtmlRowInput(w),V=0;V<w.cells.length;V++){var F=w.cells[V],C=N.getComputedStyle(F);if(A||C.display!=="none"){var R=void 0;E&&(R=(0,u.parseCss)(x,F,b,C,N)),W.push({rowSpan:F.rowSpan,colSpan:F.colSpan,styles:R,_element:F,content:y(F)})}}var G=N.getComputedStyle(w);if(W.length>0&&(A||G.display!=="none"))return W}function y(x){var b=x.cloneNode(!0);return b.innerHTML=b.innerHTML.replace(/\n/g,"").replace(/ +/g," "),b.innerHTML=b.innerHTML.split(/<br.*?>/).map(function(N){return N.trim()}).join(`
`),b.innerText||b.textContent||""}},776:function(l,c,h){Object.defineProperty(c,"__esModule",{value:!0}),c.parseInput=void 0;var u=h(4),g=h(356),m=h(420),d=h(744),y=h(792);function x(V,F){var C=new d.DocHandler(V),R=C.getDocumentOptions(),G=C.getGlobalOptions();(0,y.default)(C,G,R,F);var j=(0,g.assign)({},G,R,F),T;typeof window<"u"&&(T=window);var B=b(G,R,F),M=N(G,R,F),le=w(C,j),J=E(C,j,T);return{id:F.tableId,content:J,hooks:M,styles:B,settings:le}}c.parseInput=x;function b(V,F,C){for(var R={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},G=function(M){if(M==="columnStyles"){var le=V[M],J=F[M],z=C[M];R.columnStyles=(0,g.assign)({},le,J,z)}else{var ae=[V,F,C],te=ae.map(function(de){return de[M]||{}});R[M]=(0,g.assign)({},te[0],te[1],te[2])}},j=0,T=Object.keys(R);j<T.length;j++){var B=T[j];G(B)}return R}function N(V,F,C){for(var R=[V,F,C],G={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},j=0,T=R;j<T.length;j++){var B=T[j];B.didParseCell&&G.didParseCell.push(B.didParseCell),B.willDrawCell&&G.willDrawCell.push(B.willDrawCell),B.didDrawCell&&G.didDrawCell.push(B.didDrawCell),B.willDrawPage&&G.willDrawPage.push(B.willDrawPage),B.didDrawPage&&G.didDrawPage.push(B.didDrawPage)}return G}function w(V,F){var C,R,G,j,T,B,M,le,J,z,ae,te,de=(0,m.parseSpacing)(F.margin,40/V.scaleFactor()),xe=(C=A(V,F.startY))!==null&&C!==void 0?C:de.top,_;F.showFoot===!0?_="everyPage":F.showFoot===!1?_="never":_=(R=F.showFoot)!==null&&R!==void 0?R:"everyPage";var L;F.showHead===!0?L="everyPage":F.showHead===!1?L="never":L=(G=F.showHead)!==null&&G!==void 0?G:"everyPage";var P=(j=F.useCss)!==null&&j!==void 0?j:!1,O=F.theme||(P?"plain":"striped"),X=!!F.horizontalPageBreak,ce=(T=F.horizontalPageBreakRepeat)!==null&&T!==void 0?T:null;return{includeHiddenHtml:(B=F.includeHiddenHtml)!==null&&B!==void 0?B:!1,useCss:P,theme:O,startY:xe,margin:de,pageBreak:(M=F.pageBreak)!==null&&M!==void 0?M:"auto",rowPageBreak:(le=F.rowPageBreak)!==null&&le!==void 0?le:"auto",tableWidth:(J=F.tableWidth)!==null&&J!==void 0?J:"auto",showHead:L,showFoot:_,tableLineWidth:(z=F.tableLineWidth)!==null&&z!==void 0?z:0,tableLineColor:(ae=F.tableLineColor)!==null&&ae!==void 0?ae:200,horizontalPageBreak:X,horizontalPageBreakRepeat:ce,horizontalPageBreakBehaviour:(te=F.horizontalPageBreakBehaviour)!==null&&te!==void 0?te:"afterAllRows"}}function A(V,F){var C=V.getLastAutoTable(),R=V.scaleFactor(),G=V.pageNumber(),j=!1;if(C&&C.startPageNumber){var T=C.startPageNumber+C.pageNumber-1;j=T===G}return typeof F=="number"?F:(F==null||F===!1)&&j&&(C==null?void 0:C.finalY)!=null?C.finalY+20/R:null}function E(V,F,C){var R=F.head||[],G=F.body||[],j=F.foot||[];if(F.html){var T=F.includeHiddenHtml;if(C){var B=(0,u.parseHtml)(V,F.html,C,T,F.useCss)||{};R=B.head||R,G=B.body||R,j=B.foot||R}else console.error("Cannot parse html in non browser environment")}var M=F.columns||W(R,G,j);return{columns:M,head:R,body:G,foot:j}}function W(V,F,C){var R=V[0]||F[0]||C[0]||[],G=[];return Object.keys(R).filter(function(j){return j!=="_element"}).forEach(function(j){var T=1,B;Array.isArray(R)?B=R[parseInt(j)]:B=R[j],typeof B=="object"&&!Array.isArray(B)&&(T=(B==null?void 0:B.colSpan)||1);for(var M=0;M<T;M++){var le=void 0;Array.isArray(R)?le=G.length:le=j+(M>0?"_".concat(M):"");var J={dataKey:le};G.push(J)}}),G}},792:function(l,c){Object.defineProperty(c,"__esModule",{value:!0});function h(g,m,d,y){for(var x=function(A){A&&typeof A!="object"&&console.error("The options parameter should be of type object, is: "+typeof A),typeof A.extendWidth<"u"&&(A.tableWidth=A.extendWidth?"auto":"wrap",console.error("Use of deprecated option: extendWidth, use tableWidth instead.")),typeof A.margins<"u"&&(typeof A.margin>"u"&&(A.margin=A.margins),console.error("Use of deprecated option: margins, use margin instead.")),A.startY&&typeof A.startY!="number"&&(console.error("Invalid value for startY option",A.startY),delete A.startY),!A.didDrawPage&&(A.afterPageContent||A.beforePageContent||A.afterPageAdd)&&(console.error("The afterPageContent, beforePageContent and afterPageAdd hooks are deprecated. Use didDrawPage instead"),A.didDrawPage=function(j){g.applyStyles(g.userStyles),A.beforePageContent&&A.beforePageContent(j),g.applyStyles(g.userStyles),A.afterPageContent&&A.afterPageContent(j),g.applyStyles(g.userStyles),A.afterPageAdd&&j.pageNumber>1&&j.afterPageAdd(j),g.applyStyles(g.userStyles)}),["createdHeaderCell","drawHeaderRow","drawRow","drawHeaderCell"].forEach(function(j){A[j]&&console.error('The "'.concat(j,'" hook has changed in version 3.0, check the changelog for how to migrate.'))}),[["showFoot","showFooter"],["showHead","showHeader"],["didDrawPage","addPageContent"],["didParseCell","createdCell"],["headStyles","headerStyles"]].forEach(function(j){var T=j[0],B=j[1];A[B]&&(console.error("Use of deprecated option ".concat(B,". Use ").concat(T," instead")),A[T]=A[B])}),[["padding","cellPadding"],["lineHeight","rowHeight"],"fontSize","overflow"].forEach(function(j){var T=typeof j=="string"?j:j[0],B=typeof j=="string"?j:j[1];typeof A[T]<"u"&&(typeof A.styles[B]>"u"&&(A.styles[B]=A[T]),console.error("Use of deprecated option: "+T+", use the style "+B+" instead."))});for(var E=0,W=["styles","bodyStyles","headStyles","footStyles"];E<W.length;E++){var V=W[E];u(A[V]||{})}for(var F=A.columnStyles||{},C=0,R=Object.keys(F);C<R.length;C++){var G=R[C];u(F[G]||{})}},b=0,N=[m,d,y];b<N.length;b++){var w=N[b];x(w)}}c.default=h;function u(g){g.rowHeight?(console.error("Use of deprecated style rowHeight. It is renamed to minCellHeight."),g.minCellHeight||(g.minCellHeight=g.rowHeight)):g.columnWidth&&(console.error("Use of deprecated style columnWidth. It is renamed to cellWidth."),g.cellWidth||(g.cellWidth=g.columnWidth))}},260:function(l,c,h){Object.defineProperty(c,"__esModule",{value:!0}),c.Column=c.Cell=c.Row=c.Table=void 0;var u=h(796),g=h(172),m=h(420),d=function(){function N(w,A){this.pageNumber=1,this.pageCount=1,this.id=w.id,this.settings=w.settings,this.styles=w.styles,this.hooks=w.hooks,this.columns=A.columns,this.head=A.head,this.body=A.body,this.foot=A.foot}return N.prototype.getHeadHeight=function(w){return this.head.reduce(function(A,E){return A+E.getMaxCellHeight(w)},0)},N.prototype.getFootHeight=function(w){return this.foot.reduce(function(A,E){return A+E.getMaxCellHeight(w)},0)},N.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},N.prototype.callCellHooks=function(w,A,E,W,V,F){for(var C=0,R=A;C<R.length;C++){var G=R[C],j=new g.CellHookData(w,this,E,W,V,F),T=G(j)===!1;if(E.text=Array.isArray(E.text)?E.text:[E.text],T)return!1}return!0},N.prototype.callEndPageHooks=function(w,A){w.applyStyles(w.userStyles);for(var E=0,W=this.hooks.didDrawPage;E<W.length;E++){var V=W[E];V(new g.HookData(w,this,A))}},N.prototype.callWillDrawPageHooks=function(w,A){for(var E=0,W=this.hooks.willDrawPage;E<W.length;E++){var V=W[E];V(new g.HookData(w,this,A))}},N.prototype.getWidth=function(w){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var A=this.columns.reduce(function(W,V){return W+V.wrappedWidth},0);return A}else{var E=this.settings.margin;return w-E.left-E.right}},N}();c.Table=d;var y=function(){function N(w,A,E,W,V){V===void 0&&(V=!1),this.height=0,this.raw=w,w instanceof u.HtmlRowInput&&(this.raw=w._element,this.element=w._element),this.index=A,this.section=E,this.cells=W,this.spansMultiplePages=V}return N.prototype.getMaxCellHeight=function(w){var A=this;return w.reduce(function(E,W){var V;return Math.max(E,((V=A.cells[W.index])===null||V===void 0?void 0:V.height)||0)},0)},N.prototype.hasRowSpan=function(w){var A=this;return w.filter(function(E){var W=A.cells[E.index];return W?W.rowSpan>1:!1}).length>0},N.prototype.canEntireRowFit=function(w,A){return this.getMaxCellHeight(A)<=w},N.prototype.getMinimumRowHeight=function(w,A){var E=this;return w.reduce(function(W,V){var F=E.cells[V.index];if(!F)return 0;var C=A.getLineHeight(F.styles.fontSize),R=F.padding("vertical"),G=R+C;return G>W?G:W},0)},N}();c.Row=y;var x=function(){function N(w,A,E){var W,V;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=A,this.section=E,this.raw=w;var F=w;w!=null&&typeof w=="object"&&!Array.isArray(w)?(this.rowSpan=w.rowSpan||1,this.colSpan=w.colSpan||1,F=(V=(W=w.content)!==null&&W!==void 0?W:w.title)!==null&&V!==void 0?V:w,w._element&&(this.raw=w._element)):(this.rowSpan=1,this.colSpan=1);var C=F!=null?""+F:"",R=/\r\n|\r|\n/g;this.text=C.split(R)}return N.prototype.getTextPos=function(){var w;if(this.styles.valign==="top")w=this.y+this.padding("top");else if(this.styles.valign==="bottom")w=this.y+this.height-this.padding("bottom");else{var A=this.height-this.padding("vertical");w=this.y+A/2+this.padding("top")}var E;if(this.styles.halign==="right")E=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var W=this.width-this.padding("horizontal");E=this.x+W/2+this.padding("left")}else E=this.x+this.padding("left");return{x:E,y:w}},N.prototype.getContentHeight=function(w,A){A===void 0&&(A=1.15);var E=Array.isArray(this.text)?this.text.length:1,W=this.styles.fontSize/w*A,V=E*W+this.padding("vertical");return Math.max(V,this.styles.minCellHeight)},N.prototype.padding=function(w){var A=(0,m.parseSpacing)(this.styles.cellPadding,0);return w==="vertical"?A.top+A.bottom:w==="horizontal"?A.left+A.right:A[w]},N}();c.Cell=x;var b=function(){function N(w,A,E){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=w,this.raw=A,this.index=E}return N.prototype.getMaxCustomCellWidth=function(w){for(var A=0,E=0,W=w.allRows();E<W.length;E++){var V=W[E],F=V.cells[this.index];F&&typeof F.styles.cellWidth=="number"&&(A=Math.max(A,F.styles.cellWidth))}return A},N}();c.Column=b},356:function(l,c){Object.defineProperty(c,"__esModule",{value:!0}),c.assign=void 0;function h(u,g,m,d,y){if(u==null)throw new TypeError("Cannot convert undefined or null to object");for(var x=Object(u),b=1;b<arguments.length;b++){var N=arguments[b];if(N!=null)for(var w in N)Object.prototype.hasOwnProperty.call(N,w)&&(x[w]=N[w])}return x}c.assign=h},972:function(l,c,h){Object.defineProperty(c,"__esModule",{value:!0}),c.createTable=void 0;var u=h(744),g=h(260),m=h(324),d=h(796),y=h(356);function x(V,F){var C=new u.DocHandler(V),R=b(F,C.scaleFactor()),G=new g.Table(F,R);return(0,m.calculateWidths)(C,G),C.applyStyles(C.userStyles),G}c.createTable=x;function b(V,F){var C=V.content,R=E(C.columns);if(C.head.length===0){var G=w(R,"head");G&&C.head.push(G)}if(C.foot.length===0){var G=w(R,"foot");G&&C.foot.push(G)}var j=V.settings.theme,T=V.styles;return{columns:R,head:N("head",C.head,R,T,j,F),body:N("body",C.body,R,T,j,F),foot:N("foot",C.foot,R,T,j,F)}}function N(V,F,C,R,G,j){var T={},B=F.map(function(M,le){for(var J=0,z={},ae=0,te=0,de=0,xe=C;de<xe.length;de++){var _=xe[de];if(T[_.index]==null||T[_.index].left===0)if(te===0){var L=void 0;Array.isArray(M)?L=M[_.index-ae-J]:L=M[_.dataKey];var P={};typeof L=="object"&&!Array.isArray(L)&&(P=(L==null?void 0:L.styles)||{});var O=W(V,_,le,G,R,j,P),X=new g.Cell(L,O,V);z[_.dataKey]=X,z[_.index]=X,te=X.colSpan-1,T[_.index]={left:X.rowSpan-1,times:te}}else te--,ae++;else T[_.index].left--,te=T[_.index].times,J++}return new g.Row(M,le,V,z)});return B}function w(V,F){var C={};return V.forEach(function(R){if(R.raw!=null){var G=A(F,R.raw);G!=null&&(C[R.dataKey]=G)}}),Object.keys(C).length>0?C:null}function A(V,F){if(V==="head"){if(typeof F=="object")return F.header||F.title||null;if(typeof F=="string"||typeof F=="number")return F}else if(V==="foot"&&typeof F=="object")return F.footer;return null}function E(V){return V.map(function(F,C){var R,G,j;return typeof F=="object"?j=(G=(R=F.dataKey)!==null&&R!==void 0?R:F.key)!==null&&G!==void 0?G:C:j=C,new g.Column(j,F,C)})}function W(V,F,C,R,G,j,T){var B=(0,d.getTheme)(R),M;V==="head"?M=G.headStyles:V==="body"?M=G.bodyStyles:V==="foot"&&(M=G.footStyles);var le=(0,y.assign)({},B.table,B[V],G.styles,M),J=G.columnStyles[F.dataKey]||G.columnStyles[F.index]||{},z=V==="body"?J:{},ae=V==="body"&&C%2===0?(0,y.assign)({},B.alternateRow,G.alternateRowStyles):{},te=(0,d.defaultStyles)(j),de=(0,y.assign)({},te,le,ae,z);return(0,y.assign)(de,T)}},664:function(l,c,h){Object.defineProperty(c,"__esModule",{value:!0}),c.addPage=c.drawTable=void 0;var u=h(420),g=h(260),m=h(744),d=h(356),y=h(136),x=h(224);function b(J,z){var ae=z.settings,te=ae.startY,de=ae.margin,xe={x:de.left,y:te},_=z.getHeadHeight(z.columns)+z.getFootHeight(z.columns),L=te+de.bottom+_;if(ae.pageBreak==="avoid"){var P=z.body,O=P.reduce(function(fe,he){return fe+he.height},0);L+=O}var X=new m.DocHandler(J);(ae.pageBreak==="always"||ae.startY!=null&&L>X.pageSize().height)&&(le(X),xe.y=de.top),z.callWillDrawPageHooks(X,xe);var ce=(0,d.assign)({},xe);z.startPageNumber=X.pageNumber(),ae.horizontalPageBreak?N(X,z,ce,xe):(X.applyStyles(X.userStyles),(ae.showHead==="firstPage"||ae.showHead==="everyPage")&&z.head.forEach(function(fe){return G(X,z,fe,xe,z.columns)}),X.applyStyles(X.userStyles),z.body.forEach(function(fe,he){var we=he===z.body.length-1;R(X,z,fe,we,ce,xe,z.columns)}),X.applyStyles(X.userStyles),(ae.showFoot==="lastPage"||ae.showFoot==="everyPage")&&z.foot.forEach(function(fe){return G(X,z,fe,xe,z.columns)})),(0,u.addTableBorder)(X,z,ce,xe),z.callEndPageHooks(X,xe),z.finalY=xe.y,J.lastAutoTable=z,J.previousAutoTable=z,J.autoTable&&(J.autoTable.previous=z),X.applyStyles(X.userStyles)}c.drawTable=b;function N(J,z,ae,te){var de=(0,x.calculateAllColumnsCanFitInPage)(J,z),xe=z.settings;if(xe.horizontalPageBreakBehaviour==="afterAllRows")de.forEach(function(O,X){J.applyStyles(J.userStyles),X>0?M(J,z,ae,te,O.columns,!0):w(J,z,te,O.columns),A(J,z,ae,te,O.columns),W(J,z,te,O.columns)});else for(var _=-1,L=de[0],P=function(){var O=_;if(L){J.applyStyles(J.userStyles);var X=L.columns;_>=0?M(J,z,ae,te,X,!0):w(J,z,te,X),O=E(J,z,_+1,te,X),W(J,z,te,X)}var ce=O-_;de.slice(1).forEach(function(fe){J.applyStyles(J.userStyles),M(J,z,ae,te,fe.columns,!0),E(J,z,_+1,te,fe.columns,ce),W(J,z,te,fe.columns)}),_=O};_<z.body.length-1;)P()}function w(J,z,ae,te){var de=z.settings;J.applyStyles(J.userStyles),(de.showHead==="firstPage"||de.showHead==="everyPage")&&z.head.forEach(function(xe){return G(J,z,xe,ae,te)})}function A(J,z,ae,te,de){J.applyStyles(J.userStyles),z.body.forEach(function(xe,_){var L=_===z.body.length-1;R(J,z,xe,L,ae,te,de)})}function E(J,z,ae,te,de,xe){J.applyStyles(J.userStyles),xe=xe??z.body.length;var _=Math.min(ae+xe,z.body.length),L=-1;return z.body.slice(ae,_).forEach(function(P,O){var X=ae+O===z.body.length-1,ce=B(J,z,X,te);P.canEntireRowFit(ce,de)&&(G(J,z,P,te,de),L=ae+O)}),L}function W(J,z,ae,te){var de=z.settings;J.applyStyles(J.userStyles),(de.showFoot==="lastPage"||de.showFoot==="everyPage")&&z.foot.forEach(function(xe){return G(J,z,xe,ae,te)})}function V(J,z,ae){var te=ae.getLineHeight(J.styles.fontSize),de=J.padding("vertical"),xe=Math.floor((z-de)/te);return Math.max(0,xe)}function F(J,z,ae,te){var de={};J.spansMultiplePages=!0,J.height=0;for(var xe=0,_=0,L=ae.columns;_<L.length;_++){var P=L[_],O=J.cells[P.index];if(O){Array.isArray(O.text)||(O.text=[O.text]);var X=new g.Cell(O.raw,O.styles,O.section);X=(0,d.assign)(X,O),X.text=[];var ce=V(O,z,te);O.text.length>ce&&(X.text=O.text.splice(ce,O.text.length));var fe=te.scaleFactor(),he=te.getLineHeightFactor();O.contentHeight=O.getContentHeight(fe,he),O.contentHeight>=z&&(O.contentHeight=z,X.styles.minCellHeight-=z),O.contentHeight>J.height&&(J.height=O.contentHeight),X.contentHeight=X.getContentHeight(fe,he),X.contentHeight>xe&&(xe=X.contentHeight),de[P.index]=X}}var we=new g.Row(J.raw,-1,J.section,de,!0);we.height=xe;for(var Pe=0,Re=ae.columns;Pe<Re.length;Pe++){var P=Re[Pe],X=we.cells[P.index];X&&(X.height=we.height);var O=J.cells[P.index];O&&(O.height=J.height)}return we}function C(J,z,ae,te){var de=J.pageSize().height,xe=te.settings.margin,_=xe.top+xe.bottom,L=de-_;z.section==="body"&&(L-=te.getHeadHeight(te.columns)+te.getFootHeight(te.columns));var P=z.getMinimumRowHeight(te.columns,J),O=P<ae;if(P>L)return console.error("Will not be able to print row ".concat(z.index," correctly since it's minimum height is larger than page height")),!0;if(!O)return!1;var X=z.hasRowSpan(te.columns),ce=z.getMaxCellHeight(te.columns)>L;return ce?(X&&console.error("The content of row ".concat(z.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(X||te.settings.rowPageBreak==="avoid")}function R(J,z,ae,te,de,xe,_){var L=B(J,z,te,xe);if(ae.canEntireRowFit(L,_))G(J,z,ae,xe,_);else if(C(J,ae,L,z)){var P=F(ae,L,z,J);G(J,z,ae,xe,_),M(J,z,de,xe,_),R(J,z,P,te,de,xe,_)}else M(J,z,de,xe,_),R(J,z,ae,te,de,xe,_)}function G(J,z,ae,te,de){te.x=z.settings.margin.left;for(var xe=0,_=de;xe<_.length;xe++){var L=_[xe],P=ae.cells[L.index];if(!P){te.x+=L.width;continue}J.applyStyles(P.styles),P.x=te.x,P.y=te.y;var O=z.callCellHooks(J,z.hooks.willDrawCell,P,ae,L,te);if(O===!1){te.x+=L.width;continue}j(J,P,te);var X=P.getTextPos();(0,y.default)(P.text,X.x,X.y,{halign:P.styles.halign,valign:P.styles.valign,maxWidth:Math.ceil(P.width-P.padding("left")-P.padding("right"))},J.getDocument()),z.callCellHooks(J,z.hooks.didDrawCell,P,ae,L,te),te.x+=L.width}te.y+=ae.height}function j(J,z,ae){var te=z.styles;if(J.getDocument().setFillColor(J.getDocument().getFillColor()),typeof te.lineWidth=="number"){var de=(0,u.getFillStyle)(te.lineWidth,te.fillColor);de&&J.rect(z.x,ae.y,z.width,z.height,de)}else typeof te.lineWidth=="object"&&(te.fillColor&&J.rect(z.x,ae.y,z.width,z.height,"F"),T(J,z,ae,te.lineWidth))}function T(J,z,ae,te){var de,xe,_,L;te.top&&(de=ae.x,xe=ae.y,_=ae.x+z.width,L=ae.y,te.right&&(_+=.5*te.right),te.left&&(de-=.5*te.left),P(te.top,de,xe,_,L)),te.bottom&&(de=ae.x,xe=ae.y+z.height,_=ae.x+z.width,L=ae.y+z.height,te.right&&(_+=.5*te.right),te.left&&(de-=.5*te.left),P(te.bottom,de,xe,_,L)),te.left&&(de=ae.x,xe=ae.y,_=ae.x,L=ae.y+z.height,te.top&&(xe-=.5*te.top),te.bottom&&(L+=.5*te.bottom),P(te.left,de,xe,_,L)),te.right&&(de=ae.x+z.width,xe=ae.y,_=ae.x+z.width,L=ae.y+z.height,te.top&&(xe-=.5*te.top),te.bottom&&(L+=.5*te.bottom),P(te.right,de,xe,_,L));function P(O,X,ce,fe,he){J.getDocument().setLineWidth(O),J.getDocument().line(X,ce,fe,he,"S")}}function B(J,z,ae,te){var de=z.settings.margin.bottom,xe=z.settings.showFoot;return(xe==="everyPage"||xe==="lastPage"&&ae)&&(de+=z.getFootHeight(z.columns)),J.pageSize().height-te.y-de}function M(J,z,ae,te,de,xe){de===void 0&&(de=[]),xe===void 0&&(xe=!1),J.applyStyles(J.userStyles),z.settings.showFoot==="everyPage"&&!xe&&z.foot.forEach(function(L){return G(J,z,L,te,de)}),z.callEndPageHooks(J,te);var _=z.settings.margin;(0,u.addTableBorder)(J,z,ae,te),le(J),z.pageNumber++,z.pageCount++,te.x=_.left,te.y=_.top,ae.y=_.top,z.callWillDrawPageHooks(J,te),z.settings.showHead==="everyPage"&&(z.head.forEach(function(L){return G(J,z,L,te,de)}),J.applyStyles(J.userStyles))}c.addPage=M;function le(J){var z=J.pageNumber();J.setPage(z+1);var ae=J.pageNumber();return ae===z?(J.addPage(),!0):!1}},224:function(l,c,h){Object.defineProperty(c,"__esModule",{value:!0}),c.calculateAllColumnsCanFitInPage=void 0;var u=h(420);function g(d,y,x){var b;x===void 0&&(x={});var N=(0,u.getPageAvailableWidth)(d,y),w=new Map,A=[],E=[],W=[];y.settings.horizontalPageBreakRepeat,Array.isArray(y.settings.horizontalPageBreakRepeat)?W=y.settings.horizontalPageBreakRepeat:(typeof y.settings.horizontalPageBreakRepeat=="string"||typeof y.settings.horizontalPageBreakRepeat=="number")&&(W=[y.settings.horizontalPageBreakRepeat]),W.forEach(function(R){var G=y.columns.find(function(j){return j.dataKey===R||j.index===R});G&&!w.has(G.index)&&(w.set(G.index,!0),A.push(G.index),E.push(y.columns[G.index]),N-=G.wrappedWidth)});for(var V=!0,F=(b=x==null?void 0:x.start)!==null&&b!==void 0?b:0;F<y.columns.length;){if(w.has(F)){F++;continue}var C=y.columns[F].wrappedWidth;if(V||N>=C)V=!1,A.push(F),E.push(y.columns[F]),N-=C;else break;F++}return{colIndexes:A,columns:E,lastIndex:F-1}}function m(d,y){for(var x=[],b=0;b<y.columns.length;b++){var N=g(d,y,{start:b});N.columns.length&&(x.push(N),b=N.lastIndex)}return x}c.calculateAllColumnsCanFitInPage=m},324:function(l,c,h){Object.defineProperty(c,"__esModule",{value:!0}),c.ellipsize=c.resizeColumns=c.calculateWidths=void 0;var u=h(420);function g(A,E){m(A,E);var W=[],V=0;E.columns.forEach(function(C){var R=C.getMaxCustomCellWidth(E);R?C.width=R:(C.width=C.wrappedWidth,W.push(C)),V+=C.width});var F=E.getWidth(A.pageSize().width)-V;F&&(F=d(W,F,function(C){return Math.max(C.minReadableWidth,C.minWidth)})),F&&(F=d(W,F,function(C){return C.minWidth})),F=Math.abs(F),!E.settings.horizontalPageBreak&&F>.1/A.scaleFactor()&&(F=F<1?F:Math.round(F),console.warn("Of the table content, ".concat(F," units width could not fit page"))),x(E),b(E,A),y(E)}c.calculateWidths=g;function m(A,E){var W=A.scaleFactor(),V=E.settings.horizontalPageBreak,F=(0,u.getPageAvailableWidth)(A,E);E.allRows().forEach(function(C){for(var R=0,G=E.columns;R<G.length;R++){var j=G[R],T=C.cells[j.index];if(T){var B=E.hooks.didParseCell;E.callCellHooks(A,B,T,C,j,null);var M=T.padding("horizontal");T.contentWidth=(0,u.getStringWidth)(T.text,T.styles,A)+M;var le=(0,u.getStringWidth)(T.text.join(" ").split(/[^\S\u00A0]+/),T.styles,A);if(T.minReadableWidth=le+T.padding("horizontal"),typeof T.styles.cellWidth=="number")T.minWidth=T.styles.cellWidth,T.wrappedWidth=T.styles.cellWidth;else if(T.styles.cellWidth==="wrap"||V===!0)T.contentWidth>F?(T.minWidth=F,T.wrappedWidth=F):(T.minWidth=T.contentWidth,T.wrappedWidth=T.contentWidth);else{var J=10/W;T.minWidth=T.styles.minCellWidth||J,T.wrappedWidth=T.contentWidth,T.minWidth>T.wrappedWidth&&(T.wrappedWidth=T.minWidth)}}}}),E.allRows().forEach(function(C){for(var R=0,G=E.columns;R<G.length;R++){var j=G[R],T=C.cells[j.index];if(T&&T.colSpan===1)j.wrappedWidth=Math.max(j.wrappedWidth,T.wrappedWidth),j.minWidth=Math.max(j.minWidth,T.minWidth),j.minReadableWidth=Math.max(j.minReadableWidth,T.minReadableWidth);else{var B=E.styles.columnStyles[j.dataKey]||E.styles.columnStyles[j.index]||{},M=B.cellWidth||B.minCellWidth;M&&typeof M=="number"&&(j.minWidth=M,j.wrappedWidth=M)}T&&(T.colSpan>1&&!j.minWidth&&(j.minWidth=T.minWidth),T.colSpan>1&&!j.wrappedWidth&&(j.wrappedWidth=T.minWidth))}})}function d(A,E,W){for(var V=E,F=A.reduce(function(J,z){return J+z.wrappedWidth},0),C=0;C<A.length;C++){var R=A[C],G=R.wrappedWidth/F,j=V*G,T=R.width+j,B=W(R),M=T<B?B:T;E-=M-R.width,R.width=M}if(E=Math.round(E*1e10)/1e10,E){var le=A.filter(function(J){return E<0?J.width>W(J):!0});le.length&&(E=d(le,E,W))}return E}c.resizeColumns=d;function y(A){for(var E={},W=1,V=A.allRows(),F=0;F<V.length;F++)for(var C=V[F],R=0,G=A.columns;R<G.length;R++){var j=G[R],T=E[j.index];if(W>1)W--,delete C.cells[j.index];else if(T)T.cell.height+=C.height,W=T.cell.colSpan,delete C.cells[j.index],T.left--,T.left<=1&&delete E[j.index];else{var B=C.cells[j.index];if(!B)continue;if(B.height=C.height,B.rowSpan>1){var M=V.length-F,le=B.rowSpan>M?M:B.rowSpan;E[j.index]={cell:B,left:le,row:C}}}}}function x(A){for(var E=A.allRows(),W=0;W<E.length;W++)for(var V=E[W],F=null,C=0,R=0,G=0;G<A.columns.length;G++){var j=A.columns[G];if(R-=1,R>1&&A.columns[G+1])C+=j.width,delete V.cells[j.index];else if(F){var T=F;delete V.cells[j.index],F=null,T.width=j.width+C}else{var T=V.cells[j.index];if(!T)continue;if(R=T.colSpan,C=0,T.colSpan>1){F=T,C+=j.width;continue}T.width=j.width+C}}}function b(A,E){for(var W={count:0,height:0},V=0,F=A.allRows();V<F.length;V++){for(var C=F[V],R=0,G=A.columns;R<G.length;R++){var j=G[R],T=C.cells[j.index];if(T){E.applyStyles(T.styles,!0);var B=T.width-T.padding("horizontal");if(T.styles.overflow==="linebreak")T.text=E.splitTextToSize(T.text,B+1/E.scaleFactor(),{fontSize:T.styles.fontSize});else if(T.styles.overflow==="ellipsize")T.text=N(T.text,B,T.styles,E,"...");else if(T.styles.overflow==="hidden")T.text=N(T.text,B,T.styles,E,"");else if(typeof T.styles.overflow=="function"){var M=T.styles.overflow(T.text,B);typeof M=="string"?T.text=[M]:T.text=M}T.contentHeight=T.getContentHeight(E.scaleFactor(),E.getLineHeightFactor());var le=T.contentHeight/T.rowSpan;T.rowSpan>1&&W.count*W.height<le*T.rowSpan?W={height:le,count:T.rowSpan}:W&&W.count>0&&W.height>le&&(le=W.height),le>C.height&&(C.height=le)}}W.count--}}function N(A,E,W,V,F){return A.map(function(C){return w(C,E,W,V,F)})}c.ellipsize=N;function w(A,E,W,V,F){var C=1e4*V.scaleFactor();if(E=Math.ceil(E*C)/C,E>=(0,u.getStringWidth)(A,W,V))return A;for(;E<(0,u.getStringWidth)(A+F,W,V)&&!(A.length<=1);)A=A.substring(0,A.length-1);return A.trim()+F}},964:function(l){if(typeof t>"u"){var c=new Error("Cannot find module 'undefined'");throw c.code="MODULE_NOT_FOUND",c}l.exports=t}},a={};function i(l){var c=a[l];if(c!==void 0)return c.exports;var h=a[l]={exports:{}};return n[l].call(h.exports,h,h.exports,i),h.exports}var o={};return function(){var l=o;Object.defineProperty(l,"__esModule",{value:!0}),l.Cell=l.Column=l.Row=l.Table=l.CellHookData=l.__drawTable=l.__createTable=l.applyPlugin=void 0;var c=i(340),h=i(776),u=i(664),g=i(972),m=i(260);Object.defineProperty(l,"Table",{enumerable:!0,get:function(){return m.Table}});var d=i(172);Object.defineProperty(l,"CellHookData",{enumerable:!0,get:function(){return d.CellHookData}});var y=i(260);Object.defineProperty(l,"Cell",{enumerable:!0,get:function(){return y.Cell}}),Object.defineProperty(l,"Column",{enumerable:!0,get:function(){return y.Column}}),Object.defineProperty(l,"Row",{enumerable:!0,get:function(){return y.Row}});function x(E){(0,c.default)(E)}l.applyPlugin=x;function b(E,W){var V=(0,h.parseInput)(E,W),F=(0,g.createTable)(E,V);(0,u.drawTable)(E,F)}function N(E,W){var V=(0,h.parseInput)(E,W);return(0,g.createTable)(E,V)}l.__createTable=N;function w(E,W){(0,u.drawTable)(E,W)}l.__drawTable=w;try{var A=i(964);A.jsPDF&&(A=A.jsPDF),x(A)}catch{}l.default=b}(),o}()})})(Xp);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Kl={};Kl.version="0.18.5";var Fu=1252,Jp=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Lu=function(e){Jp.indexOf(e)!=-1&&(Fu=e)};function Zp(){Lu(1252)}var Po=function(e){Lu(e)};function Qp(){Po(1200),Zp()}var Bl=function(r){return String.fromCharCode(r)},ph=function(r){return String.fromCharCode(r)},Jl,di="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Oo(e){for(var r="",t=0,n=0,a=0,i=0,o=0,l=0,c=0,h=0;h<e.length;)t=e.charCodeAt(h++),i=t>>2,n=e.charCodeAt(h++),o=(t&3)<<4|n>>4,a=e.charCodeAt(h++),l=(n&15)<<2|a>>6,c=a&63,isNaN(n)?l=c=64:isNaN(a)&&(c=64),r+=di.charAt(i)+di.charAt(o)+di.charAt(l)+di.charAt(c);return r}function za(e){var r="",t=0,n=0,a=0,i=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<e.length;)i=di.indexOf(e.charAt(h++)),o=di.indexOf(e.charAt(h++)),t=i<<2|o>>4,r+=String.fromCharCode(t),l=di.indexOf(e.charAt(h++)),n=(o&15)<<4|l>>2,l!==64&&(r+=String.fromCharCode(n)),c=di.indexOf(e.charAt(h++)),a=(l&3)<<6|c,c!==64&&(r+=String.fromCharCode(a));return r}var Ut=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ga=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function Ui(e){return Ut?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function mh(e){return Ut?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var fa=function(r){return Ut?Ga(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function pc(e){if(typeof ArrayBuffer>"u")return fa(e);for(var r=new ArrayBuffer(e.length),t=new Uint8Array(r),n=0;n!=e.length;++n)t[n]=e.charCodeAt(n)&255;return r}function Ho(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function em(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Gr=Ut?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:Ga(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),a=0;for(r=0,t=0;r<e.length;t+=a,++r)if(a=e[r].length,e[r]instanceof Uint8Array)n.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";n.set(new Uint8Array(e[r]),t)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function tm(e){for(var r=[],t=0,n=e.length+250,a=Ui(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)a[t++]=o;else if(o<2048)a[t++]=192|o>>6&31,a[t++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++i)&1023;a[t++]=240|o>>8&7,a[t++]=128|o>>2&63,a[t++]=128|l>>6&15|(o&3)<<4,a[t++]=128|l&63}else a[t++]=224|o>>12&15,a[t++]=128|o>>6&63,a[t++]=128|o&63;t>n&&(r.push(a.slice(0,t)),t=0,a=Ui(65535),n=65530)}return r.push(a.slice(0,t)),Gr(r)}var _o=/\u0000/g,Ul=/[\u0001-\u0006]/g;function Ts(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function ha(e,r){var t=""+e;return t.length>=r?t:pr("0",r-t.length)+t}function Y0(e,r){var t=""+e;return t.length>=r?t:pr(" ",r-t.length)+t}function Zl(e,r){var t=""+e;return t.length>=r?t:t+pr(" ",r-t.length)}function rm(e,r){var t=""+Math.round(e);return t.length>=r?t:pr("0",r-t.length)+t}function nm(e,r){var t=""+e;return t.length>=r?t:pr("0",r-t.length)+t}var gh=Math.pow(2,32);function ys(e,r){if(e>gh||e<-gh)return rm(e,r);var t=Math.round(e);return nm(t,r)}function Ql(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var xh=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],m0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function am(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "',e}var mr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "'},vh={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},im={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ec(e,r,t){for(var n=e<0?-1:1,a=e*n,i=0,o=1,l=0,c=1,h=0,u=0,g=Math.floor(a);h<r&&(g=Math.floor(a),l=g*o+i,u=g*h+c,!(a-g<5e-8));)a=1/(a-g),i=o,o=l,c=h,h=u;if(u>r&&(h>r?(u=c,l=i):(u=h,l=o)),!t)return[0,n*l,u];var m=Math.floor(n*l/u);return[m,n*l-m*u,u]}function Hl(e,r,t){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,o=[],l={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),r&&r.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++n,++l.D)),n===60)o=t?[1317,10,29]:[1900,2,29],i=3;else if(n===0)o=t?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),t&&(i=um(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=i,l}var Cu=new Date(1899,11,31,0,0,0),sm=Cu.getTime(),om=new Date(1900,2,1,0,0,0);function Pu(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=om&&(t+=24*60*60*1e3),(t-(sm+(e.getTimezoneOffset()-Cu.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function X0(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function lm(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function cm(e){var r=e<0?12:11,t=X0(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function fm(e){var r=X0(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function hm(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=cm(e):r===10?t=e.toFixed(10).substr(0,12):t=fm(e),X0(lm(t.toUpperCase()))}function B0(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):hm(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return vi(14,Pu(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function um(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function dm(e,r,t,n){var a="",i=0,o=0,l=t.y,c,h=0;switch(e){case 98:l=t.y+543;case 121:switch(r.length){case 1:case 2:c=l%100,h=2;break;default:c=l%1e4,h=4;break}break;case 109:switch(r.length){case 1:case 2:c=t.m,h=r.length;break;case 3:return m0[t.m-1][1];case 5:return m0[t.m-1][0];default:return m0[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:c=t.d,h=r.length;break;case 3:return xh[t.q][0];default:return xh[t.q][1]}break;case 104:switch(r.length){case 1:case 2:c=1+(t.H+11)%12,h=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:c=t.H,h=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:c=t.M,h=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?ha(t.S,r.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,i=Math.round(o*(t.S+t.u)),i>=60*o&&(i=0),r==="s"?i===0?"0":""+i/o:(a=ha(i,2+n),r==="ss"?a.substr(0,2):"."+a.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":c=t.D*24+t.H;break;case"[m]":case"[mm]":c=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":c=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}h=r.length===3?1:2;break;case 101:c=l,h=1;break}var u=h>0?ha(c,h):"";return u}function pi(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,n=e.substr(0,t);t!=e.length;t+=r)n+=(n.length>0?",":"")+e.substr(t,r);return n}var Ou=/%/g;function pm(e,r,t){var n=r.replace(Ou,""),a=r.length-n.length;return Ha(e,n,t*Math.pow(10,2*a))+pr("%",a)}function mm(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Ha(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function Iu(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Iu(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%a;if(i<0&&(i+=a),t=(r/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),t.indexOf("e")===-1){var o=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+i):t+="E+"+(o-i);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,a)+"."+t.substr(2+a),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,h,u){return c+h+u.substr(0,(a+i)%a)+"."+u.substr(i)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Du=/# (\?+)( ?)\/( ?)(\d+)/;function gm(e,r,t){var n=parseInt(e[4],10),a=Math.round(r*n),i=Math.floor(a/n),o=a-i*n,l=n;return t+(i===0?"":""+i)+" "+(o===0?pr(" ",e[1].length+1+e[4].length):Y0(o,e[1].length)+e[2]+"/"+e[3]+ha(l,e[4].length))}function xm(e,r,t){return t+(r===0?"":""+r)+pr(" ",e[1].length+2+e[4].length)}var Ru=/^#*0*\.([0#]+)/,Mu=/\).*[0#]/,Bu=/\(###\) ###\\?-####/;function fn(e){for(var r="",t,n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function yh(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function wh(e,r){var t=e-Math.floor(e),n=Math.pow(10,r);return r<(""+Math.round(t*n)).length?0:Math.round(t*n)}function vm(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function ym(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Yn(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Mu)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Yn("n",n,t):"("+Yn("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return mm(e,r,t);if(r.indexOf("%")!==-1)return pm(e,r,t);if(r.indexOf("E")!==-1)return Iu(r,t);if(r.charCodeAt(0)===36)return"$"+Yn(e,r.substr(r.charAt(1)==" "?2:1),t);var a,i,o,l,c=Math.abs(t),h=t<0?"-":"";if(r.match(/^00+$/))return h+ys(c,r.length);if(r.match(/^[#?]+$/))return a=ys(t,0),a==="0"&&(a=""),a.length>r.length?a:fn(r.substr(0,r.length-a.length))+a;if(i=r.match(Du))return gm(i,c,h);if(r.match(/^#+0+$/))return h+ys(c,r.length-r.indexOf("0"));if(i=r.match(Ru))return a=yh(t,i[1].length).replace(/^([^\.]+)$/,"$1."+fn(i[1])).replace(/\.$/,"."+fn(i[1])).replace(/\.(\d*)$/,function(y,x){return"."+x+pr("0",fn(i[1]).length-x.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),i=r.match(/^(0*)\.(#*)$/))return h+yh(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=r.match(/^#{1,3},##0(\.?)$/))return h+pi(ys(c,0));if(i=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Yn(e,r,-t):pi(""+(Math.floor(t)+vm(t,i[1].length)))+"."+ha(wh(t,i[1].length),i[1].length);if(i=r.match(/^#,#*,#0/))return Yn(e,r.replace(/^#,#*,/,""),t);if(i=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Ts(Yn(e,r.replace(/[\\-]/g,""),t)),o=0,Ts(Ts(r.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<a.length?a.charAt(o++):y==="0"?"0":""}));if(r.match(Bu))return a=Yn(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=ec(c,Math.pow(10,o)-1,!1),a=""+h,u=Ha("n",i[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],u=Zl(l[2],o),u.length<i[4].length&&(u=fn(i[4].substr(i[4].length-u.length))+u),a+=u,a;if(i=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=ec(c,Math.pow(10,o)-1,!0),h+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Y0(l[1],o)+i[2]+"/"+i[3]+Zl(l[2],o):pr(" ",2*o+1+i[2].length+i[3].length));if(i=r.match(/^[#0?]+$/))return a=ys(t,0),r.length<=a.length?a:fn(r.substr(0,r.length-a.length))+a;if(i=r.match(/^([#0?]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var g=r.indexOf(".")-o,m=r.length-a.length-g;return fn(r.substr(0,g)+a+r.substr(r.length-m))}if(i=r.match(/^00,000\.([#0]*0)$/))return o=wh(t,i[1].length),t<0?"-"+Yn(e,r,-t):pi(ym(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?ha(0,3-y.length):"")+y})+"."+ha(o,i[1].length);switch(r){case"###,##0.00":return Yn(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var d=pi(ys(c,0));return d!=="0"?h+d:"";case"###,###.00":return Yn(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Yn(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function wm(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Ha(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function bm(e,r,t){var n=r.replace(Ou,""),a=r.length-n.length;return Ha(e,n,t*Math.pow(10,2*a))+pr("%",a)}function Uu(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Uu(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%a;if(i<0&&(i+=a),t=(r/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!t.match(/[Ee]/)){var o=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+i):t+="E+"+(o-i),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,h,u){return c+h+u.substr(0,(a+i)%a)+"."+u.substr(i)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Sa(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Mu)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Sa("n",n,t):"("+Sa("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return wm(e,r,t);if(r.indexOf("%")!==-1)return bm(e,r,t);if(r.indexOf("E")!==-1)return Uu(r,t);if(r.charCodeAt(0)===36)return"$"+Sa(e,r.substr(r.charAt(1)==" "?2:1),t);var a,i,o,l,c=Math.abs(t),h=t<0?"-":"";if(r.match(/^00+$/))return h+ha(c,r.length);if(r.match(/^[#?]+$/))return a=""+t,t===0&&(a=""),a.length>r.length?a:fn(r.substr(0,r.length-a.length))+a;if(i=r.match(Du))return xm(i,c,h);if(r.match(/^#+0+$/))return h+ha(c,r.length-r.indexOf("0"));if(i=r.match(Ru))return a=(""+t).replace(/^([^\.]+)$/,"$1."+fn(i[1])).replace(/\.$/,"."+fn(i[1])),a=a.replace(/\.(\d*)$/,function(y,x){return"."+x+pr("0",fn(i[1]).length-x.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),i=r.match(/^(0*)\.(#*)$/))return h+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=r.match(/^#{1,3},##0(\.?)$/))return h+pi(""+c);if(i=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Sa(e,r,-t):pi(""+t)+"."+pr("0",i[1].length);if(i=r.match(/^#,#*,#0/))return Sa(e,r.replace(/^#,#*,/,""),t);if(i=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Ts(Sa(e,r.replace(/[\\-]/g,""),t)),o=0,Ts(Ts(r.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<a.length?a.charAt(o++):y==="0"?"0":""}));if(r.match(Bu))return a=Sa(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=ec(c,Math.pow(10,o)-1,!1),a=""+h,u=Ha("n",i[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],u=Zl(l[2],o),u.length<i[4].length&&(u=fn(i[4].substr(i[4].length-u.length))+u),a+=u,a;if(i=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=ec(c,Math.pow(10,o)-1,!0),h+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Y0(l[1],o)+i[2]+"/"+i[3]+Zl(l[2],o):pr(" ",2*o+1+i[2].length+i[3].length));if(i=r.match(/^[#0?]+$/))return a=""+t,r.length<=a.length?a:fn(r.substr(0,r.length-a.length))+a;if(i=r.match(/^([#0]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var g=r.indexOf(".")-o,m=r.length-a.length-g;return fn(r.substr(0,g)+a+r.substr(r.length-m))}if(i=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Sa(e,r,-t):pi(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?ha(0,3-y.length):"")+y})+"."+ha(0,i[1].length);switch(r){case"###,###":case"##,###":case"#,###":var d=pi(""+c);return d!=="0"?h+d:"";default:if(r.match(/\.[0#?]*$/))return Sa(e,r.slice(0,r.lastIndexOf(".")),t)+fn(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function Ha(e,r,t){return(t|0)===t?Sa(e,r,t):Yn(e,r,t)}function Nm(e){for(var r=[],t=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=e.substr(a,n-a),a=n+1}if(r[r.length]=e.substr(a),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var Hu=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Wu(e){for(var r=0,t="",n="";r<e.length;)switch(t=e.charAt(r)){case"G":Ql(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"ä¸Š":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="ä¸Šåˆ/ä¸‹åˆ")return!0;++r;break;case"[":for(n=t;e.charAt(r++)!=="]"&&r<e.length;)n+=e.charAt(r);if(n.match(Hu))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function Sm(e,r,t,n){for(var a=[],i="",o=0,l="",c="t",h,u,g,m="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!Ql(e,o))throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(g=e.charCodeAt(++o))!==34&&o<e.length;)i+=String.fromCharCode(g);a[a.length]={t:"t",v:i},++o;break;case"\\":var d=e.charAt(++o),y=d==="("||d===")"?d:"t";a[a.length]={t:y,v:d},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:r},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(h==null&&(h=Hl(r,t,e.charAt(o+1)==="2"),h==null))return"";a[a.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||h==null&&(h=Hl(r,t),h==null))return"";for(i=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)i+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=m),a[a.length]={t:l,v:i},c=l;break;case"A":case"a":case"ä¸Š":var x={t:l,v:l};if(h==null&&(h=Hl(r,t)),e.substr(o,3).toUpperCase()==="A/P"?(h!=null&&(x.v=h.H>=12?"P":"A"),x.t="T",m="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(h!=null&&(x.v=h.H>=12?"PM":"AM"),x.t="T",o+=5,m="h"):e.substr(o,5).toUpperCase()==="ä¸Šåˆ/ä¸‹åˆ"?(h!=null&&(x.v=h.H>=12?"ä¸‹åˆ":"ä¸Šåˆ"),x.t="T",o+=5,m="h"):(x.t="t",++o),h==null&&x.t==="T")return"";a[a.length]=x,c=l;break;case"[":for(i=l;e.charAt(o++)!=="]"&&o<e.length;)i+=e.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(Hu)){if(h==null&&(h=Hl(r,t),h==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Wu(e)||(a[a.length]={t:"t",v:i}));break;case".":if(h!=null){for(i=l;++o<e.length&&(l=e.charAt(o))==="0";)i+=l;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)i+=l;a[a.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++o)===l;)i+=l;a[a.length]={t:l,v:i},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)i+=e.charAt(o);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:l,v:l},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=â‚¬acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"t",v:l},++o;break}var b=0,N=0,w;for(o=a.length-1,c="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=m,c="h",b<1&&(b=1);break;case"s":(w=a[o].v.match(/\.0+$/))&&(N=Math.max(N,w[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":c=a[o].t;break;case"m":c==="s"&&(a[o].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&a[o].v.match(/[Hh]/)&&(b=1),b<2&&a[o].v.match(/[Mm]/)&&(b=2),b<3&&a[o].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var A="",E;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=dm(a[o].t.charCodeAt(0),a[o].v,h,N),a[o].t="t";break;case"n":case"?":for(E=o+1;a[E]!=null&&((l=a[E].t)==="?"||l==="D"||(l===" "||l==="t")&&a[E+1]!=null&&(a[E+1].t==="?"||a[E+1].t==="t"&&a[E+1].v==="/")||a[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[E].v==="/"||a[E].v===" "&&a[E+1]!=null&&a[E+1].t=="?"));)a[o].v+=a[E].v,a[E]={v:"",t:";"},++E;A+=a[o].v,o=E-1;break;case"G":a[o].t="t",a[o].v=B0(r,t);break}var W="",V,F;if(A.length>0){A.charCodeAt(0)==40?(V=r<0&&A.charCodeAt(0)===45?-r:r,F=Ha("n",A,V)):(V=r<0&&n>1?-r:r,F=Ha("n",A,V),V<0&&a[0]&&a[0].t=="t"&&(F=F.substr(1),a[0].v="-"+a[0].v)),E=F.length-1;var C=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){C=o;break}var R=a.length;if(C===a.length&&F.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(E>=a[o].v.length-1?(E-=a[o].v.length,a[o].v=F.substr(E+1,a[o].v.length)):E<0?a[o].v="":(a[o].v=F.substr(0,E+1),E=-1),a[o].t="t",R=o);E>=0&&R<a.length&&(a[R].v=F.substr(0,E+1)+a[R].v)}else if(C!==a.length&&F.indexOf("E")===-1){for(E=F.indexOf(".")-1,o=C;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(u=a[o].v.indexOf(".")>-1&&o===C?a[o].v.indexOf(".")-1:a[o].v.length-1,W=a[o].v.substr(u+1);u>=0;--u)E>=0&&(a[o].v.charAt(u)==="0"||a[o].v.charAt(u)==="#")&&(W=F.charAt(E--)+W);a[o].v=W,a[o].t="t",R=o}for(E>=0&&R<a.length&&(a[R].v=F.substr(0,E+1)+a[R].v),E=F.indexOf(".")+1,o=C;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==C)){for(u=a[o].v.indexOf(".")>-1&&o===C?a[o].v.indexOf(".")+1:0,W=a[o].v.substr(0,u);u<a[o].v.length;++u)E<F.length&&(W+=F.charAt(E++));a[o].v=W,a[o].t="t",R=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(V=n>1&&r<0&&o>0&&a[o-1].v==="-"?-r:r,a[o].v=Ha(a[o].t,a[o].v,V),a[o].t="t");var G="";for(o=0;o!==a.length;++o)a[o]!=null&&(G+=a[o].v);return G}var bh=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Nh(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function _m(e,r){var t=Nm(e),n=t.length,a=t[n-1].indexOf("@");if(n<4&&a>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||a>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=a>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=a>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=a>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var i=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,i];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var o=t[0].match(bh),l=t[1].match(bh);return Nh(r,o)?[n,t[0]]:Nh(r,l)?[n,t[1]]:[n,t[o!=null&&l!=null?2:1]]}return[n,i]}function vi(e,r,t){t==null&&(t={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?n=t.dateNF:n=e;break;case"number":e==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:mr)[e],n==null&&(n=t.table&&t.table[vh[e]]||mr[vh[e]]),n==null&&(n=im[e]||"General");break}if(Ql(n,0))return B0(r,t);r instanceof Date&&(r=Pu(r,t.date1904));var a=_m(n,r);if(Ql(a[1]))return B0(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return Sm(a[1],r,t,a[0])}function qu(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(mr[t]==null){r<0&&(r=t);continue}if(mr[t]==e){r=t;break}}r<0&&(r=391)}return mr[r]=e,r}function mc(e){for(var r=0;r!=392;++r)e[r]!==void 0&&qu(e[r],r)}function gc(){mr=am()}var zu=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Am(e){var r=typeof e=="number"?mr[e]:e;return r=r.replace(zu,"(\\d+)"),new RegExp("^"+r+"$")}function jm(e,r,t){var n=-1,a=-1,i=-1,o=-1,l=-1,c=-1;(r.match(zu)||[]).forEach(function(g,m){var d=parseInt(t[m+1],10);switch(g.toLowerCase().charAt(0)){case"y":n=d;break;case"d":i=d;break;case"h":o=d;break;case"s":c=d;break;case"m":o>=0?l=d:a=d;break}}),c>=0&&l==-1&&a>=0&&(l=a,a=-1);var h=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?h:n==-1&&a==-1&&i==-1?u:h+"T"+u}var Tm=function(){var e={};e.version="1.2.0";function r(){for(var F=0,C=new Array(256),R=0;R!=256;++R)F=R,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,C[R]=F;return typeof Int32Array<"u"?new Int32Array(C):C}var t=r();function n(F){var C=0,R=0,G=0,j=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(G=0;G!=256;++G)j[G]=F[G];for(G=0;G!=256;++G)for(R=F[G],C=256+G;C<4096;C+=256)R=j[C]=R>>>8^F[R&255];var T=[];for(G=1;G!=16;++G)T[G-1]=typeof Int32Array<"u"?j.subarray(G*256,G*256+256):j.slice(G*256,G*256+256);return T}var a=n(t),i=a[0],o=a[1],l=a[2],c=a[3],h=a[4],u=a[5],g=a[6],m=a[7],d=a[8],y=a[9],x=a[10],b=a[11],N=a[12],w=a[13],A=a[14];function E(F,C){for(var R=C^-1,G=0,j=F.length;G<j;)R=R>>>8^t[(R^F.charCodeAt(G++))&255];return~R}function W(F,C){for(var R=C^-1,G=F.length-15,j=0;j<G;)R=A[F[j++]^R&255]^w[F[j++]^R>>8&255]^N[F[j++]^R>>16&255]^b[F[j++]^R>>>24]^x[F[j++]]^y[F[j++]]^d[F[j++]]^m[F[j++]]^g[F[j++]]^u[F[j++]]^h[F[j++]]^c[F[j++]]^l[F[j++]]^o[F[j++]]^i[F[j++]]^t[F[j++]];for(G+=15;j<G;)R=R>>>8^t[(R^F[j++])&255];return~R}function V(F,C){for(var R=C^-1,G=0,j=F.length,T=0,B=0;G<j;)T=F.charCodeAt(G++),T<128?R=R>>>8^t[(R^T)&255]:T<2048?(R=R>>>8^t[(R^(192|T>>6&31))&255],R=R>>>8^t[(R^(128|T&63))&255]):T>=55296&&T<57344?(T=(T&1023)+64,B=F.charCodeAt(G++)&1023,R=R>>>8^t[(R^(240|T>>8&7))&255],R=R>>>8^t[(R^(128|T>>2&63))&255],R=R>>>8^t[(R^(128|B>>6&15|(T&3)<<4))&255],R=R>>>8^t[(R^(128|B&63))&255]):(R=R>>>8^t[(R^(224|T>>12&15))&255],R=R>>>8^t[(R^(128|T>>6&63))&255],R=R>>>8^t[(R^(128|T&63))&255]);return~R}return e.table=t,e.bstr=E,e.buf=W,e.str=V,e}(),Jt=function(){var r={};r.version="1.2.1";function t(H,ne){for(var Z=H.split("/"),Q=ne.split("/"),re=0,ie=0,Ne=Math.min(Z.length,Q.length);re<Ne;++re){if(ie=Z[re].length-Q[re].length)return ie;if(Z[re]!=Q[re])return Z[re]<Q[re]?-1:1}return Z.length-Q.length}function n(H){if(H.charAt(H.length-1)=="/")return H.slice(0,-1).indexOf("/")===-1?H:n(H.slice(0,-1));var ne=H.lastIndexOf("/");return ne===-1?H:H.slice(0,ne+1)}function a(H){if(H.charAt(H.length-1)=="/")return a(H.slice(0,-1));var ne=H.lastIndexOf("/");return ne===-1?H:H.slice(ne+1)}function i(H,ne){typeof ne=="string"&&(ne=new Date(ne));var Z=ne.getHours();Z=Z<<6|ne.getMinutes(),Z=Z<<5|ne.getSeconds()>>>1,H.write_shift(2,Z);var Q=ne.getFullYear()-1980;Q=Q<<4|ne.getMonth()+1,Q=Q<<5|ne.getDate(),H.write_shift(2,Q)}function o(H){var ne=H.read_shift(2)&65535,Z=H.read_shift(2)&65535,Q=new Date,re=Z&31;Z>>>=5;var ie=Z&15;Z>>>=4,Q.setMilliseconds(0),Q.setFullYear(Z+1980),Q.setMonth(ie-1),Q.setDate(re);var Ne=ne&31;ne>>>=5;var Ee=ne&63;return ne>>>=6,Q.setHours(ne),Q.setMinutes(Ee),Q.setSeconds(Ne<<1),Q}function l(H){Cn(H,0);for(var ne={},Z=0;H.l<=H.length-4;){var Q=H.read_shift(2),re=H.read_shift(2),ie=H.l+re,Ne={};switch(Q){case 21589:Z=H.read_shift(1),Z&1&&(Ne.mtime=H.read_shift(4)),re>5&&(Z&2&&(Ne.atime=H.read_shift(4)),Z&4&&(Ne.ctime=H.read_shift(4))),Ne.mtime&&(Ne.mt=new Date(Ne.mtime*1e3));break}H.l=ie,ne[Q]=Ne}return ne}var c;function h(){return c||(c={})}function u(H,ne){if(H[0]==80&&H[1]==75)return ir(H,ne);if((H[0]|32)==109&&(H[1]|32)==105)return Bn(H,ne);if(H.length<512)throw new Error("CFB file size "+H.length+" < 512");var Z=3,Q=512,re=0,ie=0,Ne=0,Ee=0,be=0,Ae=[],je=H.slice(0,512);Cn(je,0);var qe=g(je);switch(Z=qe[0],Z){case 3:Q=512;break;case 4:Q=4096;break;case 0:if(qe[1]==0)return ir(H,ne);default:throw new Error("Major Version: Expected 3 or 4 saw "+Z)}Q!==512&&(je=H.slice(0,Q),Cn(je,28));var $e=H.slice(0,Q);m(je,Z);var nt=je.read_shift(4,"i");if(Z===3&&nt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+nt);je.l+=4,Ne=je.read_shift(4,"i"),je.l+=4,je.chk("00100000","Mini Stream Cutoff Size: "),Ee=je.read_shift(4,"i"),re=je.read_shift(4,"i"),be=je.read_shift(4,"i"),ie=je.read_shift(4,"i");for(var Ve=-1,rt=0;rt<109&&(Ve=je.read_shift(4,"i"),!(Ve<0));++rt)Ae[rt]=Ve;var gt=d(H,Q);b(be,ie,gt,Q,Ae);var Wt=w(gt,Ne,Ae,Q);Wt[Ne].name="!Directory",re>0&&Ee!==B&&(Wt[Ee].name="!MiniFAT"),Wt[Ae[0]].name="!FAT",Wt.fat_addrs=Ae,Wt.ssz=Q;var Xt={},Sr=[],Zn=[],Fa=[];A(Ne,Wt,gt,Sr,re,Xt,Zn,Ee),y(Zn,Fa,Sr),Sr.shift();var ga={FileIndex:Zn,FullPaths:Fa};return ne&&ne.raw&&(ga.raw={header:$e,sectors:gt}),ga}function g(H){if(H[H.l]==80&&H[H.l+1]==75)return[0,0];H.chk(M,"Header Signature: "),H.l+=16;var ne=H.read_shift(2,"u");return[H.read_shift(2,"u"),ne]}function m(H,ne){var Z=9;switch(H.l+=2,Z=H.read_shift(2)){case 9:if(ne!=3)throw new Error("Sector Shift: Expected 9 saw "+Z);break;case 12:if(ne!=4)throw new Error("Sector Shift: Expected 12 saw "+Z);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Z)}H.chk("0600","Mini Sector Shift: "),H.chk("000000000000","Reserved: ")}function d(H,ne){for(var Z=Math.ceil(H.length/ne)-1,Q=[],re=1;re<Z;++re)Q[re-1]=H.slice(re*ne,(re+1)*ne);return Q[Z-1]=H.slice(Z*ne),Q}function y(H,ne,Z){for(var Q=0,re=0,ie=0,Ne=0,Ee=0,be=Z.length,Ae=[],je=[];Q<be;++Q)Ae[Q]=je[Q]=Q,ne[Q]=Z[Q];for(;Ee<je.length;++Ee)Q=je[Ee],re=H[Q].L,ie=H[Q].R,Ne=H[Q].C,Ae[Q]===Q&&(re!==-1&&Ae[re]!==re&&(Ae[Q]=Ae[re]),ie!==-1&&Ae[ie]!==ie&&(Ae[Q]=Ae[ie])),Ne!==-1&&(Ae[Ne]=Q),re!==-1&&Q!=Ae[Q]&&(Ae[re]=Ae[Q],je.lastIndexOf(re)<Ee&&je.push(re)),ie!==-1&&Q!=Ae[Q]&&(Ae[ie]=Ae[Q],je.lastIndexOf(ie)<Ee&&je.push(ie));for(Q=1;Q<be;++Q)Ae[Q]===Q&&(ie!==-1&&Ae[ie]!==ie?Ae[Q]=Ae[ie]:re!==-1&&Ae[re]!==re&&(Ae[Q]=Ae[re]));for(Q=1;Q<be;++Q)if(H[Q].type!==0){if(Ee=Q,Ee!=Ae[Ee])do Ee=Ae[Ee],ne[Q]=ne[Ee]+"/"+ne[Q];while(Ee!==0&&Ae[Ee]!==-1&&Ee!=Ae[Ee]);Ae[Q]=-1}for(ne[0]+="/",Q=1;Q<be;++Q)H[Q].type!==2&&(ne[Q]+="/")}function x(H,ne,Z){for(var Q=H.start,re=H.size,ie=[],Ne=Q;Z&&re>0&&Ne>=0;)ie.push(ne.slice(Ne*T,Ne*T+T)),re-=T,Ne=Pi(Z,Ne*4);return ie.length===0?Ce(0):Gr(ie).slice(0,H.size)}function b(H,ne,Z,Q,re){var ie=B;if(H===B){if(ne!==0)throw new Error("DIFAT chain shorter than expected")}else if(H!==-1){var Ne=Z[H],Ee=(Q>>>2)-1;if(!Ne)return;for(var be=0;be<Ee&&(ie=Pi(Ne,be*4))!==B;++be)re.push(ie);b(Pi(Ne,Q-4),ne-1,Z,Q,re)}}function N(H,ne,Z,Q,re){var ie=[],Ne=[];re||(re=[]);var Ee=Q-1,be=0,Ae=0;for(be=ne;be>=0;){re[be]=!0,ie[ie.length]=be,Ne.push(H[be]);var je=Z[Math.floor(be*4/Q)];if(Ae=be*4&Ee,Q<4+Ae)throw new Error("FAT boundary crossed: "+be+" 4 "+Q);if(!H[je])break;be=Pi(H[je],Ae)}return{nodes:ie,data:Fh([Ne])}}function w(H,ne,Z,Q){var re=H.length,ie=[],Ne=[],Ee=[],be=[],Ae=Q-1,je=0,qe=0,$e=0,nt=0;for(je=0;je<re;++je)if(Ee=[],$e=je+ne,$e>=re&&($e-=re),!Ne[$e]){be=[];var Ve=[];for(qe=$e;qe>=0;){Ve[qe]=!0,Ne[qe]=!0,Ee[Ee.length]=qe,be.push(H[qe]);var rt=Z[Math.floor(qe*4/Q)];if(nt=qe*4&Ae,Q<4+nt)throw new Error("FAT boundary crossed: "+qe+" 4 "+Q);if(!H[rt]||(qe=Pi(H[rt],nt),Ve[qe]))break}ie[$e]={nodes:Ee,data:Fh([be])}}return ie}function A(H,ne,Z,Q,re,ie,Ne,Ee){for(var be=0,Ae=Q.length?2:0,je=ne[H].data,qe=0,$e=0,nt;qe<je.length;qe+=128){var Ve=je.slice(qe,qe+128);Cn(Ve,64),$e=Ve.read_shift(2),nt=ef(Ve,0,$e-Ae),Q.push(nt);var rt={name:nt,type:Ve.read_shift(1),color:Ve.read_shift(1),L:Ve.read_shift(4,"i"),R:Ve.read_shift(4,"i"),C:Ve.read_shift(4,"i"),clsid:Ve.read_shift(16),state:Ve.read_shift(4,"i"),start:0,size:0},gt=Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2);gt!==0&&(rt.ct=E(Ve,Ve.l-8));var Wt=Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2);Wt!==0&&(rt.mt=E(Ve,Ve.l-8)),rt.start=Ve.read_shift(4,"i"),rt.size=Ve.read_shift(4,"i"),rt.size<0&&rt.start<0&&(rt.size=rt.type=0,rt.start=B,rt.name=""),rt.type===5?(be=rt.start,re>0&&be!==B&&(ne[be].name="!StreamData")):rt.size>=4096?(rt.storage="fat",ne[rt.start]===void 0&&(ne[rt.start]=N(Z,rt.start,ne.fat_addrs,ne.ssz)),ne[rt.start].name=rt.name,rt.content=ne[rt.start].data.slice(0,rt.size)):(rt.storage="minifat",rt.size<0?rt.size=0:be!==B&&rt.start!==B&&ne[be]&&(rt.content=x(rt,ne[be].data,(ne[Ee]||{}).data))),rt.content&&Cn(rt.content,0),ie[nt]=rt,Ne.push(rt)}}function E(H,ne){return new Date((On(H,ne+4)/1e7*Math.pow(2,32)+On(H,ne)/1e7-11644473600)*1e3)}function W(H,ne){return h(),u(c.readFileSync(H),ne)}function V(H,ne){var Z=ne&&ne.type;switch(Z||Ut&&Buffer.isBuffer(H)&&(Z="buffer"),Z||"base64"){case"file":return W(H,ne);case"base64":return u(fa(za(H)),ne);case"binary":return u(fa(H),ne)}return u(H,ne)}function F(H,ne){var Z=ne||{},Q=Z.root||"Root Entry";if(H.FullPaths||(H.FullPaths=[]),H.FileIndex||(H.FileIndex=[]),H.FullPaths.length!==H.FileIndex.length)throw new Error("inconsistent CFB structure");H.FullPaths.length===0&&(H.FullPaths[0]=Q+"/",H.FileIndex[0]={name:Q,type:5}),Z.CLSID&&(H.FileIndex[0].clsid=Z.CLSID),C(H)}function C(H){var ne="Sh33tJ5";if(!Jt.find(H,"/"+ne)){var Z=Ce(4);Z[0]=55,Z[1]=Z[3]=50,Z[2]=54,H.FileIndex.push({name:ne,type:2,content:Z,size:4,L:69,R:69,C:69}),H.FullPaths.push(H.FullPaths[0]+ne),R(H)}}function R(H,ne){F(H);for(var Z=!1,Q=!1,re=H.FullPaths.length-1;re>=0;--re){var ie=H.FileIndex[re];switch(ie.type){case 0:Q?Z=!0:(H.FileIndex.pop(),H.FullPaths.pop());break;case 1:case 2:case 5:Q=!0,isNaN(ie.R*ie.L*ie.C)&&(Z=!0),ie.R>-1&&ie.L>-1&&ie.R==ie.L&&(Z=!0);break;default:Z=!0;break}}if(!(!Z&&!ne)){var Ne=new Date(1987,1,19),Ee=0,be=Object.create?Object.create(null):{},Ae=[];for(re=0;re<H.FullPaths.length;++re)be[H.FullPaths[re]]=!0,H.FileIndex[re].type!==0&&Ae.push([H.FullPaths[re],H.FileIndex[re]]);for(re=0;re<Ae.length;++re){var je=n(Ae[re][0]);Q=be[je],Q||(Ae.push([je,{name:a(je).replace("/",""),type:1,clsid:J,ct:Ne,mt:Ne,content:null}]),be[je]=!0)}for(Ae.sort(function(nt,Ve){return t(nt[0],Ve[0])}),H.FullPaths=[],H.FileIndex=[],re=0;re<Ae.length;++re)H.FullPaths[re]=Ae[re][0],H.FileIndex[re]=Ae[re][1];for(re=0;re<Ae.length;++re){var qe=H.FileIndex[re],$e=H.FullPaths[re];if(qe.name=a($e).replace("/",""),qe.L=qe.R=qe.C=-(qe.color=1),qe.size=qe.content?qe.content.length:0,qe.start=0,qe.clsid=qe.clsid||J,re===0)qe.C=Ae.length>1?1:-1,qe.size=0,qe.type=5;else if($e.slice(-1)=="/"){for(Ee=re+1;Ee<Ae.length&&n(H.FullPaths[Ee])!=$e;++Ee);for(qe.C=Ee>=Ae.length?-1:Ee,Ee=re+1;Ee<Ae.length&&n(H.FullPaths[Ee])!=n($e);++Ee);qe.R=Ee>=Ae.length?-1:Ee,qe.type=1}else n(H.FullPaths[re+1]||"")==n($e)&&(qe.R=re+1),qe.type=2}}}function G(H,ne){var Z=ne||{};if(Z.fileType=="mad")return ut(H,Z);switch(R(H),Z.fileType){case"zip":return Jn(H,Z)}var Q=function(nt){for(var Ve=0,rt=0,gt=0;gt<nt.FileIndex.length;++gt){var Wt=nt.FileIndex[gt];if(Wt.content){var Xt=Wt.content.length;Xt>0&&(Xt<4096?Ve+=Xt+63>>6:rt+=Xt+511>>9)}}for(var Sr=nt.FullPaths.length+3>>2,Zn=Ve+7>>3,Fa=Ve+127>>7,ga=Zn+rt+Sr+Fa,Qn=ga+127>>7,xa=Qn<=109?0:Math.ceil((Qn-109)/127);ga+Qn+xa+127>>7>Qn;)xa=++Qn<=109?0:Math.ceil((Qn-109)/127);var jn=[1,xa,Qn,Fa,Sr,rt,Ve,0];return nt.FileIndex[0].size=Ve<<6,jn[7]=(nt.FileIndex[0].start=jn[0]+jn[1]+jn[2]+jn[3]+jn[4]+jn[5])+(jn[6]+7>>3),jn}(H),re=Ce(Q[7]<<9),ie=0,Ne=0;{for(ie=0;ie<8;++ie)re.write_shift(1,le[ie]);for(ie=0;ie<8;++ie)re.write_shift(2,0);for(re.write_shift(2,62),re.write_shift(2,3),re.write_shift(2,65534),re.write_shift(2,9),re.write_shift(2,6),ie=0;ie<3;++ie)re.write_shift(2,0);for(re.write_shift(4,0),re.write_shift(4,Q[2]),re.write_shift(4,Q[0]+Q[1]+Q[2]+Q[3]-1),re.write_shift(4,0),re.write_shift(4,4096),re.write_shift(4,Q[3]?Q[0]+Q[1]+Q[2]-1:B),re.write_shift(4,Q[3]),re.write_shift(-4,Q[1]?Q[0]-1:B),re.write_shift(4,Q[1]),ie=0;ie<109;++ie)re.write_shift(-4,ie<Q[2]?Q[1]+ie:-1)}if(Q[1])for(Ne=0;Ne<Q[1];++Ne){for(;ie<236+Ne*127;++ie)re.write_shift(-4,ie<Q[2]?Q[1]+ie:-1);re.write_shift(-4,Ne===Q[1]-1?B:Ne+1)}var Ee=function(nt){for(Ne+=nt;ie<Ne-1;++ie)re.write_shift(-4,ie+1);nt&&(++ie,re.write_shift(-4,B))};for(Ne=ie=0,Ne+=Q[1];ie<Ne;++ie)re.write_shift(-4,z.DIFSECT);for(Ne+=Q[2];ie<Ne;++ie)re.write_shift(-4,z.FATSECT);Ee(Q[3]),Ee(Q[4]);for(var be=0,Ae=0,je=H.FileIndex[0];be<H.FileIndex.length;++be)je=H.FileIndex[be],je.content&&(Ae=je.content.length,!(Ae<4096)&&(je.start=Ne,Ee(Ae+511>>9)));for(Ee(Q[6]+7>>3);re.l&511;)re.write_shift(-4,z.ENDOFCHAIN);for(Ne=ie=0,be=0;be<H.FileIndex.length;++be)je=H.FileIndex[be],je.content&&(Ae=je.content.length,!(!Ae||Ae>=4096)&&(je.start=Ne,Ee(Ae+63>>6)));for(;re.l&511;)re.write_shift(-4,z.ENDOFCHAIN);for(ie=0;ie<Q[4]<<2;++ie){var qe=H.FullPaths[ie];if(!qe||qe.length===0){for(be=0;be<17;++be)re.write_shift(4,0);for(be=0;be<3;++be)re.write_shift(4,-1);for(be=0;be<12;++be)re.write_shift(4,0);continue}je=H.FileIndex[ie],ie===0&&(je.start=je.size?je.start-1:B);var $e=ie===0&&Z.root||je.name;if(Ae=2*($e.length+1),re.write_shift(64,$e,"utf16le"),re.write_shift(2,Ae),re.write_shift(1,je.type),re.write_shift(1,je.color),re.write_shift(-4,je.L),re.write_shift(-4,je.R),re.write_shift(-4,je.C),je.clsid)re.write_shift(16,je.clsid,"hex");else for(be=0;be<4;++be)re.write_shift(4,0);re.write_shift(4,je.state||0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,je.start),re.write_shift(4,je.size),re.write_shift(4,0)}for(ie=1;ie<H.FileIndex.length;++ie)if(je=H.FileIndex[ie],je.size>=4096)if(re.l=je.start+1<<9,Ut&&Buffer.isBuffer(je.content))je.content.copy(re,re.l,0,je.size),re.l+=je.size+511&-512;else{for(be=0;be<je.size;++be)re.write_shift(1,je.content[be]);for(;be&511;++be)re.write_shift(1,0)}for(ie=1;ie<H.FileIndex.length;++ie)if(je=H.FileIndex[ie],je.size>0&&je.size<4096)if(Ut&&Buffer.isBuffer(je.content))je.content.copy(re,re.l,0,je.size),re.l+=je.size+63&-64;else{for(be=0;be<je.size;++be)re.write_shift(1,je.content[be]);for(;be&63;++be)re.write_shift(1,0)}if(Ut)re.l=re.length;else for(;re.l<re.length;)re.write_shift(1,0);return re}function j(H,ne){var Z=H.FullPaths.map(function(be){return be.toUpperCase()}),Q=Z.map(function(be){var Ae=be.split("/");return Ae[Ae.length-(be.slice(-1)=="/"?2:1)]}),re=!1;ne.charCodeAt(0)===47?(re=!0,ne=Z[0].slice(0,-1)+ne):re=ne.indexOf("/")!==-1;var ie=ne.toUpperCase(),Ne=re===!0?Z.indexOf(ie):Q.indexOf(ie);if(Ne!==-1)return H.FileIndex[Ne];var Ee=!ie.match(Ul);for(ie=ie.replace(_o,""),Ee&&(ie=ie.replace(Ul,"!")),Ne=0;Ne<Z.length;++Ne)if((Ee?Z[Ne].replace(Ul,"!"):Z[Ne]).replace(_o,"")==ie||(Ee?Q[Ne].replace(Ul,"!"):Q[Ne]).replace(_o,"")==ie)return H.FileIndex[Ne];return null}var T=64,B=-2,M="d0cf11e0a1b11ae1",le=[208,207,17,224,161,177,26,225],J="00000000000000000000000000000000",z={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:B,FREESECT:-1,HEADER_SIGNATURE:M,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:J,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ae(H,ne,Z){h();var Q=G(H,Z);c.writeFileSync(ne,Q)}function te(H){for(var ne=new Array(H.length),Z=0;Z<H.length;++Z)ne[Z]=String.fromCharCode(H[Z]);return ne.join("")}function de(H,ne){var Z=G(H,ne);switch(ne&&ne.type||"buffer"){case"file":return h(),c.writeFileSync(ne.filename,Z),Z;case"binary":return typeof Z=="string"?Z:te(Z);case"base64":return Oo(typeof Z=="string"?Z:te(Z));case"buffer":if(Ut)return Buffer.isBuffer(Z)?Z:Ga(Z);case"array":return typeof Z=="string"?fa(Z):Z}return Z}var xe;function _(H){try{var ne=H.InflateRaw,Z=new ne;if(Z._processChunk(new Uint8Array([3,0]),Z._finishFlushFlag),Z.bytesRead)xe=H;else throw new Error("zlib does not expose bytesRead")}catch(Q){console.error("cannot use native zlib: "+(Q.message||Q))}}function L(H,ne){if(!xe)return Ot(H,ne);var Z=xe.InflateRaw,Q=new Z,re=Q._processChunk(H.slice(H.l),Q._finishFlushFlag);return H.l+=Q.bytesRead,re}function P(H){return xe?xe.deflateRawSync(H):jt(H)}var O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],X=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ce=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function fe(H){var ne=(H<<1|H<<11)&139536|(H<<5|H<<15)&558144;return(ne>>16|ne>>8|ne)&255}for(var he=typeof Uint8Array<"u",we=he?new Uint8Array(256):[],Pe=0;Pe<256;++Pe)we[Pe]=fe(Pe);function Re(H,ne){var Z=we[H&255];return ne<=8?Z>>>8-ne:(Z=Z<<8|we[H>>8&255],ne<=16?Z>>>16-ne:(Z=Z<<8|we[H>>16&255],Z>>>24-ne))}function ze(H,ne){var Z=ne&7,Q=ne>>>3;return(H[Q]|(Z<=6?0:H[Q+1]<<8))>>>Z&3}function Ke(H,ne){var Z=ne&7,Q=ne>>>3;return(H[Q]|(Z<=5?0:H[Q+1]<<8))>>>Z&7}function ke(H,ne){var Z=ne&7,Q=ne>>>3;return(H[Q]|(Z<=4?0:H[Q+1]<<8))>>>Z&15}function oe(H,ne){var Z=ne&7,Q=ne>>>3;return(H[Q]|(Z<=3?0:H[Q+1]<<8))>>>Z&31}function Me(H,ne){var Z=ne&7,Q=ne>>>3;return(H[Q]|(Z<=1?0:H[Q+1]<<8))>>>Z&127}function at(H,ne,Z){var Q=ne&7,re=ne>>>3,ie=(1<<Z)-1,Ne=H[re]>>>Q;return Z<8-Q||(Ne|=H[re+1]<<8-Q,Z<16-Q)||(Ne|=H[re+2]<<16-Q,Z<24-Q)||(Ne|=H[re+3]<<24-Q),Ne&ie}function He(H,ne,Z){var Q=ne&7,re=ne>>>3;return Q<=5?H[re]|=(Z&7)<<Q:(H[re]|=Z<<Q&255,H[re+1]=(Z&7)>>8-Q),ne+3}function Ge(H,ne,Z){var Q=ne&7,re=ne>>>3;return Z=(Z&1)<<Q,H[re]|=Z,ne+1}function Je(H,ne,Z){var Q=ne&7,re=ne>>>3;return Z<<=Q,H[re]|=Z&255,Z>>>=8,H[re+1]=Z,ne+8}function Qe(H,ne,Z){var Q=ne&7,re=ne>>>3;return Z<<=Q,H[re]|=Z&255,Z>>>=8,H[re+1]=Z&255,H[re+2]=Z>>>8,ne+16}function lt(H,ne){var Z=H.length,Q=2*Z>ne?2*Z:ne+5,re=0;if(Z>=ne)return H;if(Ut){var ie=mh(Q);if(H.copy)H.copy(ie);else for(;re<H.length;++re)ie[re]=H[re];return ie}else if(he){var Ne=new Uint8Array(Q);if(Ne.set)Ne.set(H);else for(;re<Z;++re)Ne[re]=H[re];return Ne}return H.length=Q,H}function ct(H){for(var ne=new Array(H),Z=0;Z<H;++Z)ne[Z]=0;return ne}function xt(H,ne,Z){var Q=1,re=0,ie=0,Ne=0,Ee=0,be=H.length,Ae=he?new Uint16Array(32):ct(32);for(ie=0;ie<32;++ie)Ae[ie]=0;for(ie=be;ie<Z;++ie)H[ie]=0;be=H.length;var je=he?new Uint16Array(be):ct(be);for(ie=0;ie<be;++ie)Ae[re=H[ie]]++,Q<re&&(Q=re),je[ie]=0;for(Ae[0]=0,ie=1;ie<=Q;++ie)Ae[ie+16]=Ee=Ee+Ae[ie-1]<<1;for(ie=0;ie<be;++ie)Ee=H[ie],Ee!=0&&(je[ie]=Ae[Ee+16]++);var qe=0;for(ie=0;ie<be;++ie)if(qe=H[ie],qe!=0)for(Ee=Re(je[ie],Q)>>Q-qe,Ne=(1<<Q+4-qe)-1;Ne>=0;--Ne)ne[Ee|Ne<<qe]=qe&15|ie<<4;return Q}var _t=he?new Uint16Array(512):ct(512),kt=he?new Uint16Array(32):ct(32);if(!he){for(var Et=0;Et<512;++Et)_t[Et]=0;for(Et=0;Et<32;++Et)kt[Et]=0}(function(){for(var H=[],ne=0;ne<32;ne++)H.push(5);xt(H,kt,32);var Z=[];for(ne=0;ne<=143;ne++)Z.push(8);for(;ne<=255;ne++)Z.push(9);for(;ne<=279;ne++)Z.push(7);for(;ne<=287;ne++)Z.push(8);xt(Z,_t,288)})();var pt=function(){for(var ne=he?new Uint8Array(32768):[],Z=0,Q=0;Z<ce.length-1;++Z)for(;Q<ce[Z+1];++Q)ne[Q]=Z;for(;Q<32768;++Q)ne[Q]=29;var re=he?new Uint8Array(259):[];for(Z=0,Q=0;Z<X.length-1;++Z)for(;Q<X[Z+1];++Q)re[Q]=Z;function ie(Ee,be){for(var Ae=0;Ae<Ee.length;){var je=Math.min(65535,Ee.length-Ae),qe=Ae+je==Ee.length;for(be.write_shift(1,+qe),be.write_shift(2,je),be.write_shift(2,~je&65535);je-- >0;)be[be.l++]=Ee[Ae++]}return be.l}function Ne(Ee,be){for(var Ae=0,je=0,qe=he?new Uint16Array(32768):[];je<Ee.length;){var $e=Math.min(65535,Ee.length-je);if($e<10){for(Ae=He(be,Ae,+(je+$e==Ee.length)),Ae&7&&(Ae+=8-(Ae&7)),be.l=Ae/8|0,be.write_shift(2,$e),be.write_shift(2,~$e&65535);$e-- >0;)be[be.l++]=Ee[je++];Ae=be.l*8;continue}Ae=He(be,Ae,+(je+$e==Ee.length)+2);for(var nt=0;$e-- >0;){var Ve=Ee[je];nt=(nt<<5^Ve)&32767;var rt=-1,gt=0;if((rt=qe[nt])&&(rt|=je&-32768,rt>je&&(rt-=32768),rt<je))for(;Ee[rt+gt]==Ee[je+gt]&&gt<250;)++gt;if(gt>2){Ve=re[gt],Ve<=22?Ae=Je(be,Ae,we[Ve+1]>>1)-1:(Je(be,Ae,3),Ae+=5,Je(be,Ae,we[Ve-23]>>5),Ae+=3);var Wt=Ve<8?0:Ve-4>>2;Wt>0&&(Qe(be,Ae,gt-X[Ve]),Ae+=Wt),Ve=ne[je-rt],Ae=Je(be,Ae,we[Ve]>>3),Ae-=3;var Xt=Ve<4?0:Ve-2>>1;Xt>0&&(Qe(be,Ae,je-rt-ce[Ve]),Ae+=Xt);for(var Sr=0;Sr<gt;++Sr)qe[nt]=je&32767,nt=(nt<<5^Ee[je])&32767,++je;$e-=gt-1}else Ve<=143?Ve=Ve+48:Ae=Ge(be,Ae,1),Ae=Je(be,Ae,we[Ve]),qe[nt]=je&32767,++je}Ae=Je(be,Ae,0)-1}return be.l=(Ae+7)/8|0,be.l}return function(be,Ae){return be.length<8?ie(be,Ae):Ne(be,Ae)}}();function jt(H){var ne=Ce(50+Math.floor(H.length*1.1)),Z=pt(H,ne);return ne.slice(0,Z)}var tt=he?new Uint16Array(32768):ct(32768),Fr=he?new Uint16Array(32768):ct(32768),Lt=he?new Uint16Array(128):ct(128),dn=1,Ht=1;function rr(H,ne){var Z=oe(H,ne)+257;ne+=5;var Q=oe(H,ne)+1;ne+=5;var re=ke(H,ne)+4;ne+=4;for(var ie=0,Ne=he?new Uint8Array(19):ct(19),Ee=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],be=1,Ae=he?new Uint8Array(8):ct(8),je=he?new Uint8Array(8):ct(8),qe=Ne.length,$e=0;$e<re;++$e)Ne[O[$e]]=ie=Ke(H,ne),be<ie&&(be=ie),Ae[ie]++,ne+=3;var nt=0;for(Ae[0]=0,$e=1;$e<=be;++$e)je[$e]=nt=nt+Ae[$e-1]<<1;for($e=0;$e<qe;++$e)(nt=Ne[$e])!=0&&(Ee[$e]=je[nt]++);var Ve=0;for($e=0;$e<qe;++$e)if(Ve=Ne[$e],Ve!=0){nt=we[Ee[$e]]>>8-Ve;for(var rt=(1<<7-Ve)-1;rt>=0;--rt)Lt[nt|rt<<Ve]=Ve&7|$e<<3}var gt=[];for(be=1;gt.length<Z+Q;)switch(nt=Lt[Me(H,ne)],ne+=nt&7,nt>>>=3){case 16:for(ie=3+ze(H,ne),ne+=2,nt=gt[gt.length-1];ie-- >0;)gt.push(nt);break;case 17:for(ie=3+Ke(H,ne),ne+=3;ie-- >0;)gt.push(0);break;case 18:for(ie=11+Me(H,ne),ne+=7;ie-- >0;)gt.push(0);break;default:gt.push(nt),be<nt&&(be=nt);break}var Wt=gt.slice(0,Z),Xt=gt.slice(Z);for($e=Z;$e<286;++$e)Wt[$e]=0;for($e=Q;$e<30;++$e)Xt[$e]=0;return dn=xt(Wt,tt,286),Ht=xt(Xt,Fr,30),ne}function Rn(H,ne){if(H[0]==3&&!(H[1]&3))return[Ui(ne),2];for(var Z=0,Q=0,re=mh(ne||1<<18),ie=0,Ne=re.length>>>0,Ee=0,be=0;!(Q&1);){if(Q=Ke(H,Z),Z+=3,Q>>>1)Q>>1==1?(Ee=9,be=5):(Z=rr(H,Z),Ee=dn,be=Ht);else{Z&7&&(Z+=8-(Z&7));var Ae=H[Z>>>3]|H[(Z>>>3)+1]<<8;if(Z+=32,Ae>0)for(!ne&&Ne<ie+Ae&&(re=lt(re,ie+Ae),Ne=re.length);Ae-- >0;)re[ie++]=H[Z>>>3],Z+=8;continue}for(;;){!ne&&Ne<ie+32767&&(re=lt(re,ie+32767),Ne=re.length);var je=at(H,Z,Ee),qe=Q>>>1==1?_t[je]:tt[je];if(Z+=qe&15,qe>>>=4,!(qe>>>8&255))re[ie++]=qe;else{if(qe==256)break;qe-=257;var $e=qe<8?0:qe-4>>2;$e>5&&($e=0);var nt=ie+X[qe];$e>0&&(nt+=at(H,Z,$e),Z+=$e),je=at(H,Z,be),qe=Q>>>1==1?kt[je]:Fr[je],Z+=qe&15,qe>>>=4;var Ve=qe<4?0:qe-2>>1,rt=ce[qe];for(Ve>0&&(rt+=at(H,Z,Ve),Z+=Ve),!ne&&Ne<nt&&(re=lt(re,nt+100),Ne=re.length);ie<nt;)re[ie]=re[ie-rt],++ie}}}return ne?[re,Z+7>>>3]:[re.slice(0,ie),Z+7>>>3]}function Ot(H,ne){var Z=H.slice(H.l||0),Q=Rn(Z,ne);return H.l+=Q[1],Q[0]}function ma(H,ne){if(H)typeof console<"u"&&console.error(ne);else throw new Error(ne)}function ir(H,ne){var Z=H;Cn(Z,0);var Q=[],re=[],ie={FileIndex:Q,FullPaths:re};F(ie,{root:ne.root});for(var Ne=Z.length-4;(Z[Ne]!=80||Z[Ne+1]!=75||Z[Ne+2]!=5||Z[Ne+3]!=6)&&Ne>=0;)--Ne;Z.l=Ne+4,Z.l+=4;var Ee=Z.read_shift(2);Z.l+=6;var be=Z.read_shift(4);for(Z.l=be,Ne=0;Ne<Ee;++Ne){Z.l+=20;var Ae=Z.read_shift(4),je=Z.read_shift(4),qe=Z.read_shift(2),$e=Z.read_shift(2),nt=Z.read_shift(2);Z.l+=8;var Ve=Z.read_shift(4),rt=l(Z.slice(Z.l+qe,Z.l+qe+$e));Z.l+=qe+$e+nt;var gt=Z.l;Z.l=Ve+4,_n(Z,Ae,je,ie,rt),Z.l=gt}return ie}function _n(H,ne,Z,Q,re){H.l+=2;var ie=H.read_shift(2),Ne=H.read_shift(2),Ee=o(H);if(ie&8257)throw new Error("Unsupported ZIP encryption");for(var be=H.read_shift(4),Ae=H.read_shift(4),je=H.read_shift(4),qe=H.read_shift(2),$e=H.read_shift(2),nt="",Ve=0;Ve<qe;++Ve)nt+=String.fromCharCode(H[H.l++]);if($e){var rt=l(H.slice(H.l,H.l+$e));(rt[21589]||{}).mt&&(Ee=rt[21589].mt),((re||{})[21589]||{}).mt&&(Ee=re[21589].mt)}H.l+=$e;var gt=H.slice(H.l,H.l+Ae);switch(Ne){case 8:gt=L(H,je);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ne)}var Wt=!1;ie&8&&(be=H.read_shift(4),be==134695760&&(be=H.read_shift(4),Wt=!0),Ae=H.read_shift(4),je=H.read_shift(4)),Ae!=ne&&ma(Wt,"Bad compressed size: "+ne+" != "+Ae),je!=Z&&ma(Wt,"Bad uncompressed size: "+Z+" != "+je),pn(Q,nt,gt,{unsafe:!0,mt:Ee})}function Jn(H,ne){var Z=ne||{},Q=[],re=[],ie=Ce(1),Ne=Z.compression?8:0,Ee=0,be=0,Ae=0,je=0,qe=0,$e=H.FullPaths[0],nt=$e,Ve=H.FileIndex[0],rt=[],gt=0;for(be=1;be<H.FullPaths.length;++be)if(nt=H.FullPaths[be].slice($e.length),Ve=H.FileIndex[be],!(!Ve.size||!Ve.content||nt=="Sh33tJ5")){var Wt=je,Xt=Ce(nt.length);for(Ae=0;Ae<nt.length;++Ae)Xt.write_shift(1,nt.charCodeAt(Ae)&127);Xt=Xt.slice(0,Xt.l),rt[qe]=Tm.buf(Ve.content,0);var Sr=Ve.content;Ne==8&&(Sr=P(Sr)),ie=Ce(30),ie.write_shift(4,67324752),ie.write_shift(2,20),ie.write_shift(2,Ee),ie.write_shift(2,Ne),Ve.mt?i(ie,Ve.mt):ie.write_shift(4,0),ie.write_shift(-4,rt[qe]),ie.write_shift(4,Sr.length),ie.write_shift(4,Ve.content.length),ie.write_shift(2,Xt.length),ie.write_shift(2,0),je+=ie.length,Q.push(ie),je+=Xt.length,Q.push(Xt),je+=Sr.length,Q.push(Sr),ie=Ce(46),ie.write_shift(4,33639248),ie.write_shift(2,0),ie.write_shift(2,20),ie.write_shift(2,Ee),ie.write_shift(2,Ne),ie.write_shift(4,0),ie.write_shift(-4,rt[qe]),ie.write_shift(4,Sr.length),ie.write_shift(4,Ve.content.length),ie.write_shift(2,Xt.length),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(4,0),ie.write_shift(4,Wt),gt+=ie.l,re.push(ie),gt+=Xt.length,re.push(Xt),++qe}return ie=Ce(22),ie.write_shift(4,101010256),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(2,qe),ie.write_shift(2,qe),ie.write_shift(4,gt),ie.write_shift(4,je),ie.write_shift(2,0),Gr([Gr(Q),Gr(re),ie])}var Zt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function vt(H,ne){if(H.ctype)return H.ctype;var Z=H.name||"",Q=Z.match(/\.([^\.]+)$/);return Q&&Zt[Q[1]]||ne&&(Q=(Z=ne).match(/[\.\\]([^\.\\])+$/),Q&&Zt[Q[1]])?Zt[Q[1]]:"application/octet-stream"}function Dt(H){for(var ne=Oo(H),Z=[],Q=0;Q<ne.length;Q+=76)Z.push(ne.slice(Q,Q+76));return Z.join(`\r
`)+`\r
`}function Ea(H){var ne=H.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ae){var je=Ae.charCodeAt(0).toString(16).toUpperCase();return"="+(je.length==1?"0"+je:je)});ne=ne.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ne.charAt(0)==`
`&&(ne="=0D"+ne.slice(1)),ne=ne.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Z=[],Q=ne.split(`\r
`),re=0;re<Q.length;++re){var ie=Q[re];if(ie.length==0){Z.push("");continue}for(var Ne=0;Ne<ie.length;){var Ee=76,be=ie.slice(Ne,Ne+Ee);be.charAt(Ee-1)=="="?Ee--:be.charAt(Ee-2)=="="?Ee-=2:be.charAt(Ee-3)=="="&&(Ee-=3),be=ie.slice(Ne,Ne+Ee),Ne+=Ee,Ne<ie.length&&(be+="="),Z.push(be)}}return Z.join(`\r
`)}function Lr(H){for(var ne=[],Z=0;Z<H.length;++Z){for(var Q=H[Z];Z<=H.length&&Q.charAt(Q.length-1)=="=";)Q=Q.slice(0,Q.length-1)+H[++Z];ne.push(Q)}for(var re=0;re<ne.length;++re)ne[re]=ne[re].replace(/[=][0-9A-Fa-f]{2}/g,function(ie){return String.fromCharCode(parseInt(ie.slice(1),16))});return fa(ne.join(`\r
`))}function Mn(H,ne,Z){for(var Q="",re="",ie="",Ne,Ee=0;Ee<10;++Ee){var be=ne[Ee];if(!be||be.match(/^\s*$/))break;var Ae=be.match(/^(.*?):\s*([^\s].*)$/);if(Ae)switch(Ae[1].toLowerCase()){case"content-location":Q=Ae[2].trim();break;case"content-type":ie=Ae[2].trim();break;case"content-transfer-encoding":re=Ae[2].trim();break}}switch(++Ee,re.toLowerCase()){case"base64":Ne=fa(za(ne.slice(Ee).join("")));break;case"quoted-printable":Ne=Lr(ne.slice(Ee));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+re)}var je=pn(H,Q.slice(Z.length),Ne,{unsafe:!0});ie&&(je.ctype=ie)}function Bn(H,ne){if(te(H.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Z=ne&&ne.root||"",Q=(Ut&&Buffer.isBuffer(H)?H.toString("binary"):te(H)).split(`\r
`),re=0,ie="";for(re=0;re<Q.length;++re)if(ie=Q[re],!!/^Content-Location:/i.test(ie)&&(ie=ie.slice(ie.indexOf("file")),Z||(Z=ie.slice(0,ie.lastIndexOf("/")+1)),ie.slice(0,Z.length)!=Z))for(;Z.length>0&&(Z=Z.slice(0,Z.length-1),Z=Z.slice(0,Z.lastIndexOf("/")+1),ie.slice(0,Z.length)!=Z););var Ne=(Q[1]||"").match(/boundary="(.*?)"/);if(!Ne)throw new Error("MAD cannot find boundary");var Ee="--"+(Ne[1]||""),be=[],Ae=[],je={FileIndex:be,FullPaths:Ae};F(je);var qe,$e=0;for(re=0;re<Q.length;++re){var nt=Q[re];nt!==Ee&&nt!==Ee+"--"||($e++&&Mn(je,Q.slice(qe,re),Z),qe=re)}return je}function ut(H,ne){var Z=ne||{},Q=Z.boundary||"SheetJS";Q="------="+Q;for(var re=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Q.slice(2)+'"',"","",""],ie=H.FullPaths[0],Ne=ie,Ee=H.FileIndex[0],be=1;be<H.FullPaths.length;++be)if(Ne=H.FullPaths[be].slice(ie.length),Ee=H.FileIndex[be],!(!Ee.size||!Ee.content||Ne=="Sh33tJ5")){Ne=Ne.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(gt){return"_x"+gt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(gt){return"_u"+gt.charCodeAt(0).toString(16)+"_"});for(var Ae=Ee.content,je=Ut&&Buffer.isBuffer(Ae)?Ae.toString("binary"):te(Ae),qe=0,$e=Math.min(1024,je.length),nt=0,Ve=0;Ve<=$e;++Ve)(nt=je.charCodeAt(Ve))>=32&&nt<128&&++qe;var rt=qe>=$e*4/5;re.push(Q),re.push("Content-Location: "+(Z.root||"file:///C:/SheetJS/")+Ne),re.push("Content-Transfer-Encoding: "+(rt?"quoted-printable":"base64")),re.push("Content-Type: "+vt(Ee,Ne)),re.push(""),re.push(rt?Ea(je):Dt(je))}return re.push(Q+`--\r
`),re.join(`\r
`)}function An(H){var ne={};return F(ne,H),ne}function pn(H,ne,Z,Q){var re=Q&&Q.unsafe;re||F(H);var ie=!re&&Jt.find(H,ne);if(!ie){var Ne=H.FullPaths[0];ne.slice(0,Ne.length)==Ne?Ne=ne:(Ne.slice(-1)!="/"&&(Ne+="/"),Ne=(Ne+ne).replace("//","/")),ie={name:a(ne),type:2},H.FileIndex.push(ie),H.FullPaths.push(Ne),re||Jt.utils.cfb_gc(H)}return ie.content=Z,ie.size=Z?Z.length:0,Q&&(Q.CLSID&&(ie.clsid=Q.CLSID),Q.mt&&(ie.mt=Q.mt),Q.ct&&(ie.ct=Q.ct)),ie}function Kr(H,ne){F(H);var Z=Jt.find(H,ne);if(Z){for(var Q=0;Q<H.FileIndex.length;++Q)if(H.FileIndex[Q]==Z)return H.FileIndex.splice(Q,1),H.FullPaths.splice(Q,1),!0}return!1}function gr(H,ne,Z){F(H);var Q=Jt.find(H,ne);if(Q){for(var re=0;re<H.FileIndex.length;++re)if(H.FileIndex[re]==Q)return H.FileIndex[re].name=a(Z),H.FullPaths[re]=Z,!0}return!1}function fr(H){R(H,!0)}return r.find=j,r.read=V,r.parse=u,r.write=de,r.writeFile=ae,r.utils={cfb_new:An,cfb_add:pn,cfb_del:Kr,cfb_mov:gr,cfb_gc:fr,ReadShift:jo,CheckField:ld,prep_blob:Cn,bconcat:Gr,use_zlib:_,_deflateRaw:jt,_inflateRaw:Ot,consts:z},r}();function km(e){return typeof e=="string"?pc(e):Array.isArray(e)?em(e):e}function Wo(e,r,t){if(typeof Deno<"u"){if(t&&typeof r=="string")switch(t){case"utf8":r=new TextEncoder(t).encode(r);break;case"binary":r=pc(r);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(e,r)}var n=t=="utf8"?Do(r):r;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([km(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(r)&&(r=Ho(r)),l.write(r),l.close(),r}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function Xr(e){for(var r=Object.keys(e),t=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(e,r[n])&&t.push(r[n]);return t}function Sh(e,r){for(var t=[],n=Xr(e),a=0;a!==n.length;++a)t[e[n[a]][r]]==null&&(t[e[n[a]][r]]=n[a]);return t}function K0(e){for(var r=[],t=Xr(e),n=0;n!==t.length;++n)r[e[t[n]]]=t[n];return r}function xc(e){for(var r=[],t=Xr(e),n=0;n!==t.length;++n)r[e[t[n]]]=parseInt(t[n],10);return r}function Em(e){for(var r=[],t=Xr(e),n=0;n!==t.length;++n)r[e[t[n]]]==null&&(r[e[t[n]]]=[]),r[e[t[n]]].push(t[n]);return r}var tc=new Date(1899,11,30,0,0,0);function bn(e,r){var t=e.getTime(),n=tc.getTime()+(e.getTimezoneOffset()-tc.getTimezoneOffset())*6e4;return(t-n)/(24*60*60*1e3)}var Vu=new Date,Fm=tc.getTime()+(Vu.getTimezoneOffset()-tc.getTimezoneOffset())*6e4,_h=Vu.getTimezoneOffset();function Gu(e){var r=new Date;return r.setTime(e*24*60*60*1e3+Fm),r.getTimezoneOffset()!==_h&&r.setTime(r.getTime()+(r.getTimezoneOffset()-_h)*6e4),r}var Ah=new Date("2017-02-19T19:06:09.000Z"),$u=isNaN(Ah.getFullYear())?new Date("2/19/17"):Ah,Lm=$u.getFullYear()==2017;function un(e,r){var t=new Date(e);if(Lm)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if($u.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return e.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function vc(e,r){if(Ut&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var t={"â‚¬":"Â€","â€š":"Â‚",Æ’:"Âƒ","â€ž":"Â„","â€¦":"Â…","â€ ":"Â†","â€¡":"Â‡","Ë†":"Âˆ","â€°":"Â‰",Å :"ÂŠ","â€¹":"Â‹",Å’:"ÂŒ",Å½:"ÂŽ","â€˜":"Â‘","â€™":"Â’","â€œ":"Â“","â€":"Â”","â€¢":"Â•","â€“":"Â–","â€”":"Â—","Ëœ":"Â˜","â„¢":"Â™",Å¡:"Âš","â€º":"Â›",Å“:"Âœ",Å¾:"Âž",Å¸:"ÂŸ"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[â‚¬â€šÆ’â€žâ€¦â€ â€¡Ë†â€°Å â€¹Å’Å½â€˜â€™â€œâ€â€¢â€“â€”Ëœâ„¢Å¡â€ºÅ“Å¾Å¸]/g,function(i){return t[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Nn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=Nn(e[t]));return r}function pr(e,r){for(var t="";t.length<r;)t+=e;return t}function Wa(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return t=-t,i}),!isNaN(r=Number(n)))?r/t:r}var Cm=["january","february","march","april","may","june","july","august","september","october","november","december"];function Io(e){var r=new Date(e),t=new Date(NaN),n=r.getYear(),a=r.getMonth(),i=r.getDate();if(isNaN(i))return t;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&Cm.indexOf(o)==-1)return t}else if(o.match(/[a-z]/))return t;return n<0||n>8099?t:(a>0||i>1)&&n!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}function Tt(e,r,t){if(e.FullPaths){if(typeof t=="string"){var n;return Ut?n=Ga(t):n=tm(t),Jt.utils.cfb_add(e,r,n)}Jt.utils.cfb_add(e,r,t)}else e.file(r,t)}function J0(){return Jt.utils.cfb_new()}var Er=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Pm={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Z0=K0(Pm),Q0=/[&<>'"]/g,Om=/[\u0000-\u0008\u000b-\u001f]/g;function $t(e){var r=e+"";return r.replace(Q0,function(t){return Z0[t]}).replace(Om,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function jh(e){return $t(e).replace(/ /g,"_x0020_")}var Yu=/[\u0000-\u001f]/g;function Im(e){var r=e+"";return r.replace(Q0,function(t){return Z0[t]}).replace(/\n/g,"<br/>").replace(Yu,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function Dm(e){var r=e+"";return r.replace(Q0,function(t){return Z0[t]}).replace(Yu,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function Rm(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Mm(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function g0(e){for(var r="",t=0,n=0,a=0,i=0,o=0,l=0;t<e.length;){if(n=e.charCodeAt(t++),n<128){r+=String.fromCharCode(n);continue}if(a=e.charCodeAt(t++),n>191&&n<224){o=(n&31)<<6,o|=a&63,r+=String.fromCharCode(o);continue}if(i=e.charCodeAt(t++),n<240){r+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}o=e.charCodeAt(t++),l=((n&7)<<18|(a&63)<<12|(i&63)<<6|o&63)-65536,r+=String.fromCharCode(55296+(l>>>10&1023)),r+=String.fromCharCode(56320+(l&1023))}return r}function Th(e){var r=Ui(2*e.length),t,n,a=1,i=0,o=0,l;for(n=0;n<e.length;n+=a)a=1,(l=e.charCodeAt(n))<128?t=l:l<224?(t=(l&31)*64+(e.charCodeAt(n+1)&63),a=2):l<240?(t=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,t=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),t-=65536,o=55296+(t>>>10&1023),t=56320+(t&1023)),o!==0&&(r[i++]=o&255,r[i++]=o>>>8,o=0),r[i++]=t%256,r[i++]=t>>>8;return r.slice(0,i).toString("ucs2")}function kh(e){return Ga(e,"binary").toString("utf8")}var Wl="foo bar bazÃ¢Â˜ÂƒÃ°ÂŸÂÂ£",Ao=Ut&&(kh(Wl)==g0(Wl)&&kh||Th(Wl)==g0(Wl)&&Th)||g0,Do=Ut?function(e){return Ga(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,n=0,a=0;t<e.length;)switch(n=e.charCodeAt(t++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(t++)-56320+(n<<10),r.push(String.fromCharCode(240+(a>>18&7))),r.push(String.fromCharCode(144+(a>>12&63))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},Bm=function(){var e=[["nbsp"," "],["middot","Â·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),Xu=/(^\s|\s$|\n)/;function $r(e,r){return"<"+e+(r.match(Xu)?' xml:space="preserve"':"")+">"+r+"</"+e+">"}function Ro(e){return Xr(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function Ye(e,r,t){return"<"+e+(t!=null?Ro(t):"")+(r!=null?(r.match(Xu)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function U0(e,r){try{return e.toISOString().replace(/\.\d*/,"")}catch(t){if(r)throw t}return""}function Um(e,r){switch(typeof e){case"string":var t=Ye("vt:lpwstr",$t(e));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return Ye((e|0)==e?"vt:i4":"vt:r8",$t(String(e)));case"boolean":return Ye("vt:bool",e?"true":"false")}if(e instanceof Date)return Ye("vt:filetime",U0(e));throw new Error("Unable to serialize "+e)}var Br={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ps=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Pn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Hm(e,r){for(var t=1-2*(e[r+7]>>>7),n=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),a=e[r+6]&15,i=5;i>=0;--i)a=a*256+e[r+i];return n==2047?a==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),t*Math.pow(2,n-52)*a)}function Wm(e,r,t){var n=(r<0||1/r==-1/0?1:0)<<7,a=0,i=0,o=n?-r:r;isFinite(o)?o==0?a=i=0:(a=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(r)?26985:0);for(var l=0;l<=5;++l,i/=256)e[t+l]=i&255;e[t+6]=(a&15)<<4|i&15,e[t+7]=a>>4|n}var Eh=function(e){for(var r=[],t=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=t)r.push.apply(r,e[0][n].slice(a,a+t));return r},Fh=Ut?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:Ga(r)})):Eh(e)}:Eh,Lh=function(e,r,t){for(var n=[],a=r;a<t;a+=2)n.push(String.fromCharCode(go(e,a)));return n.join("").replace(_o,"")},ef=Ut?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(_o,""):Lh(e,r,t)}:Lh,Ch=function(e,r,t){for(var n=[],a=r;a<r+t;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},Ku=Ut?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):Ch(e,r,t)}:Ch,Ph=function(e,r,t){for(var n=[],a=r;a<t;a++)n.push(String.fromCharCode(As(e,a)));return n.join("")},qo=Ut?function(r,t,n){return Buffer.isBuffer(r)?r.toString("utf8",t,n):Ph(r,t,n)}:Ph,Ju=function(e,r){var t=On(e,r);return t>0?qo(e,r+4,r+4+t-1):""},Zu=Ju,Qu=function(e,r){var t=On(e,r);return t>0?qo(e,r+4,r+4+t-1):""},ed=Qu,td=function(e,r){var t=2*On(e,r);return t>0?qo(e,r+4,r+4+t-1):""},rd=td,nd=function(r,t){var n=On(r,t);return n>0?ef(r,t+4,t+4+n):""},ad=nd,id=function(e,r){var t=On(e,r);return t>0?qo(e,r+4,r+4+t):""},sd=id,od=function(e,r){return Hm(e,r)},rc=od,tf=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};Ut&&(Zu=function(r,t){if(!Buffer.isBuffer(r))return Ju(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},ed=function(r,t){if(!Buffer.isBuffer(r))return Qu(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},rd=function(r,t){if(!Buffer.isBuffer(r))return td(r,t);var n=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n-1)},ad=function(r,t){if(!Buffer.isBuffer(r))return nd(r,t);var n=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n)},sd=function(r,t){if(!Buffer.isBuffer(r))return id(r,t);var n=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+n)},rc=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):od(r,t)},tf=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var As=function(e,r){return e[r]},go=function(e,r){return e[r+1]*256+e[r]},qm=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},On=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},Pi=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},zm=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function jo(e,r){var t="",n,a,i=[],o,l,c,h;switch(r){case"dbcs":if(h=this.l,Ut&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)t+=String.fromCharCode(go(this,h)),h+=2;e*=2;break;case"utf8":t=qo(this,this.l,this.l+e);break;case"utf16le":e*=2,t=ef(this,this.l,this.l+e);break;case"wstr":return jo.call(this,e,"dbcs");case"lpstr-ansi":t=Zu(this,this.l),e=4+On(this,this.l);break;case"lpstr-cp":t=ed(this,this.l),e=4+On(this,this.l);break;case"lpwstr":t=rd(this,this.l),e=4+2*On(this,this.l);break;case"lpp4":e=4+On(this,this.l),t=ad(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+On(this,this.l),t=sd(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(o=As(this,this.l+e++))!==0;)i.push(Bl(o));t=i.join("");break;case"_wstr":for(e=0,t="";(o=go(this,this.l+e))!==0;)i.push(Bl(o)),e+=2;e+=2,t=i.join("");break;case"dbcs-cont":for(t="",h=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(h)!==-1)return o=As(this,h),this.l=h+1,l=jo.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Bl(go(this,h))),h+=2}t=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",h=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(h)!==-1)return o=As(this,h),this.l=h+1,l=jo.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Bl(As(this,h))),h+=1}t=i.join("");break;default:switch(e){case 1:return n=As(this,this.l),this.l++,n;case 2:return n=(r==="i"?qm:go)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||!(this[this.l+3]&128)?(n=(e>0?Pi:zm)(this,this.l),this.l+=4,n):(a=On(this,this.l),this.l+=4,a);case 8:case-8:if(r==="f")return e==8?a=rc(this,this.l):a=rc([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:t=Ku(this,this.l,e);break}}return this.l+=e,t}var Vm=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},Gm=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},$m=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function Ym(e,r,t){var n=0,a=0;if(t==="dbcs"){for(a=0;a!=r.length;++a)$m(this,r.charCodeAt(a),this.l+2*a);n=2*r.length}else if(t==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=r.length;++a)this[this.l+a]=r.charCodeAt(a)&255;n=r.length}else if(t==="hex"){for(;a<e;++a)this[this.l++]=parseInt(r.slice(2*a,2*a+2),16)||0;return this}else if(t==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(r.length,e);++a){var o=r.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,Vm(this,r,this.l);break;case 8:if(n=8,t==="f"){Wm(this,r,this.l);break}case 16:break;case-4:n=4,Gm(this,r,this.l);break}return this.l+=n,this}function ld(e,r){var t=Ku(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function Cn(e,r){e.l=r,e.read_shift=jo,e.chk=ld,e.write_shift=Ym}function Ta(e,r){e.l+=r}function Ce(e){var r=Ui(e);return Cn(r,0),r}function wn(){var e=[],r=Ut?256:2048,t=function(h){var u=Ce(h);return Cn(u,0),u},n=t(r),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(h){return n&&h<n.length-n.l?n:(a(),n=t(Math.max(h+1,r)))},o=function(){return a(),Gr(e)},l=function(h){a(),n=h,n.l==null&&(n.l=n.length),i(r)};return{next:i,push:l,end:o,_bufs:e}}function Be(e,r,t,n){var a=+r,i;if(!isNaN(a)){n||(n=H4[a].p||(t||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var o=e.next(i);a<=127?o.write_shift(1,a):(o.write_shift(1,(a&127)+128),o.write_shift(1,a>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&tf(t)&&e.push(t)}}function To(e,r,t){var n=Nn(e);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Oh(e,r,t){var n=Nn(e);return n.s=To(n.s,r.s,t),n.e=To(n.e,r.s,t),n}function ko(e,r){if(e.cRel&&e.c<0)for(e=Nn(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=Nn(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=Yt(e);return!e.cRel&&e.cRel!=null&&(t=Jm(t)),!e.rRel&&e.rRel!=null&&(t=Xm(t)),t}function x0(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+an(e.s.c)+":"+(e.e.cRel?"":"$")+an(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Yr(e.s.r)+":"+(e.e.rRel?"":"$")+Yr(e.e.r):ko(e.s,r.biff)+":"+ko(e.e,r.biff)}function rf(e){return parseInt(Km(e),10)-1}function Yr(e){return""+(e+1)}function Xm(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Km(e){return e.replace(/\$(\d+)$/,"$1")}function nf(e){for(var r=Zm(e),t=0,n=0;n!==r.length;++n)t=26*t+r.charCodeAt(n)-64;return t-1}function an(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function Jm(e){return e.replace(/^([A-Z])/,"$$$1")}function Zm(e){return e.replace(/^\$([A-Z])/,"$1")}function Qm(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ur(e){for(var r=0,t=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?r=10*r+(a-48):a>=65&&a<=90&&(t=26*t+(a-64))}return{c:t-1,r:r-1}}function Yt(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function Dn(e){var r=e.indexOf(":");return r==-1?{s:Ur(e),e:Ur(e)}:{s:Ur(e.slice(0,r)),e:Ur(e.slice(r+1))}}function kr(e,r){return typeof r>"u"||typeof r=="number"?kr(e.s,e.e):(typeof e!="string"&&(e=Yt(e)),typeof r!="string"&&(r=Yt(r)),e==r?e:e+":"+r)}function or(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,a=0,i=e.length;for(t=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(r.s.c=--t,t=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;if(r.s.r=--t,n===i||a!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,t=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(r.e.c=--t,t=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;return r.e.r=--t,r}function Ih(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=vi(e.z,t?bn(r):r)}catch{}try{return e.w=vi((e.XF||{}).numFmtId||(t?14:0),t?bn(r):r)}catch{return""+r}}function Va(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?zo[e.v]||e.v:r==null?Ih(e,e.v):Ih(e,r))}function zi(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",n={};return n[t]=e,{SheetNames:[t],Sheets:n}}function cd(e,r,t){var n=t||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),o=0,l=0;if(i&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?Ur(n.origin):n.origin;o=c.r,l=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=or(i["!ref"]);h.s.c=u.s.c,h.s.r=u.s.r,h.e.c=Math.max(h.e.c,u.e.c),h.e.r=Math.max(h.e.r,u.e.r),o==-1&&(h.e.r=o=u.e.r+1)}for(var g=0;g!=r.length;++g)if(r[g]){if(!Array.isArray(r[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=r[g].length;++m)if(!(typeof r[g][m]>"u")){var d={v:r[g][m]},y=o+g,x=l+m;if(h.s.r>y&&(h.s.r=y),h.s.c>x&&(h.s.c=x),h.e.r<y&&(h.e.r=y),h.e.c<x&&(h.e.c=x),r[g][m]&&typeof r[g][m]=="object"&&!Array.isArray(r[g][m])&&!(r[g][m]instanceof Date))d=r[g][m];else if(Array.isArray(d.v)&&(d.f=r[g][m][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||mr[14],n.cellDates?(d.t="d",d.w=vi(d.z,bn(d.v))):(d.t="n",d.v=bn(d.v),d.w=vi(d.z,d.v))):d.t="s";if(a)i[y]||(i[y]=[]),i[y][x]&&i[y][x].z&&(d.z=i[y][x].z),i[y][x]=d;else{var b=Yt({c:x,r:y});i[b]&&i[b].z&&(d.z=i[b].z),i[b]=d}}}return h.s.c<1e7&&(i["!ref"]=kr(h)),i}function Os(e,r){return cd(null,e,r)}function eg(e){return e.read_shift(4,"i")}function ua(e,r){return r||(r=Ce(4)),r.write_shift(4,e),r}function sn(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function Hr(e,r){var t=!1;return r==null&&(t=!0,r=Ce(4+2*e.length)),r.write_shift(4,e.length),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}function tg(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function rg(e,r){return r||(r=Ce(4)),r.write_shift(2,0),r.write_shift(2,0),r}function af(e,r){var t=e.l,n=e.read_shift(1),a=sn(e),i=[],o={t:a,h:a};if(n&1){for(var l=e.read_shift(4),c=0;c!=l;++c)i.push(tg(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=t+r,o}function ng(e,r){var t=!1;return r==null&&(t=!0,r=Ce(15+4*e.t.length)),r.write_shift(1,0),Hr(e.t,r),t?r.slice(0,r.l):r}var ag=af;function ig(e,r){var t=!1;return r==null&&(t=!0,r=Ce(23+4*e.t.length)),r.write_shift(1,1),Hr(e.t,r),r.write_shift(4,1),rg({},r),t?r.slice(0,r.l):r}function Kn(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function Vi(e,r){return r==null&&(r=Ce(8)),r.write_shift(-4,e.c),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}function Gi(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}function $i(e,r){return r==null&&(r=Ce(4)),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}var sg=sn,fd=Hr;function sf(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}function nc(e,r){var t=!1;return r==null&&(t=!0,r=Ce(127)),r.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}var og=sn,H0=sf,of=nc;function hd(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,n=r[0]&2;e.l+=4;var a=n===0?rc([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):Pi(r,0)>>2;return t?a/100:a}function ud(e,r){r==null&&(r=Ce(4));var t=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,t=1),n)r.write_shift(-4,((t?a:e)<<2)+(t+2));else throw new Error("unsupported RkNumber "+e)}function dd(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}function lg(e,r){return r||(r=Ce(16)),r.write_shift(4,e.s.r),r.write_shift(4,e.e.r),r.write_shift(4,e.s.c),r.write_shift(4,e.e.c),r}var Yi=dd,Is=lg;function Ds(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Hi(e,r){return(r||Ce(8)).write_shift(8,e,"f")}function cg(e){var r={},t=e.read_shift(1),n=t>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:r.auto=1;break;case 1:r.index=a;var h=vg[a];h&&(r.rgb=Gh(h));break;case 2:r.rgb=Gh([o,l,c]);break;case 3:r.theme=a;break}return i!=0&&(r.tint=i>0?i/32767:i/32768),r}function ac(e,r){if(r||(r=Ce(8)),!e||e.auto)return r.write_shift(4,0),r.write_shift(4,0),r;e.index!=null?(r.write_shift(1,2),r.write_shift(1,e.index)):e.theme!=null?(r.write_shift(1,6),r.write_shift(1,e.theme)):(r.write_shift(1,5),r.write_shift(1,0));var t=e.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),r.write_shift(2,t),!e.rgb||e.theme!=null)r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),r.write_shift(1,parseInt(n.slice(0,2),16)),r.write_shift(1,parseInt(n.slice(2,4),16)),r.write_shift(1,parseInt(n.slice(4,6),16)),r.write_shift(1,255)}return r}function fg(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function hg(e,r){r||(r=Ce(2));var t=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return r.write_shift(1,t),r.write_shift(1,0),r}var pd=2,Ln=3,ql=11,ic=19,zl=64,ug=65,dg=71,pg=4108,mg=4126,Vr=80,Dh={1:{n:"CodePage",t:pd},2:{n:"Category",t:Vr},3:{n:"PresentationFormat",t:Vr},4:{n:"ByteCount",t:Ln},5:{n:"LineCount",t:Ln},6:{n:"ParagraphCount",t:Ln},7:{n:"SlideCount",t:Ln},8:{n:"NoteCount",t:Ln},9:{n:"HiddenCount",t:Ln},10:{n:"MultimediaClipCount",t:Ln},11:{n:"ScaleCrop",t:ql},12:{n:"HeadingPairs",t:pg},13:{n:"TitlesOfParts",t:mg},14:{n:"Manager",t:Vr},15:{n:"Company",t:Vr},16:{n:"LinksUpToDate",t:ql},17:{n:"CharacterCount",t:Ln},19:{n:"SharedDoc",t:ql},22:{n:"HyperlinksChanged",t:ql},23:{n:"AppVersion",t:Ln,p:"version"},24:{n:"DigSig",t:ug},26:{n:"ContentType",t:Vr},27:{n:"ContentStatus",t:Vr},28:{n:"Language",t:Vr},29:{n:"Version",t:Vr},255:{},2147483648:{n:"Locale",t:ic},2147483651:{n:"Behavior",t:ic},1919054434:{}},Rh={1:{n:"CodePage",t:pd},2:{n:"Title",t:Vr},3:{n:"Subject",t:Vr},4:{n:"Author",t:Vr},5:{n:"Keywords",t:Vr},6:{n:"Comments",t:Vr},7:{n:"Template",t:Vr},8:{n:"LastAuthor",t:Vr},9:{n:"RevNumber",t:Vr},10:{n:"EditTime",t:zl},11:{n:"LastPrinted",t:zl},12:{n:"CreatedDate",t:zl},13:{n:"ModifiedDate",t:zl},14:{n:"PageCount",t:Ln},15:{n:"WordCount",t:Ln},16:{n:"CharCount",t:Ln},17:{n:"Thumbnail",t:dg},18:{n:"Application",t:Vr},19:{n:"DocSecurity",t:Ln},255:{},2147483648:{n:"Locale",t:ic},2147483651:{n:"Behavior",t:ic},1919054434:{}};function gg(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var xg=gg([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),vg=Nn(xg),zo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},yg={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Vl={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function md(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function gd(e,r){var t=Em(yg),n=[],a;n[n.length]=Er,n[n.length]=Ye("Types",null,{xmlns:Br.CT,"xmlns:xsd":Br.xsd,"xmlns:xsi":Br.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Ye("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(a=e[c][0],n[n.length]=Ye("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:Vl[c][r.bookType]||Vl[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(h){n[n.length]=Ye("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:Vl[c][r.bookType]||Vl[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(h){n[n.length]=Ye("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:t[c][0]})})};return i("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Rt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function xd(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function ks(e){var r=[Er,Ye("Relationships",null,{xmlns:Br.RELS})];return Xr(e["!id"]).forEach(function(t){r[r.length]=Ye("Relationship",null,e["!id"][t])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function Gt(e,r,t,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),r<0)for(r=e["!idx"];e["!id"]["rId"+r];++r);if(e["!idx"]=r+1,a.Id="rId"+r,a.Type=n,a.Target=t,[Rt.HLINK,Rt.XPATH,Rt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+r);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,r}function wg(e){var r=[Er];r.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),r.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<e.length;++t)r.push('  <manifest:file-entry manifest:full-path="'+e[t][0]+'" manifest:media-type="'+e[t][1]+`"/>
`);return r.push("</manifest:manifest>"),r.join("")}function Mh(e,r,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+r+`"/>
`,`  </rdf:Description>
`].join("")}function bg(e,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+`"/>
`,`  </rdf:Description>
`].join("")}function Ng(e){var r=[Er];r.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=e.length;++t)r.push(Mh(e[t][0],e[t][1])),r.push(bg("",e[t][0]));return r.push(Mh("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}function vd(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Kl.version+"</meta:generator></office:meta></office:document-meta>"}var Bi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function v0(e,r,t,n,a){a[e]!=null||r==null||r===""||(a[e]=r,r=$t(r),n[n.length]=t?Ye(e,r,t):$r(e,r))}function yd(e,r){var t=r||{},n=[Er,Ye("cp:coreProperties",null,{"xmlns:cp":Br.CORE_PROPS,"xmlns:dc":Br.dc,"xmlns:dcterms":Br.dcterms,"xmlns:dcmitype":Br.dcmitype,"xmlns:xsi":Br.xsi})],a={};if(!e&&!t.Props)return n.join("");e&&(e.CreatedDate!=null&&v0("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:U0(e.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&v0("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:U0(e.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=Bi.length;++i){var o=Bi[i],l=t.Props&&t.Props[o[1]]!=null?t.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&v0(o[0],l,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Es=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],wd=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function bd(e){var r=[],t=Ye;return e||(e={}),e.Application="SheetJS",r[r.length]=Er,r[r.length]=Ye("Properties",null,{xmlns:Br.EXT_PROPS,"xmlns:vt":Br.vt}),Es.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=$t(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(r[r.length]=t(n[0],a))}}),r[r.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=t("TitlesOfParts",t("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+$t(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}function Nd(e){var r=[Er,Ye("Properties",null,{xmlns:Br.CUST_PROPS,"xmlns:vt":Br.vt})];if(!e)return r.join("");var t=1;return Xr(e).forEach(function(a){++t,r[r.length]=Ye("property",Um(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:$t(a)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var Bh={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Sg(e,r){var t=[];return Xr(Bh).map(function(n){for(var a=0;a<Bi.length;++a)if(Bi[a][1]==n)return Bi[a];for(a=0;a<Es.length;++a)if(Es[a][1]==n)return Es[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=r&&r.Props&&r.Props[n[1]]!=null?r.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),t.push($r(Bh[n[1]]||n[1],a))}}),Ye("DocumentProperties",t.join(""),{xmlns:Pn.o})}function _g(e,r){var t=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Xr(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var o=0;o<Bi.length;++o)if(i==Bi[o][1])return;for(o=0;o<Es.length;++o)if(i==Es[o][1])return;for(o=0;o<t.length;++o)if(i==t[o])return;var l=e[i],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),a.push(Ye(jh(i),l,{"dt:dt":c}))}}),r&&Xr(r).forEach(function(i){if(Object.prototype.hasOwnProperty.call(r,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var o=r[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),a.push(Ye(jh(i),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+Pn.o+'">'+a.join("")+"</"+n+">"}function Ag(e){var r=typeof e=="string"?new Date(Date.parse(e)):e,t=r.getTime()/1e3+11644473600,n=t%Math.pow(2,32),a=(t-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var o=Ce(8);return o.write_shift(4,n),o.write_shift(4,a),o}function Uh(e,r){var t=Ce(4),n=Ce(4);switch(t.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,r);break;case 5:n=Ce(8),n.write_shift(8,r,"f");break;case 11:n.write_shift(4,r?1:0);break;case 64:n=Ag(r);break;case 31:case 80:for(n=Ce(4+2*(r.length+1)+(r.length%2?0:2)),n.write_shift(4,r.length+1),n.write_shift(0,r,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}return Gr([t,n])}var Sd=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function jg(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Hh(e,r,t){var n=Ce(8),a=[],i=[],o=8,l=0,c=Ce(8),h=Ce(8);if(c.write_shift(4,2),c.write_shift(4,1200),h.write_shift(4,1),i.push(c),a.push(h),o+=8+c.length,!r){h=Ce(8),h.write_shift(4,0),a.unshift(h);var u=[Ce(4)];for(u[0].write_shift(4,e.length),l=0;l<e.length;++l){var g=e[l][0];for(c=Ce(8+2*(g.length+1)+(g.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,g.length+1),c.write_shift(0,g,"dbcs");c.l!=c.length;)c.write_shift(1,0);u.push(c)}c=Gr(u),i.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(r&&!r[e[l][0]])&&!(Sd.indexOf(e[l][0])>-1||wd.indexOf(e[l][0])>-1)&&e[l][1]!=null){var m=e[l][1],d=0;if(r){d=+r[e[l][0]];var y=t[d];if(y.p=="version"&&typeof m=="string"){var x=m.split(".");m=(+x[0]<<16)+(+x[1]||0)}c=Uh(y.t,m)}else{var b=jg(m);b==-1&&(b=31,m=String(m)),c=Uh(b,m)}i.push(c),h=Ce(8),h.write_shift(4,r?d:2+l),a.push(h),o+=8+c.length}var N=8*(i.length+1);for(l=0;l<i.length;++l)a[l].write_shift(4,N),N+=i[l].length;return n.write_shift(4,o),n.write_shift(4,i.length),Gr([n].concat(a).concat(i))}function Wh(e,r,t,n,a,i){var o=Ce(a?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Jt.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,a?2:1),o.write_shift(16,r,"hex"),o.write_shift(4,a?68:48);var c=Hh(e,t,n);if(l.push(c),a){var h=Hh(a,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+c.length),l.push(h)}return Gr(l)}function Tg(e,r){r||(r=Ce(e));for(var t=0;t<e;++t)r.write_shift(1,0);return r}function kg(e,r){return e.read_shift(r)===1}function hn(e,r){return r||(r=Ce(2)),r.write_shift(2,+!!e),r}function _d(e){return e.read_shift(2,"u")}function Xn(e,r){return r||(r=Ce(2)),r.write_shift(2,e),r}function Ad(e,r,t){return t||(t=Ce(2)),t.write_shift(1,r=="e"?+e:+!!e),t.write_shift(1,r=="e"?1:0),t}function jd(e,r,t){var n=e.read_shift(t&&t.biff>=12?2:1),a="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else t.biff==12&&(a="wstr");t.biff>=2&&t.biff<=5&&(a="cpstr");var o=n?e.read_shift(n,a):"";return o}function Eg(e){var r=e.t||"",t=Ce(3);t.write_shift(2,r.length),t.write_shift(1,1);var n=Ce(2*r.length);n.write_shift(2*r.length,r,"utf16le");var a=[t,n];return Gr(a)}function Fg(e,r,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(r,"sbcs-cont"):n=e.read_shift(r,"dbcs-cont"),n}function Lg(e,r,t){var n=e.read_shift(t&&t.biff==2?1:2);return n===0?(e.l++,""):Fg(e,n,t)}function Cg(e,r,t){if(t.biff>5)return Lg(e,r,t);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Td(e,r,t){return t||(t=Ce(3+2*e.length)),t.write_shift(2,e.length),t.write_shift(1,1),t.write_shift(31,e,"utf16le"),t}function qh(e,r){r||(r=Ce(6+e.length*2)),r.write_shift(4,1+e.length);for(var t=0;t<e.length;++t)r.write_shift(2,e.charCodeAt(t));return r.write_shift(2,0),r}function Pg(e){var r=Ce(512),t=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}r.write_shift(4,2),r.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(t=0;t<o.length;++t)r.write_shift(4,o[t]);if(i==28)n=n.slice(1),qh(n,r);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<o.length;++t)r.write_shift(1,parseInt(o[t],16));var l=a>-1?n.slice(0,a):n;for(r.write_shift(4,2*(l.length+1)),t=0;t<l.length;++t)r.write_shift(2,l.charCodeAt(t));r.write_shift(2,0),i&8&&qh(a>-1?n.slice(a+1):"",r)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<o.length;++t)r.write_shift(1,parseInt(o[t],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(r.write_shift(2,c),r.write_shift(4,n.length-3*c+1),t=0;t<n.length-3*c;++t)r.write_shift(1,n.charCodeAt(t+3*c)&255);for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),t=0;t<6;++t)r.write_shift(4,0)}return r.slice(0,r.l)}function Wi(e,r,t,n){return n||(n=Ce(6)),n.write_shift(2,e),n.write_shift(2,r),n.write_shift(2,t||0),n}function Og(e,r,t){var n=t.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[a,i,o]}function Ig(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r},e:{c:a,r:t}}}function kd(e,r){return r||(r=Ce(8)),r.write_shift(2,e.s.r),r.write_shift(2,e.e.r),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c),r}function lf(e,r,t){var n=1536,a=16;switch(t.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=Ce(a);return i.write_shift(2,n),i.write_shift(2,r),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function Dg(e,r){var t=!r||r.biff==8,n=Ce(t?112:54);for(n.write_shift(r.biff==8?2:1,7),t&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(t?0:536870912));n.l<n.length;)n.write_shift(1,t?0:32);return n}function Rg(e,r){var t=!r||r.biff>=8?2:1,n=Ce(8+t*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),r.biff>=8&&n.write_shift(1,1),n.write_shift(t*e.name.length,e.name,r.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function Mg(e,r){var t=Ce(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=Eg(e[a]);var i=Gr([t].concat(n));return i.parts=[t.length].concat(n.map(function(o){return o.length})),i}function Bg(){var e=Ce(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Ug(e){var r=Ce(18),t=1718;return e&&e.RTL&&(t|=64),r.write_shift(2,t),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}function Hg(e,r){var t=e.name||"Arial",n=r&&r.biff==5,a=n?15+t.length:16+2*t.length,i=Ce(a);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,t.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le"),i}function Wg(e,r,t,n){var a=Ce(10);return Wi(e,r,n,a),a.write_shift(4,t),a}function qg(e,r,t,n,a){var i=!a||a.biff==8,o=Ce(8+ +i+(1+i)*t.length);return Wi(e,r,n,o),o.write_shift(2,t.length),i&&o.write_shift(1,1),o.write_shift((1+i)*t.length,t,i?"utf16le":"sbcs"),o}function zg(e,r,t,n){var a=t&&t.biff==5;n||(n=Ce(a?3+r.length:5+2*r.length)),n.write_shift(2,e),n.write_shift(a?1:2,r.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}function Vg(e,r){var t=r.biff==8||!r.biff?4:2,n=Ce(2*t+6);return n.write_shift(t,e.s.r),n.write_shift(t,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function zh(e,r,t,n){var a=t&&t.biff==5;n||(n=Ce(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,r<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function Gg(e){var r=Ce(8);return r.write_shift(4,0),r.write_shift(2,0),r.write_shift(2,0),r}function $g(e,r,t,n,a,i){var o=Ce(8);return Wi(e,r,n,o),Ad(t,i,o),o}function Yg(e,r,t,n){var a=Ce(14);return Wi(e,r,n,a),Hi(t,a),a}function Xg(e,r,t){if(t.biff<8)return Kg(e,r,t);for(var n=[],a=e.l+r,i=e.read_shift(t.biff>8?4:2);i--!==0;)n.push(Og(e,t.biff>8?12:6,t));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function Kg(e,r,t){e[e.l+1]==3&&e[e.l]++;var n=jd(e,r,t);return n.charCodeAt(0)==3?n.slice(1):n}function Jg(e){var r=Ce(2+e.length*8);r.write_shift(2,e.length);for(var t=0;t<e.length;++t)kd(e[t],r);return r}function Zg(e){var r=Ce(24),t=Ur(e[0]);r.write_shift(2,t.r),r.write_shift(2,t.r),r.write_shift(2,t.c),r.write_shift(2,t.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)r.write_shift(1,parseInt(n[a],16));return Gr([r,Pg(e[1])])}function Qg(e){var r=e[1].Tooltip,t=Ce(10+2*(r.length+1));t.write_shift(2,2048);var n=Ur(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var a=0;a<r.length;++a)t.write_shift(2,r.charCodeAt(a));return t.write_shift(2,0),t}function ex(e){return e||(e=Ce(4)),e.write_shift(2,1),e.write_shift(2,1),e}function tx(e,r,t){if(!t.cellStyles)return Ta(e,r);var n=t&&t.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var h={s:a,e:i,w:o,ixfe:l,flags:c};return(t.biff>=5||!t.biff)&&(h.level=c>>8&7),h}function rx(e,r){var t=Ce(12);t.write_shift(2,r),t.write_shift(2,r),t.write_shift(2,e.width*256),t.write_shift(2,0);var n=0;return e.hidden&&(n|=1),t.write_shift(1,n),n=e.level||0,t.write_shift(1,n),t.write_shift(2,0),t}function nx(e){for(var r=Ce(2*e),t=0;t<e;++t)r.write_shift(2,t+1);return r}function ax(e,r,t){var n=Ce(15);return Go(n,e,r),n.write_shift(8,t,"f"),n}function ix(e,r,t){var n=Ce(9);return Go(n,e,r),n.write_shift(2,t),n}var sx=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=K0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(l,c){var h=[],u=Ui(1);switch(c.type){case"base64":u=fa(za(l));break;case"binary":u=fa(l);break;case"buffer":case"array":u=l;break}Cn(u,0);var g=u.read_shift(1),m=!!(g&136),d=!1,y=!1;switch(g){case 2:break;case 3:break;case 48:d=!0,m=!0;break;case 49:d=!0,m=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var x=0,b=521;g==2&&(x=u.read_shift(2)),u.l+=3,g!=2&&(x=u.read_shift(4)),x>1048576&&(x=1e6),g!=2&&(b=u.read_shift(2));var N=u.read_shift(2),w=c.codepage||1252;g!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(w=e[u[u.l]]),u.l+=1,u.l+=2),y&&(u.l+=36);for(var A=[],E={},W=Math.min(u.length,g==2?521:b-10-(d?264:0)),V=y?32:11;u.l<W&&u[u.l]!=13;)switch(E={},E.name=Jl.utils.decode(w,u.slice(u.l,u.l+V)).replace(/[\u0000\r\n].*$/g,""),u.l+=V,E.type=String.fromCharCode(u.read_shift(1)),g!=2&&!y&&(E.offset=u.read_shift(4)),E.len=u.read_shift(1),g==2&&(E.offset=u.read_shift(2)),E.dec=u.read_shift(1),E.name.length&&A.push(E),g!=2&&(u.l+=y?13:14),E.type){case"B":(!d||E.len!=8)&&c.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+E.type)}if(u[u.l]!==13&&(u.l=b-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=b;var F=0,C=0;for(h[0]=[],C=0;C!=A.length;++C)h[0][C]=A[C].name;for(;x-- >0;){if(u[u.l]===42){u.l+=N;continue}for(++u.l,h[++F]=[],C=0,C=0;C!=A.length;++C){var R=u.slice(u.l,u.l+A[C].len);u.l+=A[C].len,Cn(R,0);var G=Jl.utils.decode(w,R);switch(A[C].type){case"C":G.trim().length&&(h[F][C]=G.replace(/\s+$/,""));break;case"D":G.length===8?h[F][C]=new Date(+G.slice(0,4),+G.slice(4,6)-1,+G.slice(6,8)):h[F][C]=G;break;case"F":h[F][C]=parseFloat(G.trim());break;case"+":case"I":h[F][C]=y?R.read_shift(-4,"i")^2147483648:R.read_shift(4,"i");break;case"L":switch(G.trim().toUpperCase()){case"Y":case"T":h[F][C]=!0;break;case"N":case"F":h[F][C]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+G+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));h[F][C]="##MEMO##"+(y?parseInt(G.trim(),10):R.read_shift(4));break;case"N":G=G.replace(/\u0000/g,"").trim(),G&&G!="."&&(h[F][C]=+G||0);break;case"@":h[F][C]=new Date(R.read_shift(-8,"f")-621356832e5);break;case"T":h[F][C]=new Date((R.read_shift(4)-2440588)*864e5+R.read_shift(4));break;case"Y":h[F][C]=R.read_shift(4,"i")/1e4+R.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[F][C]=-R.read_shift(-8,"f");break;case"B":if(d&&A[C].len==8){h[F][C]=R.read_shift(8,"f");break}case"G":case"P":R.l+=A[C].len;break;case"0":if(A[C].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+A[C].type)}}}if(g!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(h=h.slice(0,c.sheetRows)),c.DBF=A,h}function n(l,c){var h=c||{};h.dateNF||(h.dateNF="yyyymmdd");var u=Os(t(l,h),h);return u["!cols"]=h.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete h.DBF,u}function a(l,c){try{return zi(n(l,c),c)}catch(h){if(c&&c.WTF)throw h}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var h=c||{};if(+h.codepage>=0&&Po(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var u=wn(),g=fc(l,{header:1,raw:!0,cellDates:!0}),m=g[0],d=g.slice(1),y=l["!cols"]||[],x=0,b=0,N=0,w=1;for(x=0;x<m.length;++x){if(((y[x]||{}).DBF||{}).name){m[x]=y[x].DBF.name,++N;continue}if(m[x]!=null){if(++N,typeof m[x]=="number"&&(m[x]=m[x].toString(10)),typeof m[x]!="string")throw new Error("DBF Invalid column name "+m[x]+" |"+typeof m[x]+"|");if(m.indexOf(m[x])!==x){for(b=0;b<1024;++b)if(m.indexOf(m[x]+"_"+b)==-1){m[x]+="_"+b;break}}}}var A=or(l["!ref"]),E=[],W=[],V=[];for(x=0;x<=A.e.c-A.s.c;++x){var F="",C="",R=0,G=[];for(b=0;b<d.length;++b)d[b][x]!=null&&G.push(d[b][x]);if(G.length==0||m[x]==null){E[x]="?";continue}for(b=0;b<G.length;++b){switch(typeof G[b]){case"number":C="B";break;case"string":C="C";break;case"boolean":C="L";break;case"object":C=G[b]instanceof Date?"D":"C";break;default:C="C"}R=Math.max(R,String(G[b]).length),F=F&&F!=C?"C":C}R>250&&(R=250),C=((y[x]||{}).DBF||{}).type,C=="C"&&y[x].DBF.len>R&&(R=y[x].DBF.len),F=="B"&&C=="N"&&(F="N",V[x]=y[x].DBF.dec,R=y[x].DBF.len),W[x]=F=="C"||C=="N"?R:i[F]||0,w+=W[x],E[x]=F}var j=u.next(32);for(j.write_shift(4,318902576),j.write_shift(4,d.length),j.write_shift(2,296+32*N),j.write_shift(2,w),x=0;x<4;++x)j.write_shift(4,0);for(j.write_shift(4,0|(+r[Fu]||3)<<8),x=0,b=0;x<m.length;++x)if(m[x]!=null){var T=u.next(32),B=(m[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);T.write_shift(1,B,"sbcs"),T.write_shift(1,E[x]=="?"?"C":E[x],"sbcs"),T.write_shift(4,b),T.write_shift(1,W[x]||i[E[x]]||0),T.write_shift(1,V[x]||0),T.write_shift(1,2),T.write_shift(4,0),T.write_shift(1,0),T.write_shift(4,0),T.write_shift(4,0),b+=W[x]||i[E[x]]||0}var M=u.next(264);for(M.write_shift(4,13),x=0;x<65;++x)M.write_shift(4,0);for(x=0;x<d.length;++x){var le=u.next(w);for(le.write_shift(1,0),b=0;b<m.length;++b)if(m[b]!=null)switch(E[b]){case"L":le.write_shift(1,d[x][b]==null?63:d[x][b]?84:70);break;case"B":le.write_shift(8,d[x][b]||0,"f");break;case"N":var J="0";for(typeof d[x][b]=="number"&&(J=d[x][b].toFixed(V[b]||0)),N=0;N<W[b]-J.length;++N)le.write_shift(1,32);le.write_shift(1,J,"sbcs");break;case"D":d[x][b]?(le.write_shift(4,("0000"+d[x][b].getFullYear()).slice(-4),"sbcs"),le.write_shift(2,("00"+(d[x][b].getMonth()+1)).slice(-2),"sbcs"),le.write_shift(2,("00"+d[x][b].getDate()).slice(-2),"sbcs")):le.write_shift(8,"00000000","sbcs");break;case"C":var z=String(d[x][b]!=null?d[x][b]:"").slice(0,W[b]);for(le.write_shift(1,z,"sbcs"),N=0;N<W[b]-z.length;++N)le.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:a,to_sheet:n,from_sheet:o}}(),ox=function(){var e={AA:"Ã€",BA:"Ã",CA:"Ã‚",DA:195,HA:"Ã„",JA:197,AE:"Ãˆ",BE:"Ã‰",CE:"ÃŠ",HE:"Ã‹",AI:"ÃŒ",BI:"Ã",CI:"ÃŽ",HI:"Ã",AO:"Ã’",BO:"Ã“",CO:"Ã”",DO:213,HO:"Ã–",AU:"Ã™",BU:"Ãš",CU:"Ã›",HU:"Ãœ",Aa:"Ã ",Ba:"Ã¡",Ca:"Ã¢",Da:227,Ha:"Ã¤",Ja:229,Ae:"Ã¨",Be:"Ã©",Ce:"Ãª",He:"Ã«",Ai:"Ã¬",Bi:"Ã­",Ci:"Ã®",Hi:"Ã¯",Ao:"Ã²",Bo:"Ã³",Co:"Ã´",Do:245,Ho:"Ã¶",Au:"Ã¹",Bu:"Ãº",Cu:"Ã»",Hu:"Ã¼",KC:"Ã‡",Kc:"Ã§",q:"Ã¦",z:"Å“",a:"Ã†",j:"Å’",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+Xr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(m,d){var y=e[d];return typeof y=="number"?ph(y):y},n=function(m,d,y){var x=d.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return x==59?m:ph(x)};e["|"]=254;function a(m,d){switch(d.type){case"base64":return i(za(m),d);case"binary":return i(m,d);case"buffer":return i(Ut&&Buffer.isBuffer(m)?m.toString("binary"):Ho(m),d);case"array":return i(vc(m),d)}throw new Error("Unrecognized type "+d.type)}function i(m,d){var y=m.split(/[\n\r]+/),x=-1,b=-1,N=0,w=0,A=[],E=[],W=null,V={},F=[],C=[],R=[],G=0,j;for(+d.codepage>=0&&Po(+d.codepage);N!==y.length;++N){G=0;var T=y[N].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,t),B=T.replace(/;;/g,"\0").split(";").map(function(O){return O.replace(/\u0000/g,";")}),M=B[0],le;if(T.length>0)switch(M){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":B[1].charAt(0)=="P"&&E.push(T.slice(3).replace(/;;/g,";"));break;case"C":var J=!1,z=!1,ae=!1,te=!1,de=-1,xe=-1;for(w=1;w<B.length;++w)switch(B[w].charAt(0)){case"A":break;case"X":b=parseInt(B[w].slice(1))-1,z=!0;break;case"Y":for(x=parseInt(B[w].slice(1))-1,z||(b=0),j=A.length;j<=x;++j)A[j]=[];break;case"K":le=B[w].slice(1),le.charAt(0)==='"'?le=le.slice(1,le.length-1):le==="TRUE"?le=!0:le==="FALSE"?le=!1:isNaN(Wa(le))?isNaN(Io(le).getDate())||(le=un(le)):(le=Wa(le),W!==null&&Wu(W)&&(le=Gu(le))),J=!0;break;case"E":te=!0;var _=i5(B[w].slice(1),{r:x,c:b});A[x][b]=[A[x][b],_];break;case"S":ae=!0,A[x][b]=[A[x][b],"S5S"];break;case"G":break;case"R":de=parseInt(B[w].slice(1))-1;break;case"C":xe=parseInt(B[w].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+T)}if(J&&(A[x][b]&&A[x][b].length==2?A[x][b][0]=le:A[x][b]=le,W=null),ae){if(te)throw new Error("SYLK shared formula cannot have own formula");var L=de>-1&&A[de][xe];if(!L||!L[1])throw new Error("SYLK shared formula cannot find base");A[x][b][1]=s5(L[1],{r:x-de,c:b-xe})}break;case"F":var P=0;for(w=1;w<B.length;++w)switch(B[w].charAt(0)){case"X":b=parseInt(B[w].slice(1))-1,++P;break;case"Y":for(x=parseInt(B[w].slice(1))-1,j=A.length;j<=x;++j)A[j]=[];break;case"M":G=parseInt(B[w].slice(1))/20;break;case"F":break;case"G":break;case"P":W=E[parseInt(B[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(R=B[w].slice(1).split(" "),j=parseInt(R[0],10);j<=parseInt(R[1],10);++j)G=parseInt(R[2],10),C[j-1]=G===0?{hidden:!0}:{wch:G},cf(C[j-1]);break;case"C":b=parseInt(B[w].slice(1))-1,C[b]||(C[b]={});break;case"R":x=parseInt(B[w].slice(1))-1,F[x]||(F[x]={}),G>0?(F[x].hpt=G,F[x].hpx=Pd(G)):G===0&&(F[x].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+T)}P<1&&(W=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+T)}}return F.length>0&&(V["!rows"]=F),C.length>0&&(V["!cols"]=C),d&&d.sheetRows&&(A=A.slice(0,d.sheetRows)),[A,V]}function o(m,d){var y=a(m,d),x=y[0],b=y[1],N=Os(x,d);return Xr(b).forEach(function(w){N[w]=b[w]}),N}function l(m,d){return zi(o(m,d),d)}function c(m,d,y,x){var b="C;Y"+(y+1)+";X"+(x+1)+";K";switch(m.t){case"n":b+=m.v||0,m.f&&!m.F&&(b+=";E"+hf(m.f,{r:y,c:x}));break;case"b":b+=m.v?"TRUE":"FALSE";break;case"e":b+=m.w||m.v;break;case"d":b+='"'+(m.w||m.v)+'"';break;case"s":b+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function h(m,d){d.forEach(function(y,x){var b="F;W"+(x+1)+" "+(x+1)+" ";y.hidden?b+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=sc(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=oc(y.wpx)),typeof y.wch=="number"&&(b+=Math.round(y.wch))),b.charAt(b.length-1)!=" "&&m.push(b)})}function u(m,d){d.forEach(function(y,x){var b="F;";y.hidden?b+="M0;":y.hpt?b+="M"+20*y.hpt+";":y.hpx&&(b+="M"+20*lc(y.hpx)+";"),b.length>2&&m.push(b+"R"+(x+1))})}function g(m,d){var y=["ID;PWXL;N;E"],x=[],b=or(m["!ref"]),N,w=Array.isArray(m),A=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),m["!cols"]&&h(y,m["!cols"]),m["!rows"]&&u(y,m["!rows"]),y.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var E=b.s.r;E<=b.e.r;++E)for(var W=b.s.c;W<=b.e.c;++W){var V=Yt({r:E,c:W});N=w?(m[E]||[])[W]:m[V],!(!N||N.v==null&&(!N.f||N.F))&&x.push(c(N,m,E,W))}return y.join(A)+A+x.join(A)+A+"E"+A}return{to_workbook:l,to_sheet:o,from_sheet:g}}(),lx=function(){function e(i,o){switch(o.type){case"base64":return r(za(i),o);case"binary":return r(i,o);case"buffer":return r(Ut&&Buffer.isBuffer(i)?i.toString("binary"):Ho(i),o);case"array":return r(vc(i),o)}throw new Error("Unrecognized type "+o.type)}function r(i,o){for(var l=i.split(`
`),c=-1,h=-1,u=0,g=[];u!==l.length;++u){if(l[u].trim()==="BOT"){g[++c]=[],h=0;continue}if(!(c<0)){var m=l[u].trim().split(","),d=m[0],y=m[1];++u;for(var x=l[u]||"";(x.match(/["]/g)||[]).length&1&&u<l.length-1;)x+=`
`+l[++u];switch(x=x.trim(),+d){case-1:if(x==="BOT"){g[++c]=[],h=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?g[c][h]=!0:x==="FALSE"?g[c][h]=!1:isNaN(Wa(y))?isNaN(Io(y).getDate())?g[c][h]=y:g[c][h]=un(y):g[c][h]=Wa(y),++h;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),g[c][h++]=x!==""?x:null;break}if(x==="EOD")break}}return o&&o.sheetRows&&(g=g.slice(0,o.sheetRows)),g}function t(i,o){return Os(e(i,o),o)}function n(i,o){return zi(t(i,o),o)}var a=function(){var i=function(c,h,u,g,m){c.push(h),c.push(u+","+g),c.push('"'+m.replace(/"/g,'""')+'"')},o=function(c,h,u,g){c.push(h+","+u),c.push(h==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(c){var h=[],u=or(c["!ref"]),g,m=Array.isArray(c);i(h,"TABLE",0,1,"sheetjs"),i(h,"VECTORS",0,u.e.r-u.s.r+1,""),i(h,"TUPLES",0,u.e.c-u.s.c+1,""),i(h,"DATA",0,0,"");for(var d=u.s.r;d<=u.e.r;++d){o(h,-1,0,"BOT");for(var y=u.s.c;y<=u.e.c;++y){var x=Yt({r:d,c:y});if(g=m?(c[d]||[])[y]:c[x],!g){o(h,1,0,"");continue}switch(g.t){case"n":var b=g.w;!b&&g.v!=null&&(b=g.v),b==null?g.f&&!g.F?o(h,1,0,"="+g.f):o(h,1,0,""):o(h,0,b,"V");break;case"b":o(h,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":o(h,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=vi(g.z||mr[14],bn(un(g.v)))),o(h,0,g.w,"V");break;default:o(h,1,0,"")}}}o(h,-1,0,"EOD");var N=`\r
`,w=h.join(N);return w}}();return{to_workbook:n,to_sheet:t,from_sheet:a}}(),Ed=function(){function e(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(g,m){for(var d=g.split(`
`),y=-1,x=-1,b=0,N=[];b!==d.length;++b){var w=d[b].trim().split(":");if(w[0]==="cell"){var A=Ur(w[1]);if(N.length<=A.r)for(y=N.length;y<=A.r;++y)N[y]||(N[y]=[]);switch(y=A.r,x=A.c,w[2]){case"t":N[y][x]=e(w[3]);break;case"v":N[y][x]=+w[3];break;case"vtf":var E=w[w.length-1];case"vtc":switch(w[3]){case"nl":N[y][x]=!!+w[4];break;default:N[y][x]=+w[4];break}w[2]=="vtf"&&(N[y][x]=[N[y][x],E])}}}return m&&m.sheetRows&&(N=N.slice(0,m.sheetRows)),N}function n(g,m){return Os(t(g,m),m)}function a(g,m){return zi(n(g,m),m)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function h(g){if(!g||!g["!ref"])return"";for(var m=[],d=[],y,x="",b=Dn(g["!ref"]),N=Array.isArray(g),w=b.s.r;w<=b.e.r;++w)for(var A=b.s.c;A<=b.e.c;++A)if(x=Yt({r:w,c:A}),y=N?(g[w]||[])[A]:g[x],!(!y||y.v==null||y.t==="z")){switch(d=["cell",x,"t"],y.t){case"s":case"str":d.push(r(y.v));break;case"n":y.f?(d[2]="vtf",d[3]="n",d[4]=y.v,d[5]=r(y.f)):(d[2]="v",d[3]=y.v);break;case"b":d[2]="vt"+(y.f?"f":"c"),d[3]="nl",d[4]=y.v?"1":"0",d[5]=r(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var E=bn(un(y.v));d[2]="vtc",d[3]="nd",d[4]=""+E,d[5]=y.w||vi(y.z||mr[14],E);break;case"e":continue}m.push(d.join(":"))}return m.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function u(g){return[i,o,l,o,h(g),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:u}}(),cx=function(){function e(u,g,m,d,y){y.raw?g[m][d]=u:u===""||(u==="TRUE"?g[m][d]=!0:u==="FALSE"?g[m][d]=!1:isNaN(Wa(u))?isNaN(Io(u).getDate())?g[m][d]=u:g[m][d]=un(u):g[m][d]=Wa(u))}function r(u,g){var m=g||{},d=[];if(!u||u.length===0)return d;for(var y=u.split(/[\r\n]/),x=y.length-1;x>=0&&y[x].length===0;)--x;for(var b=10,N=0,w=0;w<=x;++w)N=y[w].indexOf(" "),N==-1?N=y[w].length:N++,b=Math.max(b,N);for(w=0;w<=x;++w){d[w]=[];var A=0;for(e(y[w].slice(0,b).trim(),d,w,A,m),A=1;A<=(y[w].length-b)/10+1;++A)e(y[w].slice(b+(A-1)*10,b+A*10).trim(),d,w,A,m)}return m.sheetRows&&(d=d.slice(0,m.sheetRows)),d}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(u){for(var g={},m=!1,d=0,y=0;d<u.length;++d)(y=u.charCodeAt(d))==34?m=!m:!m&&y in t&&(g[y]=(g[y]||0)+1);y=[];for(d in g)Object.prototype.hasOwnProperty.call(g,d)&&y.push([g[d],d]);if(!y.length){g=n;for(d in g)Object.prototype.hasOwnProperty.call(g,d)&&y.push([g[d],d])}return y.sort(function(x,b){return x[0]-b[0]||n[x[1]]-n[b[1]]}),t[y.pop()[1]]||44}function i(u,g){var m=g||{},d="",y=m.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(d=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(d=u.charAt(4),u=u.slice(6)):d=a(u.slice(0,1024)):m&&m.FS?d=m.FS:d=a(u.slice(0,1024));var b=0,N=0,w=0,A=0,E=0,W=d.charCodeAt(0),V=!1,F=0,C=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var R=m.dateNF!=null?Am(m.dateNF):null;function G(){var j=u.slice(A,E),T={};if(j.charAt(0)=='"'&&j.charAt(j.length-1)=='"'&&(j=j.slice(1,-1).replace(/""/g,'"')),j.length===0)T.t="z";else if(m.raw)T.t="s",T.v=j;else if(j.trim().length===0)T.t="s",T.v=j;else if(j.charCodeAt(0)==61)j.charCodeAt(1)==34&&j.charCodeAt(j.length-1)==34?(T.t="s",T.v=j.slice(2,-1).replace(/""/g,'"')):o5(j)?(T.t="n",T.f=j.slice(1)):(T.t="s",T.v=j);else if(j=="TRUE")T.t="b",T.v=!0;else if(j=="FALSE")T.t="b",T.v=!1;else if(!isNaN(w=Wa(j)))T.t="n",m.cellText!==!1&&(T.w=j),T.v=w;else if(!isNaN(Io(j).getDate())||R&&j.match(R)){T.z=m.dateNF||mr[14];var B=0;R&&j.match(R)&&(j=jm(j,m.dateNF,j.match(R)||[]),B=1),m.cellDates?(T.t="d",T.v=un(j,B)):(T.t="n",T.v=bn(un(j,B))),m.cellText!==!1&&(T.w=vi(T.z,T.v instanceof Date?bn(T.v):T.v)),m.cellNF||delete T.z}else T.t="s",T.v=j;if(T.t=="z"||(m.dense?(y[b]||(y[b]=[]),y[b][N]=T):y[Yt({c:N,r:b})]=T),A=E+1,C=u.charCodeAt(A),x.e.c<N&&(x.e.c=N),x.e.r<b&&(x.e.r=b),F==W)++N;else if(N=0,++b,m.sheetRows&&m.sheetRows<=b)return!0}e:for(;E<u.length;++E)switch(F=u.charCodeAt(E)){case 34:C===34&&(V=!V);break;case W:case 10:case 13:if(!V&&G())break e;break}return E-A>0&&G(),y["!ref"]=kr(x),y}function o(u,g){return!(g&&g.PRN)||g.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,g):Os(r(u,g),g)}function l(u,g){var m="",d=g.type=="string"?[0,0,0,0]:bw(u,g);switch(g.type){case"base64":m=za(u);break;case"binary":m=u;break;case"buffer":g.codepage==65001?m=u.toString("utf8"):g.codepage&&typeof Jl<"u"||(m=Ut&&Buffer.isBuffer(u)?u.toString("binary"):Ho(u));break;case"array":m=vc(u);break;case"string":m=u;break;default:throw new Error("Unrecognized type "+g.type)}return d[0]==239&&d[1]==187&&d[2]==191?m=Ao(m.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?m=Ao(m):g.type=="binary"&&typeof Jl<"u",m.slice(0,19)=="socialcalc:version:"?Ed.to_sheet(g.type=="string"?m:Ao(m),g):o(m,g)}function c(u,g){return zi(l(u,g),g)}function h(u){for(var g=[],m=or(u["!ref"]),d,y=Array.isArray(u),x=m.s.r;x<=m.e.r;++x){for(var b=[],N=m.s.c;N<=m.e.c;++N){var w=Yt({r:x,c:N});if(d=y?(u[x]||[])[N]:u[w],!d||d.v==null){b.push("          ");continue}for(var A=(d.w||(Va(d),d.w)||"").slice(0,10);A.length<10;)A+=" ";b.push(A+(N===0?" ":""))}g.push(b.join(""))}return g.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:h}}(),Vh=function(){function e(_,L,P){if(_){Cn(_,_.l||0);for(var O=P.Enum||de;_.l<_.length;){var X=_.read_shift(2),ce=O[X]||O[65535],fe=_.read_shift(2),he=_.l+fe,we=ce.f&&ce.f(_,fe,P);if(_.l=he,L(we,ce,X))return}}}function r(_,L){switch(L.type){case"base64":return t(fa(za(_)),L);case"binary":return t(fa(_),L);case"buffer":case"array":return t(_,L)}throw"Unsupported type "+L.type}function t(_,L){if(!_)return _;var P=L||{},O=P.dense?[]:{},X="Sheet1",ce="",fe=0,he={},we=[],Pe=[],Re={s:{r:0,c:0},e:{r:0,c:0}},ze=P.sheetRows||0;if(_[2]==0&&(_[3]==8||_[3]==9)&&_.length>=16&&_[14]==5&&_[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(_[2]==2)P.Enum=de,e(_,function(Me,at,He){switch(He){case 0:P.vers=Me,Me>=4096&&(P.qpro=!0);break;case 6:Re=Me;break;case 204:Me&&(ce=Me);break;case 222:ce=Me;break;case 15:case 51:P.qpro||(Me[1].v=Me[1].v.slice(1));case 13:case 14:case 16:He==14&&(Me[2]&112)==112&&(Me[2]&15)>1&&(Me[2]&15)<15&&(Me[1].z=P.dateNF||mr[14],P.cellDates&&(Me[1].t="d",Me[1].v=Gu(Me[1].v))),P.qpro&&Me[3]>fe&&(O["!ref"]=kr(Re),he[X]=O,we.push(X),O=P.dense?[]:{},Re={s:{r:0,c:0},e:{r:0,c:0}},fe=Me[3],X=ce||"Sheet"+(fe+1),ce="");var Ge=P.dense?(O[Me[0].r]||[])[Me[0].c]:O[Yt(Me[0])];if(Ge){Ge.t=Me[1].t,Ge.v=Me[1].v,Me[1].z!=null&&(Ge.z=Me[1].z),Me[1].f!=null&&(Ge.f=Me[1].f);break}P.dense?(O[Me[0].r]||(O[Me[0].r]=[]),O[Me[0].r][Me[0].c]=Me[1]):O[Yt(Me[0])]=Me[1];break}},P);else if(_[2]==26||_[2]==14)P.Enum=xe,_[2]==14&&(P.qpro=!0,_.l=0),e(_,function(Me,at,He){switch(He){case 204:X=Me;break;case 22:Me[1].v=Me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Me[3]>fe&&(O["!ref"]=kr(Re),he[X]=O,we.push(X),O=P.dense?[]:{},Re={s:{r:0,c:0},e:{r:0,c:0}},fe=Me[3],X="Sheet"+(fe+1)),ze>0&&Me[0].r>=ze)break;P.dense?(O[Me[0].r]||(O[Me[0].r]=[]),O[Me[0].r][Me[0].c]=Me[1]):O[Yt(Me[0])]=Me[1],Re.e.c<Me[0].c&&(Re.e.c=Me[0].c),Re.e.r<Me[0].r&&(Re.e.r=Me[0].r);break;case 27:Me[14e3]&&(Pe[Me[14e3][0]]=Me[14e3][1]);break;case 1537:Pe[Me[0]]=Me[1],Me[0]==fe&&(X=Me[1]);break}},P);else throw new Error("Unrecognized LOTUS BOF "+_[2]);if(O["!ref"]=kr(Re),he[ce||X]=O,we.push(ce||X),!Pe.length)return{SheetNames:we,Sheets:he};for(var Ke={},ke=[],oe=0;oe<Pe.length;++oe)he[we[oe]]?(ke.push(Pe[oe]||we[oe]),Ke[Pe[oe]]=he[Pe[oe]]||he[we[oe]]):(ke.push(Pe[oe]),Ke[Pe[oe]]={"!ref":"A1"});return{SheetNames:ke,Sheets:Ke}}function n(_,L){var P=L||{};if(+P.codepage>=0&&Po(+P.codepage),P.type=="string")throw new Error("Cannot write WK1 to JS string");var O=wn(),X=or(_["!ref"]),ce=Array.isArray(_),fe=[];Xe(O,0,i(1030)),Xe(O,6,c(X));for(var he=Math.min(X.e.r,8191),we=X.s.r;we<=he;++we)for(var Pe=Yr(we),Re=X.s.c;Re<=X.e.c;++Re){we===X.s.r&&(fe[Re]=an(Re));var ze=fe[Re]+Pe,Ke=ce?(_[we]||[])[Re]:_[ze];if(!(!Ke||Ke.t=="z"))if(Ke.t=="n")(Ke.v|0)==Ke.v&&Ke.v>=-32768&&Ke.v<=32767?Xe(O,13,d(we,Re,Ke.v)):Xe(O,14,x(we,Re,Ke.v));else{var ke=Va(Ke);Xe(O,15,g(we,Re,ke.slice(0,239)))}}return Xe(O,1),O.end()}function a(_,L){var P=L||{};if(+P.codepage>=0&&Po(+P.codepage),P.type=="string")throw new Error("Cannot write WK3 to JS string");var O=wn();Xe(O,0,o(_));for(var X=0,ce=0;X<_.SheetNames.length;++X)(_.Sheets[_.SheetNames[X]]||{})["!ref"]&&Xe(O,27,te(_.SheetNames[X],ce++));var fe=0;for(X=0;X<_.SheetNames.length;++X){var he=_.Sheets[_.SheetNames[X]];if(!(!he||!he["!ref"])){for(var we=or(he["!ref"]),Pe=Array.isArray(he),Re=[],ze=Math.min(we.e.r,8191),Ke=we.s.r;Ke<=ze;++Ke)for(var ke=Yr(Ke),oe=we.s.c;oe<=we.e.c;++oe){Ke===we.s.r&&(Re[oe]=an(oe));var Me=Re[oe]+ke,at=Pe?(he[Ke]||[])[oe]:he[Me];if(!(!at||at.t=="z"))if(at.t=="n")Xe(O,23,G(Ke,oe,fe,at.v));else{var He=Va(at);Xe(O,22,F(Ke,oe,fe,He.slice(0,239)))}}++fe}}return Xe(O,1),O.end()}function i(_){var L=Ce(2);return L.write_shift(2,_),L}function o(_){var L=Ce(26);L.write_shift(2,4096),L.write_shift(2,4),L.write_shift(4,0);for(var P=0,O=0,X=0,ce=0;ce<_.SheetNames.length;++ce){var fe=_.SheetNames[ce],he=_.Sheets[fe];if(!(!he||!he["!ref"])){++X;var we=Dn(he["!ref"]);P<we.e.r&&(P=we.e.r),O<we.e.c&&(O=we.e.c)}}return P>8191&&(P=8191),L.write_shift(2,P),L.write_shift(1,X),L.write_shift(1,O),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(1,1),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(4,0),L}function l(_,L,P){var O={s:{c:0,r:0},e:{c:0,r:0}};return L==8&&P.qpro?(O.s.c=_.read_shift(1),_.l++,O.s.r=_.read_shift(2),O.e.c=_.read_shift(1),_.l++,O.e.r=_.read_shift(2),O):(O.s.c=_.read_shift(2),O.s.r=_.read_shift(2),L==12&&P.qpro&&(_.l+=2),O.e.c=_.read_shift(2),O.e.r=_.read_shift(2),L==12&&P.qpro&&(_.l+=2),O.s.c==65535&&(O.s.c=O.e.c=O.s.r=O.e.r=0),O)}function c(_){var L=Ce(8);return L.write_shift(2,_.s.c),L.write_shift(2,_.s.r),L.write_shift(2,_.e.c),L.write_shift(2,_.e.r),L}function h(_,L,P){var O=[{c:0,r:0},{t:"n",v:0},0,0];return P.qpro&&P.vers!=20768?(O[0].c=_.read_shift(1),O[3]=_.read_shift(1),O[0].r=_.read_shift(2),_.l+=2):(O[2]=_.read_shift(1),O[0].c=_.read_shift(2),O[0].r=_.read_shift(2)),O}function u(_,L,P){var O=_.l+L,X=h(_,L,P);if(X[1].t="s",P.vers==20768){_.l++;var ce=_.read_shift(1);return X[1].v=_.read_shift(ce,"utf8"),X}return P.qpro&&_.l++,X[1].v=_.read_shift(O-_.l,"cstr"),X}function g(_,L,P){var O=Ce(7+P.length);O.write_shift(1,255),O.write_shift(2,L),O.write_shift(2,_),O.write_shift(1,39);for(var X=0;X<O.length;++X){var ce=P.charCodeAt(X);O.write_shift(1,ce>=128?95:ce)}return O.write_shift(1,0),O}function m(_,L,P){var O=h(_,L,P);return O[1].v=_.read_shift(2,"i"),O}function d(_,L,P){var O=Ce(7);return O.write_shift(1,255),O.write_shift(2,L),O.write_shift(2,_),O.write_shift(2,P,"i"),O}function y(_,L,P){var O=h(_,L,P);return O[1].v=_.read_shift(8,"f"),O}function x(_,L,P){var O=Ce(13);return O.write_shift(1,255),O.write_shift(2,L),O.write_shift(2,_),O.write_shift(8,P,"f"),O}function b(_,L,P){var O=_.l+L,X=h(_,L,P);if(X[1].v=_.read_shift(8,"f"),P.qpro)_.l=O;else{var ce=_.read_shift(2);E(_.slice(_.l,_.l+ce),X),_.l+=ce}return X}function N(_,L,P){var O=L&32768;return L&=-32769,L=(O?_:0)+(L>=8192?L-16384:L),(O?"":"$")+(P?an(L):Yr(L))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},A=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function E(_,L){Cn(_,0);for(var P=[],O=0,X="",ce="",fe="",he="";_.l<_.length;){var we=_[_.l++];switch(we){case 0:P.push(_.read_shift(8,"f"));break;case 1:ce=N(L[0].c,_.read_shift(2),!0),X=N(L[0].r,_.read_shift(2),!1),P.push(ce+X);break;case 2:{var Pe=N(L[0].c,_.read_shift(2),!0),Re=N(L[0].r,_.read_shift(2),!1);ce=N(L[0].c,_.read_shift(2),!0),X=N(L[0].r,_.read_shift(2),!1),P.push(Pe+Re+":"+ce+X)}break;case 3:if(_.l<_.length){console.error("WK1 premature formula end");return}break;case 4:P.push("("+P.pop()+")");break;case 5:P.push(_.read_shift(2));break;case 6:{for(var ze="";we=_[_.l++];)ze+=String.fromCharCode(we);P.push('"'+ze.replace(/"/g,'""')+'"')}break;case 8:P.push("-"+P.pop());break;case 23:P.push("+"+P.pop());break;case 22:P.push("NOT("+P.pop()+")");break;case 20:case 21:he=P.pop(),fe=P.pop(),P.push(["AND","OR"][we-20]+"("+fe+","+he+")");break;default:if(we<32&&A[we])he=P.pop(),fe=P.pop(),P.push(fe+A[we]+he);else if(w[we]){if(O=w[we][1],O==69&&(O=_[_.l++]),O>P.length){console.error("WK1 bad formula parse 0x"+we.toString(16)+":|"+P.join("|")+"|");return}var Ke=P.slice(-O);P.length-=O,P.push(w[we][0]+"("+Ke.join(",")+")")}else return we<=7?console.error("WK1 invalid opcode "+we.toString(16)):we<=24?console.error("WK1 unsupported op "+we.toString(16)):we<=30?console.error("WK1 invalid opcode "+we.toString(16)):we<=115?console.error("WK1 unsupported function opcode "+we.toString(16)):console.error("WK1 unrecognized opcode "+we.toString(16))}}P.length==1?L[1].f=""+P[0]:console.error("WK1 bad formula parse |"+P.join("|")+"|")}function W(_){var L=[{c:0,r:0},{t:"n",v:0},0];return L[0].r=_.read_shift(2),L[3]=_[_.l++],L[0].c=_[_.l++],L}function V(_,L){var P=W(_);return P[1].t="s",P[1].v=_.read_shift(L-4,"cstr"),P}function F(_,L,P,O){var X=Ce(6+O.length);X.write_shift(2,_),X.write_shift(1,P),X.write_shift(1,L),X.write_shift(1,39);for(var ce=0;ce<O.length;++ce){var fe=O.charCodeAt(ce);X.write_shift(1,fe>=128?95:fe)}return X.write_shift(1,0),X}function C(_,L){var P=W(_);P[1].v=_.read_shift(2);var O=P[1].v>>1;if(P[1].v&1)switch(O&7){case 0:O=(O>>3)*5e3;break;case 1:O=(O>>3)*500;break;case 2:O=(O>>3)/20;break;case 3:O=(O>>3)/200;break;case 4:O=(O>>3)/2e3;break;case 5:O=(O>>3)/2e4;break;case 6:O=(O>>3)/16;break;case 7:O=(O>>3)/64;break}return P[1].v=O,P}function R(_,L){var P=W(_),O=_.read_shift(4),X=_.read_shift(4),ce=_.read_shift(2);if(ce==65535)return O===0&&X===3221225472?(P[1].t="e",P[1].v=15):O===0&&X===3489660928?(P[1].t="e",P[1].v=42):P[1].v=0,P;var fe=ce&32768;return ce=(ce&32767)-16446,P[1].v=(1-fe*2)*(X*Math.pow(2,ce+32)+O*Math.pow(2,ce)),P}function G(_,L,P,O){var X=Ce(14);if(X.write_shift(2,_),X.write_shift(1,P),X.write_shift(1,L),O==0)return X.write_shift(4,0),X.write_shift(4,0),X.write_shift(2,65535),X;var ce=0,fe=0,he=0,we=0;return O<0&&(ce=1,O=-O),fe=Math.log2(O)|0,O/=Math.pow(2,fe-31),we=O>>>0,we&2147483648||(O/=2,++fe,we=O>>>0),O-=we,we|=2147483648,we>>>=0,O*=Math.pow(2,32),he=O>>>0,X.write_shift(4,he),X.write_shift(4,we),fe+=16383+(ce?32768:0),X.write_shift(2,fe),X}function j(_,L){var P=R(_);return _.l+=L-14,P}function T(_,L){var P=W(_),O=_.read_shift(4);return P[1].v=O>>6,P}function B(_,L){var P=W(_),O=_.read_shift(8,"f");return P[1].v=O,P}function M(_,L){var P=B(_);return _.l+=L-10,P}function le(_,L){return _[_.l+L-1]==0?_.read_shift(L,"cstr"):""}function J(_,L){var P=_[_.l++];P>L-1&&(P=L-1);for(var O="";O.length<P;)O+=String.fromCharCode(_[_.l++]);return O}function z(_,L,P){if(!(!P.qpro||L<21)){var O=_.read_shift(1);_.l+=17,_.l+=1,_.l+=2;var X=_.read_shift(L-21,"cstr");return[O,X]}}function ae(_,L){for(var P={},O=_.l+L;_.l<O;){var X=_.read_shift(2);if(X==14e3){for(P[X]=[0,""],P[X][0]=_.read_shift(2);_[_.l];)P[X][1]+=String.fromCharCode(_[_.l]),_.l++;_.l++}}return P}function te(_,L){var P=Ce(5+_.length);P.write_shift(2,14e3),P.write_shift(2,L);for(var O=0;O<_.length;++O){var X=_.charCodeAt(O);P[P.l++]=X>127?95:X}return P[P.l++]=0,P}var de={0:{n:"BOF",f:_d},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:le},222:{n:"SHEETNAMELP",f:J},65535:{n:""}},xe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:V},23:{n:"NUMBER17",f:R},24:{n:"NUMBER18",f:C},25:{n:"FORMULA19",f:j},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ae},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:T},38:{n:"??"},39:{n:"NUMBER27",f:B},40:{n:"FORMULA28",f:M},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:le},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:z},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:r}}(),fx=/^\s|\s$|[\t\n\r]/;function Fd(e,r){if(!r.bookSST)return"";var t=[Er];t[t.length]=Ye("sst",null,{xmlns:Ps[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(fx)&&(i+=' xml:space="preserve"'),i+=">"+$t(a.t)+"</t>"),i+="</si>",t[t.length]=i}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function hx(e){return[e.read_shift(4),e.read_shift(4)]}function ux(e,r){return r||(r=Ce(8)),r.write_shift(4,e.Count),r.write_shift(4,e.Unique),r}var dx=ng;function px(e){var r=wn();Be(r,159,ux(e));for(var t=0;t<e.length;++t)Be(r,19,dx(e[t]));return Be(r,160),r.end()}function mx(e){for(var r=[],t=e.split(""),n=0;n<t.length;++n)r[n]=t[n].charCodeAt(0);return r}function Ld(e){var r=0,t,n=mx(e),a=n.length+1,i,o,l,c,h;for(t=Ui(a),t[0]=n.length,i=1;i!=a;++i)t[i]=n[i-1];for(i=a-1;i>=0;--i)o=t[i],l=r&16384?1:0,c=r<<1&32767,h=l|c,r=h^o;return r^52811}var gx=function(){function e(a,i){switch(i.type){case"base64":return r(za(a),i);case"binary":return r(a,i);case"buffer":return r(Ut&&Buffer.isBuffer(a)?a.toString("binary"):Ho(a),i);case"array":return r(vc(a),i)}throw new Error("Unrecognized type "+i.type)}function r(a,i){var o=i||{},l=o.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,g){Array.isArray(l)&&(l[g]=[]);for(var m=/\\\w+\b/g,d=0,y,x=-1;y=m.exec(u);){switch(y[0]){case"\\cell":var b=u.slice(d,m.lastIndex-y[0].length);if(b[0]==" "&&(b=b.slice(1)),++x,b.length){var N={v:b,t:"s"};Array.isArray(l)?l[g][x]=N:l[Yt({r:g,c:x})]=N}break}d=m.lastIndex}x>h.e.c&&(h.e.c=x)}),l["!ref"]=kr(h),l}function t(a,i){return zi(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],o=or(a["!ref"]),l,c=Array.isArray(a),h=o.s.r;h<=o.e.r;++h){i.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var g=Yt({r:h,c:u});l=c?(a[h]||[])[u]:a[g],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(Va(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:n}}();function Gh(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}var xx=6,qa=xx;function sc(e){return Math.floor((e+Math.round(128/qa)/256)*qa)}function oc(e){return Math.floor((e-5)/qa*100+.5)/100}function W0(e){return Math.round((e*qa+5)/qa*256)/256}function cf(e){e.width?(e.wpx=sc(e.width),e.wch=oc(e.wpx),e.MDW=qa):e.wpx?(e.wch=oc(e.wpx),e.width=W0(e.wch),e.MDW=qa):typeof e.wch=="number"&&(e.width=W0(e.wch),e.wpx=sc(e.width),e.MDW=qa),e.customWidth&&delete e.customWidth}var vx=96,Cd=vx;function lc(e){return e*96/Cd}function Pd(e){return e*Cd/96}function yx(e){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var n=t[0];n<=t[1];++n)e[n]!=null&&(r[r.length]=Ye("numFmt",null,{numFmtId:n,formatCode:$t(e[n])}))}),r.length===1?"":(r[r.length]="</numFmts>",r[0]=Ye("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function wx(e){var r=[];return r[r.length]=Ye("cellXfs",null),e.forEach(function(t){r[r.length]=Ye("xf",null,t)}),r[r.length]="</cellXfs>",r.length===2?"":(r[0]=Ye("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function Od(e,r){var t=[Er,Ye("styleSheet",null,{xmlns:Ps[0],"xmlns:vt":Br.vt})],n;return e.SSF&&(n=yx(e.SSF))!=null&&(t[t.length]=n),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=wx(r.cellXfs))&&(t[t.length]=n),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function bx(e,r){var t=e.read_shift(2),n=sn(e);return[t,n]}function Nx(e,r,t){t||(t=Ce(6+4*r.length)),t.write_shift(2,e),Hr(r,t);var n=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),n}function Sx(e,r,t){var n={};n.sz=e.read_shift(2)/20;var a=fg(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=cg(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=sn(e),n}function _x(e,r){r||(r=Ce(25+4*32)),r.write_shift(2,e.sz*20),hg(e,r),r.write_shift(2,e.bold?700:400);var t=0;e.vertAlign=="superscript"?t=1:e.vertAlign=="subscript"&&(t=2),r.write_shift(2,t),r.write_shift(1,e.underline||0),r.write_shift(1,e.family||0),r.write_shift(1,e.charset||0),r.write_shift(1,0),ac(e.color,r);var n=0;return n=2,r.write_shift(1,n),Hr(e.name,r),r.length>r.l?r.slice(0,r.l):r}var Ax=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],y0,jx=Ta;function $h(e,r){r||(r=Ce(4*3+8*7+16*1)),y0||(y0=K0(Ax));var t=y0[e.patternType];t==null&&(t=40),r.write_shift(4,t);var n=0;if(t!=40)for(ac({auto:1},r),ac({auto:1},r);n<12;++n)r.write_shift(4,0);else{for(;n<4;++n)r.write_shift(4,0);for(;n<12;++n)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function Tx(e,r){var t=e.l+r,n=e.read_shift(2),a=e.read_shift(2);return e.l=t,{ixfe:n,numFmtId:a}}function Id(e,r,t){t||(t=Ce(16)),t.write_shift(2,r||0),t.write_shift(2,e.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var n=0;return t.write_shift(1,n),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function mo(e,r){return r||(r=Ce(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var kx=Ta;function Ex(e,r){return r||(r=Ce(51)),r.write_shift(1,0),mo(null,r),mo(null,r),mo(null,r),mo(null,r),mo(null,r),r.length>r.l?r.slice(0,r.l):r}function Fx(e,r){return r||(r=Ce(12+4*10)),r.write_shift(4,e.xfId),r.write_shift(2,1),r.write_shift(1,0),r.write_shift(1,0),nc(e.name||"",r),r.length>r.l?r.slice(0,r.l):r}function Lx(e,r,t){var n=Ce(2052);return n.write_shift(4,e),nc(r,n),nc(t,n),n.length>n.l?n.slice(0,n.l):n}function Cx(e,r){if(r){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)r[a]!=null&&++t}),t!=0&&(Be(e,615,ua(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)r[a]!=null&&Be(e,44,Nx(a,r[a]))}),Be(e,616))}}function Px(e){var r=1;Be(e,611,ua(r)),Be(e,43,_x({sz:12,color:{theme:1},name:"Calibri",family:2})),Be(e,612)}function Ox(e){var r=2;Be(e,603,ua(r)),Be(e,45,$h({patternType:"none"})),Be(e,45,$h({patternType:"gray125"})),Be(e,604)}function Ix(e){var r=1;Be(e,613,ua(r)),Be(e,46,Ex()),Be(e,614)}function Dx(e){var r=1;Be(e,626,ua(r)),Be(e,47,Id({numFmtId:0},65535)),Be(e,627)}function Rx(e,r){Be(e,617,ua(r.length)),r.forEach(function(t){Be(e,47,Id(t,0))}),Be(e,618)}function Mx(e){var r=1;Be(e,619,ua(r)),Be(e,48,Fx({xfId:0,name:"Normal"})),Be(e,620)}function Bx(e){var r=0;Be(e,505,ua(r)),Be(e,506)}function Ux(e){var r=0;Be(e,508,Lx(r,"TableStyleMedium9","PivotStyleMedium4")),Be(e,509)}function Hx(e,r){var t=wn();return Be(t,278),Cx(t,e.SSF),Px(t),Ox(t),Ix(t),Dx(t),Rx(t,r.cellXfs),Mx(t),Bx(t),Ux(t),Be(t,279),t.end()}function Dd(e,r){if(r&&r.themeXLSX)return r.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var t=[Er];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',t[t.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',t[t.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',t[t.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜Žé«”"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',t[t.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',t[t.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',t[t.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜Žé«”"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function Wx(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:sn(e)}}function qx(e){var r=Ce(12+2*e.name.length);return r.write_shift(4,e.flags),r.write_shift(4,e.version),Hr(e.name,r),r.slice(0,r.l)}function zx(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function Vx(e){var r=Ce(4+8*e.length);r.write_shift(4,e.length);for(var t=0;t<e.length;++t)r.write_shift(4,e[t][0]),r.write_shift(4,e[t][1]);return r}function Gx(e,r){var t=Ce(8+2*r.length);return t.write_shift(4,e),Hr(r,t),t.slice(0,t.l)}function $x(e){return e.l+=4,e.read_shift(4)!=0}function Yx(e,r){var t=Ce(8);return t.write_shift(4,e),t.write_shift(4,1),t}function Xx(){var e=wn();return Be(e,332),Be(e,334,ua(1)),Be(e,335,qx({name:"XLDAPR",version:12e4,flags:3496657072})),Be(e,336),Be(e,339,Gx(1,"XLDAPR")),Be(e,52),Be(e,35,ua(514)),Be(e,4096,ua(0)),Be(e,4097,Xn(1)),Be(e,36),Be(e,53),Be(e,340),Be(e,337,Yx(1)),Be(e,51,Vx([[1,0]])),Be(e,338),Be(e,333),e.end()}function Rd(){var e=[Er];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Kx(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=Yt(t);var n=e.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}var js=1024;function Md(e,r){for(var t=[21600,21600],n=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),a=[Ye("xml",null,{"xmlns:v":Pn.v,"xmlns:o":Pn.o,"xmlns:x":Pn.x,"xmlns:mv":Pn.mv}).replace(/\/>/,">"),Ye("o:shapelayout",Ye("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ye("v:shapetype",[Ye("v:stroke",null,{joinstyle:"miter"}),Ye("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:n})];js<e*1e3;)js+=1e3;return r.forEach(function(i){var o=Ur(i[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?Ye("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=Ye("v:fill",c,l),u={on:"t",obscured:"t"};++js,a=a.concat(["<v:shape"+Ro({id:"_x0000_s"+js,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,Ye("v:shadow",null,u),Ye("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",$r("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),$r("x:AutoFill","False"),$r("x:Row",String(o.r)),$r("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function Bd(e){var r=[Er,Ye("comments",null,{xmlns:Ps[0]})],t=[];return r.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=$t(a.a);t.indexOf(i)==-1&&(t.push(i),r.push("<author>"+i+"</author>")),a.T&&a.ID&&t.indexOf("tc="+a.ID)==-1&&(t.push("tc="+a.ID),r.push("<author>tc="+a.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),e.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=t.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(a=t.indexOf($t(c.a))),i.push(c.t||"")}),r.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)r.push($r("t",$t(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,l=1;l<i.length;++l)o+=`Reply:
    `+i[l]+`
`;r.push($r("t",$t(o)))}r.push("</text></comment>")}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function Jx(e,r,t){var n=[Er,Ye("ThreadedComments",null,{xmlns:Br.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&r.indexOf(o.a)==-1&&r.push(o.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};l==0?i=c.id:c.parentId=i,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(o.a)).slice(-12)+"}"),n.push(Ye("threadedComment",$r("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function Zx(e){var r=[Er,Ye("personList",null,{xmlns:Br.TCMNT,"xmlns:x":Ps[0]}).replace(/[\/]>/,">")];return e.forEach(function(t,n){r.push(Ye("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:t,providerId:"None"}))}),r.push("</personList>"),r.join("")}function Qx(e){var r={};r.iauthor=e.read_shift(4);var t=Yi(e);return r.rfx=t.s,r.ref=Yt(t.s),e.l+=16,r}function e5(e,r){return r==null&&(r=Ce(36)),r.write_shift(4,e[1].iauthor),Is(e[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}var t5=sn;function r5(e){return Hr(e.slice(0,54))}function n5(e){var r=wn(),t=[];return Be(r,628),Be(r,630),e.forEach(function(n){n[1].forEach(function(a){t.indexOf(a.a)>-1||(t.push(a.a.slice(0,54)),Be(r,632,r5(a.a)))})}),Be(r,631),Be(r,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=t.indexOf(a.a);var i={s:Ur(n[0]),e:Ur(n[0])};Be(r,635,e5([i,a])),a.t&&a.t.length>0&&Be(r,637,ig(a)),Be(r,636),delete a.iauthor})}),Be(r,634),Be(r,629),r.end()}function a5(e,r){r.FullPaths.forEach(function(t,n){if(n!=0){var a=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Jt.utils.cfb_add(e,a,r.FileIndex[n].content)}})}var Ud=["xlsb","xlsm","xlam","biff8","xla"],i5=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(n,a,i,o){var l=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var h=i.length>0?parseInt(i,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return l?u+=r.c:--u,c?h+=r.r:--h,a+(l?"":"$")+an(u)+(c?"":"$")+Yr(h)}return function(a,i){return r=i,a.replace(e,t)}}(),ff=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,hf=function(){return function(r,t){return r.replace(ff,function(n,a,i,o,l,c){var h=nf(o)-(i?0:t.c),u=rf(c)-(l?0:t.r),g=u==0?"":l?u+1:"["+u+"]",m=h==0?"":i?h+1:"["+h+"]";return a+"R"+g+"C"+m})}}();function s5(e,r){return e.replace(ff,function(t,n,a,i,o,l){return n+(a=="$"?a+i:an(nf(i)+r.c))+(o=="$"?o+l:Yr(rf(l)+r.r))})}function o5(e){return e.length!=1}function Tr(e){e.l+=1}function yi(e,r){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function Hd(e,r,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return Wd(e);t.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),o=yi(e),l=yi(e);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function Wd(e){var r=yi(e),t=yi(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:t[0],c:a,cRel:t[1],rRel:t[2]}}}function l5(e,r,t){if(t.biff<8)return Wd(e);var n=e.read_shift(t.biff==12?4:2),a=e.read_shift(t.biff==12?4:2),i=yi(e),o=yi(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function qd(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return c5(e);var n=e.read_shift(t&&t.biff==12?4:2),a=yi(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function c5(e){var r=yi(e),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function f5(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function h5(e,r,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return u5(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),o=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;a>524287;)a-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:o,rRel:l}}function u5(e){var r=e.read_shift(2),t=e.read_shift(1),n=(r&32768)>>15,a=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),a==1&&t>=128&&(t=t-256),{r,c:t,cRel:a,rRel:n}}function d5(e,r,t){var n=(e[e.l++]&96)>>5,a=Hd(e,t.biff>=2&&t.biff<=5?6:8,t);return[n,a]}function p5(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(t)switch(t.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var o=Hd(e,i,t);return[n,a,o]}function m5(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function g5(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(t)switch(t.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function x5(e,r,t){var n=(e[e.l++]&96)>>5,a=l5(e,r-1,t);return[n,a]}function v5(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[n]}function Yh(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function y5(e,r,t){e.l+=2;for(var n=e.read_shift(t&&t.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(t&&t.biff==2?1:2));return a}function w5(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function b5(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function N5(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function S5(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[n]}function zd(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function _5(e){return e.read_shift(2),zd(e)}function A5(e){return e.read_shift(2),zd(e)}function j5(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=qd(e,0,t);return[n,a]}function T5(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=h5(e,0,t);return[n,a]}function k5(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var i=qd(e,0,t);return[n,a,i]}function E5(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(t&&t.biff<=3?1:2);return[Ev[a],$d[a],n]}function F5(e,r,t){var n=e[e.l++],a=e.read_shift(1),i=t&&t.biff<=3?[n==88?-1:0,e.read_shift(1)]:L5(e);return[a,(i[0]===0?$d:kv)[i[1]]]}function L5(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function C5(e,r,t){e.l+=t&&t.biff==2?3:4}function P5(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function O5(e){return e.l++,zo[e.read_shift(1)]}function I5(e){return e.l++,e.read_shift(2)}function D5(e){return e.l++,e.read_shift(1)!==0}function R5(e){return e.l++,Ds(e)}function M5(e,r,t){return e.l++,jd(e,r-1,t)}function B5(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=kg(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=zo[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Ds(e);break;case 2:t[1]=Cg(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function U5(e,r,t){for(var n=e.read_shift(t.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((t.biff==12?Yi:Ig)(e));return a}function H5(e,r,t){var n=0,a=0;t.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--a==0&&(a=256));for(var i=0,o=[];i!=n&&(o[i]=[]);++i)for(var l=0;l!=a;++l)o[i][l]=B5(e,t.biff);return o}function W5(e,r,t){var n=e.read_shift(1)>>>5&3,a=!t||t.biff>=8?4:2,i=e.read_shift(a);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function q5(e,r,t){if(t.biff==5)return z5(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function z5(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[r,t,n]}function V5(e,r,t){var n=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function G5(e,r,t){var n=e.read_shift(1)>>>5&3,a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function $5(e,r,t){var n=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[n]}function Y5(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(t)switch(t.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var X5=Ta,K5=Ta,J5=Ta;function Vo(e,r,t){return e.l+=2,[f5(e)]}function uf(e){return e.l+=6,[]}var Z5=Vo,Q5=uf,ev=uf,tv=Vo;function Vd(e){return e.l+=2,[_d(e),e.read_shift(2)&1]}var rv=Vo,nv=Vd,av=uf,iv=Vo,sv=Vo,ov=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function lv(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),o=ov[t>>2&31];return{ixti:r,coltype:t&3,rt:o,idx:n,c:a,C:i}}function cv(e){return e.l+=2,[e.read_shift(4)]}function fv(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function hv(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function uv(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function dv(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function pv(e){return e.l+=4,[0,0]}var Xh={1:{n:"PtgExp",f:P5},2:{n:"PtgTbl",f:J5},3:{n:"PtgAdd",f:Tr},4:{n:"PtgSub",f:Tr},5:{n:"PtgMul",f:Tr},6:{n:"PtgDiv",f:Tr},7:{n:"PtgPower",f:Tr},8:{n:"PtgConcat",f:Tr},9:{n:"PtgLt",f:Tr},10:{n:"PtgLe",f:Tr},11:{n:"PtgEq",f:Tr},12:{n:"PtgGe",f:Tr},13:{n:"PtgGt",f:Tr},14:{n:"PtgNe",f:Tr},15:{n:"PtgIsect",f:Tr},16:{n:"PtgUnion",f:Tr},17:{n:"PtgRange",f:Tr},18:{n:"PtgUplus",f:Tr},19:{n:"PtgUminus",f:Tr},20:{n:"PtgPercent",f:Tr},21:{n:"PtgParen",f:Tr},22:{n:"PtgMissArg",f:Tr},23:{n:"PtgStr",f:M5},26:{n:"PtgSheet",f:fv},27:{n:"PtgEndSheet",f:hv},28:{n:"PtgErr",f:O5},29:{n:"PtgBool",f:D5},30:{n:"PtgInt",f:I5},31:{n:"PtgNum",f:R5},32:{n:"PtgArray",f:v5},33:{n:"PtgFunc",f:E5},34:{n:"PtgFuncVar",f:F5},35:{n:"PtgName",f:W5},36:{n:"PtgRef",f:j5},37:{n:"PtgArea",f:d5},38:{n:"PtgMemArea",f:V5},39:{n:"PtgMemErr",f:X5},40:{n:"PtgMemNoMem",f:K5},41:{n:"PtgMemFunc",f:G5},42:{n:"PtgRefErr",f:$5},43:{n:"PtgAreaErr",f:m5},44:{n:"PtgRefN",f:T5},45:{n:"PtgAreaN",f:x5},46:{n:"PtgMemAreaN",f:uv},47:{n:"PtgMemNoMemN",f:dv},57:{n:"PtgNameX",f:q5},58:{n:"PtgRef3d",f:k5},59:{n:"PtgArea3d",f:p5},60:{n:"PtgRefErr3d",f:Y5},61:{n:"PtgAreaErr3d",f:g5},255:{}},mv={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},gv={1:{n:"PtgElfLel",f:Vd},2:{n:"PtgElfRw",f:iv},3:{n:"PtgElfCol",f:Z5},6:{n:"PtgElfRwV",f:sv},7:{n:"PtgElfColV",f:tv},10:{n:"PtgElfRadical",f:rv},11:{n:"PtgElfRadicalS",f:av},13:{n:"PtgElfColS",f:Q5},15:{n:"PtgElfColSV",f:ev},16:{n:"PtgElfRadicalLel",f:nv},25:{n:"PtgList",f:lv},29:{n:"PtgSxName",f:cv},255:{}},xv={0:{n:"PtgAttrNoop",f:pv},1:{n:"PtgAttrSemi",f:S5},2:{n:"PtgAttrIf",f:b5},4:{n:"PtgAttrChoose",f:y5},8:{n:"PtgAttrGoto",f:w5},16:{n:"PtgAttrSum",f:C5},32:{n:"PtgAttrBaxcel",f:Yh},33:{n:"PtgAttrBaxcel",f:Yh},64:{n:"PtgAttrSpace",f:_5},65:{n:"PtgAttrSpaceSemi",f:A5},128:{n:"PtgAttrIfError",f:N5},255:{}};function vv(e,r,t,n){if(n.biff<8)return Ta(e,r);for(var a=e.l+r,i=[],o=0;o!==t.length;++o)switch(t[o][0]){case"PtgArray":t[o][1]=H5(e,0,n),i.push(t[o][1]);break;case"PtgMemArea":t[o][2]=U5(e,t[o][1],n),i.push(t[o][2]);break;case"PtgExp":n&&n.biff==12&&(t[o][1][1]=e.read_shift(4),i.push(t[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[o][0]}return r=a-e.l,r!==0&&i.push(Ta(e,r)),i}function yv(e,r,t){for(var n=e.l+r,a,i,o=[];n!=e.l;)r=n-e.l,i=e[e.l],a=Xh[i]||Xh[mv[i]],(i===24||i===25)&&(a=(i===24?gv:xv)[e[e.l+1]]),!a||!a.f?Ta(e,r):o.push([a.n,a.f(e,r,t)]);return o}function wv(e){for(var r=[],t=0;t<e.length;++t){for(var n=e[t],a=[],i=0;i<n.length;++i){var o=n[i];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}r.push(a.join(","))}return r.join(";")}var bv={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Nv(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Gd(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!n)return"SH33TJSERR1";var a="";if(t.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Kh(e,r,t){var n=Gd(e,r,t);return n=="#REF"?n:Nv(n,t)}function Ls(e,r,t,n,a){var i=a&&a.biff||8,o={s:{c:0,r:0}},l=[],c,h,u,g=0,m=0,d,y="";if(!e[0]||!e[0][0])return"";for(var x=-1,b="",N=0,w=e[0].length;N<w;++N){var A=e[0][N];switch(A[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),h=l.pop(),x>=0){switch(e[0][x][1][0]){case 0:b=pr(" ",e[0][x][1][1]);break;case 1:b=pr("\r",e[0][x][1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}h=h+b,x=-1}l.push(h+bv[A[0]]+c);break;case"PtgIsect":c=l.pop(),h=l.pop(),l.push(h+" "+c);break;case"PtgUnion":c=l.pop(),h=l.pop(),l.push(h+","+c);break;case"PtgRange":c=l.pop(),h=l.pop(),l.push(h+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=To(A[1][1],o,a),l.push(ko(u,i));break;case"PtgRefN":u=t?To(A[1][1],t,a):A[1][1],l.push(ko(u,i));break;case"PtgRef3d":g=A[1][1],u=To(A[1][2],o,a),y=Kh(n,g,a),l.push(y+"!"+ko(u,i));break;case"PtgFunc":case"PtgFuncVar":var E=A[1][0],W=A[1][1];E||(E=0),E&=127;var V=E==0?[]:l.slice(-E);l.length-=E,W==="User"&&(W=V.shift()),l.push(W+"("+V.join(",")+")");break;case"PtgBool":l.push(A[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(A[1]);break;case"PtgNum":l.push(String(A[1]));break;case"PtgStr":l.push('"'+A[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(A[1]);break;case"PtgAreaN":d=Oh(A[1][1],t?{s:t}:o,a),l.push(x0(d,a));break;case"PtgArea":d=Oh(A[1][1],o,a),l.push(x0(d,a));break;case"PtgArea3d":g=A[1][1],d=A[1][2],y=Kh(n,g,a),l.push(y+"!"+x0(d,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=A[1][2];var F=(n.names||[])[m-1]||(n[0]||[])[m],C=F?F.Name:"SH33TJSNAME"+String(m);C&&C.slice(0,6)=="_xlfn."&&!a.xlfn&&(C=C.slice(6)),l.push(C);break;case"PtgNameX":var R=A[1][1];m=A[1][2];var G;if(a.biff<=5)R<0&&(R=-R),n[R]&&(G=n[R][m]);else{var j="";if(((n[R]||[])[0]||[])[0]==14849||(((n[R]||[])[0]||[])[0]==1025?n[R][m]&&n[R][m].itab>0&&(j=n.SheetNames[n[R][m].itab-1]+"!"):j=n.SheetNames[m-1]+"!"),n[R]&&n[R][m])j+=n[R][m].Name;else if(n[0]&&n[0][m])j+=n[0][m].Name;else{var T=(Gd(n,R,a)||"").split(";;");T[m-1]?j=T[m-1]:j+="SH33TJSERRX"}l.push(j);break}G||(G={Name:"SH33TJSERRY"}),l.push(G.Name);break;case"PtgParen":var B="(",M=")";if(x>=0){switch(b="",e[0][x][1][0]){case 2:B=pr(" ",e[0][x][1][1])+B;break;case 3:B=pr("\r",e[0][x][1][1])+B;break;case 4:M=pr(" ",e[0][x][1][1])+M;break;case 5:M=pr("\r",e[0][x][1][1])+M;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}l.push(B+l.pop()+M);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":u={c:A[1][1],r:A[1][0]};var le={c:t.c,r:t.r};if(n.sharedf[Yt(u)]){var J=n.sharedf[Yt(u)];l.push(Ls(J,o,le,n,a))}else{var z=!1;for(c=0;c!=n.arrayf.length;++c)if(h=n.arrayf[c],!(u.c<h[0].s.c||u.c>h[0].e.c)&&!(u.r<h[0].s.r||u.r>h[0].e.r)){l.push(Ls(h[1],o,le,n,a)),z=!0;break}z||l.push(A[1])}break;case"PtgArray":l.push("{"+wv(A[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=N;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+A[1].idx+"[#"+A[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(A));default:throw new Error("Unrecognized Formula Token: "+String(A))}var ae=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&x>=0&&ae.indexOf(e[0][N][0])==-1){A=e[0][x];var te=!0;switch(A[1][0]){case 4:te=!1;case 0:b=pr(" ",A[1][1]);break;case 5:te=!1;case 1:b=pr("\r",A[1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+A[1][0])}l.push((te?b:"")+l.pop()+(te?"":b)),x=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]}function Sv(e){if(e==null){var r=Ce(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}else if(typeof e=="number")return Hi(e);return Hi(0)}function _v(e,r,t,n,a){var i=Wi(r,t,a),o=Sv(e.v),l=Ce(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var h=Ce(e.bf.length),u=0;u<e.bf.length;++u)h[u]=e.bf[u];var g=Gr([i,o,l,h]);return g}function yc(e,r,t){var n=e.read_shift(4),a=yv(e,n,t),i=e.read_shift(4),o=i>0?vv(e,i,a,t):null;return[a,o]}var Av=yc,wc=yc,jv=yc,Tv=yc,kv={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},$d={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Ev={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Fv(e){var r="of:="+e.replace(ff,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return r.replace(/;/g,"|").replace(/,/g,";")}function Lv(e){return e.replace(/\./,"!")}var Eo=typeof Map<"u";function df(e,r,t){var n=0,a=e.length;if(t){if(Eo?t.has(r):Object.prototype.hasOwnProperty.call(t,r)){for(var i=Eo?t.get(r):t[r];n<i.length;++n)if(e[i[n]].t===r)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===r)return e.Count++,n;return e[a]={t:r},e.Count++,e.Unique++,t&&(Eo?(t.has(r)||t.set(r,[]),t.get(r).push(a)):(Object.prototype.hasOwnProperty.call(t,r)||(t[r]=[]),t[r].push(a))),a}function bc(e,r){var t={min:e+1,max:e+1},n=-1;return r.MDW&&(qa=r.MDW),r.width!=null?t.customWidth=1:r.wpx!=null?n=oc(r.wpx):r.wch!=null&&(n=r.wch),n>-1?(t.width=W0(n),t.customWidth=1):r.width!=null&&(t.width=r.width),r.hidden&&(t.hidden=!0),r.level!=null&&(t.outlineLevel=t.level=r.level),t}function Yd(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function bi(e,r,t){var n=t.revssf[r.z!=null?r.z:"General"],a=60,i=e.length;if(n==null&&t.ssf){for(;a<392;++a)if(t.ssf[a]==null){qu(r.z,a),t.ssf[a]=r.z,t.revssf[r.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function Cv(e,r,t){if(e&&e["!ref"]){var n=or(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+t+"): "+e["!ref"])}}function Pv(e){if(e.length===0)return"";for(var r='<mergeCells count="'+e.length+'">',t=0;t!=e.length;++t)r+='<mergeCell ref="'+kr(e[t])+'"/>';return r+"</mergeCells>"}function Ov(e,r,t,n,a){var i=!1,o={},l=null;if(n.bookType!=="xlsx"&&r.vbaraw){var c=r.SheetNames[t];try{r.Workbook&&(c=r.Workbook.Sheets[t].CodeName||c)}catch{}i=!0,o.codeName=Do($t(c))}if(e&&e["!outline"]){var h={summaryBelow:1,summaryRight:1};e["!outline"].above&&(h.summaryBelow=0),e["!outline"].left&&(h.summaryRight=0),l=(l||"")+Ye("outlinePr",null,h)}!i&&!l||(a[a.length]=Ye("sheetPr",l,o))}var Iv=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Dv=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Rv(e){var r={sheet:1};return Iv.forEach(function(t){e[t]!=null&&e[t]&&(r[t]="1")}),Dv.forEach(function(t){e[t]!=null&&!e[t]&&(r[t]="0")}),e.password&&(r.password=Ld(e.password).toString(16).toUpperCase()),Ye("sheetProtection",null,r)}function Mv(e){return Yd(e),Ye("pageMargins",null,e)}function Bv(e,r){for(var t=["<cols>"],n,a=0;a!=r.length;++a)(n=r[a])&&(t[t.length]=Ye("col",null,bc(a,n)));return t[t.length]="</cols>",t.join("")}function Uv(e,r,t,n){var a=typeof e.ref=="string"?e.ref:kr(e.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var i=t.Workbook.Names,o=Dn(a);o.s.r==o.e.r&&(o.e.r=Dn(r["!ref"]).e.r,a=kr(o));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+t.SheetNames[n]+"'!"+a;break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+a}),Ye("autoFilter",null,{ref:a})}function Hv(e,r,t,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ye("sheetViews",Ye("sheetView",null,a),{})}function Wv(e,r,t,n){if(e.c&&t["!comments"].push([r,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",i=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=zo[e.v];break;case"d":n&&n.cellDates?a=un(e.v,-1).toISOString():(e=Nn(e),e.t="n",a=""+(e.v=bn(un(e.v)))),typeof e.z>"u"&&(e.z=mr[14]);break;default:a=e.v;break}var l=$r("v",$t(a)),c={r},h=bi(n.cellXfs,e,n);switch(h!==0&&(c.s=h),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=$r("v",""+df(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=o),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,r.length)==r?{t:"array",ref:e.F}:null;l=Ye("f",$t(e.f),u)+(e.v!=null?l:"")}return e.l&&t["!links"].push([r,e.l]),e.D&&(c.cm=1),Ye("c",l,c)}function qv(e,r,t,n){var a=[],i=[],o=or(e["!ref"]),l="",c,h="",u=[],g=0,m=0,d=e["!rows"],y=Array.isArray(e),x={r:h},b,N=-1;for(m=o.s.c;m<=o.e.c;++m)u[m]=an(m);for(g=o.s.r;g<=o.e.r;++g){for(i=[],h=Yr(g),m=o.s.c;m<=o.e.c;++m){c=u[m]+h;var w=y?(e[g]||[])[m]:e[c];w!==void 0&&(l=Wv(w,c,e,r))!=null&&i.push(l)}(i.length>0||d&&d[g])&&(x={r:h},d&&d[g]&&(b=d[g],b.hidden&&(x.hidden=1),N=-1,b.hpx?N=lc(b.hpx):b.hpt&&(N=b.hpt),N>-1&&(x.ht=N,x.customHeight=1),b.level&&(x.outlineLevel=b.level)),a[a.length]=Ye("row",i.join(""),x))}if(d)for(;g<d.length;++g)d&&d[g]&&(x={r:g+1},b=d[g],b.hidden&&(x.hidden=1),N=-1,b.hpx?N=lc(b.hpx):b.hpt&&(N=b.hpt),N>-1&&(x.ht=N,x.customHeight=1),b.level&&(x.outlineLevel=b.level),a[a.length]=Ye("row","",x));return a.join("")}function Xd(e,r,t,n){var a=[Er,Ye("worksheet",null,{xmlns:Ps[0],"xmlns:r":Br.r})],i=t.SheetNames[e],o=0,l="",c=t.Sheets[i];c==null&&(c={});var h=c["!ref"]||"A1",u=or(h);if(u.e.c>16383||u.e.r>1048575){if(r.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),h=kr(u)}n||(n={}),c["!comments"]=[];var g=[];Ov(c,t,e,r,a),a[a.length]=Ye("dimension",null,{ref:h}),a[a.length]=Hv(c,r,e,t),r.sheetFormat&&(a[a.length]=Ye("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=Bv(c,c["!cols"])),a[o=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=qv(c,r),l.length>0&&(a[a.length]=l)),a.length>o+1&&(a[a.length]="</sheetData>",a[o]=a[o].replace("/>",">")),c["!protect"]&&(a[a.length]=Rv(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=Uv(c["!autofilter"],c,t,e)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=Pv(c["!merges"]));var m=-1,d,y=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(x){x[1].Target&&(d={ref:x[0]},x[1].Target.charAt(0)!="#"&&(y=Gt(n,-1,$t(x[1].Target).replace(/#.*$/,""),Rt.HLINK),d["r:id"]="rId"+y),(m=x[1].Target.indexOf("#"))>-1&&(d.location=$t(x[1].Target.slice(m+1))),x[1].Tooltip&&(d.tooltip=$t(x[1].Tooltip)),a[a.length]=Ye("hyperlink",null,d))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=Mv(c["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&(a[a.length]=$r("ignoredErrors",Ye("ignoredError",null,{numberStoredAsText:1,sqref:h}))),g.length>0&&(y=Gt(n,-1,"../drawings/drawing"+(e+1)+".xml",Rt.DRAW),a[a.length]=Ye("drawing",null,{"r:id":"rId"+y}),c["!drawing"]=g),c["!comments"].length>0&&(y=Gt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Rt.VML),a[a.length]=Ye("legacyDrawing",null,{"r:id":"rId"+y}),c["!legacy"]=y),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function zv(e,r){var t={},n=e.l+r;t.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(t.level=i&7),i&16&&(t.hidden=!0),i&32&&(t.hpt=a/20),t}function Vv(e,r,t){var n=Ce(145),a=(t["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=lc(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var o=0;a.level&&(o|=a.level),a.hidden&&(o|=16),(a.hpx||a.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var h={r:e,c:0},u=0;u<16;++u)if(!(r.s.c>u+1<<10||r.e.c<u<<10)){for(var g=-1,m=-1,d=u<<10;d<u+1<<10;++d){h.c=d;var y=Array.isArray(t)?(t[h.r]||[])[h.c]:t[Yt(h)];y&&(g<0&&(g=d),m=d)}g<0||(++l,n.write_shift(4,g),n.write_shift(4,m))}var x=n.l;return n.l=c,n.write_shift(4,l),n.l=x,n.length>n.l?n.slice(0,n.l):n}function Gv(e,r,t,n){var a=Vv(n,t,r);(a.length>17||(r["!rows"]||[])[n])&&Be(e,0,a)}var $v=Yi,Yv=Is;function Xv(){}function Kv(e,r){var t={},n=e[e.l];return++e.l,t.above=!(n&64),t.left=!(n&128),e.l+=18,t.name=sg(e),t}function Jv(e,r,t){t==null&&(t=Ce(84+4*e.length));var n=192;r&&(r.above&&(n&=-65),r.left&&(n&=-129)),t.write_shift(1,n);for(var a=1;a<3;++a)t.write_shift(1,0);return ac({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),fd(e,t),t.slice(0,t.l)}function Zv(e){var r=Kn(e);return[r]}function Qv(e,r,t){return t==null&&(t=Ce(8)),Vi(r,t)}function ey(e){var r=Gi(e);return[r]}function ty(e,r,t){return t==null&&(t=Ce(4)),$i(r,t)}function ry(e){var r=Kn(e),t=e.read_shift(1);return[r,t,"b"]}function ny(e,r,t){return t==null&&(t=Ce(9)),Vi(r,t),t.write_shift(1,e.v?1:0),t}function ay(e){var r=Gi(e),t=e.read_shift(1);return[r,t,"b"]}function iy(e,r,t){return t==null&&(t=Ce(5)),$i(r,t),t.write_shift(1,e.v?1:0),t}function sy(e){var r=Kn(e),t=e.read_shift(1);return[r,t,"e"]}function oy(e,r,t){return t==null&&(t=Ce(9)),Vi(r,t),t.write_shift(1,e.v),t}function ly(e){var r=Gi(e),t=e.read_shift(1);return[r,t,"e"]}function cy(e,r,t){return t==null&&(t=Ce(8)),$i(r,t),t.write_shift(1,e.v),t.write_shift(2,0),t.write_shift(1,0),t}function fy(e){var r=Kn(e),t=e.read_shift(4);return[r,t,"s"]}function hy(e,r,t){return t==null&&(t=Ce(12)),Vi(r,t),t.write_shift(4,r.v),t}function uy(e){var r=Gi(e),t=e.read_shift(4);return[r,t,"s"]}function dy(e,r,t){return t==null&&(t=Ce(8)),$i(r,t),t.write_shift(4,r.v),t}function py(e){var r=Kn(e),t=Ds(e);return[r,t,"n"]}function my(e,r,t){return t==null&&(t=Ce(16)),Vi(r,t),Hi(e.v,t),t}function gy(e){var r=Gi(e),t=Ds(e);return[r,t,"n"]}function xy(e,r,t){return t==null&&(t=Ce(12)),$i(r,t),Hi(e.v,t),t}function vy(e){var r=Kn(e),t=hd(e);return[r,t,"n"]}function yy(e,r,t){return t==null&&(t=Ce(12)),Vi(r,t),ud(e.v,t),t}function wy(e){var r=Gi(e),t=hd(e);return[r,t,"n"]}function by(e,r,t){return t==null&&(t=Ce(8)),$i(r,t),ud(e.v,t),t}function Ny(e){var r=Kn(e),t=af(e);return[r,t,"is"]}function Sy(e){var r=Kn(e),t=sn(e);return[r,t,"str"]}function _y(e,r,t){return t==null&&(t=Ce(12+4*e.v.length)),Vi(r,t),Hr(e.v,t),t.length>t.l?t.slice(0,t.l):t}function Ay(e){var r=Gi(e),t=sn(e);return[r,t,"str"]}function jy(e,r,t){return t==null&&(t=Ce(8+4*e.v.length)),$i(r,t),Hr(e.v,t),t.length>t.l?t.slice(0,t.l):t}function Ty(e,r,t){var n=e.l+r,a=Kn(e);a.r=t["!row"];var i=e.read_shift(1),o=[a,i,"b"];if(t.cellFormula){e.l+=2;var l=wc(e,n-e.l,t);o[3]=Ls(l,null,a,t.supbooks,t)}else e.l=n;return o}function ky(e,r,t){var n=e.l+r,a=Kn(e);a.r=t["!row"];var i=e.read_shift(1),o=[a,i,"e"];if(t.cellFormula){e.l+=2;var l=wc(e,n-e.l,t);o[3]=Ls(l,null,a,t.supbooks,t)}else e.l=n;return o}function Ey(e,r,t){var n=e.l+r,a=Kn(e);a.r=t["!row"];var i=Ds(e),o=[a,i,"n"];if(t.cellFormula){e.l+=2;var l=wc(e,n-e.l,t);o[3]=Ls(l,null,a,t.supbooks,t)}else e.l=n;return o}function Fy(e,r,t){var n=e.l+r,a=Kn(e);a.r=t["!row"];var i=sn(e),o=[a,i,"str"];if(t.cellFormula){e.l+=2;var l=wc(e,n-e.l,t);o[3]=Ls(l,null,a,t.supbooks,t)}else e.l=n;return o}var Ly=Yi,Cy=Is;function Py(e,r){return r==null&&(r=Ce(4)),r.write_shift(4,e),r}function Oy(e,r){var t=e.l+r,n=Yi(e),a=sf(e),i=sn(e),o=sn(e),l=sn(e);e.l=t;var c={rfx:n,relId:a,loc:i,display:l};return o&&(c.Tooltip=o),c}function Iy(e,r){var t=Ce(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Is({s:Ur(e[0]),e:Ur(e[0])},t),of("rId"+r,t);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return Hr(a||"",t),Hr(e[1].Tooltip||"",t),Hr("",t),t.slice(0,t.l)}function Dy(){}function Ry(e,r,t){var n=e.l+r,a=dd(e),i=e.read_shift(1),o=[a];if(o[2]=i,t.cellFormula){var l=Av(e,n-e.l,t);o[1]=l}else e.l=n;return o}function My(e,r,t){var n=e.l+r,a=Yi(e),i=[a];if(t.cellFormula){var o=Tv(e,n-e.l,t);i[1]=o,e.l=n}else e.l=n;return i}function By(e,r,t){t==null&&(t=Ce(18));var n=bc(e,r);t.write_shift(-4,e),t.write_shift(-4,e),t.write_shift(4,(n.width||10)*256),t.write_shift(4,0);var a=0;return r.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),r.level&&(a|=r.level<<8),t.write_shift(2,a),t}var Kd=["left","right","top","bottom","header","footer"];function Uy(e){var r={};return Kd.forEach(function(t){r[t]=Ds(e)}),r}function Hy(e,r){return r==null&&(r=Ce(6*8)),Yd(e),Kd.forEach(function(t){Hi(e[t],r)}),r}function Wy(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function qy(e,r,t){t==null&&(t=Ce(30));var n=924;return(((r||{}).Views||[])[0]||{}).RTL&&(n|=32),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function zy(e){var r=Ce(24);return r.write_shift(4,4),r.write_shift(4,1),Is(e,r),r}function Vy(e,r){return r==null&&(r=Ce(16*4+2)),r.write_shift(2,e.password?Ld(e.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?r.write_shift(4,e[t[0]]!=null&&!e[t[0]]?1:0):r.write_shift(4,e[t[0]]!=null&&e[t[0]]?0:1)}),r}function Gy(){}function $y(){}function Yy(e,r,t,n,a,i,o){if(r.v===void 0)return!1;var l="";switch(r.t){case"b":l=r.v?"1":"0";break;case"d":r=Nn(r),r.z=r.z||mr[14],r.v=bn(un(r.v)),r.t="n";break;case"n":case"e":l=""+r.v;break;default:l=r.v;break}var c={r:t,c:n};switch(c.s=bi(a.cellXfs,r,a),r.l&&i["!links"].push([Yt(c),r.l]),r.c&&i["!comments"].push([Yt(c),r.c]),r.t){case"s":case"str":return a.bookSST?(l=df(a.Strings,r.v,a.revStrings),c.t="s",c.v=l,o?Be(e,18,dy(r,c)):Be(e,7,hy(r,c))):(c.t="str",o?Be(e,17,jy(r,c)):Be(e,6,_y(r,c))),!0;case"n":return r.v==(r.v|0)&&r.v>-1e3&&r.v<1e3?o?Be(e,13,by(r,c)):Be(e,2,yy(r,c)):o?Be(e,16,xy(r,c)):Be(e,5,my(r,c)),!0;case"b":return c.t="b",o?Be(e,15,iy(r,c)):Be(e,4,ny(r,c)),!0;case"e":return c.t="e",o?Be(e,14,cy(r,c)):Be(e,3,oy(r,c)),!0}return o?Be(e,12,ty(r,c)):Be(e,1,Qv(r,c)),!0}function Xy(e,r,t,n){var a=or(r["!ref"]||"A1"),i,o="",l=[];Be(e,145);var c=Array.isArray(r),h=a.e.r;r["!rows"]&&(h=Math.max(a.e.r,r["!rows"].length-1));for(var u=a.s.r;u<=h;++u){o=Yr(u),Gv(e,r,a,u);var g=!1;if(u<=a.e.r)for(var m=a.s.c;m<=a.e.c;++m){u===a.s.r&&(l[m]=an(m)),i=l[m]+o;var d=c?(r[u]||[])[m]:r[i];if(!d){g=!1;continue}g=Yy(e,d,u,m,n,r,g)}}Be(e,146)}function Ky(e,r){!r||!r["!merges"]||(Be(e,177,Py(r["!merges"].length)),r["!merges"].forEach(function(t){Be(e,176,Cy(t))}),Be(e,178))}function Jy(e,r){!r||!r["!cols"]||(Be(e,390),r["!cols"].forEach(function(t,n){t&&Be(e,60,By(n,t))}),Be(e,391))}function Zy(e,r){!r||!r["!ref"]||(Be(e,648),Be(e,649,zy(or(r["!ref"]))),Be(e,650))}function Qy(e,r,t){r["!links"].forEach(function(n){if(n[1].Target){var a=Gt(t,-1,n[1].Target.replace(/#.*$/,""),Rt.HLINK);Be(e,494,Iy(n,a))}}),delete r["!links"]}function e4(e,r,t,n){if(r["!comments"].length>0){var a=Gt(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Rt.VML);Be(e,551,of("rId"+a)),r["!legacy"]=a}}function t4(e,r,t,n){if(r["!autofilter"]){var a=r["!autofilter"],i=typeof a.ref=="string"?a.ref:kr(a.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var o=t.Workbook.Names,l=Dn(i);l.s.r==l.e.r&&(l.e.r=Dn(r["!ref"]).e.r,i=kr(l));for(var c=0;c<o.length;++c){var h=o[c];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==n){h.Ref="'"+t.SheetNames[n]+"'!"+i;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+i}),Be(e,161,Is(or(i))),Be(e,162)}}function r4(e,r,t){Be(e,133),Be(e,137,qy(r,t)),Be(e,138),Be(e,134)}function n4(e,r){r["!protect"]&&Be(e,535,Vy(r["!protect"]))}function a4(e,r,t,n){var a=wn(),i=t.SheetNames[e],o=t.Sheets[i]||{},l=i;try{t&&t.Workbook&&(l=t.Workbook.Sheets[e].CodeName||l)}catch{}var c=or(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(r.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Be(a,129),(t.vbaraw||o["!outline"])&&Be(a,147,Jv(l,o["!outline"])),Be(a,148,Yv(c)),r4(a,o,t.Workbook),Jy(a,o),Xy(a,o,e,r),n4(a,o),t4(a,o,t,e),Ky(a,o),Qy(a,o,n),o["!margins"]&&Be(a,476,Hy(o["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&Zy(a,o),e4(a,o,e,n),Be(a,130),a.end()}function i4(e,r){e.l+=10;var t=sn(e);return{name:t}}var s4=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function o4(e){return!e.Workbook||!e.Workbook.WBProps?"false":Mm(e.Workbook.WBProps.date1904)?"true":"false"}var l4="][*?/\\".split("");function Jd(e,r){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return l4.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function c4(e,r,t){e.forEach(function(n,a){Jd(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(t){var o=r&&r[a]&&r[a].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function f4(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var r=e.Workbook&&e.Workbook.Sheets||[];c4(e.SheetNames,r,!!e.vbaraw);for(var t=0;t<e.SheetNames.length;++t)Cv(e.Sheets[e.SheetNames[t]],e.SheetNames[t],t)}function Zd(e){var r=[Er];r[r.length]=Ye("workbook",null,{xmlns:Ps[0],"xmlns:r":Br.r});var t=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(s4.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),r[r.length]=Ye("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(r[r.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),r[r.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var o={name:$t(e.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}r[r.length]=Ye("sheet",null,o)}return r[r.length]="</sheets>",t&&(r[r.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(r[r.length]=Ye("definedName",$t(l.Ref),c))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function h4(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=H0(e),t.name=sn(e),t}function u4(e,r){return r||(r=Ce(127)),r.write_shift(4,e.Hidden),r.write_shift(4,e.iTabID),of(e.strRelID,r),Hr(e.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function d4(e,r){var t={},n=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var a=r>8?sn(e):"";return a.length>0&&(t.CodeName=a),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function p4(e,r){r||(r=Ce(72));var t=0;return e&&e.filterPrivacy&&(t|=8),r.write_shift(4,t),r.write_shift(4,0),fd(e&&e.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}function m4(e,r,t){var n=e.l+r;e.l+=4,e.l+=1;var a=e.read_shift(4),i=og(e),o=jv(e,0,t),l=sf(e);e.l=n;var c={Name:i,Ptg:o};return a<268435455&&(c.Sheet=a),l&&(c.Comment=l),c}function g4(e,r){Be(e,143);for(var t=0;t!=r.SheetNames.length;++t){var n=r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t]&&r.Workbook.Sheets[t].Hidden||0,a={Hidden:n,iTabID:t+1,strRelID:"rId"+(t+1),name:r.SheetNames[t]};Be(e,156,u4(a))}Be(e,144)}function x4(e,r){r||(r=Ce(127));for(var t=0;t!=4;++t)r.write_shift(4,0);return Hr("SheetJS",r),Hr(Kl.version,r),Hr(Kl.version,r),Hr("7262",r),r.length>r.l?r.slice(0,r.l):r}function v4(e,r){r||(r=Ce(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,e),r.write_shift(4,e);var t=120;return r.write_shift(1,t),r.length>r.l?r.slice(0,r.l):r}function y4(e,r){if(!(!r.Workbook||!r.Workbook.Sheets)){for(var t=r.Workbook.Sheets,n=0,a=-1,i=-1;n<t.length;++n)!t[n]||!t[n].Hidden&&a==-1?a=n:t[n].Hidden==1&&i==-1&&(i=n);i>a||(Be(e,135),Be(e,158,v4(a)),Be(e,136))}}function w4(e,r){var t=wn();return Be(t,131),Be(t,128,x4()),Be(t,153,p4(e.Workbook&&e.Workbook.WBProps||null)),y4(t,e),g4(t,e),Be(t,132),t.end()}function b4(e,r,t){return(r.slice(-4)===".bin"?w4:Zd)(e)}function N4(e,r,t,n,a){return(r.slice(-4)===".bin"?a4:Xd)(e,t,n,a)}function S4(e,r,t){return(r.slice(-4)===".bin"?Hx:Od)(e,t)}function _4(e,r,t){return(r.slice(-4)===".bin"?px:Fd)(e,t)}function A4(e,r,t){return(r.slice(-4)===".bin"?n5:Bd)(e)}function j4(e){return(e.slice(-4)===".bin"?Xx:Rd)()}function T4(e,r){var t=[];return e.Props&&t.push(Sg(e.Props,r)),e.Custprops&&t.push(_g(e.Props,e.Custprops)),t.join("")}function k4(){return""}function E4(e,r){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(n,a){var i=[];i.push(Ye("NumberFormat",null,{"ss:Format":$t(mr[n.numFmtId])}));var o={"ss:ID":"s"+(21+a)};t.push(Ye("Style",i.join(""),o))}),Ye("Styles",t.join(""))}function Qd(e){return Ye("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+hf(e.Ref,{r:0,c:0})})}function F4(e){if(!((e||{}).Workbook||{}).Names)return"";for(var r=e.Workbook.Names,t=[],n=0;n<r.length;++n){var a=r[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||t.push(Qd(a)))}return Ye("Names",t.join(""))}function L4(e,r,t,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],o=0;o<a.length;++o){var l=a[o];l.Sheet==t&&(l.Name.match(/^_xlfn\./)||i.push(Qd(l)))}return i.join("")}function C4(e,r,t,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Ye("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Ye("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Ye("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[t])if(n.Workbook.Sheets[t].Hidden)a.push(Ye("Visible",n.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<t&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==t&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push($r("ProtectContents","True")),e["!protect"].objects&&a.push($r("ProtectObjects","True")),e["!protect"].scenarios&&a.push($r("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push($r("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push($r("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&a.push("<"+o[1]+"/>")})),a.length==0?"":Ye("WorksheetOptions",a.join(""),{xmlns:Pn.x})}function P4(e){return e.map(function(r){var t=Rm(r.t||""),n=Ye("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ye("Comment",n,{"ss:Author":r.a})}).join("")}function O4(e,r,t,n,a,i,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+$t(hf(e.f,o))),e.F&&e.F.slice(0,r.length)==r){var c=Ur(e.F.slice(r.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=$t(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=$t(e.l.Tooltip))),t["!merges"])for(var h=t["!merges"],u=0;u!=h.length;++u)h[u].s.c!=o.c||h[u].s.r!=o.r||(h[u].e.c>h[u].s.c&&(l["ss:MergeAcross"]=h[u].e.c-h[u].s.c),h[u].e.r>h[u].s.r&&(l["ss:MergeDown"]=h[u].e.r-h[u].s.r));var g="",m="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":g="Number",m=String(e.v);break;case"b":g="Boolean",m=e.v?"1":"0";break;case"e":g="Error",m=zo[e.v];break;case"d":g="DateTime",m=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||mr[14]);break;case"s":g="String",m=Dm(e.v||"");break}var d=bi(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+d),l["ss:Index"]=o.c+1;var y=e.v!=null?m:"",x=e.t=="z"?"":'<Data ss:Type="'+g+'">'+y+"</Data>";return(e.c||[]).length>0&&(x+=P4(e.c)),Ye("Cell",x,l)}function I4(e,r){var t='<Row ss:Index="'+(e+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=Pd(r.hpt)),r.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(t+=' ss:Hidden="1"')),t+">"}function D4(e,r,t,n){if(!e["!ref"])return"";var a=or(e["!ref"]),i=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(b,N){cf(b);var w=!!b.width,A=bc(N,b),E={"ss:Index":N+1};w&&(E["ss:Width"]=sc(A.width)),b.hidden&&(E["ss:Hidden"]="1"),l.push(Ye("Column",null,E))});for(var c=Array.isArray(e),h=a.s.r;h<=a.e.r;++h){for(var u=[I4(h,(e["!rows"]||[])[h])],g=a.s.c;g<=a.e.c;++g){var m=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>g)&&!(i[o].s.r>h)&&!(i[o].e.c<g)&&!(i[o].e.r<h)){(i[o].s.c!=g||i[o].s.r!=h)&&(m=!0);break}if(!m){var d={r:h,c:g},y=Yt(d),x=c?(e[h]||[])[g]:e[y];u.push(O4(x,y,e,r,t,n,d))}}u.push("</Row>"),u.length>2&&l.push(u.join(""))}return l.join("")}function R4(e,r,t){var n=[],a=t.SheetNames[e],i=t.Sheets[a],o=i?L4(i,r,e,t):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=i?D4(i,r,e,t):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(C4(i,r,e,t)),n.join("")}function M4(e,r){r||(r={}),e.SSF||(e.SSF=Nn(mr)),e.SSF&&(gc(),mc(e.SSF),r.revssf=xc(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF,r.cellXfs=[],bi(r.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(T4(e,r)),t.push(k4()),t.push(""),t.push("");for(var n=0;n<e.SheetNames.length;++n)t.push(Ye("Worksheet",R4(n,r,e),{"ss:Name":$t(e.SheetNames[n])}));return t[2]=E4(e,r),t[3]=F4(e),Er+Ye("Workbook",t.join(""),{xmlns:Pn.ss,"xmlns:o":Pn.o,"xmlns:x":Pn.x,"xmlns:ss":Pn.ss,"xmlns:dt":Pn.dt,"xmlns:html":Pn.html})}var w0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function B4(e,r){var t=[],n=[],a=[],i=0,o,l=Sh(Dh,"n"),c=Sh(Rh,"n");if(e.Props)for(o=Xr(e.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(l,o[i])?t:Object.prototype.hasOwnProperty.call(c,o[i])?n:a).push([o[i],e.Props[o[i]]]);if(e.Custprops)for(o=Xr(e.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(l,o[i])?t:Object.prototype.hasOwnProperty.call(c,o[i])?n:a).push([o[i],e.Custprops[o[i]]]);var h=[];for(i=0;i<a.length;++i)Sd.indexOf(a[i][0])>-1||wd.indexOf(a[i][0])>-1||a[i][1]!=null&&h.push(a[i]);n.length&&Jt.utils.cfb_add(r,"/SummaryInformation",Wh(n,w0.SI,c,Rh)),(t.length||h.length)&&Jt.utils.cfb_add(r,"/DocumentSummaryInformation",Wh(t,w0.DSI,l,Dh,h.length?h:null,w0.UDI))}function U4(e,r){var t=r||{},n=Jt.utils.cfb_new({root:"R"}),a="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":a="/Workbook",t.biff=8;break;case"biff5":a="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Jt.utils.cfb_add(n,a,e1(e,t)),t.biff==8&&(e.Props||e.Custprops)&&B4(e,n),t.biff==8&&e.vbaraw&&a5(n,Jt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var H4={0:{f:zv},1:{f:Zv},2:{f:vy},3:{f:sy},4:{f:ry},5:{f:py},6:{f:Sy},7:{f:fy},8:{f:Fy},9:{f:Ey},10:{f:Ty},11:{f:ky},12:{f:ey},13:{f:wy},14:{f:ly},15:{f:ay},16:{f:gy},17:{f:Ay},18:{f:uy},19:{f:af},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:m4},40:{},42:{},43:{f:Sx},44:{f:bx},45:{f:jx},46:{f:kx},47:{f:Tx},48:{},49:{f:eg},50:{},51:{f:zx},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:tx},62:{f:Ny},63:{f:Kx},64:{f:Gy},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ta,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Wy},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Kv},148:{f:$v,p:16},151:{f:Dy},152:{},153:{f:d4},154:{},155:{},156:{f:h4},157:{},158:{},159:{T:1,f:hx},160:{T:-1},161:{T:1,f:Yi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Ly},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Wx},336:{T:-1},337:{f:$x,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:H0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Xg},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Ry},427:{f:My},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Uy},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Xv},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Oy},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:H0},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:t5},633:{T:1},634:{T:-1},635:{T:1,f:Qx},636:{T:-1},637:{f:ag},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:i4},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:$y},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Xe(e,r,t,n){var a=r;if(!isNaN(a)){var i=n||(t||[]).length||0,o=e.next(4);o.write_shift(2,a),o.write_shift(2,i),i>0&&tf(t)&&e.push(t)}}function W4(e,r,t,n){var a=(t||[]).length||0;if(a<=8224)return Xe(e,r,t,a);var i=r;if(!isNaN(i)){for(var o=t.parts||[],l=0,c=0,h=0;h+(o[l]||8224)<=8224;)h+=o[l]||8224,l++;var u=e.next(4);for(u.write_shift(2,i),u.write_shift(2,h),e.push(t.slice(c,c+h)),c+=h;c<a;){for(u=e.next(4),u.write_shift(2,60),h=0;h+(o[l]||8224)<=8224;)h+=o[l]||8224,l++;u.write_shift(2,h),e.push(t.slice(c,c+h)),c+=h}}}function Go(e,r,t){return e||(e=Ce(7)),e.write_shift(2,r),e.write_shift(2,t),e.write_shift(2,0),e.write_shift(1,0),e}function q4(e,r,t,n){var a=Ce(9);return Go(a,e,r),Ad(t,n||"b",a),a}function z4(e,r,t){var n=Ce(8+2*t.length);return Go(n,e,r),n.write_shift(1,t.length),n.write_shift(t.length,t,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function V4(e,r,t,n){if(r.v!=null)switch(r.t){case"d":case"n":var a=r.t=="d"?bn(un(r.v)):r.v;a==(a|0)&&a>=0&&a<65536?Xe(e,2,ix(t,n,a)):Xe(e,3,ax(t,n,a));return;case"b":case"e":Xe(e,5,q4(t,n,r.v,r.t));return;case"s":case"str":Xe(e,4,z4(t,n,(r.v||"").slice(0,255)));return}Xe(e,1,Go(null,t,n))}function G4(e,r,t,n){var a=Array.isArray(r),i=or(r["!ref"]||"A1"),o,l="",c=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=kr(i)}for(var h=i.s.r;h<=i.e.r;++h){l=Yr(h);for(var u=i.s.c;u<=i.e.c;++u){h===i.s.r&&(c[u]=an(u)),o=c[u]+l;var g=a?(r[h]||[])[u]:r[o];g&&V4(e,g,h,u)}}}function $4(e,r){for(var t=r||{},n=wn(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==t.sheet&&(a=i);if(a==0&&t.sheet&&e.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return Xe(n,t.biff==4?1033:t.biff==3?521:9,lf(e,16,t)),G4(n,e.Sheets[e.SheetNames[a]],a,t),Xe(n,10),n.end()}function Y4(e,r,t){Xe(e,49,Hg({sz:12,name:"Arial"},t))}function X4(e,r,t){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)r[a]!=null&&Xe(e,1054,zg(a,r[a],t))})}function K4(e,r){var t=Ce(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),Xe(e,2151,t),t=Ce(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),kd(or(r["!ref"]||"A1"),t),t.write_shift(4,4),Xe(e,2152,t)}function J4(e,r){for(var t=0;t<16;++t)Xe(e,224,zh({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(n){Xe(e,224,zh(n,0,r))})}function Z4(e,r){for(var t=0;t<r["!links"].length;++t){var n=r["!links"][t];Xe(e,440,Zg(n)),n[1].Tooltip&&Xe(e,2048,Qg(n))}delete r["!links"]}function Q4(e,r){if(r){var t=0;r.forEach(function(n,a){++t<=256&&n&&Xe(e,125,rx(bc(a,n),a))})}}function ew(e,r,t,n,a){var i=16+bi(a.cellXfs,r,a);if(r.v==null&&!r.bf){Xe(e,513,Wi(t,n,i));return}if(r.bf)Xe(e,6,_v(r,t,n,a,i));else switch(r.t){case"d":case"n":var o=r.t=="d"?bn(un(r.v)):r.v;Xe(e,515,Yg(t,n,o,i));break;case"b":case"e":Xe(e,517,$g(t,n,r.v,i,a,r.t));break;case"s":case"str":if(a.bookSST){var l=df(a.Strings,r.v,a.revStrings);Xe(e,253,Wg(t,n,l,i))}else Xe(e,516,qg(t,n,(r.v||"").slice(0,255),i,a));break;default:Xe(e,513,Wi(t,n,i))}}function tw(e,r,t){var n=wn(),a=t.SheetNames[e],i=t.Sheets[a]||{},o=(t||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(i),h=r.biff==8,u,g="",m=[],d=or(i["!ref"]||"A1"),y=h?65536:16384;if(d.e.c>255||d.e.r>=y){if(r.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,y-1)}Xe(n,2057,lf(t,16,r)),Xe(n,13,Xn(1)),Xe(n,12,Xn(100)),Xe(n,15,hn(!0)),Xe(n,17,hn(!1)),Xe(n,16,Hi(.001)),Xe(n,95,hn(!0)),Xe(n,42,hn(!1)),Xe(n,43,hn(!1)),Xe(n,130,Xn(1)),Xe(n,128,Gg()),Xe(n,131,hn(!1)),Xe(n,132,hn(!1)),h&&Q4(n,i["!cols"]),Xe(n,512,Vg(d,r)),h&&(i["!links"]=[]);for(var x=d.s.r;x<=d.e.r;++x){g=Yr(x);for(var b=d.s.c;b<=d.e.c;++b){x===d.s.r&&(m[b]=an(b)),u=m[b]+g;var N=c?(i[x]||[])[b]:i[u];N&&(ew(n,N,x,b,r),h&&N.l&&i["!links"].push([u,N.l]))}}var w=l.CodeName||l.name||a;return h&&Xe(n,574,Ug((o.Views||[])[0])),h&&(i["!merges"]||[]).length&&Xe(n,229,Jg(i["!merges"])),h&&Z4(n,i),Xe(n,442,Td(w)),h&&K4(n,i),Xe(n,10),n.end()}function rw(e,r,t){var n=wn(),a=(e||{}).Workbook||{},i=a.Sheets||[],o=a.WBProps||{},l=t.biff==8,c=t.biff==5;if(Xe(n,2057,lf(e,5,t)),t.bookType=="xla"&&Xe(n,135),Xe(n,225,l?Xn(1200):null),Xe(n,193,Tg(2)),c&&Xe(n,191),c&&Xe(n,192),Xe(n,226),Xe(n,92,Dg("SheetJS",t)),Xe(n,66,Xn(l?1200:1252)),l&&Xe(n,353,Xn(0)),l&&Xe(n,448),Xe(n,317,nx(e.SheetNames.length)),l&&e.vbaraw&&Xe(n,211),l&&e.vbaraw){var h=o.CodeName||"ThisWorkbook";Xe(n,442,Td(h))}Xe(n,156,Xn(17)),Xe(n,25,hn(!1)),Xe(n,18,hn(!1)),Xe(n,19,Xn(0)),l&&Xe(n,431,hn(!1)),l&&Xe(n,444,Xn(0)),Xe(n,61,Bg()),Xe(n,64,hn(!1)),Xe(n,141,Xn(0)),Xe(n,34,hn(o4(e)=="true")),Xe(n,14,hn(!0)),l&&Xe(n,439,hn(!1)),Xe(n,218,Xn(0)),Y4(n,e,t),X4(n,e.SSF,t),J4(n,t),l&&Xe(n,352,hn(!1));var u=n.end(),g=wn();l&&Xe(g,140,ex()),l&&t.Strings&&W4(g,252,Mg(t.Strings)),Xe(g,10);var m=g.end(),d=wn(),y=0,x=0;for(x=0;x<e.SheetNames.length;++x)y+=(l?12:11)+(l?2:1)*e.SheetNames[x].length;var b=u.length+y+m.length;for(x=0;x<e.SheetNames.length;++x){var N=i[x]||{};Xe(d,133,Rg({pos:b,hs:N.Hidden||0,dt:0,name:e.SheetNames[x]},t)),b+=r[x].length}var w=d.end();if(y!=w.length)throw new Error("BS8 "+y+" != "+w.length);var A=[];return u.length&&A.push(u),w.length&&A.push(w),m.length&&A.push(m),Gr(A)}function nw(e,r){var t=r||{},n=[];e&&!e.SSF&&(e.SSF=Nn(mr)),e&&e.SSF&&(gc(),mc(e.SSF),t.revssf=xc(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,pf(t),t.cellXfs=[],bi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=tw(a,t,e);return n.unshift(rw(e,n,t)),Gr(n)}function e1(e,r){for(var t=0;t<=e.SheetNames.length;++t){var n=e.Sheets[e.SheetNames[t]];if(!(!n||!n["!ref"])){var a=Dn(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var i=r||{};switch(i.biff||2){case 8:case 5:return nw(e,r);case 4:case 3:case 2:return $4(e,r)}throw new Error("invalid type "+i.bookType+" for BIFF")}function aw(e,r,t,n){for(var a=e["!merges"]||[],i=[],o=r.s.c;o<=r.e.c;++o){for(var l=0,c=0,h=0;h<a.length;++h)if(!(a[h].s.r>t||a[h].s.c>o)&&!(a[h].e.r<t||a[h].e.c<o)){if(a[h].s.r<t||a[h].s.c<o){l=-1;break}l=a[h].e.r-a[h].s.r+1,c=a[h].e.c-a[h].s.c+1;break}if(!(l<0)){var u=Yt({r:t,c:o}),g=n.dense?(e[t]||[])[o]:e[u],m=g&&g.v!=null&&(g.h||Im(g.w||(Va(g),g.w)||""))||"",d={};l>1&&(d.rowspan=l),c>1&&(d.colspan=c),n.editable?m='<span contenteditable="true">'+m+"</span>":g&&(d["data-t"]=g&&g.t||"z",g.v!=null&&(d["data-v"]=g.v),g.z!=null&&(d["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+g.l.Target+'">'+m+"</a>")),d.id=(n.id||"sjs")+"-"+u,i.push(Ye("td",m,d))}}var y="<tr>";return y+i.join("")+"</tr>"}var iw='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',sw="</body></html>";function ow(e,r,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function t1(e,r){var t=r||{},n=t.header!=null?t.header:iw,a=t.footer!=null?t.footer:sw,i=[n],o=Dn(e["!ref"]);t.dense=Array.isArray(e),i.push(ow(e,o,t));for(var l=o.s.r;l<=o.e.r;++l)i.push(aw(e,o,l,t));return i.push("</table>"+a),i.join("")}function r1(e,r,t){var n=t||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var o=typeof n.origin=="string"?Ur(n.origin):n.origin;a=o.r,i=o.c}var l=r.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),h={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var u=Dn(e["!ref"]);h.s.r=Math.min(h.s.r,u.s.r),h.s.c=Math.min(h.s.c,u.s.c),h.e.r=Math.max(h.e.r,u.e.r),h.e.c=Math.max(h.e.c,u.e.c),a==-1&&(h.e.r=a=u.e.r+1)}var g=[],m=0,d=e["!rows"]||(e["!rows"]=[]),y=0,x=0,b=0,N=0,w=0,A=0;for(e["!cols"]||(e["!cols"]=[]);y<l.length&&x<c;++y){var E=l[y];if(Jh(E)){if(n.display)continue;d[x]={hidden:!0}}var W=E.children;for(b=N=0;b<W.length;++b){var V=W[b];if(!(n.display&&Jh(V))){var F=V.hasAttribute("data-v")?V.getAttribute("data-v"):V.hasAttribute("v")?V.getAttribute("v"):Bm(V.innerHTML),C=V.getAttribute("data-z")||V.getAttribute("z");for(m=0;m<g.length;++m){var R=g[m];R.s.c==N+i&&R.s.r<x+a&&x+a<=R.e.r&&(N=R.e.c+1-i,m=-1)}A=+V.getAttribute("colspan")||1,((w=+V.getAttribute("rowspan")||1)>1||A>1)&&g.push({s:{r:x+a,c:N+i},e:{r:x+a+(w||1)-1,c:N+i+(A||1)-1}});var G={t:"s",v:F},j=V.getAttribute("data-t")||V.getAttribute("t")||"";F!=null&&(F.length==0?G.t=j||"z":n.raw||F.trim().length==0||j=="s"||(F==="TRUE"?G={t:"b",v:!0}:F==="FALSE"?G={t:"b",v:!1}:isNaN(Wa(F))?isNaN(Io(F).getDate())||(G={t:"d",v:un(F)},n.cellDates||(G={t:"n",v:bn(G.v)}),G.z=n.dateNF||mr[14]):G={t:"n",v:Wa(F)})),G.z===void 0&&C!=null&&(G.z=C);var T="",B=V.getElementsByTagName("A");if(B&&B.length)for(var M=0;M<B.length&&!(B[M].hasAttribute("href")&&(T=B[M].getAttribute("href"),T.charAt(0)!="#"));++M);T&&T.charAt(0)!="#"&&(G.l={Target:T}),n.dense?(e[x+a]||(e[x+a]=[]),e[x+a][N+i]=G):e[Yt({c:N+i,r:x+a})]=G,h.e.c<N+i&&(h.e.c=N+i),N+=A}}++x}return g.length&&(e["!merges"]=(e["!merges"]||[]).concat(g)),h.e.r=Math.max(h.e.r,x-1+a),e["!ref"]=kr(h),x>=c&&(e["!fullref"]=kr((h.e.r=l.length-y+x-1+a,h))),e}function n1(e,r){var t=r||{},n=t.dense?[]:{};return r1(n,e,r)}function lw(e,r){return zi(n1(e,r),r)}function Jh(e){var r="",t=cw(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function cw(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var fw=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+Ro({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Er+r}}(),Zh=function(){var e=function(i){return $t(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,n=function(i,o,l){var c=[];c.push('      <table:table table:name="'+$t(o.SheetNames[l])+`" table:style-name="ta1">
`);var h=0,u=0,g=Dn(i["!ref"]||"A1"),m=i["!merges"]||[],d=0,y=Array.isArray(i);if(i["!cols"])for(u=0;u<=g.e.c;++u)c.push("        <table:table-column"+(i["!cols"][u]?' table:style-name="co'+i["!cols"][u].ods+'"':"")+`></table:table-column>
`);var x="",b=i["!rows"]||[];for(h=0;h<g.s.r;++h)x=b[h]?' table:style-name="ro'+b[h].ods+'"':"",c.push("        <table:table-row"+x+`></table:table-row>
`);for(;h<=g.e.r;++h){for(x=b[h]?' table:style-name="ro'+b[h].ods+'"':"",c.push("        <table:table-row"+x+`>
`),u=0;u<g.s.c;++u)c.push(r);for(;u<=g.e.c;++u){var N=!1,w={},A="";for(d=0;d!=m.length;++d)if(!(m[d].s.c>u)&&!(m[d].s.r>h)&&!(m[d].e.c<u)&&!(m[d].e.r<h)){(m[d].s.c!=u||m[d].s.r!=h)&&(N=!0),w["table:number-columns-spanned"]=m[d].e.c-m[d].s.c+1,w["table:number-rows-spanned"]=m[d].e.r-m[d].s.r+1;break}if(N){c.push(t);continue}var E=Yt({r:h,c:u}),W=y?(i[h]||[])[u]:i[E];if(W&&W.f&&(w["table:formula"]=$t(Fv(W.f)),W.F&&W.F.slice(0,E.length)==E)){var V=Dn(W.F);w["table:number-matrix-columns-spanned"]=V.e.c-V.s.c+1,w["table:number-matrix-rows-spanned"]=V.e.r-V.s.r+1}if(!W){c.push(r);continue}switch(W.t){case"b":A=W.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=W.v?"true":"false";break;case"n":A=W.w||String(W.v||0),w["office:value-type"]="float",w["office:value"]=W.v||0;break;case"s":case"str":A=W.v==null?"":W.v,w["office:value-type"]="string";break;case"d":A=W.w||un(W.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=un(W.v).toISOString(),w["table:style-name"]="ce1";break;default:c.push(r);continue}var F=e(A);if(W.l&&W.l.Target){var C=W.l.Target;C=C.charAt(0)=="#"?"#"+Lv(C.slice(1)):C,C.charAt(0)!="#"&&!C.match(/^\w+:/)&&(C="../"+C),F=Ye("text:a",F,{"xlink:href":C.replace(/&/g,"&amp;")})}c.push("          "+Ye("table:table-cell",Ye("text:p",F,{}),w)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(h){return o.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var u=0;u<h["!cols"].length;++u)if(h["!cols"][u]){var g=h["!cols"][u];if(g.width==null&&g.wpx==null&&g.wch==null)continue;cf(g),g.ods=l;var m=h["!cols"][u].wpx+"px";i.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),i.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(h){return o.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var u=0;u<h["!rows"].length;++u)if(h["!rows"][u]){h["!rows"][u].ods=c;var g=h["!rows"][u].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+g+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,l){var c=[Er],h=Ro({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Ro({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+h+u+`>
`),c.push(vd().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+h+`>
`),a(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var g=0;g!=o.SheetNames.length;++g)c.push(n(o.Sheets[o.SheetNames[g]],o,g));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function a1(e,r){if(r.bookType=="fods")return Zh(e,r);var t=J0(),n="",a=[],i=[];return n="mimetype",Tt(t,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Tt(t,n,Zh(e,r)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",Tt(t,n,fw(e,r)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",Tt(t,n,Er+vd()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",Tt(t,n,Ng(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Tt(t,n,wg(a)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function cc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function hw(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):fa(Do(e))}function uw(e,r){e:for(var t=0;t<=e.length-r.length;++t){for(var n=0;n<r.length;++n)if(e[t+n]!=r[n])continue e;return!0}return!1}function wi(e){var r=e.reduce(function(a,i){return a+i.length},0),t=new Uint8Array(r),n=0;return e.forEach(function(a){t.set(a,n),n+=a.length}),t}function dw(e,r,t){var n=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,a=t/Math.pow(10,n-6176);e[r+15]|=n>>7,e[r+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[r+i]=a&255;e[r+15]|=t>=0?0:128}function Mo(e,r){var t=r?r[0]:0,n=e[t]&127;e:if(e[t++]>=128&&(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),n}function Vt(e){var r=new Uint8Array(7);r[0]=e&127;var t=1;e:if(e>127){if(r[t-1]|=128,r[t]=e>>7&127,++t,e<=16383||(r[t-1]|=128,r[t]=e>>14&127,++t,e<=2097151)||(r[t-1]|=128,r[t]=e>>21&127,++t,e<=268435455)||(r[t-1]|=128,r[t]=e/256>>>21&127,++t,e<=34359738367)||(r[t-1]|=128,r[t]=e/65536>>>21&127,++t,e<=4398046511103))break e;r[t-1]|=128,r[t]=e/16777216>>>21&127,++t}return r.slice(0,t)}function Fs(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function Pr(e){for(var r=[],t=[0];t[0]<e.length;){var n=t[0],a=Mo(e,t),i=a&7;a=Math.floor(a/8);var o=0,l;if(a==0)break;switch(i){case 0:{for(var c=t[0];e[t[0]++]>=128;);l=e.slice(c,t[0])}break;case 5:o=4,l=e.slice(t[0],t[0]+o),t[0]+=o;break;case 1:o=8,l=e.slice(t[0],t[0]+o),t[0]+=o;break;case 2:o=Mo(e,t),l=e.slice(t[0],t[0]+o),t[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var h={data:l,type:i};r[a]==null?r[a]=[h]:r[a].push(h)}return r}function zr(e){var r=[];return e.forEach(function(t,n){t.forEach(function(a){a.data&&(r.push(Vt(n*8+a.type)),a.type==2&&r.push(Vt(a.data.length)),r.push(a.data))})}),wi(r)}function oa(e){for(var r,t=[],n=[0];n[0]<e.length;){var a=Mo(e,n),i=Pr(e.slice(n[0],n[0]+a));n[0]+=a;var o={id:Fs(i[1][0].data),messages:[]};i[2].forEach(function(l){var c=Pr(l.data),h=Fs(c[3][0].data);o.messages.push({meta:c,data:e.slice(n[0],n[0]+h)}),n[0]+=h}),(r=i[3])!=null&&r[0]&&(o.merge=Fs(i[3][0].data)>>>0>0),t.push(o)}return t}function ws(e){var r=[];return e.forEach(function(t){var n=[];n[1]=[{data:Vt(t.id),type:0}],n[2]=[],t.merge!=null&&(n[3]=[{data:Vt(+!!t.merge),type:0}]);var a=[];t.messages.forEach(function(o){a.push(o.data),o.meta[3]=[{type:0,data:Vt(o.data.length)}],n[2].push({data:zr(o.meta),type:2})});var i=zr(n);r.push(Vt(i.length)),r.push(i),a.forEach(function(o){return r.push(o)})}),wi(r)}function pw(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],n=Mo(r,t),a=[];t[0]<r.length;){var i=r[t[0]]&3;if(i==0){var o=r[t[0]++]>>2;if(o<60)++o;else{var l=o-59;o=r[t[0]],l>1&&(o|=r[t[0]+1]<<8),l>2&&(o|=r[t[0]+2]<<16),l>3&&(o|=r[t[0]+3]<<24),o>>>=0,o++,t[0]+=l}a.push(r.slice(t[0],t[0]+o)),t[0]+=o;continue}else{var c=0,h=0;if(i==1?(h=(r[t[0]]>>2&7)+4,c=(r[t[0]++]&224)<<3,c|=r[t[0]++]):(h=(r[t[0]++]>>2)+1,i==2?(c=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(c=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),a=[wi(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(h>=c)for(a.push(a[0].slice(-c)),h-=c;h>=a[a.length-1].length;)a.push(a[a.length-1]),h-=a[a.length-1].length;a.push(a[0].slice(-c,-c+h))}}var u=wi(a);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function la(e){for(var r=[],t=0;t<e.length;){var n=e[t++],a=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(pw(n,e.slice(t,t+a))),t+=a}if(t!==e.length)throw new Error("data is not a valid framed stream!");return wi(r)}function bs(e){for(var r=[],t=0;t<e.length;){var n=Math.min(e.length-t,268435455),a=new Uint8Array(4);r.push(a);var i=Vt(n),o=i.length;r.push(i),n<=60?(o++,r.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,r.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,r.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,r.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,r.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),r.push(e.slice(t,t+n)),o+=n,a[0]=0,a[1]=o&255,a[2]=o>>8&255,a[3]=o>>16&255,t+=n}return wi(r)}function b0(e,r){var t=new Uint8Array(32),n=cc(t),a=12,i=0;switch(t[0]=5,e.t){case"n":t[1]=2,dw(t,a,e.v),i|=1,a+=16;break;case"b":t[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[1]=3,n.setUint32(a,r.indexOf(e.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),t.slice(0,a)}function N0(e,r){var t=new Uint8Array(32),n=cc(t),a=12,i=0;switch(t[0]=3,e.t){case"n":t[2]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":t[2]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[2]=3,n.setUint32(a,r.indexOf(e.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),t.slice(0,a)}function fi(e){var r=Pr(e);return Mo(r[1][0].data)}function mw(e,r,t){var n,a,i,o;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(i=e[8])==null?void 0:i[0])==null?void 0:o.data)&&Fs(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,h=cc(e[7][0].data),u=0,g=[],m=cc(e[4][0].data),d=0,y=[],x=0;x<r.length;++x){if(r[x]==null){h.setUint16(x*2,65535,!0),m.setUint16(x*2,65535);continue}h.setUint16(x*2,u,!0),m.setUint16(x*2,d,!0);var b,N;switch(typeof r[x]){case"string":b=b0({t:"s",v:r[x]},t),N=N0({t:"s",v:r[x]},t);break;case"number":b=b0({t:"n",v:r[x]},t),N=N0({t:"n",v:r[x]},t);break;case"boolean":b=b0({t:"b",v:r[x]},t),N=N0({t:"b",v:r[x]},t);break;default:throw new Error("Unsupported value "+r[x])}g.push(b),u+=b.length,y.push(N),d+=N.length,++c}for(e[2][0].data=Vt(c);x<e[7][0].data.length/2;++x)h.setUint16(x*2,65535,!0),m.setUint16(x*2,65535,!0);return e[6][0].data=wi(g),e[3][0].data=wi(y),c}function gw(e,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Dn(t["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(kr(n)));var i=fc(t,{range:n,header:1}),o=["~Sh33tJ5~"];i.forEach(function(L){return L.forEach(function(P){typeof P=="string"&&o.push(P)})});var l={},c=[],h=Jt.read(r.numbers,{type:"base64"});h.FileIndex.map(function(L,P){return[L,h.FullPaths[P]]}).forEach(function(L){var P=L[0],O=L[1];if(P.type==2&&P.name.match(/\.iwa/)){var X=P.content,ce=la(X),fe=oa(ce);fe.forEach(function(he){c.push(he.id),l[he.id]={deps:[],location:O,type:Fs(he.messages[0].meta[1][0].data)}})}}),c.sort(function(L,P){return L-P});var u=c.filter(function(L){return L>1}).map(function(L){return[L,Vt(L)]});h.FileIndex.map(function(L,P){return[L,h.FullPaths[P]]}).forEach(function(L){var P=L[0];if(L[1],!!P.name.match(/\.iwa/)){var O=oa(la(P.content));O.forEach(function(X){X.messages.forEach(function(ce){u.forEach(function(fe){X.messages.some(function(he){return Fs(he.meta[1][0].data)!=11006&&uw(he.data,fe[1])})&&l[fe[0]].deps.push(X.id)})})})}});for(var g=Jt.find(h,l[1].location),m=oa(la(g.content)),d,y=0;y<m.length;++y){var x=m[y];x.id==1&&(d=x)}var b=fi(Pr(d.messages[0].data)[1][0].data);for(g=Jt.find(h,l[b].location),m=oa(la(g.content)),y=0;y<m.length;++y)x=m[y],x.id==b&&(d=x);for(b=fi(Pr(d.messages[0].data)[2][0].data),g=Jt.find(h,l[b].location),m=oa(la(g.content)),y=0;y<m.length;++y)x=m[y],x.id==b&&(d=x);for(b=fi(Pr(d.messages[0].data)[2][0].data),g=Jt.find(h,l[b].location),m=oa(la(g.content)),y=0;y<m.length;++y)x=m[y],x.id==b&&(d=x);var N=Pr(d.messages[0].data);{N[6][0].data=Vt(n.e.r+1),N[7][0].data=Vt(n.e.c+1);var w=fi(N[46][0].data),A=Jt.find(h,l[w].location),E=oa(la(A.content));{for(var W=0;W<E.length&&E[W].id!=w;++W);if(E[W].id!=w)throw"Bad ColumnRowUIDMapArchive";var V=Pr(E[W].messages[0].data);V[1]=[],V[2]=[],V[3]=[];for(var F=0;F<=n.e.c;++F){var C=[];C[1]=C[2]=[{type:0,data:Vt(F+420690)}],V[1].push({type:2,data:zr(C)}),V[2].push({type:0,data:Vt(F)}),V[3].push({type:0,data:Vt(F)})}V[4]=[],V[5]=[],V[6]=[];for(var R=0;R<=n.e.r;++R)C=[],C[1]=C[2]=[{type:0,data:Vt(R+726270)}],V[4].push({type:2,data:zr(C)}),V[5].push({type:0,data:Vt(R)}),V[6].push({type:0,data:Vt(R)});E[W].messages[0].data=zr(V)}A.content=bs(ws(E)),A.size=A.content.length,delete N[46];var G=Pr(N[4][0].data);{G[7][0].data=Vt(n.e.r+1);var j=Pr(G[1][0].data),T=fi(j[2][0].data);A=Jt.find(h,l[T].location),E=oa(la(A.content));{if(E[0].id!=T)throw"Bad HeaderStorageBucket";var B=Pr(E[0].messages[0].data);for(R=0;R<i.length;++R){var M=Pr(B[2][0].data);M[1][0].data=Vt(R),M[4][0].data=Vt(i[R].length),B[2][R]={type:B[2][0].type,data:zr(M)}}E[0].messages[0].data=zr(B)}A.content=bs(ws(E)),A.size=A.content.length;var le=fi(G[2][0].data);A=Jt.find(h,l[le].location),E=oa(la(A.content));{if(E[0].id!=le)throw"Bad HeaderStorageBucket";for(B=Pr(E[0].messages[0].data),F=0;F<=n.e.c;++F)M=Pr(B[2][0].data),M[1][0].data=Vt(F),M[4][0].data=Vt(n.e.r+1),B[2][F]={type:B[2][0].type,data:zr(M)};E[0].messages[0].data=zr(B)}A.content=bs(ws(E)),A.size=A.content.length;var J=fi(G[4][0].data);(function(){for(var L=Jt.find(h,l[J].location),P=oa(la(L.content)),O,X=0;X<P.length;++X){var ce=P[X];ce.id==J&&(O=ce)}var fe=Pr(O.messages[0].data);{fe[3]=[];var he=[];o.forEach(function(Re,ze){he[1]=[{type:0,data:Vt(ze)}],he[2]=[{type:0,data:Vt(1)}],he[3]=[{type:2,data:hw(Re)}],fe[3].push({type:2,data:zr(he)})})}O.messages[0].data=zr(fe);var we=ws(P),Pe=bs(we);L.content=Pe,L.size=L.content.length})();var z=Pr(G[3][0].data);{var ae=z[1][0];delete z[2];var te=Pr(ae.data);{var de=fi(te[2][0].data);(function(){for(var L=Jt.find(h,l[de].location),P=oa(la(L.content)),O,X=0;X<P.length;++X){var ce=P[X];ce.id==de&&(O=ce)}var fe=Pr(O.messages[0].data);{delete fe[6],delete z[7];var he=new Uint8Array(fe[5][0].data);fe[5]=[];for(var we=0,Pe=0;Pe<=n.e.r;++Pe){var Re=Pr(he);we+=mw(Re,i[Pe],o),Re[1][0].data=Vt(Pe),fe[5].push({data:zr(Re),type:2})}fe[1]=[{type:0,data:Vt(n.e.c+1)}],fe[2]=[{type:0,data:Vt(n.e.r+1)}],fe[3]=[{type:0,data:Vt(we)}],fe[4]=[{type:0,data:Vt(n.e.r+1)}]}O.messages[0].data=zr(fe);var ze=ws(P),Ke=bs(ze);L.content=Ke,L.size=L.content.length})()}ae.data=zr(te)}G[3][0].data=zr(z)}N[4][0].data=zr(G)}d.messages[0].data=zr(N);var xe=ws(m),_=bs(xe);return g.content=_,g.size=g.content.length,h}function xw(e){return function(t){for(var n=0;n!=e.length;++n){var a=e[n];t[a[0]]===void 0&&(t[a[0]]=a[1]),a[2]==="n"&&(t[a[0]]=Number(t[a[0]]))}}}function pf(e){xw([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function vw(e,r){return r.bookType=="ods"?a1(e,r):r.bookType=="numbers"?gw(e,r):r.bookType=="xlsb"?yw(e,r):ww(e,r)}function yw(e,r){js=1024,e&&!e.SSF&&(e.SSF=Nn(mr)),e&&e.SSF&&(gc(),mc(e.SSF),r.revssf=xc(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Eo?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t=r.bookType=="xlsb"?"bin":"xml",n=Ud.indexOf(r.bookType)>-1,a=md();pf(r=r||{});var i=J0(),o="",l=0;if(r.cellXfs=[],bi(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Tt(i,o,yd(e.Props,r)),a.coreprops.push(o),Gt(r.rels,2,o,Rt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&c.push(e.SheetNames[h]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Tt(i,o,bd(e.Props)),a.extprops.push(o),Gt(r.rels,3,o,Rt.EXT_PROPS),e.Custprops!==e.Props&&Xr(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Tt(i,o,Nd(e.Custprops)),a.custprops.push(o),Gt(r.rels,4,o,Rt.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var u={"!id":{}},g=e.Sheets[e.SheetNames[l-1]],m=(g||{})["!type"]||"sheet";switch(m){case"chart":default:o="xl/worksheets/sheet"+l+"."+t,Tt(i,o,N4(l-1,o,r,e,u)),a.sheets.push(o),Gt(r.wbrels,-1,"worksheets/sheet"+l+"."+t,Rt.WS[0])}if(g){var d=g["!comments"],y=!1,x="";d&&d.length>0&&(x="xl/comments"+l+"."+t,Tt(i,x,A4(d,x)),a.comments.push(x),Gt(u,-1,"../comments"+l+"."+t,Rt.CMNT),y=!0),g["!legacy"]&&y&&Tt(i,"xl/drawings/vmlDrawing"+l+".vml",Md(l,g["!comments"])),delete g["!comments"],delete g["!legacy"]}u["!id"].rId1&&Tt(i,xd(o),ks(u))}return r.Strings!=null&&r.Strings.length>0&&(o="xl/sharedStrings."+t,Tt(i,o,_4(r.Strings,o,r)),a.strs.push(o),Gt(r.wbrels,-1,"sharedStrings."+t,Rt.SST)),o="xl/workbook."+t,Tt(i,o,b4(e,o)),a.workbooks.push(o),Gt(r.rels,1,o,Rt.WB),o="xl/theme/theme1.xml",Tt(i,o,Dd(e.Themes,r)),a.themes.push(o),Gt(r.wbrels,-1,"theme/theme1.xml",Rt.THEME),o="xl/styles."+t,Tt(i,o,S4(e,o,r)),a.styles.push(o),Gt(r.wbrels,-1,"styles."+t,Rt.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",Tt(i,o,e.vbaraw),a.vba.push(o),Gt(r.wbrels,-1,"vbaProject.bin",Rt.VBA)),o="xl/metadata."+t,Tt(i,o,j4(o)),a.metadata.push(o),Gt(r.wbrels,-1,"metadata."+t,Rt.XLMETA),Tt(i,"[Content_Types].xml",gd(a,r)),Tt(i,"_rels/.rels",ks(r.rels)),Tt(i,"xl/_rels/workbook."+t+".rels",ks(r.wbrels)),delete r.revssf,delete r.ssf,i}function ww(e,r){js=1024,e&&!e.SSF&&(e.SSF=Nn(mr)),e&&e.SSF&&(gc(),mc(e.SSF),r.revssf=xc(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Eo?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t="xml",n=Ud.indexOf(r.bookType)>-1,a=md();pf(r=r||{});var i=J0(),o="",l=0;if(r.cellXfs=[],bi(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Tt(i,o,yd(e.Props,r)),a.coreprops.push(o),Gt(r.rels,2,o,Rt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&c.push(e.SheetNames[h]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Tt(i,o,bd(e.Props)),a.extprops.push(o),Gt(r.rels,3,o,Rt.EXT_PROPS),e.Custprops!==e.Props&&Xr(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Tt(i,o,Nd(e.Custprops)),a.custprops.push(o),Gt(r.rels,4,o,Rt.CUST_PROPS));var u=["SheetJ5"];for(r.tcid=0,l=1;l<=e.SheetNames.length;++l){var g={"!id":{}},m=e.Sheets[e.SheetNames[l-1]],d=(m||{})["!type"]||"sheet";switch(d){case"chart":default:o="xl/worksheets/sheet"+l+"."+t,Tt(i,o,Xd(l-1,r,e,g)),a.sheets.push(o),Gt(r.wbrels,-1,"worksheets/sheet"+l+"."+t,Rt.WS[0])}if(m){var y=m["!comments"],x=!1,b="";if(y&&y.length>0){var N=!1;y.forEach(function(w){w[1].forEach(function(A){A.T==!0&&(N=!0)})}),N&&(b="xl/threadedComments/threadedComment"+l+"."+t,Tt(i,b,Jx(y,u,r)),a.threadedcomments.push(b),Gt(g,-1,"../threadedComments/threadedComment"+l+"."+t,Rt.TCMNT)),b="xl/comments"+l+"."+t,Tt(i,b,Bd(y)),a.comments.push(b),Gt(g,-1,"../comments"+l+"."+t,Rt.CMNT),x=!0}m["!legacy"]&&x&&Tt(i,"xl/drawings/vmlDrawing"+l+".vml",Md(l,m["!comments"])),delete m["!comments"],delete m["!legacy"]}g["!id"].rId1&&Tt(i,xd(o),ks(g))}return r.Strings!=null&&r.Strings.length>0&&(o="xl/sharedStrings."+t,Tt(i,o,Fd(r.Strings,r)),a.strs.push(o),Gt(r.wbrels,-1,"sharedStrings."+t,Rt.SST)),o="xl/workbook."+t,Tt(i,o,Zd(e)),a.workbooks.push(o),Gt(r.rels,1,o,Rt.WB),o="xl/theme/theme1.xml",Tt(i,o,Dd(e.Themes,r)),a.themes.push(o),Gt(r.wbrels,-1,"theme/theme1.xml",Rt.THEME),o="xl/styles."+t,Tt(i,o,Od(e,r)),a.styles.push(o),Gt(r.wbrels,-1,"styles."+t,Rt.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",Tt(i,o,e.vbaraw),a.vba.push(o),Gt(r.wbrels,-1,"vbaProject.bin",Rt.VBA)),o="xl/metadata."+t,Tt(i,o,Rd()),a.metadata.push(o),Gt(r.wbrels,-1,"metadata."+t,Rt.XLMETA),u.length>1&&(o="xl/persons/person.xml",Tt(i,o,Zx(u)),a.people.push(o),Gt(r.wbrels,-1,"persons/person.xml",Rt.PEOPLE)),Tt(i,"[Content_Types].xml",gd(a,r)),Tt(i,"_rels/.rels",ks(r.rels)),Tt(i,"xl/_rels/workbook."+t+".rels",ks(r.wbrels)),delete r.revssf,delete r.ssf,i}function bw(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=za(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function i1(e,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return Wo(r.file,Jt.write(e,{type:Ut?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return Jt.write(e,r)}function Nw(e,r){var t=Nn(r||{}),n=vw(e,t);return Sw(n,t)}function Sw(e,r){var t={},n=Ut?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(r.compression&&(t.compression="DEFLATE"),r.password)t.type=n;else switch(r.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":t.type=n;break;default:throw new Error("Unrecognized type "+r.type)}var a=e.FullPaths?Jt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!r.compression}):e.generate(t);if(typeof Deno<"u"&&typeof a=="string"){if(r.type=="binary"||r.type=="base64")return a;a=new Uint8Array(pc(a))}return r.password&&typeof encrypt_agile<"u"?i1(encrypt_agile(a,r.password),r):r.type==="file"?Wo(r.file,a):r.type=="string"?Ao(a):a}function _w(e,r){var t=r||{},n=U4(e,t);return i1(n,t)}function _a(e,r,t){t||(t="");var n=t+e;switch(r.type){case"base64":return Oo(Do(n));case"binary":return Do(n);case"string":return e;case"file":return Wo(r.file,n,"utf8");case"buffer":return Ut?Ga(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):_a(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function Aw(e,r){switch(r.type){case"base64":return Oo(e);case"binary":return e;case"string":return e;case"file":return Wo(r.file,e,"binary");case"buffer":return Ut?Ga(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function Gl(e,r){switch(r.type){case"string":case"base64":case"binary":for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return r.type=="base64"?Oo(t):r.type=="string"?Ao(t):t;case"file":return Wo(r.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+r.type)}}function s1(e,r){Qp(),f4(e);var t=Nn(r||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var n=s1(e,t);return t.type="array",pc(n)}var a=0;if(t.sheet&&(typeof t.sheet=="number"?a=t.sheet:a=e.SheetNames.indexOf(t.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return _a(M4(e,t),t);case"slk":case"sylk":return _a(ox.from_sheet(e.Sheets[e.SheetNames[a]],t),t);case"htm":case"html":return _a(t1(e.Sheets[e.SheetNames[a]],t),t);case"txt":return Aw(l1(e.Sheets[e.SheetNames[a]],t),t);case"csv":return _a(mf(e.Sheets[e.SheetNames[a]],t),t,"\uFEFF");case"dif":return _a(lx.from_sheet(e.Sheets[e.SheetNames[a]],t),t);case"dbf":return Gl(sx.from_sheet(e.Sheets[e.SheetNames[a]],t),t);case"prn":return _a(cx.from_sheet(e.Sheets[e.SheetNames[a]],t),t);case"rtf":return _a(gx.from_sheet(e.Sheets[e.SheetNames[a]],t),t);case"eth":return _a(Ed.from_sheet(e.Sheets[e.SheetNames[a]],t),t);case"fods":return _a(a1(e,t),t);case"wk1":return Gl(Vh.sheet_to_wk1(e.Sheets[e.SheetNames[a]],t),t);case"wk3":return Gl(Vh.book_to_wk3(e,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Gl(e1(e,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),_w(e,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Nw(e,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function jw(e){if(!e.bookType){var r={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType=r[e.bookType]||e.bookType}}function o1(e,r,t){var n={};return n.type="file",n.file=r,jw(n),s1(e,n)}function Tw(e,r,t,n,a,i,o,l){var c=Yr(t),h=l.defval,u=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),g=!0,m=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:t,enumerable:!1})}catch{m.__rowNum__=t}else m.__rowNum__=t;if(!o||e[t])for(var d=r.s.c;d<=r.e.c;++d){var y=o?e[t][d]:e[n[d]+c];if(y===void 0||y.t===void 0){if(h===void 0)continue;i[d]!=null&&(m[i[d]]=h);continue}var x=y.v;switch(y.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(i[d]!=null){if(x==null)if(y.t=="e"&&x===null)m[i[d]]=null;else if(h!==void 0)m[i[d]]=h;else if(u&&x===null)m[i[d]]=null;else continue;else m[i[d]]=u&&(y.t!=="n"||y.t==="n"&&l.rawNumbers!==!1)?x:Va(y,x,l);x!=null&&(g=!1)}}return{row:m,isempty:g}}function fc(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},n=0,a=1,i=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},h=r||{},u=h.range!=null?h.range:e["!ref"];switch(h.header===1?n=1:h.header==="A"?n=2:Array.isArray(h.header)?n=3:h.header==null&&(n=0),typeof u){case"string":c=or(u);break;case"number":c=or(e["!ref"]),c.s.r=u;break;default:c=u}n>0&&(a=0);var g=Yr(c.s.r),m=[],d=[],y=0,x=0,b=Array.isArray(e),N=c.s.r,w=0,A={};b&&!e[N]&&(e[N]=[]);var E=h.skipHidden&&e["!cols"]||[],W=h.skipHidden&&e["!rows"]||[];for(w=c.s.c;w<=c.e.c;++w)if(!(E[w]||{}).hidden)switch(m[w]=an(w),t=b?e[N][w]:e[m[w]+g],n){case 1:i[w]=w-c.s.c;break;case 2:i[w]=m[w];break;case 3:i[w]=h.header[w-c.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),l=o=Va(t,null,h),x=A[o]||0,!x)A[o]=1;else{do l=o+"_"+x++;while(A[l]);A[o]=x,A[l]=1}i[w]=l}for(N=c.s.r+a;N<=c.e.r;++N)if(!(W[N]||{}).hidden){var V=Tw(e,c,N,m,n,i,b,h);(V.isempty===!1||(n===1?h.blankrows!==!1:h.blankrows))&&(d[y++]=V.row)}return d.length=y,d}var Qh=/"/g;function kw(e,r,t,n,a,i,o,l){for(var c=!0,h=[],u="",g=Yr(t),m=r.s.c;m<=r.e.c;++m)if(n[m]){var d=l.dense?(e[t]||[])[m]:e[n[m]+g];if(d==null)u="";else if(d.v!=null){c=!1,u=""+(l.rawNumbers&&d.t=="n"?d.v:Va(d,null,l));for(var y=0,x=0;y!==u.length;++y)if((x=u.charCodeAt(y))===a||x===i||x===34||l.forceQuotes){u='"'+u.replace(Qh,'""')+'"';break}u=="ID"&&(u='"ID"')}else d.f!=null&&!d.F?(c=!1,u="="+d.f,u.indexOf(",")>=0&&(u='"'+u.replace(Qh,'""')+'"')):u="";h.push(u)}return l.blankrows===!1&&c?null:h.join(o)}function mf(e,r){var t=[],n=r??{};if(e==null||e["!ref"]==null)return"";var a=or(e["!ref"]),i=n.FS!==void 0?n.FS:",",o=i.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),h=new RegExp((i=="|"?"\\|":i)+"+$"),u="",g=[];n.dense=Array.isArray(e);for(var m=n.skipHidden&&e["!cols"]||[],d=n.skipHidden&&e["!rows"]||[],y=a.s.c;y<=a.e.c;++y)(m[y]||{}).hidden||(g[y]=an(y));for(var x=0,b=a.s.r;b<=a.e.r;++b)(d[b]||{}).hidden||(u=kw(e,a,b,g,o,c,i,n),u!=null&&(n.strip&&(u=u.replace(h,"")),(u||n.blankrows!==!1)&&t.push((x++?l:"")+u)));return delete n.dense,t.join("")}function l1(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=mf(e,r);return t}function Ew(e){var r="",t,n="";if(e==null||e["!ref"]==null)return[];var a=or(e["!ref"]),i="",o=[],l,c=[],h=Array.isArray(e);for(l=a.s.c;l<=a.e.c;++l)o[l]=an(l);for(var u=a.s.r;u<=a.e.r;++u)for(i=Yr(u),l=a.s.c;l<=a.e.c;++l)if(r=o[l]+i,t=h?(e[u]||[])[l]:e[r],n="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;n=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}c[c.length]=r+"="+n}return c}function c1(e,r,t){var n=t||{},a=+!n.skipHeader,i=e||{},o=0,l=0;if(i&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?Ur(n.origin):n.origin;o=c.r,l=c.c}var h,u={s:{c:0,r:0},e:{c:l,r:o+r.length-1+a}};if(i["!ref"]){var g=or(i["!ref"]);u.e.c=Math.max(u.e.c,g.e.c),u.e.r=Math.max(u.e.r,g.e.r),o==-1&&(o=g.e.r+1,u.e.r=o+r.length-1+a)}else o==-1&&(o=0,u.e.r=r.length-1+a);var m=n.header||[],d=0;r.forEach(function(x,b){Xr(x).forEach(function(N){(d=m.indexOf(N))==-1&&(m[d=m.length]=N);var w=x[N],A="z",E="",W=Yt({c:l+d,r:o+b+a});h=Bo(i,W),w&&typeof w=="object"&&!(w instanceof Date)?i[W]=w:(typeof w=="number"?A="n":typeof w=="boolean"?A="b":typeof w=="string"?A="s":w instanceof Date?(A="d",n.cellDates||(A="n",w=bn(w)),E=n.dateNF||mr[14]):w===null&&n.nullError&&(A="e",w=0),h?(h.t=A,h.v=w,delete h.w,delete h.R,E&&(h.z=E)):i[W]=h={t:A,v:w},E&&(h.z=E))})}),u.e.c=Math.max(u.e.c,l+m.length-1);var y=Yr(o);if(a)for(d=0;d<m.length;++d)i[an(d+l)+y]={t:"s",v:m[d]};return i["!ref"]=kr(u),i}function Fw(e,r){return c1(null,e,r)}function Bo(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var n=Ur(r);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?Bo(e,Yt(r)):Bo(e,Yt({r,c:t||0}))}function Lw(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function Cw(){return{SheetNames:[],Sheets:{}}}function Pw(e,r,t,n){var a=1;if(!t)for(;a<=65535&&e.SheetNames.indexOf(t="Sheet"+a)!=-1;++a,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(t)>=0){var i=t.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var o=i&&i[1]||t;for(++a;a<=65535&&e.SheetNames.indexOf(t=o+a)!=-1;++a);}if(Jd(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function Ow(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=Lw(e,r);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[n].Hidden=t}function Iw(e,r){return e.z=r,e}function f1(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function Dw(e,r,t){return f1(e,"#"+r,t)}function Rw(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function Mw(e,r,t,n){for(var a=typeof r!="string"?r:or(r),i=typeof r=="string"?r:kr(r),o=a.s.r;o<=a.e.r;++o)for(var l=a.s.c;l<=a.e.c;++l){var c=Bo(e,o,l);c.t="n",c.F=i,delete c.v,o==a.s.r&&l==a.s.c&&(c.f=t,n&&(c.D=!0))}return e}var lr={encode_col:an,encode_row:Yr,encode_cell:Yt,encode_range:kr,decode_col:nf,decode_row:rf,split_cell:Qm,decode_cell:Ur,decode_range:Dn,format_cell:Va,sheet_add_aoa:cd,sheet_add_json:c1,sheet_add_dom:r1,aoa_to_sheet:Os,json_to_sheet:Fw,table_to_sheet:n1,table_to_book:lw,sheet_to_csv:mf,sheet_to_txt:l1,sheet_to_json:fc,sheet_to_html:t1,sheet_to_formulae:Ew,sheet_to_row_object_array:fc,sheet_get_cell:Bo,book_new:Cw,book_append_sheet:Pw,book_set_sheet_visibility:Ow,cell_set_number_format:Iw,cell_set_hyperlink:f1,cell_set_internal_link:Dw,cell_add_comment:Rw,sheet_set_array_formula:Mw,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const eu=["#4A7C2C","#2D5016","#F97316","#10B981"];function Bw({stats:e,analyticsData:r}){const[t,n]=Te.useState([{startDate:new Date(new Date().setDate(new Date().getDate()-30)),endDate:new Date,key:"selection"}]),a=()=>{const c=new ht;c.setFontSize(20),c.text("Vendor Analytics Report",20,20),c.setFontSize(12),c.text(`Generated on: ${new Date().toLocaleDateString()}`,20,30),c.setFontSize(16),c.text("Summary Statistics",20,45);const h=[["Total Revenue",`Â£${e.totalRevenue.toLocaleString()}`],["Total Orders",e.totalOrders],["Average Order Value",`Â£${(e.totalRevenue/e.totalOrders).toFixed(2)}`],["Active Products",e.activeProducts]];c.autoTable({startY:50,head:[["Metric","Value"]],body:h}),c.addPage(),c.setFontSize(16),c.text("Revenue Analysis",20,20),c.autoTable({startY:25,head:[["Date","Revenue","Orders"]],body:r.map(u=>[u.date,`Â£${u.revenue.toLocaleString()}`,u.orders])}),c.save("vendor-analytics-report.pdf")},i=()=>{const c=lr.book_new(),h=[["Metric","Value"],["Total Revenue",`Â£${e.totalRevenue.toLocaleString()}`],["Total Orders",e.totalOrders],["Average Order Value",`Â£${(e.totalRevenue/e.totalOrders).toFixed(2)}`],["Active Products",e.activeProducts]],u=lr.aoa_to_sheet(h);lr.book_append_sheet(c,u,"Summary");const g=[["Date","Revenue","Orders","Units Sold"],...r.map(d=>[d.date,d.revenue,d.orders,d.units])],m=lr.aoa_to_sheet(g);lr.book_append_sheet(c,m,"Daily Data"),o1(c,"vendor-analytics.xlsx")},l=(()=>{const c=r.length;if(c<2)return null;const h=Array.from({length:c},(N,w)=>w),u=r.map(N=>N.revenue),g=h.reduce((N,w)=>N+w,0),m=u.reduce((N,w)=>N+w,0),d=h.reduce((N,w,A)=>N+w*u[A],0),y=h.reduce((N,w)=>N+w*w,0),x=(c*d-g*m)/(c*y-g*g),b=(m-x*g)/c;return Array.from({length:7},(N,w)=>({date:`Day ${c+w+1}`,forecast:Math.max(0,b+x*(c+w))}))})();return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Custom Date Range"}),s.jsx(J1.DateRangePicker,{onChange:c=>n([c.selection]),moveRangeOnFirstSelection:!1,ranges:t,className:"w-full"})]}),s.jsxs("div",{className:"flex gap-4",children:[s.jsx("button",{onClick:a,className:"px-4 py-2 bg-afri-green text-white rounded-lg hover:bg-afri-green-dark transition-colors",children:"Export as PDF"}),s.jsx("button",{onClick:i,className:"px-4 py-2 bg-afri-green text-white rounded-lg hover:bg-afri-green-dark transition-colors",children:"Export as Excel"})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Revenue Trend"}),s.jsx("div",{className:"h-[300px]",children:s.jsx(xo,{width:"100%",height:"100%",children:s.jsxs(au,{data:r,children:[s.jsx("defs",{children:s.jsxs("linearGradient",{id:"colorRevenue",x1:"0",y1:"0",x2:"0",y2:"1",children:[s.jsx("stop",{offset:"5%",stopColor:"#4A7C2C",stopOpacity:.1}),s.jsx("stop",{offset:"95%",stopColor:"#4A7C2C",stopOpacity:0})]})}),s.jsx($l,{strokeDasharray:"3 3",vertical:!1}),s.jsx(Yl,{dataKey:"date"}),s.jsx(_0,{}),s.jsx(vo,{}),s.jsx(iu,{type:"monotone",dataKey:"revenue",stroke:"#4A7C2C",fill:"url(#colorRevenue)"})]})})})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Sales Distribution"}),s.jsx("div",{className:"h-[300px]",children:s.jsx(xo,{width:"100%",height:"100%",children:s.jsxs(i2,{children:[s.jsx(s2,{data:e.topProducts,dataKey:"totalRevenue",nameKey:"name",cx:"50%",cy:"50%",outerRadius:100,label:!0,children:e.topProducts.map((c,h)=>s.jsx(o2,{fill:eu[h%eu.length]},`cell-${h}`))}),s.jsx(vo,{})]})})})]})]}),l&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Revenue Forecast (Next 7 Days)"}),s.jsx("div",{className:"h-[300px]",children:s.jsx(xo,{width:"100%",height:"100%",children:s.jsxs(su,{data:l,children:[s.jsx($l,{strokeDasharray:"3 3",vertical:!1}),s.jsx(Yl,{dataKey:"date"}),s.jsx(_0,{}),s.jsx(vo,{}),s.jsx(ou,{dataKey:"forecast",fill:"#F97316"})]})})}),s.jsx("p",{className:"text-sm text-gray-500 mt-4",children:"* Forecast based on historical data trends. Actual results may vary."})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[{label:"Average Order Value",value:`Â£${(e.totalRevenue/e.totalOrders).toFixed(2)}`,change:"+5.2%",trend:"up"},{label:"Customer Retention",value:"68%",change:"+2.1%",trend:"up"},{label:"Product Return Rate",value:"2.3%",change:"-0.5%",trend:"down"},{label:"Inventory Turnover",value:"4.2x",change:"+0.3x",trend:"up"}].map(c=>s.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-500",children:c.label}),s.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:c.value}),s.jsxs("p",{className:`text-sm mt-2 ${c.trend==="up"?"text-green-600":"text-red-600"}`,children:[c.change," vs last period"]})]},c.label))})]})}function Uw(){var x,b,N,w,A,E,W,V,F,C,R,G,j,T,B,M,le,J;const[e,r]=Te.useState("overview"),[t,n]=Te.useState(null),[a,i]=Te.useState(null),[o,l]=Te.useState(!0),[c,h]=Te.useState(""),[u,g]=Te.useState("7d"),[m,d]=Te.useState([]);if(Te.useEffect(()=>{(async()=>{try{l(!0),h("");const[ae,te]=await Promise.all([Ir.getDashboardStats(),Ir.getChartData(u)]);if(ae.success&&n(ae.data),te.success&&d(te.data),e==="analytics"){const de=new Date;de.setDate(de.getDate()-30);const xe=new Date,_=await $2.getDetailedAnalytics(de.toISOString().split("T")[0],xe.toISOString().split("T")[0]);_.success&&i(_.data)}}catch(ae){console.error("Dashboard error:",ae);const te=ae.message||"Failed to load dashboard";te.includes("401")||te.includes("Session expired")||te.includes("Unauthorized")?(h("Your session has expired. Please log in again."),setTimeout(()=>{window.location.href="/login"},2e3)):h(te)}finally{l(!1)}})()},[u,e]),o)return s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-afri-green"})});if(c)return s.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded",children:s.jsx("p",{className:"text-red-700",children:c})});const y=[{name:"Today's Sales",value:`Â£${((b=(x=t==null?void 0:t.todayStats)==null?void 0:x.revenue)==null?void 0:b.toLocaleString())||0}`,subtext:`${((N=t==null?void 0:t.todayStats)==null?void 0:N.orders)||0} orders`,icon:"ðŸ’°",color:"from-green-400 to-green-600",link:"/orders"},{name:"Week's Sales",value:`Â£${((A=(w=t==null?void 0:t.weekStats)==null?void 0:w.revenue)==null?void 0:A.toLocaleString())||0}`,subtext:`${((E=t==null?void 0:t.weekStats)==null?void 0:E.orders)||0} orders`,icon:"ðŸ“…",color:"from-blue-400 to-blue-600",link:"/orders"},{name:"Month's Sales",value:`Â£${((W=t==null?void 0:t.monthlyRevenue)==null?void 0:W.toLocaleString())||0}`,subtext:`vs last month ${(t==null?void 0:t.monthlyGrowth)>0?"+":""}${(t==null?void 0:t.monthlyGrowth)||0}%`,icon:"ï¿½",color:"from-indigo-400 to-indigo-600",link:"/orders"},{name:"Total Revenue",value:`Â£${((V=t==null?void 0:t.totalRevenue)==null?void 0:V.toLocaleString())||0}`,subtext:"YTD",icon:"ðŸ†",color:"from-purple-400 to-purple-600",link:"/orders"},{name:"Pending Orders",value:(t==null?void 0:t.pendingOrders)||0,subtext:"Need attention",icon:"â³",color:"from-yellow-400 to-yellow-600",link:"/orders"},{name:"Orders to Ship",value:(t==null?void 0:t.readyToShipOrders)||0,subtext:"Ready for delivery",icon:"ðŸ“¦",color:"from-orange-400 to-orange-600",link:"/orders"},{name:"Total Products",value:(t==null?void 0:t.totalProducts)||0,subtext:`${((F=t==null?void 0:t.lowStockProducts)==null?void 0:F.length)||0} low stock`,icon:"ðŸ·ï¸",color:"from-teal-400 to-teal-600",link:"/products"},{name:"Account Health",value:`${(t==null?void 0:t.accountHealth)||100}/100`,subtext:(t==null?void 0:t.accountHealth)>=90?"âœ¨ Excellent":(t==null?void 0:t.accountHealth)>=70?"ðŸ‘ Good":"âš ï¸ Needs Attention",icon:"ï¿½",color:"from-pink-400 to-pink-600",link:"/settings"}];return s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"border-b border-gray-200",children:s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Welcome back! Here's your store overview."})]}),s.jsxs("div",{className:"flex space-x-4",children:[s.jsx("button",{onClick:()=>r("overview"),className:`px-4 py-2 font-medium rounded-lg transition-colors ${e==="overview"?"bg-afri-green text-white":"text-gray-600 hover:text-afri-green hover:bg-gray-50"}`,children:"Overview"}),s.jsx("button",{onClick:()=>r("analytics"),className:`px-4 py-2 font-medium rounded-lg transition-colors ${e==="analytics"?"bg-afri-green text-white":"text-gray-600 hover:text-afri-green hover:bg-gray-50"}`,children:"Advanced Analytics"})]})]})}),e==="overview"?s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4",children:y.map(z=>s.jsxs(St,{to:z.link,className:"group relative bg-white rounded-xl shadow-sm hover:shadow-lg transition-all duration-200 overflow-hidden transform hover:scale-102",children:[s.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${z.color} opacity-0 group-hover:opacity-5 transition-opacity`}),s.jsx("div",{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:z.name}),s.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:z.value}),z.subtext&&s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:z.subtext})]}),s.jsx("div",{className:"text-4xl",children:z.icon})]})})]},z.name))}),s.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3",children:[s.jsxs("div",{className:"lg:col-span-2 bg-white rounded-xl shadow-sm p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Sales Overview"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Last 7 days performance"})]}),s.jsxs("select",{value:u,onChange:z=>g(z.target.value),className:"bg-gray-50 text-sm border border-gray-200 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-afri-green focus:border-transparent",children:[s.jsx("option",{value:"7d",children:"Last 7 Days"}),s.jsx("option",{value:"30d",children:"Last 30 Days"}),s.jsx("option",{value:"90d",children:"Last 90 Days"})]})]}),s.jsx("div",{className:"h-[300px] bg-white rounded-lg p-4",children:s.jsx(xo,{width:"100%",height:"100%",children:s.jsxs(au,{data:m,margin:{top:10,right:30,left:0,bottom:0},children:[s.jsx("defs",{children:s.jsxs("linearGradient",{id:"colorRevenue",x1:"0",y1:"0",x2:"0",y2:"1",children:[s.jsx("stop",{offset:"5%",stopColor:"#4A7C2C",stopOpacity:.1}),s.jsx("stop",{offset:"95%",stopColor:"#4A7C2C",stopOpacity:0})]})}),s.jsx($l,{strokeDasharray:"3 3",vertical:!1,stroke:"#f0f0f0"}),s.jsx(Yl,{dataKey:"date",tick:{fill:"#6B7280"},axisLine:{stroke:"#E5E7EB"},tickLine:!1}),s.jsx(_0,{tick:{fill:"#6B7280"},axisLine:{stroke:"#E5E7EB"},tickLine:!1,width:80,tickFormatter:z=>`Â£${z}`}),s.jsx(vo,{contentStyle:{backgroundColor:"white",border:"none",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},labelStyle:{color:"#111827",fontWeight:600}}),s.jsx(iu,{type:"monotone",dataKey:"revenue",stroke:"#4A7C2C",fillOpacity:1,fill:"url(#colorRevenue)",strokeWidth:2})]})})}),s.jsx("div",{className:"h-[120px] bg-white rounded-lg mt-4",children:s.jsx(xo,{width:"100%",height:"100%",children:s.jsxs(su,{data:m,margin:{top:10,right:30,left:0,bottom:0},children:[s.jsx($l,{strokeDasharray:"3 3",vertical:!1,stroke:"#f0f0f0"}),s.jsx(Yl,{dataKey:"date",tick:{fill:"#6B7280",fontSize:12},axisLine:{stroke:"#E5E7EB"},tickLine:!1}),s.jsx(vo,{contentStyle:{backgroundColor:"white",border:"none",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},cursor:{fill:"rgba(74, 124, 44, 0.1)"}}),s.jsx(ou,{dataKey:"orders",fill:"#4A7C2C",radius:[4,4,0,0]})]})})}),s.jsx("div",{className:"grid grid-cols-4 gap-4 mt-6",children:[{label:"Today's Orders",value:((C=t==null?void 0:t.todayStats)==null?void 0:C.orders)||0},{label:"Units Sold",value:((R=t==null?void 0:t.todayStats)==null?void 0:R.units)||0},{label:"Revenue",value:`Â£${((j=(G=t==null?void 0:t.todayStats)==null?void 0:G.revenue)==null?void 0:j.toLocaleString())||0}`},{label:"Avg Order Value",value:`Â£${((B=(T=t==null?void 0:t.todayStats)==null?void 0:T.avgOrderValue)==null?void 0:B.toLocaleString())||0}`}].map(z=>s.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[s.jsx("p",{className:"text-sm text-gray-600",children:z.label}),s.jsx("p",{className:"text-lg font-bold text-gray-900 mt-1",children:z.value})]},z.label))})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Recent Activity"}),s.jsx(St,{to:"/orders",className:"text-sm text-afri-green hover:text-afri-green-dark font-medium",children:"View all â†’"})]}),t!=null&&t.recentOrders&&t.recentOrders.length>0?s.jsx("div",{className:"space-y-4",children:t.recentOrders.slice(0,5).map(z=>{var ae,te,de;return s.jsxs("div",{className:"relative pl-6 pb-4 border-l-2 border-gray-200 last:border-l-0",children:[s.jsx("div",{className:"absolute left-[-9px] top-0 w-4 h-4 rounded-full bg-afri-green border-4 border-white"}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsxs("p",{className:"font-medium text-gray-900",children:["Order #",z.orderNumber]}),s.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${z.status==="delivered"?"bg-green-100 text-green-800":z.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:z.status})]}),s.jsxs("p",{className:"text-sm text-gray-600",children:[(ae=z.customer)==null?void 0:ae.name," placed an order for Â£",(de=(te=z.pricing)==null?void 0:te.total)==null?void 0:de.toLocaleString()]}),s.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[new Date(z.createdAt).toLocaleTimeString()," - ",new Date(z.createdAt).toLocaleDateString()]})]})]},z._id)})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx("p",{className:"text-gray-500",children:"No recent activity"}),s.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"New orders will appear here"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[s.jsx("div",{className:"flex items-center justify-between mb-4",children:s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"System Notifications"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Important updates and alerts"})]})}),s.jsxs("div",{className:"space-y-4",children:[(t==null?void 0:t.lowStockProducts)&&t.lowStockProducts.length>0&&s.jsxs("div",{className:"p-4 bg-red-50 rounded-lg border border-red-100",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:s.jsx("span",{className:"text-red-600 text-xl",children:"âš ï¸"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:"Low Stock Alert"}),s.jsxs("p",{className:"text-sm text-gray-600",children:[t.lowStockProducts.length," products need restocking"]})]})]}),s.jsx("div",{className:"mt-3 pl-13",children:t.lowStockProducts.slice(0,3).map(z=>s.jsxs("div",{className:"flex items-center justify-between py-2",children:[s.jsxs("p",{className:"text-sm text-gray-600",children:[z.name," - Only ",z.stock," ",z.unit," left"]}),s.jsx(St,{to:"/products",className:"text-xs text-afri-green hover:text-afri-green-dark font-medium",children:"Restock â†’"})]},z._id))})]}),s.jsx("div",{className:"space-y-3",children:[{metric:"Fulfillment Rate",value:((M=t==null?void 0:t.metrics)==null?void 0:M.fulfillmentRate)||95,target:90,status:"success",icon:"ðŸ“¦"},{metric:"Response Time",value:((le=t==null?void 0:t.metrics)==null?void 0:le.responseTime)||2,unit:"hours",target:24,status:"success",icon:"âš¡"},{metric:"Cancellation Rate",value:((J=t==null?void 0:t.metrics)==null?void 0:J.cancellationRate)||2,target:5,status:"warning",icon:"âŒ"}].map(z=>s.jsx("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("span",{className:"text-xl",children:z.icon}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:z.metric}),s.jsxs("p",{className:"text-sm text-gray-500",children:[z.value,z.unit?z.unit:"%",s.jsxs("span",{className:`ml-2 ${z.status==="success"?"text-green-600":z.status==="warning"?"text-yellow-600":"text-red-600"}`,children:["(",z.status==="success"?"Good":"Needs Attention",")"]})]})]})]})},z.metric))})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Account Health"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Based on your store performance"})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"text-3xl font-bold text-gray-900",children:[(t==null?void 0:t.accountHealth)||95,"/100"]}),s.jsx("p",{className:"text-sm text-green-600",children:"Excellent"})]})]}),s.jsx("div",{className:"space-y-4",children:[{metric:"Order Defect Rate",target:"<1%",actual:"0.5%",status:"success"},{metric:"Late Shipment Rate",target:"<4%",actual:"3.2%",status:"success"},{metric:"Valid Tracking Rate",target:">95%",actual:"98%",status:"success"},{metric:"Customer Response Time",target:"<24h",actual:"4h",status:"success"}].map(z=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:z.metric}),s.jsxs("p",{className:"text-xs text-gray-500",children:["Target: ",z.target]})]}),s.jsx("div",{className:"text-right",children:s.jsx("p",{className:`text-sm font-medium ${z.status==="success"?"text-green-600":z.status==="warning"?"text-yellow-600":"text-red-600"}`,children:z.actual})})]},z.metric))}),s.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-100",children:[s.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Recent Achievements"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"inline-block px-3 py-1 bg-green-100 text-green-800 rounded-full text-xs",children:"ðŸ† Perfect Month"}),s.jsx("span",{className:"inline-block px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:"â­ Top Rated"}),s.jsx("span",{className:"inline-block px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-xs",children:"ðŸš€ Fast Shipper"})]})]})]})]}),s.jsxs("div",{className:"bg-gradient-to-br from-afri-green to-afri-green-dark rounded-xl shadow-lg p-6 text-white",children:[s.jsx("div",{className:"flex items-center justify-between mb-6",children:s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Quick Actions"}),s.jsx("p",{className:"text-sm text-white text-opacity-80 mt-1",children:"Frequently used actions"})]})}),s.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-4",children:[s.jsxs(St,{to:"/products/new",className:"flex flex-col items-center justify-center p-4 bg-white bg-opacity-10 rounded-lg hover:bg-opacity-20 transition-all duration-200 transform hover:scale-105",children:[s.jsx("span",{className:"text-3xl mb-2",children:"âž•"}),s.jsx("span",{className:"text-sm font-medium text-center",children:"Add New Product"})]}),s.jsxs(St,{to:"/orders?status=pending",className:"flex flex-col items-center justify-center p-4 bg-white bg-opacity-10 rounded-lg hover:bg-opacity-20 transition-all duration-200 transform hover:scale-105",children:[s.jsx("span",{className:"text-3xl mb-2",children:"ðŸ“‹"}),s.jsx("span",{className:"text-sm font-medium text-center",children:"View Pending Orders"})]}),s.jsxs(St,{to:"/orders?status=shipping",className:"flex flex-col items-center justify-center p-4 bg-white bg-opacity-10 rounded-lg hover:bg-opacity-20 transition-all duration-200 transform hover:scale-105",children:[s.jsx("span",{className:"text-3xl mb-2",children:"ðŸšš"}),s.jsx("span",{className:"text-sm font-medium text-center",children:"Process Shipments"})]}),s.jsxs(St,{to:"/products?filter=low-stock",className:"flex flex-col items-center justify-center p-4 bg-white bg-opacity-10 rounded-lg hover:bg-opacity-20 transition-all duration-200 transform hover:scale-105",children:[s.jsx("span",{className:"text-3xl mb-2",children:"ðŸ“¦"}),s.jsx("span",{className:"text-sm font-medium text-center",children:"Restock Items"})]}),s.jsxs(St,{to:"/subscription",className:"flex flex-col items-center justify-center p-4 bg-white bg-opacity-10 rounded-lg hover:bg-opacity-20 transition-all duration-200 transform hover:scale-105",children:[s.jsx("span",{className:"text-3xl mb-2",children:"â­"}),s.jsx("span",{className:"text-sm font-medium text-center",children:"Upgrade Plan"})]}),s.jsxs(St,{to:"/settings",className:"flex flex-col items-center justify-center p-4 bg-white bg-opacity-10 rounded-lg hover:bg-opacity-20 transition-all duration-200 transform hover:scale-105",children:[s.jsx("span",{className:"text-3xl mb-2",children:"âš™ï¸"}),s.jsx("span",{className:"text-sm font-medium text-center",children:"Settings"})]})]})]})]}):s.jsx(Bw,{stats:t,analyticsData:a})]})}function Hw({onClose:e,onSuccess:r}){const[t,n]=Te.useState(null),[a,i]=Te.useState(!1),[o,l]=Te.useState(""),[c,h]=Te.useState(null),u=()=>{const d=["name","description","category","price","unit","stock","sku","lowStockThreshold","imageUrl"].join(","),y=["Fresh Tomatoes","Organic fresh tomatoes (1kg pack)","vegetables","2.50","kg","100","TOM-001","10","https://example.com/tomato-image.jpg"].join(","),x=`${d}
${y}`,b=new Blob([x],{type:"text/csv"}),N=window.URL.createObjectURL(b),w=document.createElement("a");w.href=N,w.download="products_template.csv",document.body.appendChild(w),w.click(),window.URL.revokeObjectURL(N),document.body.removeChild(w)},g=d=>{const y=d.target.files[0];y&&y.type==="text/csv"?(n(y),l("")):(n(null),l("Please select a valid CSV file"))},m=async()=>{var d,y,x;if(t){i(!0),l(""),h(null);try{const b=new FormData;b.append("file",t);const N=await Fo.bulkUpload(b);N.data.success&&(h({success:N.data.data.success||[],errors:N.data.data.errors||[]}),((d=N.data.data.success)==null?void 0:d.length)>0&&r())}catch(b){l(((x=(y=b.response)==null?void 0:y.data)==null?void 0:x.message)||"Failed to upload products")}finally{i(!1)}}};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full",children:[s.jsxs("div",{className:"border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Bulk Upload Products"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Upload multiple products using a CSV file"})]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[s.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"ðŸ“¥ Get Started"}),s.jsx("p",{className:"text-sm text-blue-700 mb-3",children:"Download our CSV template to ensure your data is formatted correctly."}),s.jsx("button",{onClick:u,className:"text-sm px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition",children:"Download Template"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload CSV File"}),s.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-lg hover:border-afri-green transition cursor-pointer",children:s.jsxs("div",{className:"space-y-1 text-center",children:[s.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48","aria-hidden":"true",children:s.jsx("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})}),s.jsxs("div",{className:"flex text-sm text-gray-600",children:[s.jsxs("label",{className:"relative cursor-pointer rounded-md font-medium text-afri-green hover:text-afri-green-dark",children:[s.jsx("span",{children:"Upload a file"}),s.jsx("input",{type:"file",accept:".csv",className:"sr-only",onChange:g})]}),s.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),s.jsx("p",{className:"text-xs text-gray-500",children:"CSV files only"})]})}),t&&s.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Selected file: ",t.name]})]}),o&&s.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded",children:s.jsx("p",{className:"text-red-700 text-sm",children:o})}),c&&s.jsxs("div",{className:"space-y-3",children:[c.success.length>0&&s.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[s.jsxs("h4",{className:"font-medium text-green-800 mb-2",children:["âœ… Successfully uploaded ",c.success.length," products"]}),s.jsx("div",{className:"max-h-32 overflow-y-auto",children:c.success.map((d,y)=>s.jsx("p",{className:"text-sm text-green-600",children:d.name},y))})]}),c.errors.length>0&&s.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[s.jsxs("h4",{className:"font-medium text-red-800 mb-2",children:["âŒ Failed to upload ",c.errors.length," products"]}),s.jsx("div",{className:"max-h-32 overflow-y-auto",children:c.errors.map((d,y)=>s.jsxs("p",{className:"text-sm text-red-600",children:["Row ",d.row,": ",d.message]},y))})]})]}),s.jsxs("div",{className:"flex items-center space-x-3 pt-4",children:[s.jsx("button",{onClick:m,disabled:!t||a,className:"flex-1 px-4 py-2 bg-afri-green text-white rounded-lg hover:bg-afri-green-dark transition font-medium disabled:opacity-50",children:a?"Uploading...":"Upload Products"}),s.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition font-medium",children:"Cancel"})]})]})]})})}function Ww({product:e,isEdit:r,onClose:t,onSuccess:n}){var m,d;const[a,i]=Te.useState({name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||"",category:(e==null?void 0:e.category)||"vegetables",price:(e==null?void 0:e.price)||"",unit:(e==null?void 0:e.unit)||"kg",stock:(e==null?void 0:e.stock)||"",imageUrl:((d=(m=e==null?void 0:e.images)==null?void 0:m[0])==null?void 0:d.url)||"",imageUploadMethod:"url",imageFiles:[],lowStockThreshold:(e==null?void 0:e.lowStockThreshold)||10,isActive:(e==null?void 0:e.isActive)!==!1}),[o,l]=Te.useState(!1),[c,h]=Te.useState(""),u=y=>{const x=y.target.type==="checkbox"?y.target.checked:y.target.value;i({...a,[y.target.name]:x})},g=async y=>{var x,b;y.preventDefault(),l(!0),h("");try{let N=[];if(a.imageUploadMethod==="file"&&a.imageFiles&&a.imageFiles.length>0){const A=new FormData;a.imageFiles.forEach(V=>{A.append("productImages",V)});const W=await(await fetch("http://localhost:5000/api/vendor/upload/images",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("afrimercato_token")}`},body:A})).json();if(!W.success)throw new Error(W.message||"Image upload failed");N=W.data.images.map((V,F)=>({url:V.url,isPrimary:F===0}))}else a.imageUploadMethod==="url"&&a.imageUrl&&a.imageUrl.trim()!==""&&(N=[{url:a.imageUrl.trim(),isPrimary:!0}]);const w={name:a.name,description:a.description,category:a.category,price:a.price,unit:a.unit,stock:a.stock,lowStockThreshold:a.lowStockThreshold,isActive:a.isActive};N.length>0&&(w.images=N),r?await Fo.update(e._id,w):await Fo.create(w),n(),t()}catch(N){console.error("Product save error:",N),h(N.message||((b=(x=N.response)==null?void 0:x.data)==null?void 0:b.message)||"Failed to save product")}finally{l(!1)}};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2 sm:p-4",children:s.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[95vh] sm:max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:r?"Edit Product":"Add New Product"}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("form",{onSubmit:g,className:"p-6 space-y-4",children:[c&&s.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded",children:s.jsx("p",{className:"text-red-700 text-sm",children:c})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product Name"}),s.jsx("input",{type:"text",name:"name",required:!0,value:a.name,onChange:u,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green",placeholder:"Fresh Tomatoes"})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),s.jsx("textarea",{name:"description",required:!0,rows:3,value:a.description,onChange:u,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green",placeholder:"Fresh organic tomatoes..."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),s.jsxs("select",{name:"category",value:a.category,onChange:u,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green",children:[s.jsx("option",{value:"vegetables",children:"Vegetables"}),s.jsx("option",{value:"fruits",children:"Fruits"}),s.jsx("option",{value:"meat-fish",children:"Meat & Fish"}),s.jsx("option",{value:"dairy",children:"Dairy"}),s.jsx("option",{value:"grains",children:"Grains"}),s.jsx("option",{value:"beverages",children:"Beverages"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Unit"}),s.jsxs("select",{name:"unit",value:a.unit,onChange:u,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green",children:[s.jsx("option",{value:"kg",children:"kg"}),s.jsx("option",{value:"g",children:"g"}),s.jsx("option",{value:"piece",children:"piece"}),s.jsx("option",{value:"bunch",children:"bunch"}),s.jsx("option",{value:"pack",children:"pack"}),s.jsx("option",{value:"liter",children:"liter"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price (Â£)"}),s.jsx("input",{type:"number",name:"price",required:!0,min:"0",value:a.price,onChange:u,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green",placeholder:"500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Stock"}),s.jsx("input",{type:"number",name:"stock",required:!0,min:"0",value:a.stock,onChange:u,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green",placeholder:"100"})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Product Images",s.jsx("span",{className:"text-xs text-gray-500 ml-2",children:"(Upload files or paste URL)"})]}),s.jsxs("div",{className:"flex gap-2 mb-3",children:[s.jsx("button",{type:"button",onClick:()=>i({...a,imageUploadMethod:"file"}),className:`px-4 py-2 text-sm font-medium rounded-lg transition ${a.imageUploadMethod==="file"?"bg-afri-green text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"ðŸ“ Upload File"}),s.jsx("button",{type:"button",onClick:()=>i({...a,imageUploadMethod:"url"}),className:`px-4 py-2 text-sm font-medium rounded-lg transition ${a.imageUploadMethod==="url"?"bg-afri-green text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"ðŸ”— Image URL"})]}),a.imageUploadMethod==="file"&&s.jsxs("div",{children:[s.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:y=>i({...a,imageFiles:Array.from(y.target.files)}),className:"w-full px-4 py-2 border-2 border-dashed border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green hover:border-afri-green cursor-pointer"}),s.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Upload up to 5 images (JPG, PNG, max 5MB each)"}),a.imageFiles&&a.imageFiles.length>0&&s.jsxs("div",{className:"mt-2 text-sm text-green-600",children:["âœ“ ",a.imageFiles.length," file(s) selected"]})]}),a.imageUploadMethod==="url"&&s.jsxs("div",{children:[s.jsx("input",{type:"url",name:"imageUrl",value:a.imageUrl,onChange:u,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green",placeholder:"https://images.unsplash.com/photo-..."}),s.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Tip: Go to ",s.jsx("a",{href:"https://unsplash.com",target:"_blank",rel:"noopener noreferrer",className:"text-afri-green hover:underline",children:"Unsplash.com"}),", find a food image, right-click and copy image address"]})]})]}),s.jsx("div",{className:"md:col-span-2",children:s.jsxs("label",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"checkbox",name:"isActive",checked:a.isActive,onChange:u,className:"h-4 w-4 text-afri-green focus:ring-afri-green border-gray-300 rounded"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Product is active"})]})})]}),s.jsxs("div",{className:"flex items-center space-x-3 pt-4",children:[s.jsx("button",{type:"submit",disabled:o,className:"flex-1 px-4 py-2 bg-afri-green text-white rounded-lg hover:bg-afri-green-dark transition font-medium disabled:opacity-50",children:o?"Saving...":r?"Update Product":"Add Product"}),s.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition font-medium",children:"Cancel"})]})]})]})})}function qw({selectedProducts:e,onActionComplete:r}){const[t,n]=Te.useState(!1),[a,i]=Te.useState(!1),[o,l]=Te.useState(!1),[c,h]=Te.useState({type:"fixed",value:""}),[u,g]=Te.useState({type:"set",value:""}),m=async()=>{if(window.confirm(`Are you sure you want to delete ${e.length} products?`))try{n(!0),await Promise.all(e.map(b=>Ir.deleteProduct(b))),r("delete")}catch(b){console.error("Failed to delete products:",b)}finally{n(!1)}},d=async b=>{try{n(!0),await Promise.all(e.map(N=>Ir.updateProduct(N,{isActive:b}))),r("status")}catch(N){console.error("Failed to update product status:",N)}finally{n(!1)}},y=async()=>{try{n(!0),await Promise.all(e.map(async b=>{const w=(await Ir.getProduct(b)).data.product.price,A=c.type==="percentage"?w*(1+parseFloat(c.value)/100):parseFloat(c.value);return Ir.updateProduct(b,{price:A})})),r("price"),i(!1)}catch(b){console.error("Failed to update prices:",b)}finally{n(!1)}},x=async()=>{try{n(!0),await Promise.all(e.map(async b=>{const w=(await Ir.getProduct(b)).data.product.stock,A=u.type==="adjust"?w+parseInt(u.value):parseInt(u.value);return Ir.updateProduct(b,{stock:Math.max(0,A)})})),r("stock"),l(!1)}catch(b){console.error("Failed to update stock:",b)}finally{n(!1)}};return s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-4 space-y-4",children:[s.jsxs("h3",{className:"font-medium text-gray-900",children:[e.length," products selected"]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("button",{onClick:()=>i(!0),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 rounded-lg",disabled:t,children:"Update Prices"}),s.jsx("button",{onClick:()=>l(!0),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 rounded-lg",disabled:t,children:"Update Stock"}),s.jsx("button",{onClick:()=>d(!0),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 rounded-lg",disabled:t,children:"Activate Products"}),s.jsx("button",{onClick:()=>d(!1),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 rounded-lg",disabled:t,children:"Deactivate Products"}),s.jsx("button",{onClick:m,className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 rounded-lg",disabled:t,children:"Delete Products"})]})]}),a&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[s.jsx("h3",{className:"text-lg font-medium mb-4",children:"Update Prices"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Update Type"}),s.jsxs("select",{value:c.type,onChange:b=>h(N=>({...N,type:b.target.value})),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-afri-green focus:ring-afri-green",children:[s.jsx("option",{value:"fixed",children:"Set Fixed Price"}),s.jsx("option",{value:"percentage",children:"Adjust by Percentage"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:c.type==="fixed"?"New Price":"Percentage Change"}),s.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx("span",{className:"text-gray-500 sm:text-sm",children:c.type==="fixed"?"Â£":"%"})}),s.jsx("input",{type:"number",value:c.value,onChange:b=>h(N=>({...N,value:b.target.value})),className:"block w-full pl-7 pr-12 border-gray-300 rounded-md focus:ring-afri-green focus:border-afri-green",placeholder:"0.00"})]})]})]}),s.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[s.jsx("button",{onClick:()=>i(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 rounded-md border",children:"Cancel"}),s.jsx("button",{onClick:y,disabled:t,className:"px-4 py-2 text-sm font-medium text-white bg-afri-green hover:bg-afri-green-dark rounded-md",children:t?"Updating...":"Update Prices"})]})]})}),o&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[s.jsx("h3",{className:"text-lg font-medium mb-4",children:"Update Stock"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Update Type"}),s.jsxs("select",{value:u.type,onChange:b=>g(N=>({...N,type:b.target.value})),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-afri-green focus:ring-afri-green",children:[s.jsx("option",{value:"set",children:"Set Fixed Stock"}),s.jsx("option",{value:"adjust",children:"Adjust Stock (+/-)"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:u.type==="set"?"New Stock Level":"Stock Adjustment"}),s.jsx("input",{type:"number",value:u.value,onChange:b=>g(N=>({...N,value:b.target.value})),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-afri-green focus:border-afri-green",placeholder:"0"})]})]}),s.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[s.jsx("button",{onClick:()=>l(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 rounded-md border",children:"Cancel"}),s.jsx("button",{onClick:x,disabled:t,className:"px-4 py-2 text-sm font-medium text-white bg-afri-green hover:bg-afri-green-dark rounded-md",children:t?"Updating...":"Update Stock"})]})]})})]})}function zw(){const[e,r]=Te.useState([]),[t,n]=Te.useState(!0),[a,i]=Te.useState(""),[o,l]=Te.useState(""),[c,h]=Te.useState("all"),[u,g]=Te.useState(!1),[m,d]=Te.useState(!1),[y,x]=Te.useState(!1),[b,N]=Te.useState(null),[w,A]=Te.useState([]),[E,W]=Te.useState(!1),V=[{value:"all",label:"All Categories"},{value:"vegetables",label:"Vegetables"},{value:"fruits",label:"Fruits"},{value:"meat-fish",label:"Meat & Fish"},{value:"dairy",label:"Dairy"},{value:"grains",label:"Grains"},{value:"beverages",label:"Beverages"}];Te.useEffect(()=>{F()},[]);const F=async()=>{var M,le;try{const J=await Fo.getAll();J.data.success&&r(J.data.data.products||[])}catch(J){i(((le=(M=J.response)==null?void 0:M.data)==null?void 0:le.message)||"Failed to load products")}finally{n(!1)}},C=async M=>{var le,J;if(window.confirm("Are you sure you want to delete this product?"))try{await Fo.delete(M),r(e.filter(z=>z._id!==M))}catch(z){alert(((J=(le=z.response)==null?void 0:le.data)==null?void 0:J.message)||"Failed to delete product")}},R=M=>{N(M),d(!0)},G=M=>{A(le=>le.includes(M)?le.filter(J=>J!==M):[...le,M])},j=()=>{w.length===B.length?A([]):A(B.map(M=>M._id))},T=M=>{F(),A([]),W(!1)},B=e.filter(M=>{const le=M.name.toLowerCase().includes(o.toLowerCase()),J=c==="all"||M.category===c;return le&&J});return t?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-afri-green"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Products"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your product inventory"})]}),s.jsxs("div",{className:"mt-4 sm:mt-0 flex space-x-3",children:[s.jsxs("button",{onClick:()=>x(!0),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-medium",children:[s.jsx("span",{className:"mr-2",children:"ï¿½"}),"Bulk Upload"]}),s.jsxs("button",{onClick:()=>g(!0),className:"inline-flex items-center px-4 py-2 bg-afri-green text-white rounded-lg hover:bg-afri-green-dark transition font-medium",children:[s.jsx("span",{className:"mr-2",children:"+"}),"Add Product"]})]})]}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search"}),s.jsx("input",{type:"text",value:o,onChange:M=>l(M.target.value),placeholder:"Search products...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),s.jsx("select",{value:c,onChange:M=>h(M.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent",children:V.map(M=>s.jsx("option",{value:M.value,children:M.label},M.value))})]}),s.jsx("div",{children:w.length>0&&s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:()=>W(!E),className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-medium mt-7",children:["Bulk Actions (",w.length,")"]}),E&&s.jsx("div",{className:"absolute right-0 mt-2 z-50",children:s.jsx(qw,{selectedProducts:w,onActionComplete:T})})]})})]})}),a&&s.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded",children:s.jsx("p",{className:"text-red-700",children:a})}),B.length===0?s.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-12 text-center",children:[s.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“¦"}),s.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No products found"}),s.jsx("p",{className:"text-gray-600 mb-6",children:"Start adding products to your inventory"}),s.jsx("button",{onClick:()=>g(!0),className:"inline-flex items-center px-6 py-3 bg-afri-green text-white rounded-lg hover:bg-afri-green-dark transition font-medium",children:"Add Your First Product"})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 mb-4",children:s.jsxs("label",{className:"inline-flex items-center",children:[s.jsx("input",{type:"checkbox",checked:w.length===B.length,onChange:j,className:"rounded border-gray-300 text-afri-green focus:ring-afri-green h-4 w-4"}),s.jsx("span",{className:"ml-2 text-sm text-gray-700",children:w.length===0?"Select all products":`Selected ${w.length} products`})]})}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:B.map(M=>s.jsxs("div",{className:`bg-white rounded-xl shadow-sm overflow-hidden hover:shadow-lg transition ${w.includes(M._id)?"ring-2 ring-afri-green":""}`,children:[s.jsx("div",{className:"absolute top-2 left-2 z-10",children:s.jsx("input",{type:"checkbox",checked:w.includes(M._id),onChange:()=>G(M._id),className:"rounded border-gray-300 text-afri-green focus:ring-afri-green h-4 w-4"})}),s.jsxs("div",{className:"h-48 bg-gray-200 relative",children:[M.images&&M.images.length>0?s.jsx("img",{src:M.images[0].url,alt:M.name,className:"w-full h-full object-cover"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:s.jsx("span",{className:"text-5xl",children:"ðŸ“¦"})}),!M.isActive&&s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:s.jsx("span",{className:"bg-red-500 text-white px-3 py-1 rounded-full text-sm font-medium",children:"Inactive"})}),M.stock===0&&s.jsx("div",{className:"absolute top-2 right-2 bg-red-500 text-white px-2 py-1 rounded-full text-xs font-medium",children:"Out of Stock"}),M.stock>0&&M.stock<=(M.lowStockThreshold||10)&&s.jsx("div",{className:"absolute top-2 right-2 bg-yellow-500 text-white px-2 py-1 rounded-full text-xs font-medium",children:"Low Stock"})]}),s.jsxs("div",{className:"p-4",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-1 truncate",children:M.name}),s.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:M.description}),s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("span",{className:"text-xl font-bold text-afri-green",children:["Â£",M.price.toLocaleString()]}),s.jsxs("span",{className:"text-sm text-gray-500",children:["Stock: ",M.stock," ",M.unit]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:()=>R(M),className:"flex-1 px-3 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition text-sm font-medium",children:"Edit"}),s.jsx("button",{onClick:()=>C(M._id),className:"flex-1 px-3 py-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition text-sm font-medium",children:"Delete"})]})]})]},M._id))})]}),(u||m)&&s.jsx(Ww,{product:b,isEdit:m,onClose:()=>{g(!1),d(!1),N(null)},onSuccess:F}),y&&s.jsx(Hw,{onClose:()=>x(!1),onSuccess:F})]})}function Vw({order:e,onPackingComplete:r,onStatusUpdate:t}){var x;const[n,a]=Te.useState([]),[i,o]=Te.useState({});Te.useEffect(()=>{const b=e.items.map(N=>({itemId:N._id||N.productId||N.name,name:N.name,quantity:N.quantity,unit:N.unit,packed:!1,pickedQuantity:0}));a(b)},[e.items]);const l=b=>{a(N=>N.map(w=>w.itemId===b?{...w,packed:!w.packed,pickedQuantity:w.packed?0:w.quantity}:w))},c=(b,N)=>{a(w=>w.map(A=>A.itemId===b?{...A,pickedQuantity:Math.max(0,Math.min(N,A.quantity))}:A))},h=(b,N)=>{o(w=>({...w,[b]:N}))},u=()=>{a(b=>b.map(N=>({...N,packed:!0,pickedQuantity:N.quantity})))},g=async()=>{!n.every(N=>N.packed)&&!window.confirm("Not all items are marked as packed. Are you sure you want to mark this order as ready?")||(r&&r(n),t&&await t("ready_for_pickup","All items packed and ready for pickup"))},m=n.filter(b=>b.packed).length,d=n.length,y=d>0?m/d*100:0;return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-gradient-to-br from-[#FFB300] to-[#FFA726] rounded-xl p-6 text-white shadow-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-2xl font-bold",children:"Packing Checklist"}),s.jsxs("p",{className:"text-gray-900 mt-1",children:[m," of ",d," items packed"]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"text-4xl font-bold",children:[Math.round(y),"%"]}),s.jsx("div",{className:"text-sm text-gray-900",children:"Complete"})]})]}),s.jsx("div",{className:"w-full bg-gray-900/20 rounded-full h-4 overflow-hidden shadow-inner",children:s.jsx("div",{className:"bg-gradient-to-r from-[#00897B] to-[#26A69A] h-full rounded-full transition-all duration-500 ease-out shadow-lg",style:{width:`${y}%`}})}),s.jsxs("div",{className:"mt-4 flex gap-3",children:[s.jsx("button",{onClick:u,className:"flex-1 bg-white text-gray-900 px-4 py-2 rounded-lg font-semibold shadow-md hover:shadow-lg transition-all transform hover:-translate-y-0.5",children:"âœ“ Mark All Packed"}),s.jsx("button",{onClick:g,disabled:m===0,className:"flex-1 bg-[#00897B] text-white px-4 py-2 rounded-lg font-semibold shadow-md hover:shadow-lg hover:bg-[#00695C] transition-all transform hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none",children:"ðŸ“¦ Ready for Pickup"})]})]}),((x=e.deliveryAddress)==null?void 0:x.instructions)&&s.jsx("div",{className:"bg-yellow-50 border-l-4 border-[#FFB300] rounded-lg p-4 shadow-sm",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("svg",{className:"w-5 h-5 text-[#FFB300] mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"Special Instructions"}),s.jsx("p",{className:"text-gray-700 text-sm",children:e.deliveryAddress.instructions})]})]})}),s.jsx("div",{className:"space-y-3",children:n.map((b,N)=>{const w=e.items[N];return s.jsx("div",{className:`
                bg-white rounded-xl p-5 shadow-md border-2 transition-all duration-300
                ${b.packed?"border-[#00897B] bg-green-50/50":"border-gray-200 hover:border-[#FFB300]"}
              `,children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"flex-shrink-0 pt-1",children:s.jsx("button",{onClick:()=>l(b.itemId),className:`
                      w-8 h-8 rounded-lg border-2 flex items-center justify-center
                      transition-all duration-200 transform hover:scale-110
                      ${b.packed?"bg-[#00897B] border-[#00897B] shadow-lg":"bg-white border-gray-300 hover:border-[#FFB300]"}
                    `,children:b.packed&&s.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-start justify-between gap-4 mb-3",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:`text-lg font-semibold ${b.packed?"text-[#00897B] line-through":"text-gray-900"}`,children:b.name}),s.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-1",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:["Ordered: ",s.jsxs("span",{className:"font-semibold",children:[b.quantity," ",b.unit]})]}),w.price&&s.jsxs("span",{className:"text-sm text-gray-600",children:["Price: ",s.jsxs("span",{className:"font-semibold",children:["Â£",w.price.toFixed(2)]})]})]})]}),w.image&&s.jsx("img",{src:w.image,alt:b.name,className:"w-20 h-20 object-cover rounded-lg shadow-md"})]}),s.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[s.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Picked Quantity:"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>c(b.itemId,b.pickedQuantity-1),disabled:b.pickedQuantity<=0,className:"w-8 h-8 rounded-lg bg-gray-200 hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed font-semibold transition-colors",children:"-"}),s.jsx("input",{type:"number",value:b.pickedQuantity,onChange:A=>c(b.itemId,parseInt(A.target.value)||0),className:"w-20 text-center px-2 py-1 border-2 border-gray-300 rounded-lg font-semibold focus:border-[#FFB300] focus:ring-2 focus:ring-[#FFB300]/20",min:"0",max:b.quantity}),s.jsx("button",{onClick:()=>c(b.itemId,b.pickedQuantity+1),disabled:b.pickedQuantity>=b.quantity,className:"w-8 h-8 rounded-lg bg-gray-200 hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed font-semibold transition-colors",children:"+"}),s.jsxs("span",{className:"text-sm text-gray-600",children:["/ ",b.quantity," ",b.unit]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes (optional)"}),s.jsx("input",{type:"text",value:i[b.itemId]||"",onChange:A=>h(b.itemId,A.target.value),placeholder:"E.g., substitution, quality issue...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-[#FFB300] focus:border-transparent"})]}),b.pickedQuantity>0&&b.pickedQuantity<b.quantity&&s.jsx("div",{className:"mt-2 p-2 bg-orange-50 border-l-4 border-orange-400 rounded",children:s.jsxs("p",{className:"text-xs text-orange-700",children:["âš ï¸ Short by ",b.quantity-b.pickedQuantity," ",b.unit]})})]})]})},b.itemId)})}),s.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-6 shadow-lg border border-gray-200",children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Packing Summary"}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{className:"text-center p-3 bg-white rounded-lg shadow-sm",children:[s.jsx("div",{className:"text-2xl font-bold text-gray-900",children:d}),s.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Total Items"})]}),s.jsxs("div",{className:"text-center p-3 bg-white rounded-lg shadow-sm",children:[s.jsx("div",{className:"text-2xl font-bold text-[#00897B]",children:m}),s.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Packed"})]}),s.jsxs("div",{className:"text-center p-3 bg-white rounded-lg shadow-sm",children:[s.jsx("div",{className:"text-2xl font-bold text-orange-600",children:d-m}),s.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Remaining"})]})]})]}),s.jsx("div",{className:"sticky bottom-0 bg-white border-t-2 border-gray-200 p-4 -mx-6 -mb-6 rounded-b-xl shadow-lg",children:s.jsx("button",{onClick:g,disabled:m===0,className:`
            w-full py-4 rounded-xl font-bold text-lg text-white shadow-lg
            transition-all duration-200 transform hover:-translate-y-1 hover:shadow-xl
            ${m===d?"bg-gradient-to-r from-[#00897B] to-[#26A69A]":"bg-gradient-to-r from-gray-500 to-gray-600"}
            disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none
          `,children:m===d?s.jsx(s.Fragment,{children:"âœ“ Mark Order as Ready for Pickup"}):s.jsxs(s.Fragment,{children:["Pack ",d-m," More Items"]})})})]})}function Gw({order:e,onPickerAssigned:r}){var b,N,w,A;const[t,n]=Te.useState([]),[a,i]=Te.useState(null),[o,l]=Te.useState(!0),[c,h]=Te.useState(!1);Te.useEffect(()=>{u()},[]);const u=async()=>{try{l(!0);const E=[{id:"picker-1",name:"John Smith",status:"available",activeOrders:0,rating:4.8,completedOrders:156,avatar:null},{id:"picker-2",name:"Sarah Johnson",status:"available",activeOrders:1,rating:4.9,completedOrders:203,avatar:null},{id:"picker-3",name:"Michael Brown",status:"busy",activeOrders:3,rating:4.7,completedOrders:189,avatar:null},{id:"picker-4",name:"Emily Davis",status:"available",activeOrders:0,rating:5,completedOrders:98,avatar:null}];setTimeout(()=>{n(E),l(!1)},500)}catch(E){console.error("Error fetching pickers:",E),l(!1)}},g=async()=>{if(!a){alert("Please select a picker");return}h(!0);try{await new Promise(E=>setTimeout(E,1e3)),r&&await r(a.id),alert(`Order assigned to ${a.name}`)}catch(E){console.error("Error assigning picker:",E),alert("Failed to assign picker. Please try again.")}finally{h(!1)}},m=E=>{switch(E){case"available":return"bg-green-100 text-green-700 border-green-200";case"busy":return"bg-orange-100 text-orange-700 border-orange-200";case"offline":return"bg-gray-100 text-gray-700 border-gray-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}},d=E=>{switch(E){case"available":return"bg-green-500";case"busy":return"bg-orange-500";case"offline":return"bg-gray-400";default:return"bg-gray-400"}};if(o)return s.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#FFB300] mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading available pickers..."})]});const y=t.filter(E=>E.status==="available"),x=t.filter(E=>E.status==="busy");return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-gradient-to-br from-[#FFB300] to-[#FFA726] rounded-xl p-6 text-white shadow-lg",children:[s.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Assign Order Picker"}),s.jsxs("p",{className:"text-gray-900",children:["Select a picker to handle this order â€¢ ",y.length," available"]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-md border border-gray-200",children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Order Details"}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Order Number"}),s.jsx("p",{className:"font-semibold text-gray-900",children:e.orderNumber})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Total Items"}),s.jsx("p",{className:"font-semibold text-gray-900",children:((b=e.items)==null?void 0:b.length)||0})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Order Value"}),s.jsxs("p",{className:"font-semibold text-[#00897B]",children:["Â£",(w=(N=e.pricing)==null?void 0:N.total)==null?void 0:w.toFixed(2)]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Customer"}),s.jsx("p",{className:"font-semibold text-gray-900",children:((A=e.deliveryAddress)==null?void 0:A.fullName)||"N/A"})]})]})]}),y.length>0&&s.jsxs("div",{children:[s.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-3 h-3 bg-green-500 rounded-full animate-pulse"}),"Available Pickers (",y.length,")"]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:y.map(E=>s.jsx("div",{onClick:()=>i(E),className:`
                  bg-white rounded-xl p-5 shadow-md cursor-pointer transition-all duration-200
                  border-2 ${(a==null?void 0:a.id)===E.id?"border-[#FFB300] shadow-lg scale-105":"border-gray-200 hover:border-[#FFB300] hover:shadow-lg"}
                `,children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsxs("div",{className:"flex-shrink-0",children:[E.avatar?s.jsx("img",{src:E.avatar,alt:E.name,className:"w-16 h-16 rounded-full object-cover shadow-md"}):s.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-[#FFB300] to-[#FFA726] flex items-center justify-center text-white text-2xl font-bold shadow-md",children:E.name.charAt(0)}),s.jsx("div",{className:`w-4 h-4 rounded-full ${d(E.status)} border-2 border-white shadow-sm -mt-3 ml-12`})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[s.jsx("h5",{className:"font-bold text-gray-900 text-lg",children:E.name}),(a==null?void 0:a.id)===E.id&&s.jsx("svg",{className:"w-6 h-6 text-[#FFB300] flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[s.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"text-sm font-bold text-gray-900",children:E.rating}),s.jsx("div",{className:"text-xs text-gray-500",children:"Rating"})]}),s.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"text-sm font-bold text-gray-900",children:E.completedOrders}),s.jsx("div",{className:"text-xs text-gray-500",children:"Orders"})]}),s.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"text-sm font-bold text-gray-900",children:E.activeOrders}),s.jsx("div",{className:"text-xs text-gray-500",children:"Active"})]})]}),s.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold border ${m(E.status)}`,children:[s.jsx("span",{className:`w-2 h-2 rounded-full ${d(E.status)} mr-2`}),E.status.charAt(0).toUpperCase()+E.status.slice(1)]})]})]})},E.id))})]}),x.length>0&&s.jsxs("div",{children:[s.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-3 h-3 bg-orange-500 rounded-full"}),"Busy Pickers (",x.length,")"]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:x.map(E=>s.jsx("div",{className:"bg-white rounded-xl p-5 shadow-md border-2 border-gray-200 opacity-60",children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"flex-shrink-0",children:E.avatar?s.jsx("img",{src:E.avatar,alt:E.name,className:"w-16 h-16 rounded-full object-cover shadow-md grayscale"}):s.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-400 flex items-center justify-center text-white text-2xl font-bold shadow-md",children:E.name.charAt(0)})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h5",{className:"font-bold text-gray-700 text-lg mb-1",children:E.name}),s.jsxs("p",{className:"text-sm text-gray-500 mb-2",children:["Currently handling ",E.activeOrders," orders"]}),s.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold border ${m(E.status)}`,children:[s.jsx("span",{className:`w-2 h-2 rounded-full ${d(E.status)} mr-2`}),"Busy"]})]})]})},E.id))})]}),t.length===0&&s.jsxs("div",{className:"bg-gray-50 rounded-xl p-12 text-center",children:[s.jsx("svg",{className:"w-16 h-16 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Pickers Available"}),s.jsx("p",{className:"text-gray-600",children:"All pickers are currently busy. Please check back in a few minutes."})]}),a&&s.jsx("div",{className:"sticky bottom-0 bg-white border-t-2 border-gray-200 p-4 -mx-6 -mb-6 rounded-b-xl shadow-lg",children:s.jsx("button",{onClick:g,disabled:c,className:"w-full py-4 bg-gradient-to-r from-[#00897B] to-[#26A69A] text-white rounded-xl font-bold text-lg shadow-lg hover:shadow-xl transition-all duration-200 transform hover:-translate-y-1 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center justify-center gap-2",children:c?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Assigning..."]}):s.jsxs(s.Fragment,{children:["âœ“ Assign to ",a.name]})})})]})}function $w({order:e,onStatusUpdate:r,isUpdating:t}){const[n,a]=Te.useState(!1),[i,o]=Te.useState(null),[l,c]=Te.useState(""),h=()=>({pending:[{status:"confirmed",label:"Accept Order",icon:"âœ“",color:"green",description:"Confirm and start preparing this order"},{status:"cancelled",label:"Reject Order",icon:"âœ•",color:"red",description:"Cancel this order (requires reason)",requiresNote:!0}],confirmed:[{status:"preparing",label:"Start Preparing",icon:"ðŸ‘¨â€ðŸ³",color:"orange",description:"Begin preparing the order"},{status:"cancelled",label:"Cancel Order",icon:"âœ•",color:"red",description:"Cancel this order",requiresNote:!0}],preparing:[{status:"ready",label:"Mark as Ready",icon:"âœ“",color:"green",description:"Order is ready for pickup"}],ready:[{status:"out-for-delivery",label:"Out for Delivery",icon:"ðŸšš",color:"blue",description:"Rider has picked up the order"}],"out-for-delivery":[{status:"delivered",label:"Mark as Delivered",icon:"âœ“",color:"green",description:"Order has been delivered to customer"}],delivered:[{status:"completed",label:"Complete Order",icon:"âœ“",color:"gray",description:"Finalize and archive this order"}],assigned_picker:[{status:"picking",label:"Start Picking",icon:"ðŸ“¦",color:"purple",description:"Picker starts collecting items"}],picking:[{status:"picked",label:"Items Picked",icon:"âœ“",color:"purple",description:"All items have been picked"}],picked:[{status:"packing",label:"Start Packing",icon:"ðŸ“¦",color:"indigo",description:"Begin packing the items"}],packing:[{status:"ready_for_pickup",label:"Ready for Pickup",icon:"âœ“",color:"teal",description:"Order is packed and ready"}]})[e.status]||[],u=x=>{o(x),a(!0)},g=async()=>{if(!i)return;const x=i.requiresNote?l:"";if(i.requiresNote&&!x.trim()){alert("Please provide a reason for cancellation");return}try{await r(i.status,x),a(!1),o(null),c("")}catch(b){console.error("Error updating status:",b),alert("Failed to update order status. Please try again.")}},m=()=>{a(!1),o(null),c("")},d=h();if(d.length===0)return null;const y={green:{bg:"bg-gradient-to-r from-green-600 to-green-700",hover:"hover:from-green-700 hover:to-green-800",border:"border-green-600",text:"text-green-700"},red:{bg:"bg-gradient-to-r from-red-600 to-red-700",hover:"hover:from-red-700 hover:to-red-800",border:"border-red-600",text:"text-red-700"},orange:{bg:"bg-gradient-to-r from-orange-600 to-orange-700",hover:"hover:from-orange-700 hover:to-orange-800",border:"border-orange-600",text:"text-orange-700"},blue:{bg:"bg-gradient-to-r from-blue-600 to-blue-700",hover:"hover:from-blue-700 hover:to-blue-800",border:"border-blue-600",text:"text-blue-700"},purple:{bg:"bg-gradient-to-r from-purple-600 to-purple-700",hover:"hover:from-purple-700 hover:to-purple-800",border:"border-purple-600",text:"text-purple-700"},indigo:{bg:"bg-gradient-to-r from-indigo-600 to-indigo-700",hover:"hover:from-indigo-700 hover:to-indigo-800",border:"border-indigo-600",text:"text-indigo-700"},teal:{bg:"bg-gradient-to-r from-[#00897B] to-[#00695C]",hover:"hover:from-[#00695C] hover:to-[#004D40]",border:"border-[#00897B]",text:"text-[#00897B]"},gray:{bg:"bg-gradient-to-r from-gray-600 to-gray-700",hover:"hover:from-gray-700 hover:to-gray-800",border:"border-gray-600",text:"text-gray-700"}};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg border-2 border-[#FFB300]",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-[#FFB300]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"Quick Actions"]}),s.jsx("div",{className:"flex flex-wrap gap-3",children:d.map(x=>{const b=y[x.color]||y.gray;return s.jsxs("button",{onClick:()=>u(x),disabled:t,className:`
                  flex items-center gap-2 px-6 py-3 rounded-lg font-semibold text-white
                  ${b.bg} ${b.hover}
                  shadow-md hover:shadow-lg
                  transition-all duration-200 transform hover:-translate-y-0.5
                  disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none
                `,children:[s.jsx("span",{className:"text-xl",children:x.icon}),s.jsx("span",{children:x.label}),t&&s.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})]},x.status)})})]}),n&&i&&s.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[60] p-4 animate-fadeIn",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-slideUp",children:[s.jsx("div",{className:`w-16 h-16 rounded-full mx-auto mb-4 flex items-center justify-center ${i.color==="red"?"bg-red-100":"bg-green-100"}`,children:s.jsx("span",{className:"text-3xl",children:i.icon})}),s.jsx("h3",{className:"text-xl font-bold text-gray-900 text-center mb-2",children:i.label}),s.jsx("p",{className:"text-gray-600 text-center mb-4",children:i.description}),i.requiresNote&&s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for cancellation *"}),s.jsx("textarea",{value:l,onChange:x=>c(x.target.value),placeholder:"Please provide a reason...",rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#FFB300] focus:border-transparent resize-none",required:!0})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-4",children:[s.jsx("div",{className:"text-sm text-gray-600",children:"Order Number"}),s.jsx("div",{className:"font-semibold text-gray-900",children:e.orderNumber})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:m,className:"flex-1 px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium rounded-lg transition-colors",children:"Cancel"}),s.jsx("button",{onClick:g,disabled:i.requiresNote&&!l.trim(),className:`
                  flex-1 px-4 py-2 text-white font-medium rounded-lg transition-all
                  ${y[i.color].bg} ${y[i.color].hover}
                  shadow-md hover:shadow-lg
                  disabled:opacity-50 disabled:cursor-not-allowed
                `,children:"Confirm"})]})]})})]})}function Yw({order:e}){const[r,t]=Te.useState(!1),n=[{status:"pending",label:"Order Placed",icon:"ðŸ“‹",description:"Customer placed the order"},{status:"confirmed",label:"Order Confirmed",icon:"âœ“",description:"Vendor accepted the order"},{status:"assigned_picker",label:"Picker Assigned",icon:"ðŸ‘¤",description:"Order assigned to picker"},{status:"picking",label:"Picking Items",icon:"ðŸ›’",description:"Picker is collecting items"},{status:"picked",label:"Items Picked",icon:"âœ“",description:"All items collected"},{status:"packing",label:"Packing Order",icon:"ðŸ“¦",description:"Items being packed"},{status:"ready_for_pickup",label:"Ready for Pickup",icon:"âœ“",description:"Order ready for rider"},{status:"out-for-delivery",label:"Out for Delivery",icon:"ðŸšš",description:"Rider on the way"},{status:"delivered",label:"Delivered",icon:"âœ“",description:"Order delivered to customer"},{status:"completed",label:"Completed",icon:"âœ“",description:"Order completed"}],a={label:"Order Cancelled",icon:"âœ•",description:"Order was cancelled"},o=e.status==="cancelled"?-1:n.findIndex(m=>m.status===e.status),l=e.status==="cancelled",c=m=>l?"cancelled":m<o?"completed":m===o?"current":"upcoming",h=m=>{switch(m){case"completed":return{bg:"bg-[#00897B]",text:"text-[#00897B]",border:"border-[#00897B]",line:"bg-[#00897B]"};case"current":return{bg:"bg-[#FFB300]",text:"text-[#FFB300]",border:"border-[#FFB300]",line:"bg-gray-300"};case"cancelled":return{bg:"bg-red-500",text:"text-red-500",border:"border-red-500",line:"bg-gray-300"};default:return{bg:"bg-gray-300",text:"text-gray-400",border:"border-gray-300",line:"bg-gray-300"}}},u=e.statusHistory||[{status:"pending",timestamp:e.createdAt,note:"Order placed by customer",user:"System"},...e.status!=="pending"?[{status:e.status,timestamp:e.updatedAt,note:"Current status",user:"Vendor"}]:[]],g=r?u:u.slice(0,3);return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-gradient-to-br from-[#FFB300] to-[#FFA726] rounded-xl p-6 text-white shadow-lg",children:[s.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Order Timeline"}),s.jsxs("p",{className:"text-gray-900",children:["Track the progress of order ",e.orderNumber]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-gray-200",children:[s.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Progress Stages"}),s.jsx("div",{className:"relative",children:l?s.jsxs("div",{className:"relative flex items-start gap-4",children:[s.jsx("div",{className:"relative z-10 flex-shrink-0",children:s.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center border-4 border-white shadow-lg bg-red-500",children:s.jsx("span",{className:"text-white text-xl",children:a.icon})})}),s.jsxs("div",{className:"flex-1 pt-1",children:[s.jsx("h5",{className:"font-bold text-lg text-red-500 mb-1",children:a.label}),s.jsx("p",{className:"text-sm text-gray-600",children:a.description}),e.cancellationReason&&s.jsx("div",{className:"mt-2 p-3 bg-red-50 border-l-4 border-red-500 rounded",children:s.jsxs("p",{className:"text-sm text-gray-700",children:[s.jsx("span",{className:"font-semibold",children:"Reason:"})," ",e.cancellationReason]})})]})]}):n.map((m,d)=>{const y=c(d),x=h(y),b=d===n.length-1;return s.jsxs("div",{className:"relative flex items-start gap-4 pb-8",children:[!b&&s.jsx("div",{className:"absolute left-5 top-12 w-0.5 h-full",children:s.jsx("div",{className:`w-full h-full ${x.line}`})}),s.jsxs("div",{className:"relative z-10 flex-shrink-0",children:[s.jsx("div",{className:`
                        w-10 h-10 rounded-full flex items-center justify-center
                        border-4 border-white shadow-lg
                        ${x.bg}
                        ${y==="current"?"animate-pulse":""}
                      `,children:s.jsx("span",{className:"text-white text-xl",children:m.icon})}),y==="completed"&&s.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-[#00897B] rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),s.jsxs("div",{className:"flex-1 pt-1",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("h5",{className:`font-bold text-lg ${x.text}`,children:m.label}),y==="completed"&&u.find(N=>N.status===m.status)&&s.jsx("span",{className:"text-sm text-gray-500",children:new Date(u.find(N=>N.status===m.status).timestamp).toLocaleString("en-GB",{dateStyle:"short",timeStyle:"short"})}),y==="current"&&s.jsx("span",{className:"px-3 py-1 bg-[#FFB300] text-gray-900 text-xs font-semibold rounded-full",children:"Current"})]}),s.jsx("p",{className:"text-sm text-gray-600",children:m.description}),y==="current"&&s.jsx("div",{className:"mt-2 p-3 bg-yellow-50 border-l-4 border-[#FFB300] rounded",children:s.jsxs("p",{className:"text-sm text-gray-700",children:[s.jsx("span",{className:"font-semibold",children:"In Progress:"})," This stage is currently active"]})})]})]},m.status)})})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-gray-200",children:[s.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-[#00897B]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Status History"]}),s.jsx("div",{className:"space-y-3",children:g.map((m,d)=>s.jsxs("div",{className:"flex items-start gap-4 p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[s.jsx("div",{className:"flex-shrink-0 w-2 h-2 mt-2 rounded-full bg-[#00897B]"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[s.jsx("h5",{className:"font-semibold text-gray-900 capitalize",children:m.status.replace(/_/g," ").replace(/-/g," ")}),s.jsx("span",{className:"text-sm text-gray-500 whitespace-nowrap",children:new Date(m.timestamp).toLocaleString("en-GB",{dateStyle:"short",timeStyle:"short"})})]}),m.note&&s.jsx("p",{className:"text-sm text-gray-600",children:m.note}),m.user&&s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["By ",m.user]})]})]},d))}),u.length>3&&s.jsx("button",{onClick:()=>t(!r),className:"mt-4 w-full py-2 text-[#00897B] font-medium hover:bg-gray-50 rounded-lg transition-colors",children:r?"â–² Show Less":`â–¼ Show ${u.length-3} More`})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-5 shadow-md border border-blue-200",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-500 flex items-center justify-center",children:s.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsx("h5",{className:"font-semibold text-gray-900",children:"Total Time"})]}),s.jsxs("p",{className:"text-2xl font-bold text-blue-700",children:[Math.round((new Date-new Date(e.createdAt))/1e3/60)," mins"]}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Since order placed"})]}),s.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-5 shadow-md border border-green-200",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-green-500 flex items-center justify-center",children:s.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsx("h5",{className:"font-semibold text-gray-900",children:"Progress"})]}),s.jsxs("p",{className:"text-2xl font-bold text-green-700",children:[Math.round((o+1)/n.length*100),"%"]}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Order completion"})]}),s.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-5 shadow-md border border-purple-200",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-purple-500 flex items-center justify-center",children:s.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),s.jsx("h5",{className:"font-semibold text-gray-900",children:"Updates"})]}),s.jsx("p",{className:"text-2xl font-bold text-purple-700",children:u.length}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Status changes"})]})]})]})}const Xw={pending:"bg-gradient-to-r from-yellow-400 to-yellow-500 text-gray-900",confirmed:"bg-gradient-to-r from-blue-500 to-blue-600 text-white",assigned_picker:"bg-gradient-to-r from-purple-500 to-purple-600 text-white",picking:"bg-gradient-to-r from-purple-600 to-purple-700 text-white",picked:"bg-gradient-to-r from-purple-700 to-purple-800 text-white",packing:"bg-gradient-to-r from-indigo-500 to-indigo-600 text-white",ready_for_pickup:"bg-gradient-to-r from-teal-500 to-teal-600 text-white",preparing:"bg-gradient-to-r from-orange-500 to-orange-600 text-white",ready:"bg-gradient-to-r from-green-600 to-green-700 text-white","out-for-delivery":"bg-gradient-to-r from-blue-600 to-blue-700 text-white",delivered:"bg-gradient-to-r from-green-700 to-green-800 text-white",completed:"bg-gradient-to-r from-gray-700 to-gray-800 text-white",cancelled:"bg-gradient-to-r from-red-500 to-red-600 text-white"},Kw={pending:"Pending",confirmed:"Confirmed",assigned_picker:"Picker Assigned",picking:"Picking Items",picked:"Items Picked",packing:"Packing",ready_for_pickup:"Ready for Pickup",preparing:"Preparing",ready:"Ready","out-for-delivery":"Out for Delivery",delivered:"Delivered",completed:"Completed",cancelled:"Cancelled"};function Jw({order:e,onClose:r,onStatusUpdate:t,onRefresh:n}){var x,b,N,w,A,E,W,V,F,C,R,G,j,T,B,M,le,J,z,ae,te,de;const[a,i]=Te.useState("details"),[o,l]=Te.useState([]),[c,h]=Te.useState(!1);Te.useEffect(()=>{if(e.status==="packing"||e.status==="picking"){const xe=e.items.map(_=>({itemId:_._id||_.productId,packed:!1}));l(xe)}},[e]);const u=async(xe,_="")=>{h(!0);try{await t(e._id,xe,_),n&&await n()}catch(L){console.error("Error updating status:",L)}finally{h(!1)}},g=xe=>{l(xe),xe.every(L=>L.packed)&&u("ready_for_pickup","All items packed and ready")},m=async xe=>{try{await u("assigned_picker",`Picker ${xe} assigned`)}catch(_){console.error("Error assigning picker:",_)}},d=e.items.reduce((xe,_)=>xe+_.quantity,0),y=Math.ceil(d*2);return s.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fadeIn",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-6xl w-full max-h-[95vh] overflow-hidden flex flex-col animate-slideUp",children:[s.jsx("div",{className:"bg-gradient-to-r from-[#FFB300] to-[#FFA726] text-gray-900 p-6",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-bold",children:e.orderNumber}),s.jsxs("p",{className:"text-gray-800 mt-1 text-sm",children:["Placed on ",new Date(e.createdAt).toLocaleString("en-GB",{dateStyle:"medium",timeStyle:"short"})]}),s.jsxs("div",{className:"mt-2 flex items-center gap-3",children:[s.jsx("span",{className:`px-4 py-1.5 inline-flex text-sm font-semibold rounded-full shadow-lg ${Xw[e.status]}`,children:Kw[e.status]}),s.jsxs("span",{className:"text-sm text-gray-800",children:[d," items â€¢ Est. ",y," mins"]})]})]}),s.jsx("button",{onClick:r,className:"text-gray-900 hover:text-gray-700 transition-all hover:rotate-90 duration-300",children:s.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})]})}),s.jsx("div",{className:"border-b border-gray-200 bg-gray-50",children:s.jsx("div",{className:"flex overflow-x-auto",children:[{id:"details",label:"Order Details",icon:"ðŸ“‹"},{id:"timeline",label:"Timeline",icon:"ðŸ“"},{id:"packing",label:"Packing",icon:"ðŸ“¦",show:["packing","picking","assigned_picker"].includes(e.status)},{id:"picker",label:"Picker",icon:"ðŸ‘¤",show:["pending","confirmed"].includes(e.status)}].map(xe=>xe.show===!1||xe.show&&!xe.show?null:s.jsxs("button",{onClick:()=>i(xe.id),className:`px-6 py-4 text-sm font-medium transition-all duration-200 border-b-2 whitespace-nowrap ${a===xe.id?"border-[#FFB300] text-[#FFB300] bg-white":"border-transparent text-gray-600 hover:text-[#FFB300] hover:bg-gray-100"}`,children:[s.jsx("span",{className:"mr-2",children:xe.icon}),xe.label]},xe.id))})}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[a==="details"&&s.jsxs("div",{className:"space-y-6",children:[s.jsx($w,{order:e,onStatusUpdate:u,isUpdating:c}),s.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-6 shadow-sm border border-gray-200",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-[#00897B]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Customer Information"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[s.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Name"}),s.jsx("p",{className:"font-semibold text-gray-900",children:((x=e.deliveryAddress)==null?void 0:x.fullName)||((b=e.customer)==null?void 0:b.name)||"N/A"})]}),s.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[s.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Phone"}),s.jsx("p",{className:"font-semibold text-gray-900",children:((N=e.deliveryAddress)==null?void 0:N.phone)||((w=e.customer)==null?void 0:w.phone)||"N/A"})]}),s.jsxs("div",{className:"col-span-1 md:col-span-2 bg-white rounded-lg p-4 shadow-sm",children:[s.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Delivery Address"}),s.jsxs("p",{className:"font-semibold text-gray-900",children:[(A=e.deliveryAddress)==null?void 0:A.street,", ",(E=e.deliveryAddress)==null?void 0:E.city,", ",(W=e.deliveryAddress)==null?void 0:W.state," ",(V=e.deliveryAddress)==null?void 0:V.postalCode]}),((F=e.deliveryAddress)==null?void 0:F.instructions)&&s.jsx("div",{className:"mt-2 p-3 bg-yellow-50 border-l-4 border-[#FFB300] rounded",children:s.jsxs("p",{className:"text-sm text-gray-700",children:[s.jsx("span",{className:"font-semibold",children:"Delivery Note:"})," ",e.deliveryAddress.instructions]})})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"bg-gradient-to-r from-[#00897B] to-[#26A69A] text-white px-6 py-4",children:s.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),"Order Items (",((C=e.items)==null?void 0:C.length)||0,")"]})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Product"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Price"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Quantity"}),s.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Subtotal"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(R=e.items)==null?void 0:R.map((xe,_)=>{var L,P;return s.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[s.jsx("td",{className:"px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[xe.image&&s.jsx("img",{src:xe.image,alt:xe.name,className:"w-12 h-12 object-cover rounded-lg shadow-sm"}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:xe.name}),xe.notes&&s.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Note: ",xe.notes]})]})]})}),s.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:["Â£",(L=xe.price)==null?void 0:L.toFixed(2)]}),s.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:s.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full bg-gray-100 font-medium",children:[xe.quantity," ",xe.unit]})}),s.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900 text-right font-semibold",children:["Â£",(P=xe.subtotal)==null?void 0:P.toFixed(2)]})]},_)})})]})})]}),s.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-6 shadow-lg border border-gray-200",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Subtotal"}),s.jsxs("span",{className:"text-gray-900 font-medium",children:["Â£",(j=(G=e.pricing)==null?void 0:G.subtotal)==null?void 0:j.toFixed(2)]})]}),((T=e.pricing)==null?void 0:T.deliveryFee)>0&&s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Delivery Fee"}),s.jsxs("span",{className:"text-gray-900 font-medium",children:["Â£",e.pricing.deliveryFee.toFixed(2)]})]}),((B=e.pricing)==null?void 0:B.tax)>0&&s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Tax (VAT)"}),s.jsxs("span",{className:"text-gray-900 font-medium",children:["Â£",e.pricing.tax.toFixed(2)]})]}),((M=e.pricing)==null?void 0:M.discount)>0&&s.jsxs("div",{className:"flex justify-between text-sm text-[#00897B]",children:[s.jsx("span",{children:"Discount"}),s.jsxs("span",{className:"font-medium",children:["-Â£",e.pricing.discount.toFixed(2)]})]}),s.jsxs("div",{className:"border-t-2 border-gray-300 pt-3 flex justify-between items-center",children:[s.jsx("span",{className:"font-bold text-lg text-gray-900",children:"Total"}),s.jsxs("span",{className:"font-bold text-2xl text-[#00897B]",children:["Â£",(J=(le=e.pricing)==null?void 0:le.total)==null?void 0:J.toFixed(2)]})]})]}),s.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-300 flex flex-wrap items-center justify-between gap-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-sm text-gray-500",children:"Payment Method:"}),s.jsx("span",{className:"font-semibold text-gray-900 capitalize px-3 py-1 bg-white rounded-lg shadow-sm",children:((z=e.payment)==null?void 0:z.method)||"N/A"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-sm text-gray-500",children:"Status:"}),s.jsx("span",{className:`font-semibold px-3 py-1 rounded-lg shadow-sm ${((ae=e.payment)==null?void 0:ae.status)==="paid"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:((de=(te=e.payment)==null?void 0:te.status)==null?void 0:de.toUpperCase())||"PENDING"})]})]})]})]}),a==="timeline"&&s.jsx(Yw,{order:e}),a==="packing"&&s.jsx(Vw,{order:e,onPackingComplete:g,onStatusUpdate:u}),a==="picker"&&s.jsx(Gw,{order:e,onPickerAssigned:m})]}),s.jsxs("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200 flex justify-between items-center",children:[s.jsxs("div",{className:"text-sm text-gray-600",children:["Last updated: ",new Date(e.updatedAt||e.createdAt).toLocaleString("en-GB",{dateStyle:"short",timeStyle:"short"})]}),s.jsx("button",{onClick:r,className:"px-6 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium rounded-lg transition-all duration-200 shadow-sm hover:shadow-md",children:"Close"})]})]})})}const Zw={pending:"bg-gradient-to-r from-yellow-400 to-yellow-500 text-gray-900",confirmed:"bg-gradient-to-r from-blue-500 to-blue-600 text-white",assigned_picker:"bg-gradient-to-r from-purple-500 to-purple-600 text-white",picking:"bg-gradient-to-r from-purple-600 to-purple-700 text-white",picked:"bg-gradient-to-r from-purple-700 to-purple-800 text-white",packing:"bg-gradient-to-r from-indigo-500 to-indigo-600 text-white",ready_for_pickup:"bg-gradient-to-r from-teal-500 to-teal-600 text-white",preparing:"bg-gradient-to-r from-orange-500 to-orange-600 text-white",ready:"bg-gradient-to-r from-green-600 to-green-700 text-white","out-for-delivery":"bg-gradient-to-r from-blue-600 to-blue-700 text-white",delivered:"bg-gradient-to-r from-green-700 to-green-800 text-white",completed:"bg-gradient-to-r from-gray-700 to-gray-800 text-white",cancelled:"bg-gradient-to-r from-red-500 to-red-600 text-white"},tu={pending:"Pending",confirmed:"Confirmed",assigned_picker:"Picker Assigned",picking:"Picking Items",picked:"Items Picked",packing:"Packing",ready_for_pickup:"Ready for Pickup",preparing:"Preparing",ready:"Ready","out-for-delivery":"Out for Delivery",delivered:"Delivered",completed:"Completed",cancelled:"Cancelled"};function Qw(){const[e,r]=Te.useState([]),[t,n]=Te.useState(!0),[a,i]=Te.useState(null),[o,l]=Te.useState(!1),[c,h]=Te.useState({status:"",search:"",page:1,limit:20}),[u,g]=Te.useState({total:0,pages:0,currentPage:1});Te.useEffect(()=>{m()},[c]);const m=async()=>{try{n(!0);const N=await Ir.getOrders(c);N.success&&(r(N.data.orders),g(N.data.pagination))}catch(N){console.error("Error fetching orders:",N)}finally{n(!1)}},d=N=>{h({...c,status:N===c.status?"":N,page:1})},y=N=>{h({...c,search:N.target.value,page:1})},x=async N=>{try{const w=await Ir.getOrder(N);w.success&&(i(w.data.order),l(!0))}catch(w){console.error("Error fetching order details:",w)}},b=async(N,w,A="")=>{var E,W;try{if((await Ir.updateOrderStatus(N,{status:w,note:A})).success&&(m(),a&&a._id===N)){const F=await Ir.getOrder(N);F.success&&i(F.data.order)}}catch(V){console.error("Error updating order status:",V),alert(((W=(E=V.response)==null?void 0:E.data)==null?void 0:W.message)||"Failed to update order status")}};return s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h1",{className:"text-3xl font-bold text-afri-gray-900",children:"Orders"}),s.jsx("p",{className:"text-afri-gray-600 mt-1",children:"Manage and track all your orders"})]}),s.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:s.jsxs("div",{className:"flex flex-wrap gap-4",children:[s.jsx("div",{className:"flex-1 min-w-[250px]",children:s.jsx("input",{type:"text",placeholder:"Search by order number...",value:c.search,onChange:y,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent"})}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[["pending","confirmed","preparing","ready","out-for-delivery","delivered"].map(N=>s.jsx("button",{onClick:()=>d(N),className:`px-4 py-2 rounded-lg font-medium transition ${c.status===N?"bg-afri-green text-white":"bg-afri-gray-50 text-afri-gray-700 hover:bg-afri-gray-100"}`,children:tu[N]},N)),c.status&&s.jsx("button",{onClick:()=>h({...c,status:""}),className:"px-4 py-2 rounded-lg font-medium bg-red-100 text-red-700 hover:bg-red-200",children:"Clear Filter"})]})]})}),t?s.jsx("div",{className:"flex justify-center items-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-afri-green"})}):e.length===0?s.jsxs("div",{className:"bg-white rounded-lg shadow p-12 text-center",children:[s.jsx("svg",{className:"w-16 h-16 text-afri-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),s.jsx("h3",{className:"text-lg font-medium text-afri-gray-900 mb-1",children:"No orders found"}),s.jsx("p",{className:"text-afri-gray-500",children:c.status||c.search?"Try adjusting your filters":"Orders will appear here"})]}):s.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-afri-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Order Number"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Customer"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Items"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Total"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Date"}),s.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-afri-gray-700 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(N=>{var w,A,E,W,V;return s.jsxs("tr",{className:"hover:bg-afri-gray-50 transition",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("div",{className:"text-sm font-medium text-afri-gray-900",children:N.orderNumber})}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[s.jsx("div",{className:"text-sm text-afri-gray-900",children:((w=N.customer)==null?void 0:w.name)||"N/A"}),s.jsx("div",{className:"text-sm text-afri-gray-500",children:((A=N.customer)==null?void 0:A.phone)||""})]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"text-sm text-afri-gray-900",children:[((E=N.items)==null?void 0:E.length)||0," items"]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"text-sm font-medium text-afri-gray-900",children:["Â£",((V=(W=N.pricing)==null?void 0:W.total)==null?void 0:V.toFixed(2))||"0.00"]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${Zw[N.status]}`,children:tu[N.status]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-afri-gray-500",children:new Date(N.createdAt).toLocaleDateString()}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:s.jsx("button",{onClick:()=>x(N._id),className:"text-afri-green hover:text-afri-green-dark font-medium",children:"View Details"})})]},N._id)})})]})}),u.pages>1&&s.jsx("div",{className:"mt-6 flex justify-center",children:s.jsx("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[...Array(u.pages)].map((N,w)=>s.jsx("button",{onClick:()=>h({...c,page:w+1}),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${u.currentPage===w+1?"z-10 bg-afri-green text-white border-afri-green":"bg-white border-gray-300 text-afri-gray-700 hover:bg-afri-gray-50"}`,children:w+1},w))})}),o&&a&&s.jsx(Jw,{order:a,onClose:()=>{l(!1),i(null)},onStatusUpdate:b,onRefresh:m})]})}const S0=[{id:"sales",name:"Sales Report",description:"Revenue, orders, and sales performance",icon:"ðŸ“Š",color:"afri-green"},{id:"inventory",name:"Inventory Report",description:"Stock levels, low stock items, and product performance",icon:"ðŸ“¦",color:"blue-600"},{id:"orders",name:"Order Report",description:"Order history, status breakdown, and delivery metrics",icon:"ðŸ“‹",color:"purple-600"},{id:"revenue",name:"Revenue Report",description:"Earnings breakdown, payment status, and financial summary",icon:"ðŸ’°",color:"afri-yellow-dark"}],e3=[{label:"Today",value:"today"},{label:"Yesterday",value:"yesterday"},{label:"Last 7 Days",value:"week"},{label:"Last 30 Days",value:"month"},{label:"This Month",value:"thisMonth"},{label:"Last Month",value:"lastMonth"},{label:"Custom Range",value:"custom"}];function t3(){const[e,r]=Te.useState(null),[t,n]=Te.useState("week"),[a,i]=Te.useState(""),[o,l]=Te.useState(""),[c,h]=Te.useState(!1),[u,g]=Te.useState(null),[m,d]=Te.useState(!1),y=async()=>{if(!e){alert("Please select a report type");return}h(!0);try{const{startDate:w,endDate:A}=x();let E;switch(e){case"sales":E=await Ir.getSalesReport({startDate:w,endDate:A});break;case"inventory":E=await Ir.getInventoryReport();break;case"orders":E=await Ir.getOrdersReport({startDate:w,endDate:A});break;case"revenue":E=await Ir.getRevenueReport({startDate:w,endDate:A});break;default:throw new Error("Invalid report type")}E.success&&(g(E.data),d(!0))}catch(w){console.error("Error generating report:",w),alert(w.message||"Failed to generate report")}finally{h(!1)}},x=()=>{const w=new Date;let A,E;switch(t){case"today":A=new Date(w.setHours(0,0,0,0)),E=new Date(w.setHours(23,59,59,999));break;case"yesterday":A=new Date(w.setDate(w.getDate()-1)),A.setHours(0,0,0,0),E=new Date(A),E.setHours(23,59,59,999);break;case"week":A=new Date(w.setDate(w.getDate()-7)),E=new Date;break;case"month":A=new Date(w.setDate(w.getDate()-30)),E=new Date;break;case"thisMonth":A=new Date(w.getFullYear(),w.getMonth(),1),E=new Date;break;case"lastMonth":A=new Date(w.getFullYear(),w.getMonth()-1,1),E=new Date(w.getFullYear(),w.getMonth(),0);break;case"custom":A=new Date(a),E=new Date(o);break;default:A=new Date(w.setDate(w.getDate()-7)),E=new Date}return{startDate:A.toISOString(),endDate:E.toISOString()}},b=()=>{var C,R,G,j,T,B;if(!u)return;const w=new ht,A=S0.find(M=>M.id===e);w.setFontSize(20),w.setTextColor(0,178,7),w.text(A.name,14,20),w.setFontSize(10),w.setTextColor(100);const{startDate:E,endDate:W}=x();w.text(`Generated: ${new Date().toLocaleDateString()} | Period: ${new Date(E).toLocaleDateString()} - ${new Date(W).toLocaleDateString()}`,14,28);let V=40;if(e==="sales"){w.setFontSize(14),w.setTextColor(0),w.text("Summary",14,V),V+=10;const M=[["Total Revenue",`Â£${((C=u.totalRevenue)==null?void 0:C.toFixed(2))||"0.00"}`],["Total Orders",u.totalOrders||0],["Average Order Value",`Â£${((R=u.avgOrderValue)==null?void 0:R.toFixed(2))||"0.00"}`],["Total Items Sold",u.totalItemsSold||0]];if(w.autoTable({startY:V,head:[["Metric","Value"]],body:M,theme:"grid",headStyles:{fillColor:[0,178,7]}}),u.topProducts&&u.topProducts.length>0){V=w.lastAutoTable.finalY+15,w.setFontSize(14),w.text("Top Products",14,V),V+=5;const le=u.topProducts.map((J,z)=>{var ae;return[z+1,J.name,J.soldQuantity,`Â£${((ae=J.revenue)==null?void 0:ae.toFixed(2))||"0.00"}`]});w.autoTable({startY:V+5,head:[["#","Product","Qty Sold","Revenue"]],body:le,theme:"striped",headStyles:{fillColor:[0,178,7]}})}}else if(e==="inventory"){w.setFontSize(14),w.text("Stock Overview",14,V),V+=10;const M=[["Total Products",u.totalProducts||0],["In Stock",u.inStock||0],["Out of Stock",u.outOfStock||0],["Low Stock",u.lowStock||0]];if(w.autoTable({startY:V,head:[["Category","Count"]],body:M,theme:"grid",headStyles:{fillColor:[0,178,7]}}),u.lowStockItems&&u.lowStockItems.length>0){V=w.lastAutoTable.finalY+15,w.setFontSize(14),w.text("Low Stock Items",14,V),V+=5;const le=u.lowStockItems.map(J=>[J.name,J.currentStock,J.lowStockThreshold,J.status]);w.autoTable({startY:V+5,head:[["Product","Current Stock","Threshold","Status"]],body:le,theme:"striped",headStyles:{fillColor:[255,138,0]}})}}else if(e==="orders"){w.setFontSize(14),w.text("Orders Summary",14,V),V+=10;const M=[["Total Orders",u.totalOrders||0],["Completed",u.completed||0],["Pending",u.pending||0],["Cancelled",u.cancelled||0]];if(w.autoTable({startY:V,head:[["Status","Count"]],body:M,theme:"grid",headStyles:{fillColor:[0,178,7]}}),u.orders&&u.orders.length>0){V=w.lastAutoTable.finalY+15,w.setFontSize(14),w.text("Order Details",14,V),V+=5;const le=u.orders.map(J=>{var z;return[J.orderNumber,new Date(J.createdAt).toLocaleDateString(),J.status,`Â£${((z=J.total)==null?void 0:z.toFixed(2))||"0.00"}`]});w.autoTable({startY:V+5,head:[["Order #","Date","Status","Total"]],body:le,theme:"striped",headStyles:{fillColor:[0,178,7]}})}}else if(e==="revenue"){w.setFontSize(14),w.text("Revenue Summary",14,V),V+=10;const M=[["Total Revenue",`Â£${((G=u.totalRevenue)==null?void 0:G.toFixed(2))||"0.00"}`],["Paid",`Â£${((j=u.paidRevenue)==null?void 0:j.toFixed(2))||"0.00"}`],["Pending",`Â£${((T=u.pendingRevenue)==null?void 0:T.toFixed(2))||"0.00"}`],["Refunded",`Â£${((B=u.refundedRevenue)==null?void 0:B.toFixed(2))||"0.00"}`]];if(w.autoTable({startY:V,head:[["Category","Amount"]],body:M,theme:"grid",headStyles:{fillColor:[0,178,7]}}),u.dailyRevenue&&u.dailyRevenue.length>0){V=w.lastAutoTable.finalY+15,w.setFontSize(14),w.text("Daily Revenue Breakdown",14,V),V+=5;const le=u.dailyRevenue.map(J=>{var z;return[new Date(J.date).toLocaleDateString(),J.orders,`Â£${((z=J.revenue)==null?void 0:z.toFixed(2))||"0.00"}`]});w.autoTable({startY:V+5,head:[["Date","Orders","Revenue"]],body:le,theme:"striped",headStyles:{fillColor:[0,178,7]}})}}const F=w.internal.getNumberOfPages();for(let M=1;M<=F;M++)w.setPage(M),w.setFontSize(8),w.setTextColor(150),w.text(`Afrimercato - ${A.name} | Page ${M} of ${F}`,14,w.internal.pageSize.height-10);w.save(`${e}-report-${new Date().toISOString().split("T")[0]}.pdf`)},N=()=>{var E,W,V,F,C,R;if(!u)return;const w=S0.find(G=>G.id===e),A=lr.book_new();if(e==="sales"){const G=[["Metric","Value"],["Total Revenue",((E=u.totalRevenue)==null?void 0:E.toFixed(2))||"0.00"],["Total Orders",u.totalOrders||0],["Average Order Value",((W=u.avgOrderValue)==null?void 0:W.toFixed(2))||"0.00"],["Total Items Sold",u.totalItemsSold||0]],j=lr.aoa_to_sheet(G);if(lr.book_append_sheet(A,j,"Summary"),u.topProducts&&u.topProducts.length>0){const T=[["Rank","Product","Quantity Sold","Revenue"],...u.topProducts.map((M,le)=>{var J;return[le+1,M.name,M.soldQuantity,((J=M.revenue)==null?void 0:J.toFixed(2))||"0.00"]})],B=lr.aoa_to_sheet(T);lr.book_append_sheet(A,B,"Top Products")}}else if(e==="inventory"){const G=[["Category","Count"],["Total Products",u.totalProducts||0],["In Stock",u.inStock||0],["Out of Stock",u.outOfStock||0],["Low Stock",u.lowStock||0]],j=lr.aoa_to_sheet(G);if(lr.book_append_sheet(A,j,"Overview"),u.lowStockItems&&u.lowStockItems.length>0){const T=[["Product","Current Stock","Threshold","Status"],...u.lowStockItems.map(M=>[M.name,M.currentStock,M.lowStockThreshold,M.status])],B=lr.aoa_to_sheet(T);lr.book_append_sheet(A,B,"Low Stock Items")}if(u.allProducts&&u.allProducts.length>0){const T=[["Name","Category","Stock","Price","Status"],...u.allProducts.map(M=>[M.name,M.category,M.stock,M.price,M.inStock?"In Stock":"Out of Stock"])],B=lr.aoa_to_sheet(T);lr.book_append_sheet(A,B,"All Products")}}else if(e==="orders"){const G=[["Status","Count"],["Total Orders",u.totalOrders||0],["Completed",u.completed||0],["Pending",u.pending||0],["Cancelled",u.cancelled||0]],j=lr.aoa_to_sheet(G);if(lr.book_append_sheet(A,j,"Summary"),u.orders&&u.orders.length>0){const T=[["Order Number","Date","Customer","Status","Items","Total"],...u.orders.map(M=>{var le;return[M.orderNumber,new Date(M.createdAt).toLocaleDateString(),M.customerName||"N/A",M.status,M.itemsCount||0,((le=M.total)==null?void 0:le.toFixed(2))||"0.00"]})],B=lr.aoa_to_sheet(T);lr.book_append_sheet(A,B,"Orders")}}else if(e==="revenue"){const G=[["Category","Amount (Â£)"],["Total Revenue",((V=u.totalRevenue)==null?void 0:V.toFixed(2))||"0.00"],["Paid",((F=u.paidRevenue)==null?void 0:F.toFixed(2))||"0.00"],["Pending",((C=u.pendingRevenue)==null?void 0:C.toFixed(2))||"0.00"],["Refunded",((R=u.refundedRevenue)==null?void 0:R.toFixed(2))||"0.00"]],j=lr.aoa_to_sheet(G);if(lr.book_append_sheet(A,j,"Summary"),u.dailyRevenue&&u.dailyRevenue.length>0){const T=[["Date","Orders","Revenue (Â£)"],...u.dailyRevenue.map(M=>{var le;return[new Date(M.date).toLocaleDateString(),M.orders,((le=M.revenue)==null?void 0:le.toFixed(2))||"0.00"]})],B=lr.aoa_to_sheet(T);lr.book_append_sheet(A,B,"Daily Revenue")}}o1(A,`${w.name.replace(" ","-")}-${new Date().toISOString().split("T")[0]}.xlsx`)};return s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold text-afri-gray-900",children:"Reports"}),s.jsx("p",{className:"text-afri-gray-600 mt-1",children:"Generate and export business reports"})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsx("div",{className:"lg:col-span-1",children:s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-afri-gray-900 mb-4",children:"Select Report Type"}),s.jsx("div",{className:"space-y-3",children:S0.map(w=>s.jsx("button",{onClick:()=>r(w.id),className:`w-full text-left p-4 rounded-lg border-2 transition ${e===w.id?`border-${w.color} bg-${w.color} bg-opacity-10`:"border-gray-200 hover:border-gray-300"}`,children:s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-2xl mr-3",children:w.icon}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-afri-gray-900",children:w.name}),s.jsx("p",{className:"text-sm text-afri-gray-600 mt-1",children:w.description})]})]})},w.id))})]})}),s.jsx("div",{className:"lg:col-span-2",children:s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-afri-gray-900 mb-4",children:"Report Configuration"}),e?s.jsxs("div",{className:"space-y-6",children:[e!=="inventory"&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-afri-gray-700 mb-2",children:"Date Range"}),s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:e3.map(w=>s.jsx("button",{onClick:()=>n(w.value),className:`px-4 py-2 rounded-lg font-medium transition ${t===w.value?"bg-afri-green text-white":"bg-afri-gray-50 text-afri-gray-700 hover:bg-afri-gray-100"}`,children:w.label},w.value))}),t==="custom"&&s.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-afri-gray-700 mb-1",children:"Start Date"}),s.jsx("input",{type:"date",value:a,onChange:w=>i(w.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-afri-gray-700 mb-1",children:"End Date"}),s.jsx("input",{type:"date",value:o,onChange:w=>l(w.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green focus:border-transparent"})]})]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:y,disabled:c,className:"flex-1 bg-afri-green text-white px-6 py-3 rounded-lg font-semibold hover:bg-afri-green-dark transition disabled:opacity-50 disabled:cursor-not-allowed",children:c?s.jsxs("span",{className:"flex items-center justify-center",children:[s.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generating..."]}):"Generate Report"}),u&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:b,className:"bg-red-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-red-700 transition",children:"Export PDF"}),s.jsx("button",{onClick:N,className:"bg-green-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-green-700 transition",children:"Export Excel"})]})]}),m&&u&&s.jsxs("div",{className:"mt-6 border-t pt-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-afri-gray-900 mb-4",children:"Report Preview"}),s.jsx("div",{className:"bg-afri-gray-50 rounded-lg p-6",children:s.jsx("pre",{className:"text-sm text-afri-gray-700 whitespace-pre-wrap",children:JSON.stringify(u,null,2)})})]})]}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx("svg",{className:"w-16 h-16 text-afri-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),s.jsx("p",{className:"text-afri-gray-600",children:"Select a report type to get started"})]})]})})]})]})}function r3(){const{user:e}=Uo(),[r,t]=Te.useState("profile"),[n,a]=Te.useState(null),[i,o]=Te.useState(!0),l=[{id:"profile",name:"Vendor Profile",icon:"ðŸª"},{id:"account",name:"Account Settings",icon:"ðŸ‘¤"},{id:"notifications",name:"Notifications",icon:"ðŸ””"}];Te.useEffect(()=>{c()},[]);const c=async()=>{try{const h=await Ir.getProfile();h.data.success&&a(h.data.data.vendor)}catch{console.log("No vendor profile found")}finally{o(!1)}};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Settings"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your account and preferences"})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm",children:[s.jsx("div",{className:"border-b border-gray-200",children:s.jsx("nav",{className:"flex space-x-8 px-6","aria-label":"Tabs",children:l.map(h=>s.jsxs("button",{onClick:()=>t(h.id),className:`py-4 px-1 border-b-2 font-medium text-sm transition ${r===h.id?"border-afri-green text-afri-green":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[s.jsx("span",{className:"mr-2",children:h.icon}),h.name]},h.id))})}),s.jsx("div",{className:"p-6",children:i?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-afri-green"})}):s.jsxs(s.Fragment,{children:[r==="profile"&&s.jsx(n3,{vendorProfile:n,onUpdate:c}),r==="account"&&s.jsx(a3,{user:e}),r==="notifications"&&s.jsx(i3,{})]})})]})]})}function n3({vendorProfile:e,onUpdate:r}){var m,d,y,x;const[t,n]=Te.useState({storeName:(e==null?void 0:e.storeName)||"",description:(e==null?void 0:e.description)||"",category:(e==null?void 0:e.category)||"fresh-produce",phone:(e==null?void 0:e.phone)||"",address:{street:((m=e==null?void 0:e.address)==null?void 0:m.street)||"",city:((d=e==null?void 0:e.address)==null?void 0:d.city)||"",state:((y=e==null?void 0:e.address)==null?void 0:y.state)||"",country:((x=e==null?void 0:e.address)==null?void 0:x.country)||"Nigeria"}}),[a,i]=Te.useState(!1),[o,l]=Te.useState(!1),[c,h]=Te.useState(""),u=b=>{const{name:N,value:w}=b.target;if(N.startsWith("address.")){const A=N.split(".")[1];n({...t,address:{...t.address,[A]:w}})}else n({...t,[N]:w})},g=async b=>{var N,w;b.preventDefault(),i(!0),h(""),l(!1);try{e?await Ir.updateProfile(t):await Ir.createProfile(t),l(!0),r(),setTimeout(()=>l(!1),3e3)}catch(A){h(((w=(N=A.response)==null?void 0:N.data)==null?void 0:w.message)||"Failed to save profile")}finally{i(!1)}};return s.jsxs("form",{onSubmit:g,className:"space-y-6",children:[o&&s.jsx("div",{className:"bg-green-50 border-l-4 border-green-500 p-4 rounded",children:s.jsx("p",{className:"text-green-700",children:"Profile updated successfully!"})}),c&&s.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded",children:s.jsx("p",{className:"text-red-700",children:c})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Store Name"}),s.jsx("input",{type:"text",name:"storeName",required:!0,value:t.storeName,onChange:u,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green",placeholder:"My Fresh Store"})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),s.jsx("textarea",{name:"description",required:!0,rows:4,value:t.description,onChange:u,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green",placeholder:"Tell customers about your store..."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),s.jsxs("select",{name:"category",value:t.category,onChange:u,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green",children:[s.jsx("option",{value:"fresh-produce",children:"Fresh Produce"}),s.jsx("option",{value:"groceries",children:"Groceries"}),s.jsx("option",{value:"meat-fish",children:"Meat & Fish"}),s.jsx("option",{value:"bakery",children:"Bakery"}),s.jsx("option",{value:"dairy",children:"Dairy"}),s.jsx("option",{value:"beverages",children:"Beverages"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone"}),s.jsx("input",{type:"tel",name:"phone",required:!0,value:t.phone,onChange:u,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green",placeholder:"+234-800-555-0000"})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Street Address"}),s.jsx("input",{type:"text",name:"address.street",required:!0,value:t.address.street,onChange:u,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green",placeholder:"123 Market Street"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City"}),s.jsx("input",{type:"text",name:"address.city",required:!0,value:t.address.city,onChange:u,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green",placeholder:"Lagos"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"State"}),s.jsx("input",{type:"text",name:"address.state",required:!0,value:t.address.state,onChange:u,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-afri-green",placeholder:"Lagos"})]})]}),s.jsx("div",{className:"flex justify-end",children:s.jsx("button",{type:"submit",disabled:a,className:"px-6 py-2 bg-afri-green text-white rounded-lg hover:bg-afri-green-dark transition font-medium disabled:opacity-50",children:a?"Saving...":"Save Changes"})})]})}function a3({user:e}){const[r,t]=Te.useState({name:(e==null?void 0:e.name)||"",email:(e==null?void 0:e.email)||""});return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Account Information"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name"}),s.jsx("input",{type:"text",value:r.name,readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),s.jsx("input",{type:"email",value:r.email,readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-50"})]})]})]}),s.jsxs("div",{className:"border-t pt-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Change Password"}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:'To change your password, please contact support or use the "Forgot Password" option on the login page.'}),s.jsx("button",{className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition font-medium",children:"Contact Support"})]})]})]})}function i3(){const[e,r]=Te.useState({emailOrders:!0,emailPromotions:!1,smsOrders:!0,pushNotifications:!0}),t=n=>{r({...e,[n]:!e[n]})};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Notification Preferences"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:"Order Notifications (Email)"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Receive email updates about new orders"})]}),s.jsx("button",{onClick:()=>t("emailOrders"),className:`relative inline-flex h-6 w-11 items-center rounded-full transition ${e.emailOrders?"bg-afri-green":"bg-gray-300"}`,children:s.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition ${e.emailOrders?"translate-x-6":"translate-x-1"}`})})]}),s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:"Promotional Emails"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Receive offers and promotions"})]}),s.jsx("button",{onClick:()=>t("emailPromotions"),className:`relative inline-flex h-6 w-11 items-center rounded-full transition ${e.emailPromotions?"bg-afri-green":"bg-gray-300"}`,children:s.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition ${e.emailPromotions?"translate-x-6":"translate-x-1"}`})})]}),s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:"SMS Notifications"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Receive SMS for important updates"})]}),s.jsx("button",{onClick:()=>t("smsOrders"),className:`relative inline-flex h-6 w-11 items-center rounded-full transition ${e.smsOrders?"bg-afri-green":"bg-gray-300"}`,children:s.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition ${e.smsOrders?"translate-x-6":"translate-x-1"}`})})]}),s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:"Push Notifications"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Receive push notifications on your device"})]}),s.jsx("button",{onClick:()=>t("pushNotifications"),className:`relative inline-flex h-6 w-11 items-center rounded-full transition ${e.pushNotifications?"bg-afri-green":"bg-gray-300"}`,children:s.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition ${e.pushNotifications?"translate-x-6":"translate-x-1"}`})})]})]})]}),s.jsx("div",{className:"flex justify-end",children:s.jsx("button",{className:"px-6 py-2 bg-afri-green text-white rounded-lg hover:bg-afri-green-dark transition font-medium",children:"Save Preferences"})})]})}function s3(){const[e,r]=Te.useState([]),[t,n]=Te.useState(null),[a,i]=Te.useState(!0),[o,l]=Te.useState("");Te.useEffect(()=>{c()},[]);const c=async()=>{var g,m,d;try{const[y,x]=await Promise.all([i0.getPlans(),i0.getMySubscription().catch(()=>({data:{data:null}}))]);y.data.success&&r(y.data.data.plans||[]),(g=x.data)!=null&&g.data&&n(x.data.data)}catch(y){l(((d=(m=y.response)==null?void 0:m.data)==null?void 0:d.message)||"Failed to load subscription data")}finally{i(!1)}},h=async g=>{var m,d;try{await i0.subscribe({planId:g}),c(),alert("Subscription upgraded successfully!")}catch(y){alert(((d=(m=y.response)==null?void 0:m.data)==null?void 0:d.message)||"Failed to subscribe")}};if(a)return s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-afri-green"})});const u=t==null?void 0:t.plan;return s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-4xl font-bold text-gray-900",children:"Choose Your Plan"}),s.jsx("p",{className:"text-gray-600 mt-3 text-lg",children:"Unlock premium features for your Afrimercato marketplace"})]}),t&&s.jsxs("div",{className:"bg-gradient-to-r from-afri-green to-afri-green-dark rounded-xl p-6 text-white text-center",children:[s.jsx("p",{className:"text-sm font-medium mb-1",children:"CURRENT PLAN"}),s.jsxs("p",{className:"text-3xl font-bold capitalize",children:[t.plan," Plan"]}),t.endDate&&s.jsxs("p",{className:"text-sm mt-2 opacity-90",children:["Valid until ",new Date(t.endDate).toLocaleDateString()]})]}),o&&s.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded",children:s.jsx("p",{className:"text-red-700",children:o})}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:e.map(g=>{var y,x;const m=g.id===u,d=!m&&!o3(u,g.id);return s.jsxs("div",{className:`relative bg-white rounded-2xl shadow-lg overflow-hidden transition-all hover:shadow-2xl ${g.id==="premium"?"border-4 border-afri-yellow scale-105":"border border-gray-200"}`,children:[g.id==="premium"&&s.jsx("div",{className:"absolute top-0 right-0 bg-afri-yellow text-gray-900 px-4 py-1 text-xs font-bold rounded-bl-lg",children:"RECOMMENDED"}),m&&s.jsx("div",{className:"absolute top-0 left-0 bg-afri-green text-white px-4 py-1 text-xs font-bold rounded-br-lg",children:"CURRENT PLAN"}),s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"text-4xl mb-4",children:[g.id==="free"&&"ðŸŒ±",g.id==="standard"&&"ðŸš€",g.id==="premium"&&"â­",g.id==="enterprise"&&"ðŸ‘‘"]}),s.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:g.name}),s.jsx("div",{className:"mb-6",children:typeof g.price=="number"?s.jsxs(s.Fragment,{children:[s.jsxs("span",{className:"text-4xl font-bold text-afri-green",children:["Â£",g.price.toLocaleString()]}),s.jsx("span",{className:"text-gray-600 ml-2",children:"/month"})]}):s.jsx("span",{className:"text-2xl font-bold text-gray-900",children:g.price})}),s.jsxs("div",{className:"space-y-3 mb-6",children:[s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-green-500 mr-2",children:"âœ“"}),s.jsxs("span",{className:"text-sm text-gray-600",children:[g.features.maxProducts==="unlimited"?"Unlimited":g.features.maxProducts," products"]})]}),s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-green-500 mr-2",children:"âœ“"}),s.jsxs("span",{className:"text-sm text-gray-600",children:[g.features.maxMonthlyOrders==="unlimited"?"Unlimited":g.features.maxMonthlyOrders," orders/month"]})]}),(y=g.features.jumiaIntegration)!=null&&y.enabled?s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-green-500 mr-2",children:"âœ“"}),s.jsxs("span",{className:"text-sm text-gray-600",children:["Marketplace ",g.features.jumiaIntegration.tier==="premium"?"Premium":"Standard"]})]}):s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-gray-400 mr-2",children:"âœ—"}),s.jsx("span",{className:"text-sm text-gray-400",children:"No marketplace features"})]}),(x=g.features.kongaIntegration)!=null&&x.enabled?s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-green-500 mr-2",children:"âœ“"}),s.jsxs("span",{className:"text-sm text-gray-600",children:["Advanced ",g.features.kongaIntegration.tier==="premium"?"Premium":"Standard"]})]}):s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-gray-400 mr-2",children:"âœ—"}),s.jsx("span",{className:"text-sm text-gray-400",children:"No advanced features"})]}),s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-green-500 mr-2",children:"âœ“"}),s.jsxs("span",{className:"text-sm text-gray-600",children:[g.features.commissionRate,"% commission"]})]}),s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-green-500 mr-2",children:"âœ“"}),s.jsxs("span",{className:"text-sm text-gray-600",children:[g.features.analytics," analytics"]})]}),s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-green-500 mr-2",children:"âœ“"}),s.jsxs("span",{className:"text-sm text-gray-600",children:[g.features.customerSupport," support"]})]})]}),m?s.jsx("button",{disabled:!0,className:"w-full py-3 bg-gray-200 text-gray-500 rounded-lg font-semibold cursor-not-allowed",children:"Current Plan"}):s.jsx("button",{onClick:()=>h(g.id),className:`w-full py-3 rounded-lg font-semibold transition ${g.id==="premium"?"bg-gradient-to-r from-afri-yellow to-yellow-500 text-gray-900 hover:from-yellow-500 hover:to-afri-yellow":"bg-afri-green text-white hover:bg-afri-green-dark"}`,children:d?"Upgrade Now":"Get Started"})]}),g.id==="premium"&&s.jsxs("div",{className:"bg-gradient-to-r from-afri-yellow to-yellow-500 p-4",children:[s.jsx("p",{className:"text-xs font-bold text-gray-900 mb-2",children:"PREMIUM FEATURES:"}),s.jsxs("ul",{className:"text-xs text-gray-900 space-y-1",children:[s.jsx("li",{children:"â€¢ 5 promotional spots/month on Afrimercato"}),s.jsx("li",{children:"â€¢ 10 featured products simultaneously"}),s.jsx("li",{children:"â€¢ Flash sale access"}),s.jsx("li",{children:"â€¢ Dedicated account manager"}),s.jsx("li",{children:"â€¢ Priority 24/7 support"})]})]})]},g.id)})}),s.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6 text-center",children:"Marketplace Integration Comparison"}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b-2 border-gray-200",children:[s.jsx("th",{className:"py-3 px-4 text-left text-sm font-semibold text-gray-900",children:"Feature"}),s.jsx("th",{className:"py-3 px-4 text-center text-sm font-semibold text-gray-900",children:"Standard"}),s.jsx("th",{className:"py-3 px-4 text-center text-sm font-semibold text-gray-900 bg-afri-yellow bg-opacity-10",children:"Premium"})]})}),s.jsxs("tbody",{className:"divide-y divide-gray-200",children:[s.jsxs("tr",{children:[s.jsx("td",{className:"py-3 px-4 text-sm text-gray-700",children:"Product Listing"}),s.jsx("td",{className:"py-3 px-4 text-center text-green-600",children:"âœ“"}),s.jsx("td",{className:"py-3 px-4 text-center text-green-600 bg-afri-yellow bg-opacity-5",children:"âœ“"})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"py-3 px-4 text-sm text-gray-700",children:"Inventory Sync"}),s.jsx("td",{className:"py-3 px-4 text-center text-green-600",children:"âœ“"}),s.jsx("td",{className:"py-3 px-4 text-center text-green-600 bg-afri-yellow bg-opacity-5",children:"âœ“"})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"py-3 px-4 text-sm text-gray-700",children:"Order Management"}),s.jsx("td",{className:"py-3 px-4 text-center text-green-600",children:"âœ“"}),s.jsx("td",{className:"py-3 px-4 text-center text-green-600 bg-afri-yellow bg-opacity-5",children:"âœ“"})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"py-3 px-4 text-sm text-gray-700",children:"Promotional Spots"}),s.jsx("td",{className:"py-3 px-4 text-center text-gray-400",children:"âœ—"}),s.jsx("td",{className:"py-3 px-4 text-center text-green-600 bg-afri-yellow bg-opacity-5",children:"5/month"})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"py-3 px-4 text-sm text-gray-700",children:"Featured Products"}),s.jsx("td",{className:"py-3 px-4 text-center text-gray-400",children:"âœ—"}),s.jsx("td",{className:"py-3 px-4 text-center text-green-600 bg-afri-yellow bg-opacity-5",children:"10 items"})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"py-3 px-4 text-sm text-gray-700",children:"Flash Sales"}),s.jsx("td",{className:"py-3 px-4 text-center text-gray-400",children:"âœ—"}),s.jsx("td",{className:"py-3 px-4 text-center text-green-600 bg-afri-yellow bg-opacity-5",children:"âœ“"})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"py-3 px-4 text-sm text-gray-700",children:"Category Placement"}),s.jsx("td",{className:"py-3 px-4 text-center text-gray-600",children:"Standard"}),s.jsx("td",{className:"py-3 px-4 text-center text-green-600 bg-afri-yellow bg-opacity-5",children:"Premium"})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"py-3 px-4 text-sm text-gray-700",children:"Commission Rate"}),s.jsx("td",{className:"py-3 px-4 text-center text-gray-600",children:"8%"}),s.jsx("td",{className:"py-3 px-4 text-center text-green-600 font-semibold bg-afri-yellow bg-opacity-5",children:"6%"})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"py-3 px-4 text-sm text-gray-700",children:"Account Manager"}),s.jsx("td",{className:"py-3 px-4 text-center text-gray-400",children:"âœ—"}),s.jsx("td",{className:"py-3 px-4 text-center text-green-600 bg-afri-yellow bg-opacity-5",children:"âœ“"})]})]})]})})]}),s.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Frequently Asked Questions"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("details",{className:"group",children:[s.jsx("summary",{className:"cursor-pointer font-semibold text-gray-900 py-3 border-b border-gray-200",children:"Can I upgrade or downgrade my plan anytime?"}),s.jsx("p",{className:"text-gray-600 text-sm mt-3",children:"Yes, you can upgrade or downgrade your plan at any time. Changes take effect immediately."})]}),s.jsxs("details",{className:"group",children:[s.jsx("summary",{className:"cursor-pointer font-semibold text-gray-900 py-3 border-b border-gray-200",children:"What payment methods do you accept?"}),s.jsx("p",{className:"text-gray-600 text-sm mt-3",children:"We accept all major payment methods including cards, bank transfers, and mobile money."})]}),s.jsxs("details",{className:"group",children:[s.jsx("summary",{className:"cursor-pointer font-semibold text-gray-900 py-3 border-b border-gray-200",children:"How does the marketplace integration work?"}),s.jsx("p",{className:"text-gray-600 text-sm mt-3",children:"Once subscribed, your products are automatically listed on the Afrimercato marketplace with enhanced visibility. All orders are managed directly in your vendor dashboard with real-time sync."})]})]})]})]})}function o3(e,r){if(!e)return!0;const t=["free","standard","premium","enterprise"];return t.indexOf(e)>=t.indexOf(r)}function l3({title:e,titleId:r,...t},n){return Te.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?Te.createElement("title",{id:r},e):null,Te.createElement("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25ZM12.75 6a.75.75 0 0 0-1.5 0v6c0 .414.336.75.75.75h4.5a.75.75 0 0 0 0-1.5h-3.75V6Z",clipRule:"evenodd"}))}const h1=Te.forwardRef(l3);function c3({title:e,titleId:r,...t},n){return Te.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?Te.createElement("title",{id:r},e):null,Te.createElement("path",{fillRule:"evenodd",d:"M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z",clipRule:"evenodd"}))}const u1=Te.forwardRef(c3);function f3({title:e,titleId:r,...t},n){return Te.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?Te.createElement("title",{id:r},e):null,Te.createElement("path",{fillRule:"evenodd",d:"m11.54 22.351.07.04.028.016a.76.76 0 0 0 .723 0l.028-.015.071-.041a16.975 16.975 0 0 0 1.144-.742 19.58 19.58 0 0 0 2.683-2.282c1.944-1.99 3.963-4.98 3.963-8.827a8.25 8.25 0 0 0-16.5 0c0 3.846 2.02 6.837 3.963 8.827a19.58 19.58 0 0 0 2.682 2.282 16.975 16.975 0 0 0 1.145.742ZM12 13.5a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z",clipRule:"evenodd"}))}const q0=Te.forwardRef(f3);function h3({title:e,titleId:r,...t},n){return Te.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?Te.createElement("title",{id:r},e):null,Te.createElement("path",{fillRule:"evenodd",d:"M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z",clipRule:"evenodd"}))}const d1=Te.forwardRef(h3);function u3(){const e=Cs(),[r,t]=Te.useState(""),[n,a]=Te.useState(!1),i=[{id:1,name:"Green Valley Farms",category:"Fresh Produce",image:"https://images.unsplash.com/photo-1542838132-92c53300491e?w=600",rating:4.8,deliveryTime:"20-30 min",minOrder:"Â£10",tags:["Vegetables","Fruits","Organic"]},{id:2,name:"African Spice Market",category:"African Groceries",image:"https://images.unsplash.com/photo-1488459716781-31db52582fe9?w=600",rating:4.9,deliveryTime:"25-35 min",minOrder:"Â£15",tags:["Spices","Grains","Authentic"]},{id:3,name:"Fresh Meat & Fish",category:"Butcher & Seafood",image:"https://images.unsplash.com/photo-1607623814075-e51df1bdc82f?w=600",rating:4.7,deliveryTime:"30-40 min",minOrder:"Â£20",tags:["Halal","Fresh Fish","Quality"]},{id:4,name:"Daily Dairy",category:"Dairy & Bakery",image:"https://images.unsplash.com/photo-1563636619-e9143da7973b?w=600",rating:4.6,deliveryTime:"15-25 min",minOrder:"Â£8",tags:["Milk","Cheese","Bread"]},{id:5,name:"Tropical Fruits Hub",category:"Exotic Fruits",image:"https://images.unsplash.com/photo-1619566636858-adf3ef46400b?w=600",rating:4.8,deliveryTime:"20-30 min",minOrder:"Â£12",tags:["Plantain","Mango","Yam"]},{id:6,name:"Lagos Kitchen Store",category:"Nigerian Foods",image:"https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=600",rating:4.9,deliveryTime:"25-35 min",minOrder:"Â£15",tags:["Nigerian","Palm Oil","Cassava"]}],o=l=>{l.preventDefault(),r.trim()&&e(`/stores?location=${encodeURIComponent(r)}`)};return s.jsxs("div",{className:"min-h-screen bg-white",children:[s.jsx("nav",{className:"bg-white border-b border-gray-200 sticky top-0 z-50 shadow-sm",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:[s.jsxs("div",{className:"flex justify-between items-center h-16",children:[s.jsxs(St,{to:"/",className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-green-600 to-yellow-500 rounded-lg flex items-center justify-center",children:s.jsx("span",{className:"text-white font-bold text-lg",children:"ðŸ›’"})}),s.jsxs("span",{className:"text-xl font-bold text-gray-900",children:["Afri",s.jsx("span",{className:"text-green-600",children:"Hub"})]})]}),s.jsxs("div",{className:"hidden md:flex items-center space-x-6",children:[s.jsx("a",{href:"#stores",className:"text-gray-600 hover:text-green-600",children:"Browse Stores"}),s.jsx("a",{href:"#how-it-works",className:"text-gray-600 hover:text-green-600",children:"How It Works"}),s.jsx(St,{to:"/partner",className:"text-gray-600 hover:text-green-600",children:"Partner With Us"}),s.jsx(St,{to:"/login",className:"text-green-600 hover:text-green-700 font-medium",children:"Sign In"}),s.jsx(St,{to:"/register?role=customer",className:"bg-green-600 hover:bg-green-700 text-white px-5 py-2 rounded-lg font-medium",children:"Sign Up"})]}),s.jsx("button",{onClick:()=>a(!n),className:"md:hidden p-2",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:n?"M6 18L18 6M6 6l12 12":"M4 6h16M4 12h16M4 18h16"})})})]}),n&&s.jsxs("div",{className:"md:hidden py-4 border-t",children:[s.jsx("a",{href:"#stores",className:"block py-2 text-gray-600",children:"Browse Stores"}),s.jsx("a",{href:"#how-it-works",className:"block py-2 text-gray-600",children:"How It Works"}),s.jsx(St,{to:"/partner",className:"block py-2 text-gray-600",children:"Partner With Us"}),s.jsx(St,{to:"/login",className:"block py-2 text-green-600 font-medium",children:"Sign In"}),s.jsx(St,{to:"/register?role=customer",className:"block mt-2 bg-green-600 text-white px-4 py-2 rounded-lg text-center font-medium",children:"Sign Up"})]})]})}),s.jsxs("section",{className:"relative bg-gradient-to-br from-green-600 via-green-700 to-yellow-500 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 opacity-10",children:s.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.4'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}})}),s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 py-16 sm:py-24 relative",children:s.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 items-center",children:[s.jsxs("div",{className:"text-center lg:text-left",children:[s.jsxs(Ct.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-4xl sm:text-5xl lg:text-6xl font-bold text-white mb-6 leading-tight",children:["African Online Store",s.jsx("br",{}),s.jsx("span",{className:"text-yellow-300",children:"In the United Kingdom"})]}),s.jsx(Ct.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"text-lg sm:text-xl text-white/95 mb-8 max-w-2xl mx-auto lg:mx-0",children:"Use existing infrastructure of African products you depend on delivered to your doorstep. Open stores, fresh products delivered to you whenever convenient."}),s.jsxs(Ct.form,{onSubmit:o,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-2xl shadow-2xl p-3 flex flex-col sm:flex-row gap-3 max-w-2xl mx-auto lg:mx-0",children:[s.jsxs("div",{className:"flex-1 flex items-center gap-3 bg-gray-50 rounded-xl px-4 py-3",children:[s.jsx(q0,{className:"w-6 h-6 text-green-600 flex-shrink-0"}),s.jsx("input",{type:"text",value:r,onChange:l=>t(l.target.value),placeholder:"Enter your location (e.g., London, Manchester)",className:"flex-1 bg-transparent border-none outline-none text-gray-900 placeholder-gray-500"})]}),s.jsxs("button",{type:"submit",className:"bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white px-8 py-3 rounded-xl font-bold shadow-lg flex items-center justify-center gap-2 transition-all",children:[s.jsx(u1,{className:"w-5 h-5"}),"Find Store"]})]}),s.jsxs(Ct.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"mt-6 text-white/90 flex items-center justify-center lg:justify-start gap-2",children:[s.jsx("span",{className:"text-2xl",children:"ðŸ‘¥"}),s.jsxs("span",{className:"font-semibold",children:["Trusted by: ",s.jsx("span",{className:"text-yellow-300",children:"4,320+ Vendors"})]})]})]}),s.jsx(Ct.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2},className:"hidden lg:block",children:s.jsx("img",{src:"https://images.unsplash.com/photo-1567393537607-1e1a6df6763a?w=800",alt:"Happy customer with groceries",className:"rounded-3xl shadow-2xl w-full object-cover"})})]})})]}),s.jsx("section",{className:"py-8 bg-gray-50 border-b",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4",children:s.jsx("div",{className:"flex gap-4 overflow-x-auto pb-2 scrollbar-hide",children:[{icon:"ðŸ¥¬",name:"Vegetables",color:"bg-green-100 text-green-700"},{icon:"ðŸŒ",name:"Fruits",color:"bg-yellow-100 text-yellow-700"},{icon:"ðŸ¥©",name:"Meat & Fish",color:"bg-red-100 text-red-700"},{icon:"ðŸ¥›",name:"Dairy",color:"bg-blue-100 text-blue-700"},{icon:"ðŸŒ¶ï¸",name:"Spices",color:"bg-orange-100 text-orange-700"},{icon:"ðŸŒ¾",name:"Grains",color:"bg-amber-100 text-amber-700"}].map((l,c)=>s.jsxs("button",{className:`${l.color} px-6 py-3 rounded-xl font-semibold whitespace-nowrap flex items-center gap-2 hover:scale-105 transition-transform`,children:[s.jsx("span",{className:"text-2xl",children:l.icon}),l.name]},c))})})}),s.jsx("section",{id:"stores",className:"py-16",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:[s.jsxs("div",{className:"flex justify-between items-center mb-8",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-2",children:"Browse Nearby"}),s.jsx("p",{className:"text-gray-600",children:"Popular stores in your area"})]}),s.jsxs("div",{className:"flex gap-4",children:[s.jsx("button",{className:"px-4 py-2 bg-green-600 text-white rounded-lg font-semibold",children:"Top Stores"}),s.jsx("button",{className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg font-semibold hover:bg-gray-200",children:"Featured Stores"})]})]}),s.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map(l=>s.jsxs(Ct.div,{whileHover:{y:-5},className:"bg-white rounded-2xl shadow-lg hover:shadow-xl border border-gray-100 overflow-hidden cursor-pointer transition-all",onClick:()=>e(`/store/${l.id}`),children:[s.jsxs("div",{className:"relative h-48",children:[s.jsx("img",{src:l.image,alt:l.name,className:"w-full h-full object-cover"}),s.jsxs("div",{className:"absolute top-3 right-3 bg-white px-3 py-1 rounded-full shadow-md flex items-center gap-1",children:[s.jsx(d1,{className:"w-4 h-4 text-yellow-500"}),s.jsx("span",{className:"font-bold text-gray-900",children:l.rating})]})]}),s.jsxs("div",{className:"p-5",children:[s.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:l.name}),s.jsx("p",{className:"text-sm text-gray-600 mb-3",children:l.category}),s.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:l.tags.slice(0,3).map((c,h)=>s.jsx("span",{className:"bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-xs font-medium",children:c},h))}),s.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 pt-3 border-t",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(h1,{className:"w-4 h-4"}),s.jsx("span",{children:l.deliveryTime})]}),s.jsxs("div",{className:"font-semibold text-gray-900",children:["Min. ",l.minOrder]})]})]})]},l.id))}),s.jsx("div",{className:"text-center mt-10",children:s.jsx("button",{className:"bg-green-600 hover:bg-green-700 text-white px-8 py-3 rounded-xl font-bold shadow-lg",children:"View All Stores"})})]})}),s.jsx("section",{id:"how-it-works",className:"py-16 bg-gradient-to-br from-green-50 to-yellow-50",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[s.jsxs("div",{className:"text-center mb-12",children:[s.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-2",children:"How It Works"}),s.jsx("p",{className:"text-lg text-gray-600",children:"Get fresh African groceries delivered in 3 simple steps"})]}),s.jsx("div",{className:"grid sm:grid-cols-3 gap-8",children:[{num:1,icon:"ðŸ”",title:"Find Stores Near You",desc:"Enter your location and browse stores in your area"},{num:2,icon:"ðŸ›’",title:"Add to Cart",desc:"Choose products from multiple vendors in one order"},{num:3,icon:"ðŸšš",title:"Fast Delivery",desc:"Get your groceries delivered same-day"}].map(l=>s.jsxs(Ct.div,{className:"text-center",whileHover:{y:-5},children:[s.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-green-500 to-green-700 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg",children:s.jsx("span",{className:"text-4xl",children:l.icon})}),s.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:l.title}),s.jsx("p",{className:"text-gray-600",children:l.desc})]},l.num))})]})}),s.jsx("section",{className:"bg-gradient-to-r from-yellow-400 via-yellow-500 to-green-600 py-16",children:s.jsxs("div",{className:"max-w-4xl mx-auto px-4 text-center",children:[s.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-4",children:"Are You a Food Vendor?"}),s.jsx("p",{className:"text-lg text-gray-800 mb-8",children:"Join 4,320+ vendors already selling on AfriHub. Reach thousands of customers and grow your business online."}),s.jsx(St,{to:"/partner",className:"inline-block bg-gray-900 text-white hover:bg-gray-800 px-10 py-4 rounded-xl font-bold shadow-2xl text-lg",children:"Partner With Us â†’"})]})}),s.jsx("footer",{className:"bg-gray-900 text-gray-300 py-12",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[s.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-8",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"text-white font-bold mb-4",children:"AfriHub"}),s.jsx("p",{className:"text-sm",children:"African groceries delivered to your door across the UK."})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-white font-bold mb-4",children:"For Customers"}),s.jsxs("ul",{className:"space-y-2 text-sm",children:[s.jsx("li",{children:s.jsx("a",{href:"#stores",className:"hover:text-yellow-400",children:"Browse Stores"})}),s.jsx("li",{children:s.jsx("a",{href:"#how-it-works",className:"hover:text-yellow-400",children:"How It Works"})}),s.jsx("li",{children:s.jsx(St,{to:"/register?role=customer",className:"hover:text-yellow-400",children:"Sign Up"})})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-white font-bold mb-4",children:"For Partners"}),s.jsxs("ul",{className:"space-y-2 text-sm",children:[s.jsx("li",{children:s.jsx(St,{to:"/partner",className:"hover:text-yellow-400",children:"Become a Vendor"})}),s.jsx("li",{children:s.jsx(St,{to:"/register?role=rider",className:"hover:text-yellow-400",children:"Become a Rider"})}),s.jsx("li",{children:s.jsx(St,{to:"/register?role=picker",className:"hover:text-yellow-400",children:"Become a Picker"})})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-white font-bold mb-4",children:"Company"}),s.jsxs("ul",{className:"space-y-2 text-sm",children:[s.jsx("li",{children:s.jsx("a",{href:"#",className:"hover:text-yellow-400",children:"About Us"})}),s.jsx("li",{children:s.jsx("a",{href:"#",className:"hover:text-yellow-400",children:"Contact"})}),s.jsx("li",{children:s.jsx("a",{href:"#",className:"hover:text-yellow-400",children:"Privacy Policy"})})]})]})]}),s.jsx("div",{className:"border-t border-gray-800 mt-8 pt-8 text-center text-sm",children:s.jsx("p",{children:"Â© 2025 AfriHub. All rights reserved."})})]})})]})}function d3({title:e,titleId:r,...t},n){return Te.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?Te.createElement("title",{id:r},e):null,Te.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const p3=Te.forwardRef(d3);function m3({title:e,titleId:r,...t},n){return Te.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?Te.createElement("title",{id:r},e):null,Te.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const ru=Te.forwardRef(m3);function g3({title:e,titleId:r,...t},n){return Te.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?Te.createElement("title",{id:r},e):null,Te.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 1.5H8.25A2.25 2.25 0 0 0 6 3.75v16.5a2.25 2.25 0 0 0 2.25 2.25h7.5A2.25 2.25 0 0 0 18 20.25V3.75a2.25 2.25 0 0 0-2.25-2.25H13.5m-3 0V3h3V1.5m-3 0h3m-3 18.75h3"}))}const x3=Te.forwardRef(g3);function v3({title:e,titleId:r,...t},n){return Te.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?Te.createElement("title",{id:r},e):null,Te.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 10.5V6a3.75 3.75 0 1 0-7.5 0v4.5m11.356-1.993 1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 0 1-1.12-1.243l1.264-12A1.125 1.125 0 0 1 5.513 7.5h12.974c.576 0 1.059.435 1.119 1.007ZM8.625 10.5a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm7.5 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const y3=Te.forwardRef(v3);function w3({title:e,titleId:r,...t},n){return Te.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?Te.createElement("title",{id:r},e):null,Te.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 18.75a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 0 1-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h1.125c.621 0 1.129-.504 1.09-1.124a17.902 17.902 0 0 0-3.213-9.193 2.056 2.056 0 0 0-1.58-.86H14.25M16.5 18.75h-2.25m0-11.177v-.958c0-.568-.422-1.048-.987-1.106a48.554 48.554 0 0 0-10.026 0 1.106 1.106 0 0 0-.987 1.106v7.635m12-6.677v6.677m0 4.5v-4.5m0 0h-12"}))}const b3=Te.forwardRef(w3);function N3({title:e,titleId:r,...t},n){return Te.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},t),e?Te.createElement("title",{id:r},e):null,Te.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"}))}const S3=Te.forwardRef(N3);function _3(){const e=[{icon:y3,title:"Reach Thousands of Customers",description:"Get your products in front of 4,320+ active shoppers looking for African groceries."},{icon:p3,title:"Grow Your Business Online",description:"Track sales, manage inventory, and grow your revenue with our easy-to-use vendor dashboard."},{icon:x3,title:"Easy Store Management",description:"Manage your store from anywhere with our mobile-friendly vendor dashboard."},{icon:b3,title:"We Handle Delivery",description:"Focus on preparing quality products. Our riders handle pickup and delivery to customers."},{icon:S3,title:"Dedicated Support",description:"24/7 support to help you succeed. We're here to answer questions and solve problems."},{icon:ru,title:"Verified & Trusted",description:"Join a trusted marketplace where quality vendors are verified and customer trust is high."}],r=[{number:1,title:"Submit Application",description:"Fill out the vendor application form with your business details and documents.",color:"from-green-500 to-green-600"},{number:2,title:"Verification Process",description:"Our team reviews your application and verifies your business credentials (1-3 business days).",color:"from-yellow-500 to-yellow-600"},{number:3,title:"Set Up Your Store",description:"Once approved, set up your store profile, add products, and configure delivery settings.",color:"from-green-600 to-green-700"},{number:4,title:"Start Selling",description:"Go live and start receiving orders from customers in your area!",color:"from-yellow-600 to-yellow-700"}],t=["Valid business registration or tax ID","Proof of address (business location)","Food safety/handling certification (for food vendors)","Bank account for receiving payments","High-quality photos of your products","Commitment to quality and customer service"],n=[{q:"How much does it cost to join?",a:"Joining AfriHub is free! We charge a small commission (12-15%) on each sale to cover platform costs, payment processing, and support."},{q:"How long does verification take?",a:"Verification typically takes 1-3 business days. We'll review your documents and get back to you via email."},{q:"What products can I sell?",a:"You can sell fresh produce, meats, dairy, African foods, spices, grains, and packaged goods. All products must meet UK food safety standards."},{q:"How do I receive payments?",a:"Payments are processed through Paystack and deposited directly to your bank account weekly."},{q:"Can I manage multiple stores?",a:"Yes! You can manage multiple store locations from a single vendor account."}];return s.jsxs("div",{className:"min-h-screen bg-white",children:[s.jsx("nav",{className:"bg-white border-b border-gray-200 sticky top-0 z-50 shadow-sm",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:s.jsxs("div",{className:"flex justify-between items-center h-16",children:[s.jsxs(St,{to:"/",className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-green-600 to-yellow-500 rounded-lg flex items-center justify-center",children:s.jsx("span",{className:"text-white font-bold text-lg",children:"ðŸ›’"})}),s.jsxs("span",{className:"text-xl font-bold text-gray-900",children:["Afri",s.jsx("span",{className:"text-green-600",children:"Hub"})]})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(St,{to:"/",className:"text-gray-600 hover:text-green-600",children:"Home"}),s.jsx(St,{to:"/login",className:"text-green-600 hover:text-green-700 font-medium",children:"Vendor Sign In"})]})]})})}),s.jsx("section",{className:"bg-gradient-to-br from-green-600 via-green-700 to-yellow-500 py-20",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 text-center",children:[s.jsx(Ct.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-4xl sm:text-5xl lg:text-6xl font-bold text-white mb-6",children:"Grow Your Food Business with AfriHub"}),s.jsx(Ct.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"text-xl text-white/95 mb-8 max-w-3xl mx-auto",children:"Join 4,320+ vendors already selling African groceries and reaching thousands of customers across the UK."}),s.jsxs(Ct.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"flex flex-col sm:flex-row gap-4 justify-center",children:[s.jsx(St,{to:"/register?role=vendor",className:"bg-yellow-400 text-gray-900 hover:bg-yellow-300 px-10 py-4 rounded-xl font-bold text-lg shadow-2xl inline-flex items-center justify-center gap-2",children:"Apply Now â†’"}),s.jsx("a",{href:"#how-it-works",className:"bg-white/10 backdrop-blur text-white hover:bg-white/20 px-10 py-4 rounded-xl font-bold text-lg border-2 border-white/30 inline-flex items-center justify-center",children:"Learn More"})]}),s.jsx("div",{className:"grid grid-cols-3 gap-8 max-w-3xl mx-auto mt-16",children:[{value:"4,320+",label:"Active Vendors"},{value:"Â£2.5M+",label:"Monthly Sales"},{value:"98%",label:"Satisfaction Rate"}].map((a,i)=>s.jsxs(Ct.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:.3+i*.1},className:"text-center",children:[s.jsx("div",{className:"text-3xl sm:text-4xl font-bold text-white mb-2",children:a.value}),s.jsx("div",{className:"text-sm text-white/80",children:a.label})]},i))})]})}),s.jsx("section",{className:"py-20 bg-gray-50",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[s.jsxs("div",{className:"text-center mb-12",children:[s.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-4",children:"Why Sell on AfriHub?"}),s.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Everything you need to run a successful online grocery business"})]}),s.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-8",children:e.map((a,i)=>s.jsxs(Ct.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:i*.1},className:"bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all",children:[s.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-green-500 to-green-700 rounded-xl flex items-center justify-center mb-4",children:s.jsx(a.icon,{className:"w-8 h-8 text-white"})}),s.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:a.title}),s.jsx("p",{className:"text-gray-600",children:a.description})]},i))})]})}),s.jsx("section",{id:"how-it-works",className:"py-20",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[s.jsxs("div",{className:"text-center mb-12",children:[s.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-4",children:"How to Get Started"}),s.jsx("p",{className:"text-lg text-gray-600",children:"Simple 4-step process to start selling"})]}),s.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-8",children:r.map((a,i)=>s.jsxs(Ct.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:i*.1},className:"text-center",children:[s.jsx("div",{className:`w-20 h-20 bg-gradient-to-br ${a.color} rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg`,children:s.jsx("span",{className:"text-3xl font-bold text-white",children:a.number})}),s.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:a.title}),s.jsx("p",{className:"text-gray-600 text-sm",children:a.description})]},i))})]})}),s.jsx("section",{className:"py-20 bg-gray-50",children:s.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[s.jsxs("div",{className:"text-center mb-12",children:[s.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-4",children:"What You'll Need"}),s.jsx("p",{className:"text-lg text-gray-600",children:"Requirements for vendor verification"})]}),s.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:s.jsx("ul",{className:"space-y-4",children:t.map((a,i)=>s.jsxs("li",{className:"flex items-start gap-3",children:[s.jsx(ru,{className:"w-6 h-6 text-green-600 flex-shrink-0 mt-0.5"}),s.jsx("span",{className:"text-gray-700",children:a})]},i))})})]})}),s.jsx("section",{className:"py-20",children:s.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[s.jsx("div",{className:"text-center mb-12",children:s.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-4",children:"Frequently Asked Questions"})}),s.jsx("div",{className:"space-y-6",children:n.map((a,i)=>s.jsxs(Ct.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:i*.1},className:"bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition-all",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:a.q}),s.jsx("p",{className:"text-gray-600",children:a.a})]},i))})]})}),s.jsx("section",{className:"bg-gradient-to-r from-green-600 via-green-700 to-yellow-500 py-20",children:s.jsxs("div",{className:"max-w-4xl mx-auto px-4 text-center",children:[s.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-white mb-6",children:"Ready to Start Selling?"}),s.jsx("p",{className:"text-xl text-white/95 mb-8",children:"Join thousands of vendors growing their business on AfriHub"}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[s.jsx(St,{to:"/register?role=vendor",className:"bg-yellow-400 text-gray-900 hover:bg-yellow-300 px-10 py-4 rounded-xl font-bold text-lg shadow-2xl inline-flex items-center justify-center gap-2",children:"Apply as Vendor â†’"}),s.jsx(St,{to:"/login",className:"bg-white text-green-700 hover:bg-gray-100 px-10 py-4 rounded-xl font-bold text-lg shadow-2xl inline-flex items-center justify-center",children:"Already a Vendor? Sign In"})]})]})}),s.jsx("footer",{className:"bg-gray-900 text-gray-300 py-12",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[s.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-8",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"text-white font-bold mb-4",children:"AfriHub"}),s.jsx("p",{className:"text-sm",children:"African groceries delivered to your door across the UK."})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-white font-bold mb-4",children:"For Customers"}),s.jsxs("ul",{className:"space-y-2 text-sm",children:[s.jsx("li",{children:s.jsx(St,{to:"/",className:"hover:text-yellow-400",children:"Browse Stores"})}),s.jsx("li",{children:s.jsx(St,{to:"/#how-it-works",className:"hover:text-yellow-400",children:"How It Works"})})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-white font-bold mb-4",children:"For Partners"}),s.jsxs("ul",{className:"space-y-2 text-sm",children:[s.jsx("li",{children:s.jsx(St,{to:"/partner",className:"hover:text-yellow-400",children:"Become a Vendor"})}),s.jsx("li",{children:s.jsx(St,{to:"/register?role=rider",className:"hover:text-yellow-400",children:"Become a Rider"})})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-white font-bold mb-4",children:"Company"}),s.jsxs("ul",{className:"space-y-2 text-sm",children:[s.jsx("li",{children:s.jsx("a",{href:"#",className:"hover:text-yellow-400",children:"About"})}),s.jsx("li",{children:s.jsx("a",{href:"#",className:"hover:text-yellow-400",children:"Contact"})})]})]})]}),s.jsx("div",{className:"border-t border-gray-800 mt-8 pt-8 text-center text-sm",children:s.jsx("p",{children:"Â© 2025 AfriHub. All rights reserved."})})]})})]})}function A3(){const[e]=e2(),r=e.get("location")||"",t=Cs(),[n,a]=Te.useState([]),[i,o]=Te.useState(!0),[l,c]=Te.useState(r);Te.useEffect(()=>{h()},[r]);const h=async()=>{var m;try{o(!0);const d=await P2(r,50);d.success&&((m=d.data)!=null&&m.vendors)&&d.data.vendors.length>0?a(d.data.vendors):a(u(r))}catch(d){console.log("Using sample stores:",d.message),a(u(r))}finally{o(!1)}},u=m=>{const d=[{id:1,name:"Green Valley Farms",category:"Fresh Produce",image:"https://images.unsplash.com/photo-1542838132-92c53300491e?w=600",rating:4.8,deliveryTime:"20-30 min",minOrder:"Â£10",tags:["Vegetables","Fruits","Organic"],location:"London",address:"123 High Street, London E1 6AN"},{id:2,name:"African Spice Market",category:"African Groceries",image:"https://images.unsplash.com/photo-1488459716781-31db52582fe9?w=600",rating:4.9,deliveryTime:"25-35 min",minOrder:"Â£15",tags:["Spices","Grains","Authentic"],location:"London",address:"45 Peckham High St, London SE15"},{id:3,name:"Lagos Kitchen Store",category:"Nigerian Foods",image:"https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=600",rating:4.9,deliveryTime:"25-35 min",minOrder:"Â£15",tags:["Nigerian","Palm Oil","Cassava"],location:"London",address:"78 Brixton Road, London SW9"},{id:4,name:"Tropical Fruits Hub",category:"Exotic Fruits",image:"https://images.unsplash.com/photo-1619566636858-adf3ef46400b?w=600",rating:4.8,deliveryTime:"20-30 min",minOrder:"Â£12",tags:["Plantain","Mango","Yam"],location:"London",address:"12 Ridley Road Market, London E8"},{id:5,name:"Hackney Fresh Foods",category:"Fresh Produce",image:"https://images.unsplash.com/photo-1542838132-92c53300491e?w=600",rating:4.7,deliveryTime:"20-30 min",minOrder:"Â£10",tags:["Vegetables","Fruits"],location:"London",address:"Hackney Market, London E8 5RT"},{id:6,name:"Manchester African Market",category:"African Groceries",image:"https://images.unsplash.com/photo-1488459716781-31db52582fe9?w=600",rating:4.6,deliveryTime:"30-40 min",minOrder:"Â£12",tags:["African","Spices","Grains"],location:"Manchester",address:"34 Cheetham Hill Road, Manchester M8"},{id:7,name:"Moss Side Grocers",category:"Fresh Produce",image:"https://images.unsplash.com/photo-1542838132-92c53300491e?w=600",rating:4.5,deliveryTime:"25-35 min",minOrder:"Â£10",tags:["Vegetables","Fruits"],location:"Manchester",address:"56 Great Western Street, Manchester M14"},{id:8,name:"Afro-Caribbean Store MCR",category:"Caribbean Foods",image:"https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=600",rating:4.7,deliveryTime:"30-40 min",minOrder:"Â£15",tags:["Caribbean","Plantain","Rice"],location:"Manchester",address:"89 Princess Road, Manchester M14"},{id:9,name:"Handsworth African Foods",category:"African Groceries",image:"https://images.unsplash.com/photo-1488459716781-31db52582fe9?w=600",rating:4.8,deliveryTime:"20-30 min",minOrder:"Â£10",tags:["African","Fresh","Halal"],location:"Birmingham",address:"23 Soho Road, Birmingham B21"},{id:10,name:"Birmingham Tropical Market",category:"Tropical Foods",image:"https://images.unsplash.com/photo-1619566636858-adf3ef46400b?w=600",rating:4.6,deliveryTime:"25-35 min",minOrder:"Â£12",tags:["Plantain","Yam","Cassava"],location:"Birmingham",address:"45 Stratford Road, Birmingham B11"},{id:11,name:"Bristol African Store",category:"African Groceries",image:"https://images.unsplash.com/photo-1488459716781-31db52582fe9?w=600",rating:4.7,deliveryTime:"30-40 min",minOrder:"Â£12",tags:["African","Caribbean","Fresh"],location:"Bristol",address:"12 Stapleton Road, Bristol BS5"},{id:12,name:"St Pauls Fresh Market",category:"Fresh Produce",image:"https://images.unsplash.com/photo-1542838132-92c53300491e?w=600",rating:4.5,deliveryTime:"25-35 min",minOrder:"Â£10",tags:["Vegetables","Fruits"],location:"Bristol",address:"34 Grosvenor Road, Bristol BS2"},{id:13,name:"Leeds African Groceries",category:"African Foods",image:"https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=600",rating:4.6,deliveryTime:"30-40 min",minOrder:"Â£12",tags:["African","Spices","Grains"],location:"Leeds",address:"67 Harehills Lane, Leeds LS8"},{id:14,name:"Chapeltown Fresh Foods",category:"Fresh Produce",image:"https://images.unsplash.com/photo-1542838132-92c53300491e?w=600",rating:4.5,deliveryTime:"25-35 min",minOrder:"Â£10",tags:["Vegetables","Fruits"],location:"Leeds",address:"89 Chapeltown Road, Leeds LS7"},{id:15,name:"Liverpool African Market",category:"African Groceries",image:"https://images.unsplash.com/photo-1488459716781-31db52582fe9?w=600",rating:4.7,deliveryTime:"30-40 min",minOrder:"Â£15",tags:["African","Caribbean","Halal"],location:"Liverpool",address:"45 Granby Street, Liverpool L8"},{id:16,name:"Toxteth Tropical Foods",category:"Tropical Foods",image:"https://images.unsplash.com/photo-1619566636858-adf3ef46400b?w=600",rating:4.6,deliveryTime:"25-35 min",minOrder:"Â£12",tags:["Plantain","Yam"],location:"Liverpool",address:"23 Upper Parliament Street, Liverpool L8"}];if(m){const y=d.filter(x=>x.location.toLowerCase().includes(m.toLowerCase())||x.address.toLowerCase().includes(m.toLowerCase()));return y.length>0?y:d.slice(0,6)}return d},g=m=>{m.preventDefault(),l.trim()&&t(`/stores?location=${encodeURIComponent(l)}`)};return s.jsxs("div",{className:"min-h-screen bg-white",children:[s.jsx("nav",{className:"bg-white border-b border-gray-200 sticky top-0 z-50 shadow-sm",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:s.jsxs("div",{className:"flex justify-between items-center h-16",children:[s.jsxs(St,{to:"/",className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-green-600 to-yellow-500 rounded-lg flex items-center justify-center",children:s.jsx("span",{className:"text-white font-bold text-lg",children:"ðŸ›’"})}),s.jsxs("span",{className:"text-xl font-bold text-gray-900",children:["Afri",s.jsx("span",{className:"text-green-600",children:"Hub"})]})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(St,{to:"/",className:"text-gray-600 hover:text-green-600",children:"Home"}),s.jsx(St,{to:"/partner",className:"text-gray-600 hover:text-green-600",children:"Partner With Us"}),s.jsx(St,{to:"/login",className:"text-green-600 hover:text-green-700 font-medium",children:"Sign In"})]})]})})}),s.jsx("section",{className:"bg-gradient-to-br from-green-600 to-green-700 py-12",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[s.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-white mb-4 text-center",children:"Find African Stores Near You"}),s.jsxs("form",{onSubmit:g,className:"max-w-2xl mx-auto bg-white rounded-2xl shadow-2xl p-3 flex flex-col sm:flex-row gap-3",children:[s.jsxs("div",{className:"flex-1 flex items-center gap-3 bg-gray-50 rounded-xl px-4 py-3",children:[s.jsx(q0,{className:"w-6 h-6 text-green-600 flex-shrink-0"}),s.jsx("input",{type:"text",value:l,onChange:m=>c(m.target.value),placeholder:"Enter location (London, Manchester, Birmingham...)",className:"flex-1 bg-transparent border-none outline-none text-gray-900 placeholder-gray-500"})]}),s.jsxs("button",{type:"submit",className:"bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white px-8 py-3 rounded-xl font-bold shadow-lg flex items-center justify-center gap-2",children:[s.jsx(u1,{className:"w-5 h-5"}),"Search"]})]})]})}),s.jsx("section",{className:"py-12",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:[s.jsxs("div",{className:"mb-8",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:r?`Stores in ${r}`:"All Stores"}),s.jsx("p",{className:"text-gray-600",children:i?"Searching...":`${n.length} stores found`})]}),i&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),s.jsx("p",{className:"text-gray-600 mt-4",children:"Finding stores..."})]}),!i&&n.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"text-6xl mb-4",children:"ðŸ˜”"}),s.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"No stores found in this area"}),s.jsx("p",{className:"text-gray-600 mb-6",children:"Try searching for London, Manchester, or Birmingham"}),s.jsx(St,{to:"/",className:"text-green-600 hover:text-green-700 font-semibold",children:"â† Back to Home"})]}),!i&&n.length>0&&s.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(m=>{var d;return s.jsxs(Ct.div,{whileHover:{y:-5},className:"bg-white rounded-2xl shadow-lg hover:shadow-xl border border-gray-100 overflow-hidden cursor-pointer transition-all",onClick:()=>t(`/store/${m.id}`),children:[s.jsxs("div",{className:"relative h-48",children:[s.jsx("img",{src:m.image,alt:m.name,className:"w-full h-full object-cover"}),s.jsxs("div",{className:"absolute top-3 right-3 bg-white px-3 py-1 rounded-full shadow-md flex items-center gap-1",children:[s.jsx(d1,{className:"w-4 h-4 text-yellow-500"}),s.jsx("span",{className:"font-bold text-gray-900",children:m.rating})]})]}),s.jsxs("div",{className:"p-5",children:[s.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:m.name}),s.jsx("p",{className:"text-sm text-gray-600 mb-1",children:m.category}),s.jsxs("p",{className:"text-xs text-gray-500 mb-3 flex items-center gap-1",children:[s.jsx(q0,{className:"w-3 h-3"}),m.address||m.location]}),s.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:(d=m.tags)==null?void 0:d.slice(0,3).map((y,x)=>s.jsx("span",{className:"bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-xs font-medium",children:y},x))}),s.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 pt-3 border-t",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(h1,{className:"w-4 h-4"}),s.jsx("span",{children:m.deliveryTime})]}),s.jsxs("div",{className:"font-semibold text-gray-900",children:["Min. ",m.minOrder]})]})]})]},m.id)})})]})})]})}function j3(){const{vendorId:e}=t2(),r=Cs(),[t,n]=Te.useState(null),[a,i]=Te.useState([]),[o,l]=Te.useState(["All"]),[c,h]=Te.useState("All"),[u,g]=Te.useState(!0),[m,d]=Te.useState(null),[y,x]=Te.useState([]),[b,N]=Te.useState(!1),[w,A]=Te.useState("");Te.useEffect(()=>{E()},[e]);const E=async()=>{var j;try{g(!0),d(null);const T=await O2(e);n(T.data||T);const B=await I2(e),M=((j=B.data)==null?void 0:j.products)||B.products||[];i(M);const le=["All",...new Set(M.map(J=>J.category).filter(Boolean))];l(le)}catch(T){console.error("Error fetching vendor:",T),d(T.message||"Failed to load store")}finally{g(!1)}},W=j=>{const T=y.find(B=>B._id===j._id);x(T?y.map(B=>B._id===j._id?{...B,quantity:B.quantity+1}:B):[...y,{...j,quantity:1}]),N(!0)},V=(j,T)=>{T<=0?F(j):x(y.map(B=>B._id===j?{...B,quantity:T}:B))},F=j=>{x(y.filter(T=>T._id!==j))},C=y.reduce((j,T)=>j+T.price*T.quantity,0),R=y.reduce((j,T)=>j+T.quantity,0),G=a.filter(j=>{const T=c==="All"||j.category===c,B=j.name.toLowerCase().includes(w.toLowerCase());return T&&B&&j.inStock});return u?s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-4 border-b-4 border-[#FFB300] mx-auto"}),s.jsx("p",{className:"text-gray-600 mt-4",children:"Loading store..."})]})}):m||!t?s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-2xl mb-4",children:"ðŸ˜”"}),s.jsx("p",{className:"text-gray-600 mb-4",children:m||"Store not found"}),s.jsx("button",{onClick:()=>r("/stores"),className:"bg-[#FFB300] text-white px-6 py-2 rounded-lg hover:bg-[#FFA726] transition",children:"Browse All Stores"})]})}):s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsx("header",{className:"bg-white border-b sticky top-0 z-40 shadow-sm",children:s.jsx("div",{className:"container mx-auto px-6 py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("button",{onClick:()=>r(-1),className:"text-gray-600 hover:text-gray-900",children:"â¬…ï¸ Go Back"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-2xl",children:"ðŸ›’"}),s.jsx("span",{className:"text-xl font-bold text-gray-900",children:"AfriHub"})]})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("button",{onClick:()=>r("/login"),className:"text-gray-600 hover:text-gray-900",children:"ðŸ‘¤ Account"}),s.jsxs("button",{onClick:()=>N(!b),className:"relative bg-[#FFB300] text-white px-4 py-2 rounded-lg hover:bg-[#FFA726] transition",children:["ðŸ›’ Cart",R>0&&s.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold",children:R})]})]})]})})}),s.jsx("div",{className:"bg-gradient-to-r from-[#E0F7F4] to-[#FFF4E0] py-12",children:s.jsx("div",{className:"container mx-auto px-6",children:s.jsxs("div",{className:"grid md:grid-cols-2 gap-8 items-center",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-5xl font-bold text-gray-900 mb-2",children:t.storeName||t.businessName}),s.jsx("p",{className:"text-2xl text-gray-600 mb-4",children:"Got You."}),s.jsx("p",{className:"text-lg text-[#00897B] font-semibold mb-6",children:"Save up to 60% off on your first order"}),s.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-600",children:[s.jsx("span",{children:"ðŸ›ï¸ Shopping Method: In-Shopping, Delivery"}),s.jsx("span",{children:"âš¡ Deliveries in 20-30 mins"}),s.jsxs("span",{children:["ðŸ“ž ",t.phone||"+44 - 2071 - 234567"]})]})]}),s.jsx("div",{className:"hidden md:block",children:s.jsx("img",{src:t.storeImage||"https://images.unsplash.com/photo-1488459716781-31db52582fe9?w=600&h=400&fit=crop",alt:"Fresh Produce",className:"rounded-2xl shadow-xl w-full h-64 object-cover"})})]})})}),s.jsx("div",{className:"bg-white border-b sticky top-16 z-30",children:s.jsx("div",{className:"container mx-auto px-6 py-4",children:s.jsxs("div",{className:"flex items-center justify-between gap-4",children:[s.jsx("div",{className:"flex gap-4 overflow-x-auto",children:o.map(j=>s.jsx("button",{onClick:()=>h(j),className:`px-4 py-2 font-semibold whitespace-nowrap transition ${c===j?"text-[#FFB300] border-b-2 border-[#FFB300]":"text-gray-600 hover:text-gray-900"}`,children:j},j))}),s.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg px-4 py-2 min-w-[200px]",children:[s.jsx("span",{children:"ðŸ”"}),s.jsx("input",{type:"text",placeholder:"Search products...",value:w,onChange:j=>A(j.target.value),className:"bg-transparent outline-none flex-1"})]})]})})}),s.jsxs("div",{className:"container mx-auto px-6 py-8",children:[s.jsxs("div",{className:"mb-12",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:c==="All"?"All Products":c}),G.length===0?s.jsx("div",{className:"text-center py-12",children:s.jsx("p",{className:"text-gray-600",children:"No products found"})}):s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:G.map(j=>s.jsx(T3,{product:j,onAddToCart:()=>W(j)},j._id))})]}),s.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mb-12",children:[s.jsxs("div",{className:"bg-gradient-to-r from-[#00897B] to-[#00695C] text-white p-6 rounded-xl",children:[s.jsx("h3",{className:"text-xl font-bold mb-2",children:"Free delivery"}),s.jsx("p",{className:"mb-4",children:"over Â£50"}),s.jsx("button",{className:"bg-white text-[#00897B] px-4 py-2 rounded-lg font-semibold hover:bg-gray-100 transition",children:"Shop Now â†’"})]}),s.jsxs("div",{className:"bg-gradient-to-r from-[#FFB300] to-[#FFA726] text-white p-6 rounded-xl",children:[s.jsx("h3",{className:"text-xl font-bold mb-2",children:"60% off"}),s.jsx("p",{className:"mb-4",children:"Organic Food"}),s.jsx("button",{className:"bg-white text-[#FFB300] px-4 py-2 rounded-lg font-semibold hover:bg-gray-100 transition",children:"Order Now â†’"})]}),s.jsxs("div",{className:"bg-gradient-to-r from-[#00897B] to-[#00695C] text-white p-6 rounded-xl",children:[s.jsx("h3",{className:"text-xl font-bold mb-2",children:"Free delivery"}),s.jsx("p",{className:"mb-4",children:"Shop Â£50 get..."}),s.jsx("button",{className:"bg-white text-[#00897B] px-4 py-2 rounded-lg font-semibold hover:bg-gray-100 transition",children:"Shop Now â†’"})]})]})]}),b&&s.jsxs("div",{className:"fixed inset-0 z-50 flex",children:[s.jsx("div",{onClick:()=>N(!1),className:"flex-1 bg-black/50"}),s.jsx("div",{className:"w-full max-w-md bg-white shadow-2xl overflow-y-auto",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Shopping Cart"}),s.jsx("button",{onClick:()=>N(!1),className:"text-gray-400 hover:text-gray-600 text-2xl",children:"âœ•"})]}),y.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("p",{className:"text-2xl mb-2",children:"ðŸ›’"}),s.jsx("p",{className:"text-gray-600",children:"Your cart is empty"})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"space-y-4 mb-6",children:y.map(j=>{var T,B;return s.jsxs("div",{className:"flex gap-4 border-b pb-4",children:[s.jsx("img",{src:((B=(T=j.images)==null?void 0:T[0])==null?void 0:B.url)||"https://via.placeholder.com/80",alt:j.name,className:"w-20 h-20 object-cover rounded-lg"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:j.name}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Â£",j.price.toFixed(2)]}),s.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[s.jsx("button",{onClick:()=>V(j._id,j.quantity-1),className:"w-6 h-6 bg-gray-200 rounded hover:bg-gray-300 transition",children:"-"}),s.jsx("span",{className:"font-semibold",children:j.quantity}),s.jsx("button",{onClick:()=>V(j._id,j.quantity+1),className:"w-6 h-6 bg-gray-200 rounded hover:bg-gray-300 transition",children:"+"}),s.jsx("button",{onClick:()=>F(j._id),className:"ml-auto text-red-500 hover:text-red-700",children:"ðŸ—‘ï¸"})]})]})]},j._id)})}),s.jsxs("div",{className:"border-t pt-4 mb-6",children:[s.jsxs("div",{className:"flex justify-between mb-2",children:[s.jsx("span",{className:"text-gray-600",children:"Subtotal:"}),s.jsxs("span",{className:"font-semibold",children:["Â£",C.toFixed(2)]})]}),s.jsxs("div",{className:"flex justify-between mb-2",children:[s.jsx("span",{className:"text-gray-600",children:"Delivery:"}),s.jsxs("span",{className:"font-semibold",children:["Â£",C>=50?"0.00":"5.00"]})]}),s.jsxs("div",{className:"flex justify-between text-xl font-bold border-t pt-2",children:[s.jsx("span",{children:"Total:"}),s.jsxs("span",{children:["Â£",(C+(C>=50?0:5)).toFixed(2)]})]})]}),s.jsx("button",{onClick:()=>r("/checkout"),className:"w-full bg-gradient-to-r from-[#FFB300] to-[#FFA726] text-white py-4 rounded-lg font-bold text-lg hover:shadow-lg transition",children:"Proceed to Checkout"})]})]})})]}),s.jsx("footer",{className:"bg-[#1A1A1A] text-white py-8",children:s.jsx("div",{className:"container mx-auto px-6 text-center",children:s.jsx("p",{className:"text-gray-400",children:"Â© 2025 AfriHub. All rights reserved."})})})]})}function T3({product:e,onAddToCart:r}){var i,o;const[t,n]=Te.useState(!1),a=()=>{r(),n(!0),setTimeout(()=>n(!1),1e3)};return s.jsxs("div",{className:"bg-white rounded-xl shadow-md hover:shadow-xl transition overflow-hidden group",children:[s.jsxs("div",{className:"relative h-40 bg-gray-100 overflow-hidden",children:[s.jsx("img",{src:((o=(i=e.images)==null?void 0:i[0])==null?void 0:o.url)||"https://via.placeholder.com/200",alt:e.name,className:"w-full h-full object-cover group-hover:scale-110 transition duration-300"}),e.discount>0&&s.jsxs("span",{className:"absolute top-2 right-2 bg-red-500 text-white px-2 py-1 rounded-full text-xs font-bold",children:["-",e.discount,"%"]})]}),s.jsxs("div",{className:"p-4",children:[s.jsx("p",{className:"text-xs text-gray-500 mb-1",children:e.category}),s.jsx("h3",{className:"font-semibold text-gray-900 mb-2 truncate",children:e.name}),s.jsx("div",{className:"flex items-center gap-1 mb-2",children:[...Array(5)].map((l,c)=>s.jsx("span",{className:c<4?"text-yellow-400 text-sm":"text-gray-300 text-sm",children:"â­"},c))}),s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.discount>0&&s.jsxs("span",{className:"text-sm text-gray-400 line-through",children:["Â£",(e.price/(1-e.discount/100)).toFixed(2)]}),s.jsxs("span",{className:"text-lg font-bold text-[#00B207]",children:["Â£",e.price.toFixed(2)]})]}),s.jsx("button",{onClick:a,className:`w-full py-2 rounded-lg font-semibold transition ${t?"bg-green-500 text-white":"bg-gradient-to-r from-[#FFB300] to-[#FFA726] text-white hover:shadow-lg"}`,children:t?"âœ“ Added!":"ðŸ›’ Add"})]})]})}function Ns({children:e}){var u;const r=r2(),t=Cs(),{user:n,logout:a}=Uo(),[i,o]=Te.useState(!1),l=[{name:"Dashboard",path:"/dashboard",icon:"ðŸ“Š"},{name:"Products",path:"/products",icon:"ðŸ“¦"},{name:"Orders",path:"/orders",icon:"ðŸ›’"},{name:"Reports",path:"/reports",icon:"ðŸ“ˆ"},{name:"Subscription",path:"/subscription",icon:"ðŸ’³"},{name:"Settings",path:"/settings",icon:"âš™ï¸"}],c=()=>{a(),t("/login")},h=g=>r.pathname===g;return s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[i&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden",onClick:()=>o(!1)}),s.jsx("div",{className:`fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-xl transform transition-transform duration-300 ease-in-out lg:translate-x-0 ${i?"translate-x-0":"-translate-x-full"}`,children:s.jsxs("div",{className:"flex flex-col h-full",children:[s.jsxs("div",{className:"flex items-center justify-between h-16 px-6 bg-gradient-to-r from-afri-green to-afri-green-dark",children:[s.jsx(St,{to:"/dashboard",className:"flex items-center",children:s.jsx("span",{className:"text-2xl font-bold text-white",children:"Afrimercato"})}),s.jsx("button",{onClick:()=>o(!1),className:"lg:hidden text-white hover:text-afri-yellow",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"w-10 h-10 rounded-full bg-afri-green text-white flex items-center justify-center font-bold",children:((u=n==null?void 0:n.name)==null?void 0:u.charAt(0).toUpperCase())||"V"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate",children:(n==null?void 0:n.name)||"Vendor"}),s.jsx("p",{className:"text-xs text-gray-500 truncate",children:(n==null?void 0:n.email)||""})]})]})}),s.jsx("nav",{className:"flex-1 px-4 py-4 space-y-1 overflow-y-auto",children:l.map(g=>s.jsxs(St,{to:g.path,className:`flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${h(g.path)?"bg-afri-green text-white":"text-gray-700 hover:bg-gray-100"}`,children:[s.jsx("span",{className:"text-xl",children:g.icon}),s.jsx("span",{className:"font-medium",children:g.name})]},g.name))}),s.jsx("div",{className:"p-4 border-t border-gray-200",children:s.jsxs("button",{onClick:c,className:"w-full flex items-center space-x-3 px-4 py-3 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[s.jsx("span",{className:"text-xl",children:"ðŸšª"}),s.jsx("span",{className:"font-medium",children:"Logout"})]})})]})}),s.jsxs("div",{className:"lg:ml-64",children:[s.jsx("div",{className:"sticky top-0 z-30 bg-white shadow-sm",children:s.jsxs("div",{className:"flex items-center justify-between h-16 px-4 sm:px-6 lg:px-8",children:[s.jsx("button",{onClick:()=>o(!0),className:"lg:hidden text-gray-500 hover:text-gray-700",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),s.jsx("div",{className:"flex-1 lg:flex-none"}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("button",{className:"relative p-2 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100",children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),s.jsx("span",{className:"absolute top-1 right-1 block h-2 w-2 rounded-full bg-red-500"})]}),s.jsx("div",{className:"hidden lg:flex items-center space-x-2 text-sm",children:s.jsx("span",{className:"font-medium text-gray-700",children:n==null?void 0:n.name})})]})]})}),s.jsx("main",{className:"p-4 sm:p-6 lg:p-8",children:e})]})]})}function k3(){const{isAuthenticated:e,loading:r}=Uo();return r?s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-afri-green to-afri-green-dark",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-white mx-auto"}),s.jsx("p",{className:"text-white mt-4 text-lg font-semibold",children:"Loading Afrimercato..."})]})}):s.jsxs(n2,{children:[s.jsx($n,{path:"/",element:s.jsx(u3,{})}),s.jsx($n,{path:"/partner",element:s.jsx(_3,{})}),s.jsx($n,{path:"/stores",element:s.jsx(A3,{})}),s.jsx($n,{path:"/store/:vendorId",element:s.jsx(j3,{})}),s.jsx($n,{path:"/login",element:e?s.jsx(oi,{to:"/dashboard"}):s.jsx(z2,{})}),s.jsx($n,{path:"/register",element:e?s.jsx(oi,{to:"/dashboard"}):s.jsx(V2,{})}),s.jsx($n,{path:"/dashboard",element:e?s.jsx(Ns,{children:s.jsx(Uw,{})}):s.jsx(oi,{to:"/login"})}),s.jsx($n,{path:"/products",element:e?s.jsx(Ns,{children:s.jsx(zw,{})}):s.jsx(oi,{to:"/login"})}),s.jsx($n,{path:"/orders",element:e?s.jsx(Ns,{children:s.jsx(Qw,{})}):s.jsx(oi,{to:"/login"})}),s.jsx($n,{path:"/reports",element:e?s.jsx(Ns,{children:s.jsx(t3,{})}):s.jsx(oi,{to:"/login"})}),s.jsx($n,{path:"/subscription",element:e?s.jsx(Ns,{children:s.jsx(s3,{})}):s.jsx(oi,{to:"/login"})}),s.jsx($n,{path:"/settings",element:e?s.jsx(Ns,{children:s.jsx(r3,{})}):s.jsx(oi,{to:"/login"})})]})}function E3(){return s.jsx(q2,{children:s.jsx(k3,{})})}class F3 extends nu.Component{constructor(r){super(r),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0}}componentDidCatch(r,t){this.setState({error:r,errorInfo:t}),console.error("ErrorBoundary caught an error:",r,t)}render(){return this.state.hasError?s.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center px-4",children:s.jsxs("div",{className:"max-w-lg w-full bg-white rounded-lg shadow-xl p-8",children:[s.jsx("div",{className:"flex items-center justify-center w-16 h-16 bg-red-100 rounded-full mx-auto mb-4",children:s.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),s.jsx("h1",{className:"text-2xl font-bold text-center text-gray-900 mb-4",children:"Oops! Something went wrong"}),s.jsx("p",{className:"text-gray-600 text-center mb-6",children:"We're sorry for the inconvenience. Please try refreshing the page."}),s.jsxs("div",{className:"flex justify-center space-x-4",children:[s.jsx("button",{onClick:()=>window.location.reload(),className:"bg-green-600 text-white px-6 py-2 rounded-lg font-medium hover:bg-green-700",children:"Refresh Page"}),s.jsx("a",{href:"/",className:"bg-gray-200 text-gray-800 px-6 py-2 rounded-lg font-medium hover:bg-gray-300",children:"Go Home"})]}),!1]})}):this.props.children}}A0.createRoot(document.getElementById("root")).render(s.jsx(nu.StrictMode,{children:s.jsxs(a2,{children:["  ",s.jsx(F3,{children:s.jsx(E3,{})})]})}));
