import{j as s}from"./date-iP6_brdS.js";import{u as C,f as F,r as c}from"./vendor-CPDP2aPO.js";import{p as _,f as h}from"./index-B_A1dkTv.js";import{g as $}from"./defaultImages-jUbsX-qu.js";import"./ui-Tzc8TJql.js";const A=[{id:"all",name:"All Products",icon:"ðŸ›’"},{id:"fresh-produce",name:"Fresh Produce",icon:"ðŸ¥¬"},{id:"fruits",name:"Fruits",icon:"ðŸŽ"},{id:"vegetables",name:"Vegetables",icon:"ðŸ¥•"},{id:"meat-fish",name:"Meat & Fish",icon:"ðŸ¥©"},{id:"dairy",name:"Dairy",icon:"ðŸ¥›"},{id:"grains",name:"Grains & Cereals",icon:"ðŸŒ¾"},{id:"spices",name:"Spices",icon:"ðŸŒ¶ï¸"},{id:"beverages",name:"Beverages",icon:"ðŸ¹"}],M=[{value:"newest",label:"Newest First"},{value:"price-low",label:"Price: Low to High"},{value:"price-high",label:"Price: High to Low"},{value:"popular",label:"Most Popular"},{value:"rating",label:"Highest Rated"}];function R(){const p=C(),[i,u]=F(),[g,v]=c.useState([]),[N,f]=c.useState(!0),[o,b]=c.useState("grid"),[j,m]=c.useState([]),[t,y]=c.useState({search:i.get("search")||"",category:i.get("category")||"all",sort:i.get("sort")||"newest",minPrice:i.get("minPrice")||"",maxPrice:i.get("maxPrice")||"",inStock:i.get("inStock")==="true"}),[l,x]=c.useState({page:1,limit:12,total:0,pages:0});c.useEffect(()=>{w(),P()},[t,l.page]);const w=async()=>{try{f(!0);const e={page:l.page,limit:l.limit,...t.search&&{search:t.search},...t.category!=="all"&&{category:t.category},...t.sort&&{sort:t.sort},...t.minPrice&&{minPrice:t.minPrice},...t.maxPrice&&{maxPrice:t.maxPrice},...t.inStock&&{inStock:!0}},a=await _.getAll(e);a.success&&(v(a.data.products||a.data||[]),a.data.pagination&&x(r=>({...r,...a.data.pagination})))}catch(e){console.error("Error fetching products:",e)}finally{f(!1)}},P=async()=>{var e;try{const a=await h.getWishlist();a.success&&m(((e=a.data)==null?void 0:e.map(r=>r.productId||r._id))||[])}catch(a){console.error("Error fetching wishlist:",a)}},d=(e,a)=>{y(n=>({...n,[e]:a})),x(n=>({...n,page:1}));const r=new URLSearchParams(i);a&&a!=="all"?r.set(e,a):r.delete(e),u(r)},k=async e=>{try{j.includes(e)?(await h.removeFromWishlist(e),m(a=>a.filter(r=>r!==e))):(await h.addToWishlist(e),m(a=>[...a,e]))}catch(a){console.error("Wishlist error:",a)}},S=e=>{const a=JSON.parse(localStorage.getItem("afrimercato_cart")||"[]"),r=a.findIndex(n=>n._id===e._id);r>=0?a[r].quantity+=1:a.push({...e,quantity:1}),localStorage.setItem("afrimercato_cart",JSON.stringify(a)),window.dispatchEvent(new Event("cartUpdated")),alert(`${e.name} added to cart!`)};return s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsx("div",{className:"bg-gradient-to-r from-afri-green to-afri-green-dark text-white py-8",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[s.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Browse Products"}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("div",{className:"flex-1 relative",children:[s.jsx("input",{type:"text",placeholder:"Search products...",value:t.search,onChange:e=>d("search",e.target.value),className:"w-full px-4 py-3 pl-12 rounded-xl text-gray-900 focus:ring-2 focus:ring-yellow-400"}),s.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400",children:"ðŸ”"})]}),s.jsx("select",{value:t.sort,onChange:e=>d("sort",e.target.value),className:"px-4 py-3 rounded-xl text-gray-900 bg-white",children:M.map(e=>s.jsx("option",{value:e.value,children:e.label},e.value))})]})]})}),s.jsx("div",{className:"max-w-7xl mx-auto px-4 py-8",children:s.jsxs("div",{className:"flex gap-8",children:[s.jsx("div",{className:"w-64 flex-shrink-0 hidden lg:block",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 sticky top-4",children:[s.jsx("h3",{className:"font-bold text-lg mb-4",children:"Categories"}),s.jsx("div",{className:"space-y-2",children:A.map(e=>s.jsxs("button",{onClick:()=>d("category",e.id),className:`w-full text-left px-4 py-2 rounded-lg flex items-center gap-2 transition-all ${t.category===e.id?"bg-afri-green text-white":"hover:bg-gray-100"}`,children:[s.jsx("span",{children:e.icon}),s.jsx("span",{children:e.name})]},e.id))}),s.jsx("hr",{className:"my-6"}),s.jsx("h3",{className:"font-bold text-lg mb-4",children:"Price Range"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"number",placeholder:"Min",value:t.minPrice,onChange:e=>d("minPrice",e.target.value),className:"w-1/2 px-3 py-2 border rounded-lg"}),s.jsx("input",{type:"number",placeholder:"Max",value:t.maxPrice,onChange:e=>d("maxPrice",e.target.value),className:"w-1/2 px-3 py-2 border rounded-lg"})]}),s.jsxs("label",{className:"flex items-center gap-2 mt-4 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:t.inStock,onChange:e=>d("inStock",e.target.checked),className:"w-5 h-5 rounded text-afri-green"}),s.jsx("span",{children:"In Stock Only"})]})]})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("p",{className:"text-gray-600",children:[l.total||g.length," products found"]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>b("grid"),className:`p-2 rounded-lg ${o==="grid"?"bg-afri-green text-white":"bg-gray-200"}`,children:"â–¦"}),s.jsx("button",{onClick:()=>b("list"),className:`p-2 rounded-lg ${o==="list"?"bg-afri-green text-white":"bg-gray-200"}`,children:"â˜°"})]})]}),N?s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:[...Array(8)].map((e,a)=>s.jsxs("div",{className:"bg-white rounded-xl p-4 animate-pulse",children:[s.jsx("div",{className:"bg-gray-200 h-40 rounded-lg mb-4"}),s.jsx("div",{className:"bg-gray-200 h-4 rounded mb-2"}),s.jsx("div",{className:"bg-gray-200 h-4 w-2/3 rounded"})]},a))}):g.length===0?s.jsxs("div",{className:"text-center py-16",children:[s.jsx("span",{className:"text-6xl",children:"ðŸ”"}),s.jsx("p",{className:"text-gray-500 mt-4",children:"No products found"}),s.jsx("button",{onClick:()=>{y({search:"",category:"all",sort:"newest",minPrice:"",maxPrice:"",inStock:!1}),u({})},className:"mt-4 px-6 py-2 bg-afri-green text-white rounded-lg",children:"Clear Filters"})]}):s.jsx("div",{className:o==="grid"?"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6":"space-y-4",children:g.map(e=>{var a,r;return s.jsxs("div",{className:`bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-all group ${o==="list"?"flex":""}`,children:[s.jsxs("div",{className:`relative cursor-pointer ${o==="list"?"w-48 flex-shrink-0":""}`,onClick:()=>p(`/product/${e._id}`),children:[s.jsx("img",{src:$(e),alt:e.name,className:`w-full object-cover group-hover:scale-105 transition-transform ${o==="list"?"h-full":"h-48"}`}),e.originalPrice&&e.originalPrice>e.price&&s.jsxs("span",{className:"absolute top-2 left-2 bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:[Math.round((1-e.price/e.originalPrice)*100),"% OFF"]}),s.jsx("button",{onClick:n=>{n.stopPropagation(),k(e._id)},className:"absolute top-2 right-2 w-8 h-8 bg-white rounded-full flex items-center justify-center shadow-lg hover:scale-110 transition-transform",children:j.includes(e._id)?"â¤ï¸":"ðŸ¤"})]}),s.jsxs("div",{className:"p-4 flex-1",children:[s.jsx("p",{className:"text-xs text-afri-green font-semibold mb-1",children:((a=e.vendor)==null?void 0:a.storeName)||"AfriMercato"}),s.jsx("h3",{className:"font-semibold text-gray-900 mb-1 line-clamp-2 cursor-pointer hover:text-afri-green",onClick:()=>p(`/product/${e._id}`),children:e.name}),s.jsx("p",{className:"text-xs text-gray-500 mb-2",children:e.unit||"per item"}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("span",{className:"text-lg font-bold text-afri-green",children:["Â£",(r=e.price)==null?void 0:r.toFixed(2)]}),e.originalPrice&&e.originalPrice>e.price&&s.jsxs("span",{className:"text-sm text-gray-400 line-through ml-2",children:["Â£",e.originalPrice.toFixed(2)]})]}),s.jsx("button",{onClick:()=>S(e),className:"bg-afri-green text-white px-3 py-1.5 rounded-lg text-sm font-semibold hover:bg-afri-green-dark transition-colors",children:"+ Add"})]})]})]},e._id)})}),l.pages>1&&s.jsx("div",{className:"flex justify-center gap-2 mt-8",children:[...Array(l.pages)].map((e,a)=>s.jsx("button",{onClick:()=>x(r=>({...r,page:a+1})),className:`w-10 h-10 rounded-lg ${l.page===a+1?"bg-afri-green text-white":"bg-white hover:bg-gray-100"}`,children:a+1},a))})]})]})})]})}export{R as default};
